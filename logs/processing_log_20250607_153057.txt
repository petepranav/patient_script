================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[15:30:57] ℹ️  CSV Data Extraction & API Push Tool
[15:30:57] ℹ️  
[15:30:57] ℹ️  Features:
[15:30:57] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[15:30:57] ℹ️  - AI-powered patient and order data extraction
[15:30:57] ℹ️  - Enhanced error handling and logging
[15:30:57] ℹ️  - Full API integration (patient creation + order pushing)
[15:30:57] ℹ️  - CSV output with comprehensive patient data
[15:30:57] ℹ️  - Detailed API tracking with remarks for every document
[15:30:57] ℹ️  - Complete audit trail of all processing attempts
[15:30:57] ℹ️  
[15:30:57] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[15:30:57] ✅ Created output CSV file: csv_outputs/extracted_patients_20250607_153057.csv
[15:30:57] ✅ Created API details CSV file: api_outputs/api_push_details_20250607_153057.csv
================================================================================
║                        Processing Document ID: 9274554                         ║
================================================================================
[15:30:57] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:30:57] ℹ️  Date: 05/02/2025
[15:30:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:31:12] [DOC: 9274554] ✅ Text extracted using pdfplumber (19721 chars)
[15:31:12] ✅    ✅ Text extracted using pdfplumber (19709 chars)
[15:31:12] 🔄 
🔄 Step 2: Extracting patient data...
[15:31:17] ℹ️  AI extracted raw sex value: 'F'
[15:31:17] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[15:31:17] ℹ️  AI extracted payer source: 'Medicare'
[15:31:17] ℹ️  AI extracted diagnoses:
[15:31:17] ℹ️    - Diagnosis 1: 'I65.29'
[15:31:17] ℹ️    - Diagnosis 2: 'E78.5'
[15:31:17] ℹ️    - Diagnosis 3: 'M81.0'
[15:31:17] ℹ️    - Diagnosis 4: 'G47.00'
[15:31:17] ℹ️    - Diagnosis 5: 'I10'
[15:31:17] ℹ️    - Diagnosis 6: 'D50.9'
[15:31:17] ℹ️  Final extracted MRN: 'MA250408034202'
[15:31:17] ℹ️  Final extracted Sex: 'FEMALE'
[15:31:17] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[15:31:17] ℹ️  Final extracted Payer Source: 'Medicare'
[15:31:17] ✅ Patient data extraction completed successfully
[15:31:17] ✅    ✅ Patient data extracted successfully
[15:31:17] 📊 Patient Response
     └─ patientFName: Pamela
     └─ patientLName: Newell
     └─ dob: 03/15/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250408034202
     └─ billingProvider: CALDAS, ROBERT
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/16/2025', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '06/14/2025', 'firstDiagnosis': 'I65.29', 'secondDiagnosis': 'E78.5', 'thirdDiagnosis': 'M81.0', 'fourthDiagnosis': 'G47.00', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'D50.9'}]
[15:31:17] ✅    ✅ Patient identified: Pamela Newell
[15:31:17] ✅    ✅ Patient name validation passed
[15:31:17] 🔄 
🔄 Step 3: Processing patient dates...
[15:31:17] [DOC: 9274554] ℹ️  DOB normalized: 03/15/1942
[15:31:17] [DOC: 9274554] ℹ️  Episode startOfCare normalized: 04/16/2025
[15:31:17] [DOC: 9274554] ℹ️  Episode startOfEpisode normalized: 04/16/2025
[15:31:17] [DOC: 9274554] ℹ️  Episode endOfEpisode normalized: 06/14/2025
[15:31:17] [DOC: 9274554] ✅ Patient date processing completed successfully
[15:31:17] ✅    ✅ Date processing completed
[15:31:17] 📊 Processed Patient Data
     └─ patientFName: Pamela
     └─ patientLName: Newell
     └─ dob: 03/15/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250408034202
     └─ billingProvider: CALDAS, ROBERT
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/16/2025', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '06/14/2025', 'firstDiagnosis': 'I65.29', 'secondDiagnosis': 'E78.5', 'thirdDiagnosis': 'M81.0', 'fourthDiagnosis': 'G47.00', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'D50.9'}]
[15:31:17] 🔄 
🔄 Step 4: Extracting order data...
[15:31:20] ℹ️  Order extraction - MRN: 'MA250408034202'
[15:31:20] ℹ️  Order extraction - Sex: 'FEMALE'
[15:31:20] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy'
[15:31:20] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:31:20] ✅ Order data extraction completed successfully
[15:31:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:31:20] ℹ️  Using MRN from patient data: 'MA250408034202' over 'MA250408034202'
[15:31:20] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy'
[15:31:20] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:31:20] ✅ Patient name cross-validation successful
[15:31:20] ✅    ✅ Data merged successfully
[15:31:21] ✅    ✅ Order data extracted and validated
[15:31:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:31:38] [DOC: 9274554] ✅ Patient exists in API: Pamela Newell, ID: 916ed949-8061-47b2-9022-7ec91bcc9d65
[15:31:38] ✅    ✅ Existing patient found with ID: 916ed949-8061-47b2-9022-7ec91bcc9d65
[15:31:38] 🔄 
🔄 Step 6: Pushing order to API...
[15:31:38] [DOC: 9274554] ℹ️  Pushing order via API for patient ID: 916ed949-8061-47b2-9022-7ec91bcc9d65
[15:31:39] [DOC: 9274554] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14176"}
[15:31:39] ❌    ❌ Failed to push order
[15:31:39] 🔄 
🔄 Step 7: Writing to CSV...
[15:31:39] [DOC: 9274554] ℹ️  Calculated age: 83 from DOB: 03/15/1942
[15:31:39] [DOC: 9274554] ℹ️  Service Line extracted: 'Physical Therapy, Occupational Therapy'
[15:31:39] [DOC: 9274554] ℹ️  Payer Source extracted: 'Medicare'
[15:31:39] [DOC: 9274554] ℹ️  Diagnosis codes being written:
[15:31:39] [DOC: 9274554] ℹ️    - Latest_Episode_Firstdiagnosis: 'I65.29'
[15:31:39] [DOC: 9274554] ℹ️    - Latest_Episode_Seconddiagnosis: 'E78.5'
[15:31:39] [DOC: 9274554] ℹ️    - Latest_Episode_Thirddiagnosis: 'M81.0'
[15:31:39] [DOC: 9274554] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G47.00'
[15:31:39] [DOC: 9274554] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[15:31:39] [DOC: 9274554] ℹ️    - Latest_Episode_Sixthdiagnosis: 'D50.9'
[15:31:39] [DOC: 9274554] ✅ Patient data written to CSV: Pamela Newell | Sex: FEMALE | Age: 83 | Service: Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: MA250408034202
[15:31:39] ✅    ✅ Document 9274554 processed and saved successfully
[15:31:39] 🔄 
🔄 Step 8: Saving API details...
[15:31:39] [DOC: 9274554] ℹ️  API push details saved for document 9274554
[15:31:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9273899                         ║
================================================================================
[15:31:39] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:31:39] ℹ️  Date: 05/02/2025
[15:31:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:31:41] [DOC: 9273899] ✅ Text extracted using pdfplumber (1678 chars)
[15:31:41] ✅    ✅ Text extracted using pdfplumber (1678 chars)
[15:31:41] 🔄 
🔄 Step 2: Extracting patient data...
[15:31:44] ℹ️  AI extracted raw sex value: ''
[15:31:44] ℹ️  AI extracted service line: 'Physical Therapy'
[15:31:44] ℹ️  AI extracted payer source: ''
[15:31:44] ℹ️  AI extracted diagnoses:
[15:31:44] ℹ️    - Diagnosis 1: 'M47.816'
[15:31:44] ℹ️    - Diagnosis 2: 'M75.41'
[15:31:44] ℹ️    - Diagnosis 3: 'M17.0'
[15:31:44] ℹ️    - Diagnosis 4: 'None'
[15:31:44] ℹ️    - Diagnosis 5: 'None'
[15:31:44] ℹ️    - Diagnosis 6: 'None'
[15:31:44] ℹ️  Final extracted MRN: 'MA241216044603'
[15:31:44] ℹ️  Final extracted Sex: ''
[15:31:44] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:31:44] ℹ️  Final extracted Payer Source: ''
[15:31:44] ✅ Patient data extraction completed successfully
[15:31:44] ✅    ✅ Patient data extracted successfully
[15:31:44] 📊 Patient Response
     └─ patientFName: Leonor
     └─ patientLName: Gomes
     └─ dob: 04/15/1946
     └─ patientSex: 
     └─ medicalRecordNo: MA241216044603
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/22/2025', 'endOfEpisode': '06/20/2025', 'firstDiagnosis': 'M47.816', 'secondDiagnosis': 'M75.41', 'thirdDiagnosis': 'M17.0', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:31:44] ✅    ✅ Patient identified: Leonor Gomes
[15:31:44] ✅    ✅ Patient name validation passed
[15:31:44] 🔄 
🔄 Step 3: Processing patient dates...
[15:31:44] [DOC: 9273899] ℹ️  DOB normalized: 04/15/1946
[15:31:44] [DOC: 9273899] ℹ️  Episode startOfEpisode normalized: 04/22/2025
[15:31:44] [DOC: 9273899] ℹ️  Episode endOfEpisode normalized: 06/20/2025
[15:31:44] [DOC: 9273899] ✅ Patient date processing completed successfully
[15:31:44] ✅    ✅ Date processing completed
[15:31:44] 📊 Processed Patient Data
     └─ patientFName: Leonor
     └─ patientLName: Gomes
     └─ dob: 04/15/1946
     └─ patientSex: 
     └─ medicalRecordNo: MA241216044603
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/22/2025', 'endOfEpisode': '06/20/2025', 'firstDiagnosis': 'M47.816', 'secondDiagnosis': 'M75.41', 'thirdDiagnosis': 'M17.0'}]
[15:31:44] 🔄 
🔄 Step 4: Extracting order data...
[15:31:47] ℹ️  Order extraction - MRN: 'MA241216044603'
[15:31:47] ℹ️  Order extraction - Sex: ''
[15:31:47] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[15:31:47] ℹ️  Order extraction - Payer Source: ''
[15:31:47] ✅ Order data extraction completed successfully
[15:31:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:31:47] ℹ️  Using MRN from patient data: 'MA241216044603' over 'MA241216044603'
[15:31:47] ⚠️  Could not determine sex using any available method
[15:31:47] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[15:31:47] ✅ Patient name cross-validation successful
[15:31:47] ✅    ✅ Data merged successfully
[15:31:49] ✅    ✅ Order data extracted and validated
[15:31:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:31:49] [DOC: 9273899] ✅ Patient found in local cache: Leonor Gomes, ID: 2f7fe652-20e0-42a4-9884-7cd4ba8861fa
[15:31:49] ✅    ✅ Existing patient found with ID: 2f7fe652-20e0-42a4-9884-7cd4ba8861fa
[15:31:49] 🔄 
🔄 Step 6: Pushing order to API...
[15:31:49] [DOC: 9273899] ℹ️  Pushing order via API for patient ID: 2f7fe652-20e0-42a4-9884-7cd4ba8861fa
[15:31:50] [DOC: 9273899] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13800"}
[15:31:50] ❌    ❌ Failed to push order
[15:31:50] 🔄 
🔄 Step 7: Writing to CSV...
[15:31:50] [DOC: 9273899] ℹ️  Calculated age: 79 from DOB: 04/15/1946
[15:31:50] [DOC: 9273899] ℹ️  Service Line extracted: 'Physical Therapy'
[15:31:50] [DOC: 9273899] ℹ️  Payer Source extracted: ''
[15:31:50] [DOC: 9273899] ℹ️  Diagnosis codes being written:
[15:31:50] [DOC: 9273899] ℹ️    - Latest_Episode_Firstdiagnosis: 'M47.816'
[15:31:50] [DOC: 9273899] ℹ️    - Latest_Episode_Seconddiagnosis: 'M75.41'
[15:31:50] [DOC: 9273899] ℹ️    - Latest_Episode_Thirddiagnosis: 'M17.0'
[15:31:50] [DOC: 9273899] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:31:50] [DOC: 9273899] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:31:50] [DOC: 9273899] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:31:50] [DOC: 9273899] ✅ Patient data written to CSV: Leonor Gomes | Sex:  | Age: 79 | Service: Physical Therapy | Payer:  | MRN: MA241216044603
[15:31:50] ✅    ✅ Document 9273899 processed and saved successfully
[15:31:50] 🔄 
🔄 Step 8: Saving API details...
[15:31:50] [DOC: 9273899] ℹ️  API push details saved for document 9273899
[15:31:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9273162                         ║
================================================================================
[15:31:50] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:31:50] ℹ️  Date: 05/02/2025
[15:31:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:31:52] [DOC: 9273162] ✅ Text extracted using pdfplumber (1605 chars)
[15:31:52] ✅    ✅ Text extracted using pdfplumber (1605 chars)
[15:31:52] 🔄 
🔄 Step 2: Extracting patient data...
[15:31:55] ℹ️  AI extracted raw sex value: ''
[15:31:55] ℹ️  AI extracted service line: 'Physical Therapy'
[15:31:55] ℹ️  AI extracted payer source: ''
[15:31:55] ℹ️  AI extracted diagnoses:
[15:31:55] ℹ️    - Diagnosis 1: 'J44.0'
[15:31:55] ℹ️    - Diagnosis 2: 'J15.8'
[15:31:55] ℹ️    - Diagnosis 3: 'A41.3'
[15:31:55] ℹ️    - Diagnosis 4: 'None'
[15:31:55] ℹ️    - Diagnosis 5: 'None'
[15:31:55] ℹ️    - Diagnosis 6: 'None'
[15:31:55] ℹ️  Final extracted MRN: 'MA250203063802'
[15:31:55] ℹ️  Final extracted Sex: ''
[15:31:55] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:31:55] ℹ️  Final extracted Payer Source: ''
[15:31:55] ✅ Patient data extraction completed successfully
[15:31:55] ✅    ✅ Patient data extracted successfully
[15:31:55] 📊 Patient Response
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/19/2025', 'endOfEpisode': '06/17/2025', 'firstDiagnosis': 'J44.0', 'secondDiagnosis': 'J15.8', 'thirdDiagnosis': 'A41.3', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:31:55] ✅    ✅ Patient identified: Priscila Diaz
[15:31:55] ✅    ✅ Patient name validation passed
[15:31:55] 🔄 
🔄 Step 3: Processing patient dates...
[15:31:55] [DOC: 9273162] ℹ️  DOB normalized: 06/11/1938
[15:31:55] [DOC: 9273162] ℹ️  Episode startOfEpisode normalized: 04/19/2025
[15:31:55] [DOC: 9273162] ℹ️  Episode endOfEpisode normalized: 06/17/2025
[15:31:55] [DOC: 9273162] ✅ Patient date processing completed successfully
[15:31:55] ✅    ✅ Date processing completed
[15:31:55] 📊 Processed Patient Data
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/19/2025', 'endOfEpisode': '06/17/2025', 'firstDiagnosis': 'J44.0', 'secondDiagnosis': 'J15.8', 'thirdDiagnosis': 'A41.3'}]
[15:31:55] 🔄 
🔄 Step 4: Extracting order data...
[15:31:57] ℹ️  Order extraction - MRN: 'MA250203063802'
[15:31:57] ℹ️  Order extraction - Sex: ''
[15:31:57] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[15:31:57] ℹ️  Order extraction - Payer Source: ''
[15:31:57] ✅ Order data extraction completed successfully
[15:31:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:31:57] ℹ️  Using MRN from patient data: 'MA250203063802' over 'MA250203063802'
[15:31:57] ⚠️  Could not determine sex using any available method
[15:31:57] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[15:31:57] ✅ Patient name cross-validation successful
[15:31:57] ✅    ✅ Data merged successfully
[15:31:59] ✅    ✅ Order data extracted and validated
[15:31:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:32:07] [DOC: 9273162] ✅ Patient exists in API: Priscila Diaz, ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[15:32:07] ✅    ✅ Existing patient found with ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[15:32:07] 🔄 
🔄 Step 6: Pushing order to API...
[15:32:07] [DOC: 9273162] ℹ️  Pushing order via API for patient ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[15:32:08] [DOC: 9273162] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13862"}
[15:32:08] ❌    ❌ Failed to push order
[15:32:08] 🔄 
🔄 Step 7: Writing to CSV...
[15:32:08] [DOC: 9273162] ℹ️  Calculated age: 86 from DOB: 06/11/1938
[15:32:08] [DOC: 9273162] ℹ️  Service Line extracted: 'Physical Therapy'
[15:32:08] [DOC: 9273162] ℹ️  Payer Source extracted: ''
[15:32:08] [DOC: 9273162] ℹ️  Diagnosis codes being written:
[15:32:08] [DOC: 9273162] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.0'
[15:32:08] [DOC: 9273162] ℹ️    - Latest_Episode_Seconddiagnosis: 'J15.8'
[15:32:08] [DOC: 9273162] ℹ️    - Latest_Episode_Thirddiagnosis: 'A41.3'
[15:32:08] [DOC: 9273162] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:32:08] [DOC: 9273162] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:32:08] [DOC: 9273162] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:32:08] [DOC: 9273162] ✅ Patient data written to CSV: Priscila Diaz | Sex:  | Age: 86 | Service: Physical Therapy | Payer:  | MRN: MA250203063802
[15:32:08] ✅    ✅ Document 9273162 processed and saved successfully
[15:32:08] 🔄 
🔄 Step 8: Saving API details...
[15:32:08] [DOC: 9273162] ℹ️  API push details saved for document 9273162
[15:32:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9273158                         ║
================================================================================
[15:32:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:32:08] ℹ️  Date: 05/02/2025
[15:32:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:32:10] [DOC: 9273158] ✅ Text extracted using pdfplumber (1535 chars)
[15:32:10] ✅    ✅ Text extracted using pdfplumber (1535 chars)
[15:32:10] 🔄 
🔄 Step 2: Extracting patient data...
[15:32:13] ℹ️  AI extracted raw sex value: ''
[15:32:13] ℹ️  AI extracted service line: 'Occupational Therapy'
[15:32:13] ℹ️  AI extracted payer source: ''
[15:32:13] ℹ️  AI extracted diagnoses:
[15:32:13] ℹ️    - Diagnosis 1: 'J44.0'
[15:32:13] ℹ️    - Diagnosis 2: 'J15.8'
[15:32:13] ℹ️    - Diagnosis 3: 'A41.3'
[15:32:13] ℹ️    - Diagnosis 4: ''
[15:32:13] ℹ️    - Diagnosis 5: ''
[15:32:13] ℹ️    - Diagnosis 6: ''
[15:32:13] ℹ️  Final extracted MRN: 'MA250203063802'
[15:32:13] ℹ️  Final extracted Sex: ''
[15:32:13] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[15:32:13] ℹ️  Final extracted Payer Source: ''
[15:32:13] ✅ Patient data extraction completed successfully
[15:32:13] ✅    ✅ Patient data extracted successfully
[15:32:13] 📊 Patient Response
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/19/2025', 'endOfEpisode': '06/17/2025', 'firstDiagnosis': 'J44.0', 'secondDiagnosis': 'J15.8', 'thirdDiagnosis': 'A41.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:32:13] ✅    ✅ Patient identified: Priscila Diaz
[15:32:13] ✅    ✅ Patient name validation passed
[15:32:13] 🔄 
🔄 Step 3: Processing patient dates...
[15:32:13] [DOC: 9273158] ℹ️  DOB normalized: 06/11/1938
[15:32:13] [DOC: 9273158] ℹ️  Episode startOfEpisode normalized: 04/19/2025
[15:32:13] [DOC: 9273158] ℹ️  Episode endOfEpisode normalized: 06/17/2025
[15:32:13] [DOC: 9273158] ✅ Patient date processing completed successfully
[15:32:13] ✅    ✅ Date processing completed
[15:32:13] 📊 Processed Patient Data
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/19/2025', 'endOfEpisode': '06/17/2025', 'firstDiagnosis': 'J44.0', 'secondDiagnosis': 'J15.8', 'thirdDiagnosis': 'A41.3', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:32:13] 🔄 
🔄 Step 4: Extracting order data...
[15:32:16] ℹ️  Order extraction - MRN: 'MA250203063802'
[15:32:16] ℹ️  Order extraction - Sex: ''
[15:32:16] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[15:32:16] ℹ️  Order extraction - Payer Source: ''
[15:32:16] ✅ Order data extraction completed successfully
[15:32:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:32:16] ℹ️  Using MRN from patient data: 'MA250203063802' over 'MA250203063802'
[15:32:16] ⚠️  Could not determine sex using any available method
[15:32:16] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[15:32:16] ✅ Patient name cross-validation successful
[15:32:16] ✅    ✅ Data merged successfully
[15:32:17] ✅    ✅ Order data extracted and validated
[15:32:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:32:17] [DOC: 9273158] ✅ Patient found in local cache: Priscila Diaz, ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[15:32:17] ✅    ✅ Existing patient found with ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[15:32:17] 🔄 
🔄 Step 6: Pushing order to API...
[15:32:17] [DOC: 9273158] ℹ️  Pushing order via API for patient ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[15:32:18] [DOC: 9273158] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13864"}
[15:32:18] ❌    ❌ Failed to push order
[15:32:18] 🔄 
🔄 Step 7: Writing to CSV...
[15:32:18] [DOC: 9273158] ℹ️  Calculated age: 86 from DOB: 06/11/1938
[15:32:18] [DOC: 9273158] ℹ️  Service Line extracted: 'Occupational Therapy'
[15:32:18] [DOC: 9273158] ℹ️  Payer Source extracted: ''
[15:32:18] [DOC: 9273158] ℹ️  Diagnosis codes being written:
[15:32:18] [DOC: 9273158] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.0'
[15:32:18] [DOC: 9273158] ℹ️    - Latest_Episode_Seconddiagnosis: 'J15.8'
[15:32:18] [DOC: 9273158] ℹ️    - Latest_Episode_Thirddiagnosis: 'A41.3'
[15:32:18] [DOC: 9273158] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:32:18] [DOC: 9273158] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:32:18] [DOC: 9273158] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:32:18] [DOC: 9273158] ✅ Patient data written to CSV: Priscila Diaz | Sex:  | Age: 86 | Service: Occupational Therapy | Payer:  | MRN: MA250203063802
[15:32:18] ✅    ✅ Document 9273158 processed and saved successfully
[15:32:18] 🔄 
🔄 Step 8: Saving API details...
[15:32:18] [DOC: 9273158] ℹ️  API push details saved for document 9273158
[15:32:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9273156                         ║
================================================================================
[15:32:18] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:32:18] ℹ️  Date: 05/02/2025
[15:32:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:32:20] [DOC: 9273156] ✅ Text extracted using pdfplumber (12240 chars)
[15:32:20] ✅    ✅ Text extracted using pdfplumber (12240 chars)
[15:32:20] 🔄 
🔄 Step 2: Extracting patient data...
[15:32:23] ℹ️  AI extracted raw sex value: 'F'
[15:32:23] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:32:23] ℹ️  AI extracted payer source: 'SWH'
[15:32:23] ℹ️  AI extracted diagnoses:
[15:32:23] ℹ️    - Diagnosis 1: 'J44.0'
[15:32:23] ℹ️    - Diagnosis 2: 'J15.8'
[15:32:23] ℹ️    - Diagnosis 3: 'A41.3'
[15:32:23] ℹ️    - Diagnosis 4: 'A40.9'
[15:32:23] ℹ️    - Diagnosis 5: 'J96.00'
[15:32:23] ℹ️    - Diagnosis 6: 'I48.91'
[15:32:23] ℹ️  Final extracted MRN: 'MA250203063802'
[15:32:23] ℹ️  Final extracted Sex: 'FEMALE'
[15:32:23] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:32:23] ℹ️  Final extracted Payer Source: 'SWH'
[15:32:23] ✅ Patient data extraction completed successfully
[15:32:23] ✅    ✅ Patient data extracted successfully
[15:32:23] 📊 Patient Response
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: SOUZA, AILEEN MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 151 Rockway St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 817-7759
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '02/18/2025', 'startOfEpisode': '04/19/2025', 'endOfEpisode': '06/17/2025', 'firstDiagnosis': 'J44.0', 'secondDiagnosis': 'J15.8', 'thirdDiagnosis': 'A41.3', 'fourthDiagnosis': 'A40.9', 'fifthDiagnosis': 'J96.00', 'sixthDiagnosis': 'I48.91'}]
[15:32:23] ✅    ✅ Patient identified: Priscila Diaz
[15:32:23] ✅    ✅ Patient name validation passed
[15:32:23] 🔄 
🔄 Step 3: Processing patient dates...
[15:32:23] [DOC: 9273156] ℹ️  DOB normalized: 06/11/1938
[15:32:23] [DOC: 9273156] ℹ️  Episode startOfCare normalized: 02/18/2025
[15:32:23] [DOC: 9273156] ℹ️  Episode startOfEpisode normalized: 04/19/2025
[15:32:23] [DOC: 9273156] ℹ️  Episode endOfEpisode normalized: 06/17/2025
[15:32:23] [DOC: 9273156] ✅ Patient date processing completed successfully
[15:32:23] ✅    ✅ Date processing completed
[15:32:23] 📊 Processed Patient Data
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: SOUZA, AILEEN MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 151 Rockway St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 817-7759
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '02/18/2025', 'startOfEpisode': '04/19/2025', 'endOfEpisode': '06/17/2025', 'firstDiagnosis': 'J44.0', 'secondDiagnosis': 'J15.8', 'thirdDiagnosis': 'A41.3', 'fourthDiagnosis': 'A40.9', 'fifthDiagnosis': 'J96.00', 'sixthDiagnosis': 'I48.91'}]
[15:32:23] 🔄 
🔄 Step 4: Extracting order data...
[15:32:26] ℹ️  Order extraction - MRN: 'MA250203063802'
[15:32:26] ℹ️  Order extraction - Sex: 'FEMALE'
[15:32:26] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:32:26] ℹ️  Order extraction - Payer Source: 'SWH'
[15:32:26] ✅ Order data extraction completed successfully
[15:32:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:32:26] ℹ️  Using MRN from patient data: 'MA250203063802' over 'MA250203063802'
[15:32:26] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:32:26] ℹ️  Payer source consistent in both sources: 'SWH'
[15:32:26] ✅ Patient name cross-validation successful
[15:32:26] ✅    ✅ Data merged successfully
[15:32:28] ✅    ✅ Order data extracted and validated
[15:32:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:32:28] [DOC: 9273156] ✅ Patient found in local cache: Priscila Diaz, ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[15:32:28] ✅    ✅ Existing patient found with ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[15:32:28] 🔄 
🔄 Step 6: Pushing order to API...
[15:32:28] [DOC: 9273156] ℹ️  Pushing order via API for patient ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[15:32:29] [DOC: 9273156] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13865"}
[15:32:29] ❌    ❌ Failed to push order
[15:32:29] 🔄 
🔄 Step 7: Writing to CSV...
[15:32:29] [DOC: 9273156] ℹ️  Calculated age: 86 from DOB: 06/11/1938
[15:32:29] [DOC: 9273156] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:32:29] [DOC: 9273156] ℹ️  Payer Source extracted: 'SWH'
[15:32:29] [DOC: 9273156] ℹ️  Diagnosis codes being written:
[15:32:29] [DOC: 9273156] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.0'
[15:32:29] [DOC: 9273156] ℹ️    - Latest_Episode_Seconddiagnosis: 'J15.8'
[15:32:29] [DOC: 9273156] ℹ️    - Latest_Episode_Thirddiagnosis: 'A41.3'
[15:32:29] [DOC: 9273156] ℹ️    - Latest_Episode_Fourthdiagnosis: 'A40.9'
[15:32:29] [DOC: 9273156] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J96.00'
[15:32:29] [DOC: 9273156] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I48.91'
[15:32:29] [DOC: 9273156] ✅ Patient data written to CSV: Priscila Diaz | Sex: FEMALE | Age: 86 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: SWH | MRN: MA250203063802
[15:32:29] ✅    ✅ Document 9273156 processed and saved successfully
[15:32:29] 🔄 
🔄 Step 8: Saving API details...
[15:32:29] [DOC: 9273156] ℹ️  API push details saved for document 9273156
[15:32:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9273152                         ║
================================================================================
[15:32:29] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:32:29] ℹ️  Date: 05/02/2025
[15:32:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:32:31] [DOC: 9273152] ✅ Text extracted using pdfplumber (3310 chars)
[15:32:31] ✅    ✅ Text extracted using pdfplumber (3310 chars)
[15:32:31] 🔄 
🔄 Step 2: Extracting patient data...
[15:32:34] ℹ️  AI extracted raw sex value: ''
[15:32:34] ℹ️  AI extracted service line: 'Physical Therapy'
[15:32:34] ℹ️  AI extracted payer source: ''
[15:32:34] ℹ️  AI extracted diagnoses:
[15:32:34] ℹ️    - Diagnosis 1: 'J44.0'
[15:32:34] ℹ️    - Diagnosis 2: 'J15.8'
[15:32:34] ℹ️    - Diagnosis 3: 'A41.3'
[15:32:34] ℹ️    - Diagnosis 4: 'None'
[15:32:34] ℹ️    - Diagnosis 5: 'None'
[15:32:34] ℹ️    - Diagnosis 6: 'None'
[15:32:34] ℹ️  Final extracted MRN: 'MA250203063802'
[15:32:34] ℹ️  Final extracted Sex: ''
[15:32:34] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:32:34] ℹ️  Final extracted Payer Source: ''
[15:32:34] ✅ Patient data extraction completed successfully
[15:32:34] ✅    ✅ Patient data extracted successfully
[15:32:34] 📊 Patient Response
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'J44.0', 'secondDiagnosis': 'J15.8', 'thirdDiagnosis': 'A41.3', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:32:34] ✅    ✅ Patient identified: Priscila Diaz
[15:32:34] ✅    ✅ Patient name validation passed
[15:32:34] 🔄 
🔄 Step 3: Processing patient dates...
[15:32:34] [DOC: 9273152] ℹ️  DOB normalized: 06/11/1938
[15:32:34] [DOC: 9273152] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[15:32:34] [DOC: 9273152] ℹ️  Episode endOfEpisode normalized: 04/18/2025
[15:32:34] [DOC: 9273152] ✅ Patient date processing completed successfully
[15:32:34] ✅    ✅ Date processing completed
[15:32:34] 📊 Processed Patient Data
     └─ patientFName: Priscila
     └─ patientLName: Diaz
     └─ dob: 06/11/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA250203063802
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': 'J44.0', 'secondDiagnosis': 'J15.8', 'thirdDiagnosis': 'A41.3'}]
[15:32:34] 🔄 
🔄 Step 4: Extracting order data...
[15:32:37] ℹ️  Order extraction - MRN: 'MA250203063802'
[15:32:37] ℹ️  Order extraction - Sex: ''
[15:32:37] ℹ️  Order extraction - Service Line: 'PT'
[15:32:37] ℹ️  Order extraction - Payer Source: ''
[15:32:37] ✅ Order data extraction completed successfully
[15:32:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:32:37] ℹ️  Using MRN from patient data: 'MA250203063802' over 'MA250203063802'
[15:32:37] ⚠️  Could not determine sex using any available method
[15:32:37] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[15:32:37] ✅ Patient name cross-validation successful
[15:32:37] ✅    ✅ Data merged successfully
[15:32:38] ✅    ✅ Order data extracted and validated
[15:32:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:32:38] [DOC: 9273152] ✅ Patient found in local cache: Priscila Diaz, ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[15:32:38] ✅    ✅ Existing patient found with ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[15:32:38] 🔄 
🔄 Step 6: Pushing order to API...
[15:32:38] [DOC: 9273152] ℹ️  Pushing order via API for patient ID: bf0b26ec-d3e8-461a-b0d6-329cae009b94
[15:32:39] [DOC: 9273152] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13867"}
[15:32:39] ❌    ❌ Failed to push order
[15:32:39] 🔄 
🔄 Step 7: Writing to CSV...
[15:32:39] [DOC: 9273152] ℹ️  Calculated age: 86 from DOB: 06/11/1938
[15:32:39] [DOC: 9273152] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[15:32:39] [DOC: 9273152] ℹ️  Payer Source extracted: ''
[15:32:39] [DOC: 9273152] ℹ️  Diagnosis codes being written:
[15:32:39] [DOC: 9273152] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.0'
[15:32:39] [DOC: 9273152] ℹ️    - Latest_Episode_Seconddiagnosis: 'J15.8'
[15:32:39] [DOC: 9273152] ℹ️    - Latest_Episode_Thirddiagnosis: 'A41.3'
[15:32:39] [DOC: 9273152] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:32:39] [DOC: 9273152] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:32:39] [DOC: 9273152] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:32:39] [DOC: 9273152] ✅ Patient data written to CSV: Priscila Diaz | Sex:  | Age: 86 | Service: PT, Physical Therapy | Payer:  | MRN: MA250203063802
[15:32:39] ✅    ✅ Document 9273152 processed and saved successfully
[15:32:39] 🔄 
🔄 Step 8: Saving API details...
[15:32:39] [DOC: 9273152] ℹ️  API push details saved for document 9273152
[15:32:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9273110                         ║
================================================================================
[15:32:39] ℹ️  Agency: AccentCare Fall River
[15:32:39] ℹ️  Date: 05/02/2025
[15:32:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:32:41] [DOC: 9273110] ✅ Text extracted using pdfplumber (1628 chars)
[15:32:41] ✅    ✅ Text extracted using pdfplumber (1628 chars)
[15:32:41] 🔄 
🔄 Step 2: Extracting patient data...
[15:32:44] ℹ️  AI extracted raw sex value: ''
[15:32:44] ℹ️  AI extracted service line: 'Nursing'
[15:32:44] ℹ️  AI extracted payer source: ''
[15:32:44] ℹ️  AI extracted diagnoses:
[15:32:44] ℹ️    - Diagnosis 1: ''
[15:32:44] ℹ️    - Diagnosis 2: ''
[15:32:44] ℹ️    - Diagnosis 3: ''
[15:32:44] ℹ️    - Diagnosis 4: ''
[15:32:44] ℹ️    - Diagnosis 5: ''
[15:32:44] ℹ️    - Diagnosis 6: ''
[15:32:44] ℹ️  Final extracted MRN: 'C0200237232301'
[15:32:44] ℹ️  Final extracted Sex: ''
[15:32:44] ℹ️  Final extracted Service Line: 'Nursing'
[15:32:44] ℹ️  Final extracted Payer Source: ''
[15:32:44] ✅ Patient data extraction completed successfully
[15:32:44] ✅    ✅ Patient data extracted successfully
[15:32:44] 📊 Patient Response
     └─ patientFName: MILO
     └─ patientLName: WEBSTER
     └─ dob: 07/21/1959
     └─ patientSex: 
     └─ medicalRecordNo: C0200237232301
     └─ billingProvider: JORDAN GULAREK, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:32:44] ✅    ✅ Patient identified: MILO WEBSTER
[15:32:44] ✅    ✅ Patient name validation passed
[15:32:44] 🔄 
🔄 Step 3: Processing patient dates...
[15:32:44] [DOC: 9273110] ℹ️  DOB normalized: 07/21/1959
[15:32:44] [DOC: 9273110] ✅ Patient date processing completed successfully
[15:32:44] ✅    ✅ Date processing completed
[15:32:44] 📊 Processed Patient Data
     └─ patientFName: MILO
     └─ patientLName: WEBSTER
     └─ dob: 07/21/1959
     └─ patientSex: 
     └─ medicalRecordNo: C0200237232301
     └─ billingProvider: JORDAN GULAREK, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:32:44] 🔄 
🔄 Step 4: Extracting order data...
[15:32:46] ℹ️  Order extraction - MRN: 'C0200237232301'
[15:32:46] ℹ️  Order extraction - Sex: ''
[15:32:46] ℹ️  Order extraction - Service Line: ''
[15:32:46] ℹ️  Order extraction - Payer Source: ''
[15:32:46] ✅ Order data extraction completed successfully
[15:32:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:32:46] ℹ️  Using MRN from patient data: 'C0200237232301' over 'C0200237232301'
[15:32:46] ⚠️  Could not determine sex using any available method
[15:32:46] ℹ️  Using service line from patient data: 'Nursing'
[15:32:46] ✅ Patient name cross-validation successful
[15:32:46] ✅    ✅ Data merged successfully
[15:32:48] ✅    ✅ Order data extracted and validated
[15:32:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:32:48] [DOC: 9273110] ✅ Patient found in local cache: MILO WEBSTER, ID: 695c5703-e477-4b11-a055-202369179483
[15:32:48] ✅    ✅ Existing patient found with ID: 695c5703-e477-4b11-a055-202369179483
[15:32:48] 🔄 
🔄 Step 6: Pushing order to API...
[15:32:48] [DOC: 9273110] ℹ️  Pushing order via API for patient ID: 695c5703-e477-4b11-a055-202369179483
[15:32:49] [DOC: 9273110] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14417"}
[15:32:49] ❌    ❌ Failed to push order
[15:32:49] 🔄 
🔄 Step 7: Writing to CSV...
[15:32:49] [DOC: 9273110] ℹ️  Calculated age: 65 from DOB: 07/21/1959
[15:32:49] [DOC: 9273110] ℹ️  Service Line extracted: 'Nursing'
[15:32:49] [DOC: 9273110] ℹ️  Payer Source extracted: ''
[15:32:49] [DOC: 9273110] ℹ️  Diagnosis codes being written:
[15:32:49] [DOC: 9273110] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:32:49] [DOC: 9273110] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:32:49] [DOC: 9273110] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:32:49] [DOC: 9273110] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:32:49] [DOC: 9273110] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:32:49] [DOC: 9273110] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:32:49] [DOC: 9273110] ✅ Patient data written to CSV: MILO WEBSTER | Sex:  | Age: 65 | Service: Nursing | Payer:  | MRN: C0200237232301
[15:32:49] ✅    ✅ Document 9273110 processed and saved successfully
[15:32:49] 🔄 
🔄 Step 8: Saving API details...
[15:32:49] [DOC: 9273110] ℹ️  API push details saved for document 9273110
[15:32:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9273103                         ║
================================================================================
[15:32:49] ℹ️  Agency: Compassionate Care Hospice-Taunton
[15:32:49] ℹ️  Date: 05/02/2025
[15:32:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:32:51] [DOC: 9273103] ✅ Text extracted using pdfplumber (1185 chars)
[15:32:51] ✅    ✅ Text extracted using pdfplumber (1173 chars)
[15:32:51] 🔄 
🔄 Step 2: Extracting patient data...
[15:32:54] ℹ️  AI extracted raw sex value: ''
[15:32:54] ℹ️  AI extracted service line: ''
[15:32:54] ℹ️  AI extracted payer source: 'Medicare'
[15:32:54] ℹ️  AI extracted diagnoses:
[15:32:54] ℹ️    - Diagnosis 1: ''
[15:32:54] ℹ️    - Diagnosis 2: ''
[15:32:54] ℹ️    - Diagnosis 3: ''
[15:32:54] ℹ️    - Diagnosis 4: ''
[15:32:54] ℹ️    - Diagnosis 5: ''
[15:32:54] ℹ️    - Diagnosis 6: ''
[15:32:54] ℹ️  Final extracted MRN: 'B3700365065902'
[15:32:54] ℹ️  Final extracted Sex: ''
[15:32:54] ℹ️  Final extracted Service Line: ''
[15:32:54] ℹ️  Final extracted Payer Source: 'Medicare'
[15:32:54] ✅ Patient data extraction completed successfully
[15:32:54] ✅    ✅ Patient data extracted successfully
[15:32:54] 📊 Patient Response
     └─ patientFName: RICHARD
     └─ patientLName: SIMMONS
     └─ dob: 03/28/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700365065902
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: 
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:32:54] ✅    ✅ Patient identified: RICHARD SIMMONS
[15:32:54] ✅    ✅ Patient name validation passed
[15:32:54] 🔄 
🔄 Step 3: Processing patient dates...
[15:32:54] [DOC: 9273103] ℹ️  DOB normalized: 03/28/1931
[15:32:54] [DOC: 9273103] ✅ Patient date processing completed successfully
[15:32:54] ✅    ✅ Date processing completed
[15:32:54] 📊 Processed Patient Data
     └─ patientFName: RICHARD
     └─ patientLName: SIMMONS
     └─ dob: 03/28/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700365065902
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: 
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:32:54] 🔄 
🔄 Step 4: Extracting order data...
[15:32:56] ℹ️  Order extraction - MRN: 'B3700365065902'
[15:32:56] ℹ️  Order extraction - Sex: ''
[15:32:56] ℹ️  Order extraction - Service Line: ''
[15:32:56] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:32:56] ✅ Order data extraction completed successfully
[15:32:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:32:56] ℹ️  Using MRN from patient data: 'B3700365065902' over 'B3700365065902'
[15:32:56] ℹ️  Inferred sex as MALE from name: RICHARD
[15:32:56] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:32:56] ✅ Patient name cross-validation successful
[15:32:56] ✅    ✅ Data merged successfully
[15:32:57] ✅    ✅ Order data extracted and validated
[15:32:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:33:02] [DOC: 9273103] ✅ Patient exists in API: RICHARD SIMMONS, ID: fb13de4e-e12b-487b-9527-fa575e9f8c29
[15:33:02] ✅    ✅ Existing patient found with ID: fb13de4e-e12b-487b-9527-fa575e9f8c29
[15:33:02] 🔄 
🔄 Step 6: Pushing order to API...
[15:33:02] [DOC: 9273103] ℹ️  Pushing order via API for patient ID: fb13de4e-e12b-487b-9527-fa575e9f8c29
[15:33:03] [DOC: 9273103] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14430"}
[15:33:03] ❌    ❌ Failed to push order
[15:33:03] 🔄 
🔄 Step 7: Writing to CSV...
[15:33:03] [DOC: 9273103] ℹ️  Calculated age: 94 from DOB: 03/28/1931
[15:33:03] [DOC: 9273103] ℹ️  Service Line extracted: ''
[15:33:03] [DOC: 9273103] ℹ️  Payer Source extracted: 'Medicare'
[15:33:03] [DOC: 9273103] ℹ️  Diagnosis codes being written:
[15:33:03] [DOC: 9273103] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:33:03] [DOC: 9273103] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:33:03] [DOC: 9273103] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:33:03] [DOC: 9273103] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:33:03] [DOC: 9273103] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:33:03] [DOC: 9273103] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:33:03] [DOC: 9273103] ✅ Patient data written to CSV: RICHARD SIMMONS | Sex: MALE | Age: 94 | Service:  | Payer: Medicare | MRN: B3700365065902
[15:33:03] ✅    ✅ Document 9273103 processed and saved successfully
[15:33:03] 🔄 
🔄 Step 8: Saving API details...
[15:33:03] [DOC: 9273103] ℹ️  API push details saved for document 9273103
[15:33:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9273095                         ║
================================================================================
[15:33:03] ℹ️  Agency: Compassionate Care Hospice-Taunton
[15:33:03] ℹ️  Date: 05/02/2025
[15:33:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:33:05] [DOC: 9273095] ✅ Text extracted using pdfplumber (1588 chars)
[15:33:05] ✅    ✅ Text extracted using pdfplumber (1576 chars)
[15:33:05] 🔄 
🔄 Step 2: Extracting patient data...
[15:33:07] ℹ️  AI extracted raw sex value: ''
[15:33:07] ℹ️  AI extracted service line: 'Hospice'
[15:33:07] ℹ️  AI extracted payer source: 'Medicare'
[15:33:07] ℹ️  AI extracted diagnoses:
[15:33:07] ℹ️    - Diagnosis 1: ''
[15:33:07] ℹ️    - Diagnosis 2: ''
[15:33:07] ℹ️    - Diagnosis 3: ''
[15:33:07] ℹ️    - Diagnosis 4: ''
[15:33:07] ℹ️    - Diagnosis 5: ''
[15:33:07] ℹ️    - Diagnosis 6: ''
[15:33:07] ℹ️  Final extracted MRN: 'B3700296223202'
[15:33:07] ℹ️  Final extracted Sex: ''
[15:33:07] ℹ️  Final extracted Service Line: 'Hospice'
[15:33:07] ℹ️  Final extracted Payer Source: 'Medicare'
[15:33:07] ✅ Patient data extraction completed successfully
[15:33:07] ✅    ✅ Patient data extracted successfully
[15:33:07] 📊 Patient Response
     └─ patientFName: MARIA
     └─ patientLName: JARDIM
     └─ dob: 05/20/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700296223202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:33:07] ✅    ✅ Patient identified: MARIA JARDIM
[15:33:07] ✅    ✅ Patient name validation passed
[15:33:07] 🔄 
🔄 Step 3: Processing patient dates...
[15:33:07] [DOC: 9273095] ℹ️  DOB normalized: 05/20/1931
[15:33:07] [DOC: 9273095] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[15:33:07] [DOC: 9273095] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[15:33:07] [DOC: 9273095] ✅ Patient date processing completed successfully
[15:33:07] ✅    ✅ Date processing completed
[15:33:07] 📊 Processed Patient Data
     └─ patientFName: MARIA
     └─ patientLName: JARDIM
     └─ dob: 05/20/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700296223202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:33:07] 🔄 
🔄 Step 4: Extracting order data...
[15:33:10] ℹ️  Order extraction - MRN: 'B3700296223202'
[15:33:10] ℹ️  Order extraction - Sex: ''
[15:33:10] ℹ️  Order extraction - Service Line: 'Hospice'
[15:33:10] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:33:10] ✅ Order data extraction completed successfully
[15:33:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:33:10] ℹ️  Using MRN from patient data: 'B3700296223202' over 'B3700296223202'
[15:33:10] ℹ️  Inferred sex as FEMALE from name: MARIA
[15:33:10] ℹ️  Service line consistent in both sources: 'Hospice'
[15:33:10] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:33:10] ✅ Patient name cross-validation successful
[15:33:10] ✅    ✅ Data merged successfully
[15:33:11] ✅    ✅ Order data extracted and validated
[15:33:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:33:11] [DOC: 9273095] ✅ Patient found in local cache: MARIA JARDIM, ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[15:33:11] ✅    ✅ Existing patient found with ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[15:33:11] 🔄 
🔄 Step 6: Pushing order to API...
[15:33:11] [DOC: 9273095] ℹ️  Pushing order via API for patient ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[15:33:12] [DOC: 9273095] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14518"}
[15:33:12] ❌    ❌ Failed to push order
[15:33:12] 🔄 
🔄 Step 7: Writing to CSV...
[15:33:12] [DOC: 9273095] ℹ️  Calculated age: 94 from DOB: 05/20/1931
[15:33:12] [DOC: 9273095] ℹ️  Service Line extracted: 'Hospice'
[15:33:12] [DOC: 9273095] ℹ️  Payer Source extracted: 'Medicare'
[15:33:12] [DOC: 9273095] ℹ️  Diagnosis codes being written:
[15:33:12] [DOC: 9273095] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:33:12] [DOC: 9273095] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:33:12] [DOC: 9273095] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:33:12] [DOC: 9273095] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:33:12] [DOC: 9273095] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:33:12] [DOC: 9273095] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:33:12] [DOC: 9273095] ✅ Patient data written to CSV: MARIA JARDIM | Sex: FEMALE | Age: 94 | Service: Hospice | Payer: Medicare | MRN: B3700296223202
[15:33:12] ✅    ✅ Document 9273095 processed and saved successfully
[15:33:12] 🔄 
🔄 Step 8: Saving API details...
[15:33:12] [DOC: 9273095] ℹ️  API push details saved for document 9273095
[15:33:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9273092                         ║
================================================================================
[15:33:12] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:33:12] ℹ️  Date: 05/02/2025
[15:33:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:33:14] [DOC: 9273092] ✅ Text extracted using pdfplumber (14660 chars)
[15:33:14] ✅    ✅ Text extracted using pdfplumber (14648 chars)
[15:33:14] 🔄 
🔄 Step 2: Extracting patient data...
[15:33:18] ℹ️  AI extracted raw sex value: 'M'
[15:33:18] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[15:33:18] ℹ️  AI extracted payer source: 'Medicare'
[15:33:18] ℹ️  AI extracted diagnoses:
[15:33:18] ℹ️    - Diagnosis 1: 'I10'
[15:33:18] ℹ️    - Diagnosis 2: 'I50.30'
[15:33:18] ℹ️    - Diagnosis 3: 'E11.22'
[15:33:18] ℹ️    - Diagnosis 4: 'E11.65'
[15:33:18] ℹ️    - Diagnosis 5: 'N18.32'
[15:33:18] ℹ️    - Diagnosis 6: 'Z79.4'
[15:33:18] ℹ️  Final extracted MRN: 'MA250328034304'
[15:33:18] ℹ️  Final extracted Sex: 'MALE'
[15:33:18] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[15:33:18] ℹ️  Final extracted Payer Source: 'Medicare'
[15:33:18] ✅ Patient data extraction completed successfully
[15:33:18] ✅    ✅ Patient data extracted successfully
[15:33:18] 📊 Patient Response
     └─ patientFName: Frederick
     └─ patientLName: Turner
     └─ dob: 03/05/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250328034304
     └─ billingProvider: WILL, CHRISTINE MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 231 Middle St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (774) 473-7945
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I50.30', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'E11.65', 'fifthDiagnosis': 'N18.32', 'sixthDiagnosis': 'Z79.4'}]
[15:33:18] ✅    ✅ Patient identified: Frederick Turner
[15:33:18] ✅    ✅ Patient name validation passed
[15:33:18] 🔄 
🔄 Step 3: Processing patient dates...
[15:33:18] [DOC: 9273092] ℹ️  DOB normalized: 03/05/1943
[15:33:18] [DOC: 9273092] ℹ️  Episode startOfCare normalized: 04/01/2025
[15:33:18] [DOC: 9273092] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[15:33:18] [DOC: 9273092] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[15:33:18] [DOC: 9273092] ✅ Patient date processing completed successfully
[15:33:18] ✅    ✅ Date processing completed
[15:33:18] 📊 Processed Patient Data
     └─ patientFName: Frederick
     └─ patientLName: Turner
     └─ dob: 03/05/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250328034304
     └─ billingProvider: WILL, CHRISTINE MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 231 Middle St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (774) 473-7945
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I50.30', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'E11.65', 'fifthDiagnosis': 'N18.32', 'sixthDiagnosis': 'Z79.4'}]
[15:33:18] 🔄 
🔄 Step 4: Extracting order data...
[15:33:20] ℹ️  Order extraction - MRN: 'MA250328034304'
[15:33:20] ℹ️  Order extraction - Sex: 'MALE'
[15:33:20] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[15:33:20] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:33:20] ✅ Order data extraction completed successfully
[15:33:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:33:20] ℹ️  Using MRN from patient data: 'MA250328034304' over 'MA250328034304'
[15:33:20] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[15:33:20] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:33:20] ✅ Patient name cross-validation successful
[15:33:20] ✅    ✅ Data merged successfully
[15:33:22] ✅    ✅ Order data extracted and validated
[15:33:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:33:40] [DOC: 9273092] ✅ Patient exists in API: Frederick Turner, ID: fda2b6f0-d47f-42d2-9704-28476b119573
[15:33:40] ✅    ✅ Existing patient found with ID: fda2b6f0-d47f-42d2-9704-28476b119573
[15:33:40] 🔄 
🔄 Step 6: Pushing order to API...
[15:33:40] [DOC: 9273092] ℹ️  Pushing order via API for patient ID: fda2b6f0-d47f-42d2-9704-28476b119573
[15:33:41] [DOC: 9273092] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14247"}
[15:33:41] ❌    ❌ Failed to push order
[15:33:41] 🔄 
🔄 Step 7: Writing to CSV...
[15:33:41] [DOC: 9273092] ℹ️  Calculated age: 82 from DOB: 03/05/1943
[15:33:41] [DOC: 9273092] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[15:33:41] [DOC: 9273092] ℹ️  Payer Source extracted: 'Medicare'
[15:33:41] [DOC: 9273092] ℹ️  Diagnosis codes being written:
[15:33:41] [DOC: 9273092] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[15:33:41] [DOC: 9273092] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.30'
[15:33:41] [DOC: 9273092] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[15:33:41] [DOC: 9273092] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.65'
[15:33:41] [DOC: 9273092] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.32'
[15:33:41] [DOC: 9273092] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z79.4'
[15:33:41] [DOC: 9273092] ✅ Patient data written to CSV: Frederick Turner | Sex: MALE | Age: 82 | Service: Skilled Nursing, Physical Therapy | Payer: Medicare | MRN: MA250328034304
[15:33:41] ✅    ✅ Document 9273092 processed and saved successfully
[15:33:41] 🔄 
🔄 Step 8: Saving API details...
[15:33:41] [DOC: 9273092] ℹ️  API push details saved for document 9273092
[15:33:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9273014                         ║
================================================================================
[15:33:41] ℹ️  Agency: Fairhaven HH&H
[15:33:41] ℹ️  Date: 05/02/2025
[15:33:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:33:43] [DOC: 9273014] ✅ Text extracted using pdfplumber (1748 chars)
[15:33:43] ✅    ✅ Text extracted using pdfplumber (1748 chars)
[15:33:43] 🔄 
🔄 Step 2: Extracting patient data...
[15:33:46] ℹ️  AI extracted raw sex value: 'F'
[15:33:46] ℹ️  AI extracted service line: 'Hospice'
[15:33:46] ℹ️  AI extracted payer source: 'Medicare'
[15:33:46] ℹ️  AI extracted diagnoses:
[15:33:46] ℹ️    - Diagnosis 1: 'None'
[15:33:46] ℹ️    - Diagnosis 2: 'None'
[15:33:46] ℹ️    - Diagnosis 3: 'None'
[15:33:46] ℹ️    - Diagnosis 4: 'None'
[15:33:46] ℹ️    - Diagnosis 5: 'None'
[15:33:46] ℹ️    - Diagnosis 6: 'None'
[15:33:46] ℹ️  Final extracted MRN: '5782009'
[15:33:46] ℹ️  Final extracted Sex: 'FEMALE'
[15:33:46] ℹ️  Final extracted Service Line: 'Hospice'
[15:33:46] ℹ️  Final extracted Payer Source: 'Medicare'
[15:33:46] ✅ Patient data extraction completed successfully
[15:33:46] ✅    ✅ Patient data extracted successfully
[15:33:46] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Foster
     └─ dob: 06/16/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5782009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/23/2022', 'startOfEpisode': None, 'endOfEpisode': '06/09/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:33:46] ✅    ✅ Patient identified: Patricia Foster
[15:33:46] ✅    ✅ Patient name validation passed
[15:33:46] 🔄 
🔄 Step 3: Processing patient dates...
[15:33:46] [DOC: 9273014] ℹ️  DOB normalized: 06/16/1931
[15:33:46] [DOC: 9273014] ℹ️  Episode startOfCare normalized: 12/23/2022
[15:33:46] [DOC: 9273014] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[15:33:46] [DOC: 9273014] ✅ Patient date processing completed successfully
[15:33:46] ✅    ✅ Date processing completed
[15:33:46] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Foster
     └─ dob: 06/16/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5782009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/23/2022', 'endOfEpisode': '06/09/2025'}]
[15:33:46] 🔄 
🔄 Step 4: Extracting order data...
[15:33:48] ℹ️  Order extraction - MRN: '5782009'
[15:33:48] ℹ️  Order extraction - Sex: 'FEMALE'
[15:33:48] ℹ️  Order extraction - Service Line: 'Hospice'
[15:33:48] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:33:48] ✅ Order data extraction completed successfully
[15:33:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:33:48] ℹ️  Using MRN from patient data: '5782009' over '5782009'
[15:33:48] ℹ️  Service line consistent in both sources: 'Hospice'
[15:33:48] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:33:48] ✅ Patient name cross-validation successful
[15:33:48] ✅    ✅ Data merged successfully
[15:33:49] ✅    ✅ Order data extracted and validated
[15:33:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:33:49] [DOC: 9273014] ✅ Patient found in local cache: Patricia Foster, ID: 02cfc02d-5153-4681-bdd5-391d0e7448c5
[15:33:49] ✅    ✅ Existing patient found with ID: 02cfc02d-5153-4681-bdd5-391d0e7448c5
[15:33:49] 🔄 
🔄 Step 6: Pushing order to API...
[15:33:49] [DOC: 9273014] ℹ️  Pushing order via API for patient ID: 02cfc02d-5153-4681-bdd5-391d0e7448c5
[15:33:50] [DOC: 9273014] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:33:50] ❌    ❌ Failed to push order
[15:33:50] 🔄 
🔄 Step 7: Writing to CSV...
[15:33:50] [DOC: 9273014] ℹ️  Calculated age: 93 from DOB: 06/16/1931
[15:33:50] [DOC: 9273014] ℹ️  Service Line extracted: 'Hospice'
[15:33:50] [DOC: 9273014] ℹ️  Payer Source extracted: 'Medicare'
[15:33:50] [DOC: 9273014] ℹ️  Diagnosis codes being written:
[15:33:50] [DOC: 9273014] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:33:50] [DOC: 9273014] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:33:50] [DOC: 9273014] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:33:50] [DOC: 9273014] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:33:50] [DOC: 9273014] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:33:50] [DOC: 9273014] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:33:50] [DOC: 9273014] ✅ Patient data written to CSV: Patricia Foster | Sex: FEMALE | Age: 93 | Service: Hospice | Payer: Medicare | MRN: 5782009
[15:33:50] ✅    ✅ Document 9273014 processed and saved successfully
[15:33:50] 🔄 
🔄 Step 8: Saving API details...
[15:33:50] [DOC: 9273014] ℹ️  API push details saved for document 9273014
[15:33:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9273011                         ║
================================================================================
[15:33:50] ℹ️  Agency: Fairhaven HH&H
[15:33:50] ℹ️  Date: 05/02/2025
[15:33:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:33:51] [DOC: 9273011] ❌ Critical failure in get_pdf_text: Invalid response format
[15:33:51] ❌ Failed to extract text for Doc ID 9273011
[15:33:51] [DOC: 9273011] ℹ️  API push details saved for document 9273011
================================================================================
║                        Processing Document ID: 9273008                         ║
================================================================================
[15:33:51] ℹ️  Agency: Dartmouth HH
[15:33:51] ℹ️  Date: 05/02/2025
[15:33:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:33:53] [DOC: 9273008] ✅ Text extracted using pdfplumber (1815 chars)
[15:33:53] ✅    ✅ Text extracted using pdfplumber (1815 chars)
[15:33:53] 🔄 
🔄 Step 2: Extracting patient data...
[15:33:56] ℹ️  AI extracted raw sex value: 'F'
[15:33:56] ℹ️  AI extracted service line: 'Skilled Nursing, HHA'
[15:33:56] ℹ️  AI extracted payer source: 'Medicare'
[15:33:56] ℹ️  AI extracted diagnoses:
[15:33:56] ℹ️    - Diagnosis 1: 'None'
[15:33:56] ℹ️    - Diagnosis 2: 'None'
[15:33:56] ℹ️    - Diagnosis 3: 'None'
[15:33:56] ℹ️    - Diagnosis 4: 'None'
[15:33:56] ℹ️    - Diagnosis 5: 'None'
[15:33:56] ℹ️    - Diagnosis 6: 'None'
[15:33:56] ℹ️  Final extracted MRN: '672008'
[15:33:56] ℹ️  Final extracted Sex: 'FEMALE'
[15:33:56] ℹ️  Final extracted Service Line: 'Skilled Nursing, HHA'
[15:33:56] ℹ️  Final extracted Payer Source: 'Medicare'
[15:33:56] ✅ Patient data extraction completed successfully
[15:33:56] ✅    ✅ Patient data extracted successfully
[15:33:56] 📊 Patient Response
     └─ patientFName: Jane
     └─ patientLName: Lonsdale
     └─ dob: 02/20/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 672008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:33:56] ✅    ✅ Patient identified: Jane Lonsdale
[15:33:56] ✅    ✅ Patient name validation passed
[15:33:56] 🔄 
🔄 Step 3: Processing patient dates...
[15:33:56] [DOC: 9273008] ℹ️  DOB normalized: 02/20/1930
[15:33:56] [DOC: 9273008] ℹ️  Episode startOfCare normalized: 03/09/2025
[15:33:56] [DOC: 9273008] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[15:33:56] [DOC: 9273008] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[15:33:56] [DOC: 9273008] ✅ Patient date processing completed successfully
[15:33:56] ✅    ✅ Date processing completed
[15:33:56] 📊 Processed Patient Data
     └─ patientFName: Jane
     └─ patientLName: Lonsdale
     └─ dob: 02/20/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 672008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025'}]
[15:33:56] 🔄 
🔄 Step 4: Extracting order data...
[15:33:58] ℹ️  Order extraction - MRN: ''
[15:33:58] ℹ️  Order extraction - Sex: 'FEMALE'
[15:33:58] ℹ️  Order extraction - Service Line: 'RN, HHA'
[15:33:58] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:33:58] ✅ Order data extraction completed successfully
[15:33:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:33:58] ℹ️  Using MRN from patient data: '672008'
[15:33:58] ℹ️  Combined service lines: Patient='Skilled Nursing, HHA' + Order='RN, HHA' = 'HHA, RN, Skilled Nursing'
[15:33:58] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:33:58] ✅ Patient name cross-validation successful
[15:33:58] ✅    ✅ Data merged successfully
[15:34:00] ✅    ✅ Order data extracted and validated
[15:34:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:34:15] [DOC: 9273008] ℹ️  Patient not found in cache or API: Jane Lonsdale
[15:34:15] [DOC: 9273008] ℹ️  Patient not found, creating new patient via API...
[15:34:15] [DOC: 9273008] ℹ️  Creating patient via API: Jane Lonsdale
[15:34:16] [DOC: 9273008] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:34:16] ❌    ❌ Failed to create patient
[15:34:16] [DOC: 9273008] ℹ️  API push details saved for document 9273008
================================================================================
║                        Processing Document ID: 9273007                         ║
================================================================================
[15:34:16] ℹ️  Agency: Dartmouth HH
[15:34:16] ℹ️  Date: 05/02/2025
[15:34:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:34:18] [DOC: 9273007] ✅ Text extracted using pdfplumber (1399 chars)
[15:34:18] ✅    ✅ Text extracted using pdfplumber (1399 chars)
[15:34:18] 🔄 
🔄 Step 2: Extracting patient data...
[15:34:21] ℹ️  AI extracted raw sex value: 'M'
[15:34:21] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:34:21] ℹ️  AI extracted payer source: 'Medicare'
[15:34:21] ℹ️  AI extracted diagnoses:
[15:34:21] ℹ️    - Diagnosis 1: 'None'
[15:34:21] ℹ️    - Diagnosis 2: 'None'
[15:34:21] ℹ️    - Diagnosis 3: 'None'
[15:34:21] ℹ️    - Diagnosis 4: 'None'
[15:34:21] ℹ️    - Diagnosis 5: 'None'
[15:34:21] ℹ️    - Diagnosis 6: 'None'
[15:34:21] ℹ️  Final extracted MRN: '6208015'
[15:34:21] ℹ️  Final extracted Sex: 'MALE'
[15:34:21] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:34:21] ℹ️  Final extracted Payer Source: 'Medicare'
[15:34:21] ✅ Patient data extraction completed successfully
[15:34:21] ✅    ✅ Patient data extracted successfully
[15:34:21] 📊 Patient Response
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 6208015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:34:21] ✅    ✅ Patient identified: Stephen Hanna Jr,
[15:34:21] ✅    ✅ Patient name validation passed
[15:34:21] 🔄 
🔄 Step 3: Processing patient dates...
[15:34:21] [DOC: 9273007] ℹ️  DOB normalized: 03/11/1936
[15:34:21] [DOC: 9273007] ℹ️  Episode startOfCare normalized: 03/15/2025
[15:34:21] [DOC: 9273007] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[15:34:21] [DOC: 9273007] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[15:34:21] [DOC: 9273007] ✅ Patient date processing completed successfully
[15:34:21] ✅    ✅ Date processing completed
[15:34:21] 📊 Processed Patient Data
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 6208015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025'}]
[15:34:21] 🔄 
🔄 Step 4: Extracting order data...
[15:34:23] ℹ️  Order extraction - MRN: ''
[15:34:23] ℹ️  Order extraction - Sex: 'MALE'
[15:34:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:34:23] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:34:23] ✅ Order data extraction completed successfully
[15:34:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:34:23] ℹ️  Using MRN from patient data: '6208015'
[15:34:23] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:34:23] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:34:23] ✅ Patient name cross-validation successful
[15:34:23] ✅    ✅ Data merged successfully
[15:34:24] ✅    ✅ Order data extracted and validated
[15:34:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:34:24] [DOC: 9273007] ✅ Patient found in local cache: Stephen Hanna Jr,, ID: 38583918-d125-4291-a4c2-8551b1d02929
[15:34:24] ✅    ✅ Existing patient found with ID: 38583918-d125-4291-a4c2-8551b1d02929
[15:34:24] 🔄 
🔄 Step 6: Pushing order to API...
[15:34:24] [DOC: 9273007] ℹ️  Pushing order via API for patient ID: 38583918-d125-4291-a4c2-8551b1d02929
[15:34:25] [DOC: 9273007] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13829"}
[15:34:25] ❌    ❌ Failed to push order
[15:34:25] 🔄 
🔄 Step 7: Writing to CSV...
[15:34:25] [DOC: 9273007] ℹ️  Calculated age: 89 from DOB: 03/11/1936
[15:34:25] [DOC: 9273007] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:34:25] [DOC: 9273007] ℹ️  Payer Source extracted: 'Medicare'
[15:34:25] [DOC: 9273007] ℹ️  Diagnosis codes being written:
[15:34:25] [DOC: 9273007] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:34:25] [DOC: 9273007] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:34:25] [DOC: 9273007] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:34:25] [DOC: 9273007] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:34:25] [DOC: 9273007] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:34:25] [DOC: 9273007] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:34:25] [DOC: 9273007] ✅ Patient data written to CSV: Stephen Hanna Jr, | Sex: MALE | Age: 89 | Service: Skilled Nursing | Payer: Medicare | MRN: 6208015
[15:34:25] ✅    ✅ Document 9273007 processed and saved successfully
[15:34:25] 🔄 
🔄 Step 8: Saving API details...
[15:34:25] [DOC: 9273007] ℹ️  API push details saved for document 9273007
[15:34:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9273006                         ║
================================================================================
[15:34:25] ℹ️  Agency: Dartmouth HH
[15:34:25] ℹ️  Date: 05/02/2025
[15:34:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:34:27] [DOC: 9273006] ✅ Text extracted using pdfplumber (1083 chars)
[15:34:27] ✅    ✅ Text extracted using pdfplumber (1083 chars)
[15:34:27] 🔄 
🔄 Step 2: Extracting patient data...
[15:34:30] ℹ️  AI extracted raw sex value: 'F'
[15:34:30] ℹ️  AI extracted service line: 'HHA'
[15:34:30] ℹ️  AI extracted payer source: 'Medicare'
[15:34:30] ℹ️  AI extracted diagnoses:
[15:34:30] ℹ️    - Diagnosis 1: ''
[15:34:30] ℹ️    - Diagnosis 2: ''
[15:34:30] ℹ️    - Diagnosis 3: ''
[15:34:30] ℹ️    - Diagnosis 4: ''
[15:34:30] ℹ️    - Diagnosis 5: ''
[15:34:30] ℹ️    - Diagnosis 6: ''
[15:34:30] ℹ️  Final extracted MRN: '637008'
[15:34:30] ℹ️  Final extracted Sex: 'FEMALE'
[15:34:30] ℹ️  Final extracted Service Line: 'HHA'
[15:34:30] ℹ️  Final extracted Payer Source: 'Medicare'
[15:34:30] ✅ Patient data extraction completed successfully
[15:34:30] ✅    ✅ Patient data extracted successfully
[15:34:30] 📊 Patient Response
     └─ patientFName: Florence
     └─ patientLName: Curry
     └─ dob: 06/02/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 637008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 140 D Carriage Drive
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/30/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:34:30] ✅    ✅ Patient identified: Florence Curry
[15:34:30] ✅    ✅ Patient name validation passed
[15:34:30] 🔄 
🔄 Step 3: Processing patient dates...
[15:34:30] [DOC: 9273006] ℹ️  DOB normalized: 06/02/1933
[15:34:30] [DOC: 9273006] ℹ️  Episode startOfCare normalized: 04/11/2025
[15:34:30] [DOC: 9273006] ℹ️  Episode startOfEpisode normalized: 04/30/2025
[15:34:30] [DOC: 9273006] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[15:34:30] [DOC: 9273006] ✅ Patient date processing completed successfully
[15:34:30] ✅    ✅ Date processing completed
[15:34:30] 📊 Processed Patient Data
     └─ patientFName: Florence
     └─ patientLName: Curry
     └─ dob: 06/02/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 637008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 140 D Carriage Drive
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/30/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:34:30] 🔄 
🔄 Step 4: Extracting order data...
[15:34:32] ℹ️  Order extraction - MRN: ''
[15:34:32] ℹ️  Order extraction - Sex: 'FEMALE'
[15:34:32] ℹ️  Order extraction - Service Line: ''
[15:34:32] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:34:32] ✅ Order data extraction completed successfully
[15:34:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:34:32] ℹ️  Using MRN from patient data: '637008'
[15:34:32] ℹ️  Using service line from patient data: 'HHA'
[15:34:32] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:34:32] ✅ Patient name cross-validation successful
[15:34:32] ✅    ✅ Data merged successfully
[15:34:33] ✅    ✅ Order data extracted and validated
[15:34:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:34:54] [DOC: 9273006] ℹ️  Patient not found in cache or API: Florence Curry
[15:34:54] [DOC: 9273006] ℹ️  Patient not found, creating new patient via API...
[15:34:54] [DOC: 9273006] ℹ️  Creating patient via API: Florence Curry
[15:34:55] [DOC: 9273006] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:34:55] ❌    ❌ Failed to create patient
[15:34:55] [DOC: 9273006] ℹ️  API push details saved for document 9273006
================================================================================
║                        Processing Document ID: 9272998                         ║
================================================================================
[15:34:55] ℹ️  Agency: Dartmouth HH
[15:34:55] ℹ️  Date: 05/02/2025
[15:34:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:34:57] [DOC: 9272998] ✅ Text extracted using pdfplumber (1316 chars)
[15:34:57] ✅    ✅ Text extracted using pdfplumber (1316 chars)
[15:34:57] 🔄 
🔄 Step 2: Extracting patient data...
[15:35:00] ℹ️  AI extracted raw sex value: 'F'
[15:35:00] ℹ️  AI extracted service line: 'RN'
[15:35:00] ℹ️  AI extracted payer source: 'Medicare'
[15:35:00] ℹ️  AI extracted diagnoses:
[15:35:00] ℹ️    - Diagnosis 1: ''
[15:35:00] ℹ️    - Diagnosis 2: ''
[15:35:00] ℹ️    - Diagnosis 3: ''
[15:35:00] ℹ️    - Diagnosis 4: ''
[15:35:00] ℹ️    - Diagnosis 5: ''
[15:35:00] ℹ️    - Diagnosis 6: ''
[15:35:00] ℹ️  Final extracted MRN: '3320011'
[15:35:00] ℹ️  Final extracted Sex: 'FEMALE'
[15:35:00] ℹ️  Final extracted Service Line: 'RN'
[15:35:00] ℹ️  Final extracted Payer Source: 'Medicare'
[15:35:00] ✅ Patient data extraction completed successfully
[15:35:00] ✅    ✅ Patient data extracted successfully
[15:35:00] 📊 Patient Response
     └─ patientFName: Bonnie
     └─ patientLName: Werly
     └─ dob: 06/16/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3320011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'startOfEpisode': '09/01/2024', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:35:00] ✅    ✅ Patient identified: Bonnie Werly
[15:35:00] ✅    ✅ Patient name validation passed
[15:35:00] 🔄 
🔄 Step 3: Processing patient dates...
[15:35:00] [DOC: 9272998] ℹ️  DOB normalized: 06/16/1939
[15:35:00] [DOC: 9272998] ℹ️  Episode startOfCare normalized: 09/01/2024
[15:35:00] [DOC: 9272998] ℹ️  Episode startOfEpisode normalized: 09/01/2024
[15:35:00] [DOC: 9272998] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[15:35:00] [DOC: 9272998] ✅ Patient date processing completed successfully
[15:35:00] ✅    ✅ Date processing completed
[15:35:00] 📊 Processed Patient Data
     └─ patientFName: Bonnie
     └─ patientLName: Werly
     └─ dob: 06/16/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3320011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'startOfEpisode': '09/01/2024', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:35:00] 🔄 
🔄 Step 4: Extracting order data...
[15:35:02] ℹ️  Order extraction - MRN: ''
[15:35:02] ℹ️  Order extraction - Sex: 'FEMALE'
[15:35:02] ℹ️  Order extraction - Service Line: 'RN'
[15:35:02] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:35:02] ✅ Order data extraction completed successfully
[15:35:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:35:02] ℹ️  Using MRN from patient data: '3320011'
[15:35:02] ℹ️  Service line consistent in both sources: 'RN'
[15:35:02] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:35:02] ✅ Patient name cross-validation successful
[15:35:02] ✅    ✅ Data merged successfully
[15:35:03] ✅    ✅ Order data extracted and validated
[15:35:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:35:18] [DOC: 9272998] ✅ Patient exists in API: Bonnie Werly, ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[15:35:18] ✅    ✅ Existing patient found with ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[15:35:18] 🔄 
🔄 Step 6: Pushing order to API...
[15:35:18] [DOC: 9272998] ℹ️  Pushing order via API for patient ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[15:35:19] [DOC: 9272998] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14422"}
[15:35:19] ❌    ❌ Failed to push order
[15:35:19] 🔄 
🔄 Step 7: Writing to CSV...
[15:35:19] [DOC: 9272998] ℹ️  Calculated age: 85 from DOB: 06/16/1939
[15:35:19] [DOC: 9272998] ℹ️  Service Line extracted: 'RN'
[15:35:19] [DOC: 9272998] ℹ️  Payer Source extracted: 'Medicare'
[15:35:19] [DOC: 9272998] ℹ️  Diagnosis codes being written:
[15:35:19] [DOC: 9272998] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:35:19] [DOC: 9272998] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:35:19] [DOC: 9272998] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:35:19] [DOC: 9272998] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:35:19] [DOC: 9272998] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:35:19] [DOC: 9272998] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:35:19] [DOC: 9272998] ✅ Patient data written to CSV: Bonnie Werly | Sex: FEMALE | Age: 85 | Service: RN | Payer: Medicare | MRN: 3320011
[15:35:19] ✅    ✅ Document 9272998 processed and saved successfully
[15:35:19] 🔄 
🔄 Step 8: Saving API details...
[15:35:19] [DOC: 9272998] ℹ️  API push details saved for document 9272998
[15:35:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9272986                         ║
================================================================================
[15:35:19] ℹ️  Agency: Dartmouth HH
[15:35:19] ℹ️  Date: 05/02/2025
[15:35:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:35:21] [DOC: 9272986] ✅ Text extracted using pdfplumber (1046 chars)
[15:35:21] ✅    ✅ Text extracted using pdfplumber (1046 chars)
[15:35:21] 🔄 
🔄 Step 2: Extracting patient data...
[15:35:24] ℹ️  AI extracted raw sex value: 'M'
[15:35:24] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:35:24] ℹ️  AI extracted payer source: 'Medicare'
[15:35:24] ℹ️  AI extracted diagnoses:
[15:35:24] ℹ️    - Diagnosis 1: 'None'
[15:35:24] ℹ️    - Diagnosis 2: 'None'
[15:35:24] ℹ️    - Diagnosis 3: 'None'
[15:35:24] ℹ️    - Diagnosis 4: 'None'
[15:35:24] ℹ️    - Diagnosis 5: 'None'
[15:35:24] ℹ️    - Diagnosis 6: 'None'
[15:35:24] ℹ️  Final extracted MRN: '842002'
[15:35:24] ℹ️  Final extracted Sex: 'MALE'
[15:35:24] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:35:24] ℹ️  Final extracted Payer Source: 'Medicare'
[15:35:24] ✅ Patient data extraction completed successfully
[15:35:24] ✅    ✅ Patient data extracted successfully
[15:35:24] 📊 Patient Response
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 182 Sharp St
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:35:24] ✅    ✅ Patient identified: Johannes Bjornson
[15:35:24] ✅    ✅ Patient name validation passed
[15:35:24] 🔄 
🔄 Step 3: Processing patient dates...
[15:35:24] [DOC: 9272986] ℹ️  DOB normalized: 02/09/1942
[15:35:24] [DOC: 9272986] ℹ️  Episode startOfCare normalized: 10/10/2024
[15:35:24] [DOC: 9272986] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[15:35:24] [DOC: 9272986] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[15:35:24] [DOC: 9272986] ✅ Patient date processing completed successfully
[15:35:24] ✅    ✅ Date processing completed
[15:35:24] 📊 Processed Patient Data
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 182 Sharp St
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025'}]
[15:35:24] 🔄 
🔄 Step 4: Extracting order data...
[15:35:26] ℹ️  Order extraction - MRN: ''
[15:35:26] ℹ️  Order extraction - Sex: 'MALE'
[15:35:26] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:35:26] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:35:26] ✅ Order data extraction completed successfully
[15:35:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:35:26] ℹ️  Using MRN from patient data: '842002'
[15:35:26] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:35:26] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:35:26] ✅ Patient name cross-validation successful
[15:35:26] ✅    ✅ Data merged successfully
[15:35:27] ✅    ✅ Order data extracted and validated
[15:35:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:35:31] [DOC: 9272986] ✅ Patient exists in API: Johannes Bjornson, ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[15:35:31] ✅    ✅ Existing patient found with ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[15:35:31] 🔄 
🔄 Step 6: Pushing order to API...
[15:35:31] [DOC: 9272986] ℹ️  Pushing order via API for patient ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[15:35:32] [DOC: 9272986] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:35:32] ❌    ❌ Failed to push order
[15:35:32] 🔄 
🔄 Step 7: Writing to CSV...
[15:35:32] [DOC: 9272986] ℹ️  Calculated age: 83 from DOB: 02/09/1942
[15:35:32] [DOC: 9272986] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:35:32] [DOC: 9272986] ℹ️  Payer Source extracted: 'Medicare'
[15:35:32] [DOC: 9272986] ℹ️  Diagnosis codes being written:
[15:35:32] [DOC: 9272986] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:35:32] [DOC: 9272986] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:35:32] [DOC: 9272986] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:35:32] [DOC: 9272986] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:35:32] [DOC: 9272986] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:35:32] [DOC: 9272986] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:35:32] [DOC: 9272986] ✅ Patient data written to CSV: Johannes Bjornson | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: 842002
[15:35:32] ✅    ✅ Document 9272986 processed and saved successfully
[15:35:32] 🔄 
🔄 Step 8: Saving API details...
[15:35:32] [DOC: 9272986] ℹ️  API push details saved for document 9272986
[15:35:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9272597                         ║
================================================================================
[15:35:32] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:35:32] ℹ️  Date: 05/01/2025
[15:35:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:35:39] [DOC: 9272597] ✅ Text extracted using pdfplumber (1460 chars)
[15:35:39] ✅    ✅ Text extracted using pdfplumber (1460 chars)
[15:35:39] 🔄 
🔄 Step 2: Extracting patient data...
[15:35:42] ℹ️  AI extracted raw sex value: ''
[15:35:42] ℹ️  AI extracted service line: 'Physical Therapy'
[15:35:42] ℹ️  AI extracted payer source: ''
[15:35:42] ℹ️  AI extracted diagnoses:
[15:35:42] ℹ️    - Diagnosis 1: 'J44.1'
[15:35:42] ℹ️    - Diagnosis 2: 'I11.0'
[15:35:42] ℹ️    - Diagnosis 3: 'I50.42'
[15:35:42] ℹ️    - Diagnosis 4: 'None'
[15:35:42] ℹ️    - Diagnosis 5: 'None'
[15:35:42] ℹ️    - Diagnosis 6: 'None'
[15:35:42] ℹ️  Final extracted MRN: 'MA200528053701'
[15:35:42] ℹ️  Final extracted Sex: ''
[15:35:42] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:35:42] ℹ️  Final extracted Payer Source: ''
[15:35:42] ✅ Patient data extraction completed successfully
[15:35:42] ✅    ✅ Patient data extracted successfully
[15:35:42] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.42', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:35:42] ✅    ✅ Patient identified: Roderick Lopez
[15:35:42] ✅    ✅ Patient name validation passed
[15:35:42] 🔄 
🔄 Step 3: Processing patient dates...
[15:35:42] [DOC: 9272597] ℹ️  DOB normalized: 05/21/1937
[15:35:42] [DOC: 9272597] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[15:35:42] [DOC: 9272597] ℹ️  Episode endOfEpisode normalized: 06/18/2025
[15:35:42] [DOC: 9272597] ✅ Patient date processing completed successfully
[15:35:42] ✅    ✅ Date processing completed
[15:35:42] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.42'}]
[15:35:42] 🔄 
🔄 Step 4: Extracting order data...
[15:35:44] ℹ️  Order extraction - MRN: 'MA200528053701'
[15:35:44] ℹ️  Order extraction - Sex: ''
[15:35:44] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[15:35:44] ℹ️  Order extraction - Payer Source: ''
[15:35:44] ✅ Order data extraction completed successfully
[15:35:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:35:44] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[15:35:44] ℹ️  Inferred sex as MALE from name: Roderick
[15:35:44] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[15:35:44] ✅ Patient name cross-validation successful
[15:35:44] ✅    ✅ Data merged successfully
[15:35:45] ✅    ✅ Order data extracted and validated
[15:35:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:35:51] [DOC: 9272597] ℹ️  Patient not found in cache or API: Roderick Lopez
[15:35:51] [DOC: 9272597] ℹ️  Patient not found, creating new patient via API...
[15:35:51] [DOC: 9272597] ℹ️  Creating patient via API: Roderick Lopez
[15:35:52] [DOC: 9272597] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:35:52] ❌    ❌ Failed to create patient
[15:35:52] [DOC: 9272597] ℹ️  API push details saved for document 9272597
================================================================================
║                        Processing Document ID: 9272523                         ║
================================================================================
[15:35:52] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:35:52] ℹ️  Date: 05/01/2025
[15:35:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:35:53] [DOC: 9272523] ✅ Text extracted using pdfplumber (871 chars)
[15:35:53] ✅    ✅ Text extracted using pdfplumber (871 chars)
[15:35:53] 🔄 
🔄 Step 2: Extracting patient data...
[15:35:56] ℹ️  AI extracted raw sex value: 'F'
[15:35:56] ℹ️  AI extracted service line: 'LPN'
[15:35:56] ℹ️  AI extracted payer source: ''
[15:35:56] ℹ️  AI extracted diagnoses:
[15:35:56] ℹ️    - Diagnosis 1: 'None'
[15:35:56] ℹ️    - Diagnosis 2: 'None'
[15:35:56] ℹ️    - Diagnosis 3: 'None'
[15:35:56] ℹ️    - Diagnosis 4: 'None'
[15:35:56] ℹ️    - Diagnosis 5: 'None'
[15:35:56] ℹ️    - Diagnosis 6: 'None'
[15:35:56] ℹ️  Final extracted MRN: '2503818'
[15:35:56] ℹ️  Final extracted Sex: 'FEMALE'
[15:35:56] ℹ️  Final extracted Service Line: 'LPN'
[15:35:56] ℹ️  Final extracted Payer Source: ''
[15:35:56] ✅ Patient data extraction completed successfully
[15:35:56] ✅    ✅ Patient data extracted successfully
[15:35:56] 📊 Patient Response
     └─ patientFName: Telma
     └─ patientLName: Garcia
     └─ dob: 09/02/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2503818
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:35:56] ✅    ✅ Patient identified: Telma Garcia
[15:35:56] ✅    ✅ Patient name validation passed
[15:35:56] 🔄 
🔄 Step 3: Processing patient dates...
[15:35:56] [DOC: 9272523] ℹ️  DOB normalized: 09/02/1931
[15:35:56] [DOC: 9272523] ✅ Patient date processing completed successfully
[15:35:56] ✅    ✅ Date processing completed
[15:35:56] 📊 Processed Patient Data
     └─ patientFName: Telma
     └─ patientLName: Garcia
     └─ dob: 09/02/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2503818
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[15:35:56] 🔄 
🔄 Step 4: Extracting order data...
[15:35:58] ℹ️  Order extraction - MRN: '2503818'
[15:35:58] ℹ️  Order extraction - Sex: 'FEMALE'
[15:35:58] ℹ️  Order extraction - Service Line: ''
[15:35:58] ℹ️  Order extraction - Payer Source: ''
[15:35:58] ✅ Order data extraction completed successfully
[15:35:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:35:58] ℹ️  Using MRN from patient data: '2503818' over '2503818'
[15:35:58] ℹ️  Using service line from patient data: 'LPN'
[15:35:58] ✅ Patient name cross-validation successful
[15:35:58] ✅    ✅ Data merged successfully
[15:35:59] ✅    ✅ Order data extracted and validated
[15:35:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:36:11] [DOC: 9272523] ℹ️  Patient not found in cache or API: Telma Garcia
[15:36:11] [DOC: 9272523] ℹ️  Patient not found, creating new patient via API...
[15:36:11] [DOC: 9272523] ℹ️  Creating patient via API: Telma Garcia
[15:36:12] [DOC: 9272523] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:36:12] ❌    ❌ Failed to create patient
[15:36:12] [DOC: 9272523] ℹ️  API push details saved for document 9272523
================================================================================
║                        Processing Document ID: 9272521                         ║
================================================================================
[15:36:12] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:36:12] ℹ️  Date: 05/01/2025
[15:36:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:36:15] [DOC: 9272521] ✅ Text extracted using pdfplumber (30831 chars)
[15:36:15] ✅    ✅ Text extracted using pdfplumber (30831 chars)
[15:36:15] 🔄 
🔄 Step 2: Extracting patient data...
[15:36:19] ℹ️  AI extracted raw sex value: 'Female'
[15:36:19] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology'
[15:36:19] ℹ️  AI extracted payer source: ''
[15:36:19] ℹ️  AI extracted diagnoses:
[15:36:19] ℹ️    - Diagnosis 1: 'A41.51'
[15:36:19] ℹ️    - Diagnosis 2: 'N17.9'
[15:36:19] ℹ️    - Diagnosis 3: 'N30.00'
[15:36:19] ℹ️    - Diagnosis 4: 'R13.12'
[15:36:19] ℹ️    - Diagnosis 5: 'G30.1'
[15:36:19] ℹ️    - Diagnosis 6: 'F02.80'
[15:36:19] ℹ️  Final extracted MRN: '2503818'
[15:36:19] ℹ️  Final extracted Sex: 'FEMALE'
[15:36:19] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology'
[15:36:19] ℹ️  Final extracted Payer Source: ''
[15:36:19] ✅ Patient data extraction completed successfully
[15:36:19] ✅    ✅ Patient data extracted successfully
[15:36:19] 📊 Patient Response
     └─ patientFName: Telma
     └─ patientLName: Garcia
     └─ dob: 09/02/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2503818
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 10 Borden St Apt 2
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740-3315
     └─ email: 
     └─ phoneNumber: 508-961-9601
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/16/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'N30.00', 'fourthDiagnosis': 'R13.12', 'fifthDiagnosis': 'G30.1', 'sixthDiagnosis': 'F02.80'}]
[15:36:19] ✅    ✅ Patient identified: Telma Garcia
[15:36:19] ✅    ✅ Patient name validation passed
[15:36:19] 🔄 
🔄 Step 3: Processing patient dates...
[15:36:19] [DOC: 9272521] ℹ️  DOB normalized: 09/02/1931
[15:36:19] [DOC: 9272521] ℹ️  Episode startOfCare normalized: 04/16/2025
[15:36:19] [DOC: 9272521] ℹ️  Episode startOfEpisode normalized: 04/18/2025
[15:36:19] [DOC: 9272521] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[15:36:19] [DOC: 9272521] ✅ Patient date processing completed successfully
[15:36:19] ✅    ✅ Date processing completed
[15:36:19] 📊 Processed Patient Data
     └─ patientFName: Telma
     └─ patientLName: Garcia
     └─ dob: 09/02/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2503818
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 10 Borden St Apt 2
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740-3315
     └─ email: 
     └─ phoneNumber: 508-961-9601
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/16/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'N17.9', 'thirdDiagnosis': 'N30.00', 'fourthDiagnosis': 'R13.12', 'fifthDiagnosis': 'G30.1', 'sixthDiagnosis': 'F02.80'}]
[15:36:19] 🔄 
🔄 Step 4: Extracting order data...
[15:36:22] ℹ️  Order extraction - MRN: '2503818'
[15:36:22] ℹ️  Order extraction - Sex: 'FEMALE'
[15:36:22] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology'
[15:36:22] ℹ️  Order extraction - Payer Source: ''
[15:36:22] ✅ Order data extraction completed successfully
[15:36:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:36:22] ℹ️  Using MRN from patient data: '2503818' over '2503818'
[15:36:22] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology'
[15:36:22] ✅ Patient name cross-validation successful
[15:36:22] ✅    ✅ Data merged successfully
[15:36:23] ✅    ✅ Order data extracted and validated
[15:36:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:36:28] [DOC: 9272521] ℹ️  Patient not found in cache or API: Telma Garcia
[15:36:28] [DOC: 9272521] ℹ️  Patient not found, creating new patient via API...
[15:36:28] [DOC: 9272521] ℹ️  Creating patient via API: Telma Garcia
[15:36:29] [DOC: 9272521] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:36:29] ❌    ❌ Failed to create patient
[15:36:29] [DOC: 9272521] ℹ️  API push details saved for document 9272521
================================================================================
║                        Processing Document ID: 9272036                         ║
================================================================================
[15:36:29] ℹ️  Agency: AccentCare Fall River
[15:36:29] ℹ️  Date: 05/01/2025
[15:36:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:36:50] [DOC: 9272036] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[15:37:11] [DOC: 9272036] ✅ Text extracted using tesseract_ocr (37579 chars)
[15:37:11] ✅    ✅ Text extracted using tesseract_ocr (37548 chars)
[15:37:11] 🔄 
🔄 Step 2: Extracting patient data...
[15:37:15] ℹ️  AI extracted raw sex value: 'F'
[15:37:15] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:37:15] ℹ️  AI extracted payer source: 'Medicare'
[15:37:15] ℹ️  AI extracted diagnoses:
[15:37:15] ℹ️    - Diagnosis 1: 'K219'
[15:37:15] ℹ️    - Diagnosis 2: 'I25.10'
[15:37:15] ℹ️    - Diagnosis 3: 'I11.0'
[15:37:15] ℹ️    - Diagnosis 4: 'I50.32'
[15:37:15] ℹ️    - Diagnosis 5: 'N18.4'
[15:37:15] ℹ️    - Diagnosis 6: 'J44.89'
[15:37:15] ℹ️  Final extracted MRN: 'C0200156525301'
[15:37:15] ℹ️  Final extracted Sex: 'FEMALE'
[15:37:15] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:37:15] ℹ️  Final extracted Payer Source: 'Medicare'
[15:37:15] ✅ Patient data extraction completed successfully
[15:37:15] ✅    ✅ Patient data extracted successfully
[15:37:15] 📊 Patient Response
     └─ patientFName: JEANINE
     └─ patientLName: SASSEVILLE
     └─ dob: 07/06/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200156525301
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 777 REED RD
     └─ city: FALLRIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/21/2025', 'startOfEpisode': '04/21/2025', 'endOfEpisode': '06/19/2025', 'firstDiagnosis': 'K219', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'N18.4', 'sixthDiagnosis': 'J44.89'}]
[15:37:15] ✅    ✅ Patient identified: JEANINE SASSEVILLE
[15:37:15] ✅    ✅ Patient name validation passed
[15:37:15] 🔄 
🔄 Step 3: Processing patient dates...
[15:37:15] [DOC: 9272036] ℹ️  DOB normalized: 07/06/1941
[15:37:15] [DOC: 9272036] ℹ️  Episode startOfCare normalized: 04/21/2025
[15:37:15] [DOC: 9272036] ℹ️  Episode startOfEpisode normalized: 04/21/2025
[15:37:15] [DOC: 9272036] ℹ️  Episode endOfEpisode normalized: 06/19/2025
[15:37:15] [DOC: 9272036] ✅ Patient date processing completed successfully
[15:37:15] ✅    ✅ Date processing completed
[15:37:15] 📊 Processed Patient Data
     └─ patientFName: JEANINE
     └─ patientLName: SASSEVILLE
     └─ dob: 07/06/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200156525301
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 777 REED RD
     └─ city: FALLRIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/21/2025', 'startOfEpisode': '04/21/2025', 'endOfEpisode': '06/19/2025', 'firstDiagnosis': 'K219', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'N18.4', 'sixthDiagnosis': 'J44.89'}]
[15:37:15] 🔄 
🔄 Step 4: Extracting order data...
[15:37:18] ℹ️  Order extraction - MRN: '412112025'
[15:37:18] ℹ️  Order extraction - Sex: 'FEMALE'
[15:37:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:37:18] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:37:18] ✅ Order data extraction completed successfully
[15:37:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:37:18] ℹ️  Using MRN from patient data: 'C0200156525301' over '412112025'
[15:37:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:37:18] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:37:18] ✅ Patient name cross-validation successful
[15:37:18] ✅    ✅ Data merged successfully
[15:37:19] ✅    ✅ Order data extracted and validated
[15:37:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:37:23] [DOC: 9272036] ℹ️  Patient not found in cache or API: JEANINE SASSEVILLE
[15:37:23] [DOC: 9272036] ℹ️  Patient not found, creating new patient via API...
[15:37:23] [DOC: 9272036] ℹ️  Creating patient via API: JEANINE SASSEVILLE
[15:37:24] [DOC: 9272036] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:37:24] ❌    ❌ Failed to create patient
[15:37:24] [DOC: 9272036] ℹ️  API push details saved for document 9272036
================================================================================
║                        Processing Document ID: 9271538                         ║
================================================================================
[15:37:24] ℹ️  Agency: Compassionate Care Hospice-Taunton
[15:37:24] ℹ️  Date: 05/01/2025
[15:37:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:37:26] [DOC: 9271538] ✅ Text extracted using pdfplumber (1297 chars)
[15:37:26] ✅    ✅ Text extracted using pdfplumber (1285 chars)
[15:37:26] 🔄 
🔄 Step 2: Extracting patient data...
[15:37:29] ℹ️  AI extracted raw sex value: ''
[15:37:29] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:37:29] ℹ️  AI extracted payer source: 'Medicare'
[15:37:29] ℹ️  AI extracted diagnoses:
[15:37:29] ℹ️    - Diagnosis 1: ''
[15:37:29] ℹ️    - Diagnosis 2: ''
[15:37:29] ℹ️    - Diagnosis 3: ''
[15:37:29] ℹ️    - Diagnosis 4: ''
[15:37:29] ℹ️    - Diagnosis 5: ''
[15:37:29] ℹ️    - Diagnosis 6: ''
[15:37:29] ℹ️  Final extracted MRN: 'B3700296223202'
[15:37:29] ℹ️  Final extracted Sex: ''
[15:37:29] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:37:29] ℹ️  Final extracted Payer Source: 'Medicare'
[15:37:29] ✅ Patient data extraction completed successfully
[15:37:29] ✅    ✅ Patient data extracted successfully
[15:37:29] 📊 Patient Response
     └─ patientFName: MARIA
     └─ patientLName: JARDIM
     └─ dob: 05/20/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700296223202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/27/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:37:29] ✅    ✅ Patient identified: MARIA JARDIM
[15:37:29] ✅    ✅ Patient name validation passed
[15:37:29] 🔄 
🔄 Step 3: Processing patient dates...
[15:37:29] [DOC: 9271538] ℹ️  DOB normalized: 05/20/1931
[15:37:29] [DOC: 9271538] ℹ️  Episode startOfEpisode normalized: 04/27/2025
[15:37:29] [DOC: 9271538] ✅ Patient date processing completed successfully
[15:37:29] ✅    ✅ Date processing completed
[15:37:29] 📊 Processed Patient Data
     └─ patientFName: MARIA
     └─ patientLName: JARDIM
     └─ dob: 05/20/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700296223202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/27/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:37:29] 🔄 
🔄 Step 4: Extracting order data...
[15:37:32] ℹ️  Order extraction - MRN: 'B3700296223202'
[15:37:32] ℹ️  Order extraction - Sex: ''
[15:37:32] ℹ️  Order extraction - Service Line: 'RN'
[15:37:32] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:37:32] ✅ Order data extraction completed successfully
[15:37:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:37:32] ℹ️  Using MRN from patient data: 'B3700296223202' over 'B3700296223202'
[15:37:32] ℹ️  Inferred sex as FEMALE from name: MARIA
[15:37:32] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[15:37:32] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:37:32] ✅ Patient name cross-validation successful
[15:37:32] ✅    ✅ Data merged successfully
[15:37:33] ✅    ✅ Order data extracted and validated
[15:37:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:37:33] [DOC: 9271538] ✅ Patient found in local cache: MARIA JARDIM, ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[15:37:33] ✅    ✅ Existing patient found with ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[15:37:33] 🔄 
🔄 Step 6: Pushing order to API...
[15:37:33] [DOC: 9271538] ℹ️  Pushing order via API for patient ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[15:37:34] [DOC: 9271538] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13859"}
[15:37:34] ❌    ❌ Failed to push order
[15:37:34] 🔄 
🔄 Step 7: Writing to CSV...
[15:37:34] [DOC: 9271538] ℹ️  Calculated age: 94 from DOB: 05/20/1931
[15:37:34] [DOC: 9271538] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[15:37:34] [DOC: 9271538] ℹ️  Payer Source extracted: 'Medicare'
[15:37:34] [DOC: 9271538] ℹ️  Diagnosis codes being written:
[15:37:34] [DOC: 9271538] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:37:34] [DOC: 9271538] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:37:34] [DOC: 9271538] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:37:34] [DOC: 9271538] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:37:34] [DOC: 9271538] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:37:34] [DOC: 9271538] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:37:34] [DOC: 9271538] ✅ Patient data written to CSV: MARIA JARDIM | Sex: FEMALE | Age: 94 | Service: RN, Skilled Nursing | Payer: Medicare | MRN: B3700296223202
[15:37:34] ✅    ✅ Document 9271538 processed and saved successfully
[15:37:34] 🔄 
🔄 Step 8: Saving API details...
[15:37:34] [DOC: 9271538] ℹ️  API push details saved for document 9271538
[15:37:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9271534                         ║
================================================================================
[15:37:34] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:37:34] ℹ️  Date: 05/01/2025
[15:37:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:37:36] [DOC: 9271534] ✅ Text extracted using pdfplumber (1519 chars)
[15:37:36] ✅    ✅ Text extracted using pdfplumber (1507 chars)
[15:37:36] 🔄 
🔄 Step 2: Extracting patient data...
[15:37:39] ℹ️  AI extracted raw sex value: ''
[15:37:39] ℹ️  AI extracted service line: 'Physical Therapy'
[15:37:39] ℹ️  AI extracted payer source: ''
[15:37:39] ℹ️  AI extracted diagnoses:
[15:37:39] ℹ️    - Diagnosis 1: 'A04.72'
[15:37:39] ℹ️    - Diagnosis 2: 'E11.9'
[15:37:39] ℹ️    - Diagnosis 3: 'E87.1'
[15:37:39] ℹ️    - Diagnosis 4: 'None'
[15:37:39] ℹ️    - Diagnosis 5: 'None'
[15:37:39] ℹ️    - Diagnosis 6: 'None'
[15:37:39] ℹ️  Final extracted MRN: 'MA250414053302'
[15:37:39] ℹ️  Final extracted Sex: ''
[15:37:39] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:37:39] ℹ️  Final extracted Payer Source: ''
[15:37:39] ✅ Patient data extraction completed successfully
[15:37:39] ✅    ✅ Patient data extracted successfully
[15:37:39] 📊 Patient Response
     └─ patientFName: Serafim
     └─ patientLName: Mimoso
     └─ dob: 05/08/1933
     └─ patientSex: 
     └─ medicalRecordNo: MA250414053302
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E87.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:37:39] ✅    ✅ Patient identified: Serafim Mimoso
[15:37:39] ✅    ✅ Patient name validation passed
[15:37:39] 🔄 
🔄 Step 3: Processing patient dates...
[15:37:39] [DOC: 9271534] ℹ️  DOB normalized: 05/08/1933
[15:37:39] [DOC: 9271534] ℹ️  Episode startOfEpisode normalized: 04/18/2025
[15:37:39] [DOC: 9271534] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[15:37:39] [DOC: 9271534] ✅ Patient date processing completed successfully
[15:37:39] ✅    ✅ Date processing completed
[15:37:39] 📊 Processed Patient Data
     └─ patientFName: Serafim
     └─ patientLName: Mimoso
     └─ dob: 05/08/1933
     └─ patientSex: 
     └─ medicalRecordNo: MA250414053302
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E87.1'}]
[15:37:39] 🔄 
🔄 Step 4: Extracting order data...
[15:37:42] ℹ️  Order extraction - MRN: 'MA250414053302'
[15:37:42] ℹ️  Order extraction - Sex: ''
[15:37:42] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[15:37:42] ℹ️  Order extraction - Payer Source: ''
[15:37:42] ✅ Order data extraction completed successfully
[15:37:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:37:42] ℹ️  Using MRN from patient data: 'MA250414053302' over 'MA250414053302'
[15:37:42] ⚠️  Could not determine sex using any available method
[15:37:42] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[15:37:42] ✅ Patient name cross-validation successful
[15:37:42] ✅    ✅ Data merged successfully
[15:37:43] ✅    ✅ Order data extracted and validated
[15:37:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:37:48] [DOC: 9271534] ✅ Patient exists in API: Serafim Mimoso, ID: 0849f00a-166d-4c7d-969a-5567b25056c1
[15:37:48] ✅    ✅ Existing patient found with ID: 0849f00a-166d-4c7d-969a-5567b25056c1
[15:37:48] 🔄 
🔄 Step 6: Pushing order to API...
[15:37:48] [DOC: 9271534] ℹ️  Pushing order via API for patient ID: 0849f00a-166d-4c7d-969a-5567b25056c1
[15:37:49] [DOC: 9271534] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14106"}
[15:37:49] ❌    ❌ Failed to push order
[15:37:49] 🔄 
🔄 Step 7: Writing to CSV...
[15:37:49] [DOC: 9271534] ℹ️  Calculated age: 92 from DOB: 05/08/1933
[15:37:49] [DOC: 9271534] ℹ️  Service Line extracted: 'Physical Therapy'
[15:37:49] [DOC: 9271534] ℹ️  Payer Source extracted: ''
[15:37:49] [DOC: 9271534] ℹ️  Diagnosis codes being written:
[15:37:49] [DOC: 9271534] ℹ️    - Latest_Episode_Firstdiagnosis: 'A04.72'
[15:37:49] [DOC: 9271534] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[15:37:49] [DOC: 9271534] ℹ️    - Latest_Episode_Thirddiagnosis: 'E87.1'
[15:37:49] [DOC: 9271534] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:37:49] [DOC: 9271534] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:37:49] [DOC: 9271534] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:37:49] [DOC: 9271534] ✅ Patient data written to CSV: Serafim Mimoso | Sex:  | Age: 92 | Service: Physical Therapy | Payer:  | MRN: MA250414053302
[15:37:49] ✅    ✅ Document 9271534 processed and saved successfully
[15:37:49] 🔄 
🔄 Step 8: Saving API details...
[15:37:49] [DOC: 9271534] ℹ️  API push details saved for document 9271534
[15:37:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9271466                         ║
================================================================================
[15:37:49] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[15:37:49] ℹ️  Date: 05/01/2025
[15:37:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:37:52] [DOC: 9271466] ✅ Text extracted using pdfplumber (1671 chars)
[15:37:52] ✅    ✅ Text extracted using pdfplumber (1671 chars)
[15:37:52] 🔄 
🔄 Step 2: Extracting patient data...
[15:37:54] ℹ️  AI extracted raw sex value: 'M'
[15:37:54] ℹ️  AI extracted service line: 'HHA'
[15:37:54] ℹ️  AI extracted payer source: 'Senior Whole Health'
[15:37:54] ℹ️  AI extracted diagnoses:
[15:37:54] ℹ️    - Diagnosis 1: ''
[15:37:54] ℹ️    - Diagnosis 2: ''
[15:37:54] ℹ️    - Diagnosis 3: ''
[15:37:54] ℹ️    - Diagnosis 4: ''
[15:37:54] ℹ️    - Diagnosis 5: ''
[15:37:54] ℹ️    - Diagnosis 6: ''
[15:37:54] ℹ️  Final extracted MRN: '1859'
[15:37:54] ℹ️  Final extracted Sex: 'MALE'
[15:37:54] ℹ️  Final extracted Service Line: 'HHA'
[15:37:54] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[15:37:54] ✅ Patient data extraction completed successfully
[15:37:54] ✅    ✅ Patient data extracted successfully
[15:37:54] 📊 Patient Response
     └─ patientFName: Santos
     └─ patientLName: Serrano
     └─ dob: 09/12/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 1859
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/11/2015', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:37:54] ✅    ✅ Patient identified: Santos Serrano
[15:37:54] ✅    ✅ Patient name validation passed
[15:37:54] 🔄 
🔄 Step 3: Processing patient dates...
[15:37:54] [DOC: 9271466] ℹ️  DOB normalized: 09/12/1950
[15:37:54] [DOC: 9271466] ℹ️  Episode startOfCare normalized: 03/11/2015
[15:37:54] [DOC: 9271466] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[15:37:54] [DOC: 9271466] ℹ️  Episode endOfEpisode normalized: 05/16/2025
[15:37:54] [DOC: 9271466] ✅ Patient date processing completed successfully
[15:37:54] ✅    ✅ Date processing completed
[15:37:54] 📊 Processed Patient Data
     └─ patientFName: Santos
     └─ patientLName: Serrano
     └─ dob: 09/12/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 1859
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/11/2015', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '05/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:37:54] 🔄 
🔄 Step 4: Extracting order data...
[15:37:57] ℹ️  Order extraction - MRN: '1859'
[15:37:57] ℹ️  Order extraction - Sex: 'MALE'
[15:37:57] ℹ️  Order extraction - Service Line: ''
[15:37:57] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[15:37:57] ✅ Order data extraction completed successfully
[15:37:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:37:57] ℹ️  Using MRN from patient data: '1859' over '1859'
[15:37:57] ℹ️  Using service line from patient data: 'HHA'
[15:37:57] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[15:37:57] ✅ Patient name cross-validation successful
[15:37:57] ✅    ✅ Data merged successfully
[15:37:58] ✅    ✅ Order data extracted and validated
[15:37:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:38:04] [DOC: 9271466] ✅ Patient exists in API: Santos Serrano, ID: 61360068-b28b-42ce-bb3a-37a13f90cd0b
[15:38:04] ✅    ✅ Existing patient found with ID: 61360068-b28b-42ce-bb3a-37a13f90cd0b
[15:38:04] 🔄 
🔄 Step 6: Pushing order to API...
[15:38:04] [DOC: 9271466] ℹ️  Pushing order via API for patient ID: 61360068-b28b-42ce-bb3a-37a13f90cd0b
[15:38:05] [DOC: 9271466] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:38:05] ❌    ❌ Failed to push order
[15:38:05] 🔄 
🔄 Step 7: Writing to CSV...
[15:38:05] [DOC: 9271466] ℹ️  Calculated age: 74 from DOB: 09/12/1950
[15:38:05] [DOC: 9271466] ℹ️  Service Line extracted: 'HHA'
[15:38:05] [DOC: 9271466] ℹ️  Payer Source extracted: 'Senior Whole Health'
[15:38:05] [DOC: 9271466] ℹ️  Diagnosis codes being written:
[15:38:05] [DOC: 9271466] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:38:05] [DOC: 9271466] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:38:05] [DOC: 9271466] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:38:05] [DOC: 9271466] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:38:05] [DOC: 9271466] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:38:05] [DOC: 9271466] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:38:05] [DOC: 9271466] ✅ Patient data written to CSV: Santos Serrano | Sex: MALE | Age: 74 | Service: HHA | Payer: Senior Whole Health | MRN: 1859
[15:38:05] ✅    ✅ Document 9271466 processed and saved successfully
[15:38:05] 🔄 
🔄 Step 8: Saving API details...
[15:38:05] [DOC: 9271466] ℹ️  API push details saved for document 9271466
[15:38:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9270701                         ║
================================================================================
[15:38:05] ℹ️  Agency: Relief Home Health Services
[15:38:05] ℹ️  Date: 05/01/2025
[15:38:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:38:08] [DOC: 9270701] ✅ Text extracted using pdfplumber (16951 chars)
[15:38:08] ✅    ✅ Text extracted using pdfplumber (16951 chars)
[15:38:08] 🔄 
🔄 Step 2: Extracting patient data...
[15:38:11] ℹ️  AI extracted raw sex value: 'M'
[15:38:11] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:38:11] ℹ️  AI extracted payer source: ''
[15:38:11] ℹ️  AI extracted diagnoses:
[15:38:11] ℹ️    - Diagnosis 1: 'E11.9'
[15:38:11] ℹ️    - Diagnosis 2: 'F41.9'
[15:38:11] ℹ️    - Diagnosis 3: 'I12.9'
[15:38:11] ℹ️    - Diagnosis 4: 'N18.30'
[15:38:11] ℹ️    - Diagnosis 5: 'J45.20'
[15:38:11] ℹ️    - Diagnosis 6: 'G47.33'
[15:38:11] ℹ️  Final extracted MRN: 'NB0458'
[15:38:11] ℹ️  Final extracted Sex: 'MALE'
[15:38:11] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:38:11] ℹ️  Final extracted Payer Source: ''
[15:38:11] ✅ Patient data extraction completed successfully
[15:38:11] ✅    ✅ Patient data extracted successfully
[15:38:11] 📊 Patient Response
     └─ patientFName: BRIAN
     └─ patientLName: BROWN
     └─ dob: 11/28/1958
     └─ patientSex: MALE
     └─ medicalRecordNo: NB0458
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 525 Coggeshall St Apt 112
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: 
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/01/2024', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'J45.20', 'sixthDiagnosis': 'G47.33'}]
[15:38:11] ✅    ✅ Patient identified: BRIAN BROWN
[15:38:11] ✅    ✅ Patient name validation passed
[15:38:11] 🔄 
🔄 Step 3: Processing patient dates...
[15:38:11] [DOC: 9270701] ℹ️  DOB normalized: 11/28/1958
[15:38:11] [DOC: 9270701] ℹ️  Episode startOfCare normalized: 01/01/2024
[15:38:11] [DOC: 9270701] ℹ️  Episode startOfEpisode normalized: 04/25/2025
[15:38:11] [DOC: 9270701] ℹ️  Episode endOfEpisode normalized: 06/23/2025
[15:38:11] [DOC: 9270701] ✅ Patient date processing completed successfully
[15:38:11] ✅    ✅ Date processing completed
[15:38:11] 📊 Processed Patient Data
     └─ patientFName: BRIAN
     └─ patientLName: BROWN
     └─ dob: 11/28/1958
     └─ patientSex: MALE
     └─ medicalRecordNo: NB0458
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 525 Coggeshall St Apt 112
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: 
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/01/2024', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'J45.20', 'sixthDiagnosis': 'G47.33'}]
[15:38:11] 🔄 
🔄 Step 4: Extracting order data...
[15:38:14] ℹ️  Order extraction - MRN: 'NB0458'
[15:38:14] ℹ️  Order extraction - Sex: 'MALE'
[15:38:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:38:14] ℹ️  Order extraction - Payer Source: ''
[15:38:14] ✅ Order data extraction completed successfully
[15:38:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:38:14] ℹ️  Using MRN from patient data: 'NB0458' over 'NB0458'
[15:38:14] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:38:14] ✅ Patient name cross-validation successful
[15:38:14] ✅    ✅ Data merged successfully
[15:38:15] ✅    ✅ Order data extracted and validated
[15:38:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:38:21] [DOC: 9270701] ✅ Patient exists in API: BRIAN BROWN, ID: 6bd7fd2a-44f5-473f-b506-c7058f7d62bc
[15:38:21] ✅    ✅ Existing patient found with ID: 6bd7fd2a-44f5-473f-b506-c7058f7d62bc
[15:38:21] 🔄 
🔄 Step 6: Pushing order to API...
[15:38:21] [DOC: 9270701] ℹ️  Pushing order via API for patient ID: 6bd7fd2a-44f5-473f-b506-c7058f7d62bc
[15:38:22] [DOC: 9270701] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:38:22] ❌    ❌ Failed to push order
[15:38:22] 🔄 
🔄 Step 7: Writing to CSV...
[15:38:22] [DOC: 9270701] ℹ️  Calculated age: 66 from DOB: 11/28/1958
[15:38:22] [DOC: 9270701] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:38:22] [DOC: 9270701] ℹ️  Payer Source extracted: ''
[15:38:22] [DOC: 9270701] ℹ️  Diagnosis codes being written:
[15:38:22] [DOC: 9270701] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[15:38:22] [DOC: 9270701] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.9'
[15:38:22] [DOC: 9270701] ℹ️    - Latest_Episode_Thirddiagnosis: 'I12.9'
[15:38:22] [DOC: 9270701] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.30'
[15:38:22] [DOC: 9270701] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J45.20'
[15:38:22] [DOC: 9270701] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G47.33'
[15:38:22] [DOC: 9270701] ✅ Patient data written to CSV: BRIAN BROWN | Sex: MALE | Age: 66 | Service: Skilled Nursing | Payer:  | MRN: NB0458
[15:38:22] ✅    ✅ Document 9270701 processed and saved successfully
[15:38:22] 🔄 
🔄 Step 8: Saving API details...
[15:38:22] [DOC: 9270701] ℹ️  API push details saved for document 9270701
[15:38:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 2173693                         ║
================================================================================
[15:38:22] ℹ️  Agency: Visiting Rehab & Nursing Services
[15:38:22] ℹ️  Date: 04/30/2025
[15:38:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:38:23] [DOC: 2173693] ❌ Critical failure in get_pdf_text: Invalid response format
[15:38:23] ❌ Failed to extract text for Doc ID 2173693
[15:38:23] [DOC: 2173693] ℹ️  API push details saved for document 2173693
================================================================================
║                        Processing Document ID: 9268264                         ║
================================================================================
[15:38:23] ℹ️  Agency: Nizhoni Health-Fall River
[15:38:23] ℹ️  Date: 04/30/2025
[15:38:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:38:26] [DOC: 9268264] ✅ Text extracted using pdfplumber (11484 chars)
[15:38:26] ✅    ✅ Text extracted using pdfplumber (11484 chars)
[15:38:26] 🔄 
🔄 Step 2: Extracting patient data...
[15:38:30] ℹ️  AI extracted raw sex value: 'M'
[15:38:30] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:38:30] ℹ️  AI extracted payer source: 'None'
[15:38:30] ℹ️  AI extracted diagnoses:
[15:38:30] ℹ️    - Diagnosis 1: 'F25.0'
[15:38:30] ℹ️    - Diagnosis 2: 'I10'
[15:38:30] ℹ️    - Diagnosis 3: 'E03.9'
[15:38:30] ℹ️    - Diagnosis 4: 'E11.9'
[15:38:30] ℹ️    - Diagnosis 5: 'E78.00'
[15:38:30] ℹ️    - Diagnosis 6: 'E66.09'
[15:38:30] ℹ️  Final extracted MRN: '18016'
[15:38:30] ℹ️  Final extracted Sex: 'MALE'
[15:38:30] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:38:30] ℹ️  Final extracted Payer Source: ''
[15:38:30] ✅ Patient data extraction completed successfully
[15:38:30] ✅    ✅ Patient data extracted successfully
[15:38:30] 📊 Patient Response
     └─ patientFName: Craig
     └─ patientLName: Leite
     └─ dob: 12/14/1987
     └─ patientSex: MALE
     └─ medicalRecordNo: 18016
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/21/2020', 'startOfEpisode': '01/22/2020', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'E78.00', 'sixthDiagnosis': 'E66.09'}]
[15:38:30] ✅    ✅ Patient identified: Craig Leite
[15:38:30] ✅    ✅ Patient name validation passed
[15:38:30] 🔄 
🔄 Step 3: Processing patient dates...
[15:38:30] [DOC: 9268264] ℹ️  DOB normalized: 12/14/1987
[15:38:30] [DOC: 9268264] ℹ️  Episode startOfCare normalized: 01/21/2020
[15:38:30] [DOC: 9268264] ℹ️  Episode startOfEpisode normalized: 01/22/2020
[15:38:30] [DOC: 9268264] ℹ️  Episode endOfEpisode normalized: 06/23/2025
[15:38:30] [DOC: 9268264] ✅ Patient date processing completed successfully
[15:38:30] ✅    ✅ Date processing completed
[15:38:30] 📊 Processed Patient Data
     └─ patientFName: Craig
     └─ patientLName: Leite
     └─ dob: 12/14/1987
     └─ patientSex: MALE
     └─ medicalRecordNo: 18016
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/21/2020', 'startOfEpisode': '01/22/2020', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'E78.00', 'sixthDiagnosis': 'E66.09'}]
[15:38:30] 🔄 
🔄 Step 4: Extracting order data...
[15:38:32] ℹ️  Order extraction - MRN: '18016'
[15:38:32] ℹ️  Order extraction - Sex: 'MALE'
[15:38:32] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:38:32] ℹ️  Order extraction - Payer Source: ''
[15:38:32] ✅ Order data extraction completed successfully
[15:38:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:38:32] ℹ️  Using MRN from patient data: '18016' over '18016'
[15:38:32] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:38:32] ✅ Patient name cross-validation successful
[15:38:32] ✅    ✅ Data merged successfully
[15:38:33] ✅    ✅ Order data extracted and validated
[15:38:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:38:58] [DOC: 9268264] ✅ Patient exists in API: Craig Leite, ID: 841862b6-562d-466d-bbe3-040191d78347
[15:38:58] ✅    ✅ Existing patient found with ID: 841862b6-562d-466d-bbe3-040191d78347
[15:38:58] 🔄 
🔄 Step 6: Pushing order to API...
[15:38:58] [DOC: 9268264] ℹ️  Pushing order via API for patient ID: 841862b6-562d-466d-bbe3-040191d78347
[15:39:00] [DOC: 9268264] ❌ Order push failed with status 201: {"id":"8d6e42e7-799b-41c6-9890-d52cd2b57a4c","orderWAVId":"ORD19957","orderNo":"18016","orderDate":"04/29/2025","startOfCare":"01/22/2020","episodeStartDate":"04/25/2025","episodeEndDate":"06/23/2025","documentID":"9268264","mrn":"18016","patientName":"Leite, Craig","sentToPhysicianDate":"04/30/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":null,"signedByPhysicianStatus":false,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"841862b6-562d-466d-bbe3-040191d78347","companyId":"d598757a-87c6-4192-bcde-ff8d6e0b91ad","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[15:39:00] ❌    ❌ Failed to push order
[15:39:00] 🔄 
🔄 Step 7: Writing to CSV...
[15:39:00] [DOC: 9268264] ℹ️  Calculated age: 37 from DOB: 12/14/1987
[15:39:00] [DOC: 9268264] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:39:00] [DOC: 9268264] ℹ️  Payer Source extracted: ''
[15:39:00] [DOC: 9268264] ℹ️  Diagnosis codes being written:
[15:39:00] [DOC: 9268264] ℹ️    - Latest_Episode_Firstdiagnosis: 'F25.0'
[15:39:00] [DOC: 9268264] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[15:39:00] [DOC: 9268264] ℹ️    - Latest_Episode_Thirddiagnosis: 'E03.9'
[15:39:00] [DOC: 9268264] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.9'
[15:39:00] [DOC: 9268264] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E78.00'
[15:39:00] [DOC: 9268264] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E66.09'
[15:39:00] [DOC: 9268264] ✅ Patient data written to CSV: Craig Leite | Sex: MALE | Age: 37 | Service: Skilled Nursing | Payer:  | MRN: 18016
[15:39:00] ✅    ✅ Document 9268264 processed and saved successfully
[15:39:00] 🔄 
🔄 Step 8: Saving API details...
[15:39:00] [DOC: 9268264] ℹ️  API push details saved for document 9268264
[15:39:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9270375                         ║
================================================================================
[15:39:00] ℹ️  Agency: Brigham Home Care Services.Inc
[15:39:00] ℹ️  Date: 04/30/2025
[15:39:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:39:04] [DOC: 9270375] ✅ Text extracted using pdfplumber (17413 chars)
[15:39:04] ✅    ✅ Text extracted using pdfplumber (17413 chars)
[15:39:04] 🔄 
🔄 Step 2: Extracting patient data...
[15:39:07] ℹ️  AI extracted raw sex value: 'F'
[15:39:07] ℹ️  AI extracted service line: 'Skilled Nursing, Home Health Aide'
[15:39:07] ℹ️  AI extracted payer source: ''
[15:39:07] ℹ️  AI extracted diagnoses:
[15:39:07] ℹ️    - Diagnosis 1: 'J45.909'
[15:39:07] ℹ️    - Diagnosis 2: 'Z91.148'
[15:39:07] ℹ️    - Diagnosis 3: 'M62.838'
[15:39:07] ℹ️    - Diagnosis 4: 'G58.9'
[15:39:07] ℹ️    - Diagnosis 5: 'G89.4'
[15:39:07] ℹ️    - Diagnosis 6: 'K59.00'
[15:39:07] ℹ️  Final extracted MRN: '2327'
[15:39:07] ℹ️  Final extracted Sex: 'FEMALE'
[15:39:07] ℹ️  Final extracted Service Line: 'Skilled Nursing, Home Health Aide'
[15:39:07] ℹ️  Final extracted Payer Source: ''
[15:39:07] ✅ Patient data extraction completed successfully
[15:39:07] ✅    ✅ Patient data extracted successfully
[15:39:07] 📊 Patient Response
     └─ patientFName: NITZA
     └─ patientLName: VALE
     └─ dob: 10/07/1979
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2327
     └─ billingProvider: Brigham Home Care Services, Inc
     └─ npi: 227605
     └─ physicianNPI: 1730593195
     └─ nameOfAgency: Brigham Home Care Services, Inc
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343-1171
     └─ email: 
     └─ phoneNumber: 5088570627
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/10/2023', 'startOfEpisode': '04/29/2025', 'endOfEpisode': '06/27/2025', 'firstDiagnosis': 'J45.909', 'secondDiagnosis': 'Z91.148', 'thirdDiagnosis': 'M62.838', 'fourthDiagnosis': 'G58.9', 'fifthDiagnosis': 'G89.4', 'sixthDiagnosis': 'K59.00'}]
[15:39:07] ✅    ✅ Patient identified: NITZA VALE
[15:39:07] ✅    ✅ Patient name validation passed
[15:39:07] 🔄 
🔄 Step 3: Processing patient dates...
[15:39:07] [DOC: 9270375] ℹ️  DOB normalized: 10/07/1979
[15:39:07] [DOC: 9270375] ℹ️  Episode startOfCare normalized: 05/10/2023
[15:39:07] [DOC: 9270375] ℹ️  Episode startOfEpisode normalized: 04/29/2025
[15:39:07] [DOC: 9270375] ℹ️  Episode endOfEpisode normalized: 06/27/2025
[15:39:07] [DOC: 9270375] ✅ Patient date processing completed successfully
[15:39:07] ✅    ✅ Date processing completed
[15:39:07] 📊 Processed Patient Data
     └─ patientFName: NITZA
     └─ patientLName: VALE
     └─ dob: 10/07/1979
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2327
     └─ billingProvider: Brigham Home Care Services, Inc
     └─ npi: 227605
     └─ physicianNPI: 1730593195
     └─ nameOfAgency: Brigham Home Care Services, Inc
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343-1171
     └─ email: 
     └─ phoneNumber: 5088570627
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/10/2023', 'startOfEpisode': '04/29/2025', 'endOfEpisode': '06/27/2025', 'firstDiagnosis': 'J45.909', 'secondDiagnosis': 'Z91.148', 'thirdDiagnosis': 'M62.838', 'fourthDiagnosis': 'G58.9', 'fifthDiagnosis': 'G89.4', 'sixthDiagnosis': 'K59.00'}]
[15:39:07] 🔄 
🔄 Step 4: Extracting order data...
[15:39:10] ℹ️  Order extraction - MRN: '2327'
[15:39:10] ℹ️  Order extraction - Sex: 'FEMALE'
[15:39:10] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide'
[15:39:10] ℹ️  Order extraction - Payer Source: ''
[15:39:10] ✅ Order data extraction completed successfully
[15:39:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:39:10] ℹ️  Using MRN from patient data: '2327' over '2327'
[15:39:10] ℹ️  Combined service lines: Patient='Skilled Nursing, Home Health Aide' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide' = 'Home Health Aide, Occupational Therapy, Physical Therapy, Skilled Nursing'
[15:39:10] ✅ Patient name cross-validation successful
[15:39:10] ✅    ✅ Data merged successfully
[15:39:11] ⚠️     ❌ Skipping - missing company ID for agency: Brigham Home Care Services.Inc
[15:39:11] [DOC: 9270375] ℹ️  API push details saved for document 9270375
================================================================================
║                        Processing Document ID: 9270178                         ║
================================================================================
[15:39:11] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:39:11] ℹ️  Date: 04/30/2025
[15:39:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:39:14] [DOC: 9270178] ✅ Text extracted using pdfplumber (16877 chars)
[15:39:14] ✅    ✅ Text extracted using pdfplumber (16877 chars)
[15:39:14] 🔄 
🔄 Step 2: Extracting patient data...
[15:39:17] ℹ️  AI extracted raw sex value: 'F'
[15:39:17] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:39:17] ℹ️  AI extracted payer source: 'Medicare'
[15:39:17] ℹ️  AI extracted diagnoses:
[15:39:17] ℹ️    - Diagnosis 1: 'J44.1'
[15:39:17] ℹ️    - Diagnosis 2: 'I10'
[15:39:17] ℹ️    - Diagnosis 3: 'E11.65'
[15:39:17] ℹ️    - Diagnosis 4: 'I48.0'
[15:39:17] ℹ️    - Diagnosis 5: 'I25.10'
[15:39:17] ℹ️    - Diagnosis 6: 'J96.21'
[15:39:17] ℹ️  Final extracted MRN: '100990744'
[15:39:17] ℹ️  Final extracted Sex: 'FEMALE'
[15:39:17] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:39:17] ℹ️  Final extracted Payer Source: 'Medicare'
[15:39:17] ✅ Patient data extraction completed successfully
[15:39:17] ✅    ✅ Patient data extracted successfully
[15:39:17] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Grace
     └─ dob: 10/21/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990744
     └─ billingProvider: DHUNGANA PARAJULI, SIRJANA MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 114 Riverside Ave, APT 250
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (978) 648-4780
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2024', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'J96.21'}]
[15:39:17] ✅    ✅ Patient identified: Barbara Grace
[15:39:17] ✅    ✅ Patient name validation passed
[15:39:17] 🔄 
🔄 Step 3: Processing patient dates...
[15:39:17] [DOC: 9270178] ℹ️  DOB normalized: 10/21/1948
[15:39:17] [DOC: 9270178] ℹ️  Episode startOfCare normalized: 03/01/2024
[15:39:17] [DOC: 9270178] ℹ️  Episode startOfEpisode normalized: 04/25/2025
[15:39:17] [DOC: 9270178] ℹ️  Episode endOfEpisode normalized: 06/23/2025
[15:39:17] [DOC: 9270178] ✅ Patient date processing completed successfully
[15:39:17] ✅    ✅ Date processing completed
[15:39:17] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Grace
     └─ dob: 10/21/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990744
     └─ billingProvider: DHUNGANA PARAJULI, SIRJANA MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 114 Riverside Ave, APT 250
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (978) 648-4780
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2024', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': 'I48.0', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'J96.21'}]
[15:39:17] 🔄 
🔄 Step 4: Extracting order data...
[15:39:20] ℹ️  Order extraction - MRN: '100990744'
[15:39:20] ℹ️  Order extraction - Sex: 'FEMALE'
[15:39:20] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:39:20] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:39:20] ✅ Order data extraction completed successfully
[15:39:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:39:20] ℹ️  Using MRN from patient data: '100990744' over '100990744'
[15:39:20] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:39:20] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:39:20] ✅ Patient name cross-validation successful
[15:39:20] ✅    ✅ Data merged successfully
[15:39:21] ✅    ✅ Order data extracted and validated
[15:39:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:39:21] [DOC: 9270178] ✅ Patient found in local cache: Barbara Grace, ID: 579e1f1c-438b-4928-9793-bad56e38e647
[15:39:21] ✅    ✅ Existing patient found with ID: 579e1f1c-438b-4928-9793-bad56e38e647
[15:39:21] 🔄 
🔄 Step 6: Pushing order to API...
[15:39:21] [DOC: 9270178] ℹ️  Pushing order via API for patient ID: 579e1f1c-438b-4928-9793-bad56e38e647
[15:39:22] [DOC: 9270178] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13819"}
[15:39:22] ❌    ❌ Failed to push order
[15:39:22] 🔄 
🔄 Step 7: Writing to CSV...
[15:39:22] [DOC: 9270178] ℹ️  Calculated age: 76 from DOB: 10/21/1948
[15:39:22] [DOC: 9270178] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:39:22] [DOC: 9270178] ℹ️  Payer Source extracted: 'Medicare'
[15:39:22] [DOC: 9270178] ℹ️  Diagnosis codes being written:
[15:39:22] [DOC: 9270178] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[15:39:22] [DOC: 9270178] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[15:39:22] [DOC: 9270178] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.65'
[15:39:22] [DOC: 9270178] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.0'
[15:39:22] [DOC: 9270178] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I25.10'
[15:39:22] [DOC: 9270178] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J96.21'
[15:39:22] [DOC: 9270178] ✅ Patient data written to CSV: Barbara Grace | Sex: FEMALE | Age: 76 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: 100990744
[15:39:22] ✅    ✅ Document 9270178 processed and saved successfully
[15:39:22] 🔄 
🔄 Step 8: Saving API details...
[15:39:22] [DOC: 9270178] ℹ️  API push details saved for document 9270178
[15:39:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9269909                         ║
================================================================================
[15:39:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:39:22] ℹ️  Date: 04/30/2025
[15:39:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:39:26] [DOC: 9269909] ✅ Text extracted using pdfplumber (12401 chars)
[15:39:26] ✅    ✅ Text extracted using pdfplumber (12401 chars)
[15:39:26] 🔄 
🔄 Step 2: Extracting patient data...
[15:39:29] ℹ️  AI extracted raw sex value: 'M'
[15:39:29] ℹ️  AI extracted service line: 'OT'
[15:39:29] ℹ️  AI extracted payer source: 'None'
[15:39:29] ℹ️  AI extracted diagnoses:
[15:39:29] ℹ️    - Diagnosis 1: 'Bilateral shoulder tendonitis'
[15:39:29] ℹ️    - Diagnosis 2: 'muscle weakness'
[15:39:29] ℹ️    - Diagnosis 3: 'None'
[15:39:29] ℹ️    - Diagnosis 4: 'None'
[15:39:29] ℹ️    - Diagnosis 5: 'None'
[15:39:29] ℹ️    - Diagnosis 6: 'None'
[15:39:29] ℹ️  Final extracted MRN: 'MA230420103801'
[15:39:29] ℹ️  Final extracted Sex: 'MALE'
[15:39:29] ℹ️  Final extracted Service Line: 'OT'
[15:39:29] ℹ️  Final extracted Payer Source: ''
[15:39:29] ✅ Patient data extraction completed successfully
[15:39:29] ✅    ✅ Patient data extracted successfully
[15:39:29] 📊 Patient Response
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/24/2025', 'endOfEpisode': None, 'firstDiagnosis': 'Bilateral shoulder tendonitis', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:39:29] ✅    ✅ Patient identified: Alfredo Santos
[15:39:29] ✅    ✅ Patient name validation passed
[15:39:29] 🔄 
🔄 Step 3: Processing patient dates...
[15:39:29] [DOC: 9269909] ℹ️  DOB normalized: 10/24/1938
[15:39:29] [DOC: 9269909] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[15:39:29] [DOC: 9269909] ✅ Patient date processing completed successfully
[15:39:29] ✅    ✅ Date processing completed
[15:39:29] 📊 Processed Patient Data
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/24/2025', 'firstDiagnosis': 'Bilateral shoulder tendonitis', 'secondDiagnosis': 'muscle weakness'}]
[15:39:29] 🔄 
🔄 Step 4: Extracting order data...
[15:39:31] ℹ️  Order extraction - MRN: 'MA230420103801'
[15:39:31] ℹ️  Order extraction - Sex: 'MALE'
[15:39:31] ℹ️  Order extraction - Service Line: 'OT'
[15:39:31] ℹ️  Order extraction - Payer Source: ''
[15:39:31] ✅ Order data extraction completed successfully
[15:39:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:39:31] ℹ️  Using MRN from patient data: 'MA230420103801' over 'MA230420103801'
[15:39:31] ℹ️  Service line consistent in both sources: 'OT'
[15:39:31] ✅ Patient name cross-validation successful
[15:39:31] ✅    ✅ Data merged successfully
[15:39:33] ⚠️     ❌ Skipping - missing episode start date
[15:39:33] [DOC: 9269909] ℹ️  API push details saved for document 9269909
================================================================================
║                        Processing Document ID: 9269907                         ║
================================================================================
[15:39:33] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:39:33] ℹ️  Date: 04/30/2025
[15:39:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:39:35] [DOC: 9269907] ✅ Text extracted using pdfplumber (1489 chars)
[15:39:35] ✅    ✅ Text extracted using pdfplumber (1489 chars)
[15:39:35] 🔄 
🔄 Step 2: Extracting patient data...
[15:39:38] ℹ️  AI extracted raw sex value: ''
[15:39:38] ℹ️  AI extracted service line: 'Occupational Therapy'
[15:39:38] ℹ️  AI extracted payer source: ''
[15:39:38] ℹ️  AI extracted diagnoses:
[15:39:38] ℹ️    - Diagnosis 1: 'M67.813'
[15:39:38] ℹ️    - Diagnosis 2: 'M67.814'
[15:39:38] ℹ️    - Diagnosis 3: 'M15.9'
[15:39:38] ℹ️    - Diagnosis 4: 'None'
[15:39:38] ℹ️    - Diagnosis 5: 'None'
[15:39:38] ℹ️    - Diagnosis 6: 'None'
[15:39:38] ℹ️  Final extracted MRN: 'MA230420103801'
[15:39:38] ℹ️  Final extracted Sex: ''
[15:39:38] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[15:39:38] ℹ️  Final extracted Payer Source: ''
[15:39:38] ✅ Patient data extraction completed successfully
[15:39:38] ✅    ✅ Patient data extracted successfully
[15:39:38] 📊 Patient Response
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:39:38] ✅    ✅ Patient identified: Alfredo Santos
[15:39:38] ✅    ✅ Patient name validation passed
[15:39:38] 🔄 
🔄 Step 3: Processing patient dates...
[15:39:38] [DOC: 9269907] ℹ️  DOB normalized: 10/24/1938
[15:39:38] [DOC: 9269907] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[15:39:38] [DOC: 9269907] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[15:39:38] [DOC: 9269907] ✅ Patient date processing completed successfully
[15:39:38] ✅    ✅ Date processing completed
[15:39:38] 📊 Processed Patient Data
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9'}]
[15:39:38] 🔄 
🔄 Step 4: Extracting order data...
[15:39:40] ℹ️  Order extraction - MRN: 'MA230420103801'
[15:39:40] ℹ️  Order extraction - Sex: ''
[15:39:40] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[15:39:40] ℹ️  Order extraction - Payer Source: ''
[15:39:40] ✅ Order data extraction completed successfully
[15:39:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:39:40] ℹ️  Using MRN from patient data: 'MA230420103801' over 'MA230420103801'
[15:39:40] ⚠️  Could not determine sex using any available method
[15:39:40] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[15:39:40] ✅ Patient name cross-validation successful
[15:39:40] ✅    ✅ Data merged successfully
[15:39:42] ✅    ✅ Order data extracted and validated
[15:39:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:39:42] [DOC: 9269907] ✅ Patient found in local cache: Alfredo Santos, ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[15:39:42] ✅    ✅ Existing patient found with ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[15:39:42] 🔄 
🔄 Step 6: Pushing order to API...
[15:39:42] [DOC: 9269907] ℹ️  Pushing order via API for patient ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[15:39:43] [DOC: 9269907] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14362"}
[15:39:43] ❌    ❌ Failed to push order
[15:39:43] 🔄 
🔄 Step 7: Writing to CSV...
[15:39:43] [DOC: 9269907] ℹ️  Calculated age: 86 from DOB: 10/24/1938
[15:39:43] [DOC: 9269907] ℹ️  Service Line extracted: 'Occupational Therapy'
[15:39:43] [DOC: 9269907] ℹ️  Payer Source extracted: ''
[15:39:43] [DOC: 9269907] ℹ️  Diagnosis codes being written:
[15:39:43] [DOC: 9269907] ℹ️    - Latest_Episode_Firstdiagnosis: 'M67.813'
[15:39:43] [DOC: 9269907] ℹ️    - Latest_Episode_Seconddiagnosis: 'M67.814'
[15:39:43] [DOC: 9269907] ℹ️    - Latest_Episode_Thirddiagnosis: 'M15.9'
[15:39:43] [DOC: 9269907] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:39:43] [DOC: 9269907] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:39:43] [DOC: 9269907] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:39:43] [DOC: 9269907] ✅ Patient data written to CSV: Alfredo Santos | Sex:  | Age: 86 | Service: Occupational Therapy | Payer:  | MRN: MA230420103801
[15:39:43] ✅    ✅ Document 9269907 processed and saved successfully
[15:39:43] 🔄 
🔄 Step 8: Saving API details...
[15:39:43] [DOC: 9269907] ℹ️  API push details saved for document 9269907
[15:39:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9269903                         ║
================================================================================
[15:39:43] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:39:43] ℹ️  Date: 04/30/2025
[15:39:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:39:45] [DOC: 9269903] ✅ Text extracted using pdfplumber (1222 chars)
[15:39:45] ✅    ✅ Text extracted using pdfplumber (1222 chars)
[15:39:45] 🔄 
🔄 Step 2: Extracting patient data...
[15:39:48] ℹ️  AI extracted raw sex value: ''
[15:39:48] ℹ️  AI extracted service line: 'Occupational Therapy'
[15:39:48] ℹ️  AI extracted payer source: ''
[15:39:48] ℹ️  AI extracted diagnoses:
[15:39:48] ℹ️    - Diagnosis 1: 'M67.813'
[15:39:48] ℹ️    - Diagnosis 2: 'M67.814'
[15:39:48] ℹ️    - Diagnosis 3: 'M15.9'
[15:39:48] ℹ️    - Diagnosis 4: ''
[15:39:48] ℹ️    - Diagnosis 5: ''
[15:39:48] ℹ️    - Diagnosis 6: ''
[15:39:48] ℹ️  Final extracted MRN: 'MA230420103801'
[15:39:48] ℹ️  Final extracted Sex: ''
[15:39:48] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[15:39:48] ℹ️  Final extracted Payer Source: ''
[15:39:48] ✅ Patient data extraction completed successfully
[15:39:48] ✅    ✅ Patient data extracted successfully
[15:39:48] 📊 Patient Response
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:39:48] ✅    ✅ Patient identified: Alfredo Santos
[15:39:48] ✅    ✅ Patient name validation passed
[15:39:48] 🔄 
🔄 Step 3: Processing patient dates...
[15:39:48] [DOC: 9269903] ℹ️  DOB normalized: 10/24/1938
[15:39:48] [DOC: 9269903] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[15:39:48] [DOC: 9269903] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[15:39:48] [DOC: 9269903] ✅ Patient date processing completed successfully
[15:39:48] ✅    ✅ Date processing completed
[15:39:48] 📊 Processed Patient Data
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:39:48] 🔄 
🔄 Step 4: Extracting order data...
[15:39:50] ℹ️  Order extraction - MRN: 'MA230420103801'
[15:39:50] ℹ️  Order extraction - Sex: ''
[15:39:50] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[15:39:50] ℹ️  Order extraction - Payer Source: ''
[15:39:50] ✅ Order data extraction completed successfully
[15:39:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:39:50] ℹ️  Using MRN from patient data: 'MA230420103801' over 'MA230420103801'
[15:39:50] ⚠️  Could not determine sex using any available method
[15:39:50] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[15:39:50] ✅ Patient name cross-validation successful
[15:39:50] ✅    ✅ Data merged successfully
[15:39:52] ✅    ✅ Order data extracted and validated
[15:39:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:39:52] [DOC: 9269903] ✅ Patient found in local cache: Alfredo Santos, ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[15:39:52] ✅    ✅ Existing patient found with ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[15:39:52] 🔄 
🔄 Step 6: Pushing order to API...
[15:39:52] [DOC: 9269903] ℹ️  Pushing order via API for patient ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[15:39:53] [DOC: 9269903] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14364"}
[15:39:53] ❌    ❌ Failed to push order
[15:39:53] 🔄 
🔄 Step 7: Writing to CSV...
[15:39:53] [DOC: 9269903] ℹ️  Calculated age: 86 from DOB: 10/24/1938
[15:39:53] [DOC: 9269903] ℹ️  Service Line extracted: 'Occupational Therapy'
[15:39:53] [DOC: 9269903] ℹ️  Payer Source extracted: ''
[15:39:53] [DOC: 9269903] ℹ️  Diagnosis codes being written:
[15:39:53] [DOC: 9269903] ℹ️    - Latest_Episode_Firstdiagnosis: 'M67.813'
[15:39:53] [DOC: 9269903] ℹ️    - Latest_Episode_Seconddiagnosis: 'M67.814'
[15:39:53] [DOC: 9269903] ℹ️    - Latest_Episode_Thirddiagnosis: 'M15.9'
[15:39:53] [DOC: 9269903] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:39:53] [DOC: 9269903] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:39:53] [DOC: 9269903] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:39:53] [DOC: 9269903] ✅ Patient data written to CSV: Alfredo Santos | Sex:  | Age: 86 | Service: Occupational Therapy | Payer:  | MRN: MA230420103801
[15:39:53] ✅    ✅ Document 9269903 processed and saved successfully
[15:39:53] 🔄 
🔄 Step 8: Saving API details...
[15:39:53] [DOC: 9269903] ℹ️  API push details saved for document 9269903
[15:39:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9269900                         ║
================================================================================
[15:39:53] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:39:53] ℹ️  Date: 04/30/2025
[15:39:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:39:55] [DOC: 9269900] ✅ Text extracted using pdfplumber (1217 chars)
[15:39:55] ✅    ✅ Text extracted using pdfplumber (1217 chars)
[15:39:55] 🔄 
🔄 Step 2: Extracting patient data...
[15:39:58] ℹ️  AI extracted raw sex value: ''
[15:39:58] ℹ️  AI extracted service line: 'Occupational Therapy'
[15:39:58] ℹ️  AI extracted payer source: ''
[15:39:58] ℹ️  AI extracted diagnoses:
[15:39:58] ℹ️    - Diagnosis 1: 'M67.813'
[15:39:58] ℹ️    - Diagnosis 2: 'M67.814'
[15:39:58] ℹ️    - Diagnosis 3: 'M15.9'
[15:39:58] ℹ️    - Diagnosis 4: 'None'
[15:39:58] ℹ️    - Diagnosis 5: 'None'
[15:39:58] ℹ️    - Diagnosis 6: 'None'
[15:39:58] ℹ️  Final extracted MRN: 'MA230420103801'
[15:39:58] ℹ️  Final extracted Sex: ''
[15:39:58] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[15:39:58] ℹ️  Final extracted Payer Source: ''
[15:39:58] ✅ Patient data extraction completed successfully
[15:39:58] ✅    ✅ Patient data extracted successfully
[15:39:58] 📊 Patient Response
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:39:58] ✅    ✅ Patient identified: Alfredo Santos
[15:39:58] ✅    ✅ Patient name validation passed
[15:39:58] 🔄 
🔄 Step 3: Processing patient dates...
[15:39:58] [DOC: 9269900] ℹ️  DOB normalized: 10/24/1938
[15:39:58] [DOC: 9269900] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[15:39:58] [DOC: 9269900] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[15:39:58] [DOC: 9269900] ✅ Patient date processing completed successfully
[15:39:58] ✅    ✅ Date processing completed
[15:39:58] 📊 Processed Patient Data
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9'}]
[15:39:58] 🔄 
🔄 Step 4: Extracting order data...
[15:40:00] ℹ️  Order extraction - MRN: 'MA230420103801'
[15:40:00] ℹ️  Order extraction - Sex: ''
[15:40:00] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[15:40:00] ℹ️  Order extraction - Payer Source: ''
[15:40:00] ✅ Order data extraction completed successfully
[15:40:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:40:00] ℹ️  Using MRN from patient data: 'MA230420103801' over 'MA230420103801'
[15:40:00] ⚠️  Could not determine sex using any available method
[15:40:00] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[15:40:00] ✅ Patient name cross-validation successful
[15:40:00] ✅    ✅ Data merged successfully
[15:40:02] ✅    ✅ Order data extracted and validated
[15:40:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:40:02] [DOC: 9269900] ✅ Patient found in local cache: Alfredo Santos, ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[15:40:02] ✅    ✅ Existing patient found with ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[15:40:02] 🔄 
🔄 Step 6: Pushing order to API...
[15:40:02] [DOC: 9269900] ℹ️  Pushing order via API for patient ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[15:40:03] [DOC: 9269900] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14365"}
[15:40:03] ❌    ❌ Failed to push order
[15:40:03] 🔄 
🔄 Step 7: Writing to CSV...
[15:40:03] [DOC: 9269900] ℹ️  Calculated age: 86 from DOB: 10/24/1938
[15:40:03] [DOC: 9269900] ℹ️  Service Line extracted: 'Occupational Therapy'
[15:40:03] [DOC: 9269900] ℹ️  Payer Source extracted: ''
[15:40:03] [DOC: 9269900] ℹ️  Diagnosis codes being written:
[15:40:03] [DOC: 9269900] ℹ️    - Latest_Episode_Firstdiagnosis: 'M67.813'
[15:40:03] [DOC: 9269900] ℹ️    - Latest_Episode_Seconddiagnosis: 'M67.814'
[15:40:03] [DOC: 9269900] ℹ️    - Latest_Episode_Thirddiagnosis: 'M15.9'
[15:40:03] [DOC: 9269900] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:40:03] [DOC: 9269900] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:40:03] [DOC: 9269900] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:40:03] [DOC: 9269900] ✅ Patient data written to CSV: Alfredo Santos | Sex:  | Age: 86 | Service: Occupational Therapy | Payer:  | MRN: MA230420103801
[15:40:03] ✅    ✅ Document 9269900 processed and saved successfully
[15:40:03] 🔄 
🔄 Step 8: Saving API details...
[15:40:03] [DOC: 9269900] ℹ️  API push details saved for document 9269900
[15:40:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9269897                         ║
================================================================================
[15:40:03] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:40:03] ℹ️  Date: 04/30/2025
[15:40:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:40:06] [DOC: 9269897] ✅ Text extracted using pdfplumber (11219 chars)
[15:40:06] ✅    ✅ Text extracted using pdfplumber (11219 chars)
[15:40:06] 🔄 
🔄 Step 2: Extracting patient data...
[15:40:09] ℹ️  AI extracted raw sex value: 'M'
[15:40:09] ℹ️  AI extracted service line: 'OT'
[15:40:09] ℹ️  AI extracted payer source: ''
[15:40:09] ℹ️  AI extracted diagnoses:
[15:40:09] ℹ️    - Diagnosis 1: 'Bilateral shoulder tendonitis'
[15:40:09] ℹ️    - Diagnosis 2: ''
[15:40:09] ℹ️    - Diagnosis 3: ''
[15:40:09] ℹ️    - Diagnosis 4: ''
[15:40:09] ℹ️    - Diagnosis 5: ''
[15:40:09] ℹ️    - Diagnosis 6: ''
[15:40:09] ℹ️  Final extracted MRN: 'MA230420103801'
[15:40:09] ℹ️  Final extracted Sex: 'MALE'
[15:40:09] ℹ️  Final extracted Service Line: 'OT'
[15:40:09] ℹ️  Final extracted Payer Source: ''
[15:40:09] ✅ Patient data extraction completed successfully
[15:40:09] ✅    ✅ Patient data extracted successfully
[15:40:09] 📊 Patient Response
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'Bilateral shoulder tendonitis', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:40:09] ✅    ✅ Patient identified: Alfredo Santos
[15:40:09] ✅    ✅ Patient name validation passed
[15:40:09] 🔄 
🔄 Step 3: Processing patient dates...
[15:40:09] [DOC: 9269897] ℹ️  DOB normalized: 10/24/1938
[15:40:09] [DOC: 9269897] ✅ Patient date processing completed successfully
[15:40:09] ✅    ✅ Date processing completed
[15:40:09] 📊 Processed Patient Data
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'Bilateral shoulder tendonitis', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:40:09] 🔄 
🔄 Step 4: Extracting order data...
[15:40:11] ℹ️  Order extraction - MRN: 'MA230420103801'
[15:40:11] ℹ️  Order extraction - Sex: 'MALE'
[15:40:11] ℹ️  Order extraction - Service Line: 'OT'
[15:40:11] ℹ️  Order extraction - Payer Source: ''
[15:40:11] ✅ Order data extraction completed successfully
[15:40:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:40:11] ℹ️  Using MRN from patient data: 'MA230420103801' over 'MA230420103801'
[15:40:11] ℹ️  Service line consistent in both sources: 'OT'
[15:40:11] ✅ Patient name cross-validation successful
[15:40:11] ✅    ✅ Data merged successfully
[15:40:12] ⚠️     ❌ Skipping - missing episode start date
[15:40:12] [DOC: 9269897] ℹ️  API push details saved for document 9269897
================================================================================
║                        Processing Document ID: 9269892                         ║
================================================================================
[15:40:12] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:40:12] ℹ️  Date: 04/30/2025
[15:40:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:40:17] [DOC: 9269892] ✅ Text extracted using pdfplumber (17992 chars)
[15:40:17] ✅    ✅ Text extracted using pdfplumber (17980 chars)
[15:40:17] 🔄 
🔄 Step 2: Extracting patient data...
[15:40:20] ℹ️  AI extracted raw sex value: 'M'
[15:40:20] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:40:20] ℹ️  AI extracted payer source: 'Medicare'
[15:40:20] ℹ️  AI extracted diagnoses:
[15:40:20] ℹ️    - Diagnosis 1: 'A04.72'
[15:40:20] ℹ️    - Diagnosis 2: 'E11.9'
[15:40:20] ℹ️    - Diagnosis 3: 'E87.1'
[15:40:20] ℹ️    - Diagnosis 4: 'J44.89'
[15:40:20] ℹ️    - Diagnosis 5: 'I11.0'
[15:40:20] ℹ️    - Diagnosis 6: 'I50.32'
[15:40:20] ℹ️  Final extracted MRN: 'MA250414053302'
[15:40:20] ℹ️  Final extracted Sex: 'MALE'
[15:40:20] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:40:20] ℹ️  Final extracted Payer Source: 'Medicare'
[15:40:20] ✅ Patient data extraction completed successfully
[15:40:20] ✅    ✅ Patient data extracted successfully
[15:40:20] 📊 Patient Response
     └─ patientFName: Serafim
     └─ patientLName: Mimoso
     └─ dob: 05/08/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250414053302
     └─ billingProvider: Martin, Daniel MD
     └─ npi: 1881923936
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 281 Davis St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (508) 993-8866
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/18/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E87.1', 'fourthDiagnosis': 'J44.89', 'fifthDiagnosis': 'I11.0', 'sixthDiagnosis': 'I50.32'}]
[15:40:20] ✅    ✅ Patient identified: Serafim Mimoso
[15:40:20] ✅    ✅ Patient name validation passed
[15:40:20] 🔄 
🔄 Step 3: Processing patient dates...
[15:40:20] [DOC: 9269892] ℹ️  DOB normalized: 05/08/1933
[15:40:20] [DOC: 9269892] ℹ️  Episode startOfCare normalized: 04/18/2025
[15:40:20] [DOC: 9269892] ℹ️  Episode startOfEpisode normalized: 04/18/2025
[15:40:20] [DOC: 9269892] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[15:40:20] [DOC: 9269892] ✅ Patient date processing completed successfully
[15:40:20] ✅    ✅ Date processing completed
[15:40:20] 📊 Processed Patient Data
     └─ patientFName: Serafim
     └─ patientLName: Mimoso
     └─ dob: 05/08/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250414053302
     └─ billingProvider: Martin, Daniel MD
     └─ npi: 1881923936
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 281 Davis St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (508) 993-8866
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/18/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E87.1', 'fourthDiagnosis': 'J44.89', 'fifthDiagnosis': 'I11.0', 'sixthDiagnosis': 'I50.32'}]
[15:40:20] 🔄 
🔄 Step 4: Extracting order data...
[15:40:23] ℹ️  Order extraction - MRN: 'MA250414053302'
[15:40:23] ℹ️  Order extraction - Sex: 'MALE'
[15:40:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:40:23] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:40:23] ✅ Order data extraction completed successfully
[15:40:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:40:23] ℹ️  Using MRN from patient data: 'MA250414053302' over 'MA250414053302'
[15:40:23] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:40:23] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:40:23] ✅ Patient name cross-validation successful
[15:40:23] ✅    ✅ Data merged successfully
[15:40:24] ✅    ✅ Order data extracted and validated
[15:40:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:40:24] [DOC: 9269892] ✅ Patient found in local cache: Serafim Mimoso, ID: 0849f00a-166d-4c7d-969a-5567b25056c1
[15:40:24] ✅    ✅ Existing patient found with ID: 0849f00a-166d-4c7d-969a-5567b25056c1
[15:40:24] 🔄 
🔄 Step 6: Pushing order to API...
[15:40:24] [DOC: 9269892] ℹ️  Pushing order via API for patient ID: 0849f00a-166d-4c7d-969a-5567b25056c1
[15:40:25] [DOC: 9269892] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14107"}
[15:40:25] ❌    ❌ Failed to push order
[15:40:25] 🔄 
🔄 Step 7: Writing to CSV...
[15:40:25] [DOC: 9269892] ℹ️  Calculated age: 92 from DOB: 05/08/1933
[15:40:25] [DOC: 9269892] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:40:25] [DOC: 9269892] ℹ️  Payer Source extracted: 'Medicare'
[15:40:25] [DOC: 9269892] ℹ️  Diagnosis codes being written:
[15:40:25] [DOC: 9269892] ℹ️    - Latest_Episode_Firstdiagnosis: 'A04.72'
[15:40:25] [DOC: 9269892] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[15:40:25] [DOC: 9269892] ℹ️    - Latest_Episode_Thirddiagnosis: 'E87.1'
[15:40:25] [DOC: 9269892] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J44.89'
[15:40:25] [DOC: 9269892] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I11.0'
[15:40:25] [DOC: 9269892] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I50.32'
[15:40:25] [DOC: 9269892] ✅ Patient data written to CSV: Serafim Mimoso | Sex: MALE | Age: 92 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: MA250414053302
[15:40:25] ✅    ✅ Document 9269892 processed and saved successfully
[15:40:25] 🔄 
🔄 Step 8: Saving API details...
[15:40:25] [DOC: 9269892] ℹ️  API push details saved for document 9269892
[15:40:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9269891                         ║
================================================================================
[15:40:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:40:25] ℹ️  Date: 04/30/2025
[15:40:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:40:28] [DOC: 9269891] ✅ Text extracted using pdfplumber (1286 chars)
[15:40:28] ✅    ✅ Text extracted using pdfplumber (1274 chars)
[15:40:28] 🔄 
🔄 Step 2: Extracting patient data...
[15:40:30] ℹ️  AI extracted raw sex value: ''
[15:40:30] ℹ️  AI extracted service line: 'Occupational Therapy'
[15:40:30] ℹ️  AI extracted payer source: ''
[15:40:30] ℹ️  AI extracted diagnoses:
[15:40:30] ℹ️    - Diagnosis 1: 'A04.72'
[15:40:30] ℹ️    - Diagnosis 2: 'E11.9'
[15:40:30] ℹ️    - Diagnosis 3: 'E87.1'
[15:40:30] ℹ️    - Diagnosis 4: 'None'
[15:40:30] ℹ️    - Diagnosis 5: 'None'
[15:40:30] ℹ️    - Diagnosis 6: 'None'
[15:40:30] ℹ️  Final extracted MRN: 'MA250414053302'
[15:40:30] ℹ️  Final extracted Sex: ''
[15:40:30] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[15:40:30] ℹ️  Final extracted Payer Source: ''
[15:40:30] ✅ Patient data extraction completed successfully
[15:40:30] ✅    ✅ Patient data extracted successfully
[15:40:30] 📊 Patient Response
     └─ patientFName: Serafim
     └─ patientLName: Mimoso
     └─ dob: 05/08/1933
     └─ patientSex: 
     └─ medicalRecordNo: MA250414053302
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E87.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:40:30] ✅    ✅ Patient identified: Serafim Mimoso
[15:40:30] ✅    ✅ Patient name validation passed
[15:40:30] 🔄 
🔄 Step 3: Processing patient dates...
[15:40:30] [DOC: 9269891] ℹ️  DOB normalized: 05/08/1933
[15:40:30] [DOC: 9269891] ℹ️  Episode startOfEpisode normalized: 04/18/2025
[15:40:30] [DOC: 9269891] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[15:40:30] [DOC: 9269891] ✅ Patient date processing completed successfully
[15:40:30] ✅    ✅ Date processing completed
[15:40:30] 📊 Processed Patient Data
     └─ patientFName: Serafim
     └─ patientLName: Mimoso
     └─ dob: 05/08/1933
     └─ patientSex: 
     └─ medicalRecordNo: MA250414053302
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E87.1'}]
[15:40:30] 🔄 
🔄 Step 4: Extracting order data...
[15:40:33] ℹ️  Order extraction - MRN: 'MA250414053302'
[15:40:33] ℹ️  Order extraction - Sex: ''
[15:40:33] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[15:40:33] ℹ️  Order extraction - Payer Source: ''
[15:40:33] ✅ Order data extraction completed successfully
[15:40:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:40:33] ℹ️  Using MRN from patient data: 'MA250414053302' over 'MA250414053302'
[15:40:33] ⚠️  Could not determine sex using any available method
[15:40:33] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[15:40:33] ✅ Patient name cross-validation successful
[15:40:33] ✅    ✅ Data merged successfully
[15:40:34] ✅    ✅ Order data extracted and validated
[15:40:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:40:34] [DOC: 9269891] ✅ Patient found in local cache: Serafim Mimoso, ID: 0849f00a-166d-4c7d-969a-5567b25056c1
[15:40:34] ✅    ✅ Existing patient found with ID: 0849f00a-166d-4c7d-969a-5567b25056c1
[15:40:34] 🔄 
🔄 Step 6: Pushing order to API...
[15:40:34] [DOC: 9269891] ℹ️  Pushing order via API for patient ID: 0849f00a-166d-4c7d-969a-5567b25056c1
[15:40:35] [DOC: 9269891] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14108"}
[15:40:35] ❌    ❌ Failed to push order
[15:40:35] 🔄 
🔄 Step 7: Writing to CSV...
[15:40:35] [DOC: 9269891] ℹ️  Calculated age: 92 from DOB: 05/08/1933
[15:40:35] [DOC: 9269891] ℹ️  Service Line extracted: 'Occupational Therapy'
[15:40:35] [DOC: 9269891] ℹ️  Payer Source extracted: ''
[15:40:35] [DOC: 9269891] ℹ️  Diagnosis codes being written:
[15:40:35] [DOC: 9269891] ℹ️    - Latest_Episode_Firstdiagnosis: 'A04.72'
[15:40:35] [DOC: 9269891] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[15:40:35] [DOC: 9269891] ℹ️    - Latest_Episode_Thirddiagnosis: 'E87.1'
[15:40:35] [DOC: 9269891] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:40:35] [DOC: 9269891] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:40:35] [DOC: 9269891] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:40:35] [DOC: 9269891] ✅ Patient data written to CSV: Serafim Mimoso | Sex:  | Age: 92 | Service: Occupational Therapy | Payer:  | MRN: MA250414053302
[15:40:35] ✅    ✅ Document 9269891 processed and saved successfully
[15:40:35] 🔄 
🔄 Step 8: Saving API details...
[15:40:35] [DOC: 9269891] ℹ️  API push details saved for document 9269891
[15:40:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9269887                         ║
================================================================================
[15:40:35] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:40:35] ℹ️  Date: 04/30/2025
[15:40:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:40:37] [DOC: 9269887] ✅ Text extracted using pdfplumber (1123 chars)
[15:40:37] ✅    ✅ Text extracted using pdfplumber (1111 chars)
[15:40:37] 🔄 
🔄 Step 2: Extracting patient data...
[15:40:40] ℹ️  AI extracted raw sex value: ''
[15:40:40] ℹ️  AI extracted service line: 'Soc'
[15:40:40] ℹ️  AI extracted payer source: ''
[15:40:40] ℹ️  AI extracted diagnoses:
[15:40:40] ℹ️    - Diagnosis 1: 'I11.0'
[15:40:40] ℹ️    - Diagnosis 2: 'I50.9'
[15:40:40] ℹ️    - Diagnosis 3: 'E11.9'
[15:40:40] ℹ️    - Diagnosis 4: ''
[15:40:40] ℹ️    - Diagnosis 5: ''
[15:40:40] ℹ️    - Diagnosis 6: ''
[15:40:40] ℹ️  Final extracted MRN: 'MA200210084304'
[15:40:40] ℹ️  Final extracted Sex: ''
[15:40:40] ℹ️  Final extracted Service Line: 'Soc'
[15:40:40] ℹ️  Final extracted Payer Source: ''
[15:40:40] ✅ Patient data extraction completed successfully
[15:40:40] ✅    ✅ Patient data extracted successfully
[15:40:40] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Lima
     └─ dob: 08/18/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA200210084304
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Soc
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/04/2025', 'endOfEpisode': '04/04/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:40:40] ✅    ✅ Patient identified: Mary Lima
[15:40:40] ✅    ✅ Patient name validation passed
[15:40:40] 🔄 
🔄 Step 3: Processing patient dates...
[15:40:40] [DOC: 9269887] ℹ️  DOB normalized: 08/18/1943
[15:40:40] [DOC: 9269887] ℹ️  Episode startOfEpisode normalized: 02/04/2025
[15:40:40] [DOC: 9269887] ℹ️  Episode endOfEpisode normalized: 04/04/2025
[15:40:40] [DOC: 9269887] ✅ Patient date processing completed successfully
[15:40:40] ✅    ✅ Date processing completed
[15:40:40] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Lima
     └─ dob: 08/18/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA200210084304
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Soc
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/04/2025', 'endOfEpisode': '04/04/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:40:40] 🔄 
🔄 Step 4: Extracting order data...
[15:40:43] ℹ️  Order extraction - MRN: 'MA200210084304'
[15:40:43] ℹ️  Order extraction - Sex: ''
[15:40:43] ℹ️  Order extraction - Service Line: 'Soc'
[15:40:43] ℹ️  Order extraction - Payer Source: ''
[15:40:43] ✅ Order data extraction completed successfully
[15:40:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:40:43] ℹ️  Using MRN from patient data: 'MA200210084304' over 'MA200210084304'
[15:40:43] ℹ️  Inferred sex as FEMALE from name: Mary
[15:40:43] ℹ️  Service line consistent in both sources: 'Soc'
[15:40:43] ✅ Patient name cross-validation successful
[15:40:43] ✅    ✅ Data merged successfully
[15:40:44] ✅    ✅ Order data extracted and validated
[15:40:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:40:44] [DOC: 9269887] ✅ Patient found in local cache: Mary Lima, ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[15:40:44] ✅    ✅ Existing patient found with ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[15:40:44] 🔄 
🔄 Step 6: Pushing order to API...
[15:40:44] [DOC: 9269887] ℹ️  Pushing order via API for patient ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[15:40:45] [DOC: 9269887] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13942"}
[15:40:45] ❌    ❌ Failed to push order
[15:40:45] 🔄 
🔄 Step 7: Writing to CSV...
[15:40:45] [DOC: 9269887] ℹ️  Calculated age: 81 from DOB: 08/18/1943
[15:40:45] [DOC: 9269887] ℹ️  Service Line extracted: 'Soc'
[15:40:45] [DOC: 9269887] ℹ️  Payer Source extracted: ''
[15:40:45] [DOC: 9269887] ℹ️  Diagnosis codes being written:
[15:40:45] [DOC: 9269887] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[15:40:45] [DOC: 9269887] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.9'
[15:40:45] [DOC: 9269887] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.9'
[15:40:45] [DOC: 9269887] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:40:45] [DOC: 9269887] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:40:45] [DOC: 9269887] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:40:45] [DOC: 9269887] ✅ Patient data written to CSV: Mary Lima | Sex: FEMALE | Age: 81 | Service: Soc | Payer:  | MRN: MA200210084304
[15:40:45] ✅    ✅ Document 9269887 processed and saved successfully
[15:40:45] 🔄 
🔄 Step 8: Saving API details...
[15:40:45] [DOC: 9269887] ℹ️  API push details saved for document 9269887
[15:40:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9269885                         ║
================================================================================
[15:40:45] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:40:45] ℹ️  Date: 04/30/2025
[15:40:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:40:47] [DOC: 9269885] ✅ Text extracted using pdfplumber (1240 chars)
[15:40:47] ✅    ✅ Text extracted using pdfplumber (1240 chars)
[15:40:47] 🔄 
🔄 Step 2: Extracting patient data...
[15:40:50] ℹ️  AI extracted raw sex value: ''
[15:40:50] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:40:50] ℹ️  AI extracted payer source: ''
[15:40:50] ℹ️  AI extracted diagnoses:
[15:40:50] ℹ️    - Diagnosis 1: 'I11.0'
[15:40:50] ℹ️    - Diagnosis 2: 'I50.42'
[15:40:50] ℹ️    - Diagnosis 3: 'I48.91'
[15:40:50] ℹ️    - Diagnosis 4: 'None'
[15:40:50] ℹ️    - Diagnosis 5: 'None'
[15:40:50] ℹ️    - Diagnosis 6: 'None'
[15:40:50] ℹ️  Final extracted MRN: '100999604'
[15:40:50] ℹ️  Final extracted Sex: ''
[15:40:50] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:40:50] ℹ️  Final extracted Payer Source: ''
[15:40:50] ✅ Patient data extraction completed successfully
[15:40:50] ✅    ✅ Patient data extracted successfully
[15:40:50] 📊 Patient Response
     └─ patientFName: Gisele
     └─ patientLName: Calheta
     └─ dob: 04/05/1941
     └─ patientSex: 
     └─ medicalRecordNo: 100999604
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/12/2025', 'endOfEpisode': '03/12/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.42', 'thirdDiagnosis': 'I48.91', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:40:50] ✅    ✅ Patient identified: Gisele Calheta
[15:40:50] ✅    ✅ Patient name validation passed
[15:40:50] 🔄 
🔄 Step 3: Processing patient dates...
[15:40:50] [DOC: 9269885] ℹ️  DOB normalized: 04/05/1941
[15:40:50] [DOC: 9269885] ℹ️  Episode startOfEpisode normalized: 01/12/2025
[15:40:50] [DOC: 9269885] ℹ️  Episode endOfEpisode normalized: 03/12/2025
[15:40:50] [DOC: 9269885] ✅ Patient date processing completed successfully
[15:40:50] ✅    ✅ Date processing completed
[15:40:50] 📊 Processed Patient Data
     └─ patientFName: Gisele
     └─ patientLName: Calheta
     └─ dob: 04/05/1941
     └─ patientSex: 
     └─ medicalRecordNo: 100999604
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/12/2025', 'endOfEpisode': '03/12/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.42', 'thirdDiagnosis': 'I48.91'}]
[15:40:50] 🔄 
🔄 Step 4: Extracting order data...
[15:40:52] ℹ️  Order extraction - MRN: '100999604'
[15:40:52] ℹ️  Order extraction - Sex: ''
[15:40:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:40:52] ℹ️  Order extraction - Payer Source: ''
[15:40:52] ✅ Order data extraction completed successfully
[15:40:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:40:52] ℹ️  Using MRN from patient data: '100999604' over '100999604'
[15:40:52] ⚠️  Could not determine sex using any available method
[15:40:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:40:52] ✅ Patient name cross-validation successful
[15:40:52] ✅    ✅ Data merged successfully
[15:40:54] ✅    ✅ Order data extracted and validated
[15:40:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:41:03] [DOC: 9269885] ✅ Patient exists in API: Gisele Calheta, ID: ba774534-43ac-4c94-938a-aba81151ec6e
[15:41:03] ✅    ✅ Existing patient found with ID: ba774534-43ac-4c94-938a-aba81151ec6e
[15:41:03] 🔄 
🔄 Step 6: Pushing order to API...
[15:41:03] [DOC: 9269885] ℹ️  Pushing order via API for patient ID: ba774534-43ac-4c94-938a-aba81151ec6e
[15:41:05] [DOC: 9269885] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13428"}
[15:41:05] ❌    ❌ Failed to push order
[15:41:05] 🔄 
🔄 Step 7: Writing to CSV...
[15:41:05] [DOC: 9269885] ℹ️  Calculated age: 84 from DOB: 04/05/1941
[15:41:05] [DOC: 9269885] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:41:05] [DOC: 9269885] ℹ️  Payer Source extracted: ''
[15:41:05] [DOC: 9269885] ℹ️  Diagnosis codes being written:
[15:41:05] [DOC: 9269885] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[15:41:05] [DOC: 9269885] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.42'
[15:41:05] [DOC: 9269885] ℹ️    - Latest_Episode_Thirddiagnosis: 'I48.91'
[15:41:05] [DOC: 9269885] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:41:05] [DOC: 9269885] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:41:05] [DOC: 9269885] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:41:05] [DOC: 9269885] ✅ Patient data written to CSV: Gisele Calheta | Sex:  | Age: 84 | Service: Skilled Nursing | Payer:  | MRN: 100999604
[15:41:05] ✅    ✅ Document 9269885 processed and saved successfully
[15:41:05] 🔄 
🔄 Step 8: Saving API details...
[15:41:05] [DOC: 9269885] ℹ️  API push details saved for document 9269885
[15:41:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9269790                         ║
================================================================================
[15:41:05] ℹ️  Agency: Brigham Home Care Services.Inc
[15:41:05] ℹ️  Date: 04/30/2025
[15:41:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:41:06] [DOC: 9269790] ✅ Text extracted using pdfplumber (1868 chars)
[15:41:06] ✅    ✅ Text extracted using pdfplumber (1868 chars)
[15:41:06] 🔄 
🔄 Step 2: Extracting patient data...
[15:41:09] ℹ️  AI extracted raw sex value: 'F'
[15:41:09] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:41:09] ℹ️  AI extracted payer source: ''
[15:41:09] ℹ️  AI extracted diagnoses:
[15:41:09] ℹ️    - Diagnosis 1: ''
[15:41:09] ℹ️    - Diagnosis 2: ''
[15:41:09] ℹ️    - Diagnosis 3: ''
[15:41:09] ℹ️    - Diagnosis 4: ''
[15:41:09] ℹ️    - Diagnosis 5: ''
[15:41:09] ℹ️    - Diagnosis 6: ''
[15:41:09] ℹ️  Final extracted MRN: '2327'
[15:41:09] ℹ️  Final extracted Sex: 'FEMALE'
[15:41:09] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:41:09] ℹ️  Final extracted Payer Source: ''
[15:41:09] ✅ Patient data extraction completed successfully
[15:41:09] ✅    ✅ Patient data extracted successfully
[15:41:09] 📊 Patient Response
     └─ patientFName: NITZA
     └─ patientLName: VALE
     └─ dob: 10/07/1979
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2327
     └─ billingProvider: Defusco, Nicholas
     └─ npi: 1730593195
     └─ physicianNPI: 1730593195
     └─ nameOfAgency: Brigham Home Care Services, Inc
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343
     └─ email: 
     └─ phoneNumber: (508) 857-0627
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:41:09] ✅    ✅ Patient identified: NITZA VALE
[15:41:09] ✅    ✅ Patient name validation passed
[15:41:09] 🔄 
🔄 Step 3: Processing patient dates...
[15:41:09] [DOC: 9269790] ℹ️  DOB normalized: 10/07/1979
[15:41:09] [DOC: 9269790] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[15:41:09] [DOC: 9269790] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[15:41:09] [DOC: 9269790] ✅ Patient date processing completed successfully
[15:41:09] ✅    ✅ Date processing completed
[15:41:09] 📊 Processed Patient Data
     └─ patientFName: NITZA
     └─ patientLName: VALE
     └─ dob: 10/07/1979
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2327
     └─ billingProvider: Defusco, Nicholas
     └─ npi: 1730593195
     └─ physicianNPI: 1730593195
     └─ nameOfAgency: Brigham Home Care Services, Inc
     └─ address: 84 S FRANKLIN ST UNIT B
     └─ city: HOLBROOK
     └─ state: MA
     └─ zip: 02343
     └─ email: 
     └─ phoneNumber: (508) 857-0627
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:41:09] 🔄 
🔄 Step 4: Extracting order data...
[15:41:11] ℹ️  Order extraction - MRN: '2327'
[15:41:11] ℹ️  Order extraction - Sex: 'FEMALE'
[15:41:11] ℹ️  Order extraction - Service Line: 'Nursing'
[15:41:11] ℹ️  Order extraction - Payer Source: ''
[15:41:11] ✅ Order data extraction completed successfully
[15:41:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:41:11] ℹ️  Using MRN from patient data: '2327' over '2327'
[15:41:11] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Nursing' = 'Nursing, Skilled Nursing'
[15:41:11] ✅ Patient name cross-validation successful
[15:41:11] ✅    ✅ Data merged successfully
[15:41:13] ⚠️     ❌ Skipping - missing company ID for agency: Brigham Home Care Services.Inc
[15:41:13] [DOC: 9269790] ℹ️  API push details saved for document 9269790
================================================================================
║                        Processing Document ID: 9269623                         ║
================================================================================
[15:41:13] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:41:13] ℹ️  Date: 04/30/2025
[15:41:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:41:14] [DOC: 9269623] ✅ Text extracted using pdfplumber (1353 chars)
[15:41:14] ✅    ✅ Text extracted using pdfplumber (1353 chars)
[15:41:14] 🔄 
🔄 Step 2: Extracting patient data...
[15:41:16] ℹ️  AI extracted raw sex value: 'F'
[15:41:16] ℹ️  AI extracted service line: 'Physical Therapy'
[15:41:16] ℹ️  AI extracted payer source: ''
[15:41:16] ℹ️  AI extracted diagnoses:
[15:41:16] ℹ️    - Diagnosis 1: ''
[15:41:16] ℹ️    - Diagnosis 2: ''
[15:41:16] ℹ️    - Diagnosis 3: ''
[15:41:16] ℹ️    - Diagnosis 4: ''
[15:41:16] ℹ️    - Diagnosis 5: ''
[15:41:16] ℹ️    - Diagnosis 6: ''
[15:41:16] ℹ️  Final extracted MRN: '2925069'
[15:41:16] ℹ️  Final extracted Sex: 'FEMALE'
[15:41:16] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:41:16] ℹ️  Final extracted Payer Source: ''
[15:41:16] ✅ Patient data extraction completed successfully
[15:41:16] ✅    ✅ Patient data extracted successfully
[15:41:16] 📊 Patient Response
     └─ patientFName: Anna
     └─ patientLName: Rose
     └─ dob: 04/03/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2925069
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:41:16] ✅    ✅ Patient identified: Anna Rose
[15:41:16] ✅    ✅ Patient name validation passed
[15:41:16] 🔄 
🔄 Step 3: Processing patient dates...
[15:41:16] [DOC: 9269623] ℹ️  DOB normalized: 04/03/1933
[15:41:16] [DOC: 9269623] ✅ Patient date processing completed successfully
[15:41:16] ✅    ✅ Date processing completed
[15:41:16] 📊 Processed Patient Data
     └─ patientFName: Anna
     └─ patientLName: Rose
     └─ dob: 04/03/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2925069
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:41:16] 🔄 
🔄 Step 4: Extracting order data...
[15:41:19] ℹ️  Order extraction - MRN: '2925069'
[15:41:19] ℹ️  Order extraction - Sex: 'FEMALE'
[15:41:19] ℹ️  Order extraction - Service Line: ''
[15:41:19] ℹ️  Order extraction - Payer Source: ''
[15:41:19] ✅ Order data extraction completed successfully
[15:41:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:41:19] ℹ️  Using MRN from patient data: '2925069' over '2925069'
[15:41:19] ℹ️  Using service line from patient data: 'Physical Therapy'
[15:41:19] ✅ Patient name cross-validation successful
[15:41:19] ✅    ✅ Data merged successfully
[15:41:20] ✅    ✅ Order data extracted and validated
[15:41:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:41:25] [DOC: 9269623] ℹ️  Patient not found in cache or API: Anna Rose
[15:41:25] [DOC: 9269623] ℹ️  Patient not found, creating new patient via API...
[15:41:25] [DOC: 9269623] ℹ️  Creating patient via API: Anna Rose
[15:41:26] [DOC: 9269623] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:41:26] ❌    ❌ Failed to create patient
[15:41:26] [DOC: 9269623] ℹ️  API push details saved for document 9269623
================================================================================
║                        Processing Document ID: 9269594                         ║
================================================================================
[15:41:26] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:41:26] ℹ️  Date: 04/30/2025
[15:41:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:41:27] [DOC: 9269594] ✅ Text extracted using pdfplumber (1586 chars)
[15:41:27] ✅    ✅ Text extracted using pdfplumber (1586 chars)
[15:41:27] 🔄 
🔄 Step 2: Extracting patient data...
[15:41:30] ℹ️  AI extracted raw sex value: 'F'
[15:41:30] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:41:30] ℹ️  AI extracted payer source: ''
[15:41:30] ℹ️  AI extracted diagnoses:
[15:41:30] ℹ️    - Diagnosis 1: ''
[15:41:30] ℹ️    - Diagnosis 2: ''
[15:41:30] ℹ️    - Diagnosis 3: ''
[15:41:30] ℹ️    - Diagnosis 4: ''
[15:41:30] ℹ️    - Diagnosis 5: ''
[15:41:30] ℹ️    - Diagnosis 6: ''
[15:41:30] ℹ️  Final extracted MRN: '2761021'
[15:41:30] ℹ️  Final extracted Sex: 'FEMALE'
[15:41:30] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:41:30] ℹ️  Final extracted Payer Source: ''
[15:41:30] ✅ Patient data extraction completed successfully
[15:41:30] ✅    ✅ Patient data extracted successfully
[15:41:30] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Moniz
     └─ dob: 07/09/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2761021
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:41:30] ✅    ✅ Patient identified: Theresa Moniz
[15:41:30] ✅    ✅ Patient name validation passed
[15:41:30] 🔄 
🔄 Step 3: Processing patient dates...
[15:41:30] [DOC: 9269594] ℹ️  DOB normalized: 07/09/1956
[15:41:30] [DOC: 9269594] ✅ Patient date processing completed successfully
[15:41:30] ✅    ✅ Date processing completed
[15:41:30] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Moniz
     └─ dob: 07/09/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2761021
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:41:30] 🔄 
🔄 Step 4: Extracting order data...
[15:41:32] ℹ️  Order extraction - MRN: '2761021'
[15:41:32] ℹ️  Order extraction - Sex: 'FEMALE'
[15:41:32] ℹ️  Order extraction - Service Line: ''
[15:41:32] ℹ️  Order extraction - Payer Source: ''
[15:41:32] ✅ Order data extraction completed successfully
[15:41:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:41:32] ℹ️  Using MRN from patient data: '2761021' over '2761021'
[15:41:32] ℹ️  Using service line from patient data: 'Skilled Nursing'
[15:41:32] ✅ Patient name cross-validation successful
[15:41:32] ✅    ✅ Data merged successfully
[15:41:33] ⚠️     ❌ Skipping - missing episode start date
[15:41:33] [DOC: 9269594] ℹ️  API push details saved for document 9269594
================================================================================
║                        Processing Document ID: 9269109                         ║
================================================================================
[15:41:33] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:41:33] ℹ️  Date: 04/30/2025
[15:41:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:41:37] [DOC: 9269109] ✅ Text extracted using pdfplumber (1379 chars)
[15:41:37] ✅    ✅ Text extracted using pdfplumber (1379 chars)
[15:41:37] 🔄 
🔄 Step 2: Extracting patient data...
[15:41:39] ℹ️  AI extracted raw sex value: ''
[15:41:39] ℹ️  AI extracted service line: 'Physical Therapy'
[15:41:39] ℹ️  AI extracted payer source: ''
[15:41:39] ℹ️  AI extracted diagnoses:
[15:41:39] ℹ️    - Diagnosis 1: 'J18.9'
[15:41:39] ℹ️    - Diagnosis 2: 'I71.21'
[15:41:39] ℹ️    - Diagnosis 3: 'I11.0'
[15:41:39] ℹ️    - Diagnosis 4: 'None'
[15:41:39] ℹ️    - Diagnosis 5: 'None'
[15:41:39] ℹ️    - Diagnosis 6: 'None'
[15:41:39] ℹ️  Final extracted MRN: 'MA221128094306'
[15:41:39] ℹ️  Final extracted Sex: ''
[15:41:39] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:41:39] ℹ️  Final extracted Payer Source: ''
[15:41:39] ✅ Patient data extraction completed successfully
[15:41:39] ✅    ✅ Patient data extracted successfully
[15:41:39] 📊 Patient Response
     └─ patientFName: Vicente
     └─ patientLName: Amaro
     └─ dob: 09/09/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA221128094306
     └─ billingProvider: ROBERT CALDAS
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'I71.21', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:41:39] ✅    ✅ Patient identified: Vicente Amaro
[15:41:39] ✅    ✅ Patient name validation passed
[15:41:39] 🔄 
🔄 Step 3: Processing patient dates...
[15:41:39] [DOC: 9269109] ℹ️  DOB normalized: 09/09/1943
[15:41:39] [DOC: 9269109] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[15:41:39] [DOC: 9269109] ℹ️  Episode endOfEpisode normalized: 06/07/2025
[15:41:39] [DOC: 9269109] ✅ Patient date processing completed successfully
[15:41:39] ✅    ✅ Date processing completed
[15:41:39] 📊 Processed Patient Data
     └─ patientFName: Vicente
     └─ patientLName: Amaro
     └─ dob: 09/09/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA221128094306
     └─ billingProvider: ROBERT CALDAS
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'I71.21', 'thirdDiagnosis': 'I11.0'}]
[15:41:39] 🔄 
🔄 Step 4: Extracting order data...
[15:41:42] ℹ️  Order extraction - MRN: 'MA221128094306'
[15:41:42] ℹ️  Order extraction - Sex: ''
[15:41:42] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[15:41:42] ℹ️  Order extraction - Payer Source: ''
[15:41:42] ✅ Order data extraction completed successfully
[15:41:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:41:42] ℹ️  Using MRN from patient data: 'MA221128094306' over 'MA221128094306'
[15:41:42] ⚠️  Could not determine sex using any available method
[15:41:42] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[15:41:42] ✅ Patient name cross-validation successful
[15:41:42] ✅    ✅ Data merged successfully
[15:41:43] ✅    ✅ Order data extracted and validated
[15:41:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:41:48] [DOC: 9269109] ✅ Patient exists in API: Vicente Amaro, ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[15:41:48] ✅    ✅ Existing patient found with ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[15:41:48] 🔄 
🔄 Step 6: Pushing order to API...
[15:41:48] [DOC: 9269109] ℹ️  Pushing order via API for patient ID: 00ec4706-0e5a-4a5a-aadd-f1f5d6bcb7ac
[15:41:50] [DOC: 9269109] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12900"}
[15:41:50] ❌    ❌ Failed to push order
[15:41:50] 🔄 
🔄 Step 7: Writing to CSV...
[15:41:50] [DOC: 9269109] ℹ️  Calculated age: 81 from DOB: 09/09/1943
[15:41:50] [DOC: 9269109] ℹ️  Service Line extracted: 'Physical Therapy'
[15:41:50] [DOC: 9269109] ℹ️  Payer Source extracted: ''
[15:41:50] [DOC: 9269109] ℹ️  Diagnosis codes being written:
[15:41:50] [DOC: 9269109] ℹ️    - Latest_Episode_Firstdiagnosis: 'J18.9'
[15:41:50] [DOC: 9269109] ℹ️    - Latest_Episode_Seconddiagnosis: 'I71.21'
[15:41:50] [DOC: 9269109] ℹ️    - Latest_Episode_Thirddiagnosis: 'I11.0'
[15:41:50] [DOC: 9269109] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:41:50] [DOC: 9269109] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:41:50] [DOC: 9269109] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:41:50] [DOC: 9269109] ✅ Patient data written to CSV: Vicente Amaro | Sex:  | Age: 81 | Service: Physical Therapy | Payer:  | MRN: MA221128094306
[15:41:50] ✅    ✅ Document 9269109 processed and saved successfully
[15:41:50] 🔄 
🔄 Step 8: Saving API details...
[15:41:50] [DOC: 9269109] ℹ️  API push details saved for document 9269109
[15:41:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9268281                         ║
================================================================================
[15:41:50] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:41:50] ℹ️  Date: 04/30/2025
[15:41:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:41:51] [DOC: 9268281] ✅ Text extracted using pdfplumber (1476 chars)
[15:41:51] ✅    ✅ Text extracted using pdfplumber (1476 chars)
[15:41:51] 🔄 
🔄 Step 2: Extracting patient data...
[15:41:53] ℹ️  AI extracted raw sex value: 'F'
[15:41:53] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:41:53] ℹ️  AI extracted payer source: ''
[15:41:53] ℹ️  AI extracted diagnoses:
[15:41:53] ℹ️    - Diagnosis 1: ''
[15:41:53] ℹ️    - Diagnosis 2: ''
[15:41:53] ℹ️    - Diagnosis 3: ''
[15:41:53] ℹ️    - Diagnosis 4: ''
[15:41:53] ℹ️    - Diagnosis 5: ''
[15:41:53] ℹ️    - Diagnosis 6: ''
[15:41:53] ℹ️  Final extracted MRN: '2761021'
[15:41:53] ℹ️  Final extracted Sex: 'FEMALE'
[15:41:53] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:41:53] ℹ️  Final extracted Payer Source: ''
[15:41:53] ✅ Patient data extraction completed successfully
[15:41:53] ✅    ✅ Patient data extracted successfully
[15:41:53] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Moniz
     └─ dob: 07/09/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2761021
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:41:53] ✅    ✅ Patient identified: Theresa Moniz
[15:41:53] ✅    ✅ Patient name validation passed
[15:41:53] 🔄 
🔄 Step 3: Processing patient dates...
[15:41:53] [DOC: 9268281] ℹ️  DOB normalized: 07/09/1956
[15:41:53] [DOC: 9268281] ✅ Patient date processing completed successfully
[15:41:53] ✅    ✅ Date processing completed
[15:41:53] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Moniz
     └─ dob: 07/09/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2761021
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:41:53] 🔄 
🔄 Step 4: Extracting order data...
[15:41:56] ℹ️  Order extraction - MRN: '2761021'
[15:41:56] ℹ️  Order extraction - Sex: 'FEMALE'
[15:41:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:41:56] ℹ️  Order extraction - Payer Source: ''
[15:41:56] ✅ Order data extraction completed successfully
[15:41:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:41:56] ℹ️  Using MRN from patient data: '2761021' over '2761021'
[15:41:56] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:41:56] ✅ Patient name cross-validation successful
[15:41:56] ✅    ✅ Data merged successfully
[15:41:57] ✅    ✅ Order data extracted and validated
[15:41:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:42:12] [DOC: 9268281] ℹ️  Patient not found in cache or API: Theresa Moniz
[15:42:12] [DOC: 9268281] ℹ️  Patient not found, creating new patient via API...
[15:42:12] [DOC: 9268281] ℹ️  Creating patient via API: Theresa Moniz
[15:42:13] [DOC: 9268281] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:42:13] ❌    ❌ Failed to create patient
[15:42:13] [DOC: 9268281] ℹ️  API push details saved for document 9268281
================================================================================
║                        Processing Document ID: 9268274                         ║
================================================================================
[15:42:13] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[15:42:13] ℹ️  Date: 04/30/2025
[15:42:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:42:14] [DOC: 9268274] ✅ Text extracted using pdfplumber (1319 chars)
[15:42:14] ✅    ✅ Text extracted using pdfplumber (1319 chars)
[15:42:14] 🔄 
🔄 Step 2: Extracting patient data...
[15:42:17] ℹ️  AI extracted raw sex value: 'F'
[15:42:17] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:42:17] ℹ️  AI extracted payer source: ''
[15:42:17] ℹ️  AI extracted diagnoses:
[15:42:17] ℹ️    - Diagnosis 1: ''
[15:42:17] ℹ️    - Diagnosis 2: ''
[15:42:17] ℹ️    - Diagnosis 3: ''
[15:42:17] ℹ️    - Diagnosis 4: ''
[15:42:17] ℹ️    - Diagnosis 5: ''
[15:42:17] ℹ️    - Diagnosis 6: ''
[15:42:17] ℹ️  Final extracted MRN: '2455123'
[15:42:17] ℹ️  Final extracted Sex: 'FEMALE'
[15:42:17] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:42:17] ℹ️  Final extracted Payer Source: ''
[15:42:17] ✅ Patient data extraction completed successfully
[15:42:17] ✅    ✅ Patient data extracted successfully
[15:42:17] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Faria
     └─ dob: 04/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2455123
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:42:17] ✅    ✅ Patient identified: Donna Faria
[15:42:17] ✅    ✅ Patient name validation passed
[15:42:17] 🔄 
🔄 Step 3: Processing patient dates...
[15:42:17] [DOC: 9268274] ℹ️  DOB normalized: 04/27/1958
[15:42:17] [DOC: 9268274] ✅ Patient date processing completed successfully
[15:42:17] ✅    ✅ Date processing completed
[15:42:17] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Faria
     └─ dob: 04/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2455123
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:42:17] 🔄 
🔄 Step 4: Extracting order data...
[15:42:19] ℹ️  Order extraction - MRN: '2455123'
[15:42:19] ℹ️  Order extraction - Sex: 'FEMALE'
[15:42:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:42:19] ℹ️  Order extraction - Payer Source: ''
[15:42:19] ✅ Order data extraction completed successfully
[15:42:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:42:19] ℹ️  Using MRN from patient data: '2455123' over '2455123'
[15:42:19] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:42:19] ✅ Patient name cross-validation successful
[15:42:19] ✅    ✅ Data merged successfully
[15:42:20] ✅    ✅ Order data extracted and validated
[15:42:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:42:25] [DOC: 9268274] ✅ Patient exists in API: Donna Faria, ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[15:42:25] ✅    ✅ Existing patient found with ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[15:42:25] 🔄 
🔄 Step 6: Pushing order to API...
[15:42:25] [DOC: 9268274] ℹ️  Pushing order via API for patient ID: 1685c907-1eb7-42e4-bfab-3c7b8b56fd05
[15:42:27] [DOC: 9268274] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14143"}
[15:42:27] ❌    ❌ Failed to push order
[15:42:27] 🔄 
🔄 Step 7: Writing to CSV...
[15:42:27] [DOC: 9268274] ℹ️  Calculated age: 67 from DOB: 04/27/1958
[15:42:27] [DOC: 9268274] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:42:27] [DOC: 9268274] ℹ️  Payer Source extracted: ''
[15:42:27] [DOC: 9268274] ℹ️  Diagnosis codes being written:
[15:42:27] [DOC: 9268274] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:42:27] [DOC: 9268274] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:42:27] [DOC: 9268274] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:42:27] [DOC: 9268274] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:42:27] [DOC: 9268274] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:42:27] [DOC: 9268274] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:42:27] [DOC: 9268274] ✅ Patient data written to CSV: Donna Faria | Sex: FEMALE | Age: 67 | Service: Skilled Nursing | Payer:  | MRN: 2455123
[15:42:27] ✅    ✅ Document 9268274 processed and saved successfully
[15:42:27] 🔄 
🔄 Step 8: Saving API details...
[15:42:27] [DOC: 9268274] ℹ️  API push details saved for document 9268274
[15:42:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9268226                         ║
================================================================================
[15:42:27] ℹ️  Agency: Bayada Home Health Care Inc-Providence
[15:42:27] ℹ️  Date: 04/29/2025
[15:42:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:42:30] [DOC: 9268226] ✅ Text extracted using pdfplumber (21277 chars)
[15:42:30] ✅    ✅ Text extracted using pdfplumber (21193 chars)
[15:42:30] 🔄 
🔄 Step 2: Extracting patient data...
[15:42:34] ℹ️  AI extracted raw sex value: 'F'
[15:42:34] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:42:34] ℹ️  AI extracted payer source: 'Medicare'
[15:42:34] ℹ️  AI extracted diagnoses:
[15:42:34] ℹ️    - Diagnosis 1: 'I26.93'
[15:42:34] ℹ️    - Diagnosis 2: 'I95.1'
[15:42:34] ℹ️    - Diagnosis 3: 'E89.0'
[15:42:34] ℹ️    - Diagnosis 4: 'E55.9'
[15:42:34] ℹ️    - Diagnosis 5: 'D50.9'
[15:42:34] ℹ️    - Diagnosis 6: 'F31.9'
[15:42:34] ℹ️  Final extracted MRN: '04400034480901'
[15:42:34] ℹ️  Final extracted Sex: 'FEMALE'
[15:42:34] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:42:34] ℹ️  Final extracted Payer Source: 'Medicare'
[15:42:34] ✅ Patient data extraction completed successfully
[15:42:34] ✅    ✅ Patient data extracted successfully
[15:42:34] 📊 Patient Response
     └─ patientFName: DONNA
     └─ patientLName: MEDEIROS
     └─ dob: 05/13/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 04400034480901
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 417057
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 1295 STAFFORD RD APT 8
     └─ city: TIVERTON
     └─ state: RI
     └─ zip: 02878-
     └─ email: 
     └─ phoneNumber: (774) 473-3818
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/22/2025', 'startOfEpisode': '04/22/2025', 'endOfEpisode': '06/20/2025', 'firstDiagnosis': 'I26.93', 'secondDiagnosis': 'I95.1', 'thirdDiagnosis': 'E89.0', 'fourthDiagnosis': 'E55.9', 'fifthDiagnosis': 'D50.9', 'sixthDiagnosis': 'F31.9'}]
[15:42:34] ✅    ✅ Patient identified: DONNA MEDEIROS
[15:42:34] ✅    ✅ Patient name validation passed
[15:42:34] 🔄 
🔄 Step 3: Processing patient dates...
[15:42:34] [DOC: 9268226] ℹ️  DOB normalized: 05/13/1967
[15:42:34] [DOC: 9268226] ℹ️  Episode startOfCare normalized: 04/22/2025
[15:42:34] [DOC: 9268226] ℹ️  Episode startOfEpisode normalized: 04/22/2025
[15:42:34] [DOC: 9268226] ℹ️  Episode endOfEpisode normalized: 06/20/2025
[15:42:34] [DOC: 9268226] ✅ Patient date processing completed successfully
[15:42:34] ✅    ✅ Date processing completed
[15:42:34] 📊 Processed Patient Data
     └─ patientFName: DONNA
     └─ patientLName: MEDEIROS
     └─ dob: 05/13/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 04400034480901
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 417057
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 1295 STAFFORD RD APT 8
     └─ city: TIVERTON
     └─ state: RI
     └─ zip: 02878-
     └─ email: 
     └─ phoneNumber: (774) 473-3818
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/22/2025', 'startOfEpisode': '04/22/2025', 'endOfEpisode': '06/20/2025', 'firstDiagnosis': 'I26.93', 'secondDiagnosis': 'I95.1', 'thirdDiagnosis': 'E89.0', 'fourthDiagnosis': 'E55.9', 'fifthDiagnosis': 'D50.9', 'sixthDiagnosis': 'F31.9'}]
[15:42:34] 🔄 
🔄 Step 4: Extracting order data...
[15:42:37] ℹ️  Order extraction - MRN: '04400034480901'
[15:42:37] ℹ️  Order extraction - Sex: 'FEMALE'
[15:42:37] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:42:37] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:42:37] ✅ Order data extraction completed successfully
[15:42:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:42:37] ℹ️  Using MRN from patient data: '04400034480901' over '04400034480901'
[15:42:37] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[15:42:37] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:42:37] ✅ Patient name cross-validation successful
[15:42:37] ✅    ✅ Data merged successfully
[15:42:38] ✅    ✅ Order data extracted and validated
[15:42:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:42:38] [DOC: 9268226] ✅ Patient found in local cache: DONNA MEDEIROS, ID: 1a293cc9-60c5-42d8-ab0c-43aa83d836e9
[15:42:38] ✅    ✅ Existing patient found with ID: 1a293cc9-60c5-42d8-ab0c-43aa83d836e9
[15:42:38] 🔄 
🔄 Step 6: Pushing order to API...
[15:42:38] [DOC: 9268226] ℹ️  Pushing order via API for patient ID: 1a293cc9-60c5-42d8-ab0c-43aa83d836e9
[15:42:39] [DOC: 9268226] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14058"}
[15:42:39] ❌    ❌ Failed to push order
[15:42:39] 🔄 
🔄 Step 7: Writing to CSV...
[15:42:39] [DOC: 9268226] ℹ️  Calculated age: 58 from DOB: 05/13/1967
[15:42:39] [DOC: 9268226] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[15:42:39] [DOC: 9268226] ℹ️  Payer Source extracted: 'Medicare'
[15:42:39] [DOC: 9268226] ℹ️  Diagnosis codes being written:
[15:42:39] [DOC: 9268226] ℹ️    - Latest_Episode_Firstdiagnosis: 'I26.93'
[15:42:39] [DOC: 9268226] ℹ️    - Latest_Episode_Seconddiagnosis: 'I95.1'
[15:42:39] [DOC: 9268226] ℹ️    - Latest_Episode_Thirddiagnosis: 'E89.0'
[15:42:39] [DOC: 9268226] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E55.9'
[15:42:39] [DOC: 9268226] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D50.9'
[15:42:39] [DOC: 9268226] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F31.9'
[15:42:39] [DOC: 9268226] ✅ Patient data written to CSV: DONNA MEDEIROS | Sex: FEMALE | Age: 58 | Service: Occupational Therapy, Physical Therapy, Skilled Nursing | Payer: Medicare | MRN: 04400034480901
[15:42:39] ✅    ✅ Document 9268226 processed and saved successfully
[15:42:39] 🔄 
🔄 Step 8: Saving API details...
[15:42:39] [DOC: 9268226] ℹ️  API push details saved for document 9268226
[15:42:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9267511                         ║
================================================================================
[15:42:39] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:42:39] ℹ️  Date: 04/29/2025
[15:42:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:42:42] [DOC: 9267511] ✅ Text extracted using pdfplumber (1304 chars)
[15:42:42] ✅    ✅ Text extracted using pdfplumber (1304 chars)
[15:42:42] 🔄 
🔄 Step 2: Extracting patient data...
[15:42:45] ℹ️  AI extracted raw sex value: ''
[15:42:45] ℹ️  AI extracted service line: 'Nursing, LPN'
[15:42:45] ℹ️  AI extracted payer source: ''
[15:42:45] ℹ️  AI extracted diagnoses:
[15:42:45] ℹ️    - Diagnosis 1: 'A41.9'
[15:42:45] ℹ️    - Diagnosis 2: 'N30.00'
[15:42:45] ℹ️    - Diagnosis 3: 'F41.9'
[15:42:45] ℹ️    - Diagnosis 4: ''
[15:42:45] ℹ️    - Diagnosis 5: ''
[15:42:45] ℹ️    - Diagnosis 6: ''
[15:42:45] ℹ️  Final extracted MRN: 'MA231215025208'
[15:42:45] ℹ️  Final extracted Sex: ''
[15:42:45] ℹ️  Final extracted Service Line: 'Nursing, LPN'
[15:42:45] ℹ️  Final extracted Payer Source: ''
[15:42:45] ✅ Patient data extraction completed successfully
[15:42:45] ✅    ✅ Patient data extracted successfully
[15:42:45] 📊 Patient Response
     └─ patientFName: Marcia
     └─ patientLName: Dunlop
     └─ dob: 02/21/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA231215025208
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/28/2024', 'endOfEpisode': '02/25/2025', 'firstDiagnosis': 'A41.9', 'secondDiagnosis': 'N30.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:42:45] ✅    ✅ Patient identified: Marcia Dunlop
[15:42:45] ✅    ✅ Patient name validation passed
[15:42:45] 🔄 
🔄 Step 3: Processing patient dates...
[15:42:45] [DOC: 9267511] ℹ️  DOB normalized: 02/21/1952
[15:42:45] [DOC: 9267511] ℹ️  Episode startOfEpisode normalized: 12/28/2024
[15:42:45] [DOC: 9267511] ℹ️  Episode endOfEpisode normalized: 02/25/2025
[15:42:45] [DOC: 9267511] ✅ Patient date processing completed successfully
[15:42:45] ✅    ✅ Date processing completed
[15:42:45] 📊 Processed Patient Data
     └─ patientFName: Marcia
     └─ patientLName: Dunlop
     └─ dob: 02/21/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA231215025208
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/28/2024', 'endOfEpisode': '02/25/2025', 'firstDiagnosis': 'A41.9', 'secondDiagnosis': 'N30.00', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:42:45] 🔄 
🔄 Step 4: Extracting order data...
[15:42:48] ℹ️  Order extraction - MRN: 'MA231215025208'
[15:42:48] ℹ️  Order extraction - Sex: ''
[15:42:48] ℹ️  Order extraction - Service Line: 'RN'
[15:42:48] ℹ️  Order extraction - Payer Source: ''
[15:42:48] ✅ Order data extraction completed successfully
[15:42:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:42:48] ℹ️  Using MRN from patient data: 'MA231215025208' over 'MA231215025208'
[15:42:48] ⚠️  Could not determine sex using any available method
[15:42:48] ℹ️  Combined service lines: Patient='Nursing, LPN' + Order='RN' = 'LPN, Nursing, RN'
[15:42:48] ✅ Patient name cross-validation successful
[15:42:48] ✅    ✅ Data merged successfully
[15:42:49] ✅    ✅ Order data extracted and validated
[15:42:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:42:55] [DOC: 9267511] ✅ Patient exists in API: Marcia Dunlop, ID: 3c464d06-6a86-462f-9d61-1b884255685a
[15:42:55] ✅    ✅ Existing patient found with ID: 3c464d06-6a86-462f-9d61-1b884255685a
[15:42:55] 🔄 
🔄 Step 6: Pushing order to API...
[15:42:55] [DOC: 9267511] ℹ️  Pushing order via API for patient ID: 3c464d06-6a86-462f-9d61-1b884255685a
[15:42:56] [DOC: 9267511] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13899"}
[15:42:56] ❌    ❌ Failed to push order
[15:42:56] 🔄 
🔄 Step 7: Writing to CSV...
[15:42:56] [DOC: 9267511] ℹ️  Calculated age: 73 from DOB: 02/21/1952
[15:42:56] [DOC: 9267511] ℹ️  Service Line extracted: 'LPN, Nursing, RN'
[15:42:56] [DOC: 9267511] ℹ️  Payer Source extracted: ''
[15:42:56] [DOC: 9267511] ℹ️  Diagnosis codes being written:
[15:42:56] [DOC: 9267511] ℹ️    - Latest_Episode_Firstdiagnosis: 'A41.9'
[15:42:56] [DOC: 9267511] ℹ️    - Latest_Episode_Seconddiagnosis: 'N30.00'
[15:42:56] [DOC: 9267511] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[15:42:56] [DOC: 9267511] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:42:56] [DOC: 9267511] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:42:56] [DOC: 9267511] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:42:56] [DOC: 9267511] ✅ Patient data written to CSV: Marcia Dunlop | Sex:  | Age: 73 | Service: LPN, Nursing, RN | Payer:  | MRN: MA231215025208
[15:42:56] ✅    ✅ Document 9267511 processed and saved successfully
[15:42:56] 🔄 
🔄 Step 8: Saving API details...
[15:42:56] [DOC: 9267511] ℹ️  API push details saved for document 9267511
[15:42:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266990                         ║
================================================================================
[15:42:56] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:42:56] ℹ️  Date: 04/29/2025
[15:42:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:42:58] [DOC: 9266990] ✅ Text extracted using pdfplumber (13231 chars)
[15:42:58] ✅    ✅ Text extracted using pdfplumber (13231 chars)
[15:42:58] 🔄 
🔄 Step 2: Extracting patient data...
[15:43:02] ℹ️  AI extracted raw sex value: 'F'
[15:43:02] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:43:02] ℹ️  AI extracted payer source: 'Medicare'
[15:43:02] ℹ️  AI extracted diagnoses:
[15:43:02] ℹ️    - Diagnosis 1: 'N30.00'
[15:43:02] ℹ️    - Diagnosis 2: 'E11.9'
[15:43:02] ℹ️    - Diagnosis 3: 'F41.1'
[15:43:02] ℹ️    - Diagnosis 4: 'I95.1'
[15:43:02] ℹ️    - Diagnosis 5: 'M13.849'
[15:43:02] ℹ️    - Diagnosis 6: 'M51.87'
[15:43:02] ℹ️  Final extracted MRN: '101002392'
[15:43:02] ℹ️  Final extracted Sex: 'FEMALE'
[15:43:02] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:43:02] ℹ️  Final extracted Payer Source: 'Medicare'
[15:43:02] ✅ Patient data extraction completed successfully
[15:43:02] ✅    ✅ Patient data extracted successfully
[15:43:02] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': 'I95.1', 'fifthDiagnosis': 'M13.849', 'sixthDiagnosis': 'M51.87'}]
[15:43:02] ✅    ✅ Patient identified: Virginia Brunton
[15:43:02] ✅    ✅ Patient name validation passed
[15:43:02] 🔄 
🔄 Step 3: Processing patient dates...
[15:43:02] [DOC: 9266990] ℹ️  DOB normalized: 06/05/1940
[15:43:02] [DOC: 9266990] ℹ️  Episode startOfCare normalized: 04/08/2025
[15:43:02] [DOC: 9266990] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[15:43:02] [DOC: 9266990] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[15:43:02] [DOC: 9266990] ✅ Patient date processing completed successfully
[15:43:02] ✅    ✅ Date processing completed
[15:43:02] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': 'I95.1', 'fifthDiagnosis': 'M13.849', 'sixthDiagnosis': 'M51.87'}]
[15:43:02] 🔄 
🔄 Step 4: Extracting order data...
[15:43:04] ℹ️  Order extraction - MRN: '101002392'
[15:43:04] ℹ️  Order extraction - Sex: 'FEMALE'
[15:43:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:43:04] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:43:04] ✅ Order data extraction completed successfully
[15:43:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:43:04] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[15:43:04] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:43:04] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:43:04] ✅ Patient name cross-validation successful
[15:43:04] ✅    ✅ Data merged successfully
[15:43:06] ✅    ✅ Order data extracted and validated
[15:43:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:43:06] [DOC: 9266990] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[15:43:06] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[15:43:06] 🔄 
🔄 Step 6: Pushing order to API...
[15:43:06] [DOC: 9266990] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[15:43:07] [DOC: 9266990] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13402"}
[15:43:07] ❌    ❌ Failed to push order
[15:43:07] 🔄 
🔄 Step 7: Writing to CSV...
[15:43:07] [DOC: 9266990] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[15:43:07] [DOC: 9266990] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:43:07] [DOC: 9266990] ℹ️  Payer Source extracted: 'Medicare'
[15:43:07] [DOC: 9266990] ℹ️  Diagnosis codes being written:
[15:43:07] [DOC: 9266990] ℹ️    - Latest_Episode_Firstdiagnosis: 'N30.00'
[15:43:07] [DOC: 9266990] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[15:43:07] [DOC: 9266990] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[15:43:07] [DOC: 9266990] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I95.1'
[15:43:07] [DOC: 9266990] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M13.849'
[15:43:07] [DOC: 9266990] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M51.87'
[15:43:07] [DOC: 9266990] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: 101002392
[15:43:07] ✅    ✅ Document 9266990 processed and saved successfully
[15:43:07] 🔄 
🔄 Step 8: Saving API details...
[15:43:07] [DOC: 9266990] ℹ️  API push details saved for document 9266990
[15:43:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266816                         ║
================================================================================
[15:43:07] ℹ️  Agency: Compassionate Care Hospice-Taunton
[15:43:07] ℹ️  Date: 04/29/2025
[15:43:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:43:10] [DOC: 9266816] ✅ Text extracted using pdfplumber (1501 chars)
[15:43:10] ✅    ✅ Text extracted using pdfplumber (1489 chars)
[15:43:10] 🔄 
🔄 Step 2: Extracting patient data...
[15:43:12] ℹ️  AI extracted raw sex value: ''
[15:43:12] ℹ️  AI extracted service line: 'Hospice Volunteer Coordinator'
[15:43:12] ℹ️  AI extracted payer source: 'Medicare'
[15:43:12] ℹ️  AI extracted diagnoses:
[15:43:12] ℹ️    - Diagnosis 1: ''
[15:43:12] ℹ️    - Diagnosis 2: ''
[15:43:12] ℹ️    - Diagnosis 3: ''
[15:43:12] ℹ️    - Diagnosis 4: ''
[15:43:12] ℹ️    - Diagnosis 5: ''
[15:43:12] ℹ️    - Diagnosis 6: ''
[15:43:12] ℹ️  Final extracted MRN: 'B3700365065902'
[15:43:12] ℹ️  Final extracted Sex: ''
[15:43:12] ℹ️  Final extracted Service Line: 'Hospice Volunteer Coordinator'
[15:43:12] ℹ️  Final extracted Payer Source: 'Medicare'
[15:43:12] ✅ Patient data extraction completed successfully
[15:43:12] ✅    ✅ Patient data extracted successfully
[15:43:12] 📊 Patient Response
     └─ patientFName: RICHARD
     └─ patientLName: SIMMONS
     └─ dob: 03/28/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700365065902
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice Volunteer Coordinator
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:43:12] ✅    ✅ Patient identified: RICHARD SIMMONS
[15:43:12] ✅    ✅ Patient name validation passed
[15:43:12] 🔄 
🔄 Step 3: Processing patient dates...
[15:43:12] [DOC: 9266816] ℹ️  DOB normalized: 03/28/1931
[15:43:12] [DOC: 9266816] ✅ Patient date processing completed successfully
[15:43:12] ✅    ✅ Date processing completed
[15:43:12] 📊 Processed Patient Data
     └─ patientFName: RICHARD
     └─ patientLName: SIMMONS
     └─ dob: 03/28/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700365065902
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice Volunteer Coordinator
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:43:12] 🔄 
🔄 Step 4: Extracting order data...
[15:43:15] ℹ️  Order extraction - MRN: 'B3700365065902'
[15:43:15] ℹ️  Order extraction - Sex: ''
[15:43:15] ℹ️  Order extraction - Service Line: 'Hospice Volunteer Coordinator'
[15:43:15] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:43:15] ✅ Order data extraction completed successfully
[15:43:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:43:15] ℹ️  Using MRN from patient data: 'B3700365065902' over 'B3700365065902'
[15:43:15] ℹ️  Inferred sex as MALE from name: RICHARD
[15:43:15] ℹ️  Service line consistent in both sources: 'Hospice Volunteer Coordinator'
[15:43:15] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:43:15] ✅ Patient name cross-validation successful
[15:43:15] ✅    ✅ Data merged successfully
[15:43:16] ✅    ✅ Order data extracted and validated
[15:43:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:43:16] [DOC: 9266816] ✅ Patient found in local cache: RICHARD SIMMONS, ID: fb13de4e-e12b-487b-9527-fa575e9f8c29
[15:43:16] ✅    ✅ Existing patient found with ID: fb13de4e-e12b-487b-9527-fa575e9f8c29
[15:43:16] 🔄 
🔄 Step 6: Pushing order to API...
[15:43:16] [DOC: 9266816] ℹ️  Pushing order via API for patient ID: fb13de4e-e12b-487b-9527-fa575e9f8c29
[15:43:17] [DOC: 9266816] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14431"}
[15:43:17] ❌    ❌ Failed to push order
[15:43:17] 🔄 
🔄 Step 7: Writing to CSV...
[15:43:17] [DOC: 9266816] ℹ️  Calculated age: 94 from DOB: 03/28/1931
[15:43:17] [DOC: 9266816] ℹ️  Service Line extracted: 'Hospice Volunteer Coordinator'
[15:43:17] [DOC: 9266816] ℹ️  Payer Source extracted: 'Medicare'
[15:43:17] [DOC: 9266816] ℹ️  Diagnosis codes being written:
[15:43:17] [DOC: 9266816] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:43:17] [DOC: 9266816] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:43:17] [DOC: 9266816] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:43:17] [DOC: 9266816] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:43:17] [DOC: 9266816] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:43:17] [DOC: 9266816] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:43:17] [DOC: 9266816] ✅ Patient data written to CSV: RICHARD SIMMONS | Sex: MALE | Age: 94 | Service: Hospice Volunteer Coordinator | Payer: Medicare | MRN: B3700365065902
[15:43:17] ✅    ✅ Document 9266816 processed and saved successfully
[15:43:17] 🔄 
🔄 Step 8: Saving API details...
[15:43:17] [DOC: 9266816] ℹ️  API push details saved for document 9266816
[15:43:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266647                         ║
================================================================================
[15:43:17] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[15:43:17] ℹ️  Date: 04/29/2025
[15:43:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:43:20] [DOC: 9266647] ✅ Text extracted using pdfplumber (17992 chars)
[15:43:20] ✅    ✅ Text extracted using pdfplumber (17980 chars)
[15:43:20] 🔄 
🔄 Step 2: Extracting patient data...
[15:43:24] ℹ️  AI extracted raw sex value: 'M'
[15:43:24] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:43:24] ℹ️  AI extracted payer source: 'Medicare'
[15:43:24] ℹ️  AI extracted diagnoses:
[15:43:24] ℹ️    - Diagnosis 1: 'A04.72'
[15:43:24] ℹ️    - Diagnosis 2: 'E11.9'
[15:43:24] ℹ️    - Diagnosis 3: 'E87.1'
[15:43:24] ℹ️    - Diagnosis 4: 'J44.89'
[15:43:24] ℹ️    - Diagnosis 5: 'I11.0'
[15:43:24] ℹ️    - Diagnosis 6: 'I50.32'
[15:43:24] ℹ️  Final extracted MRN: 'MA250414053302'
[15:43:24] ℹ️  Final extracted Sex: 'MALE'
[15:43:24] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:43:24] ℹ️  Final extracted Payer Source: 'Medicare'
[15:43:24] ✅ Patient data extraction completed successfully
[15:43:24] ✅    ✅ Patient data extracted successfully
[15:43:24] 📊 Patient Response
     └─ patientFName: Serafim
     └─ patientLName: Mimoso
     └─ dob: 05/08/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250414053302
     └─ billingProvider: Martin, Daniel MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 281 Davis St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (508) 993-8866
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/18/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E87.1', 'fourthDiagnosis': 'J44.89', 'fifthDiagnosis': 'I11.0', 'sixthDiagnosis': 'I50.32'}]
[15:43:24] ✅    ✅ Patient identified: Serafim Mimoso
[15:43:24] ✅    ✅ Patient name validation passed
[15:43:24] 🔄 
🔄 Step 3: Processing patient dates...
[15:43:24] [DOC: 9266647] ℹ️  DOB normalized: 05/08/1933
[15:43:24] [DOC: 9266647] ℹ️  Episode startOfCare normalized: 04/18/2025
[15:43:24] [DOC: 9266647] ℹ️  Episode startOfEpisode normalized: 04/18/2025
[15:43:24] [DOC: 9266647] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[15:43:24] [DOC: 9266647] ✅ Patient date processing completed successfully
[15:43:24] ✅    ✅ Date processing completed
[15:43:24] 📊 Processed Patient Data
     └─ patientFName: Serafim
     └─ patientLName: Mimoso
     └─ dob: 05/08/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250414053302
     └─ billingProvider: Martin, Daniel MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 281 Davis St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (508) 993-8866
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/18/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E87.1', 'fourthDiagnosis': 'J44.89', 'fifthDiagnosis': 'I11.0', 'sixthDiagnosis': 'I50.32'}]
[15:43:24] 🔄 
🔄 Step 4: Extracting order data...
[15:43:27] ℹ️  Order extraction - MRN: 'MA250414053302'
[15:43:27] ℹ️  Order extraction - Sex: 'MALE'
[15:43:27] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:43:27] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:43:27] ✅ Order data extraction completed successfully
[15:43:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:43:27] ℹ️  Using MRN from patient data: 'MA250414053302' over 'MA250414053302'
[15:43:27] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:43:27] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:43:27] ✅ Patient name cross-validation successful
[15:43:27] ✅    ✅ Data merged successfully
[15:43:28] ✅    ✅ Order data extracted and validated
[15:43:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:43:28] [DOC: 9266647] ✅ Patient found in local cache: Serafim Mimoso, ID: 0849f00a-166d-4c7d-969a-5567b25056c1
[15:43:28] ✅    ✅ Existing patient found with ID: 0849f00a-166d-4c7d-969a-5567b25056c1
[15:43:28] 🔄 
🔄 Step 6: Pushing order to API...
[15:43:28] [DOC: 9266647] ℹ️  Pushing order via API for patient ID: 0849f00a-166d-4c7d-969a-5567b25056c1
[15:43:29] [DOC: 9266647] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14107"}
[15:43:29] ❌    ❌ Failed to push order
[15:43:29] 🔄 
🔄 Step 7: Writing to CSV...
[15:43:29] [DOC: 9266647] ℹ️  Calculated age: 92 from DOB: 05/08/1933
[15:43:29] [DOC: 9266647] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[15:43:29] [DOC: 9266647] ℹ️  Payer Source extracted: 'Medicare'
[15:43:29] [DOC: 9266647] ℹ️  Diagnosis codes being written:
[15:43:29] [DOC: 9266647] ℹ️    - Latest_Episode_Firstdiagnosis: 'A04.72'
[15:43:29] [DOC: 9266647] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[15:43:29] [DOC: 9266647] ℹ️    - Latest_Episode_Thirddiagnosis: 'E87.1'
[15:43:29] [DOC: 9266647] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J44.89'
[15:43:29] [DOC: 9266647] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I11.0'
[15:43:29] [DOC: 9266647] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I50.32'
[15:43:29] [DOC: 9266647] ✅ Patient data written to CSV: Serafim Mimoso | Sex: MALE | Age: 92 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: MA250414053302
[15:43:29] ✅    ✅ Document 9266647 processed and saved successfully
[15:43:29] 🔄 
🔄 Step 8: Saving API details...
[15:43:29] [DOC: 9266647] ℹ️  API push details saved for document 9266647
[15:43:29] ✅    ✅ API details saved
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[15:43:29] ℹ️  Total Processed: 49
[15:43:29] ℹ️  CSV Success: 34
[15:43:29] ℹ️  CSV Errors: 7
[15:43:29] ℹ️  API Success: 0
[15:43:29] ℹ️  API Errors: 42
[15:43:29] ℹ️  CSV Success Rate: 69.4%
[15:43:29] ℹ️  API Success Rate: 0.0%
[15:43:29] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250607_153057.csv
[15:43:29] ℹ️  API Details File: api_outputs/api_push_details_20250607_153057.csv
================================================================================
║          ============================================================          ║
================================================================================
