================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[12:50:21] ℹ️  CSV Data Extraction & API Push Tool
[12:50:21] ℹ️  
[12:50:21] ℹ️  Features:
[12:50:21] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[12:50:21] ℹ️  - AI-powered patient and order data extraction
[12:50:21] ℹ️  - Enhanced error handling and logging
[12:50:21] ℹ️  - Full API integration (patient creation + order pushing)
[12:50:21] ℹ️  - CSV output with comprehensive patient data
[12:50:21] ℹ️  - Detailed API tracking with remarks for every document
[12:50:21] ℹ️  - Complete audit trail of all processing attempts
[12:50:21] ℹ️  
[12:50:21] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[12:50:21] ✅ Created output CSV file: csv_outputs/extracted_patients_20250607_125021.csv
[12:50:21] ✅ Created API details CSV file: api_outputs/api_push_details_20250607_125021.csv
================================================================================
║                        Processing Document ID: 9319464                         ║
================================================================================
[12:50:21] ℹ️  Agency: Dartmouth HH
[12:50:21] ℹ️  Date: 05/30/2025
[12:50:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[12:50:32] [DOC: 9319464] ✅ Text extracted using pdfplumber (11425 chars)
[12:50:32] ✅    ✅ Text extracted using pdfplumber (11413 chars)
[12:50:32] 🔄 
🔄 Step 2: Extracting patient data...
[12:50:35] ℹ️  AI extracted raw sex value: 'F'
[12:50:35] ℹ️  AI extracted service line: 'PT, RN'
[12:50:35] ℹ️  AI extracted payer source: 'None'
[12:50:35] ℹ️  AI extracted diagnoses:
[12:50:35] ℹ️    - Diagnosis 1: 'M17.12'
[12:50:35] ℹ️    - Diagnosis 2: 'R29.6'
[12:50:35] ℹ️    - Diagnosis 3: 'E11.43'
[12:50:35] ℹ️    - Diagnosis 4: 'K31.84'
[12:50:35] ℹ️    - Diagnosis 5: 'R42'
[12:50:35] ℹ️    - Diagnosis 6: 'M35.3'
[12:50:35] ℹ️  Final extracted MRN: '227027'
[12:50:35] ℹ️  Final extracted Sex: 'FEMALE'
[12:50:35] ℹ️  Final extracted Service Line: 'PT, RN'
[12:50:35] ℹ️  Final extracted Payer Source: ''
[12:50:35] ✅ Patient data extraction completed successfully
[12:50:35] ✅    ✅ Patient data extracted successfully
[12:50:35] 📊 Patient Response
     └─ patientFName: Dorothy
     └─ patientLName: Fernandes
     └─ dob: 10/01/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 531 Faunce Corner Road Autumn Glen Apt 205
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: None
     └─ phoneNumber: (508) 996-3991
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': 'M17.12', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'E11.43', 'fourthDiagnosis': 'K31.84', 'fifthDiagnosis': 'R42', 'sixthDiagnosis': 'M35.3'}]
[12:50:35] ✅    ✅ Patient identified: Dorothy Fernandes
[12:50:35] ✅    ✅ Patient name validation passed
[12:50:35] 🔄 
🔄 Step 3: Processing patient dates...
[12:50:35] [DOC: 9319464] ℹ️  DOB normalized: 10/01/1937
[12:50:35] [DOC: 9319464] ℹ️  Episode startOfCare normalized: 03/20/2025
[12:50:35] [DOC: 9319464] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[12:50:35] [DOC: 9319464] ℹ️  Episode endOfEpisode normalized: 07/19/2025
[12:50:35] [DOC: 9319464] ✅ Patient date processing completed successfully
[12:50:35] ✅    ✅ Date processing completed
[12:50:35] 📊 Processed Patient Data
     └─ patientFName: Dorothy
     └─ patientLName: Fernandes
     └─ dob: 10/01/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 531 Faunce Corner Road Autumn Glen Apt 205
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ phoneNumber: (508) 996-3991
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': 'M17.12', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'E11.43', 'fourthDiagnosis': 'K31.84', 'fifthDiagnosis': 'R42', 'sixthDiagnosis': 'M35.3'}]
[12:50:35] 🔄 
🔄 Step 4: Extracting order data...
[12:50:38] ℹ️  Order extraction - MRN: '3649009'
[12:50:38] ℹ️  Order extraction - Sex: 'FEMALE'
[12:50:38] ℹ️  Order extraction - Service Line: 'PT, RN'
[12:50:38] ℹ️  Order extraction - Payer Source: ''
[12:50:38] ✅ Order data extraction completed successfully
[12:50:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[12:50:38] ℹ️  Using longer MRN from order data: '3649009' over '227027'
[12:50:38] ℹ️  Service line consistent in both sources: 'PT, RN'
[12:50:38] ✅ Patient name cross-validation successful
[12:50:38] ✅    ✅ Data merged successfully
[12:50:39] ✅    ✅ Order data extracted and validated
[12:50:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[12:56:31] [DOC: 9319464] ✅ Patient exists in API: Dorothy Fernandes, ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[12:56:31] ✅    ✅ Existing patient found with ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[12:56:31] 🔄 
🔄 Step 6: Pushing order to API...
[12:56:31] [DOC: 9319464] ℹ️  Pushing order via API for patient ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[12:56:33] [DOC: 9319464] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[12:56:33] ❌    ❌ Failed to push order
[12:56:33] 🔄 
🔄 Step 7: Writing to CSV...
[12:56:33] [DOC: 9319464] ℹ️  Calculated age: 87 from DOB: 10/01/1937
[12:56:33] [DOC: 9319464] ℹ️  Service Line extracted: 'PT, RN'
[12:56:33] [DOC: 9319464] ℹ️  Payer Source extracted: ''
[12:56:33] [DOC: 9319464] ℹ️  Diagnosis codes being written:
[12:56:33] [DOC: 9319464] ℹ️    - Latest_Episode_Firstdiagnosis: 'M17.12'
[12:56:33] [DOC: 9319464] ℹ️    - Latest_Episode_Seconddiagnosis: 'R29.6'
[12:56:33] [DOC: 9319464] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.43'
[12:56:33] [DOC: 9319464] ℹ️    - Latest_Episode_Fourthdiagnosis: 'K31.84'
[12:56:33] [DOC: 9319464] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R42'
[12:56:33] [DOC: 9319464] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M35.3'
[12:56:33] [DOC: 9319464] ✅ Patient data written to CSV: Dorothy Fernandes | Sex: FEMALE | Age: 87 | Service: PT, RN | Payer:  | MRN: 3649009
[12:56:33] ✅    ✅ Document 9319464 processed and saved successfully
[12:56:33] 🔄 
🔄 Step 8: Saving API details...
[12:56:33] [DOC: 9319464] ℹ️  API push details saved for document 9319464
[12:56:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319443                         ║
================================================================================
[12:56:33] ℹ️  Agency: Dartmouth HH
[12:56:33] ℹ️  Date: 05/30/2025
[12:56:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[12:56:35] [DOC: 9319443] ✅ Text extracted using pdfplumber (1529 chars)
[12:56:35] ✅    ✅ Text extracted using pdfplumber (1529 chars)
[12:56:35] 🔄 
🔄 Step 2: Extracting patient data...
[12:56:38] ℹ️  AI extracted raw sex value: 'F'
[12:56:38] ℹ️  AI extracted service line: 'Skilled Nursing'
[12:56:38] ℹ️  AI extracted payer source: 'Medicare'
[12:56:38] ℹ️  AI extracted diagnoses:
[12:56:38] ℹ️    - Diagnosis 1: ''
[12:56:38] ℹ️    - Diagnosis 2: ''
[12:56:38] ℹ️    - Diagnosis 3: ''
[12:56:38] ℹ️    - Diagnosis 4: ''
[12:56:38] ℹ️    - Diagnosis 5: ''
[12:56:38] ℹ️    - Diagnosis 6: ''
[12:56:38] ℹ️  Final extracted MRN: '6388015'
[12:56:38] ℹ️  Final extracted Sex: 'FEMALE'
[12:56:38] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[12:56:38] ℹ️  Final extracted Payer Source: 'Medicare'
[12:56:38] ✅ Patient data extraction completed successfully
[12:56:38] ✅    ✅ Patient data extracted successfully
[12:56:38] 📊 Patient Response
     └─ patientFName: Debra
     └─ patientLName: Golen
     └─ dob: 10/11/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6388015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2025', 'startOfEpisode': '04/19/2025', 'endOfEpisode': '06/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[12:56:38] ✅    ✅ Patient identified: Debra Golen
[12:56:38] ✅    ✅ Patient name validation passed
[12:56:38] 🔄 
🔄 Step 3: Processing patient dates...
[12:56:38] [DOC: 9319443] ℹ️  DOB normalized: 10/11/1959
[12:56:38] [DOC: 9319443] ℹ️  Episode startOfCare normalized: 04/19/2025
[12:56:38] [DOC: 9319443] ℹ️  Episode startOfEpisode normalized: 04/19/2025
[12:56:38] [DOC: 9319443] ℹ️  Episode endOfEpisode normalized: 06/17/2025
[12:56:38] [DOC: 9319443] ✅ Patient date processing completed successfully
[12:56:38] ✅    ✅ Date processing completed
[12:56:38] 📊 Processed Patient Data
     └─ patientFName: Debra
     └─ patientLName: Golen
     └─ dob: 10/11/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6388015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2025', 'startOfEpisode': '04/19/2025', 'endOfEpisode': '06/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[12:56:38] 🔄 
🔄 Step 4: Extracting order data...
[12:56:40] ℹ️  Order extraction - MRN: ''
[12:56:40] ℹ️  Order extraction - Sex: 'FEMALE'
[12:56:40] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[12:56:40] ℹ️  Order extraction - Payer Source: 'Medicare'
[12:56:40] ✅ Order data extraction completed successfully
[12:56:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[12:56:40] ℹ️  Using MRN from patient data: '6388015'
[12:56:40] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[12:56:40] ℹ️  Payer source consistent in both sources: 'Medicare'
[12:56:40] ✅ Patient name cross-validation successful
[12:56:40] ✅    ✅ Data merged successfully
[12:56:41] ✅    ✅ Order data extracted and validated
[12:56:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[12:57:17] [DOC: 9319443] ✅ Patient exists in API: Debra Golen, ID: 8ad987e4-de36-4026-98ee-7d79d753bc6c
[12:57:17] ✅    ✅ Existing patient found with ID: 8ad987e4-de36-4026-98ee-7d79d753bc6c
[12:57:17] 🔄 
🔄 Step 6: Pushing order to API...
[12:57:17] [DOC: 9319443] ℹ️  Pushing order via API for patient ID: 8ad987e4-de36-4026-98ee-7d79d753bc6c
[12:57:18] [DOC: 9319443] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13786"}
[12:57:18] ❌    ❌ Failed to push order
[12:57:18] 🔄 
🔄 Step 7: Writing to CSV...
[12:57:18] [DOC: 9319443] ℹ️  Calculated age: 65 from DOB: 10/11/1959
[12:57:18] [DOC: 9319443] ℹ️  Service Line extracted: 'Skilled Nursing'
[12:57:18] [DOC: 9319443] ℹ️  Payer Source extracted: 'Medicare'
[12:57:18] [DOC: 9319443] ℹ️  Diagnosis codes being written:
[12:57:18] [DOC: 9319443] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[12:57:18] [DOC: 9319443] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[12:57:18] [DOC: 9319443] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[12:57:18] [DOC: 9319443] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[12:57:18] [DOC: 9319443] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[12:57:18] [DOC: 9319443] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[12:57:18] [DOC: 9319443] ✅ Patient data written to CSV: Debra Golen | Sex: FEMALE | Age: 65 | Service: Skilled Nursing | Payer: Medicare | MRN: 6388015
[12:57:18] ✅    ✅ Document 9319443 processed and saved successfully
[12:57:18] 🔄 
🔄 Step 8: Saving API details...
[12:57:18] [DOC: 9319443] ℹ️  API push details saved for document 9319443
[12:57:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319434                         ║
================================================================================
[12:57:18] ℹ️  Agency: Dartmouth HH
[12:57:18] ℹ️  Date: 05/30/2025
[12:57:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[12:57:21] [DOC: 9319434] ✅ Text extracted using pdfplumber (1198 chars)
[12:57:21] ✅    ✅ Text extracted using pdfplumber (1198 chars)
[12:57:21] 🔄 
🔄 Step 2: Extracting patient data...
[12:57:23] ℹ️  AI extracted raw sex value: 'F'
[12:57:23] ℹ️  AI extracted service line: 'RN, LPN'
[12:57:23] ℹ️  AI extracted payer source: 'Medicare'
[12:57:23] ℹ️  AI extracted diagnoses:
[12:57:23] ℹ️    - Diagnosis 1: ''
[12:57:23] ℹ️    - Diagnosis 2: ''
[12:57:23] ℹ️    - Diagnosis 3: ''
[12:57:23] ℹ️    - Diagnosis 4: ''
[12:57:23] ℹ️    - Diagnosis 5: ''
[12:57:23] ℹ️    - Diagnosis 6: ''
[12:57:23] ℹ️  Final extracted MRN: '5662015'
[12:57:23] ℹ️  Final extracted Sex: 'FEMALE'
[12:57:23] ℹ️  Final extracted Service Line: 'RN, LPN'
[12:57:23] ℹ️  Final extracted Payer Source: 'Medicare'
[12:57:23] ✅ Patient data extraction completed successfully
[12:57:23] ✅    ✅ Patient data extracted successfully
[12:57:23] 📊 Patient Response
     └─ patientFName: Betty
     └─ patientLName: Mendonca
     └─ dob: 04/08/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5662015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/08/2024', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[12:57:23] ✅    ✅ Patient identified: Betty Mendonca
[12:57:23] ✅    ✅ Patient name validation passed
[12:57:23] 🔄 
🔄 Step 3: Processing patient dates...
[12:57:23] [DOC: 9319434] ℹ️  DOB normalized: 04/08/1948
[12:57:23] [DOC: 9319434] ℹ️  Episode startOfCare normalized: 12/08/2024
[12:57:23] [DOC: 9319434] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[12:57:23] [DOC: 9319434] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[12:57:23] [DOC: 9319434] ✅ Patient date processing completed successfully
[12:57:23] ✅    ✅ Date processing completed
[12:57:23] 📊 Processed Patient Data
     └─ patientFName: Betty
     └─ patientLName: Mendonca
     └─ dob: 04/08/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5662015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/08/2024', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[12:57:23] 🔄 
🔄 Step 4: Extracting order data...
[12:57:26] ℹ️  Order extraction - MRN: ''
[12:57:26] ℹ️  Order extraction - Sex: 'FEMALE'
[12:57:26] ℹ️  Order extraction - Service Line: 'RN, LPN'
[12:57:26] ℹ️  Order extraction - Payer Source: 'Medicare'
[12:57:26] ✅ Order data extraction completed successfully
[12:57:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[12:57:26] ℹ️  Using MRN from patient data: '5662015'
[12:57:26] ℹ️  Service line consistent in both sources: 'RN, LPN'
[12:57:26] ℹ️  Payer source consistent in both sources: 'Medicare'
[12:57:26] ✅ Patient name cross-validation successful
[12:57:26] ✅    ✅ Data merged successfully
[12:57:27] ✅    ✅ Order data extracted and validated
[12:57:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[12:58:01] [DOC: 9319434] ✅ Patient exists in API: Betty Mendonca, ID: dc2cb3cb-7477-4086-bde7-6ddaee5d09e2
[12:58:01] ✅    ✅ Existing patient found with ID: dc2cb3cb-7477-4086-bde7-6ddaee5d09e2
[12:58:01] 🔄 
🔄 Step 6: Pushing order to API...
[12:58:01] [DOC: 9319434] ℹ️  Pushing order via API for patient ID: dc2cb3cb-7477-4086-bde7-6ddaee5d09e2
[12:58:02] [DOC: 9319434] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14093"}
[12:58:02] ❌    ❌ Failed to push order
[12:58:02] 🔄 
🔄 Step 7: Writing to CSV...
[12:58:02] [DOC: 9319434] ℹ️  Calculated age: 77 from DOB: 04/08/1948
[12:58:02] [DOC: 9319434] ℹ️  Service Line extracted: 'RN, LPN'
[12:58:02] [DOC: 9319434] ℹ️  Payer Source extracted: 'Medicare'
[12:58:02] [DOC: 9319434] ℹ️  Diagnosis codes being written:
[12:58:02] [DOC: 9319434] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[12:58:02] [DOC: 9319434] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[12:58:02] [DOC: 9319434] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[12:58:02] [DOC: 9319434] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[12:58:02] [DOC: 9319434] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[12:58:02] [DOC: 9319434] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[12:58:02] [DOC: 9319434] ✅ Patient data written to CSV: Betty Mendonca | Sex: FEMALE | Age: 77 | Service: RN, LPN | Payer: Medicare | MRN: 5662015
[12:58:02] ✅    ✅ Document 9319434 processed and saved successfully
[12:58:02] 🔄 
🔄 Step 8: Saving API details...
[12:58:02] [DOC: 9319434] ℹ️  API push details saved for document 9319434
[12:58:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319423                         ║
================================================================================
[12:58:02] ℹ️  Agency: Dartmouth HH
[12:58:02] ℹ️  Date: 05/30/2025
[12:58:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[12:58:04] [DOC: 9319423] ✅ Text extracted using pdfplumber (12021 chars)
[12:58:04] ✅    ✅ Text extracted using pdfplumber (12021 chars)
[12:58:04] 🔄 
🔄 Step 2: Extracting patient data...
[12:58:08] ℹ️  AI extracted raw sex value: 'F'
[12:58:08] ℹ️  AI extracted service line: 'Skilled Nursing'
[12:58:08] ℹ️  AI extracted payer source: 'Medicaid/MA'
[12:58:08] ℹ️  AI extracted diagnoses:
[12:58:08] ℹ️    - Diagnosis 1: 'G89.3'
[12:58:08] ℹ️    - Diagnosis 2: 'C49.21'
[12:58:08] ℹ️    - Diagnosis 3: 'C79.31'
[12:58:08] ℹ️    - Diagnosis 4: 'G62.0'
[12:58:08] ℹ️    - Diagnosis 5: 'T45.1X5D'
[12:58:08] ℹ️    - Diagnosis 6: 'C77.2'
[12:58:08] ℹ️  Final extracted MRN: '5391015'
[12:58:08] ℹ️  Final extracted Sex: 'FEMALE'
[12:58:08] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[12:58:08] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[12:58:08] ✅ Patient data extraction completed successfully
[12:58:08] ✅    ✅ Patient data extracted successfully
[12:58:08] 📊 Patient Response
     └─ patientFName: Maribel
     └─ patientLName: Pena
     └─ dob: 09/16/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5391015
     └─ billingProvider: Achilles Romualdo E Alcaraz, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '10/17/2024', 'startOfEpisode': '10/17/2024', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'G89.3', 'secondDiagnosis': 'C49.21', 'thirdDiagnosis': 'C79.31', 'fourthDiagnosis': 'G62.0', 'fifthDiagnosis': 'T45.1X5D', 'sixthDiagnosis': 'C77.2'}]
[12:58:08] ✅    ✅ Patient identified: Maribel Pena
[12:58:08] ✅    ✅ Patient name validation passed
[12:58:08] 🔄 
🔄 Step 3: Processing patient dates...
[12:58:08] [DOC: 9319423] ℹ️  DOB normalized: 09/16/1994
[12:58:08] [DOC: 9319423] ℹ️  Episode startOfCare normalized: 10/17/2024
[12:58:08] [DOC: 9319423] ℹ️  Episode startOfEpisode normalized: 10/17/2024
[12:58:08] [DOC: 9319423] ℹ️  Episode endOfEpisode normalized: 06/13/2025
[12:58:08] [DOC: 9319423] ✅ Patient date processing completed successfully
[12:58:08] ✅    ✅ Date processing completed
[12:58:08] 📊 Processed Patient Data
     └─ patientFName: Maribel
     └─ patientLName: Pena
     └─ dob: 09/16/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5391015
     └─ billingProvider: Achilles Romualdo E Alcaraz, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '10/17/2024', 'startOfEpisode': '10/17/2024', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'G89.3', 'secondDiagnosis': 'C49.21', 'thirdDiagnosis': 'C79.31', 'fourthDiagnosis': 'G62.0', 'fifthDiagnosis': 'T45.1X5D', 'sixthDiagnosis': 'C77.2'}]
[12:58:08] 🔄 
🔄 Step 4: Extracting order data...
[12:58:10] ℹ️  Order extraction - MRN: ''
[12:58:10] ℹ️  Order extraction - Sex: 'FEMALE'
[12:58:10] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[12:58:10] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[12:58:10] ✅ Order data extraction completed successfully
[12:58:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[12:58:10] ℹ️  Using MRN from patient data: '5391015'
[12:58:10] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[12:58:10] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[12:58:10] ✅ Patient name cross-validation successful
[12:58:10] ✅    ✅ Data merged successfully
[12:58:12] ✅    ✅ Order data extracted and validated
[12:58:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:00:28] [DOC: 9319423] ✅ Patient exists in API: Maribel Pena, ID: 21aca991-bba7-4f19-828f-34b178408fd4
[13:00:28] ✅    ✅ Existing patient found with ID: 21aca991-bba7-4f19-828f-34b178408fd4
[13:00:28] 🔄 
🔄 Step 6: Pushing order to API...
[13:00:28] [DOC: 9319423] ℹ️  Pushing order via API for patient ID: 21aca991-bba7-4f19-828f-34b178408fd4
[13:00:29] [DOC: 9319423] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13008"}
[13:00:29] ❌    ❌ Failed to push order
[13:00:29] 🔄 
🔄 Step 7: Writing to CSV...
[13:00:29] [DOC: 9319423] ℹ️  Calculated age: 30 from DOB: 09/16/1994
[13:00:29] [DOC: 9319423] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:00:29] [DOC: 9319423] ℹ️  Payer Source extracted: 'Medicaid/MA'
[13:00:29] [DOC: 9319423] ℹ️  Diagnosis codes being written:
[13:00:29] [DOC: 9319423] ℹ️    - Latest_Episode_Firstdiagnosis: 'G89.3'
[13:00:29] [DOC: 9319423] ℹ️    - Latest_Episode_Seconddiagnosis: 'C49.21'
[13:00:29] [DOC: 9319423] ℹ️    - Latest_Episode_Thirddiagnosis: 'C79.31'
[13:00:29] [DOC: 9319423] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G62.0'
[13:00:29] [DOC: 9319423] ℹ️    - Latest_Episode_Fifthdiagnosis: 'T45.1X5D'
[13:00:29] [DOC: 9319423] ℹ️    - Latest_Episode_Sixthdiagnosis: 'C77.2'
[13:00:29] [DOC: 9319423] ✅ Patient data written to CSV: Maribel Pena | Sex: FEMALE | Age: 30 | Service: Skilled Nursing | Payer: Medicaid/MA | MRN: 5391015
[13:00:29] ✅    ✅ Document 9319423 processed and saved successfully
[13:00:29] 🔄 
🔄 Step 8: Saving API details...
[13:00:29] [DOC: 9319423] ℹ️  API push details saved for document 9319423
[13:00:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319396                         ║
================================================================================
[13:00:29] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[13:00:29] ℹ️  Date: 05/30/2025
[13:00:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:00:32] [DOC: 9319396] ✅ Text extracted using pdfplumber (8578 chars)
[13:00:32] ✅    ✅ Text extracted using pdfplumber (8578 chars)
[13:00:32] 🔄 
🔄 Step 2: Extracting patient data...
[13:00:36] ℹ️  AI extracted raw sex value: 'F'
[13:00:36] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[13:00:36] ℹ️  AI extracted payer source: 'None'
[13:00:36] ℹ️  AI extracted diagnoses:
[13:00:36] ℹ️    - Diagnosis 1: 'F25.0'
[13:00:36] ℹ️    - Diagnosis 2: 'I26.99'
[13:00:36] ℹ️    - Diagnosis 3: 'I82.432'
[13:00:36] ℹ️    - Diagnosis 4: 'I44.1'
[13:00:36] ℹ️    - Diagnosis 5: 'F43.10'
[13:00:36] ℹ️    - Diagnosis 6: 'G40.909'
[13:00:36] ℹ️  Final extracted MRN: '1776'
[13:00:36] ℹ️  Final extracted Sex: 'FEMALE'
[13:00:36] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[13:00:36] ℹ️  Final extracted Payer Source: ''
[13:00:36] ✅ Patient data extraction completed successfully
[13:00:36] ✅    ✅ Patient data extracted successfully
[13:00:36] 📊 Patient Response
     └─ patientFName: Laurianna
     └─ patientLName: Capello
     └─ dob: 10/01/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1776
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1033131008
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/25/2015', 'startOfEpisode': '06/01/2025', 'endOfEpisode': '07/30/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'I26.99', 'thirdDiagnosis': 'I82.432', 'fourthDiagnosis': 'I44.1', 'fifthDiagnosis': 'F43.10', 'sixthDiagnosis': 'G40.909'}]
[13:00:36] ✅    ✅ Patient identified: Laurianna Capello
[13:00:36] ✅    ✅ Patient name validation passed
[13:00:36] 🔄 
🔄 Step 3: Processing patient dates...
[13:00:36] [DOC: 9319396] ℹ️  DOB normalized: 10/01/1947
[13:00:36] [DOC: 9319396] ℹ️  Episode startOfCare normalized: 05/25/2015
[13:00:36] [DOC: 9319396] ℹ️  Episode startOfEpisode normalized: 06/01/2025
[13:00:36] [DOC: 9319396] ℹ️  Episode endOfEpisode normalized: 07/30/2025
[13:00:36] [DOC: 9319396] ✅ Patient date processing completed successfully
[13:00:36] ✅    ✅ Date processing completed
[13:00:36] 📊 Processed Patient Data
     └─ patientFName: Laurianna
     └─ patientLName: Capello
     └─ dob: 10/01/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1776
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1033131008
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/25/2015', 'startOfEpisode': '06/01/2025', 'endOfEpisode': '07/30/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'I26.99', 'thirdDiagnosis': 'I82.432', 'fourthDiagnosis': 'I44.1', 'fifthDiagnosis': 'F43.10', 'sixthDiagnosis': 'G40.909'}]
[13:00:36] 🔄 
🔄 Step 4: Extracting order data...
[13:00:38] ℹ️  Order extraction - MRN: '1776'
[13:00:38] ℹ️  Order extraction - Sex: 'FEMALE'
[13:00:38] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:00:38] ℹ️  Order extraction - Payer Source: ''
[13:00:38] ✅ Order data extraction completed successfully
[13:00:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:00:38] ℹ️  Using MRN from patient data: '1776' over '1776'
[13:00:38] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[13:00:38] ✅ Patient name cross-validation successful
[13:00:38] ✅    ✅ Data merged successfully
[13:00:39] ✅    ✅ Order data extracted and validated
[13:00:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:00:47] [DOC: 9319396] ℹ️  Patient not found in cache or API: Laurianna Capello
[13:00:47] [DOC: 9319396] ℹ️  Patient not found, creating new patient via API...
[13:00:47] [DOC: 9319396] ℹ️  Creating patient via API: Laurianna Capello
[13:00:48] [DOC: 9319396] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:00:48] ❌    ❌ Failed to create patient
[13:00:48] [DOC: 9319396] ℹ️  API push details saved for document 9319396
================================================================================
║                        Processing Document ID: 9319381                         ║
================================================================================
[13:00:48] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[13:00:48] ℹ️  Date: 05/30/2025
[13:00:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:00:51] [DOC: 9319381] ✅ Text extracted using pdfplumber (5717 chars)
[13:00:51] ✅    ✅ Text extracted using pdfplumber (5717 chars)
[13:00:51] 🔄 
🔄 Step 2: Extracting patient data...
[13:00:54] ℹ️  AI extracted raw sex value: 'M'
[13:00:54] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:00:54] ℹ️  AI extracted payer source: ''
[13:00:54] ℹ️  AI extracted diagnoses:
[13:00:54] ℹ️    - Diagnosis 1: 'F32.9'
[13:00:54] ℹ️    - Diagnosis 2: 'E11.9'
[13:00:54] ℹ️    - Diagnosis 3: 'F81.9'
[13:00:54] ℹ️    - Diagnosis 4: 'F90.9'
[13:00:54] ℹ️    - Diagnosis 5: 'F41.9'
[13:00:54] ℹ️    - Diagnosis 6: 'I10'
[13:00:54] ℹ️  Final extracted MRN: '139005'
[13:00:54] ℹ️  Final extracted Sex: 'MALE'
[13:00:54] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:00:54] ℹ️  Final extracted Payer Source: ''
[13:00:54] ✅ Patient data extraction completed successfully
[13:00:54] ✅    ✅ Patient data extracted successfully
[13:00:54] 📊 Patient Response
     └─ patientFName: Lemmuel
     └─ patientLName: Lomba
     └─ dob: 08/15/2003
     └─ patientSex: MALE
     └─ medicalRecordNo: 139005
     └─ billingProvider: Versana- mom
     └─ npi: 100031908435
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/24/2021', 'startOfEpisode': '02/24/2021', 'endOfEpisode': '08/01/2025', 'firstDiagnosis': 'F32.9', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F81.9', 'fourthDiagnosis': 'F90.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'I10'}]
[13:00:54] ✅    ✅ Patient identified: Lemmuel Lomba
[13:00:54] ✅    ✅ Patient name validation passed
[13:00:54] 🔄 
🔄 Step 3: Processing patient dates...
[13:00:54] [DOC: 9319381] ℹ️  DOB normalized: 08/15/2003
[13:00:54] [DOC: 9319381] ℹ️  Episode startOfCare normalized: 02/24/2021
[13:00:54] [DOC: 9319381] ℹ️  Episode startOfEpisode normalized: 02/24/2021
[13:00:54] [DOC: 9319381] ℹ️  Episode endOfEpisode normalized: 08/01/2025
[13:00:54] [DOC: 9319381] ✅ Patient date processing completed successfully
[13:00:54] ✅    ✅ Date processing completed
[13:00:54] 📊 Processed Patient Data
     └─ patientFName: Lemmuel
     └─ patientLName: Lomba
     └─ dob: 08/15/2003
     └─ patientSex: MALE
     └─ medicalRecordNo: 139005
     └─ billingProvider: Versana- mom
     └─ npi: 100031908435
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/24/2021', 'startOfEpisode': '02/24/2021', 'endOfEpisode': '08/01/2025', 'firstDiagnosis': 'F32.9', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F81.9', 'fourthDiagnosis': 'F90.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'I10'}]
[13:00:54] 🔄 
🔄 Step 4: Extracting order data...
[13:00:57] ℹ️  Order extraction - MRN: '139005'
[13:00:57] ℹ️  Order extraction - Sex: 'MALE'
[13:00:57] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:00:57] ℹ️  Order extraction - Payer Source: ''
[13:00:57] ✅ Order data extraction completed successfully
[13:00:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:00:57] ℹ️  Using MRN from patient data: '139005' over '139005'
[13:00:57] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:00:57] ✅ Patient name cross-validation successful
[13:00:57] ✅    ✅ Data merged successfully
[13:00:58] ✅    ✅ Order data extracted and validated
[13:00:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:02:08] [DOC: 9319381] ✅ Patient exists in API: Lemmuel Lomba, ID: 0836dc34-5724-4813-b116-dff31377a557
[13:02:08] ✅    ✅ Existing patient found with ID: 0836dc34-5724-4813-b116-dff31377a557
[13:02:08] 🔄 
🔄 Step 6: Pushing order to API...
[13:02:08] [DOC: 9319381] ℹ️  Pushing order via API for patient ID: 0836dc34-5724-4813-b116-dff31377a557
[13:02:10] [DOC: 9319381] ❌ Order push failed with status 201: {"id":"0892c30c-aad4-4e41-a329-0336cb8cdb9e","orderWAVId":"ORD19939","orderNo":"139005","orderDate":"05/29/2025","startOfCare":"02/24/2021","episodeStartDate":"06/03/2025","episodeEndDate":"08/01/2025","documentID":"9319381","mrn":"139005","patientName":"Lomba, Lemmuel","sentToPhysicianDate":"05/30/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"06/04/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"0836dc34-5724-4813-b116-dff31377a557","companyId":"0f46ebbe-720c-4abb-8809-892864387620","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[13:02:10] ❌    ❌ Failed to push order
[13:02:10] 🔄 
🔄 Step 7: Writing to CSV...
[13:02:10] [DOC: 9319381] ℹ️  Calculated age: 21 from DOB: 08/15/2003
[13:02:10] [DOC: 9319381] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:02:10] [DOC: 9319381] ℹ️  Payer Source extracted: ''
[13:02:10] [DOC: 9319381] ℹ️  Diagnosis codes being written:
[13:02:10] [DOC: 9319381] ℹ️    - Latest_Episode_Firstdiagnosis: 'F32.9'
[13:02:10] [DOC: 9319381] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[13:02:10] [DOC: 9319381] ℹ️    - Latest_Episode_Thirddiagnosis: 'F81.9'
[13:02:10] [DOC: 9319381] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F90.9'
[13:02:10] [DOC: 9319381] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[13:02:10] [DOC: 9319381] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I10'
[13:02:10] [DOC: 9319381] ✅ Patient data written to CSV: Lemmuel Lomba | Sex: MALE | Age: 21 | Service: Skilled Nursing | Payer:  | MRN: 139005
[13:02:10] ✅    ✅ Document 9319381 processed and saved successfully
[13:02:10] 🔄 
🔄 Step 8: Saving API details...
[13:02:10] [DOC: 9319381] ℹ️  API push details saved for document 9319381
[13:02:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319210                         ║
================================================================================
[13:02:10] ℹ️  Agency: AccentCare Fall River
[13:02:10] ℹ️  Date: 05/30/2025
[13:02:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:02:13] [DOC: 9319210] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[13:02:14] [DOC: 9319210] ✅ Text extracted using tesseract_ocr (1579 chars)
[13:02:14] ✅    ✅ Text extracted using tesseract_ocr (1574 chars)
[13:02:14] 🔄 
🔄 Step 2: Extracting patient data...
[13:02:17] ℹ️  AI extracted raw sex value: ''
[13:02:17] ℹ️  AI extracted service line: 'PT'
[13:02:17] ℹ️  AI extracted payer source: ''
[13:02:17] ℹ️  AI extracted diagnoses:
[13:02:17] ℹ️    - Diagnosis 1: 'None'
[13:02:17] ℹ️    - Diagnosis 2: 'None'
[13:02:17] ℹ️    - Diagnosis 3: 'None'
[13:02:17] ℹ️    - Diagnosis 4: 'None'
[13:02:17] ℹ️    - Diagnosis 5: 'None'
[13:02:17] ℹ️    - Diagnosis 6: 'None'
[13:02:17] ℹ️  Final extracted MRN: 'C0200089983601'
[13:02:17] ℹ️  Final extracted Sex: ''
[13:02:17] ℹ️  Final extracted Service Line: 'PT'
[13:02:17] ℹ️  Final extracted Payer Source: ''
[13:02:17] ✅ Patient data extraction completed successfully
[13:02:17] ✅    ✅ Patient data extracted successfully
[13:02:17] 📊 Patient Response
     └─ patientFName: EILEEN
     └─ patientLName: MENKER
     └─ dob: 03/27/1946
     └─ patientSex: 
     └─ medicalRecordNo: C0200089983601
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/29/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:02:17] ✅    ✅ Patient identified: EILEEN MENKER
[13:02:17] ✅    ✅ Patient name validation passed
[13:02:17] 🔄 
🔄 Step 3: Processing patient dates...
[13:02:17] [DOC: 9319210] ℹ️  DOB normalized: 03/27/1946
[13:02:17] [DOC: 9319210] ℹ️  Episode startOfEpisode normalized: 04/29/2025
[13:02:17] [DOC: 9319210] ℹ️  Episode endOfEpisode normalized: 04/30/2025
[13:02:17] [DOC: 9319210] ✅ Patient date processing completed successfully
[13:02:17] ✅    ✅ Date processing completed
[13:02:17] 📊 Processed Patient Data
     └─ patientFName: EILEEN
     └─ patientLName: MENKER
     └─ dob: 03/27/1946
     └─ patientSex: 
     └─ medicalRecordNo: C0200089983601
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/29/2025', 'endOfEpisode': '04/30/2025'}]
[13:02:17] 🔄 
🔄 Step 4: Extracting order data...
[13:02:19] ℹ️  Order extraction - MRN: 'C0200089983601'
[13:02:19] ℹ️  Order extraction - Sex: 'FEMALE'
[13:02:19] ℹ️  Order extraction - Service Line: 'PT'
[13:02:19] ℹ️  Order extraction - Payer Source: ''
[13:02:19] ✅ Order data extraction completed successfully
[13:02:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:02:19] ℹ️  Using MRN from patient data: 'C0200089983601' over 'C0200089983601'
[13:02:19] ℹ️  Service line consistent in both sources: 'PT'
[13:02:19] ✅ Patient name cross-validation successful
[13:02:19] ✅    ✅ Data merged successfully
[13:02:20] ✅    ✅ Order data extracted and validated
[13:02:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:02:27] [DOC: 9319210] ℹ️  Patient not found in cache or API: EILEEN MENKER
[13:02:27] [DOC: 9319210] ℹ️  Patient not found, creating new patient via API...
[13:02:27] [DOC: 9319210] ℹ️  Creating patient via API: EILEEN MENKER
[13:02:30] [DOC: 9319210] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:02:30] ❌    ❌ Failed to create patient
[13:02:30] [DOC: 9319210] ℹ️  API push details saved for document 9319210
================================================================================
║                        Processing Document ID: 9319140                         ║
================================================================================
[13:02:30] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:02:30] ℹ️  Date: 05/30/2025
[13:02:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:02:33] [DOC: 9319140] ✅ Text extracted using pdfplumber (18407 chars)
[13:02:33] ✅    ✅ Text extracted using pdfplumber (18407 chars)
[13:02:33] 🔄 
🔄 Step 2: Extracting patient data...
[13:02:36] ℹ️  AI extracted raw sex value: 'F'
[13:02:36] ℹ️  AI extracted service line: 'PT'
[13:02:36] ℹ️  AI extracted payer source: ''
[13:02:36] ℹ️  AI extracted diagnoses:
[13:02:36] ℹ️    - Diagnosis 1: 'Unsp fracture of right pubis'
[13:02:36] ℹ️    - Diagnosis 2: ''
[13:02:36] ℹ️    - Diagnosis 3: ''
[13:02:36] ℹ️    - Diagnosis 4: ''
[13:02:36] ℹ️    - Diagnosis 5: ''
[13:02:36] ℹ️    - Diagnosis 6: ''
[13:02:36] ℹ️  Final extracted MRN: 'MA221116116005'
[13:02:36] ℹ️  Final extracted Sex: 'FEMALE'
[13:02:36] ℹ️  Final extracted Service Line: 'PT'
[13:02:36] ℹ️  Final extracted Payer Source: ''
[13:02:36] ✅ Patient data extraction completed successfully
[13:02:36] ✅    ✅ Patient data extracted successfully
[13:02:36] 📊 Patient Response
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Unsp fracture of right pubis', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:02:36] ✅    ✅ Patient identified: Kelly Medeiros
[13:02:36] ✅    ✅ Patient name validation passed
[13:02:36] 🔄 
🔄 Step 3: Processing patient dates...
[13:02:36] [DOC: 9319140] ℹ️  DOB normalized: 11/23/1960
[13:02:36] [DOC: 9319140] ℹ️  Episode startOfEpisode normalized: 01/30/2025
[13:02:36] [DOC: 9319140] ✅ Patient date processing completed successfully
[13:02:36] ✅    ✅ Date processing completed
[13:02:36] 📊 Processed Patient Data
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Unsp fracture of right pubis', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:02:36] 🔄 
🔄 Step 4: Extracting order data...
[13:02:39] ℹ️  Order extraction - MRN: 'MA221116116005'
[13:02:39] ℹ️  Order extraction - Sex: 'FEMALE'
[13:02:39] ℹ️  Order extraction - Service Line: 'PT'
[13:02:39] ℹ️  Order extraction - Payer Source: ''
[13:02:39] ✅ Order data extraction completed successfully
[13:02:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:02:39] ℹ️  Using MRN from patient data: 'MA221116116005' over 'MA221116116005'
[13:02:39] ℹ️  Service line consistent in both sources: 'PT'
[13:02:39] ✅ Patient name cross-validation successful
[13:02:39] ✅    ✅ Data merged successfully
[13:02:40] ⚠️     ❌ Skipping - missing episode start date
[13:02:40] [DOC: 9319140] ℹ️  API push details saved for document 9319140
================================================================================
║                        Processing Document ID: 9319086                         ║
================================================================================
[13:02:40] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:02:40] ℹ️  Date: 05/30/2025
[13:02:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:02:43] [DOC: 9319086] ✅ Text extracted using pdfplumber (19476 chars)
[13:02:43] ✅    ✅ Text extracted using pdfplumber (19464 chars)
[13:02:43] 🔄 
🔄 Step 2: Extracting patient data...
[13:02:47] ℹ️  AI extracted raw sex value: 'F'
[13:02:47] ℹ️  AI extracted service line: 'PT, OT'
[13:02:47] ℹ️  AI extracted payer source: 'Medicare'
[13:02:47] ℹ️  AI extracted diagnoses:
[13:02:47] ℹ️    - Diagnosis 1: 'I12.0'
[13:02:47] ℹ️    - Diagnosis 2: 'N18.5'
[13:02:47] ℹ️    - Diagnosis 3: 'D63.1'
[13:02:47] ℹ️    - Diagnosis 4: 'G25.81'
[13:02:47] ℹ️    - Diagnosis 5: 'M54.2'
[13:02:47] ℹ️    - Diagnosis 6: 'J47.9'
[13:02:47] ℹ️  Final extracted MRN: 'MA220308043601'
[13:02:47] ℹ️  Final extracted Sex: 'FEMALE'
[13:02:47] ℹ️  Final extracted Service Line: 'PT, OT'
[13:02:47] ℹ️  Final extracted Payer Source: 'Medicare'
[13:02:47] ✅ Patient data extraction completed successfully
[13:02:47] ✅    ✅ Patient data extracted successfully
[13:02:47] 📊 Patient Response
     └─ patientFName: Charlotte
     └─ patientLName: Lefrancois
     └─ dob: 04/08/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220308043601
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033476627
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/30/2024', 'startOfEpisode': '04/29/2025', 'endOfEpisode': '06/27/2025', 'firstDiagnosis': 'I12.0', 'secondDiagnosis': 'N18.5', 'thirdDiagnosis': 'D63.1', 'fourthDiagnosis': 'G25.81', 'fifthDiagnosis': 'M54.2', 'sixthDiagnosis': 'J47.9'}]
[13:02:47] ✅    ✅ Patient identified: Charlotte Lefrancois
[13:02:47] ✅    ✅ Patient name validation passed
[13:02:47] 🔄 
🔄 Step 3: Processing patient dates...
[13:02:47] [DOC: 9319086] ℹ️  DOB normalized: 04/08/1936
[13:02:47] [DOC: 9319086] ℹ️  Episode startOfCare normalized: 12/30/2024
[13:02:47] [DOC: 9319086] ℹ️  Episode startOfEpisode normalized: 04/29/2025
[13:02:47] [DOC: 9319086] ℹ️  Episode endOfEpisode normalized: 06/27/2025
[13:02:47] [DOC: 9319086] ✅ Patient date processing completed successfully
[13:02:47] ✅    ✅ Date processing completed
[13:02:47] 📊 Processed Patient Data
     └─ patientFName: Charlotte
     └─ patientLName: Lefrancois
     └─ dob: 04/08/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220308043601
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1033476627
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/30/2024', 'startOfEpisode': '04/29/2025', 'endOfEpisode': '06/27/2025', 'firstDiagnosis': 'I12.0', 'secondDiagnosis': 'N18.5', 'thirdDiagnosis': 'D63.1', 'fourthDiagnosis': 'G25.81', 'fifthDiagnosis': 'M54.2', 'sixthDiagnosis': 'J47.9'}]
[13:02:47] 🔄 
🔄 Step 4: Extracting order data...
[13:02:50] ℹ️  Order extraction - MRN: 'MA220308043601'
[13:02:50] ℹ️  Order extraction - Sex: 'FEMALE'
[13:02:50] ℹ️  Order extraction - Service Line: 'PT, OT'
[13:02:50] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:02:50] ✅ Order data extraction completed successfully
[13:02:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:02:50] ℹ️  Using MRN from patient data: 'MA220308043601' over 'MA220308043601'
[13:02:50] ℹ️  Service line consistent in both sources: 'PT, OT'
[13:02:50] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:02:50] ✅ Patient name cross-validation successful
[13:02:50] ✅    ✅ Data merged successfully
[13:02:51] ✅    ✅ Order data extracted and validated
[13:02:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:04:21] [DOC: 9319086] ℹ️  Patient not found in cache or API: Charlotte Lefrancois
[13:04:21] [DOC: 9319086] ℹ️  Patient not found, creating new patient via API...
[13:04:21] [DOC: 9319086] ℹ️  Creating patient via API: Charlotte Lefrancois
[13:04:22] [DOC: 9319086] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:04:22] ❌    ❌ Failed to create patient
[13:04:22] [DOC: 9319086] ℹ️  API push details saved for document 9319086
================================================================================
║                        Processing Document ID: 9318995                         ║
================================================================================
[13:04:22] ℹ️  Agency: Dartmouth HH
[13:04:22] ℹ️  Date: 05/30/2025
[13:04:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:04:24] [DOC: 9318995] ✅ Text extracted using pdfplumber (1580 chars)
[13:04:24] ✅    ✅ Text extracted using pdfplumber (1580 chars)
[13:04:24] 🔄 
🔄 Step 2: Extracting patient data...
[13:04:27] ℹ️  AI extracted raw sex value: 'M'
[13:04:27] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:04:27] ℹ️  AI extracted payer source: 'Medicare'
[13:04:27] ℹ️  AI extracted diagnoses:
[13:04:27] ℹ️    - Diagnosis 1: ''
[13:04:27] ℹ️    - Diagnosis 2: ''
[13:04:27] ℹ️    - Diagnosis 3: ''
[13:04:27] ℹ️    - Diagnosis 4: ''
[13:04:27] ℹ️    - Diagnosis 5: ''
[13:04:27] ℹ️    - Diagnosis 6: ''
[13:04:27] ℹ️  Final extracted MRN: '6208015'
[13:04:27] ℹ️  Final extracted Sex: 'MALE'
[13:04:27] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:04:27] ℹ️  Final extracted Payer Source: 'Medicare'
[13:04:27] ✅ Patient data extraction completed successfully
[13:04:27] ✅    ✅ Patient data extracted successfully
[13:04:27] 📊 Patient Response
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 6208015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1013 Marlborough St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '05/14/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:04:27] ✅    ✅ Patient identified: Stephen Hanna Jr,
[13:04:27] ✅    ✅ Patient name validation passed
[13:04:27] 🔄 
🔄 Step 3: Processing patient dates...
[13:04:27] [DOC: 9318995] ℹ️  DOB normalized: 03/11/1936
[13:04:27] [DOC: 9318995] ℹ️  Episode startOfCare normalized: 03/15/2025
[13:04:27] [DOC: 9318995] ℹ️  Episode startOfEpisode normalized: 05/14/2025
[13:04:27] [DOC: 9318995] ℹ️  Episode endOfEpisode normalized: 07/12/2025
[13:04:27] [DOC: 9318995] ✅ Patient date processing completed successfully
[13:04:27] ✅    ✅ Date processing completed
[13:04:27] 📊 Processed Patient Data
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 6208015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1013 Marlborough St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '05/14/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:04:27] 🔄 
🔄 Step 4: Extracting order data...
[13:04:30] ℹ️  Order extraction - MRN: ''
[13:04:30] ℹ️  Order extraction - Sex: 'MALE'
[13:04:30] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:04:30] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:04:30] ✅ Order data extraction completed successfully
[13:04:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:04:30] ℹ️  Using MRN from patient data: '6208015'
[13:04:30] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:04:30] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:04:30] ✅ Patient name cross-validation successful
[13:04:30] ✅    ✅ Data merged successfully
[13:04:31] ✅    ✅ Order data extracted and validated
[13:04:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:04:39] [DOC: 9318995] ✅ Patient exists in API: Stephen Hanna Jr,, ID: 38583918-d125-4291-a4c2-8551b1d02929
[13:04:39] ✅    ✅ Existing patient found with ID: 38583918-d125-4291-a4c2-8551b1d02929
[13:04:39] 🔄 
🔄 Step 6: Pushing order to API...
[13:04:39] [DOC: 9318995] ℹ️  Pushing order via API for patient ID: 38583918-d125-4291-a4c2-8551b1d02929
[13:04:40] [DOC: 9318995] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:04:40] ❌    ❌ Failed to push order
[13:04:40] 🔄 
🔄 Step 7: Writing to CSV...
[13:04:40] [DOC: 9318995] ℹ️  Calculated age: 89 from DOB: 03/11/1936
[13:04:40] [DOC: 9318995] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:04:40] [DOC: 9318995] ℹ️  Payer Source extracted: 'Medicare'
[13:04:40] [DOC: 9318995] ℹ️  Diagnosis codes being written:
[13:04:40] [DOC: 9318995] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:04:40] [DOC: 9318995] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:04:40] [DOC: 9318995] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:04:40] [DOC: 9318995] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:04:40] [DOC: 9318995] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:04:40] [DOC: 9318995] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:04:40] [DOC: 9318995] ✅ Patient data written to CSV: Stephen Hanna Jr, | Sex: MALE | Age: 89 | Service: Skilled Nursing | Payer: Medicare | MRN: 6208015
[13:04:40] ✅    ✅ Document 9318995 processed and saved successfully
[13:04:40] 🔄 
🔄 Step 8: Saving API details...
[13:04:40] [DOC: 9318995] ℹ️  API push details saved for document 9318995
[13:04:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9318993                         ║
================================================================================
[13:04:40] ℹ️  Agency: Dartmouth HH
[13:04:40] ℹ️  Date: 05/30/2025
[13:04:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:04:42] [DOC: 9318993] ✅ Text extracted using pdfplumber (6619 chars)
[13:04:42] ✅    ✅ Text extracted using pdfplumber (6619 chars)
[13:04:42] 🔄 
🔄 Step 2: Extracting patient data...
[13:04:45] ℹ️  AI extracted raw sex value: 'F'
[13:04:45] ℹ️  AI extracted service line: 'OT, PT'
[13:04:45] ℹ️  AI extracted payer source: 'Medicare'
[13:04:45] ℹ️  AI extracted diagnoses:
[13:04:45] ℹ️    - Diagnosis 1: 'None'
[13:04:45] ℹ️    - Diagnosis 2: 'None'
[13:04:45] ℹ️    - Diagnosis 3: 'None'
[13:04:45] ℹ️    - Diagnosis 4: 'None'
[13:04:45] ℹ️    - Diagnosis 5: 'None'
[13:04:45] ℹ️    - Diagnosis 6: 'None'
[13:04:45] ℹ️  Final extracted MRN: '672008'
[13:04:45] ℹ️  Final extracted Sex: 'FEMALE'
[13:04:45] ℹ️  Final extracted Service Line: 'OT, PT'
[13:04:45] ℹ️  Final extracted Payer Source: 'Medicare'
[13:04:45] ✅ Patient data extraction completed successfully
[13:04:45] ✅    ✅ Patient data extracted successfully
[13:04:45] 📊 Patient Response
     └─ patientFName: Jane
     └─ patientLName: Lonsdale
     └─ dob: 02/20/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 672008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:04:45] ✅    ✅ Patient identified: Jane Lonsdale
[13:04:45] ✅    ✅ Patient name validation passed
[13:04:45] 🔄 
🔄 Step 3: Processing patient dates...
[13:04:45] [DOC: 9318993] ℹ️  DOB normalized: 02/20/1930
[13:04:45] [DOC: 9318993] ℹ️  Episode startOfCare normalized: 03/09/2025
[13:04:45] [DOC: 9318993] ℹ️  Episode startOfEpisode normalized: 05/08/2025
[13:04:45] [DOC: 9318993] ℹ️  Episode endOfEpisode normalized: 07/06/2025
[13:04:45] [DOC: 9318993] ✅ Patient date processing completed successfully
[13:04:45] ✅    ✅ Date processing completed
[13:04:45] 📊 Processed Patient Data
     └─ patientFName: Jane
     └─ patientLName: Lonsdale
     └─ dob: 02/20/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 672008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025'}]
[13:04:45] 🔄 
🔄 Step 4: Extracting order data...
[13:04:48] ℹ️  Order extraction - MRN: ''
[13:04:48] ℹ️  Order extraction - Sex: 'FEMALE'
[13:04:48] ℹ️  Order extraction - Service Line: 'OT, PT'
[13:04:48] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:04:48] ✅ Order data extraction completed successfully
[13:04:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:04:48] ℹ️  Using MRN from patient data: '672008'
[13:04:48] ℹ️  Service line consistent in both sources: 'OT, PT'
[13:04:48] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:04:48] ✅ Patient name cross-validation successful
[13:04:48] ✅    ✅ Data merged successfully
[13:04:49] ✅    ✅ Order data extracted and validated
[13:04:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:05:01] [DOC: 9318993] ℹ️  Patient not found in cache or API: Jane Lonsdale
[13:05:01] [DOC: 9318993] ℹ️  Patient not found, creating new patient via API...
[13:05:01] [DOC: 9318993] ℹ️  Creating patient via API: Jane Lonsdale
[13:05:03] [DOC: 9318993] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:05:03] ❌    ❌ Failed to create patient
[13:05:03] [DOC: 9318993] ℹ️  API push details saved for document 9318993
================================================================================
║                        Processing Document ID: 9318977                         ║
================================================================================
[13:05:03] ℹ️  Agency: Dartmouth HH
[13:05:03] ℹ️  Date: 05/30/2025
[13:05:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:05:04] [DOC: 9318977] ✅ Text extracted using pdfplumber (2010 chars)
[13:05:04] ✅    ✅ Text extracted using pdfplumber (2010 chars)
[13:05:04] 🔄 
🔄 Step 2: Extracting patient data...
[13:05:07] ℹ️  AI extracted raw sex value: 'F'
[13:05:07] ℹ️  AI extracted service line: 'PT'
[13:05:07] ℹ️  AI extracted payer source: 'Medicare'
[13:05:07] ℹ️  AI extracted diagnoses:
[13:05:07] ℹ️    - Diagnosis 1: ''
[13:05:07] ℹ️    - Diagnosis 2: ''
[13:05:07] ℹ️    - Diagnosis 3: ''
[13:05:07] ℹ️    - Diagnosis 4: ''
[13:05:07] ℹ️    - Diagnosis 5: ''
[13:05:07] ℹ️    - Diagnosis 6: ''
[13:05:07] ℹ️  Final extracted MRN: '2498015'
[13:05:07] ℹ️  Final extracted Sex: 'FEMALE'
[13:05:07] ℹ️  Final extracted Service Line: 'PT'
[13:05:07] ℹ️  Final extracted Payer Source: 'Medicare'
[13:05:07] ✅ Patient data extraction completed successfully
[13:05:07] ✅    ✅ Patient data extracted successfully
[13:05:07] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Kurtz
     └─ dob: 06/13/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2498015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/23/2025', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:05:07] ✅    ✅ Patient identified: Nancy Kurtz
[13:05:07] ✅    ✅ Patient name validation passed
[13:05:07] 🔄 
🔄 Step 3: Processing patient dates...
[13:05:07] [DOC: 9318977] ℹ️  DOB normalized: 06/13/1940
[13:05:07] [DOC: 9318977] ℹ️  Episode startOfCare normalized: 04/23/2025
[13:05:07] [DOC: 9318977] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[13:05:07] [DOC: 9318977] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[13:05:07] [DOC: 9318977] ✅ Patient date processing completed successfully
[13:05:07] ✅    ✅ Date processing completed
[13:05:07] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Kurtz
     └─ dob: 06/13/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2498015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/23/2025', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:05:07] 🔄 
🔄 Step 4: Extracting order data...
[13:05:10] ℹ️  Order extraction - MRN: ''
[13:05:10] ℹ️  Order extraction - Sex: 'FEMALE'
[13:05:10] ℹ️  Order extraction - Service Line: 'PT'
[13:05:10] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:05:10] ✅ Order data extraction completed successfully
[13:05:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:05:10] ℹ️  Using MRN from patient data: '2498015'
[13:05:10] ℹ️  Service line consistent in both sources: 'PT'
[13:05:10] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:05:10] ✅ Patient name cross-validation successful
[13:05:10] ✅    ✅ Data merged successfully
[13:05:11] ✅    ✅ Order data extracted and validated
[13:05:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:05:21] [DOC: 9318977] ℹ️  Patient not found in cache or API: Nancy Kurtz
[13:05:21] [DOC: 9318977] ℹ️  Patient not found, creating new patient via API...
[13:05:21] [DOC: 9318977] ℹ️  Creating patient via API: Nancy Kurtz
[13:05:22] [DOC: 9318977] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:05:22] ❌    ❌ Failed to create patient
[13:05:22] [DOC: 9318977] ℹ️  API push details saved for document 9318977
================================================================================
║                        Processing Document ID: 9318966                         ║
================================================================================
[13:05:22] ℹ️  Agency: Dartmouth HH
[13:05:22] ℹ️  Date: 05/30/2025
[13:05:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:05:24] [DOC: 9318966] ✅ Text extracted using pdfplumber (1209 chars)
[13:05:24] ✅    ✅ Text extracted using pdfplumber (1209 chars)
[13:05:24] 🔄 
🔄 Step 2: Extracting patient data...
[13:05:26] ℹ️  AI extracted raw sex value: 'F'
[13:05:26] ℹ️  AI extracted service line: 'RN'
[13:05:26] ℹ️  AI extracted payer source: 'Fallon Navicare'
[13:05:26] ℹ️  AI extracted diagnoses:
[13:05:26] ℹ️    - Diagnosis 1: ''
[13:05:26] ℹ️    - Diagnosis 2: ''
[13:05:26] ℹ️    - Diagnosis 3: ''
[13:05:26] ℹ️    - Diagnosis 4: ''
[13:05:26] ℹ️    - Diagnosis 5: ''
[13:05:26] ℹ️    - Diagnosis 6: ''
[13:05:26] ℹ️  Final extracted MRN: '519009'
[13:05:26] ℹ️  Final extracted Sex: 'FEMALE'
[13:05:26] ℹ️  Final extracted Service Line: 'RN'
[13:05:26] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[13:05:26] ✅ Patient data extraction completed successfully
[13:05:26] ✅    ✅ Patient data extracted successfully
[13:05:26] 📊 Patient Response
     └─ patientFName: Cynthia
     └─ patientLName: Reddy
     └─ dob: 10/04/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 519009
     └─ billingProvider: Daniel J Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 34 Summer Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '05/16/2025', 'startOfEpisode': '05/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:05:26] ✅    ✅ Patient identified: Cynthia Reddy
[13:05:26] ✅    ✅ Patient name validation passed
[13:05:26] 🔄 
🔄 Step 3: Processing patient dates...
[13:05:26] [DOC: 9318966] ℹ️  DOB normalized: 10/04/1946
[13:05:26] [DOC: 9318966] ℹ️  Episode startOfCare normalized: 05/16/2025
[13:05:26] [DOC: 9318966] ℹ️  Episode startOfEpisode normalized: 05/16/2025
[13:05:26] [DOC: 9318966] ℹ️  Episode endOfEpisode normalized: 07/14/2025
[13:05:26] [DOC: 9318966] ✅ Patient date processing completed successfully
[13:05:26] ✅    ✅ Date processing completed
[13:05:26] 📊 Processed Patient Data
     └─ patientFName: Cynthia
     └─ patientLName: Reddy
     └─ dob: 10/04/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 519009
     └─ billingProvider: Daniel J Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 34 Summer Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '05/16/2025', 'startOfEpisode': '05/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:05:26] 🔄 
🔄 Step 4: Extracting order data...
[13:05:29] ℹ️  Order extraction - MRN: ''
[13:05:29] ℹ️  Order extraction - Sex: 'FEMALE'
[13:05:29] ℹ️  Order extraction - Service Line: 'RN'
[13:05:29] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[13:05:29] ✅ Order data extraction completed successfully
[13:05:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:05:29] ℹ️  Using MRN from patient data: '519009'
[13:05:29] ℹ️  Service line consistent in both sources: 'RN'
[13:05:29] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[13:05:29] ✅ Patient name cross-validation successful
[13:05:29] ✅    ✅ Data merged successfully
[13:05:30] ✅    ✅ Order data extracted and validated
[13:05:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:05:44] [DOC: 9318966] ✅ Patient exists in API: Cynthia Reddy, ID: 7c152491-8a88-48e5-80a0-00d845b5f874
[13:05:44] ✅    ✅ Existing patient found with ID: 7c152491-8a88-48e5-80a0-00d845b5f874
[13:05:44] 🔄 
🔄 Step 6: Pushing order to API...
[13:05:44] [DOC: 9318966] ℹ️  Pushing order via API for patient ID: 7c152491-8a88-48e5-80a0-00d845b5f874
[13:05:45] [DOC: 9318966] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:05:45] ❌    ❌ Failed to push order
[13:05:45] 🔄 
🔄 Step 7: Writing to CSV...
[13:05:45] [DOC: 9318966] ℹ️  Calculated age: 78 from DOB: 10/04/1946
[13:05:45] [DOC: 9318966] ℹ️  Service Line extracted: 'RN'
[13:05:45] [DOC: 9318966] ℹ️  Payer Source extracted: 'Fallon Navicare'
[13:05:45] [DOC: 9318966] ℹ️  Diagnosis codes being written:
[13:05:45] [DOC: 9318966] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:05:45] [DOC: 9318966] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:05:45] [DOC: 9318966] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:05:45] [DOC: 9318966] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:05:45] [DOC: 9318966] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:05:45] [DOC: 9318966] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:05:45] [DOC: 9318966] ✅ Patient data written to CSV: Cynthia Reddy | Sex: FEMALE | Age: 78 | Service: RN | Payer: Fallon Navicare | MRN: 519009
[13:05:45] ✅    ✅ Document 9318966 processed and saved successfully
[13:05:45] 🔄 
🔄 Step 8: Saving API details...
[13:05:45] [DOC: 9318966] ℹ️  API push details saved for document 9318966
[13:05:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9318965                         ║
================================================================================
[13:05:45] ℹ️  Agency: Dartmouth HH
[13:05:45] ℹ️  Date: 05/30/2025
[13:05:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:05:47] [DOC: 9318965] ✅ Text extracted using pdfplumber (963 chars)
[13:05:47] ✅    ✅ Text extracted using pdfplumber (963 chars)
[13:05:47] 🔄 
🔄 Step 2: Extracting patient data...
[13:05:50] ℹ️  AI extracted raw sex value: 'F'
[13:05:50] ℹ️  AI extracted service line: 'Tubefeeding'
[13:05:50] ℹ️  AI extracted payer source: 'Medicare'
[13:05:50] ℹ️  AI extracted diagnoses:
[13:05:50] ℹ️    - Diagnosis 1: ''
[13:05:50] ℹ️    - Diagnosis 2: ''
[13:05:50] ℹ️    - Diagnosis 3: ''
[13:05:50] ℹ️    - Diagnosis 4: ''
[13:05:50] ℹ️    - Diagnosis 5: ''
[13:05:50] ℹ️    - Diagnosis 6: ''
[13:05:50] ℹ️  Final extracted MRN: '6523015'
[13:05:50] ℹ️  Final extracted Sex: 'FEMALE'
[13:05:50] ℹ️  Final extracted Service Line: 'Tubefeeding'
[13:05:50] ℹ️  Final extracted Payer Source: 'Medicare'
[13:05:50] ✅ Patient data extraction completed successfully
[13:05:50] ✅    ✅ Patient data extracted successfully
[13:05:50] 📊 Patient Response
     └─ patientFName: Dolores
     └─ patientLName: Hanson
     └─ dob: 11/26/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6523015
     └─ billingProvider: Daniel J Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Tubefeeding
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2025', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:05:50] ✅    ✅ Patient identified: Dolores Hanson
[13:05:50] ✅    ✅ Patient name validation passed
[13:05:50] 🔄 
🔄 Step 3: Processing patient dates...
[13:05:50] [DOC: 9318965] ℹ️  DOB normalized: 11/26/1931
[13:05:50] [DOC: 9318965] ℹ️  Episode startOfCare normalized: 05/21/2025
[13:05:50] [DOC: 9318965] ℹ️  Episode startOfEpisode normalized: 05/21/2025
[13:05:50] [DOC: 9318965] ℹ️  Episode endOfEpisode normalized: 07/19/2025
[13:05:50] [DOC: 9318965] ✅ Patient date processing completed successfully
[13:05:50] ✅    ✅ Date processing completed
[13:05:50] 📊 Processed Patient Data
     └─ patientFName: Dolores
     └─ patientLName: Hanson
     └─ dob: 11/26/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6523015
     └─ billingProvider: Daniel J Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Tubefeeding
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2025', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:05:50] 🔄 
🔄 Step 4: Extracting order data...
[13:05:52] ℹ️  Order extraction - MRN: ''
[13:05:52] ℹ️  Order extraction - Sex: 'FEMALE'
[13:05:52] ℹ️  Order extraction - Service Line: 'Tubefeeding'
[13:05:52] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:05:52] ✅ Order data extraction completed successfully
[13:05:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:05:52] ℹ️  Using MRN from patient data: '6523015'
[13:05:52] ℹ️  Service line consistent in both sources: 'Tubefeeding'
[13:05:52] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:05:52] ✅ Patient name cross-validation successful
[13:05:52] ✅    ✅ Data merged successfully
[13:05:54] ✅    ✅ Order data extracted and validated
[13:05:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:05:54] [DOC: 9318965] ✅ Patient found in local cache: Dolores Hanson, ID: dd622d4d-efdc-446e-8265-00fae76c09a4
[13:05:54] ✅    ✅ Existing patient found with ID: dd622d4d-efdc-446e-8265-00fae76c09a4
[13:05:54] 🔄 
🔄 Step 6: Pushing order to API...
[13:05:54] [DOC: 9318965] ℹ️  Pushing order via API for patient ID: dd622d4d-efdc-446e-8265-00fae76c09a4
[13:05:55] [DOC: 9318965] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:05:55] ❌    ❌ Failed to push order
[13:05:55] 🔄 
🔄 Step 7: Writing to CSV...
[13:05:55] [DOC: 9318965] ℹ️  Calculated age: 93 from DOB: 11/26/1931
[13:05:55] [DOC: 9318965] ℹ️  Service Line extracted: 'Tubefeeding'
[13:05:55] [DOC: 9318965] ℹ️  Payer Source extracted: 'Medicare'
[13:05:55] [DOC: 9318965] ℹ️  Diagnosis codes being written:
[13:05:55] [DOC: 9318965] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:05:55] [DOC: 9318965] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:05:55] [DOC: 9318965] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:05:55] [DOC: 9318965] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:05:55] [DOC: 9318965] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:05:55] [DOC: 9318965] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:05:55] [DOC: 9318965] ✅ Patient data written to CSV: Dolores Hanson | Sex: FEMALE | Age: 93 | Service: Tubefeeding | Payer: Medicare | MRN: 6523015
[13:05:55] ✅    ✅ Document 9318965 processed and saved successfully
[13:05:55] 🔄 
🔄 Step 8: Saving API details...
[13:05:55] [DOC: 9318965] ℹ️  API push details saved for document 9318965
[13:05:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9318963                         ║
================================================================================
[13:05:55] ℹ️  Agency: Dartmouth HH
[13:05:55] ℹ️  Date: 05/30/2025
[13:05:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:05:57] [DOC: 9318963] ✅ Text extracted using pdfplumber (1016 chars)
[13:05:57] ✅    ✅ Text extracted using pdfplumber (1016 chars)
[13:05:57] 🔄 
🔄 Step 2: Extracting patient data...
[13:06:00] ℹ️  AI extracted raw sex value: 'F'
[13:06:00] ℹ️  AI extracted service line: 'RN'
[13:06:00] ℹ️  AI extracted payer source: 'Fallon Health'
[13:06:00] ℹ️  AI extracted diagnoses:
[13:06:00] ℹ️    - Diagnosis 1: ''
[13:06:00] ℹ️    - Diagnosis 2: ''
[13:06:00] ℹ️    - Diagnosis 3: ''
[13:06:00] ℹ️    - Diagnosis 4: ''
[13:06:00] ℹ️    - Diagnosis 5: ''
[13:06:00] ℹ️    - Diagnosis 6: ''
[13:06:00] ℹ️  Final extracted MRN: '4034011'
[13:06:00] ℹ️  Final extracted Sex: 'FEMALE'
[13:06:00] ℹ️  Final extracted Service Line: 'RN'
[13:06:00] ℹ️  Final extracted Payer Source: 'Fallon Health'
[13:06:00] ✅ Patient data extraction completed successfully
[13:06:00] ✅    ✅ Patient data extracted successfully
[13:06:00] 📊 Patient Response
     └─ patientFName: Joan E
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Daniel J Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:06:00] ✅    ✅ Patient identified: Joan E Swift
[13:06:00] ✅    ✅ Patient name validation passed
[13:06:00] 🔄 
🔄 Step 3: Processing patient dates...
[13:06:00] [DOC: 9318963] ℹ️  DOB normalized: 05/05/1943
[13:06:00] [DOC: 9318963] ℹ️  Episode startOfCare normalized: 01/08/2025
[13:06:00] [DOC: 9318963] ℹ️  Episode startOfEpisode normalized: 05/08/2025
[13:06:00] [DOC: 9318963] ℹ️  Episode endOfEpisode normalized: 07/06/2025
[13:06:00] [DOC: 9318963] ✅ Patient date processing completed successfully
[13:06:00] ✅    ✅ Date processing completed
[13:06:00] 📊 Processed Patient Data
     └─ patientFName: Joan E
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Daniel J Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:06:00] 🔄 
🔄 Step 4: Extracting order data...
[13:06:02] ℹ️  Order extraction - MRN: ''
[13:06:02] ℹ️  Order extraction - Sex: 'FEMALE'
[13:06:02] ℹ️  Order extraction - Service Line: 'RN'
[13:06:02] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[13:06:02] ✅ Order data extraction completed successfully
[13:06:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:06:02] ℹ️  Using MRN from patient data: '4034011'
[13:06:02] ℹ️  Service line consistent in both sources: 'RN'
[13:06:02] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[13:06:02] ✅ Patient name cross-validation successful
[13:06:02] ✅    ✅ Data merged successfully
[13:06:04] ✅    ✅ Order data extracted and validated
[13:06:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:06:14] [DOC: 9318963] ℹ️  Patient not found in cache or API: Joan E Swift
[13:06:14] [DOC: 9318963] ℹ️  Patient not found, creating new patient via API...
[13:06:14] [DOC: 9318963] ℹ️  Creating patient via API: Joan E Swift
[13:06:15] [DOC: 9318963] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:06:15] ❌    ❌ Failed to create patient
[13:06:15] [DOC: 9318963] ℹ️  API push details saved for document 9318963
================================================================================
║                        Processing Document ID: 9318959                         ║
================================================================================
[13:06:15] ℹ️  Agency: Dartmouth HH
[13:06:15] ℹ️  Date: 05/30/2025
[13:06:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:06:18] [DOC: 9318959] ✅ Text extracted using pdfplumber (29981 chars)
[13:06:18] ✅    ✅ Text extracted using pdfplumber (29969 chars)
[13:06:18] 🔄 
🔄 Step 2: Extracting patient data...
[13:06:22] ℹ️  AI extracted raw sex value: 'M'
[13:06:22] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[13:06:22] ℹ️  AI extracted payer source: ''
[13:06:22] ℹ️  AI extracted diagnoses:
[13:06:22] ℹ️    - Diagnosis 1: 'A41.51'
[13:06:22] ℹ️    - Diagnosis 2: 'N39.0'
[13:06:22] ℹ️    - Diagnosis 3: 'J09.X9'
[13:06:22] ℹ️    - Diagnosis 4: 'I11.0'
[13:06:22] ℹ️    - Diagnosis 5: 'I50.32'
[13:06:22] ℹ️    - Diagnosis 6: 'I69.351'
[13:06:22] ℹ️  Final extracted MRN: '1427001'
[13:06:22] ℹ️  Final extracted Sex: 'MALE'
[13:06:22] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[13:06:22] ℹ️  Final extracted Payer Source: ''
[13:06:22] ✅ Patient data extraction completed successfully
[13:06:22] ✅    ✅ Patient data extracted successfully
[13:06:22] 📊 Patient Response
     └─ patientFName: Kenneth
     └─ patientLName: Hartnett
     └─ dob: 06/17/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 1427001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'J09.X9', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'I69.351'}]
[13:06:22] ✅    ✅ Patient identified: Kenneth Hartnett
[13:06:22] ✅    ✅ Patient name validation passed
[13:06:22] 🔄 
🔄 Step 3: Processing patient dates...
[13:06:22] [DOC: 9318959] ℹ️  DOB normalized: 06/17/1934
[13:06:22] [DOC: 9318959] ℹ️  Episode startOfEpisode normalized: 05/08/2025
[13:06:22] [DOC: 9318959] ℹ️  Episode endOfEpisode normalized: 07/06/2025
[13:06:22] [DOC: 9318959] ✅ Patient date processing completed successfully
[13:06:22] ✅    ✅ Date processing completed
[13:06:22] 📊 Processed Patient Data
     └─ patientFName: Kenneth
     └─ patientLName: Hartnett
     └─ dob: 06/17/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 1427001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'J09.X9', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'I69.351'}]
[13:06:22] 🔄 
🔄 Step 4: Extracting order data...
[13:06:25] ℹ️  Order extraction - MRN: '1427001'
[13:06:25] ℹ️  Order extraction - Sex: 'MALE'
[13:06:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[13:06:25] ℹ️  Order extraction - Payer Source: ''
[13:06:25] ✅ Order data extraction completed successfully
[13:06:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:06:25] ℹ️  Using MRN from patient data: '1427001' over '1427001'
[13:06:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[13:06:25] ✅ Patient name cross-validation successful
[13:06:25] ✅    ✅ Data merged successfully
[13:06:26] ✅    ✅ Order data extracted and validated
[13:06:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:06:32] [DOC: 9318959] ℹ️  Patient not found in cache or API: Kenneth Hartnett
[13:06:32] [DOC: 9318959] ℹ️  Patient not found, creating new patient via API...
[13:06:32] [DOC: 9318959] ℹ️  Creating patient via API: Kenneth Hartnett
[13:06:33] [DOC: 9318959] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:06:33] ❌    ❌ Failed to create patient
[13:06:33] [DOC: 9318959] ℹ️  API push details saved for document 9318959
================================================================================
║                        Processing Document ID: 9318958                         ║
================================================================================
[13:06:33] ℹ️  Agency: Dartmouth HH
[13:06:33] ℹ️  Date: 05/30/2025
[13:06:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:06:35] [DOC: 9318958] ✅ Text extracted using pdfplumber (21889 chars)
[13:06:35] ✅    ✅ Text extracted using pdfplumber (21877 chars)
[13:06:35] 🔄 
🔄 Step 2: Extracting patient data...
[13:06:39] ℹ️  AI extracted raw sex value: 'M'
[13:06:39] ℹ️  AI extracted service line: 'PT, OT'
[13:06:39] ℹ️  AI extracted payer source: ''
[13:06:39] ℹ️  AI extracted diagnoses:
[13:06:39] ℹ️    - Diagnosis 1: 'I48.0'
[13:06:39] ℹ️    - Diagnosis 2: 'R29.6'
[13:06:39] ℹ️    - Diagnosis 3: 'J96.01'
[13:06:39] ℹ️    - Diagnosis 4: 'M48.56XD'
[13:06:39] ℹ️    - Diagnosis 5: 'M48.54XD'
[13:06:39] ℹ️    - Diagnosis 6: 'I11.0'
[13:06:39] ℹ️  Final extracted MRN: '2491015'
[13:06:39] ℹ️  Final extracted Sex: 'MALE'
[13:06:39] ℹ️  Final extracted Service Line: 'PT, OT'
[13:06:39] ℹ️  Final extracted Payer Source: ''
[13:06:39] ✅ Patient data extraction completed successfully
[13:06:39] ✅    ✅ Patient data extracted successfully
[13:06:39] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: Medeiros
     └─ dob: 07/29/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 2491015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/06/2025', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'I48.0', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'J96.01', 'fourthDiagnosis': 'M48.56XD', 'fifthDiagnosis': 'M48.54XD', 'sixthDiagnosis': 'I11.0'}]
[13:06:39] ✅    ✅ Patient identified: Richard Medeiros
[13:06:39] ✅    ✅ Patient name validation passed
[13:06:39] 🔄 
🔄 Step 3: Processing patient dates...
[13:06:39] [DOC: 9318958] ℹ️  DOB normalized: 07/29/1931
[13:06:39] [DOC: 9318958] ℹ️  Episode startOfCare normalized: 05/06/2025
[13:06:39] [DOC: 9318958] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[13:06:39] [DOC: 9318958] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[13:06:39] [DOC: 9318958] ✅ Patient date processing completed successfully
[13:06:39] ✅    ✅ Date processing completed
[13:06:39] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: Medeiros
     └─ dob: 07/29/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 2491015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/06/2025', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'I48.0', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'J96.01', 'fourthDiagnosis': 'M48.56XD', 'fifthDiagnosis': 'M48.54XD', 'sixthDiagnosis': 'I11.0'}]
[13:06:39] 🔄 
🔄 Step 4: Extracting order data...
[13:06:41] ℹ️  Order extraction - MRN: '2491015'
[13:06:41] ℹ️  Order extraction - Sex: 'MALE'
[13:06:41] ℹ️  Order extraction - Service Line: 'PT, OT'
[13:06:41] ℹ️  Order extraction - Payer Source: ''
[13:06:41] ✅ Order data extraction completed successfully
[13:06:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:06:41] ℹ️  Using MRN from patient data: '2491015' over '2491015'
[13:06:41] ℹ️  Service line consistent in both sources: 'PT, OT'
[13:06:41] ✅ Patient name cross-validation successful
[13:06:41] ✅    ✅ Data merged successfully
[13:06:43] ✅    ✅ Order data extracted and validated
[13:06:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:06:48] [DOC: 9318958] ℹ️  Patient not found in cache or API: Richard Medeiros
[13:06:48] [DOC: 9318958] ℹ️  Patient not found, creating new patient via API...
[13:06:48] [DOC: 9318958] ℹ️  Creating patient via API: Richard Medeiros
[13:06:50] [DOC: 9318958] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:06:50] ❌    ❌ Failed to create patient
[13:06:50] [DOC: 9318958] ℹ️  API push details saved for document 9318958
================================================================================
║                        Processing Document ID: 9318952                         ║
================================================================================
[13:06:50] ℹ️  Agency: Dartmouth HH
[13:06:50] ℹ️  Date: 05/30/2025
[13:06:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:06:52] [DOC: 9318952] ✅ Text extracted using pdfplumber (6504 chars)
[13:06:52] ✅    ✅ Text extracted using pdfplumber (6504 chars)
[13:06:52] 🔄 
🔄 Step 2: Extracting patient data...
[13:06:56] ℹ️  AI extracted raw sex value: 'M'
[13:06:56] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:06:56] ℹ️  AI extracted payer source: 'Medicare'
[13:06:56] ℹ️  AI extracted diagnoses:
[13:06:56] ℹ️    - Diagnosis 1: 'I12.9'
[13:06:56] ℹ️    - Diagnosis 2: 'E11.22'
[13:06:56] ℹ️    - Diagnosis 3: 'N18.32'
[13:06:56] ℹ️    - Diagnosis 4: 'R31.0'
[13:06:56] ℹ️    - Diagnosis 5: 'Z43.6'
[13:06:56] ℹ️    - Diagnosis 6: 'N13.1'
[13:06:56] ℹ️  Final extracted MRN: '6570009'
[13:06:56] ℹ️  Final extracted Sex: 'MALE'
[13:06:56] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:06:56] ℹ️  Final extracted Payer Source: 'Medicare'
[13:06:56] ✅ Patient data extraction completed successfully
[13:06:56] ✅    ✅ Patient data extracted successfully
[13:06:56] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Wood
     └─ dob: 01/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 6570009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/29/2024', 'startOfEpisode': '10/25/2024', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'E11.22', 'thirdDiagnosis': 'N18.32', 'fourthDiagnosis': 'R31.0', 'fifthDiagnosis': 'Z43.6', 'sixthDiagnosis': 'N13.1'}, {'startOfCare': '10/29/2024', 'startOfEpisode': '05/27/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': 'N17.9', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '10/29/2024', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': 'R31.0', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:06:56] ✅    ✅ Patient identified: James Wood
[13:06:56] ✅    ✅ Patient name validation passed
[13:06:56] 🔄 
🔄 Step 3: Processing patient dates...
[13:06:56] [DOC: 9318952] ℹ️  DOB normalized: 01/29/1944
[13:06:56] [DOC: 9318952] ℹ️  Episode startOfCare normalized: 10/29/2024
[13:06:56] [DOC: 9318952] ℹ️  Episode startOfEpisode normalized: 10/25/2024
[13:06:56] [DOC: 9318952] ℹ️  Episode endOfEpisode normalized: 06/25/2025
[13:06:56] [DOC: 9318952] ✅ Patient date processing completed successfully
[13:06:56] ✅    ✅ Date processing completed
[13:06:56] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Wood
     └─ dob: 01/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 6570009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/29/2024', 'startOfEpisode': '10/25/2024', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'E11.22', 'thirdDiagnosis': 'N18.32', 'fourthDiagnosis': 'R31.0', 'fifthDiagnosis': 'Z43.6', 'sixthDiagnosis': 'N13.1'}, {'startOfCare': '10/29/2024', 'startOfEpisode': '05/27/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': 'N17.9', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '10/29/2024', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '06/25/2025', 'firstDiagnosis': 'R31.0', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:06:56] 🔄 
🔄 Step 4: Extracting order data...
[13:06:59] ℹ️  Order extraction - MRN: '6570009'
[13:06:59] ℹ️  Order extraction - Sex: 'MALE'
[13:06:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:06:59] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:06:59] ✅ Order data extraction completed successfully
[13:06:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:06:59] ℹ️  Using MRN from patient data: '6570009' over '6570009'
[13:06:59] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:06:59] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:06:59] ✅ Patient name cross-validation successful
[13:06:59] ✅    ✅ Data merged successfully
[13:07:00] ✅    ✅ Order data extracted and validated
[13:07:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:07:06] [DOC: 9318952] ✅ Patient exists in API: James Wood, ID: b532915a-79b5-4b9d-9458-683e03933774
[13:07:06] ✅    ✅ Existing patient found with ID: b532915a-79b5-4b9d-9458-683e03933774
[13:07:06] 🔄 
🔄 Step 6: Pushing order to API...
[13:07:06] [DOC: 9318952] ℹ️  Pushing order via API for patient ID: b532915a-79b5-4b9d-9458-683e03933774
[13:07:07] [DOC: 9318952] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:07:07] ❌    ❌ Failed to push order
[13:07:07] 🔄 
🔄 Step 7: Writing to CSV...
[13:07:07] [DOC: 9318952] ℹ️  Calculated age: 81 from DOB: 01/29/1944
[13:07:07] [DOC: 9318952] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:07:07] [DOC: 9318952] ℹ️  Payer Source extracted: 'Medicare'
[13:07:07] [DOC: 9318952] ℹ️  Diagnosis codes being written:
[13:07:07] [DOC: 9318952] ℹ️    - Latest_Episode_Firstdiagnosis: 'I12.9'
[13:07:07] [DOC: 9318952] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.22'
[13:07:07] [DOC: 9318952] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.32'
[13:07:07] [DOC: 9318952] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R31.0'
[13:07:07] [DOC: 9318952] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z43.6'
[13:07:07] [DOC: 9318952] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N13.1'
[13:07:07] [DOC: 9318952] ✅ Patient data written to CSV: James Wood | Sex: MALE | Age: 81 | Service: Skilled Nursing | Payer: Medicare | MRN: 6570009
[13:07:07] ✅    ✅ Document 9318952 processed and saved successfully
[13:07:07] 🔄 
🔄 Step 8: Saving API details...
[13:07:07] [DOC: 9318952] ℹ️  API push details saved for document 9318952
[13:07:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9318951                         ║
================================================================================
[13:07:07] ℹ️  Agency: Dartmouth HH
[13:07:07] ℹ️  Date: 05/30/2025
[13:07:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:07:09] [DOC: 9318951] ✅ Text extracted using pdfplumber (3631 chars)
[13:07:09] ✅    ✅ Text extracted using pdfplumber (3631 chars)
[13:07:09] 🔄 
🔄 Step 2: Extracting patient data...
[13:07:12] ℹ️  AI extracted raw sex value: 'F'
[13:07:12] ℹ️  AI extracted service line: 'Skilled Nursing, OT'
[13:07:12] ℹ️  AI extracted payer source: 'Fallon Navicare'
[13:07:12] ℹ️  AI extracted diagnoses:
[13:07:12] ℹ️    - Diagnosis 1: ''
[13:07:12] ℹ️    - Diagnosis 2: ''
[13:07:12] ℹ️    - Diagnosis 3: ''
[13:07:12] ℹ️    - Diagnosis 4: ''
[13:07:12] ℹ️    - Diagnosis 5: ''
[13:07:12] ℹ️    - Diagnosis 6: ''
[13:07:12] ℹ️  Final extracted MRN: '7544009'
[13:07:12] ℹ️  Final extracted Sex: 'FEMALE'
[13:07:12] ℹ️  Final extracted Service Line: 'Skilled Nursing, OT'
[13:07:12] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[13:07:12] ✅ Patient data extraction completed successfully
[13:07:12] ✅    ✅ Patient data extracted successfully
[13:07:12] 📊 Patient Response
     └─ patientFName: Sandra
     └─ patientLName: Knickerbocker
     └─ dob: 07/22/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7544009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, OT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:07:12] ✅    ✅ Patient identified: Sandra Knickerbocker
[13:07:12] ✅    ✅ Patient name validation passed
[13:07:12] 🔄 
🔄 Step 3: Processing patient dates...
[13:07:12] [DOC: 9318951] ℹ️  DOB normalized: 07/22/1948
[13:07:12] [DOC: 9318951] ℹ️  Episode startOfCare normalized: 03/26/2025
[13:07:12] [DOC: 9318951] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[13:07:12] [DOC: 9318951] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[13:07:12] [DOC: 9318951] ✅ Patient date processing completed successfully
[13:07:12] ✅    ✅ Date processing completed
[13:07:12] 📊 Processed Patient Data
     └─ patientFName: Sandra
     └─ patientLName: Knickerbocker
     └─ dob: 07/22/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7544009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, OT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:07:12] 🔄 
🔄 Step 4: Extracting order data...
[13:07:15] ℹ️  Order extraction - MRN: '7544009'
[13:07:15] ℹ️  Order extraction - Sex: 'FEMALE'
[13:07:15] ℹ️  Order extraction - Service Line: 'OT'
[13:07:15] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[13:07:15] ✅ Order data extraction completed successfully
[13:07:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:07:15] ℹ️  Using MRN from patient data: '7544009' over '7544009'
[13:07:15] ℹ️  Combined service lines: Patient='Skilled Nursing, OT' + Order='OT' = 'OT, Skilled Nursing'
[13:07:15] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[13:07:15] ✅ Patient name cross-validation successful
[13:07:15] ✅    ✅ Data merged successfully
[13:07:16] ✅    ✅ Order data extracted and validated
[13:07:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:07:21] [DOC: 9318951] ✅ Patient exists in API: Sandra Knickerbocker, ID: 72b6d189-6994-4d0a-9e48-56e329440311
[13:07:21] ✅    ✅ Existing patient found with ID: 72b6d189-6994-4d0a-9e48-56e329440311
[13:07:21] 🔄 
🔄 Step 6: Pushing order to API...
[13:07:21] [DOC: 9318951] ℹ️  Pushing order via API for patient ID: 72b6d189-6994-4d0a-9e48-56e329440311
[13:07:22] [DOC: 9318951] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:07:22] ❌    ❌ Failed to push order
[13:07:22] 🔄 
🔄 Step 7: Writing to CSV...
[13:07:22] [DOC: 9318951] ℹ️  Calculated age: 76 from DOB: 07/22/1948
[13:07:22] [DOC: 9318951] ℹ️  Service Line extracted: 'OT, Skilled Nursing'
[13:07:22] [DOC: 9318951] ℹ️  Payer Source extracted: 'Fallon Navicare'
[13:07:22] [DOC: 9318951] ℹ️  Diagnosis codes being written:
[13:07:22] [DOC: 9318951] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:07:22] [DOC: 9318951] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:07:22] [DOC: 9318951] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:07:22] [DOC: 9318951] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:07:22] [DOC: 9318951] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:07:22] [DOC: 9318951] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:07:22] [DOC: 9318951] ✅ Patient data written to CSV: Sandra Knickerbocker | Sex: FEMALE | Age: 76 | Service: OT, Skilled Nursing | Payer: Fallon Navicare | MRN: 7544009
[13:07:22] ✅    ✅ Document 9318951 processed and saved successfully
[13:07:22] 🔄 
🔄 Step 8: Saving API details...
[13:07:22] [DOC: 9318951] ℹ️  API push details saved for document 9318951
[13:07:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9318950                         ║
================================================================================
[13:07:22] ℹ️  Agency: Dartmouth HH
[13:07:22] ℹ️  Date: 05/30/2025
[13:07:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:07:25] [DOC: 9318950] ✅ Text extracted using pdfplumber (1242 chars)
[13:07:25] ✅    ✅ Text extracted using pdfplumber (1242 chars)
[13:07:25] 🔄 
🔄 Step 2: Extracting patient data...
[13:07:28] ℹ️  AI extracted raw sex value: 'F'
[13:07:28] ℹ️  AI extracted service line: 'RN'
[13:07:28] ℹ️  AI extracted payer source: 'Medicare'
[13:07:28] ℹ️  AI extracted diagnoses:
[13:07:28] ℹ️    - Diagnosis 1: 'None'
[13:07:28] ℹ️    - Diagnosis 2: 'None'
[13:07:28] ℹ️    - Diagnosis 3: 'None'
[13:07:28] ℹ️    - Diagnosis 4: 'None'
[13:07:28] ℹ️    - Diagnosis 5: 'None'
[13:07:28] ℹ️    - Diagnosis 6: 'None'
[13:07:28] ℹ️  Final extracted MRN: '1690001'
[13:07:28] ℹ️  Final extracted Sex: 'FEMALE'
[13:07:28] ℹ️  Final extracted Service Line: 'RN'
[13:07:28] ℹ️  Final extracted Payer Source: 'Medicare'
[13:07:28] ✅ Patient data extraction completed successfully
[13:07:28] ✅    ✅ Patient data extracted successfully
[13:07:28] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Rocha
     └─ dob: 04/26/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1690001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/03/2025', 'startOfEpisode': '01/03/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:07:28] ✅    ✅ Patient identified: Nancy Rocha
[13:07:28] ✅    ✅ Patient name validation passed
[13:07:28] 🔄 
🔄 Step 3: Processing patient dates...
[13:07:28] [DOC: 9318950] ℹ️  DOB normalized: 04/26/1933
[13:07:28] [DOC: 9318950] ℹ️  Episode startOfCare normalized: 01/03/2025
[13:07:28] [DOC: 9318950] ℹ️  Episode startOfEpisode normalized: 01/03/2025
[13:07:28] [DOC: 9318950] ℹ️  Episode endOfEpisode normalized: 07/01/2025
[13:07:28] [DOC: 9318950] ✅ Patient date processing completed successfully
[13:07:28] ✅    ✅ Date processing completed
[13:07:28] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Rocha
     └─ dob: 04/26/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1690001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/03/2025', 'startOfEpisode': '01/03/2025', 'endOfEpisode': '07/01/2025'}]
[13:07:28] 🔄 
🔄 Step 4: Extracting order data...
[13:07:30] ℹ️  Order extraction - MRN: ''
[13:07:30] ℹ️  Order extraction - Sex: 'FEMALE'
[13:07:30] ℹ️  Order extraction - Service Line: 'RN'
[13:07:30] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:07:30] ✅ Order data extraction completed successfully
[13:07:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:07:30] ℹ️  Using MRN from patient data: '1690001'
[13:07:30] ℹ️  Service line consistent in both sources: 'RN'
[13:07:30] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:07:30] ✅ Patient name cross-validation successful
[13:07:30] ✅    ✅ Data merged successfully
[13:07:31] ✅    ✅ Order data extracted and validated
[13:07:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:07:53] [DOC: 9318950] ✅ Patient exists in API: Nancy Rocha, ID: 34212fde-a89b-47f5-a81f-07e123e156e2
[13:07:53] ✅    ✅ Existing patient found with ID: 34212fde-a89b-47f5-a81f-07e123e156e2
[13:07:53] 🔄 
🔄 Step 6: Pushing order to API...
[13:07:53] [DOC: 9318950] ℹ️  Pushing order via API for patient ID: 34212fde-a89b-47f5-a81f-07e123e156e2
[13:07:55] [DOC: 9318950] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14263"}
[13:07:55] ❌    ❌ Failed to push order
[13:07:55] 🔄 
🔄 Step 7: Writing to CSV...
[13:07:55] [DOC: 9318950] ℹ️  Calculated age: 92 from DOB: 04/26/1933
[13:07:55] [DOC: 9318950] ℹ️  Service Line extracted: 'RN'
[13:07:55] [DOC: 9318950] ℹ️  Payer Source extracted: 'Medicare'
[13:07:55] [DOC: 9318950] ℹ️  Diagnosis codes being written:
[13:07:55] [DOC: 9318950] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:07:55] [DOC: 9318950] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:07:55] [DOC: 9318950] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:07:55] [DOC: 9318950] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:07:55] [DOC: 9318950] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:07:55] [DOC: 9318950] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:07:55] [DOC: 9318950] ✅ Patient data written to CSV: Nancy Rocha | Sex: FEMALE | Age: 92 | Service: RN | Payer: Medicare | MRN: 1690001
[13:07:55] ✅    ✅ Document 9318950 processed and saved successfully
[13:07:55] 🔄 
🔄 Step 8: Saving API details...
[13:07:55] [DOC: 9318950] ℹ️  API push details saved for document 9318950
[13:07:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9318949                         ║
================================================================================
[13:07:55] ℹ️  Agency: Dartmouth HH
[13:07:55] ℹ️  Date: 05/30/2025
[13:07:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:07:57] [DOC: 9318949] ✅ Text extracted using pdfplumber (1543 chars)
[13:07:57] ✅    ✅ Text extracted using pdfplumber (1543 chars)
[13:07:57] 🔄 
🔄 Step 2: Extracting patient data...
[13:07:59] ℹ️  AI extracted raw sex value: 'M'
[13:07:59] ℹ️  AI extracted service line: 'RN'
[13:07:59] ℹ️  AI extracted payer source: 'Fallon Health'
[13:07:59] ℹ️  AI extracted diagnoses:
[13:07:59] ℹ️    - Diagnosis 1: ''
[13:07:59] ℹ️    - Diagnosis 2: ''
[13:07:59] ℹ️    - Diagnosis 3: ''
[13:07:59] ℹ️    - Diagnosis 4: ''
[13:07:59] ℹ️    - Diagnosis 5: ''
[13:07:59] ℹ️    - Diagnosis 6: ''
[13:07:59] ℹ️  Final extracted MRN: '6476015'
[13:07:59] ℹ️  Final extracted Sex: 'MALE'
[13:07:59] ℹ️  Final extracted Service Line: 'RN'
[13:07:59] ℹ️  Final extracted Payer Source: 'Fallon Health'
[13:07:59] ✅ Patient data extraction completed successfully
[13:07:59] ✅    ✅ Patient data extracted successfully
[13:07:59] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Mathieu
     └─ dob: 04/14/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 6476015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '05/03/2025', 'startOfEpisode': '05/03/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:07:59] ✅    ✅ Patient identified: Joseph Mathieu
[13:07:59] ✅    ✅ Patient name validation passed
[13:07:59] 🔄 
🔄 Step 3: Processing patient dates...
[13:07:59] [DOC: 9318949] ℹ️  DOB normalized: 04/14/1947
[13:07:59] [DOC: 9318949] ℹ️  Episode startOfCare normalized: 05/03/2025
[13:07:59] [DOC: 9318949] ℹ️  Episode startOfEpisode normalized: 05/03/2025
[13:07:59] [DOC: 9318949] ℹ️  Episode endOfEpisode normalized: 07/01/2025
[13:07:59] [DOC: 9318949] ✅ Patient date processing completed successfully
[13:07:59] ✅    ✅ Date processing completed
[13:07:59] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Mathieu
     └─ dob: 04/14/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 6476015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '05/03/2025', 'startOfEpisode': '05/03/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:07:59] 🔄 
🔄 Step 4: Extracting order data...
[13:08:02] ℹ️  Order extraction - MRN: '6476015'
[13:08:02] ℹ️  Order extraction - Sex: 'MALE'
[13:08:02] ℹ️  Order extraction - Service Line: ''
[13:08:02] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[13:08:02] ✅ Order data extraction completed successfully
[13:08:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:08:02] ℹ️  Using MRN from patient data: '6476015' over '6476015'
[13:08:02] ℹ️  Using service line from patient data: 'RN'
[13:08:02] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[13:08:02] ✅ Patient name cross-validation successful
[13:08:02] ✅    ✅ Data merged successfully
[13:08:03] ✅    ✅ Order data extracted and validated
[13:08:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:08:09] [DOC: 9318949] ℹ️  Patient not found in cache or API: Joseph Mathieu
[13:08:09] [DOC: 9318949] ℹ️  Patient not found, creating new patient via API...
[13:08:09] [DOC: 9318949] ℹ️  Creating patient via API: Joseph Mathieu
[13:08:10] [DOC: 9318949] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:08:10] ❌    ❌ Failed to create patient
[13:08:10] [DOC: 9318949] ℹ️  API push details saved for document 9318949
================================================================================
║                        Processing Document ID: 9318948                         ║
================================================================================
[13:08:10] ℹ️  Agency: Dartmouth HH
[13:08:10] ℹ️  Date: 05/30/2025
[13:08:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:08:12] [DOC: 9318948] ✅ Text extracted using pdfplumber (5232 chars)
[13:08:12] ✅    ✅ Text extracted using pdfplumber (5232 chars)
[13:08:12] 🔄 
🔄 Step 2: Extracting patient data...
[13:08:15] ℹ️  AI extracted raw sex value: 'M'
[13:08:15] ℹ️  AI extracted service line: 'OT'
[13:08:15] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[13:08:15] ℹ️  AI extracted diagnoses:
[13:08:15] ℹ️    - Diagnosis 1: ''
[13:08:15] ℹ️    - Diagnosis 2: ''
[13:08:15] ℹ️    - Diagnosis 3: ''
[13:08:15] ℹ️    - Diagnosis 4: ''
[13:08:15] ℹ️    - Diagnosis 5: ''
[13:08:15] ℹ️    - Diagnosis 6: ''
[13:08:15] ℹ️  Final extracted MRN: '4031011'
[13:08:15] ℹ️  Final extracted Sex: 'MALE'
[13:08:15] ℹ️  Final extracted Service Line: 'OT'
[13:08:15] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[13:08:15] ✅ Patient data extraction completed successfully
[13:08:15] ✅    ✅ Patient data extracted successfully
[13:08:15] 📊 Patient Response
     └─ patientFName: Gilberto
     └─ patientLName: Tavares
     └─ dob: 03/04/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 4031011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '04/18/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:08:15] ✅    ✅ Patient identified: Gilberto Tavares
[13:08:15] ✅    ✅ Patient name validation passed
[13:08:15] 🔄 
🔄 Step 3: Processing patient dates...
[13:08:15] [DOC: 9318948] ℹ️  DOB normalized: 03/04/1941
[13:08:15] [DOC: 9318948] ℹ️  Episode startOfCare normalized: 04/18/2025
[13:08:15] [DOC: 9318948] ℹ️  Episode startOfEpisode normalized: 04/18/2025
[13:08:15] [DOC: 9318948] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[13:08:15] [DOC: 9318948] ✅ Patient date processing completed successfully
[13:08:15] ✅    ✅ Date processing completed
[13:08:15] 📊 Processed Patient Data
     └─ patientFName: Gilberto
     └─ patientLName: Tavares
     └─ dob: 03/04/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 4031011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '04/18/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:08:15] 🔄 
🔄 Step 4: Extracting order data...
[13:08:18] ℹ️  Order extraction - MRN: '4031011'
[13:08:18] ℹ️  Order extraction - Sex: 'MALE'
[13:08:18] ℹ️  Order extraction - Service Line: 'OT'
[13:08:18] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[13:08:18] ✅ Order data extraction completed successfully
[13:08:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:08:18] ℹ️  Using MRN from patient data: '4031011' over '4031011'
[13:08:18] ℹ️  Service line consistent in both sources: 'OT'
[13:08:18] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[13:08:18] ✅ Patient name cross-validation successful
[13:08:18] ✅    ✅ Data merged successfully
[13:08:19] ✅    ✅ Order data extracted and validated
[13:08:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:08:26] [DOC: 9318948] ℹ️  Patient not found in cache or API: Gilberto Tavares
[13:08:26] [DOC: 9318948] ℹ️  Patient not found, creating new patient via API...
[13:08:26] [DOC: 9318948] ℹ️  Creating patient via API: Gilberto Tavares
[13:08:27] [DOC: 9318948] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:08:27] ❌    ❌ Failed to create patient
[13:08:27] [DOC: 9318948] ℹ️  API push details saved for document 9318948
================================================================================
║                        Processing Document ID: 9318944                         ║
================================================================================
[13:08:27] ℹ️  Agency: Dartmouth HH
[13:08:27] ℹ️  Date: 05/30/2025
[13:08:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:08:29] [DOC: 9318944] ✅ Text extracted using pdfplumber (1249 chars)
[13:08:29] ✅    ✅ Text extracted using pdfplumber (1249 chars)
[13:08:29] 🔄 
🔄 Step 2: Extracting patient data...
[13:08:32] ℹ️  AI extracted raw sex value: 'F'
[13:08:32] ℹ️  AI extracted service line: 'PT'
[13:08:32] ℹ️  AI extracted payer source: 'Medicare'
[13:08:32] ℹ️  AI extracted diagnoses:
[13:08:32] ℹ️    - Diagnosis 1: 'None'
[13:08:32] ℹ️    - Diagnosis 2: 'None'
[13:08:32] ℹ️    - Diagnosis 3: 'None'
[13:08:32] ℹ️    - Diagnosis 4: 'None'
[13:08:32] ℹ️    - Diagnosis 5: 'None'
[13:08:32] ℹ️    - Diagnosis 6: 'None'
[13:08:32] ℹ️  Final extracted MRN: '4618015'
[13:08:32] ℹ️  Final extracted Sex: 'FEMALE'
[13:08:32] ℹ️  Final extracted Service Line: 'PT'
[13:08:32] ℹ️  Final extracted Payer Source: 'Medicare'
[13:08:32] ✅ Patient data extraction completed successfully
[13:08:32] ✅    ✅ Patient data extracted successfully
[13:08:32] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Almeida
     └─ dob: 10/08/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4618015
     └─ billingProvider: Robert J Caldas, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/26/2025', 'startOfEpisode': '04/26/2025', 'endOfEpisode': '06/24/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:08:32] ✅    ✅ Patient identified: Judith Almeida
[13:08:32] ✅    ✅ Patient name validation passed
[13:08:32] 🔄 
🔄 Step 3: Processing patient dates...
[13:08:32] [DOC: 9318944] ℹ️  DOB normalized: 10/08/1943
[13:08:32] [DOC: 9318944] ℹ️  Episode startOfCare normalized: 04/26/2025
[13:08:32] [DOC: 9318944] ℹ️  Episode startOfEpisode normalized: 04/26/2025
[13:08:32] [DOC: 9318944] ℹ️  Episode endOfEpisode normalized: 06/24/2025
[13:08:32] [DOC: 9318944] ✅ Patient date processing completed successfully
[13:08:32] ✅    ✅ Date processing completed
[13:08:32] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Almeida
     └─ dob: 10/08/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4618015
     └─ billingProvider: Robert J Caldas, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/26/2025', 'startOfEpisode': '04/26/2025', 'endOfEpisode': '06/24/2025'}]
[13:08:32] 🔄 
🔄 Step 4: Extracting order data...
[13:08:34] ℹ️  Order extraction - MRN: ''
[13:08:34] ℹ️  Order extraction - Sex: 'FEMALE'
[13:08:34] ℹ️  Order extraction - Service Line: 'PT'
[13:08:34] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:08:34] ✅ Order data extraction completed successfully
[13:08:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:08:34] ℹ️  Using MRN from patient data: '4618015'
[13:08:34] ℹ️  Service line consistent in both sources: 'PT'
[13:08:34] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:08:34] ✅ Patient name cross-validation successful
[13:08:34] ✅    ✅ Data merged successfully
[13:08:35] ✅    ✅ Order data extracted and validated
[13:08:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:08:41] [DOC: 9318944] ℹ️  Patient not found in cache or API: Judith Almeida
[13:08:41] [DOC: 9318944] ℹ️  Patient not found, creating new patient via API...
[13:08:41] [DOC: 9318944] ℹ️  Creating patient via API: Judith Almeida
[13:08:42] [DOC: 9318944] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:08:42] ❌    ❌ Failed to create patient
[13:08:42] [DOC: 9318944] ℹ️  API push details saved for document 9318944
================================================================================
║                        Processing Document ID: 9318943                         ║
================================================================================
[13:08:42] ℹ️  Agency: Dartmouth HH
[13:08:42] ℹ️  Date: 05/30/2025
[13:08:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:08:44] [DOC: 9318943] ✅ Text extracted using pdfplumber (5154 chars)
[13:08:44] ✅    ✅ Text extracted using pdfplumber (5154 chars)
[13:08:44] 🔄 
🔄 Step 2: Extracting patient data...
[13:08:47] ℹ️  AI extracted raw sex value: 'F'
[13:08:47] ℹ️  AI extracted service line: 'PT'
[13:08:47] ℹ️  AI extracted payer source: 'Fallon Navicare'
[13:08:47] ℹ️  AI extracted diagnoses:
[13:08:47] ℹ️    - Diagnosis 1: ''
[13:08:47] ℹ️    - Diagnosis 2: ''
[13:08:47] ℹ️    - Diagnosis 3: ''
[13:08:47] ℹ️    - Diagnosis 4: ''
[13:08:47] ℹ️    - Diagnosis 5: ''
[13:08:47] ℹ️    - Diagnosis 6: ''
[13:08:47] ℹ️  Final extracted MRN: '301015'
[13:08:47] ℹ️  Final extracted Sex: 'FEMALE'
[13:08:47] ℹ️  Final extracted Service Line: 'PT'
[13:08:47] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[13:08:47] ✅ Patient data extraction completed successfully
[13:08:47] ✅    ✅ Patient data extracted successfully
[13:08:47] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Dacosta
     └─ dob: 10/10/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 301015
     └─ billingProvider: Robert J Caldas, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2024', 'startOfEpisode': '04/29/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:08:47] ✅    ✅ Patient identified: Maria Dacosta
[13:08:47] ✅    ✅ Patient name validation passed
[13:08:47] 🔄 
🔄 Step 3: Processing patient dates...
[13:08:47] [DOC: 9318943] ℹ️  DOB normalized: 10/10/1943
[13:08:47] [DOC: 9318943] ℹ️  Episode startOfCare normalized: 04/19/2024
[13:08:47] [DOC: 9318943] ℹ️  Episode startOfEpisode normalized: 04/29/2025
[13:08:47] [DOC: 9318943] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[13:08:47] [DOC: 9318943] ✅ Patient date processing completed successfully
[13:08:47] ✅    ✅ Date processing completed
[13:08:47] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Dacosta
     └─ dob: 10/10/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 301015
     └─ billingProvider: Robert J Caldas, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2024', 'startOfEpisode': '04/29/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:08:47] 🔄 
🔄 Step 4: Extracting order data...
[13:08:49] ℹ️  Order extraction - MRN: ''
[13:08:49] ℹ️  Order extraction - Sex: 'FEMALE'
[13:08:49] ℹ️  Order extraction - Service Line: 'PT'
[13:08:49] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[13:08:49] ✅ Order data extraction completed successfully
[13:08:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:08:49] ℹ️  Using MRN from patient data: '301015'
[13:08:49] ℹ️  Service line consistent in both sources: 'PT'
[13:08:49] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[13:08:49] ✅ Patient name cross-validation successful
[13:08:49] ✅    ✅ Data merged successfully
[13:08:51] ✅    ✅ Order data extracted and validated
[13:08:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:09:00] [DOC: 9318943] ✅ Patient exists in API: Maria Dacosta, ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[13:09:00] ✅    ✅ Existing patient found with ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[13:09:00] 🔄 
🔄 Step 6: Pushing order to API...
[13:09:00] [DOC: 9318943] ℹ️  Pushing order via API for patient ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[13:09:01] [DOC: 9318943] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:09:01] ❌    ❌ Failed to push order
[13:09:01] 🔄 
🔄 Step 7: Writing to CSV...
[13:09:01] [DOC: 9318943] ℹ️  Calculated age: 81 from DOB: 10/10/1943
[13:09:01] [DOC: 9318943] ℹ️  Service Line extracted: 'PT'
[13:09:01] [DOC: 9318943] ℹ️  Payer Source extracted: 'Fallon Navicare'
[13:09:01] [DOC: 9318943] ℹ️  Diagnosis codes being written:
[13:09:01] [DOC: 9318943] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:09:01] [DOC: 9318943] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:09:01] [DOC: 9318943] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:09:01] [DOC: 9318943] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:09:01] [DOC: 9318943] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:09:01] [DOC: 9318943] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:09:01] [DOC: 9318943] ✅ Patient data written to CSV: Maria Dacosta | Sex: FEMALE | Age: 81 | Service: PT | Payer: Fallon Navicare | MRN: 301015
[13:09:01] ✅    ✅ Document 9318943 processed and saved successfully
[13:09:01] 🔄 
🔄 Step 8: Saving API details...
[13:09:01] [DOC: 9318943] ℹ️  API push details saved for document 9318943
[13:09:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9318941                         ║
================================================================================
[13:09:01] ℹ️  Agency: Dartmouth HH
[13:09:01] ℹ️  Date: 05/30/2025
[13:09:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:09:04] [DOC: 9318941] ✅ Text extracted using pdfplumber (1220 chars)
[13:09:04] ✅    ✅ Text extracted using pdfplumber (1220 chars)
[13:09:04] 🔄 
🔄 Step 2: Extracting patient data...
[13:09:07] ℹ️  AI extracted raw sex value: 'F'
[13:09:07] ℹ️  AI extracted service line: 'PT'
[13:09:07] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[13:09:07] ℹ️  AI extracted diagnoses:
[13:09:07] ℹ️    - Diagnosis 1: ''
[13:09:07] ℹ️    - Diagnosis 2: ''
[13:09:07] ℹ️    - Diagnosis 3: ''
[13:09:07] ℹ️    - Diagnosis 4: ''
[13:09:07] ℹ️    - Diagnosis 5: ''
[13:09:07] ℹ️    - Diagnosis 6: ''
[13:09:07] ℹ️  Final extracted MRN: '6326015'
[13:09:07] ℹ️  Final extracted Sex: 'FEMALE'
[13:09:07] ℹ️  Final extracted Service Line: 'PT'
[13:09:07] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[13:09:07] ✅ Patient data extraction completed successfully
[13:09:07] ✅    ✅ Patient data extracted successfully
[13:09:07] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Cardona
     └─ dob: 12/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6326015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 2108 Phillips Rd Apt 12
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:09:07] ✅    ✅ Patient identified: Maria Cardona
[13:09:07] ✅    ✅ Patient name validation passed
[13:09:07] 🔄 
🔄 Step 3: Processing patient dates...
[13:09:07] [DOC: 9318941] ℹ️  DOB normalized: 12/20/1945
[13:09:07] [DOC: 9318941] ℹ️  Episode startOfCare normalized: 04/07/2025
[13:09:07] [DOC: 9318941] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[13:09:07] [DOC: 9318941] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[13:09:07] [DOC: 9318941] ✅ Patient date processing completed successfully
[13:09:07] ✅    ✅ Date processing completed
[13:09:07] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Cardona
     └─ dob: 12/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6326015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 2108 Phillips Rd Apt 12
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:09:07] 🔄 
🔄 Step 4: Extracting order data...
[13:09:10] ℹ️  Order extraction - MRN: ''
[13:09:10] ℹ️  Order extraction - Sex: 'FEMALE'
[13:09:10] ℹ️  Order extraction - Service Line: 'PT'
[13:09:10] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[13:09:10] ✅ Order data extraction completed successfully
[13:09:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:09:10] ℹ️  Using MRN from patient data: '6326015'
[13:09:10] ℹ️  Service line consistent in both sources: 'PT'
[13:09:10] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[13:09:10] ✅ Patient name cross-validation successful
[13:09:10] ✅    ✅ Data merged successfully
[13:09:11] ✅    ✅ Order data extracted and validated
[13:09:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:09:16] [DOC: 9318941] ✅ Patient exists in API: Maria Cardona, ID: e3ebaeb6-381d-4ad3-bc43-6cdc78b5cbc1
[13:09:16] ✅    ✅ Existing patient found with ID: e3ebaeb6-381d-4ad3-bc43-6cdc78b5cbc1
[13:09:16] 🔄 
🔄 Step 6: Pushing order to API...
[13:09:16] [DOC: 9318941] ℹ️  Pushing order via API for patient ID: e3ebaeb6-381d-4ad3-bc43-6cdc78b5cbc1
[13:09:17] [DOC: 9318941] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:09:17] ❌    ❌ Failed to push order
[13:09:17] 🔄 
🔄 Step 7: Writing to CSV...
[13:09:17] [DOC: 9318941] ℹ️  Calculated age: 79 from DOB: 12/20/1945
[13:09:17] [DOC: 9318941] ℹ️  Service Line extracted: 'PT'
[13:09:17] [DOC: 9318941] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[13:09:17] [DOC: 9318941] ℹ️  Diagnosis codes being written:
[13:09:17] [DOC: 9318941] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:09:17] [DOC: 9318941] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:09:17] [DOC: 9318941] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:09:17] [DOC: 9318941] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:09:17] [DOC: 9318941] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:09:17] [DOC: 9318941] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:09:17] [DOC: 9318941] ✅ Patient data written to CSV: Maria Cardona | Sex: FEMALE | Age: 79 | Service: PT | Payer: Blue Cross Medicare Adv | MRN: 6326015
[13:09:17] ✅    ✅ Document 9318941 processed and saved successfully
[13:09:17] 🔄 
🔄 Step 8: Saving API details...
[13:09:17] [DOC: 9318941] ℹ️  API push details saved for document 9318941
[13:09:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9318939                         ║
================================================================================
[13:09:17] ℹ️  Agency: Dartmouth HH
[13:09:17] ℹ️  Date: 05/30/2025
[13:09:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:09:19] [DOC: 9318939] ✅ Text extracted using pdfplumber (1008 chars)
[13:09:19] ✅    ✅ Text extracted using pdfplumber (1008 chars)
[13:09:19] 🔄 
🔄 Step 2: Extracting patient data...
[13:09:22] ℹ️  AI extracted raw sex value: 'M'
[13:09:22] ℹ️  AI extracted service line: 'OT'
[13:09:22] ℹ️  AI extracted payer source: 'Fallon Navicare'
[13:09:22] ℹ️  AI extracted diagnoses:
[13:09:22] ℹ️    - Diagnosis 1: ''
[13:09:22] ℹ️    - Diagnosis 2: ''
[13:09:22] ℹ️    - Diagnosis 3: ''
[13:09:22] ℹ️    - Diagnosis 4: ''
[13:09:22] ℹ️    - Diagnosis 5: ''
[13:09:22] ℹ️    - Diagnosis 6: ''
[13:09:22] ℹ️  Final extracted MRN: '6306015'
[13:09:22] ℹ️  Final extracted Sex: 'MALE'
[13:09:22] ℹ️  Final extracted Service Line: 'OT'
[13:09:22] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[13:09:22] ✅ Patient data extraction completed successfully
[13:09:22] ✅    ✅ Patient data extracted successfully
[13:09:22] 📊 Patient Response
     └─ patientFName: Armindo
     └─ patientLName: Lopes
     └─ dob: 11/09/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 6306015
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 228 Eugenia Street second floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '05/02/2025', 'startOfEpisode': '05/04/2025', 'endOfEpisode': '06/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:09:22] ✅    ✅ Patient identified: Armindo Lopes
[13:09:22] ✅    ✅ Patient name validation passed
[13:09:22] 🔄 
🔄 Step 3: Processing patient dates...
[13:09:22] [DOC: 9318939] ℹ️  DOB normalized: 11/09/1952
[13:09:22] [DOC: 9318939] ℹ️  Episode startOfCare normalized: 05/02/2025
[13:09:22] [DOC: 9318939] ℹ️  Episode startOfEpisode normalized: 05/04/2025
[13:09:22] [DOC: 9318939] ℹ️  Episode endOfEpisode normalized: 06/30/2025
[13:09:22] [DOC: 9318939] ✅ Patient date processing completed successfully
[13:09:22] ✅    ✅ Date processing completed
[13:09:22] 📊 Processed Patient Data
     └─ patientFName: Armindo
     └─ patientLName: Lopes
     └─ dob: 11/09/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 6306015
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 228 Eugenia Street second floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '05/02/2025', 'startOfEpisode': '05/04/2025', 'endOfEpisode': '06/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:09:22] 🔄 
🔄 Step 4: Extracting order data...
[13:09:25] ℹ️  Order extraction - MRN: ''
[13:09:25] ℹ️  Order extraction - Sex: 'MALE'
[13:09:25] ℹ️  Order extraction - Service Line: 'OT'
[13:09:25] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[13:09:25] ✅ Order data extraction completed successfully
[13:09:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:09:25] ℹ️  Using MRN from patient data: '6306015'
[13:09:25] ℹ️  Service line consistent in both sources: 'OT'
[13:09:25] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[13:09:25] ✅ Patient name cross-validation successful
[13:09:25] ✅    ✅ Data merged successfully
[13:09:26] ✅    ✅ Order data extracted and validated
[13:09:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:09:33] [DOC: 9318939] ℹ️  Patient not found in cache or API: Armindo Lopes
[13:09:33] [DOC: 9318939] ℹ️  Patient not found, creating new patient via API...
[13:09:33] [DOC: 9318939] ℹ️  Creating patient via API: Armindo Lopes
[13:09:34] [DOC: 9318939] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:09:34] ❌    ❌ Failed to create patient
[13:09:34] [DOC: 9318939] ℹ️  API push details saved for document 9318939
================================================================================
║                        Processing Document ID: 9318935                         ║
================================================================================
[13:09:34] ℹ️  Agency: Fairhaven HH&H
[13:09:34] ℹ️  Date: 05/30/2025
[13:09:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:09:36] [DOC: 9318935] ✅ Text extracted using pdfplumber (1214 chars)
[13:09:36] ✅    ✅ Text extracted using pdfplumber (1214 chars)
[13:09:36] 🔄 
🔄 Step 2: Extracting patient data...
[13:09:38] ℹ️  AI extracted raw sex value: 'F'
[13:09:38] ℹ️  AI extracted service line: 'HOSPICE'
[13:09:38] ℹ️  AI extracted payer source: 'Medicare'
[13:09:38] ℹ️  AI extracted diagnoses:
[13:09:38] ℹ️    - Diagnosis 1: ''
[13:09:38] ℹ️    - Diagnosis 2: ''
[13:09:38] ℹ️    - Diagnosis 3: ''
[13:09:38] ℹ️    - Diagnosis 4: ''
[13:09:38] ℹ️    - Diagnosis 5: ''
[13:09:38] ℹ️    - Diagnosis 6: ''
[13:09:38] ℹ️  Final extracted MRN: '5782009'
[13:09:38] ℹ️  Final extracted Sex: 'FEMALE'
[13:09:38] ℹ️  Final extracted Service Line: 'HOSPICE'
[13:09:38] ℹ️  Final extracted Payer Source: 'Medicare'
[13:09:38] ✅ Patient data extraction completed successfully
[13:09:38] ✅    ✅ Patient data extracted successfully
[13:09:38] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Foster
     └─ dob: 06/16/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5782009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HOSPICE
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/23/2022', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:09:38] ✅    ✅ Patient identified: Patricia Foster
[13:09:38] ✅    ✅ Patient name validation passed
[13:09:38] 🔄 
🔄 Step 3: Processing patient dates...
[13:09:38] [DOC: 9318935] ℹ️  DOB normalized: 06/16/1931
[13:09:38] [DOC: 9318935] ℹ️  Episode startOfCare normalized: 12/23/2022
[13:09:38] [DOC: 9318935] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[13:09:38] [DOC: 9318935] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[13:09:38] [DOC: 9318935] ✅ Patient date processing completed successfully
[13:09:38] ✅    ✅ Date processing completed
[13:09:38] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Foster
     └─ dob: 06/16/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5782009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HOSPICE
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/23/2022', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:09:38] 🔄 
🔄 Step 4: Extracting order data...
[13:09:41] ℹ️  Order extraction - MRN: '5782009'
[13:09:41] ℹ️  Order extraction - Sex: 'FEMALE'
[13:09:41] ℹ️  Order extraction - Service Line: 'Hospice'
[13:09:41] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:09:41] ✅ Order data extraction completed successfully
[13:09:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:09:41] ℹ️  Using MRN from patient data: '5782009' over '5782009'
[13:09:41] ℹ️  Service line consistent in both sources: 'HOSPICE'
[13:09:41] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:09:41] ✅ Patient name cross-validation successful
[13:09:41] ✅    ✅ Data merged successfully
[13:09:42] ✅    ✅ Order data extracted and validated
[13:09:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:09:49] [DOC: 9318935] ✅ Patient exists in API: Patricia Foster, ID: 02cfc02d-5153-4681-bdd5-391d0e7448c5
[13:09:49] ✅    ✅ Existing patient found with ID: 02cfc02d-5153-4681-bdd5-391d0e7448c5
[13:09:49] 🔄 
🔄 Step 6: Pushing order to API...
[13:09:49] [DOC: 9318935] ℹ️  Pushing order via API for patient ID: 02cfc02d-5153-4681-bdd5-391d0e7448c5
[13:09:50] [DOC: 9318935] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:09:50] ❌    ❌ Failed to push order
[13:09:50] 🔄 
🔄 Step 7: Writing to CSV...
[13:09:50] [DOC: 9318935] ℹ️  Calculated age: 93 from DOB: 06/16/1931
[13:09:50] [DOC: 9318935] ℹ️  Service Line extracted: 'HOSPICE'
[13:09:50] [DOC: 9318935] ℹ️  Payer Source extracted: 'Medicare'
[13:09:50] [DOC: 9318935] ℹ️  Diagnosis codes being written:
[13:09:50] [DOC: 9318935] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:09:50] [DOC: 9318935] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:09:50] [DOC: 9318935] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:09:50] [DOC: 9318935] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:09:50] [DOC: 9318935] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:09:50] [DOC: 9318935] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:09:50] [DOC: 9318935] ✅ Patient data written to CSV: Patricia Foster | Sex: FEMALE | Age: 93 | Service: HOSPICE | Payer: Medicare | MRN: 5782009
[13:09:50] ✅    ✅ Document 9318935 processed and saved successfully
[13:09:50] 🔄 
🔄 Step 8: Saving API details...
[13:09:50] [DOC: 9318935] ℹ️  API push details saved for document 9318935
[13:09:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320827                         ║
================================================================================
[13:09:50] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:09:50] ℹ️  Date: 05/30/2025
[13:09:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:09:52] [DOC: 9320827] ✅ Text extracted using pdfplumber (1033 chars)
[13:09:52] ✅    ✅ Text extracted using pdfplumber (1033 chars)
[13:09:52] 🔄 
🔄 Step 2: Extracting patient data...
[13:09:55] ℹ️  AI extracted raw sex value: ''
[13:09:55] ℹ️  AI extracted service line: 'LPN'
[13:09:55] ℹ️  AI extracted payer source: ''
[13:09:55] ℹ️  AI extracted diagnoses:
[13:09:55] ℹ️    - Diagnosis 1: 'B37.41'
[13:09:55] ℹ️    - Diagnosis 2: 'B37.49'
[13:09:55] ℹ️    - Diagnosis 3: 'N13.6'
[13:09:55] ℹ️    - Diagnosis 4: ''
[13:09:55] ℹ️    - Diagnosis 5: ''
[13:09:55] ℹ️    - Diagnosis 6: ''
[13:09:55] ℹ️  Final extracted MRN: 'MA230712124102'
[13:09:55] ℹ️  Final extracted Sex: ''
[13:09:55] ℹ️  Final extracted Service Line: 'LPN'
[13:09:55] ℹ️  Final extracted Payer Source: ''
[13:09:55] ✅ Patient data extraction completed successfully
[13:09:55] ✅    ✅ Patient data extracted successfully
[13:09:55] 📊 Patient Response
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/15/2025', 'endOfEpisode': '07/13/2025', 'firstDiagnosis': 'B37.41', 'secondDiagnosis': 'B37.49', 'thirdDiagnosis': 'N13.6', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:09:55] ✅    ✅ Patient identified: Hiram Cordero
[13:09:55] ✅    ✅ Patient name validation passed
[13:09:55] 🔄 
🔄 Step 3: Processing patient dates...
[13:09:55] [DOC: 9320827] ℹ️  DOB normalized: 12/08/1941
[13:09:55] [DOC: 9320827] ℹ️  Episode startOfEpisode normalized: 05/15/2025
[13:09:55] [DOC: 9320827] ℹ️  Episode endOfEpisode normalized: 07/13/2025
[13:09:55] [DOC: 9320827] ✅ Patient date processing completed successfully
[13:09:55] ✅    ✅ Date processing completed
[13:09:55] 📊 Processed Patient Data
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: AILEEN SOUZA MD
     └─ npi: 1598261745
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/15/2025', 'endOfEpisode': '07/13/2025', 'firstDiagnosis': 'B37.41', 'secondDiagnosis': 'B37.49', 'thirdDiagnosis': 'N13.6', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:09:55] 🔄 
🔄 Step 4: Extracting order data...
[13:09:58] ℹ️  Order extraction - MRN: 'MA230712124102'
[13:09:58] ℹ️  Order extraction - Sex: ''
[13:09:58] ℹ️  Order extraction - Service Line: 'LPN'
[13:09:58] ℹ️  Order extraction - Payer Source: ''
[13:09:58] ✅ Order data extraction completed successfully
[13:09:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:09:58] ℹ️  Using MRN from patient data: 'MA230712124102' over 'MA230712124102'
[13:09:58] ⚠️  Could not determine sex using any available method
[13:09:58] ℹ️  Service line consistent in both sources: 'LPN'
[13:09:58] ✅ Patient name cross-validation successful
[13:09:58] ✅    ✅ Data merged successfully
[13:09:59] ✅    ✅ Order data extracted and validated
[13:09:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:10:07] [DOC: 9320827] ✅ Patient exists in API: Hiram Cordero, ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[13:10:07] ✅    ✅ Existing patient found with ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[13:10:07] 🔄 
🔄 Step 6: Pushing order to API...
[13:10:07] [DOC: 9320827] ℹ️  Pushing order via API for patient ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[13:10:09] [DOC: 9320827] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18930"}
[13:10:09] ❌    ❌ Failed to push order
[13:10:09] 🔄 
🔄 Step 7: Writing to CSV...
[13:10:09] [DOC: 9320827] ℹ️  Calculated age: 83 from DOB: 12/08/1941
[13:10:09] [DOC: 9320827] ℹ️  Service Line extracted: 'LPN'
[13:10:09] [DOC: 9320827] ℹ️  Payer Source extracted: ''
[13:10:09] [DOC: 9320827] ℹ️  Diagnosis codes being written:
[13:10:09] [DOC: 9320827] ℹ️    - Latest_Episode_Firstdiagnosis: 'B37.41'
[13:10:09] [DOC: 9320827] ℹ️    - Latest_Episode_Seconddiagnosis: 'B37.49'
[13:10:09] [DOC: 9320827] ℹ️    - Latest_Episode_Thirddiagnosis: 'N13.6'
[13:10:09] [DOC: 9320827] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:10:09] [DOC: 9320827] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:10:09] [DOC: 9320827] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:10:09] [DOC: 9320827] ✅ Patient data written to CSV: Hiram Cordero | Sex:  | Age: 83 | Service: LPN | Payer:  | MRN: MA230712124102
[13:10:09] ✅    ✅ Document 9320827 processed and saved successfully
[13:10:09] 🔄 
🔄 Step 8: Saving API details...
[13:10:09] [DOC: 9320827] ℹ️  API push details saved for document 9320827
[13:10:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320825                         ║
================================================================================
[13:10:09] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:10:09] ℹ️  Date: 05/30/2025
[13:10:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:10:11] [DOC: 9320825] ✅ Text extracted using pdfplumber (9192 chars)
[13:10:11] ✅    ✅ Text extracted using pdfplumber (9192 chars)
[13:10:11] 🔄 
🔄 Step 2: Extracting patient data...
[13:10:14] ℹ️  AI extracted raw sex value: 'M'
[13:10:14] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:10:14] ℹ️  AI extracted payer source: ''
[13:10:14] ℹ️  AI extracted diagnoses:
[13:10:14] ℹ️    - Diagnosis 1: 'B3741'
[13:10:14] ℹ️    - Diagnosis 2: 'B3749'
[13:10:14] ℹ️    - Diagnosis 3: ''
[13:10:14] ℹ️    - Diagnosis 4: ''
[13:10:14] ℹ️    - Diagnosis 5: ''
[13:10:14] ℹ️    - Diagnosis 6: ''
[13:10:14] ℹ️  Final extracted MRN: 'MA230712124102'
[13:10:14] ℹ️  Final extracted Sex: 'MALE'
[13:10:14] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:10:14] ℹ️  Final extracted Payer Source: ''
[13:10:14] ✅ Patient data extraction completed successfully
[13:10:14] ✅    ✅ Patient data extracted successfully
[13:10:14] 📊 Patient Response
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: Dr. SOUZA, AILEEN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'B3741', 'secondDiagnosis': 'B3749', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:10:14] ✅    ✅ Patient identified: Hiram Cordero
[13:10:14] ✅    ✅ Patient name validation passed
[13:10:14] 🔄 
🔄 Step 3: Processing patient dates...
[13:10:14] [DOC: 9320825] ℹ️  DOB normalized: 12/08/1941
[13:10:14] [DOC: 9320825] ℹ️  Episode startOfEpisode normalized: 03/16/2025
[13:10:14] [DOC: 9320825] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[13:10:14] [DOC: 9320825] ✅ Patient date processing completed successfully
[13:10:14] ✅    ✅ Date processing completed
[13:10:14] 📊 Processed Patient Data
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: Dr. SOUZA, AILEEN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'B3741', 'secondDiagnosis': 'B3749', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:10:14] 🔄 
🔄 Step 4: Extracting order data...
[13:10:16] ℹ️  Order extraction - MRN: 'MA230712124102'
[13:10:16] ℹ️  Order extraction - Sex: 'MALE'
[13:10:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:10:16] ℹ️  Order extraction - Payer Source: ''
[13:10:16] ✅ Order data extraction completed successfully
[13:10:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:10:16] ℹ️  Using MRN from patient data: 'MA230712124102' over 'MA230712124102'
[13:10:16] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:10:16] ✅ Patient name cross-validation successful
[13:10:16] ✅    ✅ Data merged successfully
[13:10:18] ✅    ✅ Order data extracted and validated
[13:10:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:10:18] [DOC: 9320825] ✅ Patient found in local cache: Hiram Cordero, ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[13:10:18] ✅    ✅ Existing patient found with ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[13:10:18] 🔄 
🔄 Step 6: Pushing order to API...
[13:10:18] [DOC: 9320825] ℹ️  Pushing order via API for patient ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[13:10:19] [DOC: 9320825] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18931"}
[13:10:19] ❌    ❌ Failed to push order
[13:10:19] 🔄 
🔄 Step 7: Writing to CSV...
[13:10:19] [DOC: 9320825] ℹ️  Calculated age: 83 from DOB: 12/08/1941
[13:10:19] [DOC: 9320825] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:10:19] [DOC: 9320825] ℹ️  Payer Source extracted: ''
[13:10:19] [DOC: 9320825] ℹ️  Diagnosis codes being written:
[13:10:19] [DOC: 9320825] ℹ️    - Latest_Episode_Firstdiagnosis: 'B3741'
[13:10:19] [DOC: 9320825] ℹ️    - Latest_Episode_Seconddiagnosis: 'B3749'
[13:10:19] [DOC: 9320825] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:10:19] [DOC: 9320825] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:10:19] [DOC: 9320825] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:10:19] [DOC: 9320825] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:10:19] [DOC: 9320825] ✅ Patient data written to CSV: Hiram Cordero | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer:  | MRN: MA230712124102
[13:10:19] ✅    ✅ Document 9320825 processed and saved successfully
[13:10:19] 🔄 
🔄 Step 8: Saving API details...
[13:10:19] [DOC: 9320825] ℹ️  API push details saved for document 9320825
[13:10:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320821                         ║
================================================================================
[13:10:19] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:10:19] ℹ️  Date: 05/30/2025
[13:10:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:10:21] [DOC: 9320821] ✅ Text extracted using pdfplumber (11669 chars)
[13:10:21] ✅    ✅ Text extracted using pdfplumber (11669 chars)
[13:10:21] 🔄 
🔄 Step 2: Extracting patient data...
[13:10:25] ℹ️  AI extracted raw sex value: 'M'
[13:10:25] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:10:25] ℹ️  AI extracted payer source: 'Medicare'
[13:10:25] ℹ️  AI extracted diagnoses:
[13:10:25] ℹ️    - Diagnosis 1: 'B37.41'
[13:10:25] ℹ️    - Diagnosis 2: 'B37.49'
[13:10:25] ℹ️    - Diagnosis 3: 'N13.6'
[13:10:25] ℹ️    - Diagnosis 4: 'B95.61'
[13:10:25] ℹ️    - Diagnosis 5: 'I48.0'
[13:10:25] ℹ️    - Diagnosis 6: 'N17.9'
[13:10:25] ℹ️  Final extracted MRN: 'MA230712124102'
[13:10:25] ℹ️  Final extracted Sex: 'MALE'
[13:10:25] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:10:25] ℹ️  Final extracted Payer Source: 'Medicare'
[13:10:25] ✅ Patient data extraction completed successfully
[13:10:25] ✅    ✅ Patient data extracted successfully
[13:10:25] 📊 Patient Response
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: SOUZA, AILEEN MD
     └─ npi: 1881923936
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 66 Newcomb St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (774) 305-9616
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2024', 'startOfEpisode': '05/15/2025', 'endOfEpisode': '07/13/2025', 'firstDiagnosis': 'B37.41', 'secondDiagnosis': 'B37.49', 'thirdDiagnosis': 'N13.6', 'fourthDiagnosis': 'B95.61', 'fifthDiagnosis': 'I48.0', 'sixthDiagnosis': 'N17.9'}]
[13:10:25] ✅    ✅ Patient identified: Hiram Cordero
[13:10:25] ✅    ✅ Patient name validation passed
[13:10:25] 🔄 
🔄 Step 3: Processing patient dates...
[13:10:25] [DOC: 9320821] ℹ️  DOB normalized: 12/08/1941
[13:10:25] [DOC: 9320821] ℹ️  Episode startOfCare normalized: 03/21/2024
[13:10:25] [DOC: 9320821] ℹ️  Episode startOfEpisode normalized: 05/15/2025
[13:10:25] [DOC: 9320821] ℹ️  Episode endOfEpisode normalized: 07/13/2025
[13:10:25] [DOC: 9320821] ✅ Patient date processing completed successfully
[13:10:25] ✅    ✅ Date processing completed
[13:10:25] 📊 Processed Patient Data
     └─ patientFName: Hiram
     └─ patientLName: Cordero
     └─ dob: 12/08/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230712124102
     └─ billingProvider: SOUZA, AILEEN MD
     └─ npi: 1881923936
     └─ physicianNPI: 1598261745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 66 Newcomb St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (774) 305-9616
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/21/2024', 'startOfEpisode': '05/15/2025', 'endOfEpisode': '07/13/2025', 'firstDiagnosis': 'B37.41', 'secondDiagnosis': 'B37.49', 'thirdDiagnosis': 'N13.6', 'fourthDiagnosis': 'B95.61', 'fifthDiagnosis': 'I48.0', 'sixthDiagnosis': 'N17.9'}]
[13:10:25] 🔄 
🔄 Step 4: Extracting order data...
[13:10:27] ℹ️  Order extraction - MRN: 'MA230712124102'
[13:10:27] ℹ️  Order extraction - Sex: 'MALE'
[13:10:27] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:10:27] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:10:27] ✅ Order data extraction completed successfully
[13:10:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:10:27] ℹ️  Using MRN from patient data: 'MA230712124102' over 'MA230712124102'
[13:10:27] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:10:27] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:10:27] ✅ Patient name cross-validation successful
[13:10:27] ✅    ✅ Data merged successfully
[13:10:29] ✅    ✅ Order data extracted and validated
[13:10:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:10:29] [DOC: 9320821] ✅ Patient found in local cache: Hiram Cordero, ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[13:10:29] ✅    ✅ Existing patient found with ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[13:10:29] 🔄 
🔄 Step 6: Pushing order to API...
[13:10:29] [DOC: 9320821] ℹ️  Pushing order via API for patient ID: 2cca8d0d-8096-4aa4-a3cc-b1cac047aafd
[13:10:30] [DOC: 9320821] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18932"}
[13:10:30] ❌    ❌ Failed to push order
[13:10:30] 🔄 
🔄 Step 7: Writing to CSV...
[13:10:30] [DOC: 9320821] ℹ️  Calculated age: 83 from DOB: 12/08/1941
[13:10:30] [DOC: 9320821] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:10:30] [DOC: 9320821] ℹ️  Payer Source extracted: 'Medicare'
[13:10:30] [DOC: 9320821] ℹ️  Diagnosis codes being written:
[13:10:30] [DOC: 9320821] ℹ️    - Latest_Episode_Firstdiagnosis: 'B37.41'
[13:10:30] [DOC: 9320821] ℹ️    - Latest_Episode_Seconddiagnosis: 'B37.49'
[13:10:30] [DOC: 9320821] ℹ️    - Latest_Episode_Thirddiagnosis: 'N13.6'
[13:10:30] [DOC: 9320821] ℹ️    - Latest_Episode_Fourthdiagnosis: 'B95.61'
[13:10:30] [DOC: 9320821] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I48.0'
[13:10:30] [DOC: 9320821] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N17.9'
[13:10:30] [DOC: 9320821] ✅ Patient data written to CSV: Hiram Cordero | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: MA230712124102
[13:10:30] ✅    ✅ Document 9320821 processed and saved successfully
[13:10:30] 🔄 
🔄 Step 8: Saving API details...
[13:10:30] [DOC: 9320821] ℹ️  API push details saved for document 9320821
[13:10:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320670                         ║
================================================================================
[13:10:30] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:10:30] ℹ️  Date: 05/30/2025
[13:10:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:10:32] [DOC: 9320670] ✅ Text extracted using pdfplumber (1329 chars)
[13:10:32] ✅    ✅ Text extracted using pdfplumber (1317 chars)
[13:10:32] 🔄 
🔄 Step 2: Extracting patient data...
[13:10:35] ℹ️  AI extracted raw sex value: ''
[13:10:35] ℹ️  AI extracted service line: 'Physical Therapy'
[13:10:35] ℹ️  AI extracted payer source: ''
[13:10:35] ℹ️  AI extracted diagnoses:
[13:10:35] ℹ️    - Diagnosis 1: 'E11.65'
[13:10:35] ℹ️    - Diagnosis 2: 'E03.9'
[13:10:35] ℹ️    - Diagnosis 3: 'E55.9'
[13:10:35] ℹ️    - Diagnosis 4: ''
[13:10:35] ℹ️    - Diagnosis 5: ''
[13:10:35] ℹ️    - Diagnosis 6: ''
[13:10:35] ℹ️  Final extracted MRN: 'MA241011025604'
[13:10:35] ℹ️  Final extracted Sex: ''
[13:10:35] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:10:35] ℹ️  Final extracted Payer Source: ''
[13:10:35] ✅ Patient data extraction completed successfully
[13:10:35] ✅    ✅ Patient data extracted successfully
[13:10:35] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Medeiros
     └─ dob: 02/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA241011025604
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E55.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:10:35] ✅    ✅ Patient identified: Maria Medeiros
[13:10:35] ✅    ✅ Patient name validation passed
[13:10:35] 🔄 
🔄 Step 3: Processing patient dates...
[13:10:35] [DOC: 9320670] ℹ️  DOB normalized: 02/04/1956
[13:10:35] [DOC: 9320670] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[13:10:35] [DOC: 9320670] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[13:10:35] [DOC: 9320670] ✅ Patient date processing completed successfully
[13:10:35] ✅    ✅ Date processing completed
[13:10:35] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Medeiros
     └─ dob: 02/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA241011025604
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E55.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:10:35] 🔄 
🔄 Step 4: Extracting order data...
[13:10:37] ℹ️  Order extraction - MRN: 'MA241011025604'
[13:10:37] ℹ️  Order extraction - Sex: ''
[13:10:37] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[13:10:37] ℹ️  Order extraction - Payer Source: ''
[13:10:37] ✅ Order data extraction completed successfully
[13:10:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:10:37] ℹ️  Using MRN from patient data: 'MA241011025604' over 'MA241011025604'
[13:10:37] ℹ️  Inferred sex as FEMALE from name: Maria
[13:10:37] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[13:10:37] ✅ Patient name cross-validation successful
[13:10:37] ✅    ✅ Data merged successfully
[13:10:38] ✅    ✅ Order data extracted and validated
[13:10:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:10:44] [DOC: 9320670] ℹ️  Patient not found in cache or API: Maria Medeiros
[13:10:44] [DOC: 9320670] ℹ️  Patient not found, creating new patient via API...
[13:10:44] [DOC: 9320670] ℹ️  Creating patient via API: Maria Medeiros
[13:10:45] [DOC: 9320670] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:10:45] ❌    ❌ Failed to create patient
[13:10:45] [DOC: 9320670] ℹ️  API push details saved for document 9320670
================================================================================
║                        Processing Document ID: 9320669                         ║
================================================================================
[13:10:45] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:10:45] ℹ️  Date: 05/30/2025
[13:10:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:10:47] [DOC: 9320669] ✅ Text extracted using pdfplumber (1316 chars)
[13:10:47] ✅    ✅ Text extracted using pdfplumber (1304 chars)
[13:10:47] 🔄 
🔄 Step 2: Extracting patient data...
[13:10:50] ℹ️  AI extracted raw sex value: ''
[13:10:50] ℹ️  AI extracted service line: 'Physical Therapy'
[13:10:50] ℹ️  AI extracted payer source: ''
[13:10:50] ℹ️  AI extracted diagnoses:
[13:10:50] ℹ️    - Diagnosis 1: 'E11.65'
[13:10:50] ℹ️    - Diagnosis 2: 'E03.9'
[13:10:50] ℹ️    - Diagnosis 3: 'E55.9'
[13:10:50] ℹ️    - Diagnosis 4: 'None'
[13:10:50] ℹ️    - Diagnosis 5: 'None'
[13:10:50] ℹ️    - Diagnosis 6: 'None'
[13:10:50] ℹ️  Final extracted MRN: 'MA241011025604'
[13:10:50] ℹ️  Final extracted Sex: ''
[13:10:50] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:10:50] ℹ️  Final extracted Payer Source: ''
[13:10:50] ✅ Patient data extraction completed successfully
[13:10:50] ✅    ✅ Patient data extracted successfully
[13:10:50] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Medeiros
     └─ dob: 02/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA241011025604
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E55.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:10:50] ✅    ✅ Patient identified: Maria Medeiros
[13:10:50] ✅    ✅ Patient name validation passed
[13:10:50] 🔄 
🔄 Step 3: Processing patient dates...
[13:10:50] [DOC: 9320669] ℹ️  DOB normalized: 02/04/1956
[13:10:50] [DOC: 9320669] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[13:10:50] [DOC: 9320669] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[13:10:50] [DOC: 9320669] ✅ Patient date processing completed successfully
[13:10:50] ✅    ✅ Date processing completed
[13:10:50] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Medeiros
     └─ dob: 02/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA241011025604
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E55.9'}]
[13:10:50] 🔄 
🔄 Step 4: Extracting order data...
[13:10:53] ℹ️  Order extraction - MRN: 'MA241011025604'
[13:10:53] ℹ️  Order extraction - Sex: ''
[13:10:53] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[13:10:53] ℹ️  Order extraction - Payer Source: ''
[13:10:53] ✅ Order data extraction completed successfully
[13:10:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:10:53] ℹ️  Using MRN from patient data: 'MA241011025604' over 'MA241011025604'
[13:10:53] ℹ️  Inferred sex as FEMALE from name: Maria
[13:10:53] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[13:10:53] ✅ Patient name cross-validation successful
[13:10:53] ✅    ✅ Data merged successfully
[13:10:54] ✅    ✅ Order data extracted and validated
[13:10:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:11:00] [DOC: 9320669] ℹ️  Patient not found in cache or API: Maria Medeiros
[13:11:00] [DOC: 9320669] ℹ️  Patient not found, creating new patient via API...
[13:11:00] [DOC: 9320669] ℹ️  Creating patient via API: Maria Medeiros
[13:11:01] [DOC: 9320669] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:11:01] ❌    ❌ Failed to create patient
[13:11:01] [DOC: 9320669] ℹ️  API push details saved for document 9320669
================================================================================
║                        Processing Document ID: 9320610                         ║
================================================================================
[13:11:01] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:11:01] ℹ️  Date: 05/30/2025
[13:11:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:11:04] [DOC: 9320610] ✅ Text extracted using pdfplumber (16371 chars)
[13:11:04] ✅    ✅ Text extracted using pdfplumber (16371 chars)
[13:11:04] 🔄 
🔄 Step 2: Extracting patient data...
[13:11:07] ℹ️  AI extracted raw sex value: 'M'
[13:11:07] ℹ️  AI extracted service line: 'PT'
[13:11:07] ℹ️  AI extracted payer source: 'None'
[13:11:07] ℹ️  AI extracted diagnoses:
[13:11:07] ℹ️    - Diagnosis 1: 'J45.90'
[13:11:07] ℹ️    - Diagnosis 2: 'I25.10'
[13:11:07] ℹ️    - Diagnosis 3: 'E11.9'
[13:11:07] ℹ️    - Diagnosis 4: 'G40.9'
[13:11:07] ℹ️    - Diagnosis 5: 'D64.9'
[13:11:07] ℹ️    - Diagnosis 6: 'N18.9'
[13:11:07] ℹ️  Final extracted MRN: 'MA250210123603'
[13:11:07] ℹ️  Final extracted Sex: 'MALE'
[13:11:07] ℹ️  Final extracted Service Line: 'PT'
[13:11:07] ℹ️  Final extracted Payer Source: ''
[13:11:07] ✅ Patient data extraction completed successfully
[13:11:07] ✅    ✅ Patient data extracted successfully
[13:11:07] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/28/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': 'J45.90', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'G40.9', 'fifthDiagnosis': 'D64.9', 'sixthDiagnosis': 'N18.9'}]
[13:11:07] ✅    ✅ Patient identified: David Boswell
[13:11:07] ✅    ✅ Patient name validation passed
[13:11:07] 🔄 
🔄 Step 3: Processing patient dates...
[13:11:07] [DOC: 9320610] ℹ️  DOB normalized: 12/29/1936
[13:11:07] [DOC: 9320610] ℹ️  Episode startOfEpisode normalized: 04/28/2025
[13:11:07] [DOC: 9320610] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[13:11:07] [DOC: 9320610] ✅ Patient date processing completed successfully
[13:11:07] ✅    ✅ Date processing completed
[13:11:07] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/28/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': 'J45.90', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'G40.9', 'fifthDiagnosis': 'D64.9', 'sixthDiagnosis': 'N18.9'}]
[13:11:07] 🔄 
🔄 Step 4: Extracting order data...
[13:11:10] ℹ️  Order extraction - MRN: 'MA250210123603'
[13:11:10] ℹ️  Order extraction - Sex: 'MALE'
[13:11:10] ℹ️  Order extraction - Service Line: 'PT'
[13:11:10] ℹ️  Order extraction - Payer Source: ''
[13:11:10] ✅ Order data extraction completed successfully
[13:11:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:11:10] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[13:11:10] ℹ️  Service line consistent in both sources: 'PT'
[13:11:10] ✅ Patient name cross-validation successful
[13:11:10] ✅    ✅ Data merged successfully
[13:11:11] ⚠️     ❌ Skipping - missing episode start date
[13:11:11] [DOC: 9320610] ℹ️  API push details saved for document 9320610
================================================================================
║                        Processing Document ID: 9320609                         ║
================================================================================
[13:11:11] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:11:11] ℹ️  Date: 05/30/2025
[13:11:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:11:14] [DOC: 9320609] ✅ Text extracted using pdfplumber (15363 chars)
[13:11:14] ✅    ✅ Text extracted using pdfplumber (15363 chars)
[13:11:14] 🔄 
🔄 Step 2: Extracting patient data...
[13:11:17] ℹ️  AI extracted raw sex value: 'M'
[13:11:17] ℹ️  AI extracted service line: 'OT'
[13:11:17] ℹ️  AI extracted payer source: ''
[13:11:17] ℹ️  AI extracted diagnoses:
[13:11:17] ℹ️    - Diagnosis 1: 'J44.1'
[13:11:17] ℹ️    - Diagnosis 2: ''
[13:11:17] ℹ️    - Diagnosis 3: ''
[13:11:17] ℹ️    - Diagnosis 4: ''
[13:11:17] ℹ️    - Diagnosis 5: ''
[13:11:17] ℹ️    - Diagnosis 6: ''
[13:11:17] ℹ️  Final extracted MRN: 'MA250210123603'
[13:11:17] ℹ️  Final extracted Sex: 'MALE'
[13:11:17] ℹ️  Final extracted Service Line: 'OT'
[13:11:17] ℹ️  Final extracted Payer Source: ''
[13:11:17] ✅ Patient data extraction completed successfully
[13:11:17] ✅    ✅ Patient data extracted successfully
[13:11:17] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:11:17] ✅    ✅ Patient identified: David Boswell
[13:11:17] ✅    ✅ Patient name validation passed
[13:11:17] 🔄 
🔄 Step 3: Processing patient dates...
[13:11:17] [DOC: 9320609] ℹ️  DOB normalized: 12/29/1936
[13:11:17] [DOC: 9320609] ℹ️  Episode startOfEpisode normalized: 02/27/2025
[13:11:17] [DOC: 9320609] ✅ Patient date processing completed successfully
[13:11:17] ✅    ✅ Date processing completed
[13:11:17] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/27/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:11:17] 🔄 
🔄 Step 4: Extracting order data...
[13:11:19] ℹ️  Order extraction - MRN: 'MA250210123603'
[13:11:19] ℹ️  Order extraction - Sex: 'MALE'
[13:11:19] ℹ️  Order extraction - Service Line: 'OT'
[13:11:19] ℹ️  Order extraction - Payer Source: ''
[13:11:19] ✅ Order data extraction completed successfully
[13:11:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:11:19] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[13:11:19] ℹ️  Service line consistent in both sources: 'OT'
[13:11:19] ✅ Patient name cross-validation successful
[13:11:19] ✅    ✅ Data merged successfully
[13:11:21] ✅    ✅ Order data extracted and validated
[13:11:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:11:31] [DOC: 9320609] ✅ Patient exists in API: David Boswell, ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[13:11:31] ✅    ✅ Existing patient found with ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[13:11:31] 🔄 
🔄 Step 6: Pushing order to API...
[13:11:31] [DOC: 9320609] ℹ️  Pushing order via API for patient ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[13:11:32] [DOC: 9320609] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:11:32] ❌    ❌ Failed to push order
[13:11:32] 🔄 
🔄 Step 7: Writing to CSV...
[13:11:32] [DOC: 9320609] ℹ️  Calculated age: 88 from DOB: 12/29/1936
[13:11:32] [DOC: 9320609] ℹ️  Service Line extracted: 'OT'
[13:11:32] [DOC: 9320609] ℹ️  Payer Source extracted: ''
[13:11:32] [DOC: 9320609] ℹ️  Diagnosis codes being written:
[13:11:32] [DOC: 9320609] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[13:11:32] [DOC: 9320609] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:11:32] [DOC: 9320609] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:11:32] [DOC: 9320609] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:11:32] [DOC: 9320609] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:11:32] [DOC: 9320609] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:11:32] [DOC: 9320609] ✅ Patient data written to CSV: David Boswell | Sex: MALE | Age: 88 | Service: OT | Payer:  | MRN: MA250210123603
[13:11:32] ✅    ✅ Document 9320609 processed and saved successfully
[13:11:32] 🔄 
🔄 Step 8: Saving API details...
[13:11:32] [DOC: 9320609] ℹ️  API push details saved for document 9320609
[13:11:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320608                         ║
================================================================================
[13:11:32] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:11:32] ℹ️  Date: 05/30/2025
[13:11:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:11:35] [DOC: 9320608] ✅ Text extracted using pdfplumber (16648 chars)
[13:11:35] ✅    ✅ Text extracted using pdfplumber (16648 chars)
[13:11:35] 🔄 
🔄 Step 2: Extracting patient data...
[13:11:38] ℹ️  AI extracted raw sex value: 'F'
[13:11:38] ℹ️  AI extracted service line: 'PT'
[13:11:38] ℹ️  AI extracted payer source: ''
[13:11:38] ℹ️  AI extracted diagnoses:
[13:11:38] ℹ️    - Diagnosis 1: 's/p right shoulder arthroplasty with biceps tendesis'
[13:11:38] ℹ️    - Diagnosis 2: 'gait instability'
[13:11:38] ℹ️    - Diagnosis 3: 'IDA'
[13:11:38] ℹ️    - Diagnosis 4: 'asthma'
[13:11:38] ℹ️    - Diagnosis 5: 'systemic lupus erythematous'
[13:11:38] ℹ️    - Diagnosis 6: 'osteoporosis'
[13:11:38] ℹ️  Final extracted MRN: 'MA250502105601'
[13:11:38] ℹ️  Final extracted Sex: 'FEMALE'
[13:11:38] ℹ️  Final extracted Service Line: 'PT'
[13:11:38] ℹ️  Final extracted Payer Source: ''
[13:11:38] ✅ Patient data extraction completed successfully
[13:11:38] ✅    ✅ Patient data extracted successfully
[13:11:38] 📊 Patient Response
     └─ patientFName: Jane
     └─ patientLName: Barros
     └─ dob: 10/08/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250502105601
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/01/2025', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': 's/p right shoulder arthroplasty with biceps tendesis', 'secondDiagnosis': 'gait instability', 'thirdDiagnosis': 'IDA', 'fourthDiagnosis': 'asthma', 'fifthDiagnosis': 'systemic lupus erythematous', 'sixthDiagnosis': 'osteoporosis'}]
[13:11:38] ✅    ✅ Patient identified: Jane Barros
[13:11:38] ✅    ✅ Patient name validation passed
[13:11:38] 🔄 
🔄 Step 3: Processing patient dates...
[13:11:38] [DOC: 9320608] ℹ️  DOB normalized: 10/08/1956
[13:11:38] [DOC: 9320608] ℹ️  Episode startOfCare normalized: 05/01/2025
[13:11:38] [DOC: 9320608] ℹ️  Episode startOfEpisode normalized: 05/01/2025
[13:11:38] [DOC: 9320608] ℹ️  Episode endOfEpisode normalized: 07/01/2025
[13:11:38] [DOC: 9320608] ✅ Patient date processing completed successfully
[13:11:38] ✅    ✅ Date processing completed
[13:11:38] 📊 Processed Patient Data
     └─ patientFName: Jane
     └─ patientLName: Barros
     └─ dob: 10/08/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250502105601
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/01/2025', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': 's/p right shoulder arthroplasty with biceps tendesis', 'secondDiagnosis': 'gait instability', 'thirdDiagnosis': 'IDA', 'fourthDiagnosis': 'asthma', 'fifthDiagnosis': 'systemic lupus erythematous', 'sixthDiagnosis': 'osteoporosis'}]
[13:11:38] 🔄 
🔄 Step 4: Extracting order data...
[13:11:40] ℹ️  Order extraction - MRN: 'MA250502105601'
[13:11:40] ℹ️  Order extraction - Sex: 'FEMALE'
[13:11:40] ℹ️  Order extraction - Service Line: 'PT'
[13:11:40] ℹ️  Order extraction - Payer Source: ''
[13:11:40] ✅ Order data extraction completed successfully
[13:11:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:11:40] ℹ️  Using MRN from patient data: 'MA250502105601' over 'MA250502105601'
[13:11:40] ℹ️  Service line consistent in both sources: 'PT'
[13:11:40] ✅ Patient name cross-validation successful
[13:11:40] ✅    ✅ Data merged successfully
[13:11:42] ⚠️     ❌ Skipping - missing episode start date
[13:11:42] [DOC: 9320608] ℹ️  API push details saved for document 9320608
================================================================================
║                        Processing Document ID: 9320462                         ║
================================================================================
[13:11:42] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:11:42] ℹ️  Date: 05/30/2025
[13:11:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:11:44] [DOC: 9320462] ✅ Text extracted using pdfplumber (12440 chars)
[13:11:44] ✅    ✅ Text extracted using pdfplumber (12440 chars)
[13:11:44] 🔄 
🔄 Step 2: Extracting patient data...
[13:11:47] ℹ️  AI extracted raw sex value: 'F'
[13:11:47] ℹ️  AI extracted service line: 'PT'
[13:11:47] ℹ️  AI extracted payer source: ''
[13:11:47] ℹ️  AI extracted diagnoses:
[13:11:47] ℹ️    - Diagnosis 1: ''
[13:11:47] ℹ️    - Diagnosis 2: ''
[13:11:47] ℹ️    - Diagnosis 3: ''
[13:11:47] ℹ️    - Diagnosis 4: ''
[13:11:47] ℹ️    - Diagnosis 5: ''
[13:11:47] ℹ️    - Diagnosis 6: ''
[13:11:47] ℹ️  Final extracted MRN: 'MA250130025704'
[13:11:47] ℹ️  Final extracted Sex: 'FEMALE'
[13:11:47] ℹ️  Final extracted Service Line: 'PT'
[13:11:47] ℹ️  Final extracted Payer Source: ''
[13:11:47] ✅ Patient data extraction completed successfully
[13:11:47] ✅    ✅ Patient data extracted successfully
[13:11:47] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '06/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:11:47] ✅    ✅ Patient identified: Theresa Racine
[13:11:47] ✅    ✅ Patient name validation passed
[13:11:47] 🔄 
🔄 Step 3: Processing patient dates...
[13:11:47] [DOC: 9320462] ℹ️  DOB normalized: 02/10/1957
[13:11:47] [DOC: 9320462] ℹ️  Episode endOfEpisode normalized: 06/27/2025
[13:11:47] [DOC: 9320462] ✅ Patient date processing completed successfully
[13:11:47] ✅    ✅ Date processing completed
[13:11:47] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '06/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:11:47] 🔄 
🔄 Step 4: Extracting order data...
[13:11:50] ℹ️  Order extraction - MRN: 'MA250130025704'
[13:11:50] ℹ️  Order extraction - Sex: 'FEMALE'
[13:11:50] ℹ️  Order extraction - Service Line: 'PT'
[13:11:50] ℹ️  Order extraction - Payer Source: ''
[13:11:50] ✅ Order data extraction completed successfully
[13:11:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:11:50] ℹ️  Using MRN from patient data: 'MA250130025704' over 'MA250130025704'
[13:11:50] ℹ️  Service line consistent in both sources: 'PT'
[13:11:50] ✅ Patient name cross-validation successful
[13:11:50] ✅    ✅ Data merged successfully
[13:11:51] ✅    ✅ Order data extracted and validated
[13:11:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:11:51] [DOC: 9320462] ✅ Patient found in local cache: Theresa Racine, ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[13:11:51] ✅    ✅ Existing patient found with ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[13:11:51] 🔄 
🔄 Step 6: Pushing order to API...
[13:11:51] [DOC: 9320462] ℹ️  Pushing order via API for patient ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[13:11:52] [DOC: 9320462] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:11:52] ❌    ❌ Failed to push order
[13:11:52] 🔄 
🔄 Step 7: Writing to CSV...
[13:11:52] [DOC: 9320462] ℹ️  Calculated age: 68 from DOB: 02/10/1957
[13:11:52] [DOC: 9320462] ℹ️  Service Line extracted: 'PT'
[13:11:52] [DOC: 9320462] ℹ️  Payer Source extracted: ''
[13:11:52] [DOC: 9320462] ℹ️  Diagnosis codes being written:
[13:11:52] [DOC: 9320462] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:11:52] [DOC: 9320462] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:11:52] [DOC: 9320462] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:11:52] [DOC: 9320462] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:11:52] [DOC: 9320462] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:11:52] [DOC: 9320462] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:11:52] [DOC: 9320462] ✅ Patient data written to CSV: Theresa Racine | Sex: FEMALE | Age: 68 | Service: PT | Payer:  | MRN: MA250130025704
[13:11:52] ✅    ✅ Document 9320462 processed and saved successfully
[13:11:52] 🔄 
🔄 Step 8: Saving API details...
[13:11:52] [DOC: 9320462] ℹ️  API push details saved for document 9320462
[13:11:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320461                         ║
================================================================================
[13:11:52] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:11:52] ℹ️  Date: 05/30/2025
[13:11:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:11:55] [DOC: 9320461] ✅ Text extracted using pdfplumber (1090 chars)
[13:11:55] ✅    ✅ Text extracted using pdfplumber (1090 chars)
[13:11:55] 🔄 
🔄 Step 2: Extracting patient data...
[13:11:58] ℹ️  AI extracted raw sex value: ''
[13:11:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:11:58] ℹ️  AI extracted payer source: ''
[13:11:58] ℹ️  AI extracted diagnoses:
[13:11:58] ℹ️    - Diagnosis 1: 'E11.65'
[13:11:58] ℹ️    - Diagnosis 2: 'I10'
[13:11:58] ℹ️    - Diagnosis 3: 'H54.8'
[13:11:58] ℹ️    - Diagnosis 4: 'None'
[13:11:58] ℹ️    - Diagnosis 5: 'None'
[13:11:58] ℹ️    - Diagnosis 6: 'None'
[13:11:58] ℹ️  Final extracted MRN: 'MA210907053505'
[13:11:58] ℹ️  Final extracted Sex: ''
[13:11:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:11:58] ℹ️  Final extracted Payer Source: ''
[13:11:58] ✅ Patient data extraction completed successfully
[13:11:58] ✅    ✅ Patient data extracted successfully
[13:11:58] 📊 Patient Response
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/13/2025', 'endOfEpisode': '07/11/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:11:58] ✅    ✅ Patient identified: Rolande Morrell
[13:11:58] ✅    ✅ Patient name validation passed
[13:11:58] 🔄 
🔄 Step 3: Processing patient dates...
[13:11:58] [DOC: 9320461] ℹ️  DOB normalized: 05/15/1935
[13:11:58] [DOC: 9320461] ℹ️  Episode startOfEpisode normalized: 05/13/2025
[13:11:58] [DOC: 9320461] ℹ️  Episode endOfEpisode normalized: 07/11/2025
[13:11:58] [DOC: 9320461] ✅ Patient date processing completed successfully
[13:11:58] ✅    ✅ Date processing completed
[13:11:58] 📊 Processed Patient Data
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/13/2025', 'endOfEpisode': '07/11/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8'}]
[13:11:58] 🔄 
🔄 Step 4: Extracting order data...
[13:12:00] ℹ️  Order extraction - MRN: 'MA210907053505'
[13:12:00] ℹ️  Order extraction - Sex: ''
[13:12:00] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:12:00] ℹ️  Order extraction - Payer Source: ''
[13:12:00] ✅ Order data extraction completed successfully
[13:12:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:12:00] ℹ️  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[13:12:00] ⚠️  Could not determine sex using any available method
[13:12:00] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:12:00] ✅ Patient name cross-validation successful
[13:12:00] ✅    ✅ Data merged successfully
[13:12:01] ✅    ✅ Order data extracted and validated
[13:12:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:12:01] [DOC: 9320461] ✅ Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[13:12:01] ✅    ✅ Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[13:12:01] 🔄 
🔄 Step 6: Pushing order to API...
[13:12:01] [DOC: 9320461] ℹ️  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[13:12:03] [DOC: 9320461] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18939"}
[13:12:03] ❌    ❌ Failed to push order
[13:12:03] 🔄 
🔄 Step 7: Writing to CSV...
[13:12:03] [DOC: 9320461] ℹ️  Calculated age: 90 from DOB: 05/15/1935
[13:12:03] [DOC: 9320461] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:12:03] [DOC: 9320461] ℹ️  Payer Source extracted: ''
[13:12:03] [DOC: 9320461] ℹ️  Diagnosis codes being written:
[13:12:03] [DOC: 9320461] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[13:12:03] [DOC: 9320461] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[13:12:03] [DOC: 9320461] ℹ️    - Latest_Episode_Thirddiagnosis: 'H54.8'
[13:12:03] [DOC: 9320461] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:12:03] [DOC: 9320461] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:12:03] [DOC: 9320461] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:12:03] [DOC: 9320461] ✅ Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: Skilled Nursing | Payer:  | MRN: MA210907053505
[13:12:03] ✅    ✅ Document 9320461 processed and saved successfully
[13:12:03] 🔄 
🔄 Step 8: Saving API details...
[13:12:03] [DOC: 9320461] ℹ️  API push details saved for document 9320461
[13:12:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9319489                         ║
================================================================================
[13:12:03] ℹ️  Agency: Dartmouth HH
[13:12:03] ℹ️  Date: 05/30/2025
[13:12:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:12:06] [DOC: 9319489] ✅ Text extracted using pdfplumber (11283 chars)
[13:12:06] ✅    ✅ Text extracted using pdfplumber (11283 chars)
[13:12:06] 🔄 
🔄 Step 2: Extracting patient data...
[13:12:09] ℹ️  AI extracted raw sex value: 'F'
[13:12:09] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[13:12:09] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[13:12:09] ℹ️  AI extracted diagnoses:
[13:12:09] ℹ️    - Diagnosis 1: 'J18.9'
[13:12:09] ℹ️    - Diagnosis 2: 'J90'
[13:12:09] ℹ️    - Diagnosis 3: 'I48.0'
[13:12:09] ℹ️    - Diagnosis 4: 'G93.40'
[13:12:09] ℹ️    - Diagnosis 5: 'I13.0'
[13:12:09] ℹ️    - Diagnosis 6: 'I50.30'
[13:12:09] ℹ️  Final extracted MRN: '2485015'
[13:12:09] ℹ️  Final extracted Sex: 'FEMALE'
[13:12:09] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[13:12:09] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[13:12:09] ✅ Patient data extraction completed successfully
[13:12:09] ✅    ✅ Patient data extracted successfully
[13:12:09] 📊 Patient Response
     └─ patientFName: Lynne
     └─ patientLName: Chase
     └─ dob: 11/21/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2485015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '05/01/2025', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'J90', 'thirdDiagnosis': 'I48.0', 'fourthDiagnosis': 'G93.40', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.30'}]
[13:12:09] ✅    ✅ Patient identified: Lynne Chase
[13:12:09] ✅    ✅ Patient name validation passed
[13:12:09] 🔄 
🔄 Step 3: Processing patient dates...
[13:12:09] [DOC: 9319489] ℹ️  DOB normalized: 11/21/1946
[13:12:09] [DOC: 9319489] ℹ️  Episode startOfCare normalized: 05/01/2025
[13:12:09] [DOC: 9319489] ℹ️  Episode startOfEpisode normalized: 05/01/2025
[13:12:09] [DOC: 9319489] ℹ️  Episode endOfEpisode normalized: 06/29/2025
[13:12:09] [DOC: 9319489] ✅ Patient date processing completed successfully
[13:12:09] ✅    ✅ Date processing completed
[13:12:09] 📊 Processed Patient Data
     └─ patientFName: Lynne
     └─ patientLName: Chase
     └─ dob: 11/21/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2485015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '05/01/2025', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'J90', 'thirdDiagnosis': 'I48.0', 'fourthDiagnosis': 'G93.40', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.30'}]
[13:12:09] 🔄 
🔄 Step 4: Extracting order data...
[13:12:11] ℹ️  Order extraction - MRN: ''
[13:12:11] ℹ️  Order extraction - Sex: 'FEMALE'
[13:12:11] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:12:11] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[13:12:11] ✅ Order data extraction completed successfully
[13:12:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:12:11] ℹ️  Using MRN from patient data: '2485015'
[13:12:11] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT' + Order='Skilled Nursing' = 'OT, PT, Skilled Nursing'
[13:12:11] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[13:12:11] ✅ Patient name cross-validation successful
[13:12:11] ✅    ✅ Data merged successfully
[13:12:13] ✅    ✅ Order data extracted and validated
[13:12:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:12:19] [DOC: 9319489] ℹ️  Patient not found in cache or API: Lynne Chase
[13:12:19] [DOC: 9319489] ℹ️  Patient not found, creating new patient via API...
[13:12:19] [DOC: 9319489] ℹ️  Creating patient via API: Lynne Chase
[13:12:20] [DOC: 9319489] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:12:20] ❌    ❌ Failed to create patient
[13:12:20] [DOC: 9319489] ℹ️  API push details saved for document 9319489
================================================================================
║                        Processing Document ID: 9319021                         ║
================================================================================
[13:12:20] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:12:20] ℹ️  Date: 05/30/2025
[13:12:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:12:23] [DOC: 9319021] ✅ Text extracted using pdfplumber (12666 chars)
[13:12:23] ✅    ✅ Text extracted using pdfplumber (12666 chars)
[13:12:23] 🔄 
🔄 Step 2: Extracting patient data...
[13:12:26] ℹ️  AI extracted raw sex value: 'M'
[13:12:26] ℹ️  AI extracted service line: 'OT'
[13:12:26] ℹ️  AI extracted payer source: 'None'
[13:12:26] ℹ️  AI extracted diagnoses:
[13:12:26] ℹ️    - Diagnosis 1: 'Right Femur ORIF'
[13:12:26] ℹ️    - Diagnosis 2: 'muscle weakness'
[13:12:26] ℹ️    - Diagnosis 3: 'None'
[13:12:26] ℹ️    - Diagnosis 4: 'None'
[13:12:26] ℹ️    - Diagnosis 5: 'None'
[13:12:26] ℹ️    - Diagnosis 6: 'None'
[13:12:26] ℹ️  Final extracted MRN: 'MA250324024402'
[13:12:26] ℹ️  Final extracted Sex: 'MALE'
[13:12:26] ℹ️  Final extracted Service Line: 'OT'
[13:12:26] ℹ️  Final extracted Payer Source: ''
[13:12:26] ✅ Patient data extraction completed successfully
[13:12:26] ✅    ✅ Patient data extracted successfully
[13:12:26] 📊 Patient Response
     └─ patientFName: Ronald
     └─ patientLName: Ferreira
     └─ dob: 02/01/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250324024402
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/01/2025', 'endOfEpisode': None, 'firstDiagnosis': 'Right Femur ORIF', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:12:26] ✅    ✅ Patient identified: Ronald Ferreira
[13:12:26] ✅    ✅ Patient name validation passed
[13:12:26] 🔄 
🔄 Step 3: Processing patient dates...
[13:12:26] [DOC: 9319021] ℹ️  DOB normalized: 02/01/1944
[13:12:26] [DOC: 9319021] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[13:12:26] [DOC: 9319021] ✅ Patient date processing completed successfully
[13:12:26] ✅    ✅ Date processing completed
[13:12:26] 📊 Processed Patient Data
     └─ patientFName: Ronald
     └─ patientLName: Ferreira
     └─ dob: 02/01/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250324024402
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'firstDiagnosis': 'Right Femur ORIF', 'secondDiagnosis': 'muscle weakness'}]
[13:12:26] 🔄 
🔄 Step 4: Extracting order data...
[13:12:29] ℹ️  Order extraction - MRN: 'MA250324024402'
[13:12:29] ℹ️  Order extraction - Sex: 'MALE'
[13:12:29] ℹ️  Order extraction - Service Line: 'OT'
[13:12:29] ℹ️  Order extraction - Payer Source: ''
[13:12:29] ✅ Order data extraction completed successfully
[13:12:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:12:29] ℹ️  Using MRN from patient data: 'MA250324024402' over 'MA250324024402'
[13:12:29] ℹ️  Service line consistent in both sources: 'OT'
[13:12:29] ✅ Patient name cross-validation successful
[13:12:29] ✅    ✅ Data merged successfully
[13:12:30] ⚠️     ❌ Skipping - missing episode start date
[13:12:30] [DOC: 9319021] ℹ️  API push details saved for document 9319021
================================================================================
║                        Processing Document ID: 9318996                         ║
================================================================================
[13:12:30] ℹ️  Agency: Dartmouth HH
[13:12:30] ℹ️  Date: 05/30/2025
[13:12:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:12:32] [DOC: 9318996] ✅ Text extracted using pdfplumber (1669 chars)
[13:12:32] ✅    ✅ Text extracted using pdfplumber (1669 chars)
[13:12:32] 🔄 
🔄 Step 2: Extracting patient data...
[13:12:34] ℹ️  AI extracted raw sex value: 'M'
[13:12:34] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:12:34] ℹ️  AI extracted payer source: 'Medicare'
[13:12:34] ℹ️  AI extracted diagnoses:
[13:12:34] ℹ️    - Diagnosis 1: ''
[13:12:34] ℹ️    - Diagnosis 2: ''
[13:12:34] ℹ️    - Diagnosis 3: ''
[13:12:34] ℹ️    - Diagnosis 4: ''
[13:12:34] ℹ️    - Diagnosis 5: ''
[13:12:34] ℹ️    - Diagnosis 6: ''
[13:12:34] ℹ️  Final extracted MRN: '6836011'
[13:12:34] ℹ️  Final extracted Sex: 'MALE'
[13:12:34] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:12:34] ℹ️  Final extracted Payer Source: 'Medicare'
[13:12:34] ✅ Patient data extraction completed successfully
[13:12:34] ✅    ✅ Patient data extracted successfully
[13:12:34] 📊 Patient Response
     └─ patientFName: Thomas
     └─ patientLName: Imbeau
     └─ dob: 11/15/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 6836011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/06/2025', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:12:34] ✅    ✅ Patient identified: Thomas Imbeau
[13:12:34] ✅    ✅ Patient name validation passed
[13:12:34] 🔄 
🔄 Step 3: Processing patient dates...
[13:12:34] [DOC: 9318996] ℹ️  DOB normalized: 11/15/1950
[13:12:34] [DOC: 9318996] ℹ️  Episode startOfCare normalized: 05/06/2025
[13:12:34] [DOC: 9318996] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[13:12:34] [DOC: 9318996] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[13:12:34] [DOC: 9318996] ✅ Patient date processing completed successfully
[13:12:34] ✅    ✅ Date processing completed
[13:12:34] 📊 Processed Patient Data
     └─ patientFName: Thomas
     └─ patientLName: Imbeau
     └─ dob: 11/15/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 6836011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/06/2025', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:12:34] 🔄 
🔄 Step 4: Extracting order data...
[13:12:37] ℹ️  Order extraction - MRN: ''
[13:12:37] ℹ️  Order extraction - Sex: 'MALE'
[13:12:37] ℹ️  Order extraction - Service Line: 'RN'
[13:12:37] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:12:37] ✅ Order data extraction completed successfully
[13:12:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:12:37] ℹ️  Using MRN from patient data: '6836011'
[13:12:37] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[13:12:37] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:12:37] ✅ Patient name cross-validation successful
[13:12:37] ✅    ✅ Data merged successfully
[13:12:38] ✅    ✅ Order data extracted and validated
[13:12:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:12:44] [DOC: 9318996] ✅ Patient exists in API: Thomas Imbeau, ID: f981bb19-b873-4e8d-8d19-a01d2ed7868e
[13:12:44] ✅    ✅ Existing patient found with ID: f981bb19-b873-4e8d-8d19-a01d2ed7868e
[13:12:44] 🔄 
🔄 Step 6: Pushing order to API...
[13:12:44] [DOC: 9318996] ℹ️  Pushing order via API for patient ID: f981bb19-b873-4e8d-8d19-a01d2ed7868e
[13:12:45] [DOC: 9318996] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:12:45] ❌    ❌ Failed to push order
[13:12:45] 🔄 
🔄 Step 7: Writing to CSV...
[13:12:45] [DOC: 9318996] ℹ️  Calculated age: 74 from DOB: 11/15/1950
[13:12:45] [DOC: 9318996] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[13:12:45] [DOC: 9318996] ℹ️  Payer Source extracted: 'Medicare'
[13:12:45] [DOC: 9318996] ℹ️  Diagnosis codes being written:
[13:12:45] [DOC: 9318996] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:12:45] [DOC: 9318996] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:12:45] [DOC: 9318996] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:12:45] [DOC: 9318996] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:12:45] [DOC: 9318996] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:12:45] [DOC: 9318996] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:12:45] [DOC: 9318996] ✅ Patient data written to CSV: Thomas Imbeau | Sex: MALE | Age: 74 | Service: RN, Skilled Nursing | Payer: Medicare | MRN: 6836011
[13:12:45] ✅    ✅ Document 9318996 processed and saved successfully
[13:12:45] 🔄 
🔄 Step 8: Saving API details...
[13:12:45] [DOC: 9318996] ℹ️  API push details saved for document 9318996
[13:12:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9318976                         ║
================================================================================
[13:12:45] ℹ️  Agency: Dartmouth HH
[13:12:45] ℹ️  Date: 05/30/2025
[13:12:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:12:47] [DOC: 9318976] ✅ Text extracted using pdfplumber (1068 chars)
[13:12:47] ✅    ✅ Text extracted using pdfplumber (1068 chars)
[13:12:47] 🔄 
🔄 Step 2: Extracting patient data...
[13:12:49] ℹ️  AI extracted raw sex value: 'F'
[13:12:49] ℹ️  AI extracted service line: 'HHA'
[13:12:49] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[13:12:49] ℹ️  AI extracted diagnoses:
[13:12:49] ℹ️    - Diagnosis 1: ''
[13:12:49] ℹ️    - Diagnosis 2: ''
[13:12:49] ℹ️    - Diagnosis 3: ''
[13:12:49] ℹ️    - Diagnosis 4: ''
[13:12:49] ℹ️    - Diagnosis 5: ''
[13:12:49] ℹ️    - Diagnosis 6: ''
[13:12:49] ℹ️  Final extracted MRN: '2485015'
[13:12:49] ℹ️  Final extracted Sex: 'FEMALE'
[13:12:49] ℹ️  Final extracted Service Line: 'HHA'
[13:12:49] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[13:12:49] ✅ Patient data extraction completed successfully
[13:12:49] ✅    ✅ Patient data extracted successfully
[13:12:49] 📊 Patient Response
     └─ patientFName: Lynne
     └─ patientLName: Chase
     └─ dob: 11/21/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2485015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '05/01/2025', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:12:49] ✅    ✅ Patient identified: Lynne Chase
[13:12:49] ✅    ✅ Patient name validation passed
[13:12:49] 🔄 
🔄 Step 3: Processing patient dates...
[13:12:49] [DOC: 9318976] ℹ️  DOB normalized: 11/21/1946
[13:12:49] [DOC: 9318976] ℹ️  Episode startOfCare normalized: 05/01/2025
[13:12:49] [DOC: 9318976] ℹ️  Episode startOfEpisode normalized: 05/01/2025
[13:12:49] [DOC: 9318976] ℹ️  Episode endOfEpisode normalized: 06/29/2025
[13:12:49] [DOC: 9318976] ✅ Patient date processing completed successfully
[13:12:49] ✅    ✅ Date processing completed
[13:12:49] 📊 Processed Patient Data
     └─ patientFName: Lynne
     └─ patientLName: Chase
     └─ dob: 11/21/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2485015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '05/01/2025', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '06/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:12:49] 🔄 
🔄 Step 4: Extracting order data...
[13:12:52] ℹ️  Order extraction - MRN: '2485015'
[13:12:52] ℹ️  Order extraction - Sex: 'FEMALE'
[13:12:52] ℹ️  Order extraction - Service Line: 'HHA'
[13:12:52] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[13:12:52] ✅ Order data extraction completed successfully
[13:12:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:12:52] ℹ️  Using MRN from patient data: '2485015' over '2485015'
[13:12:52] ℹ️  Service line consistent in both sources: 'HHA'
[13:12:52] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[13:12:52] ✅ Patient name cross-validation successful
[13:12:52] ✅    ✅ Data merged successfully
[13:12:53] ✅    ✅ Order data extracted and validated
[13:12:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:13:09] [DOC: 9318976] ℹ️  Patient not found in cache or API: Lynne Chase
[13:13:09] [DOC: 9318976] ℹ️  Patient not found, creating new patient via API...
[13:13:09] [DOC: 9318976] ℹ️  Creating patient via API: Lynne Chase
[13:13:10] [DOC: 9318976] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:13:10] ❌    ❌ Failed to create patient
[13:13:10] [DOC: 9318976] ℹ️  API push details saved for document 9318976
================================================================================
║                        Processing Document ID: 9318975                         ║
================================================================================
[13:13:10] ℹ️  Agency: Dartmouth HH
[13:13:10] ℹ️  Date: 05/30/2025
[13:13:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:13:13] [DOC: 9318975] ✅ Text extracted using pdfplumber (1076 chars)
[13:13:13] ✅    ✅ Text extracted using pdfplumber (1076 chars)
[13:13:13] 🔄 
🔄 Step 2: Extracting patient data...
[13:13:15] ℹ️  AI extracted raw sex value: 'F'
[13:13:15] ℹ️  AI extracted service line: 'RN'
[13:13:15] ℹ️  AI extracted payer source: 'Medicare'
[13:13:15] ℹ️  AI extracted diagnoses:
[13:13:15] ℹ️    - Diagnosis 1: 'None'
[13:13:15] ℹ️    - Diagnosis 2: 'None'
[13:13:15] ℹ️    - Diagnosis 3: 'None'
[13:13:15] ℹ️    - Diagnosis 4: 'None'
[13:13:15] ℹ️    - Diagnosis 5: 'None'
[13:13:15] ℹ️    - Diagnosis 6: 'None'
[13:13:15] ℹ️  Final extracted MRN: '6650011'
[13:13:15] ℹ️  Final extracted Sex: 'FEMALE'
[13:13:15] ℹ️  Final extracted Service Line: 'RN'
[13:13:15] ℹ️  Final extracted Payer Source: 'Medicare'
[13:13:15] ✅ Patient data extraction completed successfully
[13:13:15] ✅    ✅ Patient data extracted successfully
[13:13:15] 📊 Patient Response
     └─ patientFName: Lorraine
     └─ patientLName: Blais
     └─ dob: 09/07/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6650011
     └─ billingProvider: Jahn A Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/08/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:13:15] ✅    ✅ Patient identified: Lorraine Blais
[13:13:15] ✅    ✅ Patient name validation passed
[13:13:15] 🔄 
🔄 Step 3: Processing patient dates...
[13:13:15] [DOC: 9318975] ℹ️  DOB normalized: 09/07/1941
[13:13:15] [DOC: 9318975] ℹ️  Episode startOfCare normalized: 05/08/2025
[13:13:15] [DOC: 9318975] ℹ️  Episode startOfEpisode normalized: 05/08/2025
[13:13:15] [DOC: 9318975] ℹ️  Episode endOfEpisode normalized: 07/06/2025
[13:13:15] [DOC: 9318975] ✅ Patient date processing completed successfully
[13:13:15] ✅    ✅ Date processing completed
[13:13:15] 📊 Processed Patient Data
     └─ patientFName: Lorraine
     └─ patientLName: Blais
     └─ dob: 09/07/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6650011
     └─ billingProvider: Jahn A Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/08/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025'}]
[13:13:15] 🔄 
🔄 Step 4: Extracting order data...
[13:13:18] ℹ️  Order extraction - MRN: ''
[13:13:18] ℹ️  Order extraction - Sex: 'FEMALE'
[13:13:18] ℹ️  Order extraction - Service Line: 'RN'
[13:13:18] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:13:18] ✅ Order data extraction completed successfully
[13:13:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:13:18] ℹ️  Using MRN from patient data: '6650011'
[13:13:18] ℹ️  Service line consistent in both sources: 'RN'
[13:13:18] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:13:18] ✅ Patient name cross-validation successful
[13:13:18] ✅    ✅ Data merged successfully
[13:13:19] ✅    ✅ Order data extracted and validated
[13:13:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:13:35] [DOC: 9318975] ✅ Patient exists in API: Lorraine Blais, ID: 52bacf05-b07c-491b-b93a-b81420861a03
[13:13:35] ✅    ✅ Existing patient found with ID: 52bacf05-b07c-491b-b93a-b81420861a03
[13:13:35] 🔄 
🔄 Step 6: Pushing order to API...
[13:13:35] [DOC: 9318975] ℹ️  Pushing order via API for patient ID: 52bacf05-b07c-491b-b93a-b81420861a03
[13:13:36] [DOC: 9318975] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16407"}
[13:13:36] ❌    ❌ Failed to push order
[13:13:36] 🔄 
🔄 Step 7: Writing to CSV...
[13:13:36] [DOC: 9318975] ℹ️  Calculated age: 83 from DOB: 09/07/1941
[13:13:36] [DOC: 9318975] ℹ️  Service Line extracted: 'RN'
[13:13:36] [DOC: 9318975] ℹ️  Payer Source extracted: 'Medicare'
[13:13:36] [DOC: 9318975] ℹ️  Diagnosis codes being written:
[13:13:36] [DOC: 9318975] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:13:36] [DOC: 9318975] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:13:36] [DOC: 9318975] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:13:36] [DOC: 9318975] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:13:36] [DOC: 9318975] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:13:36] [DOC: 9318975] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:13:36] [DOC: 9318975] ✅ Patient data written to CSV: Lorraine Blais | Sex: FEMALE | Age: 83 | Service: RN | Payer: Medicare | MRN: 6650011
[13:13:36] ✅    ✅ Document 9318975 processed and saved successfully
[13:13:36] 🔄 
🔄 Step 8: Saving API details...
[13:13:36] [DOC: 9318975] ℹ️  API push details saved for document 9318975
[13:13:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9317616                         ║
================================================================================
[13:13:36] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[13:13:36] ℹ️  Date: 05/29/2025
[13:13:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:13:41] [DOC: 9317616] ✅ Text extracted using pdfplumber (6488 chars)
[13:13:41] ✅    ✅ Text extracted using pdfplumber (6488 chars)
[13:13:41] 🔄 
🔄 Step 2: Extracting patient data...
[13:13:44] ℹ️  AI extracted raw sex value: 'F'
[13:13:44] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:13:44] ℹ️  AI extracted payer source: ''
[13:13:44] ℹ️  AI extracted diagnoses:
[13:13:44] ℹ️    - Diagnosis 1: 'F31.10'
[13:13:44] ℹ️    - Diagnosis 2: 'F41.1'
[13:13:44] ℹ️    - Diagnosis 3: 'E11.40'
[13:13:44] ℹ️    - Diagnosis 4: 'I10'
[13:13:44] ℹ️    - Diagnosis 5: 'E66.01'
[13:13:44] ℹ️    - Diagnosis 6: 'M17.0'
[13:13:44] ℹ️  Final extracted MRN: '253005'
[13:13:44] ℹ️  Final extracted Sex: 'FEMALE'
[13:13:44] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:13:44] ℹ️  Final extracted Payer Source: ''
[13:13:44] ✅ Patient data extraction completed successfully
[13:13:44] ✅    ✅ Patient data extracted successfully
[13:13:44] 📊 Patient Response
     └─ patientFName: N/A
     └─ patientLName: N/A
     └─ dob: 04/22/1971
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 253005
     └─ billingProvider: Fernandes, Versana
     └─ npi: 227504
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/16/2021', 'startOfEpisode': '12/16/2021', 'endOfEpisode': '07/27/2025', 'firstDiagnosis': 'F31.10', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E66.01', 'sixthDiagnosis': 'M17.0'}]
[13:13:44] ✅    ✅ Patient identified: N/A N/A
[13:13:44] ✅    ✅ Patient name validation passed
[13:13:44] 🔄 
🔄 Step 3: Processing patient dates...
[13:13:44] [DOC: 9317616] ℹ️  DOB normalized: 04/22/1971
[13:13:44] [DOC: 9317616] ℹ️  Episode startOfCare normalized: 12/16/2021
[13:13:44] [DOC: 9317616] ℹ️  Episode startOfEpisode normalized: 12/16/2021
[13:13:44] [DOC: 9317616] ℹ️  Episode endOfEpisode normalized: 07/27/2025
[13:13:44] [DOC: 9317616] ✅ Patient date processing completed successfully
[13:13:44] ✅    ✅ Date processing completed
[13:13:44] 📊 Processed Patient Data
     └─ patientFName: N/A
     └─ patientLName: N/A
     └─ dob: 04/22/1971
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 253005
     └─ billingProvider: Fernandes, Versana
     └─ npi: 227504
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/16/2021', 'startOfEpisode': '12/16/2021', 'endOfEpisode': '07/27/2025', 'firstDiagnosis': 'F31.10', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E66.01', 'sixthDiagnosis': 'M17.0'}]
[13:13:44] 🔄 
🔄 Step 4: Extracting order data...
[13:13:47] ℹ️  Order extraction - MRN: '253005'
[13:13:47] ℹ️  Order extraction - Sex: 'FEMALE'
[13:13:47] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[13:13:47] ℹ️  Order extraction - Payer Source: ''
[13:13:47] ✅ Order data extraction completed successfully
[13:13:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:13:47] ℹ️  Using MRN from patient data: '253005' over '253005'
[13:13:47] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy' + Order='Skilled Nursing, PT, OT' = 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[13:13:47] ⚠️  Patient name mismatch: Order='Fernandes, Versana' vs Patient='N/A N/A'
[13:13:47] ✅    ✅ Data merged successfully
[13:13:48] ✅    ✅ Order data extracted and validated
[13:13:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:13:53] [DOC: 9317616] ✅ Patient exists in API: N/A N/A, ID: e9629652-0bca-412d-8c30-df4a73e9513b
[13:13:53] ✅    ✅ Existing patient found with ID: e9629652-0bca-412d-8c30-df4a73e9513b
[13:13:53] 🔄 
🔄 Step 6: Pushing order to API...
[13:13:53] [DOC: 9317616] ℹ️  Pushing order via API for patient ID: e9629652-0bca-412d-8c30-df4a73e9513b
[13:13:55] [DOC: 9317616] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13975"}
[13:13:55] ❌    ❌ Failed to push order
[13:13:55] 🔄 
🔄 Step 7: Writing to CSV...
[13:13:55] [DOC: 9317616] ℹ️  Calculated age: 54 from DOB: 04/22/1971
[13:13:55] [DOC: 9317616] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[13:13:55] [DOC: 9317616] ℹ️  Payer Source extracted: ''
[13:13:55] [DOC: 9317616] ℹ️  Diagnosis codes being written:
[13:13:55] [DOC: 9317616] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.10'
[13:13:55] [DOC: 9317616] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.1'
[13:13:55] [DOC: 9317616] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.40'
[13:13:55] [DOC: 9317616] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[13:13:55] [DOC: 9317616] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E66.01'
[13:13:55] [DOC: 9317616] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M17.0'
[13:13:55] [DOC: 9317616] ✅ Patient data written to CSV: N/A N/A | Sex: FEMALE | Age: 54 | Service: OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 253005
[13:13:55] ✅    ✅ Document 9317616 processed and saved successfully
[13:13:55] 🔄 
🔄 Step 8: Saving API details...
[13:13:55] [DOC: 9317616] ℹ️  API push details saved for document 9317616
[13:13:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9317475                         ║
================================================================================
[13:13:55] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[13:13:55] ℹ️  Date: 05/29/2025
[13:13:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:13:57] [DOC: 9317475] ✅ Text extracted using pdfplumber (1470 chars)
[13:13:57] ✅    ✅ Text extracted using pdfplumber (1470 chars)
[13:13:57] 🔄 
🔄 Step 2: Extracting patient data...
[13:14:00] ℹ️  AI extracted raw sex value: 'M'
[13:14:00] ℹ️  AI extracted service line: 'RN'
[13:14:00] ℹ️  AI extracted payer source: 'Senior Whole Health'
[13:14:00] ℹ️  AI extracted diagnoses:
[13:14:00] ℹ️    - Diagnosis 1: 'None'
[13:14:00] ℹ️    - Diagnosis 2: 'None'
[13:14:00] ℹ️    - Diagnosis 3: 'None'
[13:14:00] ℹ️    - Diagnosis 4: 'None'
[13:14:00] ℹ️    - Diagnosis 5: 'None'
[13:14:00] ℹ️    - Diagnosis 6: 'None'
[13:14:00] ℹ️  Final extracted MRN: '84005'
[13:14:00] ℹ️  Final extracted Sex: 'MALE'
[13:14:00] ℹ️  Final extracted Service Line: 'RN'
[13:14:00] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[13:14:00] ✅ Patient data extraction completed successfully
[13:14:00] ✅    ✅ Patient data extracted successfully
[13:14:00] 📊 Patient Response
     └─ patientFName: Gerald
     └─ patientLName: Mello
     └─ dob: 01/09/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 84005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '08/06/2020', 'startOfEpisode': None, 'endOfEpisode': '07/10/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:14:00] ✅    ✅ Patient identified: Gerald Mello
[13:14:00] ✅    ✅ Patient name validation passed
[13:14:00] 🔄 
🔄 Step 3: Processing patient dates...
[13:14:00] [DOC: 9317475] ℹ️  DOB normalized: 01/09/1941
[13:14:00] [DOC: 9317475] ℹ️  Episode startOfCare normalized: 08/06/2020
[13:14:00] [DOC: 9317475] ℹ️  Episode endOfEpisode normalized: 07/10/2025
[13:14:00] [DOC: 9317475] ✅ Patient date processing completed successfully
[13:14:00] ✅    ✅ Date processing completed
[13:14:00] 📊 Processed Patient Data
     └─ patientFName: Gerald
     └─ patientLName: Mello
     └─ dob: 01/09/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 84005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '08/06/2020', 'endOfEpisode': '07/10/2025'}]
[13:14:00] 🔄 
🔄 Step 4: Extracting order data...
[13:14:02] ℹ️  Order extraction - MRN: '84005'
[13:14:02] ℹ️  Order extraction - Sex: 'MALE'
[13:14:02] ℹ️  Order extraction - Service Line: ''
[13:14:02] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[13:14:02] ✅ Order data extraction completed successfully
[13:14:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:14:02] ℹ️  Using MRN from patient data: '84005' over '84005'
[13:14:02] ℹ️  Using service line from patient data: 'RN'
[13:14:02] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[13:14:02] ✅ Patient name cross-validation successful
[13:14:02] ✅    ✅ Data merged successfully
[13:14:03] ✅    ✅ Order data extracted and validated
[13:14:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:14:09] [DOC: 9317475] ℹ️  Patient not found in cache or API: Gerald Mello
[13:14:09] [DOC: 9317475] ℹ️  Patient not found, creating new patient via API...
[13:14:09] [DOC: 9317475] ℹ️  Creating patient via API: Gerald Mello
[13:14:10] [DOC: 9317475] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:14:10] ❌    ❌ Failed to create patient
[13:14:10] [DOC: 9317475] ℹ️  API push details saved for document 9317475
================================================================================
║                        Processing Document ID: 9317463                         ║
================================================================================
[13:14:10] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[13:14:10] ℹ️  Date: 05/29/2025
[13:14:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:14:13] [DOC: 9317463] ✅ Text extracted using pdfplumber (1390 chars)
[13:14:13] ✅    ✅ Text extracted using pdfplumber (1390 chars)
[13:14:13] 🔄 
🔄 Step 2: Extracting patient data...
[13:14:16] ℹ️  AI extracted raw sex value: 'M'
[13:14:16] ℹ️  AI extracted service line: 'HHA'
[13:14:16] ℹ️  AI extracted payer source: 'Medicaid/MA'
[13:14:16] ℹ️  AI extracted diagnoses:
[13:14:16] ℹ️    - Diagnosis 1: ''
[13:14:16] ℹ️    - Diagnosis 2: ''
[13:14:16] ℹ️    - Diagnosis 3: ''
[13:14:16] ℹ️    - Diagnosis 4: ''
[13:14:16] ℹ️    - Diagnosis 5: ''
[13:14:16] ℹ️    - Diagnosis 6: ''
[13:14:16] ℹ️  Final extracted MRN: '457'
[13:14:16] ℹ️  Final extracted Sex: 'MALE'
[13:14:16] ℹ️  Final extracted Service Line: 'HHA'
[13:14:16] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[13:14:16] ✅ Patient data extraction completed successfully
[13:14:16] ✅    ✅ Patient data extracted successfully
[13:14:16] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2024', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:14:16] ✅    ✅ Patient identified: Manuel Varela
[13:14:16] ✅    ✅ Patient name validation passed
[13:14:16] 🔄 
🔄 Step 3: Processing patient dates...
[13:14:16] [DOC: 9317463] ℹ️  DOB normalized: 02/08/1969
[13:14:16] [DOC: 9317463] ℹ️  Episode startOfCare normalized: 11/07/2024
[13:14:16] [DOC: 9317463] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[13:14:16] [DOC: 9317463] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[13:14:16] [DOC: 9317463] ✅ Patient date processing completed successfully
[13:14:16] ✅    ✅ Date processing completed
[13:14:16] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2024', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:14:16] 🔄 
🔄 Step 4: Extracting order data...
[13:14:18] ℹ️  Order extraction - MRN: '457'
[13:14:18] ℹ️  Order extraction - Sex: 'MALE'
[13:14:18] ℹ️  Order extraction - Service Line: 'HHA'
[13:14:18] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[13:14:18] ✅ Order data extraction completed successfully
[13:14:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:14:18] ℹ️  Using MRN from patient data: '457' over '457'
[13:14:18] ℹ️  Service line consistent in both sources: 'HHA'
[13:14:18] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[13:14:18] ✅ Patient name cross-validation successful
[13:14:18] ✅    ✅ Data merged successfully
[13:14:20] ✅    ✅ Order data extracted and validated
[13:14:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:14:25] [DOC: 9317463] ✅ Patient exists in API: Manuel Varela, ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[13:14:25] ✅    ✅ Existing patient found with ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[13:14:25] 🔄 
🔄 Step 6: Pushing order to API...
[13:14:25] [DOC: 9317463] ℹ️  Pushing order via API for patient ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[13:14:26] [DOC: 9317463] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14373"}
[13:14:26] ❌    ❌ Failed to push order
[13:14:26] 🔄 
🔄 Step 7: Writing to CSV...
[13:14:26] [DOC: 9317463] ℹ️  Calculated age: 56 from DOB: 02/08/1969
[13:14:26] [DOC: 9317463] ℹ️  Service Line extracted: 'HHA'
[13:14:26] [DOC: 9317463] ℹ️  Payer Source extracted: 'Medicaid/MA'
[13:14:26] [DOC: 9317463] ℹ️  Diagnosis codes being written:
[13:14:26] [DOC: 9317463] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:14:26] [DOC: 9317463] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:14:26] [DOC: 9317463] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:14:26] [DOC: 9317463] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:14:26] [DOC: 9317463] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:14:26] [DOC: 9317463] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:14:26] [DOC: 9317463] ✅ Patient data written to CSV: Manuel Varela | Sex: MALE | Age: 56 | Service: HHA | Payer: Medicaid/MA | MRN: 457
[13:14:26] ✅    ✅ Document 9317463 processed and saved successfully
[13:14:26] 🔄 
🔄 Step 8: Saving API details...
[13:14:26] [DOC: 9317463] ℹ️  API push details saved for document 9317463
[13:14:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9317403                         ║
================================================================================
[13:14:26] ℹ️  Agency: Nizhoni Health Systems-Somerville
[13:14:26] ℹ️  Date: 05/29/2025
[13:14:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:14:30] [DOC: 9317403] ✅ Text extracted using pdfplumber (11090 chars)
[13:14:30] ✅    ✅ Text extracted using pdfplumber (11090 chars)
[13:14:30] 🔄 
🔄 Step 2: Extracting patient data...
[13:14:33] ℹ️  AI extracted raw sex value: 'F'
[13:14:33] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:14:33] ℹ️  AI extracted payer source: 'None'
[13:14:33] ℹ️  AI extracted diagnoses:
[13:14:33] ℹ️    - Diagnosis 1: 'F31.9'
[13:14:33] ℹ️    - Diagnosis 2: 'F20.9'
[13:14:33] ℹ️    - Diagnosis 3: 'G80.9'
[13:14:33] ℹ️    - Diagnosis 4: 'I10'
[13:14:33] ℹ️    - Diagnosis 5: 'F41.1'
[13:14:33] ℹ️    - Diagnosis 6: 'E06.3'
[13:14:33] ℹ️  Final extracted MRN: '17207020'
[13:14:33] ℹ️  Final extracted Sex: 'FEMALE'
[13:14:33] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:14:33] ℹ️  Final extracted Payer Source: ''
[13:14:33] ✅ Patient data extraction completed successfully
[13:14:33] ✅    ✅ Patient data extracted successfully
[13:14:33] 📊 Patient Response
     └─ patientFName: Tammy
     └─ patientLName: Alves
     └─ dob: 04/30/1981
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 17207020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100000511244
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '07/23/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'F20.9', 'thirdDiagnosis': 'G80.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'F41.1', 'sixthDiagnosis': 'E06.3'}]
[13:14:33] ✅    ✅ Patient identified: Tammy Alves
[13:14:33] ✅    ✅ Patient name validation passed
[13:14:33] 🔄 
🔄 Step 3: Processing patient dates...
[13:14:33] [DOC: 9317403] ℹ️  DOB normalized: 04/30/1981
[13:14:33] [DOC: 9317403] ℹ️  Episode startOfCare normalized: 03/26/2025
[13:14:33] [DOC: 9317403] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[13:14:33] [DOC: 9317403] ℹ️  Episode endOfEpisode normalized: 07/23/2025
[13:14:33] [DOC: 9317403] ✅ Patient date processing completed successfully
[13:14:33] ✅    ✅ Date processing completed
[13:14:33] 📊 Processed Patient Data
     └─ patientFName: Tammy
     └─ patientLName: Alves
     └─ dob: 04/30/1981
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 17207020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100000511244
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '07/23/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'F20.9', 'thirdDiagnosis': 'G80.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'F41.1', 'sixthDiagnosis': 'E06.3'}]
[13:14:33] 🔄 
🔄 Step 4: Extracting order data...
[13:14:36] ℹ️  Order extraction - MRN: '17207020'
[13:14:36] ℹ️  Order extraction - Sex: 'FEMALE'
[13:14:36] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:14:36] ℹ️  Order extraction - Payer Source: ''
[13:14:36] ✅ Order data extraction completed successfully
[13:14:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:14:36] ℹ️  Using MRN from patient data: '17207020' over '17207020'
[13:14:36] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:14:36] ✅ Patient name cross-validation successful
[13:14:36] ✅    ✅ Data merged successfully
[13:14:37] ✅    ✅ Order data extracted and validated
[13:14:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:14:42] [DOC: 9317403] ✅ Patient exists in API: Tammy Alves, ID: b762ac43-5719-4426-a8a1-b93c8317b643
[13:14:42] ✅    ✅ Existing patient found with ID: b762ac43-5719-4426-a8a1-b93c8317b643
[13:14:42] 🔄 
🔄 Step 6: Pushing order to API...
[13:14:42] [DOC: 9317403] ℹ️  Pushing order via API for patient ID: b762ac43-5719-4426-a8a1-b93c8317b643
[13:14:43] [DOC: 9317403] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:14:43] ❌    ❌ Failed to push order
[13:14:43] 🔄 
🔄 Step 7: Writing to CSV...
[13:14:43] [DOC: 9317403] ℹ️  Calculated age: 44 from DOB: 04/30/1981
[13:14:43] [DOC: 9317403] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:14:43] [DOC: 9317403] ℹ️  Payer Source extracted: ''
[13:14:43] [DOC: 9317403] ℹ️  Diagnosis codes being written:
[13:14:43] [DOC: 9317403] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.9'
[13:14:43] [DOC: 9317403] ℹ️    - Latest_Episode_Seconddiagnosis: 'F20.9'
[13:14:43] [DOC: 9317403] ℹ️    - Latest_Episode_Thirddiagnosis: 'G80.9'
[13:14:43] [DOC: 9317403] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[13:14:43] [DOC: 9317403] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.1'
[13:14:43] [DOC: 9317403] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E06.3'
[13:14:43] [DOC: 9317403] ✅ Patient data written to CSV: Tammy Alves | Sex: FEMALE | Age: 44 | Service: Skilled Nursing | Payer:  | MRN: 17207020
[13:14:43] ✅    ✅ Document 9317403 processed and saved successfully
[13:14:43] 🔄 
🔄 Step 8: Saving API details...
[13:14:43] [DOC: 9317403] ℹ️  API push details saved for document 9317403
[13:14:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9317297                         ║
================================================================================
[13:14:43] ℹ️  Agency: All At Home Health Care-Allston
[13:14:43] ℹ️  Date: 05/29/2025
[13:14:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:14:45] [DOC: 9317297] ✅ Text extracted using pdfplumber (2138 chars)
[13:14:45] ✅    ✅ Text extracted using pdfplumber (2138 chars)
[13:14:45] 🔄 
🔄 Step 2: Extracting patient data...
[13:14:48] ℹ️  AI extracted raw sex value: ''
[13:14:48] ℹ️  AI extracted service line: ''
[13:14:48] ℹ️  AI extracted payer source: ''
[13:14:48] ℹ️  AI extracted diagnoses:
[13:14:48] ℹ️    - Diagnosis 1: ''
[13:14:48] ℹ️    - Diagnosis 2: ''
[13:14:48] ℹ️    - Diagnosis 3: ''
[13:14:48] ℹ️    - Diagnosis 4: ''
[13:14:48] ℹ️    - Diagnosis 5: ''
[13:14:48] ℹ️    - Diagnosis 6: ''
[13:14:48] ℹ️  Final extracted MRN: ''
[13:14:48] ℹ️  Final extracted Sex: ''
[13:14:48] ℹ️  Final extracted Service Line: ''
[13:14:48] ℹ️  Final extracted Payer Source: ''
[13:14:48] ✅ Patient data extraction completed successfully
[13:14:48] ✅    ✅ Patient data extracted successfully
[13:14:48] 📊 Patient Response
     └─ patientFName: Luz
     └─ patientLName: Torres
     └─ dob: 11/23/1943
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: All At Home Health Care
     └─ npi: 1720386378
     └─ physicianNPI: 1982269205
     └─ nameOfAgency: All At Home Health Care
     └─ address: 531 Faunce Corner Road
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: olsa.rusha@allathomehealth.com
     └─ phoneNumber: (617) 782-9900
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/20/2025', 'startOfEpisode': '05/20/2025', 'endOfEpisode': '07/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:14:48] ✅    ✅ Patient identified: Luz Torres
[13:14:48] ✅    ✅ Patient name validation passed
[13:14:48] 🔄 
🔄 Step 3: Processing patient dates...
[13:14:48] [DOC: 9317297] ℹ️  DOB normalized: 11/23/1943
[13:14:48] [DOC: 9317297] ℹ️  Episode startOfCare normalized: 05/20/2025
[13:14:48] [DOC: 9317297] ℹ️  Episode startOfEpisode normalized: 05/20/2025
[13:14:48] [DOC: 9317297] ℹ️  Episode endOfEpisode normalized: 07/18/2025
[13:14:48] [DOC: 9317297] ✅ Patient date processing completed successfully
[13:14:48] ✅    ✅ Date processing completed
[13:14:48] 📊 Processed Patient Data
     └─ patientFName: Luz
     └─ patientLName: Torres
     └─ dob: 11/23/1943
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: All At Home Health Care
     └─ npi: 1720386378
     └─ physicianNPI: 1982269205
     └─ nameOfAgency: All At Home Health Care
     └─ address: 531 Faunce Corner Road
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: olsa.rusha@allathomehealth.com
     └─ phoneNumber: (617) 782-9900
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/20/2025', 'startOfEpisode': '05/20/2025', 'endOfEpisode': '07/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:14:48] 🔄 
🔄 Step 4: Extracting order data...
[13:14:50] ℹ️  Order extraction - MRN: ''
[13:14:50] ℹ️  Order extraction - Sex: ''
[13:14:50] ℹ️  Order extraction - Service Line: ''
[13:14:50] ℹ️  Order extraction - Payer Source: ''
[13:14:50] ✅ Order data extraction completed successfully
[13:14:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:14:50] ⚠️  No MRN found in either patient or order data
[13:14:50] ⚠️  Could not determine sex using any available method
[13:14:50] ✅ Patient name cross-validation successful
[13:14:50] ✅    ✅ Data merged successfully
[13:14:51] ✅    ✅ Order data extracted and validated
[13:14:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:14:58] [DOC: 9317297] ✅ Patient exists in API: Luz Torres, ID: 21f878bf-d0a3-4ae7-861f-eaee35edbc3e
[13:14:58] ✅    ✅ Existing patient found with ID: 21f878bf-d0a3-4ae7-861f-eaee35edbc3e
[13:14:58] 🔄 
🔄 Step 6: Pushing order to API...
[13:14:58] [DOC: 9317297] ℹ️  Pushing order via API for patient ID: 21f878bf-d0a3-4ae7-861f-eaee35edbc3e
[13:14:59] [DOC: 9317297] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:14:59] ❌    ❌ Failed to push order
[13:14:59] 🔄 
🔄 Step 7: Writing to CSV...
[13:14:59] [DOC: 9317297] ℹ️  Calculated age: 81 from DOB: 11/23/1943
[13:14:59] [DOC: 9317297] ℹ️  Service Line extracted: ''
[13:14:59] [DOC: 9317297] ℹ️  Payer Source extracted: ''
[13:14:59] [DOC: 9317297] ℹ️  Diagnosis codes being written:
[13:14:59] [DOC: 9317297] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:14:59] [DOC: 9317297] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:14:59] [DOC: 9317297] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:14:59] [DOC: 9317297] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:14:59] [DOC: 9317297] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:14:59] [DOC: 9317297] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:14:59] [DOC: 9317297] ✅ Patient data written to CSV: Luz Torres | Sex:  | Age: 81 | Service:  | Payer:  | MRN: 
[13:14:59] ✅    ✅ Document 9317297 processed and saved successfully
[13:14:59] 🔄 
🔄 Step 8: Saving API details...
[13:14:59] [DOC: 9317297] ℹ️  API push details saved for document 9317297
[13:14:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9317289                         ║
================================================================================
[13:14:59] ℹ️  Agency: All At Home Health Care-Allston
[13:14:59] ℹ️  Date: 05/29/2025
[13:14:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:15:02] [DOC: 9317289] ✅ Text extracted using pdfplumber (17985 chars)
[13:15:02] ✅    ✅ Text extracted using pdfplumber (17985 chars)
[13:15:02] 🔄 
🔄 Step 2: Extracting patient data...
[13:15:06] ℹ️  AI extracted raw sex value: 'M'
[13:15:06] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[13:15:06] ℹ️  AI extracted payer source: ''
[13:15:06] ℹ️  AI extracted diagnoses:
[13:15:06] ℹ️    - Diagnosis 1: 'Z47.1'
[13:15:06] ℹ️    - Diagnosis 2: 'I10'
[13:15:06] ℹ️    - Diagnosis 3: 'K29.70'
[13:15:06] ℹ️    - Diagnosis 4: 'Z96.651'
[13:15:06] ℹ️    - Diagnosis 5: 'Z79.82'
[13:15:06] ℹ️    - Diagnosis 6: ''
[13:15:06] ℹ️  Final extracted MRN: '1828'
[13:15:06] ℹ️  Final extracted Sex: 'MALE'
[13:15:06] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[13:15:06] ℹ️  Final extracted Payer Source: ''
[13:15:06] ✅ Patient data extraction completed successfully
[13:15:06] ✅    ✅ Patient data extracted successfully
[13:15:06] 📊 Patient Response
     └─ patientFName: Luz
     └─ patientLName: Torres
     └─ dob: 11/23/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 1828
     └─ billingProvider: All At Home Health Care
     └─ npi: 1720386378
     └─ physicianNPI: 1982269205
     └─ nameOfAgency: All At Home Health Care
     └─ address: 65 Armsby St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 287-3705
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/20/2025', 'startOfEpisode': '05/20/2025', 'endOfEpisode': '07/18/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'K29.70', 'fourthDiagnosis': 'Z96.651', 'fifthDiagnosis': 'Z79.82', 'sixthDiagnosis': ''}]
[13:15:06] ✅    ✅ Patient identified: Luz Torres
[13:15:06] ✅    ✅ Patient name validation passed
[13:15:06] 🔄 
🔄 Step 3: Processing patient dates...
[13:15:06] [DOC: 9317289] ℹ️  DOB normalized: 11/23/1943
[13:15:06] [DOC: 9317289] ℹ️  Episode startOfCare normalized: 05/20/2025
[13:15:06] [DOC: 9317289] ℹ️  Episode startOfEpisode normalized: 05/20/2025
[13:15:06] [DOC: 9317289] ℹ️  Episode endOfEpisode normalized: 07/18/2025
[13:15:06] [DOC: 9317289] ✅ Patient date processing completed successfully
[13:15:06] ✅    ✅ Date processing completed
[13:15:06] 📊 Processed Patient Data
     └─ patientFName: Luz
     └─ patientLName: Torres
     └─ dob: 11/23/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 1828
     └─ billingProvider: All At Home Health Care
     └─ npi: 1720386378
     └─ physicianNPI: 1982269205
     └─ nameOfAgency: All At Home Health Care
     └─ address: 65 Armsby St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 287-3705
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/20/2025', 'startOfEpisode': '05/20/2025', 'endOfEpisode': '07/18/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'K29.70', 'fourthDiagnosis': 'Z96.651', 'fifthDiagnosis': 'Z79.82', 'sixthDiagnosis': ''}]
[13:15:06] 🔄 
🔄 Step 4: Extracting order data...
[13:15:08] ℹ️  Order extraction - MRN: '1828'
[13:15:08] ℹ️  Order extraction - Sex: 'MALE'
[13:15:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[13:15:08] ℹ️  Order extraction - Payer Source: ''
[13:15:08] ✅ Order data extraction completed successfully
[13:15:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:15:08] ℹ️  Using MRN from patient data: '1828' over '1828'
[13:15:08] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[13:15:08] ✅ Patient name cross-validation successful
[13:15:08] ✅    ✅ Data merged successfully
[13:15:10] ✅    ✅ Order data extracted and validated
[13:15:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:15:10] [DOC: 9317289] ✅ Patient found in local cache: Luz Torres, ID: 21f878bf-d0a3-4ae7-861f-eaee35edbc3e
[13:15:10] ✅    ✅ Existing patient found with ID: 21f878bf-d0a3-4ae7-861f-eaee35edbc3e
[13:15:10] 🔄 
🔄 Step 6: Pushing order to API...
[13:15:10] [DOC: 9317289] ℹ️  Pushing order via API for patient ID: 21f878bf-d0a3-4ae7-861f-eaee35edbc3e
[13:15:11] [DOC: 9317289] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:15:11] ❌    ❌ Failed to push order
[13:15:11] 🔄 
🔄 Step 7: Writing to CSV...
[13:15:11] [DOC: 9317289] ℹ️  Calculated age: 81 from DOB: 11/23/1943
[13:15:11] [DOC: 9317289] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[13:15:11] [DOC: 9317289] ℹ️  Payer Source extracted: ''
[13:15:11] [DOC: 9317289] ℹ️  Diagnosis codes being written:
[13:15:11] [DOC: 9317289] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[13:15:11] [DOC: 9317289] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[13:15:11] [DOC: 9317289] ℹ️    - Latest_Episode_Thirddiagnosis: 'K29.70'
[13:15:11] [DOC: 9317289] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Z96.651'
[13:15:11] [DOC: 9317289] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z79.82'
[13:15:11] [DOC: 9317289] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:15:11] [DOC: 9317289] ✅ Patient data written to CSV: Luz Torres | Sex: MALE | Age: 81 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 1828
[13:15:11] ✅    ✅ Document 9317289 processed and saved successfully
[13:15:11] 🔄 
🔄 Step 8: Saving API details...
[13:15:11] [DOC: 9317289] ℹ️  API push details saved for document 9317289
[13:15:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9317008                         ║
================================================================================
[13:15:11] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[13:15:11] ℹ️  Date: 05/29/2025
[13:15:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:15:14] [DOC: 9317008] ✅ Text extracted using pdfplumber (2953 chars)
[13:15:14] ✅    ✅ Text extracted using pdfplumber (2953 chars)
[13:15:14] 🔄 
🔄 Step 2: Extracting patient data...
[13:15:17] ℹ️  AI extracted raw sex value: 'F'
[13:15:17] ℹ️  AI extracted service line: 'PT'
[13:15:17] ℹ️  AI extracted payer source: 'Medicaid/MA'
[13:15:17] ℹ️  AI extracted diagnoses:
[13:15:17] ℹ️    - Diagnosis 1: ''
[13:15:17] ℹ️    - Diagnosis 2: ''
[13:15:17] ℹ️    - Diagnosis 3: ''
[13:15:17] ℹ️    - Diagnosis 4: ''
[13:15:17] ℹ️    - Diagnosis 5: ''
[13:15:17] ℹ️    - Diagnosis 6: ''
[13:15:17] ℹ️  Final extracted MRN: '1005'
[13:15:17] ℹ️  Final extracted Sex: 'FEMALE'
[13:15:17] ℹ️  Final extracted Service Line: 'PT'
[13:15:17] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[13:15:17] ✅ Patient data extraction completed successfully
[13:15:17] ✅    ✅ Patient data extracted successfully
[13:15:17] 📊 Patient Response
     └─ patientFName: Christina
     └─ patientLName: Bosworth
     └─ dob: 07/02/1990
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: PT
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '08/17/2022', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:15:17] ✅    ✅ Patient identified: Christina Bosworth
[13:15:17] ✅    ✅ Patient name validation passed
[13:15:17] 🔄 
🔄 Step 3: Processing patient dates...
[13:15:17] [DOC: 9317008] ℹ️  DOB normalized: 07/02/1990
[13:15:17] [DOC: 9317008] ℹ️  Episode startOfCare normalized: 08/17/2022
[13:15:17] [DOC: 9317008] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[13:15:17] [DOC: 9317008] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[13:15:17] [DOC: 9317008] ✅ Patient date processing completed successfully
[13:15:17] ✅    ✅ Date processing completed
[13:15:17] 📊 Processed Patient Data
     └─ patientFName: Christina
     └─ patientLName: Bosworth
     └─ dob: 07/02/1990
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1005
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: PT
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '08/17/2022', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:15:17] 🔄 
🔄 Step 4: Extracting order data...
[13:15:19] ℹ️  Order extraction - MRN: '1005'
[13:15:19] ℹ️  Order extraction - Sex: 'FEMALE'
[13:15:19] ℹ️  Order extraction - Service Line: 'PT'
[13:15:19] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[13:15:19] ✅ Order data extraction completed successfully
[13:15:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:15:19] ℹ️  Using MRN from patient data: '1005' over '1005'
[13:15:19] ℹ️  Service line consistent in both sources: 'PT'
[13:15:19] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[13:15:19] ✅ Patient name cross-validation successful
[13:15:19] ✅    ✅ Data merged successfully
[13:15:20] ✅    ✅ Order data extracted and validated
[13:15:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:15:28] [DOC: 9317008] ✅ Patient exists in API: Christina Bosworth, ID: 189e87b4-7506-4371-aa11-46e767bb1879
[13:15:28] ✅    ✅ Existing patient found with ID: 189e87b4-7506-4371-aa11-46e767bb1879
[13:15:28] 🔄 
🔄 Step 6: Pushing order to API...
[13:15:28] [DOC: 9317008] ℹ️  Pushing order via API for patient ID: 189e87b4-7506-4371-aa11-46e767bb1879
[13:15:29] [DOC: 9317008] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:15:29] ❌    ❌ Failed to push order
[13:15:29] 🔄 
🔄 Step 7: Writing to CSV...
[13:15:29] [DOC: 9317008] ℹ️  Calculated age: 34 from DOB: 07/02/1990
[13:15:29] [DOC: 9317008] ℹ️  Service Line extracted: 'PT'
[13:15:29] [DOC: 9317008] ℹ️  Payer Source extracted: 'Medicaid/MA'
[13:15:29] [DOC: 9317008] ℹ️  Diagnosis codes being written:
[13:15:29] [DOC: 9317008] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:15:29] [DOC: 9317008] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:15:29] [DOC: 9317008] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:15:29] [DOC: 9317008] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:15:29] [DOC: 9317008] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:15:29] [DOC: 9317008] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:15:29] [DOC: 9317008] ✅ Patient data written to CSV: Christina Bosworth | Sex: FEMALE | Age: 34 | Service: PT | Payer: Medicaid/MA | MRN: 1005
[13:15:29] ✅    ✅ Document 9317008 processed and saved successfully
[13:15:29] 🔄 
🔄 Step 8: Saving API details...
[13:15:29] [DOC: 9317008] ℹ️  API push details saved for document 9317008
[13:15:29] ✅    ✅ API details saved
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[13:15:29] ℹ️  Total Processed: 49
[13:15:29] ℹ️  CSV Success: 28
[13:15:29] ℹ️  CSV Errors: 4
[13:15:29] ℹ️  API Success: 0
[13:15:29] ℹ️  API Errors: 45
[13:15:29] ℹ️  CSV Success Rate: 57.1%
[13:15:29] ℹ️  API Success Rate: 0.0%
[13:15:29] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250607_125021.csv
[13:15:29] ℹ️  API Details File: api_outputs/api_push_details_20250607_125021.csv
================================================================================
║          ============================================================          ║
================================================================================
