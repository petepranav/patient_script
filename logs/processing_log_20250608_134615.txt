================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[13:46:15] ℹ️  CSV Data Extraction & API Push Tool
[13:46:15] ℹ️  
[13:46:15] ℹ️  Features:
[13:46:15] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[13:46:15] ℹ️  - AI-powered patient and order data extraction
[13:46:15] ℹ️  - Enhanced error handling and logging
[13:46:15] ℹ️  - Full API integration (patient creation + order pushing)
[13:46:15] ℹ️  - CSV output with comprehensive patient data
[13:46:15] ℹ️  - Detailed API tracking with remarks for every document
[13:46:15] ℹ️  - Complete audit trail of all processing attempts
[13:46:15] ℹ️  
[13:46:15] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[13:46:15] ✅ Created output CSV file: csv_outputs/extracted_patients_20250608_134615.csv
[13:46:15] ✅ Created API details CSV file: api_outputs/api_push_details_20250608_134615.csv
================================================================================
║                        Processing Document ID: 9234415                         ║
================================================================================
[13:46:15] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[13:46:15] ℹ️  Date: 04/10/2025
[13:46:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:46:19] [DOC: 9234415] ✅ Text extracted using pdfplumber (15375 chars)
[13:46:19] ✅    ✅ Text extracted using pdfplumber (15363 chars)
[13:46:19] 🔄 
🔄 Step 2: Extracting patient data...
[13:46:22] ℹ️  AI extracted raw sex value: ''
[13:46:22] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:46:22] ℹ️  AI extracted payer source: 'Medicare'
[13:46:22] ℹ️  AI extracted diagnoses:
[13:46:22] ℹ️    - Diagnosis 1: 'E87.1'
[13:46:22] ℹ️    - Diagnosis 2: 'E11.621'
[13:46:22] ℹ️    - Diagnosis 3: 'L97.522'
[13:46:22] ℹ️    - Diagnosis 4: 'E11.51'
[13:46:22] ℹ️    - Diagnosis 5: 'I70.203'
[13:46:22] ℹ️    - Diagnosis 6: 'E11.42'
[13:46:22] ℹ️  Final extracted MRN: '28700205798601'
[13:46:22] ℹ️  Final extracted Sex: ''
[13:46:22] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:46:22] ℹ️  Final extracted Payer Source: 'Medicare'
[13:46:22] ✅ Patient data extraction completed successfully
[13:46:22] ✅    ✅ Patient data extracted successfully
[13:46:22] 📊 Patient Response
     └─ patientFName: LIGIA
     └─ patientLName: SOUSA
     └─ dob: 10/29/1950
     └─ patientSex: 
     └─ medicalRecordNo: 28700205798601
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '04/04/2025', 'firstDiagnosis': 'E87.1', 'secondDiagnosis': 'E11.621', 'thirdDiagnosis': 'L97.522', 'fourthDiagnosis': 'E11.51', 'fifthDiagnosis': 'I70.203', 'sixthDiagnosis': 'E11.42'}]
[13:46:22] ✅    ✅ Patient identified: LIGIA SOUSA
[13:46:22] ✅    ✅ Patient name validation passed
[13:46:22] 🔄 
🔄 Step 3: Processing patient dates...
[13:46:22] [DOC: 9234415] ℹ️  DOB normalized: 10/29/1950
[13:46:22] [DOC: 9234415] ℹ️  Episode startOfCare normalized: 04/05/2025
[13:46:22] [DOC: 9234415] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[13:46:22] [DOC: 9234415] ℹ️  Episode endOfEpisode normalized: 04/04/2025
[13:46:22] [DOC: 9234415] ✅ Patient date processing completed successfully
[13:46:22] ✅    ✅ Date processing completed
[13:46:22] 📊 Processed Patient Data
     └─ patientFName: LIGIA
     └─ patientLName: SOUSA
     └─ dob: 10/29/1950
     └─ patientSex: 
     └─ medicalRecordNo: 28700205798601
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/05/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '04/04/2025', 'firstDiagnosis': 'E87.1', 'secondDiagnosis': 'E11.621', 'thirdDiagnosis': 'L97.522', 'fourthDiagnosis': 'E11.51', 'fifthDiagnosis': 'I70.203', 'sixthDiagnosis': 'E11.42'}]
[13:46:22] 🔄 
🔄 Step 4: Extracting order data...
[13:46:25] ℹ️  Order extraction - MRN: '28700205798601'
[13:46:25] ℹ️  Order extraction - Sex: ''
[13:46:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:46:25] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:46:25] ✅ Order data extraction completed successfully
[13:46:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:46:25] ℹ️  Using MRN from patient data: '28700205798601' over '28700205798601'
[13:46:25] ⚠️  Could not determine sex using any available method
[13:46:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:46:25] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:46:25] ✅ Patient name cross-validation successful
[13:46:25] ✅    ✅ Data merged successfully
[13:46:27] ✅    ✅ Order data extracted and validated
[13:46:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:46:27] [DOC: 9234415] ✅ Patient found in local cache: LIGIA SOUSA, ID: 3afc2e11-631e-42fc-9551-478448edb57d
[13:46:27] ✅    ✅ Existing patient found with ID: 3afc2e11-631e-42fc-9551-478448edb57d
[13:46:27] 🔄 
🔄 Step 6: Pushing order to API...
[13:46:27] [DOC: 9234415] ℹ️  Pushing order via API for patient ID: 3afc2e11-631e-42fc-9551-478448edb57d
[13:46:28] [DOC: 9234415] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14440"}
[13:46:28] ❌    ❌ Failed to push order
[13:46:28] 🔄 
🔄 Step 7: Writing to CSV...
[13:46:28] [DOC: 9234415] ℹ️  Calculated age: 74 from DOB: 10/29/1950
[13:46:28] [DOC: 9234415] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:46:28] [DOC: 9234415] ℹ️  Payer Source extracted: 'Medicare'
[13:46:28] [DOC: 9234415] ℹ️  Diagnosis codes being written:
[13:46:28] [DOC: 9234415] ℹ️    - Latest_Episode_Firstdiagnosis: 'E87.1'
[13:46:28] [DOC: 9234415] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.621'
[13:46:28] [DOC: 9234415] ℹ️    - Latest_Episode_Thirddiagnosis: 'L97.522'
[13:46:28] [DOC: 9234415] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.51'
[13:46:28] [DOC: 9234415] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I70.203'
[13:46:28] [DOC: 9234415] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E11.42'
[13:46:28] [DOC: 9234415] ✅ Patient data written to CSV: LIGIA SOUSA | Sex:  | Age: 74 | Service: Skilled Nursing | Payer: Medicare | MRN: 28700205798601
[13:46:28] ✅    ✅ Document 9234415 processed and saved successfully
[13:46:28] 🔄 
🔄 Step 8: Saving API details...
[13:46:28] [DOC: 9234415] ℹ️  API push details saved for document 9234415
[13:46:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234022                         ║
================================================================================
[13:46:28] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:46:28] ℹ️  Date: 04/10/2025
[13:46:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:46:31] [DOC: 9234022] ✅ Text extracted using pdfplumber (1398 chars)
[13:46:31] ✅    ✅ Text extracted using pdfplumber (1386 chars)
[13:46:31] 🔄 
🔄 Step 2: Extracting patient data...
[13:46:34] ℹ️  AI extracted raw sex value: ''
[13:46:34] ℹ️  AI extracted service line: 'Physical Therapy'
[13:46:34] ℹ️  AI extracted payer source: ''
[13:46:34] ℹ️  AI extracted diagnoses:
[13:46:34] ℹ️    - Diagnosis 1: 'I10'
[13:46:34] ℹ️    - Diagnosis 2: 'I50.30'
[13:46:34] ℹ️    - Diagnosis 3: 'E11.22'
[13:46:34] ℹ️    - Diagnosis 4: ''
[13:46:34] ℹ️    - Diagnosis 5: ''
[13:46:34] ℹ️    - Diagnosis 6: ''
[13:46:34] ℹ️  Final extracted MRN: 'MA250328034304'
[13:46:34] ℹ️  Final extracted Sex: ''
[13:46:34] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:46:34] ℹ️  Final extracted Payer Source: ''
[13:46:34] ✅ Patient data extraction completed successfully
[13:46:34] ✅    ✅ Patient data extracted successfully
[13:46:34] 📊 Patient Response
     └─ patientFName: Frederick
     └─ patientLName: Turner
     └─ dob: 03/05/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA250328034304
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I50.30', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:46:34] ✅    ✅ Patient identified: Frederick Turner
[13:46:34] ✅    ✅ Patient name validation passed
[13:46:34] 🔄 
🔄 Step 3: Processing patient dates...
[13:46:34] [DOC: 9234022] ℹ️  DOB normalized: 03/05/1943
[13:46:34] [DOC: 9234022] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[13:46:34] [DOC: 9234022] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[13:46:34] [DOC: 9234022] ✅ Patient date processing completed successfully
[13:46:34] ✅    ✅ Date processing completed
[13:46:34] 📊 Processed Patient Data
     └─ patientFName: Frederick
     └─ patientLName: Turner
     └─ dob: 03/05/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA250328034304
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I50.30', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:46:34] 🔄 
🔄 Step 4: Extracting order data...
[13:46:36] ℹ️  Order extraction - MRN: 'MA250328034304'
[13:46:36] ℹ️  Order extraction - Sex: ''
[13:46:36] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[13:46:36] ℹ️  Order extraction - Payer Source: ''
[13:46:36] ✅ Order data extraction completed successfully
[13:46:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:46:36] ℹ️  Using MRN from patient data: 'MA250328034304' over 'MA250328034304'
[13:46:36] ⚠️  Could not determine sex using any available method
[13:46:36] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[13:46:36] ✅ Patient name cross-validation successful
[13:46:36] ✅    ✅ Data merged successfully
[13:46:38] ✅    ✅ Order data extracted and validated
[13:46:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:46:38] [DOC: 9234022] ✅ Patient found in local cache: Frederick Turner, ID: fda2b6f0-d47f-42d2-9704-28476b119573
[13:46:38] ✅    ✅ Existing patient found with ID: fda2b6f0-d47f-42d2-9704-28476b119573
[13:46:38] 🔄 
🔄 Step 6: Pushing order to API...
[13:46:38] [DOC: 9234022] ℹ️  Pushing order via API for patient ID: fda2b6f0-d47f-42d2-9704-28476b119573
[13:46:39] [DOC: 9234022] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14249"}
[13:46:39] ❌    ❌ Failed to push order
[13:46:39] 🔄 
🔄 Step 7: Writing to CSV...
[13:46:39] [DOC: 9234022] ℹ️  Calculated age: 82 from DOB: 03/05/1943
[13:46:39] [DOC: 9234022] ℹ️  Service Line extracted: 'Physical Therapy'
[13:46:39] [DOC: 9234022] ℹ️  Payer Source extracted: ''
[13:46:39] [DOC: 9234022] ℹ️  Diagnosis codes being written:
[13:46:39] [DOC: 9234022] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[13:46:39] [DOC: 9234022] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.30'
[13:46:39] [DOC: 9234022] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[13:46:39] [DOC: 9234022] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:46:39] [DOC: 9234022] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:46:39] [DOC: 9234022] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:46:39] [DOC: 9234022] ✅ Patient data written to CSV: Frederick Turner | Sex:  | Age: 82 | Service: Physical Therapy | Payer:  | MRN: MA250328034304
[13:46:39] ✅    ✅ Document 9234022 processed and saved successfully
[13:46:39] 🔄 
🔄 Step 8: Saving API details...
[13:46:39] [DOC: 9234022] ℹ️  API push details saved for document 9234022
[13:46:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233980                         ║
================================================================================
[13:46:39] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:46:39] ℹ️  Date: 04/10/2025
[13:46:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:46:44] [DOC: 9233980] ✅ Text extracted using pdfplumber (12578 chars)
[13:46:44] ✅    ✅ Text extracted using pdfplumber (12578 chars)
[13:46:44] 🔄 
🔄 Step 2: Extracting patient data...
[13:46:47] ℹ️  AI extracted raw sex value: 'F'
[13:46:47] ℹ️  AI extracted service line: 'OT'
[13:46:47] ℹ️  AI extracted payer source: ''
[13:46:47] ℹ️  AI extracted diagnoses:
[13:46:47] ℹ️    - Diagnosis 1: ''
[13:46:47] ℹ️    - Diagnosis 2: ''
[13:46:47] ℹ️    - Diagnosis 3: ''
[13:46:47] ℹ️    - Diagnosis 4: ''
[13:46:47] ℹ️    - Diagnosis 5: ''
[13:46:47] ℹ️    - Diagnosis 6: ''
[13:46:47] ℹ️  Final extracted MRN: 'MA221209055605'
[13:46:47] ℹ️  Final extracted Sex: 'FEMALE'
[13:46:47] ℹ️  Final extracted Service Line: 'OT'
[13:46:47] ℹ️  Final extracted Payer Source: ''
[13:46:47] ✅ Patient data extraction completed successfully
[13:46:47] ✅    ✅ Patient data extracted successfully
[13:46:47] 📊 Patient Response
     └─ patientFName: Connie
     └─ patientLName: Sousa
     └─ dob: 05/23/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221209055605
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Home Health Services
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:46:47] ✅    ✅ Patient identified: Connie Sousa
[13:46:47] ✅    ✅ Patient name validation passed
[13:46:47] 🔄 
🔄 Step 3: Processing patient dates...
[13:46:47] [DOC: 9233980] ℹ️  DOB normalized: 05/23/1956
[13:46:47] [DOC: 9233980] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[13:46:47] [DOC: 9233980] ✅ Patient date processing completed successfully
[13:46:47] ✅    ✅ Date processing completed
[13:46:47] 📊 Processed Patient Data
     └─ patientFName: Connie
     └─ patientLName: Sousa
     └─ dob: 05/23/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221209055605
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Home Health Services
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:46:47] 🔄 
🔄 Step 4: Extracting order data...
[13:46:50] ℹ️  Order extraction - MRN: 'MA221209055605'
[13:46:50] ℹ️  Order extraction - Sex: 'FEMALE'
[13:46:50] ℹ️  Order extraction - Service Line: 'OT'
[13:46:50] ℹ️  Order extraction - Payer Source: ''
[13:46:50] ✅ Order data extraction completed successfully
[13:46:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:46:50] ℹ️  Using MRN from patient data: 'MA221209055605' over 'MA221209055605'
[13:46:50] ℹ️  Service line consistent in both sources: 'OT'
[13:46:50] ✅ Patient name cross-validation successful
[13:46:50] ✅    ✅ Data merged successfully
[13:46:51] ✅    ✅ Order data extracted and validated
[13:46:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:47:14] [DOC: 9233980] ℹ️  Patient not found in cache or API: Connie Sousa
[13:47:14] [DOC: 9233980] ℹ️  Patient not found, creating new patient via API...
[13:47:14] [DOC: 9233980] ℹ️  Creating patient via API: Connie Sousa
[13:47:15] [DOC: 9233980] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:47:15] ❌    ❌ Failed to create patient
[13:47:15] [DOC: 9233980] ℹ️  API push details saved for document 9233980
================================================================================
║                        Processing Document ID: 9233969                         ║
================================================================================
[13:47:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:47:15] ℹ️  Date: 04/10/2025
[13:47:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:47:17] [DOC: 9233969] ✅ Text extracted using pdfplumber (2425 chars)
[13:47:17] ✅    ✅ Text extracted using pdfplumber (2413 chars)
[13:47:17] 🔄 
🔄 Step 2: Extracting patient data...
[13:47:20] ℹ️  AI extracted raw sex value: ''
[13:47:20] ℹ️  AI extracted service line: 'Physical Therapy'
[13:47:20] ℹ️  AI extracted payer source: ''
[13:47:20] ℹ️  AI extracted diagnoses:
[13:47:20] ℹ️    - Diagnosis 1: 'S32.501'
[13:47:20] ℹ️    - Diagnosis 2: 'S52.022'
[13:47:20] ℹ️    - Diagnosis 3: 'M48.061'
[13:47:20] ℹ️    - Diagnosis 4: 'None'
[13:47:20] ℹ️    - Diagnosis 5: 'None'
[13:47:20] ℹ️    - Diagnosis 6: 'None'
[13:47:20] ℹ️  Final extracted MRN: 'MA221116116005'
[13:47:20] ℹ️  Final extracted Sex: ''
[13:47:20] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:47:20] ℹ️  Final extracted Payer Source: ''
[13:47:20] ✅ Patient data extraction completed successfully
[13:47:20] ✅    ✅ Patient data extracted successfully
[13:47:20] 📊 Patient Response
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'S32.501', 'secondDiagnosis': 'S52.022', 'thirdDiagnosis': 'M48.061', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:47:20] ✅    ✅ Patient identified: Kelly Medeiros
[13:47:20] ✅    ✅ Patient name validation passed
[13:47:20] 🔄 
🔄 Step 3: Processing patient dates...
[13:47:20] [DOC: 9233969] ℹ️  DOB normalized: 11/23/1960
[13:47:20] [DOC: 9233969] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[13:47:20] [DOC: 9233969] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[13:47:20] [DOC: 9233969] ✅ Patient date processing completed successfully
[13:47:20] ✅    ✅ Date processing completed
[13:47:20] 📊 Processed Patient Data
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'S32.501', 'secondDiagnosis': 'S52.022', 'thirdDiagnosis': 'M48.061'}]
[13:47:20] 🔄 
🔄 Step 4: Extracting order data...
[13:47:23] ℹ️  Order extraction - MRN: 'MA221116116005'
[13:47:23] ℹ️  Order extraction - Sex: ''
[13:47:23] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[13:47:23] ℹ️  Order extraction - Payer Source: ''
[13:47:23] ✅ Order data extraction completed successfully
[13:47:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:47:23] ℹ️  Using MRN from patient data: 'MA221116116005' over 'MA221116116005'
[13:47:23] ⚠️  Could not determine sex using any available method
[13:47:23] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[13:47:23] ✅ Patient name cross-validation successful
[13:47:23] ✅    ✅ Data merged successfully
[13:47:24] ✅    ✅ Order data extracted and validated
[13:47:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:47:30] [DOC: 9233969] ℹ️  Patient not found in cache or API: Kelly Medeiros
[13:47:30] [DOC: 9233969] ℹ️  Patient not found, creating new patient via API...
[13:47:30] [DOC: 9233969] ℹ️  Creating patient via API: Kelly Medeiros
[13:47:31] [DOC: 9233969] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:47:31] ❌    ❌ Failed to create patient
[13:47:31] [DOC: 9233969] ℹ️  API push details saved for document 9233969
================================================================================
║                        Processing Document ID: 9233967                         ║
================================================================================
[13:47:31] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:47:31] ℹ️  Date: 04/10/2025
[13:47:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:47:35] [DOC: 9233967] ✅ Text extracted using pdfplumber (17862 chars)
[13:47:35] ✅    ✅ Text extracted using pdfplumber (17862 chars)
[13:47:35] 🔄 
🔄 Step 2: Extracting patient data...
[13:47:38] ℹ️  AI extracted raw sex value: 'F'
[13:47:38] ℹ️  AI extracted service line: 'PT'
[13:47:38] ℹ️  AI extracted payer source: ''
[13:47:38] ℹ️  AI extracted diagnoses:
[13:47:38] ℹ️    - Diagnosis 1: 'Unsp fracture of right pubis, subs for fx w routn healing'
[13:47:38] ℹ️    - Diagnosis 2: 'Muscle weakness'
[13:47:38] ℹ️    - Diagnosis 3: ''
[13:47:38] ℹ️    - Diagnosis 4: ''
[13:47:38] ℹ️    - Diagnosis 5: ''
[13:47:38] ℹ️    - Diagnosis 6: ''
[13:47:38] ℹ️  Final extracted MRN: 'MA221116116005'
[13:47:38] ℹ️  Final extracted Sex: 'FEMALE'
[13:47:38] ℹ️  Final extracted Service Line: 'PT'
[13:47:38] ℹ️  Final extracted Payer Source: ''
[13:47:38] ✅ Patient data extraction completed successfully
[13:47:38] ✅    ✅ Patient data extracted successfully
[13:47:38] 📊 Patient Response
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Unsp fracture of right pubis, subs for fx w routn healing', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:47:38] ✅    ✅ Patient identified: Kelly Medeiros
[13:47:38] ✅    ✅ Patient name validation passed
[13:47:38] 🔄 
🔄 Step 3: Processing patient dates...
[13:47:38] [DOC: 9233967] ℹ️  DOB normalized: 11/23/1960
[13:47:38] [DOC: 9233967] ℹ️  Episode startOfEpisode normalized: 01/30/2025
[13:47:38] [DOC: 9233967] ✅ Patient date processing completed successfully
[13:47:38] ✅    ✅ Date processing completed
[13:47:38] 📊 Processed Patient Data
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/30/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Unsp fracture of right pubis, subs for fx w routn healing', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:47:38] 🔄 
🔄 Step 4: Extracting order data...
[13:47:42] ℹ️  Order extraction - MRN: 'MA221116116005'
[13:47:42] ℹ️  Order extraction - Sex: 'FEMALE'
[13:47:42] ℹ️  Order extraction - Service Line: 'PT'
[13:47:42] ℹ️  Order extraction - Payer Source: ''
[13:47:42] ✅ Order data extraction completed successfully
[13:47:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:47:42] ℹ️  Using MRN from patient data: 'MA221116116005' over 'MA221116116005'
[13:47:42] ℹ️  Service line consistent in both sources: 'PT'
[13:47:42] ✅ Patient name cross-validation successful
[13:47:42] ✅    ✅ Data merged successfully
[13:47:43] ✅    ✅ Order data extracted and validated
[13:47:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:47:52] [DOC: 9233967] ℹ️  Patient not found in cache or API: Kelly Medeiros
[13:47:52] [DOC: 9233967] ℹ️  Patient not found, creating new patient via API...
[13:47:52] [DOC: 9233967] ℹ️  Creating patient via API: Kelly Medeiros
[13:47:53] [DOC: 9233967] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:47:53] ❌    ❌ Failed to create patient
[13:47:53] [DOC: 9233967] ℹ️  API push details saved for document 9233967
================================================================================
║                        Processing Document ID: 9233958                         ║
================================================================================
[13:47:53] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:47:53] ℹ️  Date: 04/10/2025
[13:47:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:47:56] [DOC: 9233958] ✅ Text extracted using pdfplumber (1571 chars)
[13:47:56] ✅    ✅ Text extracted using pdfplumber (1571 chars)
[13:47:56] 🔄 
🔄 Step 2: Extracting patient data...
[13:47:58] ℹ️  AI extracted raw sex value: ''
[13:47:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:47:58] ℹ️  AI extracted payer source: ''
[13:47:58] ℹ️  AI extracted diagnoses:
[13:47:58] ℹ️    - Diagnosis 1: 'I13.0'
[13:47:58] ℹ️    - Diagnosis 2: 'I50.22'
[13:47:58] ℹ️    - Diagnosis 3: 'E11.22'
[13:47:58] ℹ️    - Diagnosis 4: 'None'
[13:47:58] ℹ️    - Diagnosis 5: 'None'
[13:47:58] ℹ️    - Diagnosis 6: 'None'
[13:47:58] ℹ️  Final extracted MRN: 'MA250306056005'
[13:47:58] ℹ️  Final extracted Sex: ''
[13:47:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:47:58] ℹ️  Final extracted Payer Source: ''
[13:47:58] ✅ Patient data extraction completed successfully
[13:47:58] ✅    ✅ Patient data extracted successfully
[13:47:58] 📊 Patient Response
     └─ patientFName: Frederick
     └─ patientLName: Ellis
     └─ dob: 05/29/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA250306056005
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.22', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:47:58] ✅    ✅ Patient identified: Frederick Ellis
[13:47:58] ✅    ✅ Patient name validation passed
[13:47:58] 🔄 
🔄 Step 3: Processing patient dates...
[13:47:58] [DOC: 9233958] ℹ️  DOB normalized: 05/29/1960
[13:47:58] [DOC: 9233958] ℹ️  Episode startOfEpisode normalized: 03/11/2025
[13:47:58] [DOC: 9233958] ℹ️  Episode endOfEpisode normalized: 05/09/2025
[13:47:58] [DOC: 9233958] ✅ Patient date processing completed successfully
[13:47:58] ✅    ✅ Date processing completed
[13:47:58] 📊 Processed Patient Data
     └─ patientFName: Frederick
     └─ patientLName: Ellis
     └─ dob: 05/29/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA250306056005
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.22', 'thirdDiagnosis': 'E11.22'}]
[13:47:58] 🔄 
🔄 Step 4: Extracting order data...
[13:48:01] ℹ️  Order extraction - MRN: 'MA250306056005'
[13:48:01] ℹ️  Order extraction - Sex: ''
[13:48:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:48:01] ℹ️  Order extraction - Payer Source: ''
[13:48:01] ✅ Order data extraction completed successfully
[13:48:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:48:01] ℹ️  Using MRN from patient data: 'MA250306056005' over 'MA250306056005'
[13:48:01] ⚠️  Could not determine sex using any available method
[13:48:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:48:01] ✅ Patient name cross-validation successful
[13:48:01] ✅    ✅ Data merged successfully
[13:48:02] ✅    ✅ Order data extracted and validated
[13:48:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:48:25] [DOC: 9233958] ℹ️  Patient not found in cache or API: Frederick Ellis
[13:48:25] [DOC: 9233958] ℹ️  Patient not found, creating new patient via API...
[13:48:25] [DOC: 9233958] ℹ️  Creating patient via API: Frederick Ellis
[13:48:27] [DOC: 9233958] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:48:27] ❌    ❌ Failed to create patient
[13:48:27] [DOC: 9233958] ℹ️  API push details saved for document 9233958
================================================================================
║                        Processing Document ID: 9233954                         ║
================================================================================
[13:48:27] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:48:27] ℹ️  Date: 04/10/2025
[13:48:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:48:29] [DOC: 9233954] ✅ Text extracted using pdfplumber (1623 chars)
[13:48:29] ✅    ✅ Text extracted using pdfplumber (1623 chars)
[13:48:29] 🔄 
🔄 Step 2: Extracting patient data...
[13:48:32] ℹ️  AI extracted raw sex value: ''
[13:48:32] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:48:32] ℹ️  AI extracted payer source: ''
[13:48:32] ℹ️  AI extracted diagnoses:
[13:48:32] ℹ️    - Diagnosis 1: 'I10'
[13:48:32] ℹ️    - Diagnosis 2: 'N18.31'
[13:48:32] ℹ️    - Diagnosis 3: 'I48.0'
[13:48:32] ℹ️    - Diagnosis 4: 'None'
[13:48:32] ℹ️    - Diagnosis 5: 'None'
[13:48:32] ℹ️    - Diagnosis 6: 'None'
[13:48:32] ℹ️  Final extracted MRN: 'MA250306056005'
[13:48:32] ℹ️  Final extracted Sex: ''
[13:48:32] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:48:32] ℹ️  Final extracted Payer Source: ''
[13:48:32] ✅ Patient data extraction completed successfully
[13:48:32] ✅    ✅ Patient data extracted successfully
[13:48:32] 📊 Patient Response
     └─ patientFName: Frederick
     └─ patientLName: Ellis
     └─ dob: 05/29/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA250306056005
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'N18.31', 'thirdDiagnosis': 'I48.0', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:48:32] ✅    ✅ Patient identified: Frederick Ellis
[13:48:32] ✅    ✅ Patient name validation passed
[13:48:32] 🔄 
🔄 Step 3: Processing patient dates...
[13:48:32] [DOC: 9233954] ℹ️  DOB normalized: 05/29/1960
[13:48:32] [DOC: 9233954] ℹ️  Episode startOfEpisode normalized: 03/11/2025
[13:48:32] [DOC: 9233954] ℹ️  Episode endOfEpisode normalized: 05/09/2025
[13:48:32] [DOC: 9233954] ✅ Patient date processing completed successfully
[13:48:32] ✅    ✅ Date processing completed
[13:48:32] 📊 Processed Patient Data
     └─ patientFName: Frederick
     └─ patientLName: Ellis
     └─ dob: 05/29/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA250306056005
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'N18.31', 'thirdDiagnosis': 'I48.0'}]
[13:48:32] 🔄 
🔄 Step 4: Extracting order data...
[13:48:34] ℹ️  Order extraction - MRN: 'MA250306056005'
[13:48:34] ℹ️  Order extraction - Sex: ''
[13:48:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:48:34] ℹ️  Order extraction - Payer Source: ''
[13:48:34] ✅ Order data extraction completed successfully
[13:48:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:48:34] ℹ️  Using MRN from patient data: 'MA250306056005' over 'MA250306056005'
[13:48:34] ⚠️  Could not determine sex using any available method
[13:48:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:48:34] ✅ Patient name cross-validation successful
[13:48:34] ✅    ✅ Data merged successfully
[13:48:36] ✅    ✅ Order data extracted and validated
[13:48:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:48:51] [DOC: 9233954] ℹ️  Patient not found in cache or API: Frederick Ellis
[13:48:51] [DOC: 9233954] ℹ️  Patient not found, creating new patient via API...
[13:48:51] [DOC: 9233954] ℹ️  Creating patient via API: Frederick Ellis
[13:48:52] [DOC: 9233954] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:48:52] ❌    ❌ Failed to create patient
[13:48:52] [DOC: 9233954] ℹ️  API push details saved for document 9233954
================================================================================
║                        Processing Document ID: 9233948                         ║
================================================================================
[13:48:52] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:48:52] ℹ️  Date: 04/10/2025
[13:48:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:48:55] [DOC: 9233948] ✅ Text extracted using pdfplumber (15664 chars)
[13:48:55] ✅    ✅ Text extracted using pdfplumber (15664 chars)
[13:48:55] 🔄 
🔄 Step 2: Extracting patient data...
[13:48:58] ℹ️  AI extracted raw sex value: 'M'
[13:48:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:48:58] ℹ️  AI extracted payer source: ''
[13:48:58] ℹ️  AI extracted diagnoses:
[13:48:58] ℹ️    - Diagnosis 1: 'I10'
[13:48:58] ℹ️    - Diagnosis 2: 'N1831'
[13:48:58] ℹ️    - Diagnosis 3: ''
[13:48:58] ℹ️    - Diagnosis 4: ''
[13:48:58] ℹ️    - Diagnosis 5: ''
[13:48:58] ℹ️    - Diagnosis 6: ''
[13:48:58] ℹ️  Final extracted MRN: 'MA250306056005'
[13:48:58] ℹ️  Final extracted Sex: 'MALE'
[13:48:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:48:58] ℹ️  Final extracted Payer Source: ''
[13:48:58] ✅ Patient data extraction completed successfully
[13:48:58] ✅    ✅ Patient data extracted successfully
[13:48:58] 📊 Patient Response
     └─ patientFName: Frederick
     └─ patientLName: Ellis
     └─ dob: 05/29/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250306056005
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'N1831', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:48:58] ✅    ✅ Patient identified: Frederick Ellis
[13:48:58] ✅    ✅ Patient name validation passed
[13:48:58] 🔄 
🔄 Step 3: Processing patient dates...
[13:48:58] [DOC: 9233948] ℹ️  DOB normalized: 05/29/1960
[13:48:58] [DOC: 9233948] ℹ️  Episode startOfEpisode normalized: 03/11/2025
[13:48:58] [DOC: 9233948] ℹ️  Episode endOfEpisode normalized: 05/09/2025
[13:48:58] [DOC: 9233948] ✅ Patient date processing completed successfully
[13:48:58] ✅    ✅ Date processing completed
[13:48:58] 📊 Processed Patient Data
     └─ patientFName: Frederick
     └─ patientLName: Ellis
     └─ dob: 05/29/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250306056005
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'N1831', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:48:58] 🔄 
🔄 Step 4: Extracting order data...
[13:49:01] ℹ️  Order extraction - MRN: 'MA250306056005'
[13:49:01] ℹ️  Order extraction - Sex: 'MALE'
[13:49:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:49:01] ℹ️  Order extraction - Payer Source: ''
[13:49:01] ✅ Order data extraction completed successfully
[13:49:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:49:01] ℹ️  Using MRN from patient data: 'MA250306056005' over 'MA250306056005'
[13:49:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:49:01] ✅ Patient name cross-validation successful
[13:49:01] ✅    ✅ Data merged successfully
[13:49:02] ✅    ✅ Order data extracted and validated
[13:49:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:49:08] [DOC: 9233948] ℹ️  Patient not found in cache or API: Frederick Ellis
[13:49:08] [DOC: 9233948] ℹ️  Patient not found, creating new patient via API...
[13:49:08] [DOC: 9233948] ℹ️  Creating patient via API: Frederick Ellis
[13:49:10] [DOC: 9233948] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:49:10] ❌    ❌ Failed to create patient
[13:49:10] [DOC: 9233948] ℹ️  API push details saved for document 9233948
================================================================================
║                        Processing Document ID: 9233943                         ║
================================================================================
[13:49:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:49:10] ℹ️  Date: 04/10/2025
[13:49:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:49:11] [DOC: 9233943] ✅ Text extracted using pdfplumber (1300 chars)
[13:49:11] ✅    ✅ Text extracted using pdfplumber (1300 chars)
[13:49:11] 🔄 
🔄 Step 2: Extracting patient data...
[13:49:14] ℹ️  AI extracted raw sex value: ''
[13:49:14] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:49:14] ℹ️  AI extracted payer source: ''
[13:49:14] ℹ️  AI extracted diagnoses:
[13:49:14] ℹ️    - Diagnosis 1: 'I10'
[13:49:14] ℹ️    - Diagnosis 2: 'N18.31'
[13:49:14] ℹ️    - Diagnosis 3: 'I48.0'
[13:49:14] ℹ️    - Diagnosis 4: ''
[13:49:14] ℹ️    - Diagnosis 5: ''
[13:49:14] ℹ️    - Diagnosis 6: ''
[13:49:14] ℹ️  Final extracted MRN: 'MA250306056005'
[13:49:14] ℹ️  Final extracted Sex: ''
[13:49:14] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:49:14] ℹ️  Final extracted Payer Source: ''
[13:49:14] ✅ Patient data extraction completed successfully
[13:49:14] ✅    ✅ Patient data extracted successfully
[13:49:14] 📊 Patient Response
     └─ patientFName: Frederick
     └─ patientLName: Ellis
     └─ dob: 05/29/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA250306056005
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'N18.31', 'thirdDiagnosis': 'I48.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:49:14] ✅    ✅ Patient identified: Frederick Ellis
[13:49:14] ✅    ✅ Patient name validation passed
[13:49:14] 🔄 
🔄 Step 3: Processing patient dates...
[13:49:14] [DOC: 9233943] ℹ️  DOB normalized: 05/29/1960
[13:49:14] [DOC: 9233943] ℹ️  Episode startOfEpisode normalized: 03/11/2025
[13:49:14] [DOC: 9233943] ℹ️  Episode endOfEpisode normalized: 05/09/2025
[13:49:14] [DOC: 9233943] ✅ Patient date processing completed successfully
[13:49:14] ✅    ✅ Date processing completed
[13:49:14] 📊 Processed Patient Data
     └─ patientFName: Frederick
     └─ patientLName: Ellis
     └─ dob: 05/29/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA250306056005
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'N18.31', 'thirdDiagnosis': 'I48.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:49:14] 🔄 
🔄 Step 4: Extracting order data...
[13:49:17] ℹ️  Order extraction - MRN: 'MA250306056005'
[13:49:17] ℹ️  Order extraction - Sex: ''
[13:49:17] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:49:17] ℹ️  Order extraction - Payer Source: ''
[13:49:17] ✅ Order data extraction completed successfully
[13:49:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:49:17] ℹ️  Using MRN from patient data: 'MA250306056005' over 'MA250306056005'
[13:49:17] ⚠️  Could not determine sex using any available method
[13:49:17] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:49:17] ✅ Patient name cross-validation successful
[13:49:17] ✅    ✅ Data merged successfully
[13:49:18] ✅    ✅ Order data extracted and validated
[13:49:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:49:41] [DOC: 9233943] ℹ️  Patient not found in cache or API: Frederick Ellis
[13:49:41] [DOC: 9233943] ℹ️  Patient not found, creating new patient via API...
[13:49:41] [DOC: 9233943] ℹ️  Creating patient via API: Frederick Ellis
[13:49:42] [DOC: 9233943] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:49:42] ❌    ❌ Failed to create patient
[13:49:42] [DOC: 9233943] ℹ️  API push details saved for document 9233943
================================================================================
║                        Processing Document ID: 9233926                         ║
================================================================================
[13:49:42] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:49:42] ℹ️  Date: 04/10/2025
[13:49:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:49:45] [DOC: 9233926] ✅ Text extracted using pdfplumber (14846 chars)
[13:49:45] ✅    ✅ Text extracted using pdfplumber (14846 chars)
[13:49:45] 🔄 
🔄 Step 2: Extracting patient data...
[13:49:48] ℹ️  AI extracted raw sex value: 'F'
[13:49:48] ℹ️  AI extracted service line: 'PT'
[13:49:48] ℹ️  AI extracted payer source: ''
[13:49:48] ℹ️  AI extracted diagnoses:
[13:49:48] ℹ️    - Diagnosis 1: 'Flu due to oth ident influenza virus w oth resp manifest'
[13:49:48] ℹ️    - Diagnosis 2: 'Muscle weakness'
[13:49:48] ℹ️    - Diagnosis 3: ''
[13:49:48] ℹ️    - Diagnosis 4: ''
[13:49:48] ℹ️    - Diagnosis 5: ''
[13:49:48] ℹ️    - Diagnosis 6: ''
[13:49:48] ℹ️  Final extracted MRN: 'MA240417095701'
[13:49:48] ℹ️  Final extracted Sex: 'FEMALE'
[13:49:48] ℹ️  Final extracted Service Line: 'PT'
[13:49:48] ℹ️  Final extracted Payer Source: ''
[13:49:48] ✅ Patient data extraction completed successfully
[13:49:48] ✅    ✅ Patient data extracted successfully
[13:49:48] 📊 Patient Response
     └─ patientFName: Cheryl
     └─ patientLName: Perkins
     └─ dob: 09/07/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240417095701
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Flu due to oth ident influenza virus w oth resp manifest', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:49:48] ✅    ✅ Patient identified: Cheryl Perkins
[13:49:48] ✅    ✅ Patient name validation passed
[13:49:48] 🔄 
🔄 Step 3: Processing patient dates...
[13:49:48] [DOC: 9233926] ℹ️  DOB normalized: 09/07/1957
[13:49:48] [DOC: 9233926] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[13:49:48] [DOC: 9233926] ✅ Patient date processing completed successfully
[13:49:48] ✅    ✅ Date processing completed
[13:49:48] 📊 Processed Patient Data
     └─ patientFName: Cheryl
     └─ patientLName: Perkins
     └─ dob: 09/07/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240417095701
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Flu due to oth ident influenza virus w oth resp manifest', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:49:48] 🔄 
🔄 Step 4: Extracting order data...
[13:49:51] ℹ️  Order extraction - MRN: 'MA240417095701'
[13:49:51] ℹ️  Order extraction - Sex: 'FEMALE'
[13:49:51] ℹ️  Order extraction - Service Line: 'PT'
[13:49:51] ℹ️  Order extraction - Payer Source: ''
[13:49:51] ✅ Order data extraction completed successfully
[13:49:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:49:51] ℹ️  Using MRN from patient data: 'MA240417095701' over 'MA240417095701'
[13:49:51] ℹ️  Service line consistent in both sources: 'PT'
[13:49:51] ✅ Patient name cross-validation successful
[13:49:51] ✅    ✅ Data merged successfully
[13:49:53] ✅    ✅ Order data extracted and validated
[13:49:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:49:53] [DOC: 9233926] ✅ Patient found in local cache: Cheryl Perkins, ID: 04d5ea44-f52f-4eb7-b219-de8c47b96e9b
[13:49:53] ✅    ✅ Existing patient found with ID: 04d5ea44-f52f-4eb7-b219-de8c47b96e9b
[13:49:53] 🔄 
🔄 Step 6: Pushing order to API...
[13:49:53] [DOC: 9233926] ℹ️  Pushing order via API for patient ID: 04d5ea44-f52f-4eb7-b219-de8c47b96e9b
[13:49:54] [DOC: 9233926] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:49:54] ❌    ❌ Failed to push order
[13:49:54] 🔄 
🔄 Step 7: Writing to CSV...
[13:49:54] [DOC: 9233926] ℹ️  Calculated age: 67 from DOB: 09/07/1957
[13:49:54] [DOC: 9233926] ℹ️  Service Line extracted: 'PT'
[13:49:54] [DOC: 9233926] ℹ️  Payer Source extracted: ''
[13:49:54] [DOC: 9233926] ℹ️  Diagnosis codes being written:
[13:49:54] [DOC: 9233926] ℹ️    - Latest_Episode_Firstdiagnosis: 'Flu due to oth ident influenza virus w oth resp manifest'
[13:49:54] [DOC: 9233926] ℹ️    - Latest_Episode_Seconddiagnosis: 'Muscle weakness'
[13:49:54] [DOC: 9233926] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:49:54] [DOC: 9233926] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:49:54] [DOC: 9233926] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:49:54] [DOC: 9233926] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:49:54] [DOC: 9233926] ✅ Patient data written to CSV: Cheryl Perkins | Sex: FEMALE | Age: 67 | Service: PT | Payer:  | MRN: MA240417095701
[13:49:54] ✅    ✅ Document 9233926 processed and saved successfully
[13:49:54] 🔄 
🔄 Step 8: Saving API details...
[13:49:54] [DOC: 9233926] ℹ️  API push details saved for document 9233926
[13:49:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233922                         ║
================================================================================
[13:49:54] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:49:54] ℹ️  Date: 04/10/2025
[13:49:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:49:57] [DOC: 9233922] ✅ Text extracted using pdfplumber (2360 chars)
[13:49:57] ✅    ✅ Text extracted using pdfplumber (2360 chars)
[13:49:57] 🔄 
🔄 Step 2: Extracting patient data...
[13:49:59] ℹ️  AI extracted raw sex value: ''
[13:49:59] ℹ️  AI extracted service line: 'Physical Therapy'
[13:49:59] ℹ️  AI extracted payer source: ''
[13:49:59] ℹ️  AI extracted diagnoses:
[13:49:59] ℹ️    - Diagnosis 1: 'J10.1'
[13:49:59] ℹ️    - Diagnosis 2: 'I10'
[13:49:59] ℹ️    - Diagnosis 3: 'D72.819'
[13:49:59] ℹ️    - Diagnosis 4: 'None'
[13:49:59] ℹ️    - Diagnosis 5: 'None'
[13:49:59] ℹ️    - Diagnosis 6: 'None'
[13:49:59] ℹ️  Final extracted MRN: 'MA240417095701'
[13:49:59] ℹ️  Final extracted Sex: ''
[13:49:59] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:49:59] ℹ️  Final extracted Payer Source: ''
[13:49:59] ✅ Patient data extraction completed successfully
[13:49:59] ✅    ✅ Patient data extracted successfully
[13:49:59] 📊 Patient Response
     └─ patientFName: Cheryl
     └─ patientLName: Perkins
     └─ dob: 09/07/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA240417095701
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'J10.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'D72.819', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:49:59] ✅    ✅ Patient identified: Cheryl Perkins
[13:49:59] ✅    ✅ Patient name validation passed
[13:49:59] 🔄 
🔄 Step 3: Processing patient dates...
[13:49:59] [DOC: 9233922] ℹ️  DOB normalized: 09/07/1957
[13:49:59] [DOC: 9233922] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[13:49:59] [DOC: 9233922] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[13:49:59] [DOC: 9233922] ✅ Patient date processing completed successfully
[13:49:59] ✅    ✅ Date processing completed
[13:49:59] 📊 Processed Patient Data
     └─ patientFName: Cheryl
     └─ patientLName: Perkins
     └─ dob: 09/07/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA240417095701
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'J10.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'D72.819'}]
[13:49:59] 🔄 
🔄 Step 4: Extracting order data...
[13:50:02] ℹ️  Order extraction - MRN: 'MA240417095701'
[13:50:02] ℹ️  Order extraction - Sex: ''
[13:50:02] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[13:50:02] ℹ️  Order extraction - Payer Source: ''
[13:50:02] ✅ Order data extraction completed successfully
[13:50:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:50:02] ℹ️  Using MRN from patient data: 'MA240417095701' over 'MA240417095701'
[13:50:02] ⚠️  Could not determine sex using any available method
[13:50:02] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[13:50:02] ✅ Patient name cross-validation successful
[13:50:02] ✅    ✅ Data merged successfully
[13:50:03] ✅    ✅ Order data extracted and validated
[13:50:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:50:03] [DOC: 9233922] ✅ Patient found in local cache: Cheryl Perkins, ID: 04d5ea44-f52f-4eb7-b219-de8c47b96e9b
[13:50:03] ✅    ✅ Existing patient found with ID: 04d5ea44-f52f-4eb7-b219-de8c47b96e9b
[13:50:03] 🔄 
🔄 Step 6: Pushing order to API...
[13:50:03] [DOC: 9233922] ℹ️  Pushing order via API for patient ID: 04d5ea44-f52f-4eb7-b219-de8c47b96e9b
[13:50:05] [DOC: 9233922] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13054"}
[13:50:05] ❌    ❌ Failed to push order
[13:50:05] 🔄 
🔄 Step 7: Writing to CSV...
[13:50:05] [DOC: 9233922] ℹ️  Calculated age: 67 from DOB: 09/07/1957
[13:50:05] [DOC: 9233922] ℹ️  Service Line extracted: 'Physical Therapy'
[13:50:05] [DOC: 9233922] ℹ️  Payer Source extracted: ''
[13:50:05] [DOC: 9233922] ℹ️  Diagnosis codes being written:
[13:50:05] [DOC: 9233922] ℹ️    - Latest_Episode_Firstdiagnosis: 'J10.1'
[13:50:05] [DOC: 9233922] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[13:50:05] [DOC: 9233922] ℹ️    - Latest_Episode_Thirddiagnosis: 'D72.819'
[13:50:05] [DOC: 9233922] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:50:05] [DOC: 9233922] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:50:05] [DOC: 9233922] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:50:05] [DOC: 9233922] ✅ Patient data written to CSV: Cheryl Perkins | Sex:  | Age: 67 | Service: Physical Therapy | Payer:  | MRN: MA240417095701
[13:50:05] ✅    ✅ Document 9233922 processed and saved successfully
[13:50:05] 🔄 
🔄 Step 8: Saving API details...
[13:50:05] [DOC: 9233922] ℹ️  API push details saved for document 9233922
[13:50:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233919                         ║
================================================================================
[13:50:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:50:05] ℹ️  Date: 04/10/2025
[13:50:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:50:08] [DOC: 9233919] ✅ Text extracted using pdfplumber (2226 chars)
[13:50:08] ✅    ✅ Text extracted using pdfplumber (2226 chars)
[13:50:08] 🔄 
🔄 Step 2: Extracting patient data...
[13:50:10] ℹ️  AI extracted raw sex value: ''
[13:50:10] ℹ️  AI extracted service line: 'Physical Therapy'
[13:50:10] ℹ️  AI extracted payer source: ''
[13:50:10] ℹ️  AI extracted diagnoses:
[13:50:10] ℹ️    - Diagnosis 1: 'J10.1'
[13:50:10] ℹ️    - Diagnosis 2: 'I10'
[13:50:10] ℹ️    - Diagnosis 3: 'D72.819'
[13:50:10] ℹ️    - Diagnosis 4: ''
[13:50:10] ℹ️    - Diagnosis 5: ''
[13:50:10] ℹ️    - Diagnosis 6: ''
[13:50:10] ℹ️  Final extracted MRN: 'MA240417095701'
[13:50:10] ℹ️  Final extracted Sex: ''
[13:50:10] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:50:10] ℹ️  Final extracted Payer Source: ''
[13:50:10] ✅ Patient data extraction completed successfully
[13:50:10] ✅    ✅ Patient data extracted successfully
[13:50:10] 📊 Patient Response
     └─ patientFName: Cheryl
     └─ patientLName: Perkins
     └─ dob: 09/07/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA240417095701
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'J10.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'D72.819', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:50:10] ✅    ✅ Patient identified: Cheryl Perkins
[13:50:10] ✅    ✅ Patient name validation passed
[13:50:10] 🔄 
🔄 Step 3: Processing patient dates...
[13:50:10] [DOC: 9233919] ℹ️  DOB normalized: 09/07/1957
[13:50:10] [DOC: 9233919] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[13:50:10] [DOC: 9233919] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[13:50:10] [DOC: 9233919] ✅ Patient date processing completed successfully
[13:50:10] ✅    ✅ Date processing completed
[13:50:10] 📊 Processed Patient Data
     └─ patientFName: Cheryl
     └─ patientLName: Perkins
     └─ dob: 09/07/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA240417095701
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'J10.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'D72.819', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:50:10] 🔄 
🔄 Step 4: Extracting order data...
[13:50:13] ℹ️  Order extraction - MRN: 'MA240417095701'
[13:50:13] ℹ️  Order extraction - Sex: ''
[13:50:13] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[13:50:13] ℹ️  Order extraction - Payer Source: ''
[13:50:13] ✅ Order data extraction completed successfully
[13:50:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:50:13] ℹ️  Using MRN from patient data: 'MA240417095701' over 'MA240417095701'
[13:50:13] ⚠️  Could not determine sex using any available method
[13:50:13] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[13:50:13] ✅ Patient name cross-validation successful
[13:50:13] ✅    ✅ Data merged successfully
[13:50:14] ✅    ✅ Order data extracted and validated
[13:50:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:50:14] [DOC: 9233919] ✅ Patient found in local cache: Cheryl Perkins, ID: 04d5ea44-f52f-4eb7-b219-de8c47b96e9b
[13:50:14] ✅    ✅ Existing patient found with ID: 04d5ea44-f52f-4eb7-b219-de8c47b96e9b
[13:50:14] 🔄 
🔄 Step 6: Pushing order to API...
[13:50:14] [DOC: 9233919] ℹ️  Pushing order via API for patient ID: 04d5ea44-f52f-4eb7-b219-de8c47b96e9b
[13:50:15] [DOC: 9233919] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13055"}
[13:50:15] ❌    ❌ Failed to push order
[13:50:15] 🔄 
🔄 Step 7: Writing to CSV...
[13:50:15] [DOC: 9233919] ℹ️  Calculated age: 67 from DOB: 09/07/1957
[13:50:15] [DOC: 9233919] ℹ️  Service Line extracted: 'Physical Therapy'
[13:50:15] [DOC: 9233919] ℹ️  Payer Source extracted: ''
[13:50:15] [DOC: 9233919] ℹ️  Diagnosis codes being written:
[13:50:15] [DOC: 9233919] ℹ️    - Latest_Episode_Firstdiagnosis: 'J10.1'
[13:50:15] [DOC: 9233919] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[13:50:15] [DOC: 9233919] ℹ️    - Latest_Episode_Thirddiagnosis: 'D72.819'
[13:50:15] [DOC: 9233919] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:50:15] [DOC: 9233919] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:50:15] [DOC: 9233919] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:50:15] [DOC: 9233919] ✅ Patient data written to CSV: Cheryl Perkins | Sex:  | Age: 67 | Service: Physical Therapy | Payer:  | MRN: MA240417095701
[13:50:15] ✅    ✅ Document 9233919 processed and saved successfully
[13:50:15] 🔄 
🔄 Step 8: Saving API details...
[13:50:15] [DOC: 9233919] ℹ️  API push details saved for document 9233919
[13:50:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233915                         ║
================================================================================
[13:50:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:50:15] ℹ️  Date: 04/10/2025
[13:50:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:50:20] [DOC: 9233915] ✅ Text extracted using pdfplumber (3234 chars)
[13:50:20] ✅    ✅ Text extracted using pdfplumber (3234 chars)
[13:50:20] 🔄 
🔄 Step 2: Extracting patient data...
[13:50:23] ℹ️  AI extracted raw sex value: ''
[13:50:23] ℹ️  AI extracted service line: 'Physical Therapy'
[13:50:23] ℹ️  AI extracted payer source: ''
[13:50:23] ℹ️  AI extracted diagnoses:
[13:50:23] ℹ️    - Diagnosis 1: 'J10.1'
[13:50:23] ℹ️    - Diagnosis 2: 'I10'
[13:50:23] ℹ️    - Diagnosis 3: 'D72.819'
[13:50:23] ℹ️    - Diagnosis 4: 'None'
[13:50:23] ℹ️    - Diagnosis 5: 'None'
[13:50:23] ℹ️    - Diagnosis 6: 'None'
[13:50:23] ℹ️  Final extracted MRN: 'MA240417095701'
[13:50:23] ℹ️  Final extracted Sex: ''
[13:50:23] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:50:23] ℹ️  Final extracted Payer Source: ''
[13:50:23] ✅ Patient data extraction completed successfully
[13:50:23] ✅    ✅ Patient data extracted successfully
[13:50:23] 📊 Patient Response
     └─ patientFName: Cheryl
     └─ patientLName: Perkins
     └─ dob: 09/07/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA240417095701
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': 'J10.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'D72.819', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:50:23] ✅    ✅ Patient identified: Cheryl Perkins
[13:50:23] ✅    ✅ Patient name validation passed
[13:50:23] 🔄 
🔄 Step 3: Processing patient dates...
[13:50:23] [DOC: 9233915] ℹ️  DOB normalized: 09/07/1957
[13:50:23] [DOC: 9233915] ℹ️  Episode startOfEpisode normalized: 01/20/2025
[13:50:23] [DOC: 9233915] ℹ️  Episode endOfEpisode normalized: 03/20/2025
[13:50:23] [DOC: 9233915] ✅ Patient date processing completed successfully
[13:50:23] ✅    ✅ Date processing completed
[13:50:23] 📊 Processed Patient Data
     └─ patientFName: Cheryl
     └─ patientLName: Perkins
     └─ dob: 09/07/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA240417095701
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/20/2025', 'endOfEpisode': '03/20/2025', 'firstDiagnosis': 'J10.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'D72.819'}]
[13:50:23] 🔄 
🔄 Step 4: Extracting order data...
[13:50:25] ℹ️  Order extraction - MRN: 'MA240417095701'
[13:50:25] ℹ️  Order extraction - Sex: ''
[13:50:25] ℹ️  Order extraction - Service Line: 'PT'
[13:50:25] ℹ️  Order extraction - Payer Source: ''
[13:50:25] ✅ Order data extraction completed successfully
[13:50:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:50:25] ℹ️  Using MRN from patient data: 'MA240417095701' over 'MA240417095701'
[13:50:25] ⚠️  Could not determine sex using any available method
[13:50:25] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[13:50:25] ✅ Patient name cross-validation successful
[13:50:25] ✅    ✅ Data merged successfully
[13:50:28] ✅    ✅ Order data extracted and validated
[13:50:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:50:28] [DOC: 9233915] ✅ Patient found in local cache: Cheryl Perkins, ID: 04d5ea44-f52f-4eb7-b219-de8c47b96e9b
[13:50:28] ✅    ✅ Existing patient found with ID: 04d5ea44-f52f-4eb7-b219-de8c47b96e9b
[13:50:28] 🔄 
🔄 Step 6: Pushing order to API...
[13:50:28] [DOC: 9233915] ℹ️  Pushing order via API for patient ID: 04d5ea44-f52f-4eb7-b219-de8c47b96e9b
[13:50:30] [DOC: 9233915] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13056"}
[13:50:30] ❌    ❌ Failed to push order
[13:50:30] 🔄 
🔄 Step 7: Writing to CSV...
[13:50:30] [DOC: 9233915] ℹ️  Calculated age: 67 from DOB: 09/07/1957
[13:50:30] [DOC: 9233915] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[13:50:30] [DOC: 9233915] ℹ️  Payer Source extracted: ''
[13:50:30] [DOC: 9233915] ℹ️  Diagnosis codes being written:
[13:50:30] [DOC: 9233915] ℹ️    - Latest_Episode_Firstdiagnosis: 'J10.1'
[13:50:30] [DOC: 9233915] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[13:50:30] [DOC: 9233915] ℹ️    - Latest_Episode_Thirddiagnosis: 'D72.819'
[13:50:30] [DOC: 9233915] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:50:30] [DOC: 9233915] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:50:30] [DOC: 9233915] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:50:30] [DOC: 9233915] ✅ Patient data written to CSV: Cheryl Perkins | Sex:  | Age: 67 | Service: PT, Physical Therapy | Payer:  | MRN: MA240417095701
[13:50:30] ✅    ✅ Document 9233915 processed and saved successfully
[13:50:30] 🔄 
🔄 Step 8: Saving API details...
[13:50:30] [DOC: 9233915] ℹ️  API push details saved for document 9233915
[13:50:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233900                         ║
================================================================================
[13:50:30] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:50:30] ℹ️  Date: 04/10/2025
[13:50:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:50:33] [DOC: 9233900] ✅ Text extracted using pdfplumber (16860 chars)
[13:50:33] ✅    ✅ Text extracted using pdfplumber (16860 chars)
[13:50:33] 🔄 
🔄 Step 2: Extracting patient data...
[13:50:35] ℹ️  AI extracted raw sex value: 'F'
[13:50:35] ℹ️  AI extracted service line: 'PT'
[13:50:35] ℹ️  AI extracted payer source: ''
[13:50:35] ℹ️  AI extracted diagnoses:
[13:50:35] ℹ️    - Diagnosis 1: 'Lumbar spondylosis'
[13:50:35] ℹ️    - Diagnosis 2: 'Difficulty with gait'
[13:50:35] ℹ️    - Diagnosis 3: ''
[13:50:35] ℹ️    - Diagnosis 4: ''
[13:50:35] ℹ️    - Diagnosis 5: ''
[13:50:35] ℹ️    - Diagnosis 6: ''
[13:50:35] ℹ️  Final extracted MRN: 'MA220109073101'
[13:50:35] ℹ️  Final extracted Sex: 'FEMALE'
[13:50:35] ℹ️  Final extracted Service Line: 'PT'
[13:50:35] ℹ️  Final extracted Payer Source: ''
[13:50:35] ✅ Patient data extraction completed successfully
[13:50:35] ✅    ✅ Patient data extracted successfully
[13:50:35] 📊 Patient Response
     └─ patientFName: Raquel
     └─ patientLName: Franco
     └─ dob: 07/01/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220109073101
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Lumbar spondylosis', 'secondDiagnosis': 'Difficulty with gait', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:50:35] ✅    ✅ Patient identified: Raquel Franco
[13:50:35] ✅    ✅ Patient name validation passed
[13:50:35] 🔄 
🔄 Step 3: Processing patient dates...
[13:50:35] [DOC: 9233900] ℹ️  DOB normalized: 07/01/1931
[13:50:35] [DOC: 9233900] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[13:50:35] [DOC: 9233900] ✅ Patient date processing completed successfully
[13:50:35] ✅    ✅ Date processing completed
[13:50:35] 📊 Processed Patient Data
     └─ patientFName: Raquel
     └─ patientLName: Franco
     └─ dob: 07/01/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220109073101
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Lumbar spondylosis', 'secondDiagnosis': 'Difficulty with gait', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:50:35] 🔄 
🔄 Step 4: Extracting order data...
[13:50:39] ℹ️  Order extraction - MRN: 'MA220109073101'
[13:50:39] ℹ️  Order extraction - Sex: 'FEMALE'
[13:50:39] ℹ️  Order extraction - Service Line: 'PT'
[13:50:39] ℹ️  Order extraction - Payer Source: ''
[13:50:39] ✅ Order data extraction completed successfully
[13:50:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:50:39] ℹ️  Using MRN from patient data: 'MA220109073101' over 'MA220109073101'
[13:50:39] ℹ️  Service line consistent in both sources: 'PT'
[13:50:39] ✅ Patient name cross-validation successful
[13:50:39] ✅    ✅ Data merged successfully
[13:50:40] ✅    ✅ Order data extracted and validated
[13:50:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:51:08] [DOC: 9233900] ℹ️  Patient not found in cache or API: Raquel Franco
[13:51:08] [DOC: 9233900] ℹ️  Patient not found, creating new patient via API...
[13:51:08] [DOC: 9233900] ℹ️  Creating patient via API: Raquel Franco
[13:51:09] [DOC: 9233900] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:51:09] ❌    ❌ Failed to create patient
[13:51:09] [DOC: 9233900] ℹ️  API push details saved for document 9233900
================================================================================
║                        Processing Document ID: 9233897                         ║
================================================================================
[13:51:09] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:51:09] ℹ️  Date: 04/10/2025
[13:51:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:51:18] [DOC: 9233897] ✅ Text extracted using pdfplumber (18256 chars)
[13:51:18] ✅    ✅ Text extracted using pdfplumber (18256 chars)
[13:51:18] 🔄 
🔄 Step 2: Extracting patient data...
[13:51:21] ℹ️  AI extracted raw sex value: 'F'
[13:51:21] ℹ️  AI extracted service line: 'OT'
[13:51:21] ℹ️  AI extracted payer source: ''
[13:51:21] ℹ️  AI extracted diagnoses:
[13:51:21] ℹ️    - Diagnosis 1: 'back pain'
[13:51:21] ℹ️    - Diagnosis 2: 'pain and weakness'
[13:51:21] ℹ️    - Diagnosis 3: 'hypercholesterolemia'
[13:51:21] ℹ️    - Diagnosis 4: 'chronic obstructive lung disease'
[13:51:21] ℹ️    - Diagnosis 5: 'CAD'
[13:51:21] ℹ️    - Diagnosis 6: 'chronic pain'
[13:51:21] ℹ️  Final extracted MRN: 'MA220109073101'
[13:51:21] ℹ️  Final extracted Sex: 'FEMALE'
[13:51:21] ℹ️  Final extracted Service Line: 'OT'
[13:51:21] ℹ️  Final extracted Payer Source: ''
[13:51:21] ✅ Patient data extraction completed successfully
[13:51:21] ✅    ✅ Patient data extracted successfully
[13:51:21] 📊 Patient Response
     └─ patientFName: Raquel
     └─ patientLName: Franco
     └─ dob: 07/01/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220109073101
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '', 'firstDiagnosis': 'back pain', 'secondDiagnosis': 'pain and weakness', 'thirdDiagnosis': 'hypercholesterolemia', 'fourthDiagnosis': 'chronic obstructive lung disease', 'fifthDiagnosis': 'CAD', 'sixthDiagnosis': 'chronic pain'}]
[13:51:21] ✅    ✅ Patient identified: Raquel Franco
[13:51:21] ✅    ✅ Patient name validation passed
[13:51:21] 🔄 
🔄 Step 3: Processing patient dates...
[13:51:21] [DOC: 9233897] ℹ️  DOB normalized: 07/01/1931
[13:51:21] [DOC: 9233897] ℹ️  Episode startOfEpisode normalized: 02/16/2025
[13:51:21] [DOC: 9233897] ✅ Patient date processing completed successfully
[13:51:21] ✅    ✅ Date processing completed
[13:51:21] 📊 Processed Patient Data
     └─ patientFName: Raquel
     └─ patientLName: Franco
     └─ dob: 07/01/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220109073101
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/16/2025', 'endOfEpisode': '', 'firstDiagnosis': 'back pain', 'secondDiagnosis': 'pain and weakness', 'thirdDiagnosis': 'hypercholesterolemia', 'fourthDiagnosis': 'chronic obstructive lung disease', 'fifthDiagnosis': 'CAD', 'sixthDiagnosis': 'chronic pain'}]
[13:51:21] 🔄 
🔄 Step 4: Extracting order data...
[13:51:24] ℹ️  Order extraction - MRN: 'MA220109073101'
[13:51:24] ℹ️  Order extraction - Sex: 'FEMALE'
[13:51:24] ℹ️  Order extraction - Service Line: 'OT'
[13:51:24] ℹ️  Order extraction - Payer Source: ''
[13:51:24] ✅ Order data extraction completed successfully
[13:51:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:51:24] ℹ️  Using MRN from patient data: 'MA220109073101' over 'MA220109073101'
[13:51:24] ℹ️  Service line consistent in both sources: 'OT'
[13:51:24] ✅ Patient name cross-validation successful
[13:51:24] ✅    ✅ Data merged successfully
[13:51:25] ✅    ✅ Order data extracted and validated
[13:51:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:51:51] [DOC: 9233897] ℹ️  Patient not found in cache or API: Raquel Franco
[13:51:51] [DOC: 9233897] ℹ️  Patient not found, creating new patient via API...
[13:51:51] [DOC: 9233897] ℹ️  Creating patient via API: Raquel Franco
[13:51:52] [DOC: 9233897] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:51:52] ❌    ❌ Failed to create patient
[13:51:52] [DOC: 9233897] ℹ️  API push details saved for document 9233897
================================================================================
║                        Processing Document ID: 9233894                         ║
================================================================================
[13:51:52] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:51:52] ℹ️  Date: 04/10/2025
[13:51:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:51:56] [DOC: 9233894] ✅ Text extracted using pdfplumber (15473 chars)
[13:51:56] ✅    ✅ Text extracted using pdfplumber (15473 chars)
[13:51:56] 🔄 
🔄 Step 2: Extracting patient data...
[13:51:58] ℹ️  AI extracted raw sex value: 'F'
[13:51:58] ℹ️  AI extracted service line: 'PT'
[13:51:58] ℹ️  AI extracted payer source: ''
[13:51:58] ℹ️  AI extracted diagnoses:
[13:51:58] ℹ️    - Diagnosis 1: ''
[13:51:58] ℹ️    - Diagnosis 2: ''
[13:51:58] ℹ️    - Diagnosis 3: ''
[13:51:58] ℹ️    - Diagnosis 4: ''
[13:51:58] ℹ️    - Diagnosis 5: ''
[13:51:58] ℹ️    - Diagnosis 6: ''
[13:51:58] ℹ️  Final extracted MRN: 'MA220109073101'
[13:51:58] ℹ️  Final extracted Sex: 'FEMALE'
[13:51:58] ℹ️  Final extracted Service Line: 'PT'
[13:51:58] ℹ️  Final extracted Payer Source: ''
[13:51:58] ✅ Patient data extraction completed successfully
[13:51:58] ✅    ✅ Patient data extracted successfully
[13:51:58] 📊 Patient Response
     └─ patientFName: Raquel
     └─ patientLName: Franco
     └─ dob: 07/01/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220109073101
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:51:58] ✅    ✅ Patient identified: Raquel Franco
[13:51:58] ✅    ✅ Patient name validation passed
[13:51:58] 🔄 
🔄 Step 3: Processing patient dates...
[13:51:58] [DOC: 9233894] ℹ️  DOB normalized: 07/01/1931
[13:51:58] [DOC: 9233894] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[13:51:58] [DOC: 9233894] ✅ Patient date processing completed successfully
[13:51:58] ✅    ✅ Date processing completed
[13:51:58] 📊 Processed Patient Data
     └─ patientFName: Raquel
     └─ patientLName: Franco
     └─ dob: 07/01/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220109073101
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:51:58] 🔄 
🔄 Step 4: Extracting order data...
[13:52:02] ℹ️  Order extraction - MRN: 'MA220109073101'
[13:52:02] ℹ️  Order extraction - Sex: 'FEMALE'
[13:52:02] ℹ️  Order extraction - Service Line: 'PT'
[13:52:02] ℹ️  Order extraction - Payer Source: ''
[13:52:02] ✅ Order data extraction completed successfully
[13:52:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:52:02] ℹ️  Using MRN from patient data: 'MA220109073101' over 'MA220109073101'
[13:52:02] ℹ️  Service line consistent in both sources: 'PT'
[13:52:02] ✅ Patient name cross-validation successful
[13:52:02] ✅    ✅ Data merged successfully
[13:52:03] ✅    ✅ Order data extracted and validated
[13:52:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:52:10] [DOC: 9233894] ℹ️  Patient not found in cache or API: Raquel Franco
[13:52:10] [DOC: 9233894] ℹ️  Patient not found, creating new patient via API...
[13:52:10] [DOC: 9233894] ℹ️  Creating patient via API: Raquel Franco
[13:52:11] [DOC: 9233894] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:52:11] ❌    ❌ Failed to create patient
[13:52:11] [DOC: 9233894] ℹ️  API push details saved for document 9233894
================================================================================
║                        Processing Document ID: 9233699                         ║
================================================================================
[13:52:11] ℹ️  Agency: Alphacare Home Health Agency
[13:52:11] ℹ️  Date: 04/10/2025
[13:52:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:52:24] [DOC: 9233699] ✅ Text extracted using pdfplumber (30372 chars)
[13:52:24] ✅    ✅ Text extracted using pdfplumber (30372 chars)
[13:52:24] 🔄 
🔄 Step 2: Extracting patient data...
[13:52:28] ℹ️  AI extracted raw sex value: 'M'
[13:52:28] ℹ️  AI extracted service line: 'RN, PT'
[13:52:28] ℹ️  AI extracted payer source: 'MassHealth (Medicaid)'
[13:52:28] ℹ️  AI extracted diagnoses:
[13:52:28] ℹ️    - Diagnosis 1: 'J18.9'
[13:52:28] ℹ️    - Diagnosis 2: 'J44.9'
[13:52:28] ℹ️    - Diagnosis 3: 'J96.20'
[13:52:28] ℹ️    - Diagnosis 4: ''
[13:52:28] ℹ️    - Diagnosis 5: ''
[13:52:28] ℹ️    - Diagnosis 6: ''
[13:52:28] ℹ️  Final extracted MRN: '000003097'
[13:52:28] ℹ️  Final extracted Sex: 'MALE'
[13:52:28] ℹ️  Final extracted Service Line: 'RN, PT'
[13:52:28] ℹ️  Final extracted Payer Source: 'MassHealth (Medicaid)'
[13:52:28] ✅ Patient data extraction completed successfully
[13:52:28] ✅    ✅ Patient data extracted successfully
[13:52:28] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Medeiros
     └─ dob: 07/04/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 000003097
     └─ billingProvider: AlphaCare Home Health Agency, Inc.
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 42 Tremont St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 996-6332
     └─ serviceLine: RN, PT
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '01/22/2024', 'startOfEpisode': '01/11/2025', 'endOfEpisode': '03/04/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'J96.20', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '01/22/2024', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:52:28] ✅    ✅ Patient identified: Gloria Medeiros
[13:52:28] ✅    ✅ Patient name validation passed
[13:52:28] 🔄 
🔄 Step 3: Processing patient dates...
[13:52:28] [DOC: 9233699] ℹ️  DOB normalized: 07/04/1946
[13:52:28] [DOC: 9233699] ℹ️  Episode startOfCare normalized: 01/22/2024
[13:52:28] [DOC: 9233699] ℹ️  Episode startOfEpisode normalized: 01/11/2025
[13:52:28] [DOC: 9233699] ℹ️  Episode endOfEpisode normalized: 03/04/2025
[13:52:28] [DOC: 9233699] ✅ Patient date processing completed successfully
[13:52:28] ✅    ✅ Date processing completed
[13:52:28] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Medeiros
     └─ dob: 07/04/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 000003097
     └─ billingProvider: AlphaCare Home Health Agency, Inc.
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 42 Tremont St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 996-6332
     └─ serviceLine: RN, PT
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '01/22/2024', 'startOfEpisode': '01/11/2025', 'endOfEpisode': '03/04/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'J96.20', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '01/22/2024', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:52:28] 🔄 
🔄 Step 4: Extracting order data...
[13:52:31] ℹ️  Order extraction - MRN: '000003097'
[13:52:31] ℹ️  Order extraction - Sex: 'MALE'
[13:52:31] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[13:52:31] ℹ️  Order extraction - Payer Source: 'MassHealth (Medicaid)'
[13:52:31] ✅ Order data extraction completed successfully
[13:52:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:52:31] ℹ️  Using MRN from patient data: '000003097' over '000003097'
[13:52:31] ℹ️  Combined service lines: Patient='RN, PT' + Order='Skilled Nursing, Physical Therapy' = 'PT, Physical Therapy, RN, Skilled Nursing'
[13:52:31] ℹ️  Payer source consistent in both sources: 'MassHealth (Medicaid)'
[13:52:31] ✅ Patient name cross-validation successful
[13:52:31] ✅    ✅ Data merged successfully
[13:52:32] ✅    ✅ Order data extracted and validated
[13:52:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:52:32] [DOC: 9233699] ✅ Patient found in local cache: Gloria Medeiros, ID: 94edbecd-aff3-4eb4-8828-772617a0c5c6
[13:52:32] ✅    ✅ Existing patient found with ID: 94edbecd-aff3-4eb4-8828-772617a0c5c6
[13:52:32] 🔄 
🔄 Step 6: Pushing order to API...
[13:52:32] [DOC: 9233699] ℹ️  Pushing order via API for patient ID: 94edbecd-aff3-4eb4-8828-772617a0c5c6
[13:52:34] [DOC: 9233699] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:52:34] ❌    ❌ Failed to push order
[13:52:34] 🔄 
🔄 Step 7: Writing to CSV...
[13:52:34] [DOC: 9233699] ℹ️  Calculated age: 78 from DOB: 07/04/1946
[13:52:34] [DOC: 9233699] ℹ️  Service Line extracted: 'PT, Physical Therapy, RN, Skilled Nursing'
[13:52:34] [DOC: 9233699] ℹ️  Payer Source extracted: 'MassHealth (Medicaid)'
[13:52:34] [DOC: 9233699] ℹ️  Diagnosis codes being written:
[13:52:34] [DOC: 9233699] ℹ️    - Latest_Episode_Firstdiagnosis: 'J18.9'
[13:52:34] [DOC: 9233699] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[13:52:34] [DOC: 9233699] ℹ️    - Latest_Episode_Thirddiagnosis: 'J96.20'
[13:52:34] [DOC: 9233699] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:52:34] [DOC: 9233699] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:52:34] [DOC: 9233699] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:52:34] [DOC: 9233699] ✅ Patient data written to CSV: Gloria Medeiros | Sex: MALE | Age: 78 | Service: PT, Physical Therapy, RN, Skilled Nursing | Payer: MassHealth (Medicaid) | MRN: 000003097
[13:52:34] ✅    ✅ Document 9233699 processed and saved successfully
[13:52:34] 🔄 
🔄 Step 8: Saving API details...
[13:52:34] [DOC: 9233699] ℹ️  API push details saved for document 9233699
[13:52:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233692                         ║
================================================================================
[13:52:34] ℹ️  Agency: Alphacare Home Health Agency
[13:52:34] ℹ️  Date: 04/10/2025
[13:52:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:52:37] [DOC: 9233692] ✅ Text extracted using pdfplumber (2010 chars)
[13:52:37] ✅    ✅ Text extracted using pdfplumber (2010 chars)
[13:52:37] 🔄 
🔄 Step 2: Extracting patient data...
[13:52:40] ℹ️  AI extracted raw sex value: ''
[13:52:40] ℹ️  AI extracted service line: 'Speech Therapy'
[13:52:40] ℹ️  AI extracted payer source: ''
[13:52:40] ℹ️  AI extracted diagnoses:
[13:52:40] ℹ️    - Diagnosis 1: 'J44.9'
[13:52:40] ℹ️    - Diagnosis 2: 'Z99.81'
[13:52:40] ℹ️    - Diagnosis 3: 'M62.81'
[13:52:40] ℹ️    - Diagnosis 4: 'J18.9'
[13:52:40] ℹ️    - Diagnosis 5: 'R13.10'
[13:52:40] ℹ️    - Diagnosis 6: ''
[13:52:40] ℹ️  Final extracted MRN: '000003097'
[13:52:40] ℹ️  Final extracted Sex: ''
[13:52:40] ℹ️  Final extracted Service Line: 'Speech Therapy'
[13:52:40] ℹ️  Final extracted Payer Source: ''
[13:52:40] ✅ Patient data extraction completed successfully
[13:52:40] ✅    ✅ Patient data extracted successfully
[13:52:40] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Medeiros
     └─ dob: 07/04/1946
     └─ patientSex: 
     └─ medicalRecordNo: 000003097
     └─ billingProvider: Pothier, Jahn (MD (Dr. Alliance))
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2025', 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'Z99.81', 'thirdDiagnosis': 'M62.81', 'fourthDiagnosis': 'J18.9', 'fifthDiagnosis': 'R13.10', 'sixthDiagnosis': ''}]
[13:52:40] ✅    ✅ Patient identified: Gloria Medeiros
[13:52:40] ✅    ✅ Patient name validation passed
[13:52:40] 🔄 
🔄 Step 3: Processing patient dates...
[13:52:40] [DOC: 9233692] ℹ️  DOB normalized: 07/04/1946
[13:52:40] [DOC: 9233692] ℹ️  Episode startOfCare normalized: 03/23/2025
[13:52:40] [DOC: 9233692] ✅ Patient date processing completed successfully
[13:52:40] ✅    ✅ Date processing completed
[13:52:40] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Medeiros
     └─ dob: 07/04/1946
     └─ patientSex: 
     └─ medicalRecordNo: 000003097
     └─ billingProvider: Pothier, Jahn (MD (Dr. Alliance))
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2025', 'firstDiagnosis': 'J44.9', 'secondDiagnosis': 'Z99.81', 'thirdDiagnosis': 'M62.81', 'fourthDiagnosis': 'J18.9', 'fifthDiagnosis': 'R13.10', 'sixthDiagnosis': ''}]
[13:52:40] 🔄 
🔄 Step 4: Extracting order data...
[13:52:42] ℹ️  Order extraction - MRN: '000003097'
[13:52:42] ℹ️  Order extraction - Sex: ''
[13:52:42] ℹ️  Order extraction - Service Line: 'Speech Therapy'
[13:52:42] ℹ️  Order extraction - Payer Source: ''
[13:52:42] ✅ Order data extraction completed successfully
[13:52:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:52:42] ℹ️  Using MRN from patient data: '000003097' over '000003097'
[13:52:42] ⚠️  Could not determine sex using any available method
[13:52:42] ℹ️  Service line consistent in both sources: 'Speech Therapy'
[13:52:42] ✅ Patient name cross-validation successful
[13:52:42] ✅    ✅ Data merged successfully
[13:52:43] ✅    ✅ Order data extracted and validated
[13:52:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:52:43] [DOC: 9233692] ✅ Patient found in local cache: Gloria Medeiros, ID: 94edbecd-aff3-4eb4-8828-772617a0c5c6
[13:52:43] ✅    ✅ Existing patient found with ID: 94edbecd-aff3-4eb4-8828-772617a0c5c6
[13:52:43] 🔄 
🔄 Step 6: Pushing order to API...
[13:52:43] [DOC: 9233692] ℹ️  Pushing order via API for patient ID: 94edbecd-aff3-4eb4-8828-772617a0c5c6
[13:52:44] [DOC: 9233692] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:52:44] ❌    ❌ Failed to push order
[13:52:44] 🔄 
🔄 Step 7: Writing to CSV...
[13:52:44] [DOC: 9233692] ℹ️  Calculated age: 78 from DOB: 07/04/1946
[13:52:44] [DOC: 9233692] ℹ️  Service Line extracted: 'Speech Therapy'
[13:52:44] [DOC: 9233692] ℹ️  Payer Source extracted: ''
[13:52:44] [DOC: 9233692] ℹ️  Diagnosis codes being written:
[13:52:44] [DOC: 9233692] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.9'
[13:52:44] [DOC: 9233692] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z99.81'
[13:52:44] [DOC: 9233692] ℹ️    - Latest_Episode_Thirddiagnosis: 'M62.81'
[13:52:44] [DOC: 9233692] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J18.9'
[13:52:44] [DOC: 9233692] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R13.10'
[13:52:44] [DOC: 9233692] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:52:44] [DOC: 9233692] ✅ Patient data written to CSV: Gloria Medeiros | Sex:  | Age: 78 | Service: Speech Therapy | Payer:  | MRN: 000003097
[13:52:44] ✅    ✅ Document 9233692 processed and saved successfully
[13:52:44] 🔄 
🔄 Step 8: Saving API details...
[13:52:44] [DOC: 9233692] ℹ️  API push details saved for document 9233692
[13:52:44] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233632                         ║
================================================================================
[13:52:44] ℹ️  Agency: Alphacare Home Health Agency
[13:52:44] ℹ️  Date: 04/10/2025
[13:52:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:52:46] [DOC: 9233632] ✅ Text extracted using pdfplumber (1550 chars)
[13:52:46] ✅    ✅ Text extracted using pdfplumber (1550 chars)
[13:52:46] 🔄 
🔄 Step 2: Extracting patient data...
[13:52:49] ℹ️  AI extracted raw sex value: ''
[13:52:49] ℹ️  AI extracted service line: 'Speech Therapy'
[13:52:49] ℹ️  AI extracted payer source: ''
[13:52:49] ℹ️  AI extracted diagnoses:
[13:52:49] ℹ️    - Diagnosis 1: ''
[13:52:49] ℹ️    - Diagnosis 2: ''
[13:52:49] ℹ️    - Diagnosis 3: ''
[13:52:49] ℹ️    - Diagnosis 4: ''
[13:52:49] ℹ️    - Diagnosis 5: ''
[13:52:49] ℹ️    - Diagnosis 6: ''
[13:52:49] ℹ️  Final extracted MRN: '000003097'
[13:52:49] ℹ️  Final extracted Sex: ''
[13:52:49] ℹ️  Final extracted Service Line: 'Speech Therapy'
[13:52:49] ℹ️  Final extracted Payer Source: ''
[13:52:49] ✅ Patient data extraction completed successfully
[13:52:49] ✅    ✅ Patient data extracted successfully
[13:52:49] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Medeiros
     └─ dob: 07/04/1946
     └─ patientSex: 
     └─ medicalRecordNo: 000003097
     └─ billingProvider: Pothier, Jahn (MD (Dr. Alliance))
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: (617) 600-4547
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:52:49] ✅    ✅ Patient identified: Gloria Medeiros
[13:52:49] ✅    ✅ Patient name validation passed
[13:52:49] 🔄 
🔄 Step 3: Processing patient dates...
[13:52:49] [DOC: 9233632] ℹ️  DOB normalized: 07/04/1946
[13:52:49] [DOC: 9233632] ✅ Patient date processing completed successfully
[13:52:49] ✅    ✅ Date processing completed
[13:52:49] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Medeiros
     └─ dob: 07/04/1946
     └─ patientSex: 
     └─ medicalRecordNo: 000003097
     └─ billingProvider: Pothier, Jahn (MD (Dr. Alliance))
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: (617) 600-4547
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:52:49] 🔄 
🔄 Step 4: Extracting order data...
[13:52:51] ℹ️  Order extraction - MRN: '000003097'
[13:52:51] ℹ️  Order extraction - Sex: ''
[13:52:51] ℹ️  Order extraction - Service Line: 'Speech Therapy'
[13:52:51] ℹ️  Order extraction - Payer Source: ''
[13:52:51] ✅ Order data extraction completed successfully
[13:52:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:52:51] ℹ️  Using MRN from patient data: '000003097' over '000003097'
[13:52:51] ⚠️  Could not determine sex using any available method
[13:52:51] ℹ️  Service line consistent in both sources: 'Speech Therapy'
[13:52:51] ✅ Patient name cross-validation successful
[13:52:51] ✅    ✅ Data merged successfully
[13:52:53] ✅    ✅ Order data extracted and validated
[13:52:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:52:53] [DOC: 9233632] ✅ Patient found in local cache: Gloria Medeiros, ID: 94edbecd-aff3-4eb4-8828-772617a0c5c6
[13:52:53] ✅    ✅ Existing patient found with ID: 94edbecd-aff3-4eb4-8828-772617a0c5c6
[13:52:53] 🔄 
🔄 Step 6: Pushing order to API...
[13:52:53] [DOC: 9233632] ℹ️  Pushing order via API for patient ID: 94edbecd-aff3-4eb4-8828-772617a0c5c6
[13:52:54] [DOC: 9233632] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:52:54] ❌    ❌ Failed to push order
[13:52:54] 🔄 
🔄 Step 7: Writing to CSV...
[13:52:54] [DOC: 9233632] ℹ️  Calculated age: 78 from DOB: 07/04/1946
[13:52:54] [DOC: 9233632] ℹ️  Service Line extracted: 'Speech Therapy'
[13:52:54] [DOC: 9233632] ℹ️  Payer Source extracted: ''
[13:52:54] [DOC: 9233632] ℹ️  Diagnosis codes being written:
[13:52:54] [DOC: 9233632] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:52:54] [DOC: 9233632] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:52:54] [DOC: 9233632] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:52:54] [DOC: 9233632] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:52:54] [DOC: 9233632] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:52:54] [DOC: 9233632] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:52:54] [DOC: 9233632] ✅ Patient data written to CSV: Gloria Medeiros | Sex:  | Age: 78 | Service: Speech Therapy | Payer:  | MRN: 000003097
[13:52:54] ✅    ✅ Document 9233632 processed and saved successfully
[13:52:54] 🔄 
🔄 Step 8: Saving API details...
[13:52:54] [DOC: 9233632] ℹ️  API push details saved for document 9233632
[13:52:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233489                         ║
================================================================================
[13:52:54] ℹ️  Agency: AccentCare Fall River
[13:52:54] ℹ️  Date: 04/10/2025
[13:52:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:52:57] [DOC: 9233489] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[13:52:58] [DOC: 9233489] ✅ Text extracted using tesseract_ocr (1230 chars)
[13:52:58] ✅    ✅ Text extracted using tesseract_ocr (1221 chars)
[13:52:58] 🔄 
🔄 Step 2: Extracting patient data...
[13:53:01] ℹ️  AI extracted raw sex value: ''
[13:53:01] ℹ️  AI extracted service line: 'PT'
[13:53:01] ℹ️  AI extracted payer source: ''
[13:53:01] ℹ️  AI extracted diagnoses:
[13:53:01] ℹ️    - Diagnosis 1: 'None'
[13:53:01] ℹ️    - Diagnosis 2: 'None'
[13:53:01] ℹ️    - Diagnosis 3: 'None'
[13:53:01] ℹ️    - Diagnosis 4: 'None'
[13:53:01] ℹ️    - Diagnosis 5: 'None'
[13:53:01] ℹ️    - Diagnosis 6: 'None'
[13:53:01] ℹ️  Final extracted MRN: 'C0200235550301'
[13:53:01] ℹ️  Final extracted Sex: ''
[13:53:01] ℹ️  Final extracted Service Line: 'PT'
[13:53:01] ℹ️  Final extracted Payer Source: ''
[13:53:01] ✅ Patient data extraction completed successfully
[13:53:01] ✅    ✅ Patient data extracted successfully
[13:53:01] 📊 Patient Response
     └─ patientFName: DENISE
     └─ patientLName: PLASKON
     └─ dob: 07/20/1956
     └─ patientSex: 
     └─ medicalRecordNo: C0200235550301
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/25/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:53:01] ✅    ✅ Patient identified: DENISE PLASKON
[13:53:01] ✅    ✅ Patient name validation passed
[13:53:01] 🔄 
🔄 Step 3: Processing patient dates...
[13:53:01] [DOC: 9233489] ℹ️  DOB normalized: 07/20/1956
[13:53:01] [DOC: 9233489] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[13:53:01] [DOC: 9233489] ℹ️  Episode endOfEpisode normalized: 03/26/2025
[13:53:01] [DOC: 9233489] ✅ Patient date processing completed successfully
[13:53:01] ✅    ✅ Date processing completed
[13:53:01] 📊 Processed Patient Data
     └─ patientFName: DENISE
     └─ patientLName: PLASKON
     └─ dob: 07/20/1956
     └─ patientSex: 
     └─ medicalRecordNo: C0200235550301
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '03/26/2025'}]
[13:53:01] 🔄 
🔄 Step 4: Extracting order data...
[13:53:03] ℹ️  Order extraction - MRN: 'C0200235550301'
[13:53:03] ℹ️  Order extraction - Sex: 'FEMALE'
[13:53:03] ℹ️  Order extraction - Service Line: 'PT'
[13:53:03] ℹ️  Order extraction - Payer Source: ''
[13:53:03] ✅ Order data extraction completed successfully
[13:53:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:53:03] ℹ️  Using MRN from patient data: 'C0200235550301' over 'C0200235550301'
[13:53:03] ℹ️  Service line consistent in both sources: 'PT'
[13:53:03] ✅ Patient name cross-validation successful
[13:53:03] ✅    ✅ Data merged successfully
[13:53:05] ✅    ✅ Order data extracted and validated
[13:53:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:53:16] [DOC: 9233489] ℹ️  Patient not found in cache or API: DENISE PLASKON
[13:53:16] [DOC: 9233489] ℹ️  Patient not found, creating new patient via API...
[13:53:16] [DOC: 9233489] ℹ️  Creating patient via API: DENISE PLASKON
[13:53:17] [DOC: 9233489] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:53:17] ❌    ❌ Failed to create patient
[13:53:17] [DOC: 9233489] ℹ️  API push details saved for document 9233489
================================================================================
║                        Processing Document ID: 9233295                         ║
================================================================================
[13:53:17] ℹ️  Agency: Dartmouth HH
[13:53:17] ℹ️  Date: 04/10/2025
[13:53:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:53:20] [DOC: 9233295] ✅ Text extracted using pdfplumber (5101 chars)
[13:53:20] ✅    ✅ Text extracted using pdfplumber (5101 chars)
[13:53:20] 🔄 
🔄 Step 2: Extracting patient data...
[13:53:23] ℹ️  AI extracted raw sex value: 'F'
[13:53:23] ℹ️  AI extracted service line: 'PT'
[13:53:23] ℹ️  AI extracted payer source: 'Medicare'
[13:53:23] ℹ️  AI extracted diagnoses:
[13:53:23] ℹ️    - Diagnosis 1: 'Hypoxemia'
[13:53:23] ℹ️    - Diagnosis 2: 'Interstitial lung disease'
[13:53:23] ℹ️    - Diagnosis 3: 'Spinal stenosis'
[13:53:23] ℹ️    - Diagnosis 4: 'Depression'
[13:53:23] ℹ️    - Diagnosis 5: 'Osteoporosis'
[13:53:23] ℹ️    - Diagnosis 6: 'Alopecia'
[13:53:23] ℹ️  Final extracted MRN: '4799015'
[13:53:23] ℹ️  Final extracted Sex: 'FEMALE'
[13:53:23] ℹ️  Final extracted Service Line: 'PT'
[13:53:23] ℹ️  Final extracted Payer Source: 'Medicare'
[13:53:23] ✅ Patient data extraction completed successfully
[13:53:23] ✅    ✅ Patient data extracted successfully
[13:53:23] 📊 Patient Response
     └─ patientFName: Agatina
     └─ patientLName: Manna
     └─ dob: 03/10/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4799015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/17/2024', 'startOfEpisode': '11/17/2024', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'Hypoxemia', 'secondDiagnosis': 'Interstitial lung disease', 'thirdDiagnosis': 'Spinal stenosis', 'fourthDiagnosis': 'Depression', 'fifthDiagnosis': 'Osteoporosis', 'sixthDiagnosis': 'Alopecia'}]
[13:53:23] ✅    ✅ Patient identified: Agatina Manna
[13:53:23] ✅    ✅ Patient name validation passed
[13:53:23] 🔄 
🔄 Step 3: Processing patient dates...
[13:53:23] [DOC: 9233295] ℹ️  DOB normalized: 03/10/1937
[13:53:23] [DOC: 9233295] ℹ️  Episode startOfCare normalized: 11/17/2024
[13:53:23] [DOC: 9233295] ℹ️  Episode startOfEpisode normalized: 11/17/2024
[13:53:23] [DOC: 9233295] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[13:53:23] [DOC: 9233295] ✅ Patient date processing completed successfully
[13:53:23] ✅    ✅ Date processing completed
[13:53:23] 📊 Processed Patient Data
     └─ patientFName: Agatina
     └─ patientLName: Manna
     └─ dob: 03/10/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4799015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/17/2024', 'startOfEpisode': '11/17/2024', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'Hypoxemia', 'secondDiagnosis': 'Interstitial lung disease', 'thirdDiagnosis': 'Spinal stenosis', 'fourthDiagnosis': 'Depression', 'fifthDiagnosis': 'Osteoporosis', 'sixthDiagnosis': 'Alopecia'}]
[13:53:23] 🔄 
🔄 Step 4: Extracting order data...
[13:53:25] ℹ️  Order extraction - MRN: '4799015'
[13:53:25] ℹ️  Order extraction - Sex: 'FEMALE'
[13:53:25] ℹ️  Order extraction - Service Line: 'PT'
[13:53:25] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:53:25] ✅ Order data extraction completed successfully
[13:53:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:53:25] ℹ️  Using MRN from patient data: '4799015' over '4799015'
[13:53:25] ℹ️  Service line consistent in both sources: 'PT'
[13:53:25] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:53:25] ✅ Patient name cross-validation successful
[13:53:25] ✅    ✅ Data merged successfully
[13:53:27] ✅    ✅ Order data extracted and validated
[13:53:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:53:27] [DOC: 9233295] ✅ Patient found in local cache: Agatina Manna, ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[13:53:27] ✅    ✅ Existing patient found with ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[13:53:27] 🔄 
🔄 Step 6: Pushing order to API...
[13:53:27] [DOC: 9233295] ℹ️  Pushing order via API for patient ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[13:53:28] [DOC: 9233295] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:53:28] ❌    ❌ Failed to push order
[13:53:28] 🔄 
🔄 Step 7: Writing to CSV...
[13:53:28] [DOC: 9233295] ℹ️  Calculated age: 88 from DOB: 03/10/1937
[13:53:28] [DOC: 9233295] ℹ️  Service Line extracted: 'PT'
[13:53:28] [DOC: 9233295] ℹ️  Payer Source extracted: 'Medicare'
[13:53:28] [DOC: 9233295] ℹ️  Diagnosis codes being written:
[13:53:28] [DOC: 9233295] ℹ️    - Latest_Episode_Firstdiagnosis: 'Hypoxemia'
[13:53:28] [DOC: 9233295] ℹ️    - Latest_Episode_Seconddiagnosis: 'Interstitial lung disease'
[13:53:28] [DOC: 9233295] ℹ️    - Latest_Episode_Thirddiagnosis: 'Spinal stenosis'
[13:53:28] [DOC: 9233295] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Depression'
[13:53:28] [DOC: 9233295] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Osteoporosis'
[13:53:28] [DOC: 9233295] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Alopecia'
[13:53:28] [DOC: 9233295] ✅ Patient data written to CSV: Agatina Manna | Sex: FEMALE | Age: 88 | Service: PT | Payer: Medicare | MRN: 4799015
[13:53:28] ✅    ✅ Document 9233295 processed and saved successfully
[13:53:28] 🔄 
🔄 Step 8: Saving API details...
[13:53:28] [DOC: 9233295] ℹ️  API push details saved for document 9233295
[13:53:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233292                         ║
================================================================================
[13:53:28] ℹ️  Agency: Dartmouth HH
[13:53:28] ℹ️  Date: 04/10/2025
[13:53:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:53:30] [DOC: 9233292] ✅ Text extracted using pdfplumber (1442 chars)
[13:53:30] ✅    ✅ Text extracted using pdfplumber (1442 chars)
[13:53:30] 🔄 
🔄 Step 2: Extracting patient data...
[13:53:33] ℹ️  AI extracted raw sex value: 'M'
[13:53:33] ℹ️  AI extracted service line: 'PT, OT'
[13:53:33] ℹ️  AI extracted payer source: 'Medicare'
[13:53:33] ℹ️  AI extracted diagnoses:
[13:53:33] ℹ️    - Diagnosis 1: 'None'
[13:53:33] ℹ️    - Diagnosis 2: 'None'
[13:53:33] ℹ️    - Diagnosis 3: 'None'
[13:53:33] ℹ️    - Diagnosis 4: 'None'
[13:53:33] ℹ️    - Diagnosis 5: 'None'
[13:53:33] ℹ️    - Diagnosis 6: 'None'
[13:53:33] ℹ️  Final extracted MRN: '6142015'
[13:53:33] ℹ️  Final extracted Sex: 'MALE'
[13:53:33] ℹ️  Final extracted Service Line: 'PT, OT'
[13:53:33] ℹ️  Final extracted Payer Source: 'Medicare'
[13:53:33] ✅ Patient data extraction completed successfully
[13:53:33] ✅    ✅ Patient data extracted successfully
[13:53:33] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Sleight
     └─ dob: 07/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6142015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:53:33] ✅    ✅ Patient identified: Raymond Sleight
[13:53:33] ✅    ✅ Patient name validation passed
[13:53:33] 🔄 
🔄 Step 3: Processing patient dates...
[13:53:33] [DOC: 9233292] ℹ️  DOB normalized: 07/10/1942
[13:53:33] [DOC: 9233292] ℹ️  Episode startOfCare normalized: 03/13/2025
[13:53:33] [DOC: 9233292] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[13:53:33] [DOC: 9233292] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[13:53:33] [DOC: 9233292] ✅ Patient date processing completed successfully
[13:53:33] ✅    ✅ Date processing completed
[13:53:33] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Sleight
     └─ dob: 07/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6142015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025'}]
[13:53:33] 🔄 
🔄 Step 4: Extracting order data...
[13:53:35] ℹ️  Order extraction - MRN: ''
[13:53:35] ℹ️  Order extraction - Sex: 'MALE'
[13:53:35] ℹ️  Order extraction - Service Line: 'PT, OT'
[13:53:35] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:53:35] ✅ Order data extraction completed successfully
[13:53:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:53:35] ℹ️  Using MRN from patient data: '6142015'
[13:53:35] ℹ️  Service line consistent in both sources: 'PT, OT'
[13:53:35] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:53:35] ✅ Patient name cross-validation successful
[13:53:35] ✅    ✅ Data merged successfully
[13:53:37] ✅    ✅ Order data extracted and validated
[13:53:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:53:37] [DOC: 9233292] ✅ Patient found in local cache: Raymond Sleight, ID: ae8026f6-4ac7-4693-a56a-b5eabb5428a2
[13:53:37] ✅    ✅ Existing patient found with ID: ae8026f6-4ac7-4693-a56a-b5eabb5428a2
[13:53:37] 🔄 
🔄 Step 6: Pushing order to API...
[13:53:37] [DOC: 9233292] ℹ️  Pushing order via API for patient ID: ae8026f6-4ac7-4693-a56a-b5eabb5428a2
[13:53:38] [DOC: 9233292] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14432"}
[13:53:38] ❌    ❌ Failed to push order
[13:53:38] 🔄 
🔄 Step 7: Writing to CSV...
[13:53:38] [DOC: 9233292] ℹ️  Calculated age: 82 from DOB: 07/10/1942
[13:53:38] [DOC: 9233292] ℹ️  Service Line extracted: 'PT, OT'
[13:53:38] [DOC: 9233292] ℹ️  Payer Source extracted: 'Medicare'
[13:53:38] [DOC: 9233292] ℹ️  Diagnosis codes being written:
[13:53:38] [DOC: 9233292] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:53:38] [DOC: 9233292] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:53:38] [DOC: 9233292] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:53:38] [DOC: 9233292] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:53:38] [DOC: 9233292] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:53:38] [DOC: 9233292] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:53:38] [DOC: 9233292] ✅ Patient data written to CSV: Raymond Sleight | Sex: MALE | Age: 82 | Service: PT, OT | Payer: Medicare | MRN: 6142015
[13:53:38] ✅    ✅ Document 9233292 processed and saved successfully
[13:53:38] 🔄 
🔄 Step 8: Saving API details...
[13:53:38] [DOC: 9233292] ℹ️  API push details saved for document 9233292
[13:53:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233290                         ║
================================================================================
[13:53:38] ℹ️  Agency: Dartmouth HH
[13:53:38] ℹ️  Date: 04/10/2025
[13:53:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:53:41] [DOC: 9233290] ✅ Text extracted using pdfplumber (1106 chars)
[13:53:41] ✅    ✅ Text extracted using pdfplumber (1106 chars)
[13:53:41] 🔄 
🔄 Step 2: Extracting patient data...
[13:53:43] ℹ️  AI extracted raw sex value: 'F'
[13:53:43] ℹ️  AI extracted service line: 'RN'
[13:53:43] ℹ️  AI extracted payer source: 'Fallon Navicare'
[13:53:43] ℹ️  AI extracted diagnoses:
[13:53:43] ℹ️    - Diagnosis 1: ''
[13:53:43] ℹ️    - Diagnosis 2: ''
[13:53:43] ℹ️    - Diagnosis 3: ''
[13:53:43] ℹ️    - Diagnosis 4: ''
[13:53:43] ℹ️    - Diagnosis 5: ''
[13:53:43] ℹ️    - Diagnosis 6: ''
[13:53:43] ℹ️  Final extracted MRN: '7544009'
[13:53:43] ℹ️  Final extracted Sex: 'FEMALE'
[13:53:43] ℹ️  Final extracted Service Line: 'RN'
[13:53:43] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[13:53:43] ✅ Patient data extraction completed successfully
[13:53:43] ✅    ✅ Patient data extracted successfully
[13:53:43] 📊 Patient Response
     └─ patientFName: Sandra
     └─ patientLName: Knickerbocker
     └─ dob: 07/22/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7544009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:53:43] ✅    ✅ Patient identified: Sandra Knickerbocker
[13:53:43] ✅    ✅ Patient name validation passed
[13:53:43] 🔄 
🔄 Step 3: Processing patient dates...
[13:53:43] [DOC: 9233290] ℹ️  DOB normalized: 07/22/1948
[13:53:43] [DOC: 9233290] ℹ️  Episode startOfCare normalized: 03/26/2025
[13:53:43] [DOC: 9233290] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[13:53:43] [DOC: 9233290] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[13:53:43] [DOC: 9233290] ✅ Patient date processing completed successfully
[13:53:43] ✅    ✅ Date processing completed
[13:53:43] 📊 Processed Patient Data
     └─ patientFName: Sandra
     └─ patientLName: Knickerbocker
     └─ dob: 07/22/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7544009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:53:43] 🔄 
🔄 Step 4: Extracting order data...
[13:53:46] ℹ️  Order extraction - MRN: ''
[13:53:46] ℹ️  Order extraction - Sex: 'FEMALE'
[13:53:46] ℹ️  Order extraction - Service Line: 'RN'
[13:53:46] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[13:53:46] ✅ Order data extraction completed successfully
[13:53:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:53:46] ℹ️  Using MRN from patient data: '7544009'
[13:53:46] ℹ️  Service line consistent in both sources: 'RN'
[13:53:46] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[13:53:46] ✅ Patient name cross-validation successful
[13:53:46] ✅    ✅ Data merged successfully
[13:53:47] ✅    ✅ Order data extracted and validated
[13:53:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:53:47] [DOC: 9233290] ✅ Patient found in local cache: Sandra Knickerbocker, ID: 72b6d189-6994-4d0a-9e48-56e329440311
[13:53:47] ✅    ✅ Existing patient found with ID: 72b6d189-6994-4d0a-9e48-56e329440311
[13:53:47] 🔄 
🔄 Step 6: Pushing order to API...
[13:53:47] [DOC: 9233290] ℹ️  Pushing order via API for patient ID: 72b6d189-6994-4d0a-9e48-56e329440311
[13:53:48] [DOC: 9233290] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13882"}
[13:53:48] ❌    ❌ Failed to push order
[13:53:48] 🔄 
🔄 Step 7: Writing to CSV...
[13:53:48] [DOC: 9233290] ℹ️  Calculated age: 76 from DOB: 07/22/1948
[13:53:48] [DOC: 9233290] ℹ️  Service Line extracted: 'RN'
[13:53:48] [DOC: 9233290] ℹ️  Payer Source extracted: 'Fallon Navicare'
[13:53:48] [DOC: 9233290] ℹ️  Diagnosis codes being written:
[13:53:48] [DOC: 9233290] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:53:48] [DOC: 9233290] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:53:48] [DOC: 9233290] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:53:48] [DOC: 9233290] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:53:48] [DOC: 9233290] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:53:48] [DOC: 9233290] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:53:48] [DOC: 9233290] ✅ Patient data written to CSV: Sandra Knickerbocker | Sex: FEMALE | Age: 76 | Service: RN | Payer: Fallon Navicare | MRN: 7544009
[13:53:48] ✅    ✅ Document 9233290 processed and saved successfully
[13:53:48] 🔄 
🔄 Step 8: Saving API details...
[13:53:48] [DOC: 9233290] ℹ️  API push details saved for document 9233290
[13:53:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233281                         ║
================================================================================
[13:53:48] ℹ️  Agency: Dartmouth HH
[13:53:48] ℹ️  Date: 04/10/2025
[13:53:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:53:53] [DOC: 9233281] ✅ Text extracted using pdfplumber (10429 chars)
[13:53:53] ✅    ✅ Text extracted using pdfplumber (10429 chars)
[13:53:53] 🔄 
🔄 Step 2: Extracting patient data...
[13:53:57] ℹ️  AI extracted raw sex value: 'F'
[13:53:57] ℹ️  AI extracted service line: 'Skilled Nursing, HHA'
[13:53:57] ℹ️  AI extracted payer source: ''
[13:53:57] ℹ️  AI extracted diagnoses:
[13:53:57] ℹ️    - Diagnosis 1: 'C50.911'
[13:53:57] ℹ️    - Diagnosis 2: 'C79.51'
[13:53:57] ℹ️    - Diagnosis 3: 'C78.7'
[13:53:57] ℹ️    - Diagnosis 4: 'K59.00'
[13:53:57] ℹ️    - Diagnosis 5: 'F34.1'
[13:53:57] ℹ️    - Diagnosis 6: 'M79.10'
[13:53:57] ℹ️  Final extracted MRN: '5333015'
[13:53:57] ℹ️  Final extracted Sex: 'FEMALE'
[13:53:57] ℹ️  Final extracted Service Line: 'Skilled Nursing, HHA'
[13:53:57] ℹ️  Final extracted Payer Source: ''
[13:53:57] ✅ Patient data extraction completed successfully
[13:53:57] ✅    ✅ Patient data extracted successfully
[13:53:57] 📊 Patient Response
     └─ patientFName: Cecilia
     └─ patientLName: Gafitanu
     └─ dob: 12/27/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5333015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/05/2024', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'C50.911', 'secondDiagnosis': 'C79.51', 'thirdDiagnosis': 'C78.7', 'fourthDiagnosis': 'K59.00', 'fifthDiagnosis': 'F34.1', 'sixthDiagnosis': 'M79.10'}]
[13:53:57] ✅    ✅ Patient identified: Cecilia Gafitanu
[13:53:57] ✅    ✅ Patient name validation passed
[13:53:57] 🔄 
🔄 Step 3: Processing patient dates...
[13:53:57] [DOC: 9233281] ℹ️  DOB normalized: 12/27/1964
[13:53:57] [DOC: 9233281] ℹ️  Episode startOfCare normalized: 10/05/2024
[13:53:57] [DOC: 9233281] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[13:53:57] [DOC: 9233281] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[13:53:57] [DOC: 9233281] ✅ Patient date processing completed successfully
[13:53:57] ✅    ✅ Date processing completed
[13:53:57] 📊 Processed Patient Data
     └─ patientFName: Cecilia
     └─ patientLName: Gafitanu
     └─ dob: 12/27/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5333015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/05/2024', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'C50.911', 'secondDiagnosis': 'C79.51', 'thirdDiagnosis': 'C78.7', 'fourthDiagnosis': 'K59.00', 'fifthDiagnosis': 'F34.1', 'sixthDiagnosis': 'M79.10'}]
[13:53:57] 🔄 
🔄 Step 4: Extracting order data...
[13:53:59] ℹ️  Order extraction - MRN: '5333015'
[13:53:59] ℹ️  Order extraction - Sex: 'FEMALE'
[13:53:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing, HHA'
[13:53:59] ℹ️  Order extraction - Payer Source: ''
[13:53:59] ✅ Order data extraction completed successfully
[13:53:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:53:59] ℹ️  Using MRN from patient data: '5333015' over '5333015'
[13:53:59] ℹ️  Service line consistent in both sources: 'Skilled Nursing, HHA'
[13:53:59] ✅ Patient name cross-validation successful
[13:53:59] ✅    ✅ Data merged successfully
[13:54:04] ✅    ✅ Order data extracted and validated
[13:54:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:54:16] [DOC: 9233281] ✅ Patient exists in API: Cecilia Gafitanu, ID: a2c0cc94-c259-4767-8632-854b4dd2548e
[13:54:16] ✅    ✅ Existing patient found with ID: a2c0cc94-c259-4767-8632-854b4dd2548e
[13:54:16] 🔄 
🔄 Step 6: Pushing order to API...
[13:54:16] [DOC: 9233281] ℹ️  Pushing order via API for patient ID: a2c0cc94-c259-4767-8632-854b4dd2548e
[13:54:17] [DOC: 9233281] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:54:17] ❌    ❌ Failed to push order
[13:54:17] 🔄 
🔄 Step 7: Writing to CSV...
[13:54:17] [DOC: 9233281] ℹ️  Calculated age: 60 from DOB: 12/27/1964
[13:54:17] [DOC: 9233281] ℹ️  Service Line extracted: 'Skilled Nursing, HHA'
[13:54:17] [DOC: 9233281] ℹ️  Payer Source extracted: ''
[13:54:17] [DOC: 9233281] ℹ️  Diagnosis codes being written:
[13:54:17] [DOC: 9233281] ℹ️    - Latest_Episode_Firstdiagnosis: 'C50.911'
[13:54:17] [DOC: 9233281] ℹ️    - Latest_Episode_Seconddiagnosis: 'C79.51'
[13:54:17] [DOC: 9233281] ℹ️    - Latest_Episode_Thirddiagnosis: 'C78.7'
[13:54:17] [DOC: 9233281] ℹ️    - Latest_Episode_Fourthdiagnosis: 'K59.00'
[13:54:17] [DOC: 9233281] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F34.1'
[13:54:17] [DOC: 9233281] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M79.10'
[13:54:17] [DOC: 9233281] ✅ Patient data written to CSV: Cecilia Gafitanu | Sex: FEMALE | Age: 60 | Service: Skilled Nursing, HHA | Payer:  | MRN: 5333015
[13:54:17] ✅    ✅ Document 9233281 processed and saved successfully
[13:54:17] 🔄 
🔄 Step 8: Saving API details...
[13:54:17] [DOC: 9233281] ℹ️  API push details saved for document 9233281
[13:54:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233275                         ║
================================================================================
[13:54:17] ℹ️  Agency: Dartmouth HH
[13:54:17] ℹ️  Date: 04/10/2025
[13:54:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:54:20] [DOC: 9233275] ✅ Text extracted using pdfplumber (11879 chars)
[13:54:20] ✅    ✅ Text extracted using pdfplumber (11879 chars)
[13:54:20] 🔄 
🔄 Step 2: Extracting patient data...
[13:54:23] ℹ️  AI extracted raw sex value: 'F'
[13:54:23] ℹ️  AI extracted service line: 'PT, RN'
[13:54:23] ℹ️  AI extracted payer source: 'None'
[13:54:23] ℹ️  AI extracted diagnoses:
[13:54:23] ℹ️    - Diagnosis 1: 'S12.000D'
[13:54:23] ℹ️    - Diagnosis 2: 'M54.50'
[13:54:23] ℹ️    - Diagnosis 3: 'M54.2'
[13:54:23] ℹ️    - Diagnosis 4: 'R26.81'
[13:54:23] ℹ️    - Diagnosis 5: 'E66.9'
[13:54:23] ℹ️    - Diagnosis 6: 'Z68.35'
[13:54:23] ℹ️  Final extracted MRN: '5610015'
[13:54:23] ℹ️  Final extracted Sex: 'FEMALE'
[13:54:23] ℹ️  Final extracted Service Line: 'PT, RN'
[13:54:23] ℹ️  Final extracted Payer Source: ''
[13:54:23] ✅ Patient data extraction completed successfully
[13:54:23] ✅    ✅ Patient data extracted successfully
[13:54:23] 📊 Patient Response
     └─ patientFName: Elaine
     └─ patientLName: Miranda
     └─ dob: 02/19/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5610015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 100009477603
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'S12.000D', 'secondDiagnosis': 'M54.50', 'thirdDiagnosis': 'M54.2', 'fourthDiagnosis': 'R26.81', 'fifthDiagnosis': 'E66.9', 'sixthDiagnosis': 'Z68.35'}]
[13:54:23] ✅    ✅ Patient identified: Elaine Miranda
[13:54:23] ✅    ✅ Patient name validation passed
[13:54:23] 🔄 
🔄 Step 3: Processing patient dates...
[13:54:23] [DOC: 9233275] ℹ️  DOB normalized: 02/19/1959
[13:54:23] [DOC: 9233275] ℹ️  Episode startOfCare normalized: 03/25/2025
[13:54:23] [DOC: 9233275] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[13:54:23] [DOC: 9233275] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[13:54:23] [DOC: 9233275] ✅ Patient date processing completed successfully
[13:54:23] ✅    ✅ Date processing completed
[13:54:23] 📊 Processed Patient Data
     └─ patientFName: Elaine
     └─ patientLName: Miranda
     └─ dob: 02/19/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5610015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 100009477603
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'S12.000D', 'secondDiagnosis': 'M54.50', 'thirdDiagnosis': 'M54.2', 'fourthDiagnosis': 'R26.81', 'fifthDiagnosis': 'E66.9', 'sixthDiagnosis': 'Z68.35'}]
[13:54:23] 🔄 
🔄 Step 4: Extracting order data...
[13:54:25] ℹ️  Order extraction - MRN: '5610015'
[13:54:25] ℹ️  Order extraction - Sex: 'FEMALE'
[13:54:25] ℹ️  Order extraction - Service Line: 'PT, RN'
[13:54:25] ℹ️  Order extraction - Payer Source: ''
[13:54:25] ✅ Order data extraction completed successfully
[13:54:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:54:25] ℹ️  Using MRN from patient data: '5610015' over '5610015'
[13:54:25] ℹ️  Service line consistent in both sources: 'PT, RN'
[13:54:25] ✅ Patient name cross-validation successful
[13:54:25] ✅    ✅ Data merged successfully
[13:54:27] ✅    ✅ Order data extracted and validated
[13:54:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:54:27] [DOC: 9233275] ✅ Patient found in local cache: Elaine Miranda, ID: 68c9da11-eed8-438a-a027-146bf04743d0
[13:54:27] ✅    ✅ Existing patient found with ID: 68c9da11-eed8-438a-a027-146bf04743d0
[13:54:27] 🔄 
🔄 Step 6: Pushing order to API...
[13:54:27] [DOC: 9233275] ℹ️  Pushing order via API for patient ID: 68c9da11-eed8-438a-a027-146bf04743d0
[13:54:28] [DOC: 9233275] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:54:28] ❌    ❌ Failed to push order
[13:54:28] 🔄 
🔄 Step 7: Writing to CSV...
[13:54:28] [DOC: 9233275] ℹ️  Calculated age: 66 from DOB: 02/19/1959
[13:54:28] [DOC: 9233275] ℹ️  Service Line extracted: 'PT, RN'
[13:54:28] [DOC: 9233275] ℹ️  Payer Source extracted: ''
[13:54:28] [DOC: 9233275] ℹ️  Diagnosis codes being written:
[13:54:28] [DOC: 9233275] ℹ️    - Latest_Episode_Firstdiagnosis: 'S12.000D'
[13:54:28] [DOC: 9233275] ℹ️    - Latest_Episode_Seconddiagnosis: 'M54.50'
[13:54:28] [DOC: 9233275] ℹ️    - Latest_Episode_Thirddiagnosis: 'M54.2'
[13:54:28] [DOC: 9233275] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R26.81'
[13:54:28] [DOC: 9233275] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E66.9'
[13:54:28] [DOC: 9233275] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z68.35'
[13:54:28] [DOC: 9233275] ✅ Patient data written to CSV: Elaine Miranda | Sex: FEMALE | Age: 66 | Service: PT, RN | Payer:  | MRN: 5610015
[13:54:28] ✅    ✅ Document 9233275 processed and saved successfully
[13:54:28] 🔄 
🔄 Step 8: Saving API details...
[13:54:28] [DOC: 9233275] ℹ️  API push details saved for document 9233275
[13:54:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233268                         ║
================================================================================
[13:54:28] ℹ️  Agency: Dartmouth HH
[13:54:28] ℹ️  Date: 04/10/2025
[13:54:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:54:30] [DOC: 9233268] ✅ Text extracted using pdfplumber (4765 chars)
[13:54:30] ✅    ✅ Text extracted using pdfplumber (4765 chars)
[13:54:30] 🔄 
🔄 Step 2: Extracting patient data...
[13:54:33] ℹ️  AI extracted raw sex value: 'F'
[13:54:33] ℹ️  AI extracted service line: 'PT'
[13:54:33] ℹ️  AI extracted payer source: 'Medicare'
[13:54:33] ℹ️  AI extracted diagnoses:
[13:54:33] ℹ️    - Diagnosis 1: ''
[13:54:33] ℹ️    - Diagnosis 2: ''
[13:54:33] ℹ️    - Diagnosis 3: ''
[13:54:33] ℹ️    - Diagnosis 4: ''
[13:54:33] ℹ️    - Diagnosis 5: ''
[13:54:33] ℹ️    - Diagnosis 6: ''
[13:54:33] ℹ️  Final extracted MRN: '5025015'
[13:54:33] ℹ️  Final extracted Sex: 'FEMALE'
[13:54:33] ℹ️  Final extracted Service Line: 'PT'
[13:54:33] ℹ️  Final extracted Payer Source: 'Medicare'
[13:54:33] ✅ Patient data extraction completed successfully
[13:54:33] ✅    ✅ Patient data extracted successfully
[13:54:33] 📊 Patient Response
     └─ patientFName: Lorraine
     └─ patientLName: Harrington
     └─ dob: 09/29/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5025015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:54:33] ✅    ✅ Patient identified: Lorraine Harrington
[13:54:33] ✅    ✅ Patient name validation passed
[13:54:33] 🔄 
🔄 Step 3: Processing patient dates...
[13:54:33] [DOC: 9233268] ℹ️  DOB normalized: 09/29/1940
[13:54:33] [DOC: 9233268] ℹ️  Episode startOfCare normalized: 02/28/2025
[13:54:33] [DOC: 9233268] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[13:54:33] [DOC: 9233268] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[13:54:33] [DOC: 9233268] ✅ Patient date processing completed successfully
[13:54:33] ✅    ✅ Date processing completed
[13:54:33] 📊 Processed Patient Data
     └─ patientFName: Lorraine
     └─ patientLName: Harrington
     └─ dob: 09/29/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5025015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:54:33] 🔄 
🔄 Step 4: Extracting order data...
[13:54:35] ℹ️  Order extraction - MRN: ''
[13:54:35] ℹ️  Order extraction - Sex: 'FEMALE'
[13:54:35] ℹ️  Order extraction - Service Line: 'PT'
[13:54:35] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:54:35] ✅ Order data extraction completed successfully
[13:54:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:54:35] ℹ️  Using MRN from patient data: '5025015'
[13:54:35] ℹ️  Service line consistent in both sources: 'PT'
[13:54:35] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:54:35] ✅ Patient name cross-validation successful
[13:54:35] ✅    ✅ Data merged successfully
[13:54:37] ✅    ✅ Order data extracted and validated
[13:54:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:55:08] [DOC: 9233268] ℹ️  Patient not found in cache or API: Lorraine Harrington
[13:55:08] [DOC: 9233268] ℹ️  Patient not found, creating new patient via API...
[13:55:08] [DOC: 9233268] ℹ️  Creating patient via API: Lorraine Harrington
[13:55:10] [DOC: 9233268] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:55:10] ❌    ❌ Failed to create patient
[13:55:10] [DOC: 9233268] ℹ️  API push details saved for document 9233268
================================================================================
║                        Processing Document ID: 9233262                         ║
================================================================================
[13:55:10] ℹ️  Agency: Dartmouth HH
[13:55:10] ℹ️  Date: 04/10/2025
[13:55:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:55:13] [DOC: 9233262] ✅ Text extracted using pdfplumber (17666 chars)
[13:55:13] ✅    ✅ Text extracted using pdfplumber (17654 chars)
[13:55:13] 🔄 
🔄 Step 2: Extracting patient data...
[13:55:16] ℹ️  AI extracted raw sex value: 'F'
[13:55:16] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[13:55:16] ℹ️  AI extracted payer source: ''
[13:55:16] ℹ️  AI extracted diagnoses:
[13:55:16] ℹ️    - Diagnosis 1: 'S06.6XAD'
[13:55:16] ℹ️    - Diagnosis 2: 'N13.2'
[13:55:16] ℹ️    - Diagnosis 3: 'N12'
[13:55:16] ℹ️    - Diagnosis 4: 'Z96.0'
[13:55:16] ℹ️    - Diagnosis 5: 'I13.0'
[13:55:16] ℹ️    - Diagnosis 6: 'I50.33'
[13:55:16] ℹ️  Final extracted MRN: '5862015'
[13:55:16] ℹ️  Final extracted Sex: 'FEMALE'
[13:55:16] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[13:55:16] ℹ️  Final extracted Payer Source: ''
[13:55:16] ✅ Patient data extraction completed successfully
[13:55:16] ✅    ✅ Patient data extracted successfully
[13:55:16] 📊 Patient Response
     └─ patientFName: Janice G
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '02/08/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'S06.6XAD', 'secondDiagnosis': 'N13.2', 'thirdDiagnosis': 'N12', 'fourthDiagnosis': 'Z96.0', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.33'}]
[13:55:16] ✅    ✅ Patient identified: Janice G Arruda
[13:55:16] ✅    ✅ Patient name validation passed
[13:55:16] 🔄 
🔄 Step 3: Processing patient dates...
[13:55:16] [DOC: 9233262] ℹ️  DOB normalized: 01/24/1950
[13:55:16] [DOC: 9233262] ℹ️  Episode startOfCare normalized: 02/08/2025
[13:55:16] [DOC: 9233262] ℹ️  Episode startOfEpisode normalized: 02/08/2025
[13:55:16] [DOC: 9233262] ℹ️  Episode endOfEpisode normalized: 06/07/2025
[13:55:16] [DOC: 9233262] ✅ Patient date processing completed successfully
[13:55:16] ✅    ✅ Date processing completed
[13:55:16] 📊 Processed Patient Data
     └─ patientFName: Janice G
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '02/08/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'S06.6XAD', 'secondDiagnosis': 'N13.2', 'thirdDiagnosis': 'N12', 'fourthDiagnosis': 'Z96.0', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.33'}]
[13:55:16] 🔄 
🔄 Step 4: Extracting order data...
[13:55:19] ℹ️  Order extraction - MRN: '5862015'
[13:55:19] ℹ️  Order extraction - Sex: 'FEMALE'
[13:55:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[13:55:19] ℹ️  Order extraction - Payer Source: ''
[13:55:19] ✅ Order data extraction completed successfully
[13:55:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:55:19] ℹ️  Using MRN from patient data: '5862015' over '5862015'
[13:55:19] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[13:55:19] ✅ Patient name cross-validation successful
[13:55:19] ✅    ✅ Data merged successfully
[13:55:20] ✅    ✅ Order data extracted and validated
[13:55:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:55:28] [DOC: 9233262] ℹ️  Patient not found in cache or API: Janice G Arruda
[13:55:28] [DOC: 9233262] ℹ️  Patient not found, creating new patient via API...
[13:55:28] [DOC: 9233262] ℹ️  Creating patient via API: Janice G Arruda
[13:55:29] [DOC: 9233262] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:55:29] ❌    ❌ Failed to create patient
[13:55:29] [DOC: 9233262] ℹ️  API push details saved for document 9233262
================================================================================
║                        Processing Document ID: 9233261                         ║
================================================================================
[13:55:29] ℹ️  Agency: Dartmouth HH
[13:55:29] ℹ️  Date: 04/10/2025
[13:55:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:55:31] [DOC: 9233261] ✅ Text extracted using pdfplumber (1136 chars)
[13:55:31] ✅    ✅ Text extracted using pdfplumber (1136 chars)
[13:55:31] 🔄 
🔄 Step 2: Extracting patient data...
[13:55:33] ℹ️  AI extracted raw sex value: 'F'
[13:55:33] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:55:33] ℹ️  AI extracted payer source: 'Medicare'
[13:55:33] ℹ️  AI extracted diagnoses:
[13:55:33] ℹ️    - Diagnosis 1: ''
[13:55:33] ℹ️    - Diagnosis 2: ''
[13:55:33] ℹ️    - Diagnosis 3: ''
[13:55:33] ℹ️    - Diagnosis 4: ''
[13:55:33] ℹ️    - Diagnosis 5: ''
[13:55:33] ℹ️    - Diagnosis 6: ''
[13:55:33] ℹ️  Final extracted MRN: '6117015'
[13:55:33] ℹ️  Final extracted Sex: 'FEMALE'
[13:55:33] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:55:33] ℹ️  Final extracted Payer Source: 'Medicare'
[13:55:33] ✅ Patient data extraction completed successfully
[13:55:33] ✅    ✅ Patient data extracted successfully
[13:55:33] 📊 Patient Response
     └─ patientFName: Janet
     └─ patientLName: Cabral
     └─ dob: 07/26/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6117015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1959 Purchase St Apt E 209
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:55:33] ✅    ✅ Patient identified: Janet Cabral
[13:55:33] ✅    ✅ Patient name validation passed
[13:55:33] 🔄 
🔄 Step 3: Processing patient dates...
[13:55:33] [DOC: 9233261] ℹ️  DOB normalized: 07/26/1952
[13:55:33] [DOC: 9233261] ℹ️  Episode startOfCare normalized: 02/28/2025
[13:55:33] [DOC: 9233261] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[13:55:33] [DOC: 9233261] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[13:55:33] [DOC: 9233261] ✅ Patient date processing completed successfully
[13:55:33] ✅    ✅ Date processing completed
[13:55:33] 📊 Processed Patient Data
     └─ patientFName: Janet
     └─ patientLName: Cabral
     └─ dob: 07/26/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6117015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1959 Purchase St Apt E 209
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:55:33] 🔄 
🔄 Step 4: Extracting order data...
[13:55:36] ℹ️  Order extraction - MRN: ''
[13:55:36] ℹ️  Order extraction - Sex: 'FEMALE'
[13:55:36] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:55:36] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:55:36] ✅ Order data extraction completed successfully
[13:55:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:55:36] ℹ️  Using MRN from patient data: '6117015'
[13:55:36] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:55:36] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:55:36] ✅ Patient name cross-validation successful
[13:55:36] ✅    ✅ Data merged successfully
[13:55:37] ✅    ✅ Order data extracted and validated
[13:55:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:55:37] [DOC: 9233261] ✅ Patient found in local cache: Janet Cabral, ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[13:55:37] ✅    ✅ Existing patient found with ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[13:55:37] 🔄 
🔄 Step 6: Pushing order to API...
[13:55:37] [DOC: 9233261] ℹ️  Pushing order via API for patient ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[13:55:38] [DOC: 9233261] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:55:38] ❌    ❌ Failed to push order
[13:55:38] 🔄 
🔄 Step 7: Writing to CSV...
[13:55:38] [DOC: 9233261] ℹ️  Calculated age: 72 from DOB: 07/26/1952
[13:55:38] [DOC: 9233261] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:55:38] [DOC: 9233261] ℹ️  Payer Source extracted: 'Medicare'
[13:55:38] [DOC: 9233261] ℹ️  Diagnosis codes being written:
[13:55:38] [DOC: 9233261] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:55:38] [DOC: 9233261] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:55:38] [DOC: 9233261] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:55:38] [DOC: 9233261] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:55:38] [DOC: 9233261] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:55:38] [DOC: 9233261] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:55:38] [DOC: 9233261] ✅ Patient data written to CSV: Janet Cabral | Sex: FEMALE | Age: 72 | Service: Skilled Nursing | Payer: Medicare | MRN: 6117015
[13:55:38] ✅    ✅ Document 9233261 processed and saved successfully
[13:55:38] 🔄 
🔄 Step 8: Saving API details...
[13:55:38] [DOC: 9233261] ℹ️  API push details saved for document 9233261
[13:55:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233258                         ║
================================================================================
[13:55:38] ℹ️  Agency: Dartmouth HH
[13:55:38] ℹ️  Date: 04/10/2025
[13:55:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:55:40] [DOC: 9233258] ✅ Text extracted using pdfplumber (1054 chars)
[13:55:40] ✅    ✅ Text extracted using pdfplumber (1054 chars)
[13:55:40] 🔄 
🔄 Step 2: Extracting patient data...
[13:55:42] ℹ️  AI extracted raw sex value: 'F'
[13:55:42] ℹ️  AI extracted service line: 'HHA'
[13:55:42] ℹ️  AI extracted payer source: 'Medicare'
[13:55:42] ℹ️  AI extracted diagnoses:
[13:55:42] ℹ️    - Diagnosis 1: ''
[13:55:42] ℹ️    - Diagnosis 2: ''
[13:55:42] ℹ️    - Diagnosis 3: ''
[13:55:42] ℹ️    - Diagnosis 4: ''
[13:55:42] ℹ️    - Diagnosis 5: ''
[13:55:42] ℹ️    - Diagnosis 6: ''
[13:55:42] ℹ️  Final extracted MRN: '2929009'
[13:55:42] ℹ️  Final extracted Sex: 'FEMALE'
[13:55:42] ℹ️  Final extracted Service Line: 'HHA'
[13:55:42] ℹ️  Final extracted Payer Source: 'Medicare'
[13:55:42] ✅ Patient data extraction completed successfully
[13:55:42] ✅    ✅ Patient data extracted successfully
[13:55:42] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Tavares
     └─ dob: 09/03/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2929009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 217 Deane Street Apt 336
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:55:42] ✅    ✅ Patient identified: Maria Tavares
[13:55:42] ✅    ✅ Patient name validation passed
[13:55:42] 🔄 
🔄 Step 3: Processing patient dates...
[13:55:42] [DOC: 9233258] ℹ️  DOB normalized: 09/03/1948
[13:55:42] [DOC: 9233258] ℹ️  Episode startOfCare normalized: 03/19/2025
[13:55:42] [DOC: 9233258] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[13:55:42] [DOC: 9233258] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[13:55:42] [DOC: 9233258] ✅ Patient date processing completed successfully
[13:55:42] ✅    ✅ Date processing completed
[13:55:42] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Tavares
     └─ dob: 09/03/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2929009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 217 Deane Street Apt 336
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:55:42] 🔄 
🔄 Step 4: Extracting order data...
[13:55:45] ℹ️  Order extraction - MRN: '2929009'
[13:55:45] ℹ️  Order extraction - Sex: 'FEMALE'
[13:55:45] ℹ️  Order extraction - Service Line: 'HHA'
[13:55:45] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:55:45] ✅ Order data extraction completed successfully
[13:55:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:55:45] ℹ️  Using MRN from patient data: '2929009' over '2929009'
[13:55:45] ℹ️  Service line consistent in both sources: 'HHA'
[13:55:45] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:55:45] ✅ Patient name cross-validation successful
[13:55:45] ✅    ✅ Data merged successfully
[13:55:46] ✅    ✅ Order data extracted and validated
[13:55:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:55:55] [DOC: 9233258] ✅ Patient exists in API: Maria Tavares, ID: 1c258f9c-405c-497c-94d6-e50c3e251b72
[13:55:55] ✅    ✅ Existing patient found with ID: 1c258f9c-405c-497c-94d6-e50c3e251b72
[13:55:55] 🔄 
🔄 Step 6: Pushing order to API...
[13:55:55] [DOC: 9233258] ℹ️  Pushing order via API for patient ID: 1c258f9c-405c-497c-94d6-e50c3e251b72
[13:55:56] [DOC: 9233258] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:55:56] ❌    ❌ Failed to push order
[13:55:56] 🔄 
🔄 Step 7: Writing to CSV...
[13:55:56] [DOC: 9233258] ℹ️  Calculated age: 76 from DOB: 09/03/1948
[13:55:56] [DOC: 9233258] ℹ️  Service Line extracted: 'HHA'
[13:55:56] [DOC: 9233258] ℹ️  Payer Source extracted: 'Medicare'
[13:55:56] [DOC: 9233258] ℹ️  Diagnosis codes being written:
[13:55:56] [DOC: 9233258] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:55:56] [DOC: 9233258] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:55:56] [DOC: 9233258] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:55:56] [DOC: 9233258] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:55:56] [DOC: 9233258] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:55:56] [DOC: 9233258] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:55:56] [DOC: 9233258] ✅ Patient data written to CSV: Maria Tavares | Sex: FEMALE | Age: 76 | Service: HHA | Payer: Medicare | MRN: 2929009
[13:55:56] ✅    ✅ Document 9233258 processed and saved successfully
[13:55:56] 🔄 
🔄 Step 8: Saving API details...
[13:55:56] [DOC: 9233258] ℹ️  API push details saved for document 9233258
[13:55:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233255                         ║
================================================================================
[13:55:56] ℹ️  Agency: Dartmouth HH
[13:55:56] ℹ️  Date: 04/10/2025
[13:55:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:55:57] [DOC: 9233255] ✅ Text extracted using pdfplumber (3089 chars)
[13:55:57] ✅    ✅ Text extracted using pdfplumber (3089 chars)
[13:55:57] 🔄 
🔄 Step 2: Extracting patient data...
[13:56:00] ℹ️  AI extracted raw sex value: 'F'
[13:56:00] ℹ️  AI extracted service line: 'PT'
[13:56:00] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[13:56:00] ℹ️  AI extracted diagnoses:
[13:56:00] ℹ️    - Diagnosis 1: ''
[13:56:00] ℹ️    - Diagnosis 2: ''
[13:56:00] ℹ️    - Diagnosis 3: ''
[13:56:00] ℹ️    - Diagnosis 4: ''
[13:56:00] ℹ️    - Diagnosis 5: ''
[13:56:00] ℹ️    - Diagnosis 6: ''
[13:56:00] ℹ️  Final extracted MRN: '4398011'
[13:56:00] ℹ️  Final extracted Sex: 'FEMALE'
[13:56:00] ℹ️  Final extracted Service Line: 'PT'
[13:56:00] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[13:56:00] ✅ Patient data extraction completed successfully
[13:56:00] ✅    ✅ Patient data extracted successfully
[13:56:00] 📊 Patient Response
     └─ patientFName: Elaine
     └─ patientLName: Dos Santos
     └─ dob: 06/30/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4398011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '12/15/2024', 'startOfEpisode': '02/13/2025', 'endOfEpisode': '04/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:56:00] ✅    ✅ Patient identified: Elaine Dos Santos
[13:56:00] ✅    ✅ Patient name validation passed
[13:56:00] 🔄 
🔄 Step 3: Processing patient dates...
[13:56:00] [DOC: 9233255] ℹ️  DOB normalized: 06/30/1950
[13:56:00] [DOC: 9233255] ℹ️  Episode startOfCare normalized: 12/15/2024
[13:56:00] [DOC: 9233255] ℹ️  Episode startOfEpisode normalized: 02/13/2025
[13:56:00] [DOC: 9233255] ℹ️  Episode endOfEpisode normalized: 04/13/2025
[13:56:00] [DOC: 9233255] ✅ Patient date processing completed successfully
[13:56:00] ✅    ✅ Date processing completed
[13:56:00] 📊 Processed Patient Data
     └─ patientFName: Elaine
     └─ patientLName: Dos Santos
     └─ dob: 06/30/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4398011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '12/15/2024', 'startOfEpisode': '02/13/2025', 'endOfEpisode': '04/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:56:00] 🔄 
🔄 Step 4: Extracting order data...
[13:56:03] ℹ️  Order extraction - MRN: ''
[13:56:03] ℹ️  Order extraction - Sex: 'FEMALE'
[13:56:03] ℹ️  Order extraction - Service Line: 'PT'
[13:56:03] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[13:56:03] ✅ Order data extraction completed successfully
[13:56:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:56:03] ℹ️  Using MRN from patient data: '4398011'
[13:56:03] ℹ️  Service line consistent in both sources: 'PT'
[13:56:03] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[13:56:03] ✅ Patient name cross-validation successful
[13:56:03] ✅    ✅ Data merged successfully
[13:56:04] ✅    ✅ Order data extracted and validated
[13:56:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:56:04] [DOC: 9233255] ✅ Patient found in local cache: Elaine Dos Santos, ID: b67987f0-df4a-470f-8698-52193755e58e
[13:56:04] ✅    ✅ Existing patient found with ID: b67987f0-df4a-470f-8698-52193755e58e
[13:56:04] 🔄 
🔄 Step 6: Pushing order to API...
[13:56:04] [DOC: 9233255] ℹ️  Pushing order via API for patient ID: b67987f0-df4a-470f-8698-52193755e58e
[13:56:05] [DOC: 9233255] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19941"}
[13:56:05] ❌    ❌ Failed to push order
[13:56:05] 🔄 
🔄 Step 7: Writing to CSV...
[13:56:05] [DOC: 9233255] ℹ️  Calculated age: 74 from DOB: 06/30/1950
[13:56:05] [DOC: 9233255] ℹ️  Service Line extracted: 'PT'
[13:56:05] [DOC: 9233255] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[13:56:05] [DOC: 9233255] ℹ️  Diagnosis codes being written:
[13:56:05] [DOC: 9233255] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:56:05] [DOC: 9233255] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:56:05] [DOC: 9233255] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:56:05] [DOC: 9233255] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:56:05] [DOC: 9233255] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:56:05] [DOC: 9233255] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:56:05] [DOC: 9233255] ✅ Patient data written to CSV: Elaine Dos Santos | Sex: FEMALE | Age: 74 | Service: PT | Payer: Blue Cross Medicare Adv | MRN: 4398011
[13:56:05] ✅    ✅ Document 9233255 processed and saved successfully
[13:56:05] 🔄 
🔄 Step 8: Saving API details...
[13:56:05] [DOC: 9233255] ℹ️  API push details saved for document 9233255
[13:56:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233246                         ║
================================================================================
[13:56:05] ℹ️  Agency: Dartmouth HH
[13:56:05] ℹ️  Date: 04/10/2025
[13:56:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:56:07] [DOC: 9233246] ✅ Text extracted using pdfplumber (1140 chars)
[13:56:07] ✅    ✅ Text extracted using pdfplumber (1140 chars)
[13:56:07] 🔄 
🔄 Step 2: Extracting patient data...
[13:56:10] ℹ️  AI extracted raw sex value: 'F'
[13:56:10] ℹ️  AI extracted service line: 'RN'
[13:56:10] ℹ️  AI extracted payer source: 'Senior Whole Health'
[13:56:10] ℹ️  AI extracted diagnoses:
[13:56:10] ℹ️    - Diagnosis 1: ''
[13:56:10] ℹ️    - Diagnosis 2: ''
[13:56:10] ℹ️    - Diagnosis 3: ''
[13:56:10] ℹ️    - Diagnosis 4: ''
[13:56:10] ℹ️    - Diagnosis 5: ''
[13:56:10] ℹ️    - Diagnosis 6: ''
[13:56:10] ℹ️  Final extracted MRN: '670009'
[13:56:10] ℹ️  Final extracted Sex: 'FEMALE'
[13:56:10] ℹ️  Final extracted Service Line: 'RN'
[13:56:10] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[13:56:10] ✅ Patient data extraction completed successfully
[13:56:10] ✅    ✅ Patient data extracted successfully
[13:56:10] 📊 Patient Response
     └─ patientFName: Debra
     └─ patientLName: Murphy
     └─ dob: 06/14/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 670009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 12 Ruth Street Apt 805
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2024', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:56:10] ✅    ✅ Patient identified: Debra Murphy
[13:56:10] ✅    ✅ Patient name validation passed
[13:56:10] 🔄 
🔄 Step 3: Processing patient dates...
[13:56:10] [DOC: 9233246] ℹ️  DOB normalized: 06/14/1952
[13:56:10] [DOC: 9233246] ℹ️  Episode startOfCare normalized: 01/15/2024
[13:56:10] [DOC: 9233246] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[13:56:10] [DOC: 9233246] ℹ️  Episode endOfEpisode normalized: 05/08/2025
[13:56:10] [DOC: 9233246] ✅ Patient date processing completed successfully
[13:56:10] ✅    ✅ Date processing completed
[13:56:10] 📊 Processed Patient Data
     └─ patientFName: Debra
     └─ patientLName: Murphy
     └─ dob: 06/14/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 670009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 12 Ruth Street Apt 805
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '01/15/2024', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:56:10] 🔄 
🔄 Step 4: Extracting order data...
[13:56:12] ℹ️  Order extraction - MRN: ''
[13:56:12] ℹ️  Order extraction - Sex: 'FEMALE'
[13:56:12] ℹ️  Order extraction - Service Line: 'RN'
[13:56:12] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[13:56:12] ✅ Order data extraction completed successfully
[13:56:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:56:12] ℹ️  Using MRN from patient data: '670009'
[13:56:12] ℹ️  Service line consistent in both sources: 'RN'
[13:56:12] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[13:56:12] ✅ Patient name cross-validation successful
[13:56:12] ✅    ✅ Data merged successfully
[13:56:13] ✅    ✅ Order data extracted and validated
[13:56:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:56:30] [DOC: 9233246] ℹ️  Patient not found in cache or API: Debra Murphy
[13:56:30] [DOC: 9233246] ℹ️  Patient not found, creating new patient via API...
[13:56:30] [DOC: 9233246] ℹ️  Creating patient via API: Debra Murphy
[13:56:32] [DOC: 9233246] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:56:32] ❌    ❌ Failed to create patient
[13:56:32] [DOC: 9233246] ℹ️  API push details saved for document 9233246
================================================================================
║                        Processing Document ID: 9233245                         ║
================================================================================
[13:56:32] ℹ️  Agency: Dartmouth HH
[13:56:32] ℹ️  Date: 04/10/2025
[13:56:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:56:33] [DOC: 9233245] ✅ Text extracted using pdfplumber (1132 chars)
[13:56:33] ✅    ✅ Text extracted using pdfplumber (1132 chars)
[13:56:33] 🔄 
🔄 Step 2: Extracting patient data...
[13:56:36] ℹ️  AI extracted raw sex value: 'F'
[13:56:36] ℹ️  AI extracted service line: 'RN'
[13:56:36] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[13:56:36] ℹ️  AI extracted diagnoses:
[13:56:36] ℹ️    - Diagnosis 1: 'hypercholesteremia'
[13:56:36] ℹ️    - Diagnosis 2: ''
[13:56:36] ℹ️    - Diagnosis 3: ''
[13:56:36] ℹ️    - Diagnosis 4: ''
[13:56:36] ℹ️    - Diagnosis 5: ''
[13:56:36] ℹ️    - Diagnosis 6: ''
[13:56:36] ℹ️  Final extracted MRN: '6204015'
[13:56:36] ℹ️  Final extracted Sex: 'FEMALE'
[13:56:36] ℹ️  Final extracted Service Line: 'RN'
[13:56:36] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[13:56:36] ✅ Patient data extraction completed successfully
[13:56:36] ✅    ✅ Patient data extracted successfully
[13:56:36] 📊 Patient Response
     └─ patientFName: Rita
     └─ patientLName: Costa
     └─ dob: 10/16/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6204015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'hypercholesteremia', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:56:36] ✅    ✅ Patient identified: Rita Costa
[13:56:36] ✅    ✅ Patient name validation passed
[13:56:36] 🔄 
🔄 Step 3: Processing patient dates...
[13:56:36] [DOC: 9233245] ℹ️  DOB normalized: 10/16/1930
[13:56:36] [DOC: 9233245] ℹ️  Episode startOfCare normalized: 03/17/2025
[13:56:36] [DOC: 9233245] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[13:56:36] [DOC: 9233245] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[13:56:36] [DOC: 9233245] ✅ Patient date processing completed successfully
[13:56:36] ✅    ✅ Date processing completed
[13:56:36] 📊 Processed Patient Data
     └─ patientFName: Rita
     └─ patientLName: Costa
     └─ dob: 10/16/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6204015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'hypercholesteremia', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:56:36] 🔄 
🔄 Step 4: Extracting order data...
[13:56:38] ℹ️  Order extraction - MRN: ''
[13:56:38] ℹ️  Order extraction - Sex: 'FEMALE'
[13:56:38] ℹ️  Order extraction - Service Line: 'SN'
[13:56:38] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[13:56:38] ✅ Order data extraction completed successfully
[13:56:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:56:38] ℹ️  Using MRN from patient data: '6204015'
[13:56:38] ℹ️  Combined service lines: Patient='RN' + Order='SN' = 'RN, SN'
[13:56:38] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[13:56:38] ✅ Patient name cross-validation successful
[13:56:38] ✅    ✅ Data merged successfully
[13:56:39] ✅    ✅ Order data extracted and validated
[13:56:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:56:39] [DOC: 9233245] ✅ Patient found in local cache: Rita Costa, ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[13:56:39] ✅    ✅ Existing patient found with ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[13:56:39] 🔄 
🔄 Step 6: Pushing order to API...
[13:56:39] [DOC: 9233245] ℹ️  Pushing order via API for patient ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[13:56:41] [DOC: 9233245] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12877"}
[13:56:41] ❌    ❌ Failed to push order
[13:56:41] 🔄 
🔄 Step 7: Writing to CSV...
[13:56:41] [DOC: 9233245] ℹ️  Calculated age: 94 from DOB: 10/16/1930
[13:56:41] [DOC: 9233245] ℹ️  Service Line extracted: 'RN, SN'
[13:56:41] [DOC: 9233245] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[13:56:41] [DOC: 9233245] ℹ️  Diagnosis codes being written:
[13:56:41] [DOC: 9233245] ℹ️    - Latest_Episode_Firstdiagnosis: 'hypercholesteremia'
[13:56:41] [DOC: 9233245] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:56:41] [DOC: 9233245] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:56:41] [DOC: 9233245] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:56:41] [DOC: 9233245] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:56:41] [DOC: 9233245] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:56:41] [DOC: 9233245] ✅ Patient data written to CSV: Rita Costa | Sex: FEMALE | Age: 94 | Service: RN, SN | Payer: Aetna- Mcare | MRN: 6204015
[13:56:41] ✅    ✅ Document 9233245 processed and saved successfully
[13:56:41] 🔄 
🔄 Step 8: Saving API details...
[13:56:41] [DOC: 9233245] ℹ️  API push details saved for document 9233245
[13:56:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233242                         ║
================================================================================
[13:56:41] ℹ️  Agency: Dartmouth HH
[13:56:41] ℹ️  Date: 04/10/2025
[13:56:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:56:43] [DOC: 9233242] ✅ Text extracted using pdfplumber (7543 chars)
[13:56:43] ✅    ✅ Text extracted using pdfplumber (7543 chars)
[13:56:43] 🔄 
🔄 Step 2: Extracting patient data...
[13:56:46] ℹ️  AI extracted raw sex value: 'F'
[13:56:46] ℹ️  AI extracted service line: 'PT, OT, SN, SLP'
[13:56:46] ℹ️  AI extracted payer source: 'Fallon Navicare'
[13:56:46] ℹ️  AI extracted diagnoses:
[13:56:46] ℹ️    - Diagnosis 1: 'G54.0'
[13:56:46] ℹ️    - Diagnosis 2: 'M54.5'
[13:56:46] ℹ️    - Diagnosis 3: 'M25.51'
[13:56:46] ℹ️    - Diagnosis 4: 'M25.51'
[13:56:46] ℹ️    - Diagnosis 5: 'M19.90'
[13:56:46] ℹ️    - Diagnosis 6: 'None'
[13:56:46] ℹ️  Final extracted MRN: '6324015'
[13:56:46] ℹ️  Final extracted Sex: 'FEMALE'
[13:56:46] ℹ️  Final extracted Service Line: 'PT, OT, SN, SLP'
[13:56:46] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[13:56:46] ✅ Patient data extraction completed successfully
[13:56:46] ✅    ✅ Patient data extracted successfully
[13:56:46] 📊 Patient Response
     └─ patientFName: Pascualina
     └─ patientLName: Costa
     └─ dob: 12/10/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6324015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT, SN, SLP
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'G54.0', 'secondDiagnosis': 'M54.5', 'thirdDiagnosis': 'M25.51', 'fourthDiagnosis': 'M25.51', 'fifthDiagnosis': 'M19.90', 'sixthDiagnosis': None}]
[13:56:46] ✅    ✅ Patient identified: Pascualina Costa
[13:56:46] ✅    ✅ Patient name validation passed
[13:56:46] 🔄 
🔄 Step 3: Processing patient dates...
[13:56:46] [DOC: 9233242] ℹ️  DOB normalized: 12/10/1935
[13:56:46] [DOC: 9233242] ℹ️  Episode startOfCare normalized: 04/04/2025
[13:56:46] [DOC: 9233242] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[13:56:46] [DOC: 9233242] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[13:56:46] [DOC: 9233242] ✅ Patient date processing completed successfully
[13:56:46] ✅    ✅ Date processing completed
[13:56:46] 📊 Processed Patient Data
     └─ patientFName: Pascualina
     └─ patientLName: Costa
     └─ dob: 12/10/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6324015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT, SN, SLP
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'G54.0', 'secondDiagnosis': 'M54.5', 'thirdDiagnosis': 'M25.51', 'fourthDiagnosis': 'M25.51', 'fifthDiagnosis': 'M19.90'}]
[13:56:46] 🔄 
🔄 Step 4: Extracting order data...
[13:56:48] ℹ️  Order extraction - MRN: '6324015'
[13:56:48] ℹ️  Order extraction - Sex: 'FEMALE'
[13:56:48] ℹ️  Order extraction - Service Line: 'PT'
[13:56:48] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[13:56:48] ✅ Order data extraction completed successfully
[13:56:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:56:48] ℹ️  Using MRN from patient data: '6324015' over '6324015'
[13:56:48] ℹ️  Combined service lines: Patient='PT, OT, SN, SLP' + Order='PT' = 'OT, PT, SLP, SN'
[13:56:48] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[13:56:48] ✅ Patient name cross-validation successful
[13:56:48] ✅    ✅ Data merged successfully
[13:56:49] ✅    ✅ Order data extracted and validated
[13:56:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:56:49] [DOC: 9233242] ✅ Patient found in local cache: Pascualina Costa, ID: cb0d604b-ae64-4265-b4ee-470e611dd434
[13:56:49] ✅    ✅ Existing patient found with ID: cb0d604b-ae64-4265-b4ee-470e611dd434
[13:56:49] 🔄 
🔄 Step 6: Pushing order to API...
[13:56:49] [DOC: 9233242] ℹ️  Pushing order via API for patient ID: cb0d604b-ae64-4265-b4ee-470e611dd434
[13:56:50] [DOC: 9233242] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:56:50] ❌    ❌ Failed to push order
[13:56:50] 🔄 
🔄 Step 7: Writing to CSV...
[13:56:50] [DOC: 9233242] ℹ️  Calculated age: 89 from DOB: 12/10/1935
[13:56:50] [DOC: 9233242] ℹ️  Service Line extracted: 'OT, PT, SLP, SN'
[13:56:50] [DOC: 9233242] ℹ️  Payer Source extracted: 'Fallon Navicare'
[13:56:50] [DOC: 9233242] ℹ️  Diagnosis codes being written:
[13:56:50] [DOC: 9233242] ℹ️    - Latest_Episode_Firstdiagnosis: 'G54.0'
[13:56:50] [DOC: 9233242] ℹ️    - Latest_Episode_Seconddiagnosis: 'M54.5'
[13:56:50] [DOC: 9233242] ℹ️    - Latest_Episode_Thirddiagnosis: 'M25.51'
[13:56:50] [DOC: 9233242] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M25.51'
[13:56:50] [DOC: 9233242] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M19.90'
[13:56:50] [DOC: 9233242] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:56:50] [DOC: 9233242] ✅ Patient data written to CSV: Pascualina Costa | Sex: FEMALE | Age: 89 | Service: OT, PT, SLP, SN | Payer: Fallon Navicare | MRN: 6324015
[13:56:50] ✅    ✅ Document 9233242 processed and saved successfully
[13:56:50] 🔄 
🔄 Step 8: Saving API details...
[13:56:50] [DOC: 9233242] ℹ️  API push details saved for document 9233242
[13:56:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233239                         ║
================================================================================
[13:56:50] ℹ️  Agency: Dartmouth HH
[13:56:50] ℹ️  Date: 04/10/2025
[13:56:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:56:52] [DOC: 9233239] ✅ Text extracted using pdfplumber (2795 chars)
[13:56:52] ✅    ✅ Text extracted using pdfplumber (2795 chars)
[13:56:52] 🔄 
🔄 Step 2: Extracting patient data...
[13:56:55] ℹ️  AI extracted raw sex value: 'F'
[13:56:55] ℹ️  AI extracted service line: 'Occupational Therapy'
[13:56:55] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[13:56:55] ℹ️  AI extracted diagnoses:
[13:56:55] ℹ️    - Diagnosis 1: ''
[13:56:55] ℹ️    - Diagnosis 2: ''
[13:56:55] ℹ️    - Diagnosis 3: ''
[13:56:55] ℹ️    - Diagnosis 4: ''
[13:56:55] ℹ️    - Diagnosis 5: ''
[13:56:55] ℹ️    - Diagnosis 6: ''
[13:56:55] ℹ️  Final extracted MRN: '6073015'
[13:56:55] ℹ️  Final extracted Sex: 'FEMALE'
[13:56:55] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[13:56:55] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[13:56:55] ✅ Patient data extraction completed successfully
[13:56:55] ✅    ✅ Patient data extracted successfully
[13:56:55] 📊 Patient Response
     └─ patientFName: Marilyn
     └─ patientLName: Valle
     └─ dob: 12/24/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6073015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Occupational Therapy
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:56:55] ✅    ✅ Patient identified: Marilyn Valle
[13:56:55] ✅    ✅ Patient name validation passed
[13:56:55] 🔄 
🔄 Step 3: Processing patient dates...
[13:56:55] [DOC: 9233239] ℹ️  DOB normalized: 12/24/1947
[13:56:55] [DOC: 9233239] ℹ️  Episode startOfCare normalized: 02/22/2025
[13:56:55] [DOC: 9233239] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[13:56:55] [DOC: 9233239] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[13:56:55] [DOC: 9233239] ✅ Patient date processing completed successfully
[13:56:55] ✅    ✅ Date processing completed
[13:56:55] 📊 Processed Patient Data
     └─ patientFName: Marilyn
     └─ patientLName: Valle
     └─ dob: 12/24/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6073015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Occupational Therapy
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:56:55] 🔄 
🔄 Step 4: Extracting order data...
[13:56:57] ℹ️  Order extraction - MRN: '6073015'
[13:56:57] ℹ️  Order extraction - Sex: 'FEMALE'
[13:56:57] ℹ️  Order extraction - Service Line: 'OT'
[13:56:57] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[13:56:57] ✅ Order data extraction completed successfully
[13:56:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:56:57] ℹ️  Using MRN from patient data: '6073015' over '6073015'
[13:56:57] ℹ️  Combined service lines: Patient='Occupational Therapy' + Order='OT' = 'OT, Occupational Therapy'
[13:56:57] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[13:56:57] ✅ Patient name cross-validation successful
[13:56:57] ✅    ✅ Data merged successfully
[13:56:59] ✅    ✅ Order data extracted and validated
[13:56:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:56:59] [DOC: 9233239] ✅ Patient found in local cache: Marilyn Valle, ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[13:56:59] ✅    ✅ Existing patient found with ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[13:56:59] 🔄 
🔄 Step 6: Pushing order to API...
[13:56:59] [DOC: 9233239] ℹ️  Pushing order via API for patient ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[13:57:00] [DOC: 9233239] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:57:00] ❌    ❌ Failed to push order
[13:57:00] 🔄 
🔄 Step 7: Writing to CSV...
[13:57:00] [DOC: 9233239] ℹ️  Calculated age: 77 from DOB: 12/24/1947
[13:57:00] [DOC: 9233239] ℹ️  Service Line extracted: 'OT, Occupational Therapy'
[13:57:00] [DOC: 9233239] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[13:57:00] [DOC: 9233239] ℹ️  Diagnosis codes being written:
[13:57:00] [DOC: 9233239] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:57:00] [DOC: 9233239] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:57:00] [DOC: 9233239] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:57:00] [DOC: 9233239] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:57:00] [DOC: 9233239] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:57:00] [DOC: 9233239] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:57:00] [DOC: 9233239] ✅ Patient data written to CSV: Marilyn Valle | Sex: FEMALE | Age: 77 | Service: OT, Occupational Therapy | Payer: Aetna- Mcare | MRN: 6073015
[13:57:00] ✅    ✅ Document 9233239 processed and saved successfully
[13:57:00] 🔄 
🔄 Step 8: Saving API details...
[13:57:00] [DOC: 9233239] ℹ️  API push details saved for document 9233239
[13:57:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233037                         ║
================================================================================
[13:57:00] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:57:00] ℹ️  Date: 04/10/2025
[13:57:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:57:01] [DOC: 9233037] ✅ Text extracted using pdfplumber (1071 chars)
[13:57:01] ✅    ✅ Text extracted using pdfplumber (1071 chars)
[13:57:01] 🔄 
🔄 Step 2: Extracting patient data...
[13:57:04] ℹ️  AI extracted raw sex value: 'F'
[13:57:04] ℹ️  AI extracted service line: 'Nursing'
[13:57:04] ℹ️  AI extracted payer source: ''
[13:57:04] ℹ️  AI extracted diagnoses:
[13:57:04] ℹ️    - Diagnosis 1: 'None'
[13:57:04] ℹ️    - Diagnosis 2: 'None'
[13:57:04] ℹ️    - Diagnosis 3: 'None'
[13:57:04] ℹ️    - Diagnosis 4: 'None'
[13:57:04] ℹ️    - Diagnosis 5: 'None'
[13:57:04] ℹ️    - Diagnosis 6: 'None'
[13:57:04] ℹ️  Final extracted MRN: '3064389'
[13:57:04] ℹ️  Final extracted Sex: 'FEMALE'
[13:57:04] ℹ️  Final extracted Service Line: 'Nursing'
[13:57:04] ℹ️  Final extracted Payer Source: ''
[13:57:04] ✅ Patient data extraction completed successfully
[13:57:04] ✅    ✅ Patient data extracted successfully
[13:57:04] 📊 Patient Response
     └─ patientFName: Dianne
     └─ patientLName: Veiga
     └─ dob: 05/17/1970
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3064389
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:57:04] ✅    ✅ Patient identified: Dianne Veiga
[13:57:04] ✅    ✅ Patient name validation passed
[13:57:04] 🔄 
🔄 Step 3: Processing patient dates...
[13:57:04] [DOC: 9233037] ℹ️  DOB normalized: 05/17/1970
[13:57:04] [DOC: 9233037] ✅ Patient date processing completed successfully
[13:57:04] ✅    ✅ Date processing completed
[13:57:04] 📊 Processed Patient Data
     └─ patientFName: Dianne
     └─ patientLName: Veiga
     └─ dob: 05/17/1970
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3064389
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[13:57:04] 🔄 
🔄 Step 4: Extracting order data...
[13:57:06] ℹ️  Order extraction - MRN: '3064389'
[13:57:06] ℹ️  Order extraction - Sex: 'FEMALE'
[13:57:06] ℹ️  Order extraction - Service Line: 'Nursing'
[13:57:06] ℹ️  Order extraction - Payer Source: ''
[13:57:06] ✅ Order data extraction completed successfully
[13:57:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:57:06] ℹ️  Using MRN from patient data: '3064389' over '3064389'
[13:57:06] ℹ️  Service line consistent in both sources: 'Nursing'
[13:57:06] ✅ Patient name cross-validation successful
[13:57:06] ✅    ✅ Data merged successfully
[13:57:07] ✅    ✅ Order data extracted and validated
[13:57:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:57:24] [DOC: 9233037] ℹ️  Patient not found in cache or API: Dianne Veiga
[13:57:24] [DOC: 9233037] ℹ️  Patient not found, creating new patient via API...
[13:57:24] [DOC: 9233037] ℹ️  Creating patient via API: Dianne Veiga
[13:57:26] [DOC: 9233037] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:57:26] ❌    ❌ Failed to create patient
[13:57:26] [DOC: 9233037] ℹ️  API push details saved for document 9233037
================================================================================
║                        Processing Document ID: 9233025                         ║
================================================================================
[13:57:26] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:57:26] ℹ️  Date: 04/10/2025
[13:57:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:57:27] [DOC: 9233025] ✅ Text extracted using pdfplumber (1075 chars)
[13:57:27] ✅    ✅ Text extracted using pdfplumber (1075 chars)
[13:57:27] 🔄 
🔄 Step 2: Extracting patient data...
[13:57:30] ℹ️  AI extracted raw sex value: 'F'
[13:57:30] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:57:30] ℹ️  AI extracted payer source: ''
[13:57:30] ℹ️  AI extracted diagnoses:
[13:57:30] ℹ️    - Diagnosis 1: ''
[13:57:30] ℹ️    - Diagnosis 2: ''
[13:57:30] ℹ️    - Diagnosis 3: ''
[13:57:30] ℹ️    - Diagnosis 4: ''
[13:57:30] ℹ️    - Diagnosis 5: ''
[13:57:30] ℹ️    - Diagnosis 6: ''
[13:57:30] ℹ️  Final extracted MRN: '3053671'
[13:57:30] ℹ️  Final extracted Sex: 'FEMALE'
[13:57:30] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:57:30] ℹ️  Final extracted Payer Source: ''
[13:57:30] ✅ Patient data extraction completed successfully
[13:57:30] ✅    ✅ Patient data extracted successfully
[13:57:30] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: Tuite
     └─ dob: 04/18/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3053671
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:57:30] ✅    ✅ Patient identified: Janice Tuite
[13:57:30] ✅    ✅ Patient name validation passed
[13:57:30] 🔄 
🔄 Step 3: Processing patient dates...
[13:57:30] [DOC: 9233025] ℹ️  DOB normalized: 04/18/1939
[13:57:30] [DOC: 9233025] ✅ Patient date processing completed successfully
[13:57:30] ✅    ✅ Date processing completed
[13:57:30] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: Tuite
     └─ dob: 04/18/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3053671
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:57:30] 🔄 
🔄 Step 4: Extracting order data...
[13:57:32] ℹ️  Order extraction - MRN: '3053671'
[13:57:32] ℹ️  Order extraction - Sex: 'FEMALE'
[13:57:32] ℹ️  Order extraction - Service Line: ''
[13:57:32] ℹ️  Order extraction - Payer Source: ''
[13:57:32] ✅ Order data extraction completed successfully
[13:57:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:57:32] ℹ️  Using MRN from patient data: '3053671' over '3053671'
[13:57:32] ℹ️  Using service line from patient data: 'Skilled Nursing'
[13:57:32] ✅ Patient name cross-validation successful
[13:57:32] ✅    ✅ Data merged successfully
[13:57:33] ⚠️     ❌ Skipping - missing episode start date
[13:57:33] [DOC: 9233025] ℹ️  API push details saved for document 9233025
================================================================================
║                        Processing Document ID: 9233015                         ║
================================================================================
[13:57:33] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:57:33] ℹ️  Date: 04/10/2025
[13:57:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:57:34] [DOC: 9233015] ✅ Text extracted using pdfplumber (871 chars)
[13:57:34] ✅    ✅ Text extracted using pdfplumber (871 chars)
[13:57:34] 🔄 
🔄 Step 2: Extracting patient data...
[13:57:37] ℹ️  AI extracted raw sex value: 'F'
[13:57:37] ℹ️  AI extracted service line: ''
[13:57:37] ℹ️  AI extracted payer source: ''
[13:57:37] ℹ️  AI extracted diagnoses:
[13:57:37] ℹ️    - Diagnosis 1: 'None'
[13:57:37] ℹ️    - Diagnosis 2: 'None'
[13:57:37] ℹ️    - Diagnosis 3: 'None'
[13:57:37] ℹ️    - Diagnosis 4: 'None'
[13:57:37] ℹ️    - Diagnosis 5: 'None'
[13:57:37] ℹ️    - Diagnosis 6: 'None'
[13:57:37] ℹ️  Final extracted MRN: '3052261'
[13:57:37] ℹ️  Final extracted Sex: 'FEMALE'
[13:57:37] ℹ️  Final extracted Service Line: ''
[13:57:37] ℹ️  Final extracted Payer Source: ''
[13:57:37] ✅ Patient data extraction completed successfully
[13:57:37] ✅    ✅ Patient data extracted successfully
[13:57:37] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Trott
     └─ dob: 04/22/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3052261
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:57:37] ✅    ✅ Patient identified: Donna Trott
[13:57:37] ✅    ✅ Patient name validation passed
[13:57:37] 🔄 
🔄 Step 3: Processing patient dates...
[13:57:37] [DOC: 9233015] ℹ️  DOB normalized: 04/22/1943
[13:57:37] [DOC: 9233015] ✅ Patient date processing completed successfully
[13:57:37] ✅    ✅ Date processing completed
[13:57:37] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Trott
     └─ dob: 04/22/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3052261
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[13:57:37] 🔄 
🔄 Step 4: Extracting order data...
[13:57:40] ℹ️  Order extraction - MRN: '3052261'
[13:57:40] ℹ️  Order extraction - Sex: 'FEMALE'
[13:57:40] ℹ️  Order extraction - Service Line: ''
[13:57:40] ℹ️  Order extraction - Payer Source: ''
[13:57:40] ✅ Order data extraction completed successfully
[13:57:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:57:40] ℹ️  Using MRN from patient data: '3052261' over '3052261'
[13:57:40] ✅ Patient name cross-validation successful
[13:57:40] ✅    ✅ Data merged successfully
[13:57:42] ✅    ✅ Order data extracted and validated
[13:57:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:57:42] [DOC: 9233015] ✅ Patient found in local cache: Donna Trott, ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[13:57:42] ✅    ✅ Existing patient found with ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[13:57:42] 🔄 
🔄 Step 6: Pushing order to API...
[13:57:42] [DOC: 9233015] ℹ️  Pushing order via API for patient ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[13:57:43] [DOC: 9233015] ❌ Order push failed with status 201: {"id":"189685c2-04ec-475a-9735-8aa3a210da59","orderWAVId":"ORD20037","orderNo":"1079851","orderDate":"04/08/2025","startOfCare":"04/08/2025","episodeStartDate":"04/08/2025","episodeEndDate":"04/08/2025","documentID":"9233015","mrn":"3052261","patientName":"Trott,Donna L","sentToPhysicianDate":"04/10/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/17/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"35c8b502-60ae-4cbb-b57d-d65de599a3da","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[13:57:43] ❌    ❌ Failed to push order
[13:57:43] 🔄 
🔄 Step 7: Writing to CSV...
[13:57:43] [DOC: 9233015] ℹ️  Calculated age: 82 from DOB: 04/22/1943
[13:57:43] [DOC: 9233015] ℹ️  Service Line extracted: ''
[13:57:43] [DOC: 9233015] ℹ️  Payer Source extracted: ''
[13:57:43] [DOC: 9233015] ℹ️  Diagnosis codes being written:
[13:57:43] [DOC: 9233015] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:57:43] [DOC: 9233015] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:57:43] [DOC: 9233015] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:57:43] [DOC: 9233015] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:57:43] [DOC: 9233015] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:57:43] [DOC: 9233015] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:57:43] [DOC: 9233015] ✅ Patient data written to CSV: Donna Trott | Sex: FEMALE | Age: 82 | Service:  | Payer:  | MRN: 3052261
[13:57:43] ✅    ✅ Document 9233015 processed and saved successfully
[13:57:43] 🔄 
🔄 Step 8: Saving API details...
[13:57:43] [DOC: 9233015] ℹ️  API push details saved for document 9233015
[13:57:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233006                         ║
================================================================================
[13:57:43] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:57:43] ℹ️  Date: 04/10/2025
[13:57:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:57:47] [DOC: 9233006] ✅ Text extracted using pdfplumber (29259 chars)
[13:57:47] ✅    ✅ Text extracted using pdfplumber (29259 chars)
[13:57:47] 🔄 
🔄 Step 2: Extracting patient data...
[13:57:50] ℹ️  AI extracted raw sex value: 'F'
[13:57:50] ℹ️  AI extracted service line: 'RN, MSW, Skilled Nursing, HHA'
[13:57:50] ℹ️  AI extracted payer source: ''
[13:57:50] ℹ️  AI extracted diagnoses:
[13:57:50] ℹ️    - Diagnosis 1: 'G31.1'
[13:57:50] ℹ️    - Diagnosis 2: 'F03.90'
[13:57:50] ℹ️    - Diagnosis 3: 'R13.10'
[13:57:50] ℹ️    - Diagnosis 4: 'R63.4'
[13:57:50] ℹ️    - Diagnosis 5: 'R53.1'
[13:57:50] ℹ️    - Diagnosis 6: 'R32'
[13:57:50] ℹ️  Final extracted MRN: '3494855'
[13:57:50] ℹ️  Final extracted Sex: 'FEMALE'
[13:57:50] ℹ️  Final extracted Service Line: 'RN, MSW, Skilled Nursing, HHA'
[13:57:50] ℹ️  Final extracted Payer Source: ''
[13:57:50] ✅ Patient data extraction completed successfully
[13:57:50] ✅    ✅ Patient data extracted successfully
[13:57:50] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Skaza
     └─ dob: 09/23/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3494855
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: RN, MSW, Skilled Nursing, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'G31.1', 'secondDiagnosis': 'F03.90', 'thirdDiagnosis': 'R13.10', 'fourthDiagnosis': 'R63.4', 'fifthDiagnosis': 'R53.1', 'sixthDiagnosis': 'R32'}]
[13:57:50] ✅    ✅ Patient identified: Patricia Skaza
[13:57:50] ✅    ✅ Patient name validation passed
[13:57:50] 🔄 
🔄 Step 3: Processing patient dates...
[13:57:50] [DOC: 9233006] ℹ️  DOB normalized: 09/23/1947
[13:57:50] [DOC: 9233006] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[13:57:50] [DOC: 9233006] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[13:57:50] [DOC: 9233006] ✅ Patient date processing completed successfully
[13:57:50] ✅    ✅ Date processing completed
[13:57:50] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Skaza
     └─ dob: 09/23/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3494855
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: RN, MSW, Skilled Nursing, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'G31.1', 'secondDiagnosis': 'F03.90', 'thirdDiagnosis': 'R13.10', 'fourthDiagnosis': 'R63.4', 'fifthDiagnosis': 'R53.1', 'sixthDiagnosis': 'R32'}]
[13:57:50] 🔄 
🔄 Step 4: Extracting order data...
[13:57:53] ℹ️  Order extraction - MRN: '3494855'
[13:57:53] ℹ️  Order extraction - Sex: 'FEMALE'
[13:57:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, Clergy, Home Health Aide'
[13:57:53] ℹ️  Order extraction - Payer Source: ''
[13:57:53] ✅ Order data extraction completed successfully
[13:57:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:57:53] ℹ️  Using MRN from patient data: '3494855' over '3494855'
[13:57:53] ℹ️  Combined service lines: Patient='RN, MSW, Skilled Nursing, HHA' + Order='Skilled Nursing, MSW, Clergy, Home Health Aide' = 'Clergy, HHA, Home Health Aide, MSW, RN, Skilled Nursing'
[13:57:53] ✅ Patient name cross-validation successful
[13:57:53] ✅    ✅ Data merged successfully
[13:57:54] ✅    ✅ Order data extracted and validated
[13:57:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:57:54] [DOC: 9233006] ✅ Patient found in local cache: Patricia Skaza, ID: dc3655e9-56c2-4423-bdaa-c4e93123cb50
[13:57:54] ✅    ✅ Existing patient found with ID: dc3655e9-56c2-4423-bdaa-c4e93123cb50
[13:57:54] 🔄 
🔄 Step 6: Pushing order to API...
[13:57:54] [DOC: 9233006] ℹ️  Pushing order via API for patient ID: dc3655e9-56c2-4423-bdaa-c4e93123cb50
[13:57:55] [DOC: 9233006] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14601"}
[13:57:55] ❌    ❌ Failed to push order
[13:57:55] 🔄 
🔄 Step 7: Writing to CSV...
[13:57:55] [DOC: 9233006] ℹ️  Calculated age: 77 from DOB: 09/23/1947
[13:57:55] [DOC: 9233006] ℹ️  Service Line extracted: 'Clergy, HHA, Home Health Aide, MSW, RN, Skilled Nursing'
[13:57:55] [DOC: 9233006] ℹ️  Payer Source extracted: ''
[13:57:55] [DOC: 9233006] ℹ️  Diagnosis codes being written:
[13:57:55] [DOC: 9233006] ℹ️    - Latest_Episode_Firstdiagnosis: 'G31.1'
[13:57:55] [DOC: 9233006] ℹ️    - Latest_Episode_Seconddiagnosis: 'F03.90'
[13:57:55] [DOC: 9233006] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.10'
[13:57:55] [DOC: 9233006] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R63.4'
[13:57:55] [DOC: 9233006] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R53.1'
[13:57:55] [DOC: 9233006] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R32'
[13:57:55] [DOC: 9233006] ✅ Patient data written to CSV: Patricia Skaza | Sex: FEMALE | Age: 77 | Service: Clergy, HHA, Home Health Aide, MSW, RN, Skilled Nursing | Payer:  | MRN: 3494855
[13:57:55] ✅    ✅ Document 9233006 processed and saved successfully
[13:57:55] 🔄 
🔄 Step 8: Saving API details...
[13:57:55] [DOC: 9233006] ℹ️  API push details saved for document 9233006
[13:57:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9233002                         ║
================================================================================
[13:57:55] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:57:55] ℹ️  Date: 04/10/2025
[13:57:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:57:56] [DOC: 9233002] ✅ Text extracted using pdfplumber (1175 chars)
[13:57:56] ✅    ✅ Text extracted using pdfplumber (1175 chars)
[13:57:56] 🔄 
🔄 Step 2: Extracting patient data...
[13:57:59] ℹ️  AI extracted raw sex value: 'F'
[13:57:59] ℹ️  AI extracted service line: 'Nursing'
[13:57:59] ℹ️  AI extracted payer source: ''
[13:57:59] ℹ️  AI extracted diagnoses:
[13:57:59] ℹ️    - Diagnosis 1: 'None'
[13:57:59] ℹ️    - Diagnosis 2: 'None'
[13:57:59] ℹ️    - Diagnosis 3: 'None'
[13:57:59] ℹ️    - Diagnosis 4: 'None'
[13:57:59] ℹ️    - Diagnosis 5: 'None'
[13:57:59] ℹ️    - Diagnosis 6: 'None'
[13:57:59] ℹ️  Final extracted MRN: '2795248'
[13:57:59] ℹ️  Final extracted Sex: 'FEMALE'
[13:57:59] ℹ️  Final extracted Service Line: 'Nursing'
[13:57:59] ℹ️  Final extracted Payer Source: ''
[13:57:59] ✅ Patient data extraction completed successfully
[13:57:59] ✅    ✅ Patient data extracted successfully
[13:57:59] 📊 Patient Response
     └─ patientFName: Meryl
     └─ patientLName: Novek
     └─ dob: 02/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2795248
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:57:59] ✅    ✅ Patient identified: Meryl Novek
[13:57:59] ✅    ✅ Patient name validation passed
[13:57:59] 🔄 
🔄 Step 3: Processing patient dates...
[13:57:59] [DOC: 9233002] ℹ️  DOB normalized: 02/08/1941
[13:57:59] [DOC: 9233002] ✅ Patient date processing completed successfully
[13:57:59] ✅    ✅ Date processing completed
[13:57:59] 📊 Processed Patient Data
     └─ patientFName: Meryl
     └─ patientLName: Novek
     └─ dob: 02/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2795248
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[13:57:59] 🔄 
🔄 Step 4: Extracting order data...
[13:58:02] ℹ️  Order extraction - MRN: '2795248'
[13:58:02] ℹ️  Order extraction - Sex: 'FEMALE'
[13:58:02] ℹ️  Order extraction - Service Line: ''
[13:58:02] ℹ️  Order extraction - Payer Source: ''
[13:58:02] ✅ Order data extraction completed successfully
[13:58:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:58:02] ℹ️  Using MRN from patient data: '2795248' over '2795248'
[13:58:02] ℹ️  Using service line from patient data: 'Nursing'
[13:58:02] ✅ Patient name cross-validation successful
[13:58:02] ✅    ✅ Data merged successfully
[13:58:03] ✅    ✅ Order data extracted and validated
[13:58:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:58:10] [DOC: 9233002] ℹ️  Patient not found in cache or API: Meryl Novek
[13:58:10] [DOC: 9233002] ℹ️  Patient not found, creating new patient via API...
[13:58:10] [DOC: 9233002] ℹ️  Creating patient via API: Meryl Novek
[13:58:11] [DOC: 9233002] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:58:11] ❌    ❌ Failed to create patient
[13:58:11] [DOC: 9233002] ℹ️  API push details saved for document 9233002
================================================================================
║                        Processing Document ID: 9232999                         ║
================================================================================
[13:58:11] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:58:11] ℹ️  Date: 04/10/2025
[13:58:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:58:12] [DOC: 9232999] ✅ Text extracted using pdfplumber (1023 chars)
[13:58:12] ✅    ✅ Text extracted using pdfplumber (1023 chars)
[13:58:12] 🔄 
🔄 Step 2: Extracting patient data...
[13:58:15] ℹ️  AI extracted raw sex value: 'F'
[13:58:15] ℹ️  AI extracted service line: 'LPN'
[13:58:15] ℹ️  AI extracted payer source: ''
[13:58:15] ℹ️  AI extracted diagnoses:
[13:58:15] ℹ️    - Diagnosis 1: 'None'
[13:58:15] ℹ️    - Diagnosis 2: 'None'
[13:58:15] ℹ️    - Diagnosis 3: 'None'
[13:58:15] ℹ️    - Diagnosis 4: 'None'
[13:58:15] ℹ️    - Diagnosis 5: 'None'
[13:58:15] ℹ️    - Diagnosis 6: 'None'
[13:58:15] ℹ️  Final extracted MRN: '2773301'
[13:58:15] ℹ️  Final extracted Sex: 'FEMALE'
[13:58:15] ℹ️  Final extracted Service Line: 'LPN'
[13:58:15] ℹ️  Final extracted Payer Source: ''
[13:58:15] ✅ Patient data extraction completed successfully
[13:58:15] ✅    ✅ Patient data extracted successfully
[13:58:15] 📊 Patient Response
     └─ patientFName: Arlene
     └─ patientLName: Moss
     └─ dob: 01/24/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2773301
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:58:15] ✅    ✅ Patient identified: Arlene Moss
[13:58:15] ✅    ✅ Patient name validation passed
[13:58:15] 🔄 
🔄 Step 3: Processing patient dates...
[13:58:15] [DOC: 9232999] ℹ️  DOB normalized: 01/24/1959
[13:58:15] [DOC: 9232999] ✅ Patient date processing completed successfully
[13:58:15] ✅    ✅ Date processing completed
[13:58:15] 📊 Processed Patient Data
     └─ patientFName: Arlene
     └─ patientLName: Moss
     └─ dob: 01/24/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2773301
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[13:58:15] 🔄 
🔄 Step 4: Extracting order data...
[13:58:17] ℹ️  Order extraction - MRN: '2773301'
[13:58:17] ℹ️  Order extraction - Sex: 'FEMALE'
[13:58:17] ℹ️  Order extraction - Service Line: ''
[13:58:17] ℹ️  Order extraction - Payer Source: ''
[13:58:17] ✅ Order data extraction completed successfully
[13:58:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:58:17] ℹ️  Using MRN from patient data: '2773301' over '2773301'
[13:58:17] ℹ️  Using service line from patient data: 'LPN'
[13:58:17] ✅ Patient name cross-validation successful
[13:58:17] ✅    ✅ Data merged successfully
[13:58:18] ✅    ✅ Order data extracted and validated
[13:58:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:58:26] [DOC: 9232999] ℹ️  Patient not found in cache or API: Arlene Moss
[13:58:26] [DOC: 9232999] ℹ️  Patient not found, creating new patient via API...
[13:58:26] [DOC: 9232999] ℹ️  Creating patient via API: Arlene Moss
[13:58:27] [DOC: 9232999] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:58:27] ❌    ❌ Failed to create patient
[13:58:27] [DOC: 9232999] ℹ️  API push details saved for document 9232999
================================================================================
║                        Processing Document ID: 9232995                         ║
================================================================================
[13:58:27] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:58:27] ℹ️  Date: 04/10/2025
[13:58:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:58:29] [DOC: 9232995] ✅ Text extracted using pdfplumber (1131 chars)
[13:58:29] ✅    ✅ Text extracted using pdfplumber (1131 chars)
[13:58:29] 🔄 
🔄 Step 2: Extracting patient data...
[13:58:31] ℹ️  AI extracted raw sex value: 'M'
[13:58:31] ℹ️  AI extracted service line: 'RN'
[13:58:31] ℹ️  AI extracted payer source: ''
[13:58:31] ℹ️  AI extracted diagnoses:
[13:58:31] ℹ️    - Diagnosis 1: ''
[13:58:31] ℹ️    - Diagnosis 2: ''
[13:58:31] ℹ️    - Diagnosis 3: ''
[13:58:31] ℹ️    - Diagnosis 4: ''
[13:58:31] ℹ️    - Diagnosis 5: ''
[13:58:31] ℹ️    - Diagnosis 6: ''
[13:58:31] ℹ️  Final extracted MRN: '2145411'
[13:58:31] ℹ️  Final extracted Sex: 'MALE'
[13:58:31] ℹ️  Final extracted Service Line: 'RN'
[13:58:31] ℹ️  Final extracted Payer Source: ''
[13:58:31] ✅ Patient data extraction completed successfully
[13:58:31] ✅    ✅ Patient data extracted successfully
[13:58:31] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Mannes
     └─ dob: 05/18/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 2145411
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:58:31] ✅    ✅ Patient identified: John Mannes
[13:58:31] ✅    ✅ Patient name validation passed
[13:58:31] 🔄 
🔄 Step 3: Processing patient dates...
[13:58:31] [DOC: 9232995] ℹ️  DOB normalized: 05/18/1946
[13:58:31] [DOC: 9232995] ✅ Patient date processing completed successfully
[13:58:31] ✅    ✅ Date processing completed
[13:58:31] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Mannes
     └─ dob: 05/18/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 2145411
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:58:31] 🔄 
🔄 Step 4: Extracting order data...
[13:58:34] ℹ️  Order extraction - MRN: '2145411'
[13:58:34] ℹ️  Order extraction - Sex: 'MALE'
[13:58:34] ℹ️  Order extraction - Service Line: 'RN'
[13:58:34] ℹ️  Order extraction - Payer Source: ''
[13:58:34] ✅ Order data extraction completed successfully
[13:58:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:58:34] ℹ️  Using MRN from patient data: '2145411' over '2145411'
[13:58:34] ℹ️  Service line consistent in both sources: 'RN'
[13:58:34] ✅ Patient name cross-validation successful
[13:58:34] ✅    ✅ Data merged successfully
[13:58:35] ✅    ✅ Order data extracted and validated
[13:58:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:58:42] [DOC: 9232995] ✅ Patient exists in API: John Mannes, ID: 537a377b-351e-4155-98f6-dd0d32dedc84
[13:58:42] ✅    ✅ Existing patient found with ID: 537a377b-351e-4155-98f6-dd0d32dedc84
[13:58:42] 🔄 
🔄 Step 6: Pushing order to API...
[13:58:42] [DOC: 9232995] ℹ️  Pushing order via API for patient ID: 537a377b-351e-4155-98f6-dd0d32dedc84
[13:58:43] [DOC: 9232995] ❌ Order push failed with status 201: {"id":"c4f5ee79-d0e7-4c7d-852a-7248b8a81f2a","orderWAVId":"ORD20038","orderNo":"1080137, 1080138","orderDate":"04/09/2025","startOfCare":"04/07/2025","episodeStartDate":"04/07/2025","episodeEndDate":"04/21/2025","documentID":"9232995","mrn":"2145411","patientName":"Mannes,John O","sentToPhysicianDate":"04/10/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/14/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"537a377b-351e-4155-98f6-dd0d32dedc84","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[13:58:43] ❌    ❌ Failed to push order
[13:58:43] 🔄 
🔄 Step 7: Writing to CSV...
[13:58:43] [DOC: 9232995] ℹ️  Calculated age: 79 from DOB: 05/18/1946
[13:58:43] [DOC: 9232995] ℹ️  Service Line extracted: 'RN'
[13:58:43] [DOC: 9232995] ℹ️  Payer Source extracted: ''
[13:58:43] [DOC: 9232995] ℹ️  Diagnosis codes being written:
[13:58:43] [DOC: 9232995] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:58:43] [DOC: 9232995] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:58:43] [DOC: 9232995] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:58:43] [DOC: 9232995] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:58:43] [DOC: 9232995] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:58:43] [DOC: 9232995] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:58:43] [DOC: 9232995] ✅ Patient data written to CSV: John Mannes | Sex: MALE | Age: 79 | Service: RN | Payer:  | MRN: 2145411
[13:58:43] ✅    ✅ Document 9232995 processed and saved successfully
[13:58:43] 🔄 
🔄 Step 8: Saving API details...
[13:58:43] [DOC: 9232995] ℹ️  API push details saved for document 9232995
[13:58:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232992                         ║
================================================================================
[13:58:43] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:58:43] ℹ️  Date: 04/10/2025
[13:58:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:58:45] [DOC: 9232992] ✅ Text extracted using pdfplumber (2196 chars)
[13:58:45] ✅    ✅ Text extracted using pdfplumber (2196 chars)
[13:58:45] 🔄 
🔄 Step 2: Extracting patient data...
[13:58:47] ℹ️  AI extracted raw sex value: 'M'
[13:58:47] ℹ️  AI extracted service line: 'Nursing'
[13:58:47] ℹ️  AI extracted payer source: ''
[13:58:47] ℹ️  AI extracted diagnoses:
[13:58:47] ℹ️    - Diagnosis 1: 'None'
[13:58:47] ℹ️    - Diagnosis 2: 'None'
[13:58:47] ℹ️    - Diagnosis 3: 'None'
[13:58:47] ℹ️    - Diagnosis 4: 'None'
[13:58:47] ℹ️    - Diagnosis 5: 'None'
[13:58:47] ℹ️    - Diagnosis 6: 'None'
[13:58:47] ℹ️  Final extracted MRN: '3170225'
[13:58:47] ℹ️  Final extracted Sex: 'MALE'
[13:58:47] ℹ️  Final extracted Service Line: 'Nursing'
[13:58:47] ℹ️  Final extracted Payer Source: ''
[13:58:47] ✅ Patient data extraction completed successfully
[13:58:47] ✅    ✅ Patient data extracted successfully
[13:58:47] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:58:47] ✅    ✅ Patient identified: Donald Maceachern
[13:58:47] ✅    ✅ Patient name validation passed
[13:58:47] 🔄 
🔄 Step 3: Processing patient dates...
[13:58:47] [DOC: 9232992] ℹ️  DOB normalized: 11/18/1939
[13:58:47] [DOC: 9232992] ✅ Patient date processing completed successfully
[13:58:47] ✅    ✅ Date processing completed
[13:58:47] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[13:58:47] 🔄 
🔄 Step 4: Extracting order data...
[13:58:50] ℹ️  Order extraction - MRN: '3170225'
[13:58:50] ℹ️  Order extraction - Sex: 'MALE'
[13:58:50] ℹ️  Order extraction - Service Line: 'Nursing'
[13:58:50] ℹ️  Order extraction - Payer Source: ''
[13:58:50] ✅ Order data extraction completed successfully
[13:58:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:58:50] ℹ️  Using MRN from patient data: '3170225' over '3170225'
[13:58:50] ℹ️  Service line consistent in both sources: 'Nursing'
[13:58:50] ✅ Patient name cross-validation successful
[13:58:50] ✅    ✅ Data merged successfully
[13:58:51] ✅    ✅ Order data extracted and validated
[13:58:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:58:56] [DOC: 9232992] ✅ Patient exists in API: Donald Maceachern, ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[13:58:56] ✅    ✅ Existing patient found with ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[13:58:56] 🔄 
🔄 Step 6: Pushing order to API...
[13:58:56] [DOC: 9232992] ℹ️  Pushing order via API for patient ID: 7af7c208-09d9-45bc-a97b-f457df90d626
[13:58:58] [DOC: 9232992] ❌ Order push failed with status 201: {"id":"ca9af5ae-a8ce-4eb8-ae80-b00143e58d0b","orderWAVId":"ORD20039","orderNo":"1080328, 1080329, 1080330, 1080331","orderDate":"04/09/2025","startOfCare":"08/26/2024","episodeStartDate":"08/26/2024","episodeEndDate":"04/09/2025","documentID":"9232992","mrn":"3170225","patientName":"Maceachern,Donald L","sentToPhysicianDate":"04/10/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/17/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"7af7c208-09d9-45bc-a97b-f457df90d626","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[13:58:58] ❌    ❌ Failed to push order
[13:58:58] 🔄 
🔄 Step 7: Writing to CSV...
[13:58:58] [DOC: 9232992] ℹ️  Calculated age: 85 from DOB: 11/18/1939
[13:58:58] [DOC: 9232992] ℹ️  Service Line extracted: 'Nursing'
[13:58:58] [DOC: 9232992] ℹ️  Payer Source extracted: ''
[13:58:58] [DOC: 9232992] ℹ️  Diagnosis codes being written:
[13:58:58] [DOC: 9232992] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:58:58] [DOC: 9232992] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:58:58] [DOC: 9232992] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:58:58] [DOC: 9232992] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:58:58] [DOC: 9232992] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:58:58] [DOC: 9232992] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:58:58] [DOC: 9232992] ✅ Patient data written to CSV: Donald Maceachern | Sex: MALE | Age: 85 | Service: Nursing | Payer:  | MRN: 3170225
[13:58:58] ✅    ✅ Document 9232992 processed and saved successfully
[13:58:58] 🔄 
🔄 Step 8: Saving API details...
[13:58:58] [DOC: 9232992] ℹ️  API push details saved for document 9232992
[13:58:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232968                         ║
================================================================================
[13:58:58] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:58:58] ℹ️  Date: 04/10/2025
[13:58:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:58:59] [DOC: 9232968] ✅ Text extracted using pdfplumber (1162 chars)
[13:58:59] ✅    ✅ Text extracted using pdfplumber (1162 chars)
[13:58:59] 🔄 
🔄 Step 2: Extracting patient data...
[13:59:02] ℹ️  AI extracted raw sex value: 'M'
[13:59:02] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:59:02] ℹ️  AI extracted payer source: ''
[13:59:02] ℹ️  AI extracted diagnoses:
[13:59:02] ℹ️    - Diagnosis 1: ''
[13:59:02] ℹ️    - Diagnosis 2: ''
[13:59:02] ℹ️    - Diagnosis 3: ''
[13:59:02] ℹ️    - Diagnosis 4: ''
[13:59:02] ℹ️    - Diagnosis 5: ''
[13:59:02] ℹ️    - Diagnosis 6: ''
[13:59:02] ℹ️  Final extracted MRN: '2136200'
[13:59:02] ℹ️  Final extracted Sex: 'MALE'
[13:59:02] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:59:02] ℹ️  Final extracted Payer Source: ''
[13:59:02] ✅ Patient data extraction completed successfully
[13:59:02] ✅    ✅ Patient data extracted successfully
[13:59:02] 📊 Patient Response
     └─ patientFName: Jacob
     └─ patientLName: Amadeu
     └─ dob: 04/03/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2136200
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:59:02] ✅    ✅ Patient identified: Jacob Amadeu
[13:59:02] ✅    ✅ Patient name validation passed
[13:59:02] 🔄 
🔄 Step 3: Processing patient dates...
[13:59:02] [DOC: 9232968] ℹ️  DOB normalized: 04/03/1941
[13:59:02] [DOC: 9232968] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[13:59:02] [DOC: 9232968] ✅ Patient date processing completed successfully
[13:59:02] ✅    ✅ Date processing completed
[13:59:02] 📊 Processed Patient Data
     └─ patientFName: Jacob
     └─ patientLName: Amadeu
     └─ dob: 04/03/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 2136200
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:59:02] 🔄 
🔄 Step 4: Extracting order data...
[13:59:04] ℹ️  Order extraction - MRN: '2136200'
[13:59:04] ℹ️  Order extraction - Sex: 'MALE'
[13:59:04] ℹ️  Order extraction - Service Line: 'SN'
[13:59:04] ℹ️  Order extraction - Payer Source: ''
[13:59:04] ✅ Order data extraction completed successfully
[13:59:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:59:04] ℹ️  Using MRN from patient data: '2136200' over '2136200'
[13:59:04] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[13:59:04] ✅ Patient name cross-validation successful
[13:59:04] ✅    ✅ Data merged successfully
[13:59:05] ✅    ✅ Order data extracted and validated
[13:59:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:59:19] [DOC: 9232968] ℹ️  Patient not found in cache or API: Jacob Amadeu
[13:59:19] [DOC: 9232968] ℹ️  Patient not found, creating new patient via API...
[13:59:19] [DOC: 9232968] ℹ️  Creating patient via API: Jacob Amadeu
[13:59:20] [DOC: 9232968] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:59:20] ❌    ❌ Failed to create patient
[13:59:20] [DOC: 9232968] ℹ️  API push details saved for document 9232968
================================================================================
║                        Processing Document ID: 9232958                         ║
================================================================================
[13:59:20] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:59:20] ℹ️  Date: 04/10/2025
[13:59:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:59:23] [DOC: 9232958] ✅ Text extracted using pdfplumber (16446 chars)
[13:59:23] ✅    ✅ Text extracted using pdfplumber (16446 chars)
[13:59:23] 🔄 
🔄 Step 2: Extracting patient data...
[13:59:26] ℹ️  AI extracted raw sex value: 'M'
[13:59:26] ℹ️  AI extracted service line: 'Skilled Nursing, Home Health Aide'
[13:59:26] ℹ️  AI extracted payer source: ''
[13:59:26] ℹ️  AI extracted diagnoses:
[13:59:26] ℹ️    - Diagnosis 1: 'S82.491D'
[13:59:26] ℹ️    - Diagnosis 2: 'S82.234D'
[13:59:26] ℹ️    - Diagnosis 3: 'Z46.6'
[13:59:26] ℹ️    - Diagnosis 4: 'N40.1'
[13:59:26] ℹ️    - Diagnosis 5: 'R33.8'
[13:59:26] ℹ️    - Diagnosis 6: 'I12.9'
[13:59:26] ℹ️  Final extracted MRN: '2113948'
[13:59:26] ℹ️  Final extracted Sex: 'MALE'
[13:59:26] ℹ️  Final extracted Service Line: 'Skilled Nursing, Home Health Aide'
[13:59:26] ℹ️  Final extracted Payer Source: ''
[13:59:26] ✅ Patient data extraction completed successfully
[13:59:26] ✅    ✅ Patient data extracted successfully
[13:59:26] 📊 Patient Response
     └─ patientFName: Jay
     └─ patientLName: Greenspan
     └─ dob: 03/11/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2113948
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'S82.491D', 'secondDiagnosis': 'S82.234D', 'thirdDiagnosis': 'Z46.6', 'fourthDiagnosis': 'N40.1', 'fifthDiagnosis': 'R33.8', 'sixthDiagnosis': 'I12.9'}]
[13:59:26] ✅    ✅ Patient identified: Jay Greenspan
[13:59:26] ✅    ✅ Patient name validation passed
[13:59:26] 🔄 
🔄 Step 3: Processing patient dates...
[13:59:26] [DOC: 9232958] ℹ️  DOB normalized: 03/11/1942
[13:59:26] [DOC: 9232958] ℹ️  Episode startOfCare normalized: 03/27/2025
[13:59:26] [DOC: 9232958] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[13:59:26] [DOC: 9232958] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[13:59:26] [DOC: 9232958] ✅ Patient date processing completed successfully
[13:59:26] ✅    ✅ Date processing completed
[13:59:26] 📊 Processed Patient Data
     └─ patientFName: Jay
     └─ patientLName: Greenspan
     └─ dob: 03/11/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2113948
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'S82.491D', 'secondDiagnosis': 'S82.234D', 'thirdDiagnosis': 'Z46.6', 'fourthDiagnosis': 'N40.1', 'fifthDiagnosis': 'R33.8', 'sixthDiagnosis': 'I12.9'}]
[13:59:26] 🔄 
🔄 Step 4: Extracting order data...
[13:59:29] ℹ️  Order extraction - MRN: '2113948'
[13:59:29] ℹ️  Order extraction - Sex: 'MALE'
[13:59:29] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Home Health Aide'
[13:59:29] ℹ️  Order extraction - Payer Source: ''
[13:59:29] ✅ Order data extraction completed successfully
[13:59:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:59:29] ℹ️  Using MRN from patient data: '2113948' over '2113948'
[13:59:29] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Home Health Aide'
[13:59:29] ✅ Patient name cross-validation successful
[13:59:29] ✅    ✅ Data merged successfully
[13:59:30] ✅    ✅ Order data extracted and validated
[13:59:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:59:30] [DOC: 9232958] ✅ Patient found in local cache: Jay Greenspan, ID: 1939a2d2-70c3-4e3e-a402-a4eccf79fb4a
[13:59:30] ✅    ✅ Existing patient found with ID: 1939a2d2-70c3-4e3e-a402-a4eccf79fb4a
[13:59:30] 🔄 
🔄 Step 6: Pushing order to API...
[13:59:30] [DOC: 9232958] ℹ️  Pushing order via API for patient ID: 1939a2d2-70c3-4e3e-a402-a4eccf79fb4a
[13:59:32] [DOC: 9232958] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13052"}
[13:59:32] ❌    ❌ Failed to push order
[13:59:32] 🔄 
🔄 Step 7: Writing to CSV...
[13:59:32] [DOC: 9232958] ℹ️  Calculated age: 83 from DOB: 03/11/1942
[13:59:32] [DOC: 9232958] ℹ️  Service Line extracted: 'Skilled Nursing, Home Health Aide'
[13:59:32] [DOC: 9232958] ℹ️  Payer Source extracted: ''
[13:59:32] [DOC: 9232958] ℹ️  Diagnosis codes being written:
[13:59:32] [DOC: 9232958] ℹ️    - Latest_Episode_Firstdiagnosis: 'S82.491D'
[13:59:32] [DOC: 9232958] ℹ️    - Latest_Episode_Seconddiagnosis: 'S82.234D'
[13:59:32] [DOC: 9232958] ℹ️    - Latest_Episode_Thirddiagnosis: 'Z46.6'
[13:59:32] [DOC: 9232958] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N40.1'
[13:59:32] [DOC: 9232958] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R33.8'
[13:59:32] [DOC: 9232958] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I12.9'
[13:59:32] [DOC: 9232958] ✅ Patient data written to CSV: Jay Greenspan | Sex: MALE | Age: 83 | Service: Skilled Nursing, Home Health Aide | Payer:  | MRN: 2113948
[13:59:32] ✅    ✅ Document 9232958 processed and saved successfully
[13:59:32] 🔄 
🔄 Step 8: Saving API details...
[13:59:32] [DOC: 9232958] ℹ️  API push details saved for document 9232958
[13:59:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232918                         ║
================================================================================
[13:59:32] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:59:32] ℹ️  Date: 04/10/2025
[13:59:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:59:33] [DOC: 9232918] ✅ Text extracted using pdfplumber (1087 chars)
[13:59:33] ✅    ✅ Text extracted using pdfplumber (1087 chars)
[13:59:33] 🔄 
🔄 Step 2: Extracting patient data...
[13:59:36] ℹ️  AI extracted raw sex value: 'F'
[13:59:36] ℹ️  AI extracted service line: 'Nursing'
[13:59:36] ℹ️  AI extracted payer source: ''
[13:59:36] ℹ️  AI extracted diagnoses:
[13:59:36] ℹ️    - Diagnosis 1: ''
[13:59:36] ℹ️    - Diagnosis 2: ''
[13:59:36] ℹ️    - Diagnosis 3: ''
[13:59:36] ℹ️    - Diagnosis 4: ''
[13:59:36] ℹ️    - Diagnosis 5: ''
[13:59:36] ℹ️    - Diagnosis 6: ''
[13:59:36] ℹ️  Final extracted MRN: '2489378'
[13:59:36] ℹ️  Final extracted Sex: 'FEMALE'
[13:59:36] ℹ️  Final extracted Service Line: 'Nursing'
[13:59:36] ℹ️  Final extracted Payer Source: ''
[13:59:36] ✅ Patient data extraction completed successfully
[13:59:36] ✅    ✅ Patient data extracted successfully
[13:59:36] 📊 Patient Response
     └─ patientFName: Norma
     └─ patientLName: Fredette
     └─ dob: 11/12/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2489378
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:59:36] ✅    ✅ Patient identified: Norma Fredette
[13:59:36] ✅    ✅ Patient name validation passed
[13:59:36] 🔄 
🔄 Step 3: Processing patient dates...
[13:59:36] [DOC: 9232918] ℹ️  DOB normalized: 11/12/1947
[13:59:36] [DOC: 9232918] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[13:59:36] [DOC: 9232918] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[13:59:36] [DOC: 9232918] ✅ Patient date processing completed successfully
[13:59:36] ✅    ✅ Date processing completed
[13:59:36] 📊 Processed Patient Data
     └─ patientFName: Norma
     └─ patientLName: Fredette
     └─ dob: 11/12/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2489378
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:59:36] 🔄 
🔄 Step 4: Extracting order data...
[13:59:38] ℹ️  Order extraction - MRN: '2489378'
[13:59:38] ℹ️  Order extraction - Sex: 'FEMALE'
[13:59:38] ℹ️  Order extraction - Service Line: ''
[13:59:38] ℹ️  Order extraction - Payer Source: ''
[13:59:38] ✅ Order data extraction completed successfully
[13:59:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:59:38] ℹ️  Using MRN from patient data: '2489378' over '2489378'
[13:59:38] ℹ️  Using service line from patient data: 'Nursing'
[13:59:38] ✅ Patient name cross-validation successful
[13:59:38] ✅    ✅ Data merged successfully
[13:59:39] ✅    ✅ Order data extracted and validated
[13:59:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:59:52] [DOC: 9232918] ✅ Patient exists in API: Norma Fredette, ID: 4bd0828a-689c-48a3-ac25-fe03dabda005
[13:59:52] ✅    ✅ Existing patient found with ID: 4bd0828a-689c-48a3-ac25-fe03dabda005
[13:59:52] 🔄 
🔄 Step 6: Pushing order to API...
[13:59:52] [DOC: 9232918] ℹ️  Pushing order via API for patient ID: 4bd0828a-689c-48a3-ac25-fe03dabda005
[13:59:54] [DOC: 9232918] ❌ Order push failed with status 201: {"id":"9bd7b9d4-a30a-4776-9bb5-31d814a7005e","orderWAVId":"ORD20040","orderNo":"1080288","orderDate":"04/09/2025","startOfCare":"03/18/2025","episodeStartDate":"03/18/2025","episodeEndDate":"04/17/2025","documentID":"9232918","mrn":"2489378","patientName":"Fredette,Norma E","sentToPhysicianDate":"04/10/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/11/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"4bd0828a-689c-48a3-ac25-fe03dabda005","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[13:59:54] ❌    ❌ Failed to push order
[13:59:54] 🔄 
🔄 Step 7: Writing to CSV...
[13:59:54] [DOC: 9232918] ℹ️  Calculated age: 77 from DOB: 11/12/1947
[13:59:54] [DOC: 9232918] ℹ️  Service Line extracted: 'Nursing'
[13:59:54] [DOC: 9232918] ℹ️  Payer Source extracted: ''
[13:59:54] [DOC: 9232918] ℹ️  Diagnosis codes being written:
[13:59:54] [DOC: 9232918] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:59:54] [DOC: 9232918] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:59:54] [DOC: 9232918] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:59:54] [DOC: 9232918] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:59:54] [DOC: 9232918] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:59:54] [DOC: 9232918] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:59:54] [DOC: 9232918] ✅ Patient data written to CSV: Norma Fredette | Sex: FEMALE | Age: 77 | Service: Nursing | Payer:  | MRN: 2489378
[13:59:54] ✅    ✅ Document 9232918 processed and saved successfully
[13:59:54] 🔄 
🔄 Step 8: Saving API details...
[13:59:54] [DOC: 9232918] ℹ️  API push details saved for document 9232918
[13:59:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232914                         ║
================================================================================
[13:59:54] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:59:54] ℹ️  Date: 04/10/2025
[13:59:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:59:57] [DOC: 9232914] ✅ Text extracted using pdfplumber (25868 chars)
[13:59:57] ✅    ✅ Text extracted using pdfplumber (25868 chars)
[13:59:57] 🔄 
🔄 Step 2: Extracting patient data...
[14:00:00] ℹ️  AI extracted raw sex value: 'M'
[14:00:00] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology'
[14:00:00] ℹ️  AI extracted payer source: 'None'
[14:00:00] ℹ️  AI extracted diagnoses:
[14:00:00] ℹ️    - Diagnosis 1: 'I69.351'
[14:00:00] ℹ️    - Diagnosis 2: 'I69.320'
[14:00:00] ℹ️    - Diagnosis 3: 'G35'
[14:00:00] ℹ️    - Diagnosis 4: 'G40.909'
[14:00:00] ℹ️    - Diagnosis 5: 'I48.91'
[14:00:00] ℹ️    - Diagnosis 6: 'J45.909'
[14:00:00] ℹ️  Final extracted MRN: '2475455'
[14:00:00] ℹ️  Final extracted Sex: 'MALE'
[14:00:00] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology'
[14:00:00] ℹ️  Final extracted Payer Source: ''
[14:00:00] ✅ Patient data extraction completed successfully
[14:00:00] ✅    ✅ Patient data extracted successfully
[14:00:00] 📊 Patient Response
     └─ patientFName: Jay
     └─ patientLName: Flanagan
     └─ dob: 11/01/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 2475455
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: None
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'I69.351', 'secondDiagnosis': 'I69.320', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': 'G40.909', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'J45.909'}]
[14:00:00] ✅    ✅ Patient identified: Jay Flanagan
[14:00:00] ✅    ✅ Patient name validation passed
[14:00:00] 🔄 
🔄 Step 3: Processing patient dates...
[14:00:00] [DOC: 9232914] ℹ️  DOB normalized: 11/01/1951
[14:00:00] [DOC: 9232914] ℹ️  Episode startOfCare normalized: 03/28/2025
[14:00:00] [DOC: 9232914] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[14:00:00] [DOC: 9232914] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[14:00:00] [DOC: 9232914] ✅ Patient date processing completed successfully
[14:00:00] ✅    ✅ Date processing completed
[14:00:00] 📊 Processed Patient Data
     └─ patientFName: Jay
     └─ patientLName: Flanagan
     └─ dob: 11/01/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 2475455
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'I69.351', 'secondDiagnosis': 'I69.320', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': 'G40.909', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'J45.909'}]
[14:00:00] 🔄 
🔄 Step 4: Extracting order data...
[14:00:03] ℹ️  Order extraction - MRN: '2475455'
[14:00:03] ℹ️  Order extraction - Sex: 'MALE'
[14:00:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology'
[14:00:03] ℹ️  Order extraction - Payer Source: ''
[14:00:03] ✅ Order data extraction completed successfully
[14:00:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:00:03] ℹ️  Using MRN from patient data: '2475455' over '2475455'
[14:00:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Language Pathology'
[14:00:03] ✅ Patient name cross-validation successful
[14:00:03] ✅    ✅ Data merged successfully
[14:00:05] ✅    ✅ Order data extracted and validated
[14:00:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:00:13] [DOC: 9232914] ℹ️  Patient not found in cache or API: Jay Flanagan
[14:00:13] [DOC: 9232914] ℹ️  Patient not found, creating new patient via API...
[14:00:13] [DOC: 9232914] ℹ️  Creating patient via API: Jay Flanagan
[14:00:14] [DOC: 9232914] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:00:14] ❌    ❌ Failed to create patient
[14:00:14] [DOC: 9232914] ℹ️  API push details saved for document 9232914
================================================================================
║                        Processing Document ID: 9232906                         ║
================================================================================
[14:00:14] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:00:14] ℹ️  Date: 04/10/2025
[14:00:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:00:15] [DOC: 9232906] ✅ Text extracted using pdfplumber (991 chars)
[14:00:15] ✅    ✅ Text extracted using pdfplumber (991 chars)
[14:00:15] 🔄 
🔄 Step 2: Extracting patient data...
[14:00:18] ℹ️  AI extracted raw sex value: 'F'
[14:00:18] ℹ️  AI extracted service line: ''
[14:00:18] ℹ️  AI extracted payer source: ''
[14:00:18] ℹ️  AI extracted diagnoses:
[14:00:18] ℹ️    - Diagnosis 1: ''
[14:00:18] ℹ️    - Diagnosis 2: ''
[14:00:18] ℹ️    - Diagnosis 3: ''
[14:00:18] ℹ️    - Diagnosis 4: ''
[14:00:18] ℹ️    - Diagnosis 5: ''
[14:00:18] ℹ️    - Diagnosis 6: ''
[14:00:18] ℹ️  Final extracted MRN: '2461998'
[14:00:18] ℹ️  Final extracted Sex: 'FEMALE'
[14:00:18] ℹ️  Final extracted Service Line: ''
[14:00:18] ℹ️  Final extracted Payer Source: ''
[14:00:18] ✅ Patient data extraction completed successfully
[14:00:18] ✅    ✅ Patient data extracted successfully
[14:00:18] 📊 Patient Response
     └─ patientFName: Dolores
     └─ patientLName: Fernandes
     └─ dob: 08/26/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2461998
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:00:18] ✅    ✅ Patient identified: Dolores Fernandes
[14:00:18] ✅    ✅ Patient name validation passed
[14:00:18] 🔄 
🔄 Step 3: Processing patient dates...
[14:00:18] [DOC: 9232906] ℹ️  DOB normalized: 08/26/1931
[14:00:18] [DOC: 9232906] ✅ Patient date processing completed successfully
[14:00:18] ✅    ✅ Date processing completed
[14:00:18] 📊 Processed Patient Data
     └─ patientFName: Dolores
     └─ patientLName: Fernandes
     └─ dob: 08/26/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2461998
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:00:18] 🔄 
🔄 Step 4: Extracting order data...
[14:00:20] ℹ️  Order extraction - MRN: '2461998'
[14:00:20] ℹ️  Order extraction - Sex: 'FEMALE'
[14:00:20] ℹ️  Order extraction - Service Line: ''
[14:00:20] ℹ️  Order extraction - Payer Source: ''
[14:00:20] ✅ Order data extraction completed successfully
[14:00:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:00:20] ℹ️  Using MRN from patient data: '2461998' over '2461998'
[14:00:20] ✅ Patient name cross-validation successful
[14:00:20] ✅    ✅ Data merged successfully
[14:00:21] ✅    ✅ Order data extracted and validated
[14:00:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:00:42] [DOC: 9232906] ✅ Patient exists in API: Dolores Fernandes, ID: fcab244b-32d7-404c-9e73-965d056a5073
[14:00:42] ✅    ✅ Existing patient found with ID: fcab244b-32d7-404c-9e73-965d056a5073
[14:00:42] 🔄 
🔄 Step 6: Pushing order to API...
[14:00:42] [DOC: 9232906] ℹ️  Pushing order via API for patient ID: fcab244b-32d7-404c-9e73-965d056a5073
[14:00:43] [DOC: 9232906] ❌ Order push failed with status 201: {"id":"2c2d6f36-d15f-4428-94b8-9dfc00658a60","orderWAVId":"ORD20041","orderNo":"1079889","orderDate":"04/08/2025","startOfCare":"03/18/2025","episodeStartDate":"03/18/2025","episodeEndDate":"04/08/2025","documentID":"9232906","mrn":"2461998","patientName":"Fernandes,Dolores F","sentToPhysicianDate":"04/10/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/14/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"fcab244b-32d7-404c-9e73-965d056a5073","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[14:00:43] ❌    ❌ Failed to push order
[14:00:43] 🔄 
🔄 Step 7: Writing to CSV...
[14:00:43] [DOC: 9232906] ℹ️  Calculated age: 93 from DOB: 08/26/1931
[14:00:43] [DOC: 9232906] ℹ️  Service Line extracted: ''
[14:00:43] [DOC: 9232906] ℹ️  Payer Source extracted: ''
[14:00:43] [DOC: 9232906] ℹ️  Diagnosis codes being written:
[14:00:43] [DOC: 9232906] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:00:43] [DOC: 9232906] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:00:43] [DOC: 9232906] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:00:43] [DOC: 9232906] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:00:43] [DOC: 9232906] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:00:43] [DOC: 9232906] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:00:43] [DOC: 9232906] ✅ Patient data written to CSV: Dolores Fernandes | Sex: FEMALE | Age: 93 | Service:  | Payer:  | MRN: 2461998
[14:00:43] ✅    ✅ Document 9232906 processed and saved successfully
[14:00:43] 🔄 
🔄 Step 8: Saving API details...
[14:00:43] [DOC: 9232906] ℹ️  API push details saved for document 9232906
[14:00:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232904                         ║
================================================================================
[14:00:43] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:00:43] ℹ️  Date: 04/10/2025
[14:00:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:00:47] [DOC: 9232904] ✅ Text extracted using pdfplumber (24823 chars)
[14:00:47] ✅    ✅ Text extracted using pdfplumber (24823 chars)
[14:00:47] 🔄 
🔄 Step 2: Extracting patient data...
[14:00:50] ℹ️  AI extracted raw sex value: 'M'
[14:00:50] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:00:50] ℹ️  AI extracted payer source: ''
[14:00:50] ℹ️  AI extracted diagnoses:
[14:00:50] ℹ️    - Diagnosis 1: 'I11.0'
[14:00:50] ℹ️    - Diagnosis 2: 'I50.33'
[14:00:50] ℹ️    - Diagnosis 3: 'J96.01'
[14:00:50] ℹ️    - Diagnosis 4: 'J44.9'
[14:00:50] ℹ️    - Diagnosis 5: 'J43.9'
[14:00:50] ℹ️    - Diagnosis 6: 'J84.10'
[14:00:50] ℹ️  Final extracted MRN: '2447688'
[14:00:50] ℹ️  Final extracted Sex: 'MALE'
[14:00:50] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:00:50] ℹ️  Final extracted Payer Source: ''
[14:00:50] ✅ Patient data extraction completed successfully
[14:00:50] ✅    ✅ Patient data extracted successfully
[14:00:50] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'J96.01', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'J43.9', 'sixthDiagnosis': 'J84.10'}]
[14:00:50] ✅    ✅ Patient identified: George England
[14:00:50] ✅    ✅ Patient name validation passed
[14:00:50] 🔄 
🔄 Step 3: Processing patient dates...
[14:00:50] [DOC: 9232904] ℹ️  DOB normalized: 08/26/1924
[14:00:50] [DOC: 9232904] ℹ️  Episode startOfCare normalized: 03/28/2025
[14:00:50] [DOC: 9232904] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[14:00:50] [DOC: 9232904] ℹ️  Episode endOfEpisode normalized: 05/28/2025
[14:00:50] [DOC: 9232904] ✅ Patient date processing completed successfully
[14:00:50] ✅    ✅ Date processing completed
[14:00:50] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/28/2025', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'J96.01', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'J43.9', 'sixthDiagnosis': 'J84.10'}]
[14:00:50] 🔄 
🔄 Step 4: Extracting order data...
[14:00:53] ℹ️  Order extraction - MRN: '2447688'
[14:00:53] ℹ️  Order extraction - Sex: 'MALE'
[14:00:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[14:00:53] ℹ️  Order extraction - Payer Source: ''
[14:00:53] ✅ Order data extraction completed successfully
[14:00:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:00:53] ℹ️  Using MRN from patient data: '2447688' over '2447688'
[14:00:53] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy' + Order='Skilled Nursing,Physical Therapy,Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[14:00:53] ✅ Patient name cross-validation successful
[14:00:53] ✅    ✅ Data merged successfully
[14:00:54] ✅    ✅ Order data extracted and validated
[14:00:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:01:05] [DOC: 9232904] ✅ Patient exists in API: George England, ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[14:01:05] ✅    ✅ Existing patient found with ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[14:01:05] 🔄 
🔄 Step 6: Pushing order to API...
[14:01:05] [DOC: 9232904] ℹ️  Pushing order via API for patient ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[14:01:06] [DOC: 9232904] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14173"}
[14:01:06] ❌    ❌ Failed to push order
[14:01:06] 🔄 
🔄 Step 7: Writing to CSV...
[14:01:06] [DOC: 9232904] ℹ️  Calculated age: 100 from DOB: 08/26/1924
[14:01:06] [DOC: 9232904] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[14:01:06] [DOC: 9232904] ℹ️  Payer Source extracted: ''
[14:01:06] [DOC: 9232904] ℹ️  Diagnosis codes being written:
[14:01:06] [DOC: 9232904] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[14:01:06] [DOC: 9232904] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[14:01:06] [DOC: 9232904] ℹ️    - Latest_Episode_Thirddiagnosis: 'J96.01'
[14:01:06] [DOC: 9232904] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J44.9'
[14:01:06] [DOC: 9232904] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J43.9'
[14:01:06] [DOC: 9232904] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J84.10'
[14:01:06] [DOC: 9232904] ✅ Patient data written to CSV: George England | Sex: MALE | Age: 100 | Service: Occupational Therapy, Physical Therapy, Skilled Nursing | Payer:  | MRN: 2447688
[14:01:06] ✅    ✅ Document 9232904 processed and saved successfully
[14:01:06] 🔄 
🔄 Step 8: Saving API details...
[14:01:06] [DOC: 9232904] ℹ️  API push details saved for document 9232904
[14:01:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232885                         ║
================================================================================
[14:01:06] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:01:06] ℹ️  Date: 04/10/2025
[14:01:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:01:09] [DOC: 9232885] ✅ Text extracted using pdfplumber (24360 chars)
[14:01:09] ✅    ✅ Text extracted using pdfplumber (24360 chars)
[14:01:09] 🔄 
🔄 Step 2: Extracting patient data...
[14:01:13] ℹ️  AI extracted raw sex value: 'M'
[14:01:13] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, HHA'
[14:01:13] ℹ️  AI extracted payer source: ''
[14:01:13] ℹ️  AI extracted diagnoses:
[14:01:13] ℹ️    - Diagnosis 1: 'I63.9'
[14:01:13] ℹ️    - Diagnosis 2: 'E78.5'
[14:01:13] ℹ️    - Diagnosis 3: 'K21.9'
[14:01:13] ℹ️    - Diagnosis 4: 'E03.8'
[14:01:13] ℹ️    - Diagnosis 5: 'F03.90'
[14:01:13] ℹ️    - Diagnosis 6: 'F41.1'
[14:01:13] ℹ️  Final extracted MRN: '2312121'
[14:01:13] ℹ️  Final extracted Sex: 'MALE'
[14:01:13] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, HHA'
[14:01:13] ℹ️  Final extracted Payer Source: ''
[14:01:13] ✅ Patient data extraction completed successfully
[14:01:13] ✅    ✅ Patient data extracted successfully
[14:01:13] 📊 Patient Response
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I63.9', 'secondDiagnosis': 'E78.5', 'thirdDiagnosis': 'K21.9', 'fourthDiagnosis': 'E03.8', 'fifthDiagnosis': 'F03.90', 'sixthDiagnosis': 'F41.1'}]
[14:01:13] ✅    ✅ Patient identified: Antonio Carvalho
[14:01:13] ✅    ✅ Patient name validation passed
[14:01:13] 🔄 
🔄 Step 3: Processing patient dates...
[14:01:13] [DOC: 9232885] ℹ️  DOB normalized: 07/01/1933
[14:01:13] [DOC: 9232885] ℹ️  Episode startOfCare normalized: 04/07/2025
[14:01:13] [DOC: 9232885] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[14:01:13] [DOC: 9232885] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[14:01:13] [DOC: 9232885] ✅ Patient date processing completed successfully
[14:01:13] ✅    ✅ Date processing completed
[14:01:13] 📊 Processed Patient Data
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I63.9', 'secondDiagnosis': 'E78.5', 'thirdDiagnosis': 'K21.9', 'fourthDiagnosis': 'E03.8', 'fifthDiagnosis': 'F03.90', 'sixthDiagnosis': 'F41.1'}]
[14:01:13] 🔄 
🔄 Step 4: Extracting order data...
[14:01:15] ℹ️  Order extraction - MRN: '2312121'
[14:01:15] ℹ️  Order extraction - Sex: 'MALE'
[14:01:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, HHA'
[14:01:15] ℹ️  Order extraction - Payer Source: ''
[14:01:15] ✅ Order data extraction completed successfully
[14:01:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:01:15] ℹ️  Using MRN from patient data: '2312121' over '2312121'
[14:01:15] ℹ️  Service line consistent in both sources: 'Skilled Nursing, MSW, HHA'
[14:01:15] ✅ Patient name cross-validation successful
[14:01:15] ✅    ✅ Data merged successfully
[14:01:16] ✅    ✅ Order data extracted and validated
[14:01:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:01:22] [DOC: 9232885] ℹ️  Patient not found in cache or API: Antonio Carvalho
[14:01:22] [DOC: 9232885] ℹ️  Patient not found, creating new patient via API...
[14:01:22] [DOC: 9232885] ℹ️  Creating patient via API: Antonio Carvalho
[14:01:24] [DOC: 9232885] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:01:24] ❌    ❌ Failed to create patient
[14:01:24] [DOC: 9232885] ℹ️  API push details saved for document 9232885
================================================================================
║                        Processing Document ID: 9232883                         ║
================================================================================
[14:01:24] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:01:24] ℹ️  Date: 04/10/2025
[14:01:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:01:26] [DOC: 9232883] ✅ Text extracted using pdfplumber (16218 chars)
[14:01:26] ✅    ✅ Text extracted using pdfplumber (16208 chars)
[14:01:26] 🔄 
🔄 Step 2: Extracting patient data...
[14:01:30] ℹ️  AI extracted raw sex value: 'F'
[14:01:30] ℹ️  AI extracted service line: 'Physical Therapy, Skilled Nursing'
[14:01:30] ℹ️  AI extracted payer source: ''
[14:01:30] ℹ️  AI extracted diagnoses:
[14:01:30] ℹ️    - Diagnosis 1: 'K56.690'
[14:01:30] ℹ️    - Diagnosis 2: 'G93.41'
[14:01:30] ℹ️    - Diagnosis 3: 'E87.6'
[14:01:30] ℹ️    - Diagnosis 4: 'G30.1'
[14:01:30] ℹ️    - Diagnosis 5: 'F02.B0'
[14:01:30] ℹ️    - Diagnosis 6: 'E11.9'
[14:01:30] ℹ️  Final extracted MRN: '2296721'
[14:01:30] ℹ️  Final extracted Sex: 'FEMALE'
[14:01:30] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled Nursing'
[14:01:30] ℹ️  Final extracted Payer Source: ''
[14:01:30] ✅ Patient data extraction completed successfully
[14:01:30] ✅    ✅ Patient data extracted successfully
[14:01:30] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Camara
     └─ dob: 11/02/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2296721
     └─ billingProvider: Mary R Dias-Regus, NP
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'K56.690', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'E87.6', 'fourthDiagnosis': 'G30.1', 'fifthDiagnosis': 'F02.B0', 'sixthDiagnosis': 'E11.9'}]
[14:01:30] ✅    ✅ Patient identified: Maria Camara
[14:01:30] ✅    ✅ Patient name validation passed
[14:01:30] 🔄 
🔄 Step 3: Processing patient dates...
[14:01:30] [DOC: 9232883] ℹ️  DOB normalized: 11/02/1932
[14:01:30] [DOC: 9232883] ℹ️  Episode startOfCare normalized: 03/27/2025
[14:01:30] [DOC: 9232883] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[14:01:30] [DOC: 9232883] ℹ️  Episode endOfEpisode normalized: 05/26/2025
[14:01:30] [DOC: 9232883] ✅ Patient date processing completed successfully
[14:01:30] ✅    ✅ Date processing completed
[14:01:30] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Camara
     └─ dob: 11/02/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2296721
     └─ billingProvider: Mary R Dias-Regus, NP
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'K56.690', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'E87.6', 'fourthDiagnosis': 'G30.1', 'fifthDiagnosis': 'F02.B0', 'sixthDiagnosis': 'E11.9'}]
[14:01:30] 🔄 
🔄 Step 4: Extracting order data...
[14:01:33] ℹ️  Order extraction - MRN: '2296721'
[14:01:33] ℹ️  Order extraction - Sex: 'FEMALE'
[14:01:33] ℹ️  Order extraction - Service Line: 'PT'
[14:01:33] ℹ️  Order extraction - Payer Source: ''
[14:01:33] ✅ Order data extraction completed successfully
[14:01:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:01:33] ℹ️  Using MRN from patient data: '2296721' over '2296721'
[14:01:33] ℹ️  Combined service lines: Patient='Physical Therapy, Skilled Nursing' + Order='PT' = 'PT, Physical Therapy, Skilled Nursing'
[14:01:33] ✅ Patient name cross-validation successful
[14:01:33] ✅    ✅ Data merged successfully
[14:01:34] ✅    ✅ Order data extracted and validated
[14:01:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:02:01] [DOC: 9232883] ℹ️  Patient not found in cache or API: Maria Camara
[14:02:01] [DOC: 9232883] ℹ️  Patient not found, creating new patient via API...
[14:02:01] [DOC: 9232883] ℹ️  Creating patient via API: Maria Camara
[14:02:02] [DOC: 9232883] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:02:02] ❌    ❌ Failed to create patient
[14:02:02] [DOC: 9232883] ℹ️  API push details saved for document 9232883
================================================================================
║                        Processing Document ID: 9232876                         ║
================================================================================
[14:02:02] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:02:02] ℹ️  Date: 04/10/2025
[14:02:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:02:04] [DOC: 9232876] ✅ Text extracted using pdfplumber (977 chars)
[14:02:04] ✅    ✅ Text extracted using pdfplumber (977 chars)
[14:02:04] 🔄 
🔄 Step 2: Extracting patient data...
[14:02:06] ℹ️  AI extracted raw sex value: 'F'
[14:02:06] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:02:06] ℹ️  AI extracted payer source: ''
[14:02:06] ℹ️  AI extracted diagnoses:
[14:02:06] ℹ️    - Diagnosis 1: ''
[14:02:06] ℹ️    - Diagnosis 2: ''
[14:02:06] ℹ️    - Diagnosis 3: ''
[14:02:06] ℹ️    - Diagnosis 4: ''
[14:02:06] ℹ️    - Diagnosis 5: ''
[14:02:06] ℹ️    - Diagnosis 6: ''
[14:02:06] ℹ️  Final extracted MRN: '2037361'
[14:02:06] ℹ️  Final extracted Sex: 'FEMALE'
[14:02:06] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:02:06] ℹ️  Final extracted Payer Source: ''
[14:02:06] ✅ Patient data extraction completed successfully
[14:02:06] ✅    ✅ Patient data extracted successfully
[14:02:06] 📊 Patient Response
     └─ patientFName: Euridice
     └─ patientLName: Caldas
     └─ dob: 10/13/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2037361
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:02:06] ✅    ✅ Patient identified: Euridice Caldas
[14:02:06] ✅    ✅ Patient name validation passed
[14:02:06] 🔄 
🔄 Step 3: Processing patient dates...
[14:02:06] [DOC: 9232876] ℹ️  DOB normalized: 10/13/1934
[14:02:06] [DOC: 9232876] ✅ Patient date processing completed successfully
[14:02:06] ✅    ✅ Date processing completed
[14:02:06] 📊 Processed Patient Data
     └─ patientFName: Euridice
     └─ patientLName: Caldas
     └─ dob: 10/13/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2037361
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:02:06] 🔄 
🔄 Step 4: Extracting order data...
[14:02:09] ℹ️  Order extraction - MRN: '2037361'
[14:02:09] ℹ️  Order extraction - Sex: 'FEMALE'
[14:02:09] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:02:09] ℹ️  Order extraction - Payer Source: ''
[14:02:09] ✅ Order data extraction completed successfully
[14:02:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:02:09] ℹ️  Using MRN from patient data: '2037361' over '2037361'
[14:02:09] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:02:09] ✅ Patient name cross-validation successful
[14:02:09] ✅    ✅ Data merged successfully
[14:02:10] ✅    ✅ Order data extracted and validated
[14:02:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:02:10] [DOC: 9232876] ✅ Patient found in local cache: Euridice Caldas, ID: 1e054717-d198-4bd4-bb3b-44e39f78739e
[14:02:10] ✅    ✅ Existing patient found with ID: 1e054717-d198-4bd4-bb3b-44e39f78739e
[14:02:10] 🔄 
🔄 Step 6: Pushing order to API...
[14:02:10] [DOC: 9232876] ℹ️  Pushing order via API for patient ID: 1e054717-d198-4bd4-bb3b-44e39f78739e
[14:02:12] [DOC: 9232876] ❌ Order push failed with status 201: {"id":"968eecc2-ae53-4de3-bc1b-a80cfba742aa","orderWAVId":"ORD20042","orderNo":"1080311","orderDate":"04/09/2025","startOfCare":"04/09/2025","episodeStartDate":"04/09/2025","episodeEndDate":"06/07/2025","documentID":"9232876","mrn":"2037361","patientName":"Caldas,Euridice S","sentToPhysicianDate":"04/10/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/16/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"1e054717-d198-4bd4-bb3b-44e39f78739e","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[14:02:12] ❌    ❌ Failed to push order
[14:02:12] 🔄 
🔄 Step 7: Writing to CSV...
[14:02:12] [DOC: 9232876] ℹ️  Calculated age: 90 from DOB: 10/13/1934
[14:02:12] [DOC: 9232876] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:02:12] [DOC: 9232876] ℹ️  Payer Source extracted: ''
[14:02:12] [DOC: 9232876] ℹ️  Diagnosis codes being written:
[14:02:12] [DOC: 9232876] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:02:12] [DOC: 9232876] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:02:12] [DOC: 9232876] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:02:12] [DOC: 9232876] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:02:12] [DOC: 9232876] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:02:12] [DOC: 9232876] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:02:12] [DOC: 9232876] ✅ Patient data written to CSV: Euridice Caldas | Sex: FEMALE | Age: 90 | Service: Skilled Nursing | Payer:  | MRN: 2037361
[14:02:12] ✅    ✅ Document 9232876 processed and saved successfully
[14:02:12] 🔄 
🔄 Step 8: Saving API details...
[14:02:12] [DOC: 9232876] ℹ️  API push details saved for document 9232876
[14:02:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232873                         ║
================================================================================
[14:02:12] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:02:12] ℹ️  Date: 04/10/2025
[14:02:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:02:13] [DOC: 9232873] ✅ Text extracted using pdfplumber (1054 chars)
[14:02:13] ✅    ✅ Text extracted using pdfplumber (1054 chars)
[14:02:13] 🔄 
🔄 Step 2: Extracting patient data...
[14:02:16] ℹ️  AI extracted raw sex value: 'M'
[14:02:16] ℹ️  AI extracted service line: ''
[14:02:16] ℹ️  AI extracted payer source: ''
[14:02:16] ℹ️  AI extracted diagnoses:
[14:02:16] ℹ️    - Diagnosis 1: ''
[14:02:16] ℹ️    - Diagnosis 2: ''
[14:02:16] ℹ️    - Diagnosis 3: ''
[14:02:16] ℹ️    - Diagnosis 4: ''
[14:02:16] ℹ️    - Diagnosis 5: ''
[14:02:16] ℹ️    - Diagnosis 6: ''
[14:02:16] ℹ️  Final extracted MRN: '2261639'
[14:02:16] ℹ️  Final extracted Sex: 'MALE'
[14:02:16] ℹ️  Final extracted Service Line: ''
[14:02:16] ℹ️  Final extracted Payer Source: ''
[14:02:16] ✅ Patient data extraction completed successfully
[14:02:16] ✅    ✅ Patient data extracted successfully
[14:02:16] 📊 Patient Response
     └─ patientFName: Webster
     └─ patientLName: Bowen
     └─ dob: 09/12/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 2261639
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:02:16] ✅    ✅ Patient identified: Webster Bowen
[14:02:16] ✅    ✅ Patient name validation passed
[14:02:16] 🔄 
🔄 Step 3: Processing patient dates...
[14:02:16] [DOC: 9232873] ℹ️  DOB normalized: 09/12/1949
[14:02:16] [DOC: 9232873] ✅ Patient date processing completed successfully
[14:02:16] ✅    ✅ Date processing completed
[14:02:16] 📊 Processed Patient Data
     └─ patientFName: Webster
     └─ patientLName: Bowen
     └─ dob: 09/12/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 2261639
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:02:16] 🔄 
🔄 Step 4: Extracting order data...
[14:02:18] ℹ️  Order extraction - MRN: '2261639'
[14:02:18] ℹ️  Order extraction - Sex: 'MALE'
[14:02:18] ℹ️  Order extraction - Service Line: ''
[14:02:18] ℹ️  Order extraction - Payer Source: ''
[14:02:18] ✅ Order data extraction completed successfully
[14:02:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:02:18] ℹ️  Using MRN from patient data: '2261639' over '2261639'
[14:02:18] ✅ Patient name cross-validation successful
[14:02:18] ✅    ✅ Data merged successfully
[14:02:19] ⚠️     ❌ Skipping - missing episode start date
[14:02:19] [DOC: 9232873] ℹ️  API push details saved for document 9232873
================================================================================
║                        Processing Document ID: 9232866                         ║
================================================================================
[14:02:19] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:02:19] ℹ️  Date: 04/10/2025
[14:02:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:02:23] [DOC: 9232866] ✅ Text extracted using pdfplumber (31935 chars)
[14:02:23] ✅    ✅ Text extracted using pdfplumber (31935 chars)
[14:02:23] 🔄 
🔄 Step 2: Extracting patient data...
[14:02:26] ℹ️  AI extracted raw sex value: 'F'
[14:02:26] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, Clergy'
[14:02:26] ℹ️  AI extracted payer source: 'Medicaid'
[14:02:26] ℹ️  AI extracted diagnoses:
[14:02:26] ℹ️    - Diagnosis 1: 'N32.89'
[14:02:26] ℹ️    - Diagnosis 2: 'N30.01'
[14:02:26] ℹ️    - Diagnosis 3: 'F03.90'
[14:02:26] ℹ️    - Diagnosis 4: 'G91.2'
[14:02:26] ℹ️    - Diagnosis 5: 'I48.20'
[14:02:26] ℹ️    - Diagnosis 6: 'J45.909'
[14:02:26] ℹ️  Final extracted MRN: '2234420'
[14:02:26] ℹ️  Final extracted Sex: 'FEMALE'
[14:02:26] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, Clergy'
[14:02:26] ℹ️  Final extracted Payer Source: 'Medicaid'
[14:02:26] ✅ Patient data extraction completed successfully
[14:02:26] ✅    ✅ Patient data extracted successfully
[14:02:26] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Bento
     └─ dob: 12/20/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2234420
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-996-3991
     └─ serviceLine: Skilled Nursing, MSW, Clergy
     └─ payorSource: Medicaid
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/04/2025', 'endOfEpisode': '07/02/2025', 'firstDiagnosis': 'N32.89', 'secondDiagnosis': 'N30.01', 'thirdDiagnosis': 'F03.90', 'fourthDiagnosis': 'G91.2', 'fifthDiagnosis': 'I48.20', 'sixthDiagnosis': 'J45.909'}]
[14:02:26] ✅    ✅ Patient identified: Maria Bento
[14:02:26] ✅    ✅ Patient name validation passed
[14:02:26] 🔄 
🔄 Step 3: Processing patient dates...
[14:02:26] [DOC: 9232866] ℹ️  DOB normalized: 12/20/1941
[14:02:26] [DOC: 9232866] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[14:02:26] [DOC: 9232866] ℹ️  Episode endOfEpisode normalized: 07/02/2025
[14:02:26] [DOC: 9232866] ✅ Patient date processing completed successfully
[14:02:26] ✅    ✅ Date processing completed
[14:02:26] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Bento
     └─ dob: 12/20/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2234420
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-996-3991
     └─ serviceLine: Skilled Nursing, MSW, Clergy
     └─ payorSource: Medicaid
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '07/02/2025', 'firstDiagnosis': 'N32.89', 'secondDiagnosis': 'N30.01', 'thirdDiagnosis': 'F03.90', 'fourthDiagnosis': 'G91.2', 'fifthDiagnosis': 'I48.20', 'sixthDiagnosis': 'J45.909'}]
[14:02:26] 🔄 
🔄 Step 4: Extracting order data...
[14:02:29] ℹ️  Order extraction - MRN: '2234420'
[14:02:29] ℹ️  Order extraction - Sex: 'FEMALE'
[14:02:29] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, Clergy'
[14:02:29] ℹ️  Order extraction - Payer Source: 'Medicaid'
[14:02:29] ✅ Order data extraction completed successfully
[14:02:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:02:29] ℹ️  Using MRN from patient data: '2234420' over '2234420'
[14:02:29] ℹ️  Service line consistent in both sources: 'Skilled Nursing, MSW, Clergy'
[14:02:29] ℹ️  Payer source consistent in both sources: 'Medicaid'
[14:02:29] ✅ Patient name cross-validation successful
[14:02:29] ✅    ✅ Data merged successfully
[14:02:30] ✅    ✅ Order data extracted and validated
[14:02:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:02:54] [DOC: 9232866] ✅ Patient exists in API: Maria Bento, ID: d4a1a1eb-aab3-4fbd-9217-ee0d0bad9907
[14:02:54] ✅    ✅ Existing patient found with ID: d4a1a1eb-aab3-4fbd-9217-ee0d0bad9907
[14:02:54] 🔄 
🔄 Step 6: Pushing order to API...
[14:02:54] [DOC: 9232866] ℹ️  Pushing order via API for patient ID: d4a1a1eb-aab3-4fbd-9217-ee0d0bad9907
[14:02:55] [DOC: 9232866] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13093"}
[14:02:55] ❌    ❌ Failed to push order
[14:02:55] 🔄 
🔄 Step 7: Writing to CSV...
[14:02:55] [DOC: 9232866] ℹ️  Calculated age: 83 from DOB: 12/20/1941
[14:02:55] [DOC: 9232866] ℹ️  Service Line extracted: 'Skilled Nursing, MSW, Clergy'
[14:02:55] [DOC: 9232866] ℹ️  Payer Source extracted: 'Medicaid'
[14:02:55] [DOC: 9232866] ℹ️  Diagnosis codes being written:
[14:02:55] [DOC: 9232866] ℹ️    - Latest_Episode_Firstdiagnosis: 'N32.89'
[14:02:55] [DOC: 9232866] ℹ️    - Latest_Episode_Seconddiagnosis: 'N30.01'
[14:02:55] [DOC: 9232866] ℹ️    - Latest_Episode_Thirddiagnosis: 'F03.90'
[14:02:55] [DOC: 9232866] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G91.2'
[14:02:55] [DOC: 9232866] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I48.20'
[14:02:55] [DOC: 9232866] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J45.909'
[14:02:55] [DOC: 9232866] ✅ Patient data written to CSV: Maria Bento | Sex: FEMALE | Age: 83 | Service: Skilled Nursing, MSW, Clergy | Payer: Medicaid | MRN: 2234420
[14:02:55] ✅    ✅ Document 9232866 processed and saved successfully
[14:02:55] 🔄 
🔄 Step 8: Saving API details...
[14:02:55] [DOC: 9232866] ℹ️  API push details saved for document 9232866
[14:02:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232213                         ║
================================================================================
[14:02:55] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:02:55] ℹ️  Date: 04/10/2025
[14:02:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:02:56] [DOC: 9232213] ✅ Text extracted using pdfplumber (1056 chars)
[14:02:56] ✅    ✅ Text extracted using pdfplumber (1056 chars)
[14:02:56] 🔄 
🔄 Step 2: Extracting patient data...
[14:02:59] ℹ️  AI extracted raw sex value: 'F'
[14:02:59] ℹ️  AI extracted service line: 'Medical Social Work'
[14:02:59] ℹ️  AI extracted payer source: ''
[14:02:59] ℹ️  AI extracted diagnoses:
[14:02:59] ℹ️    - Diagnosis 1: 'None'
[14:02:59] ℹ️    - Diagnosis 2: 'None'
[14:02:59] ℹ️    - Diagnosis 3: 'None'
[14:02:59] ℹ️    - Diagnosis 4: 'None'
[14:02:59] ℹ️    - Diagnosis 5: 'None'
[14:02:59] ℹ️    - Diagnosis 6: 'None'
[14:02:59] ℹ️  Final extracted MRN: '3103225'
[14:02:59] ℹ️  Final extracted Sex: 'FEMALE'
[14:02:59] ℹ️  Final extracted Service Line: 'Medical Social Work'
[14:02:59] ℹ️  Final extracted Payer Source: ''
[14:02:59] ✅ Patient data extraction completed successfully
[14:02:59] ✅    ✅ Patient data extracted successfully
[14:02:59] 📊 Patient Response
     └─ patientFName: Ronalie
     └─ patientLName: Wood
     └─ dob: 02/11/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3103225
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/14/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:02:59] ✅    ✅ Patient identified: Ronalie Wood
[14:02:59] ✅    ✅ Patient name validation passed
[14:02:59] 🔄 
🔄 Step 3: Processing patient dates...
[14:02:59] [DOC: 9232213] ℹ️  DOB normalized: 02/11/1950
[14:02:59] [DOC: 9232213] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[14:02:59] [DOC: 9232213] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[14:02:59] [DOC: 9232213] ✅ Patient date processing completed successfully
[14:02:59] ✅    ✅ Date processing completed
[14:02:59] 📊 Processed Patient Data
     └─ patientFName: Ronalie
     └─ patientLName: Wood
     └─ dob: 02/11/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3103225
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '05/31/2025'}]
[14:02:59] 🔄 
🔄 Step 4: Extracting order data...
[14:03:01] ℹ️  Order extraction - MRN: '3103225'
[14:03:01] ℹ️  Order extraction - Sex: 'FEMALE'
[14:03:01] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[14:03:01] ℹ️  Order extraction - Payer Source: ''
[14:03:01] ✅ Order data extraction completed successfully
[14:03:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:03:01] ℹ️  Using MRN from patient data: '3103225' over '3103225'
[14:03:01] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[14:03:01] ✅ Patient name cross-validation successful
[14:03:01] ✅    ✅ Data merged successfully
[14:03:03] ✅    ✅ Order data extracted and validated
[14:03:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:03:09] [DOC: 9232213] ℹ️  Patient not found in cache or API: Ronalie Wood
[14:03:09] [DOC: 9232213] ℹ️  Patient not found, creating new patient via API...
[14:03:09] [DOC: 9232213] ℹ️  Creating patient via API: Ronalie Wood
[14:03:10] [DOC: 9232213] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:03:10] ❌    ❌ Failed to create patient
[14:03:10] [DOC: 9232213] ℹ️  API push details saved for document 9232213
================================================================================
║                        Processing Document ID: 9232189                         ║
================================================================================
[14:03:10] ℹ️  Agency: Dartmouth HH
[14:03:10] ℹ️  Date: 04/10/2025
[14:03:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:03:18] [DOC: 9232189] ✅ Text extracted using pdfplumber (16431 chars)
[14:03:18] ✅    ✅ Text extracted using pdfplumber (16419 chars)
[14:03:18] 🔄 
🔄 Step 2: Extracting patient data...
[14:03:21] ℹ️  AI extracted raw sex value: 'F'
[14:03:21] ℹ️  AI extracted service line: 'Skilled Nursing,Occupational Therapy'
[14:03:21] ℹ️  AI extracted payer source: ''
[14:03:21] ℹ️  AI extracted diagnoses:
[14:03:21] ℹ️    - Diagnosis 1: 'Z47.1'
[14:03:21] ℹ️    - Diagnosis 2: 'Z96.611'
[14:03:21] ℹ️    - Diagnosis 3: 'K21.9'
[14:03:21] ℹ️    - Diagnosis 4: 'D50.9'
[14:03:21] ℹ️    - Diagnosis 5: 'K59.01'
[14:03:21] ℹ️    - Diagnosis 6: 'J45.20'
[14:03:21] ℹ️  Final extracted MRN: '6063015'
[14:03:21] ℹ️  Final extracted Sex: 'FEMALE'
[14:03:21] ℹ️  Final extracted Service Line: 'Skilled Nursing,Occupational Therapy'
[14:03:21] ℹ️  Final extracted Payer Source: ''
[14:03:21] ✅ Patient data extraction completed successfully
[14:03:21] ✅    ✅ Patient data extracted successfully
[14:03:21] 📊 Patient Response
     └─ patientFName: Ann M
     └─ patientLName: Bourque
     └─ dob: 11/28/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6063015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.611', 'thirdDiagnosis': 'K21.9', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'K59.01', 'sixthDiagnosis': 'J45.20'}]
[14:03:21] ✅    ✅ Patient identified: Ann M Bourque
[14:03:21] ✅    ✅ Patient name validation passed
[14:03:21] 🔄 
🔄 Step 3: Processing patient dates...
[14:03:21] [DOC: 9232189] ℹ️  DOB normalized: 11/28/1962
[14:03:21] [DOC: 9232189] ℹ️  Episode startOfCare normalized: 03/29/2025
[14:03:21] [DOC: 9232189] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[14:03:21] [DOC: 9232189] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[14:03:21] [DOC: 9232189] ✅ Patient date processing completed successfully
[14:03:21] ✅    ✅ Date processing completed
[14:03:21] 📊 Processed Patient Data
     └─ patientFName: Ann M
     └─ patientLName: Bourque
     └─ dob: 11/28/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6063015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.611', 'thirdDiagnosis': 'K21.9', 'fourthDiagnosis': 'D50.9', 'fifthDiagnosis': 'K59.01', 'sixthDiagnosis': 'J45.20'}]
[14:03:21] 🔄 
🔄 Step 4: Extracting order data...
[14:03:23] ℹ️  Order extraction - MRN: '6063015'
[14:03:23] ℹ️  Order extraction - Sex: 'FEMALE'
[14:03:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Occupational Therapy'
[14:03:23] ℹ️  Order extraction - Payer Source: ''
[14:03:23] ✅ Order data extraction completed successfully
[14:03:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:03:23] ℹ️  Using MRN from patient data: '6063015' over '6063015'
[14:03:23] ℹ️  Service line consistent in both sources: 'Skilled Nursing,Occupational Therapy'
[14:03:23] ✅ Patient name cross-validation successful
[14:03:23] ✅    ✅ Data merged successfully
[14:03:25] ✅    ✅ Order data extracted and validated
[14:03:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:03:44] [DOC: 9232189] ℹ️  Patient not found in cache or API: Ann M Bourque
[14:03:44] [DOC: 9232189] ℹ️  Patient not found, creating new patient via API...
[14:03:44] [DOC: 9232189] ℹ️  Creating patient via API: Ann M Bourque
[14:03:45] [DOC: 9232189] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:03:45] ❌    ❌ Failed to create patient
[14:03:45] [DOC: 9232189] ℹ️  API push details saved for document 9232189
================================================================================
║                        Processing Document ID: 9232180                         ║
================================================================================
[14:03:45] ℹ️  Agency: Nizhoni Health-Fall River
[14:03:45] ℹ️  Date: 04/10/2025
[14:03:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:03:52] [DOC: 9232180] ✅ Text extracted using pdfplumber (14529 chars)
[14:03:52] ✅    ✅ Text extracted using pdfplumber (14529 chars)
[14:03:52] 🔄 
🔄 Step 2: Extracting patient data...
[14:03:55] ℹ️  AI extracted raw sex value: 'F'
[14:03:55] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:03:55] ℹ️  AI extracted payer source: 'None'
[14:03:55] ℹ️  AI extracted diagnoses:
[14:03:55] ℹ️    - Diagnosis 1: 'F25.0'
[14:03:55] ℹ️    - Diagnosis 2: 'E11.9'
[14:03:55] ℹ️    - Diagnosis 3: 'J44.9'
[14:03:55] ℹ️    - Diagnosis 4: 'F19.10'
[14:03:55] ℹ️    - Diagnosis 5: 'D51.9'
[14:03:55] ℹ️    - Diagnosis 6: 'G93.1'
[14:03:55] ℹ️  Final extracted MRN: '3632020'
[14:03:55] ℹ️  Final extracted Sex: 'FEMALE'
[14:03:55] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:03:55] ℹ️  Final extracted Payer Source: ''
[14:03:55] ✅ Patient data extraction completed successfully
[14:03:55] ✅    ✅ Patient data extracted successfully
[14:03:55] 📊 Patient Response
     └─ patientFName: Andrea
     └─ patientLName: Rousseau
     └─ dob: 09/03/1971
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3632020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100008791079
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive VNA services
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/07/2024', 'startOfEpisode': '02/17/2024', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'F19.10', 'fifthDiagnosis': 'D51.9', 'sixthDiagnosis': 'G93.1'}]
[14:03:55] ✅    ✅ Patient identified: Andrea Rousseau
[14:03:55] ✅    ✅ Patient name validation passed
[14:03:55] 🔄 
🔄 Step 3: Processing patient dates...
[14:03:55] [DOC: 9232180] ℹ️  DOB normalized: 09/03/1971
[14:03:55] [DOC: 9232180] ℹ️  Episode startOfCare normalized: 02/07/2024
[14:03:55] [DOC: 9232180] ℹ️  Episode startOfEpisode normalized: 02/17/2024
[14:03:55] [DOC: 9232180] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[14:03:55] [DOC: 9232180] ✅ Patient date processing completed successfully
[14:03:55] ✅    ✅ Date processing completed
[14:03:55] 📊 Processed Patient Data
     └─ patientFName: Andrea
     └─ patientLName: Rousseau
     └─ dob: 09/03/1971
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3632020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100008791079
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive VNA services
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/07/2024', 'startOfEpisode': '02/17/2024', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'F19.10', 'fifthDiagnosis': 'D51.9', 'sixthDiagnosis': 'G93.1'}]
[14:03:55] 🔄 
🔄 Step 4: Extracting order data...
[14:03:58] ℹ️  Order extraction - MRN: '3632020'
[14:03:58] ℹ️  Order extraction - Sex: 'FEMALE'
[14:03:58] ℹ️  Order extraction - Service Line: 'RN, Skilled Nursing'
[14:03:58] ℹ️  Order extraction - Payer Source: ''
[14:03:58] ✅ Order data extraction completed successfully
[14:03:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:03:58] ℹ️  Using MRN from patient data: '3632020' over '3632020'
[14:03:58] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN, Skilled Nursing' = 'RN, Skilled Nursing'
[14:03:58] ✅ Patient name cross-validation successful
[14:03:58] ✅    ✅ Data merged successfully
[14:03:59] ✅    ✅ Order data extracted and validated
[14:03:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:04:28] [DOC: 9232180] ✅ Patient exists in API: Andrea Rousseau, ID: dc2d02be-917d-4152-8010-08c95fce8277
[14:04:28] ✅    ✅ Existing patient found with ID: dc2d02be-917d-4152-8010-08c95fce8277
[14:04:28] 🔄 
🔄 Step 6: Pushing order to API...
[14:04:28] [DOC: 9232180] ℹ️  Pushing order via API for patient ID: dc2d02be-917d-4152-8010-08c95fce8277
[14:04:30] [DOC: 9232180] ❌ Order push failed with status 201: {"id":"07385970-f95a-45be-8ac0-204f75039386","orderWAVId":"ORD20043","orderNo":"3632020","orderDate":"04/09/2025","startOfCare":"02/17/2024","episodeStartDate":"04/12/2025","episodeEndDate":"06/10/2025","documentID":"9232180","mrn":"3632020","patientName":"Rousseau, Andrea","sentToPhysicianDate":"04/10/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/27/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"dc2d02be-917d-4152-8010-08c95fce8277","companyId":"d598757a-87c6-4192-bcde-ff8d6e0b91ad","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[14:04:30] ❌    ❌ Failed to push order
[14:04:30] 🔄 
🔄 Step 7: Writing to CSV...
[14:04:30] [DOC: 9232180] ℹ️  Calculated age: 53 from DOB: 09/03/1971
[14:04:30] [DOC: 9232180] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[14:04:30] [DOC: 9232180] ℹ️  Payer Source extracted: ''
[14:04:30] [DOC: 9232180] ℹ️  Diagnosis codes being written:
[14:04:30] [DOC: 9232180] ℹ️    - Latest_Episode_Firstdiagnosis: 'F25.0'
[14:04:30] [DOC: 9232180] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[14:04:30] [DOC: 9232180] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.9'
[14:04:30] [DOC: 9232180] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F19.10'
[14:04:30] [DOC: 9232180] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D51.9'
[14:04:30] [DOC: 9232180] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G93.1'
[14:04:30] [DOC: 9232180] ✅ Patient data written to CSV: Andrea Rousseau | Sex: FEMALE | Age: 53 | Service: RN, Skilled Nursing | Payer:  | MRN: 3632020
[14:04:30] ✅    ✅ Document 9232180 processed and saved successfully
[14:04:30] 🔄 
🔄 Step 8: Saving API details...
[14:04:30] [DOC: 9232180] ℹ️  API push details saved for document 9232180
[14:04:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232175                         ║
================================================================================
[14:04:30] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:04:30] ℹ️  Date: 04/10/2025
[14:04:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:04:32] [DOC: 9232175] ✅ Text extracted using pdfplumber (3665 chars)
[14:04:32] ✅    ✅ Text extracted using pdfplumber (3665 chars)
[14:04:32] 🔄 
🔄 Step 2: Extracting patient data...
[14:04:35] ℹ️  AI extracted raw sex value: 'F'
[14:04:35] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy, Physical Therapy'
[14:04:35] ℹ️  AI extracted payer source: ''
[14:04:35] ℹ️  AI extracted diagnoses:
[14:04:35] ℹ️    - Diagnosis 1: ''
[14:04:35] ℹ️    - Diagnosis 2: ''
[14:04:35] ℹ️    - Diagnosis 3: ''
[14:04:35] ℹ️    - Diagnosis 4: ''
[14:04:35] ℹ️    - Diagnosis 5: ''
[14:04:35] ℹ️    - Diagnosis 6: ''
[14:04:35] ℹ️  Final extracted MRN: '3052261'
[14:04:35] ℹ️  Final extracted Sex: 'FEMALE'
[14:04:35] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy, Physical Therapy'
[14:04:35] ℹ️  Final extracted Payer Source: ''
[14:04:35] ✅ Patient data extraction completed successfully
[14:04:35] ✅    ✅ Patient data extracted successfully
[14:04:35] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Trott
     └─ dob: 04/22/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3052261
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Occupational Therapy, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:04:35] ✅    ✅ Patient identified: Donna Trott
[14:04:35] ✅    ✅ Patient name validation passed
[14:04:35] 🔄 
🔄 Step 3: Processing patient dates...
[14:04:35] [DOC: 9232175] ℹ️  DOB normalized: 04/22/1943
[14:04:35] [DOC: 9232175] ✅ Patient date processing completed successfully
[14:04:35] ✅    ✅ Date processing completed
[14:04:35] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Trott
     └─ dob: 04/22/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3052261
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Occupational Therapy, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:04:35] 🔄 
🔄 Step 4: Extracting order data...
[14:04:37] ℹ️  Order extraction - MRN: '3052261'
[14:04:37] ℹ️  Order extraction - Sex: 'FEMALE'
[14:04:37] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Occupational Therapy, Physical Therapy'
[14:04:37] ℹ️  Order extraction - Payer Source: ''
[14:04:37] ✅ Order data extraction completed successfully
[14:04:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:04:37] ℹ️  Using MRN from patient data: '3052261' over '3052261'
[14:04:37] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Occupational Therapy, Physical Therapy'
[14:04:37] ✅ Patient name cross-validation successful
[14:04:37] ✅    ✅ Data merged successfully
[14:04:38] ✅    ✅ Order data extracted and validated
[14:04:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:04:38] [DOC: 9232175] ✅ Patient found in local cache: Donna Trott, ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[14:04:38] ✅    ✅ Existing patient found with ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[14:04:38] 🔄 
🔄 Step 6: Pushing order to API...
[14:04:38] [DOC: 9232175] ℹ️  Pushing order via API for patient ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[14:04:40] [DOC: 9232175] ❌ Order push failed with status 201: {"id":"69627074-cb34-4db9-b2d9-855aafb64f26","orderWAVId":"ORD20044","orderNo":"1079757, 1079844, 1079845, 1079846","orderDate":"04/08/2025","startOfCare":"04/08/2025","episodeStartDate":"04/08/2025","episodeEndDate":"05/18/2025","documentID":"9232175","mrn":"3052261","patientName":"Trott,Donna L","sentToPhysicianDate":"04/10/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/11/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"35c8b502-60ae-4cbb-b57d-d65de599a3da","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[14:04:40] ❌    ❌ Failed to push order
[14:04:40] 🔄 
🔄 Step 7: Writing to CSV...
[14:04:40] [DOC: 9232175] ℹ️  Calculated age: 82 from DOB: 04/22/1943
[14:04:40] [DOC: 9232175] ℹ️  Service Line extracted: 'Skilled Nursing, Occupational Therapy, Physical Therapy'
[14:04:40] [DOC: 9232175] ℹ️  Payer Source extracted: ''
[14:04:40] [DOC: 9232175] ℹ️  Diagnosis codes being written:
[14:04:40] [DOC: 9232175] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:04:40] [DOC: 9232175] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:04:40] [DOC: 9232175] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:04:40] [DOC: 9232175] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:04:40] [DOC: 9232175] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:04:40] [DOC: 9232175] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:04:40] [DOC: 9232175] ✅ Patient data written to CSV: Donna Trott | Sex: FEMALE | Age: 82 | Service: Skilled Nursing, Occupational Therapy, Physical Therapy | Payer:  | MRN: 3052261
[14:04:40] ✅    ✅ Document 9232175 processed and saved successfully
[14:04:40] 🔄 
🔄 Step 8: Saving API details...
[14:04:40] [DOC: 9232175] ℹ️  API push details saved for document 9232175
[14:04:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232169                         ║
================================================================================
[14:04:40] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:04:40] ℹ️  Date: 04/10/2025
[14:04:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:04:42] [DOC: 9232169] ✅ Text extracted using pdfplumber (1365 chars)
[14:04:42] ✅    ✅ Text extracted using pdfplumber (1365 chars)
[14:04:42] 🔄 
🔄 Step 2: Extracting patient data...
[14:04:45] ℹ️  AI extracted raw sex value: 'M'
[14:04:45] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:04:45] ℹ️  AI extracted payer source: ''
[14:04:45] ℹ️  AI extracted diagnoses:
[14:04:45] ℹ️    - Diagnosis 1: ''
[14:04:45] ℹ️    - Diagnosis 2: ''
[14:04:45] ℹ️    - Diagnosis 3: ''
[14:04:45] ℹ️    - Diagnosis 4: ''
[14:04:45] ℹ️    - Diagnosis 5: ''
[14:04:45] ℹ️    - Diagnosis 6: ''
[14:04:45] ℹ️  Final extracted MRN: '2998876'
[14:04:45] ℹ️  Final extracted Sex: 'MALE'
[14:04:45] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:04:45] ℹ️  Final extracted Payer Source: ''
[14:04:45] ✅ Patient data extraction completed successfully
[14:04:45] ✅    ✅ Patient data extracted successfully
[14:04:45] 📊 Patient Response
     └─ patientFName: Ronald
     └─ patientLName: Souza
     └─ dob: 08/01/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998876
     └─ billingProvider: Achilles R. Alcaraz, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:04:45] ✅    ✅ Patient identified: Ronald Souza
[14:04:45] ✅    ✅ Patient name validation passed
[14:04:45] 🔄 
🔄 Step 3: Processing patient dates...
[14:04:45] [DOC: 9232169] ℹ️  DOB normalized: 08/01/1948
[14:04:45] [DOC: 9232169] ✅ Patient date processing completed successfully
[14:04:45] ✅    ✅ Date processing completed
[14:04:45] 📊 Processed Patient Data
     └─ patientFName: Ronald
     └─ patientLName: Souza
     └─ dob: 08/01/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998876
     └─ billingProvider: Achilles R. Alcaraz, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:04:45] 🔄 
🔄 Step 4: Extracting order data...
[14:04:47] ℹ️  Order extraction - MRN: '2998876'
[14:04:47] ℹ️  Order extraction - Sex: 'MALE'
[14:04:47] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:04:47] ℹ️  Order extraction - Payer Source: ''
[14:04:47] ✅ Order data extraction completed successfully
[14:04:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:04:47] ℹ️  Using MRN from patient data: '2998876' over '2998876'
[14:04:47] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:04:47] ✅ Patient name cross-validation successful
[14:04:47] ✅    ✅ Data merged successfully
[14:04:48] ✅    ✅ Order data extracted and validated
[14:04:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:04:56] [DOC: 9232169] ℹ️  Patient not found in cache or API: Ronald Souza
[14:04:56] [DOC: 9232169] ℹ️  Patient not found, creating new patient via API...
[14:04:56] [DOC: 9232169] ℹ️  Creating patient via API: Ronald Souza
[14:04:57] [DOC: 9232169] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:04:57] ❌    ❌ Failed to create patient
[14:04:57] [DOC: 9232169] ℹ️  API push details saved for document 9232169
================================================================================
║                        Processing Document ID: 9232165                         ║
================================================================================
[14:04:57] ℹ️  Agency: Nizhoni Health-Fall River
[14:04:57] ℹ️  Date: 04/10/2025
[14:04:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:05:00] [DOC: 9232165] ✅ Text extracted using pdfplumber (16929 chars)
[14:05:00] ✅    ✅ Text extracted using pdfplumber (16929 chars)
[14:05:00] 🔄 
🔄 Step 2: Extracting patient data...
[14:05:04] ℹ️  AI extracted raw sex value: 'M'
[14:05:04] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:05:04] ℹ️  AI extracted payer source: 'None'
[14:05:04] ℹ️  AI extracted diagnoses:
[14:05:04] ℹ️    - Diagnosis 1: 'N31.9'
[14:05:04] ℹ️    - Diagnosis 2: 'F33.2'
[14:05:04] ℹ️    - Diagnosis 3: 'G93.1'
[14:05:04] ℹ️    - Diagnosis 4: 'G40.211'
[14:05:04] ℹ️    - Diagnosis 5: 'E03.9'
[14:05:04] ℹ️    - Diagnosis 6: 'I10'
[14:05:04] ℹ️  Final extracted MRN: '3947012'
[14:05:04] ℹ️  Final extracted Sex: 'MALE'
[14:05:04] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:05:04] ℹ️  Final extracted Payer Source: ''
[14:05:04] ✅ Patient data extraction completed successfully
[14:05:04] ✅    ✅ Patient data extracted successfully
[14:05:04] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: Bartley
     └─ dob: 10/08/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: 3947012
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100202523039
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/20/2023', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'N31.9', 'secondDiagnosis': 'F33.2', 'thirdDiagnosis': 'G93.1', 'fourthDiagnosis': 'G40.211', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'I10'}]
[14:05:04] ✅    ✅ Patient identified: Richard Bartley
[14:05:04] ✅    ✅ Patient name validation passed
[14:05:04] 🔄 
🔄 Step 3: Processing patient dates...
[14:05:04] [DOC: 9232165] ℹ️  DOB normalized: 10/08/1962
[14:05:04] [DOC: 9232165] ℹ️  Episode startOfCare normalized: 10/20/2023
[14:05:04] [DOC: 9232165] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[14:05:04] [DOC: 9232165] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[14:05:04] [DOC: 9232165] ✅ Patient date processing completed successfully
[14:05:04] ✅    ✅ Date processing completed
[14:05:04] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: Bartley
     └─ dob: 10/08/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: 3947012
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100202523039
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/20/2023', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'N31.9', 'secondDiagnosis': 'F33.2', 'thirdDiagnosis': 'G93.1', 'fourthDiagnosis': 'G40.211', 'fifthDiagnosis': 'E03.9', 'sixthDiagnosis': 'I10'}]
[14:05:04] 🔄 
🔄 Step 4: Extracting order data...
[14:05:06] ℹ️  Order extraction - MRN: '3947012'
[14:05:06] ℹ️  Order extraction - Sex: 'MALE'
[14:05:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:05:06] ℹ️  Order extraction - Payer Source: ''
[14:05:06] ✅ Order data extraction completed successfully
[14:05:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:05:06] ℹ️  Using MRN from patient data: '3947012' over '3947012'
[14:05:06] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:05:06] ✅ Patient name cross-validation successful
[14:05:06] ✅    ✅ Data merged successfully
[14:05:08] ✅    ✅ Order data extracted and validated
[14:05:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:05:08] [DOC: 9232165] ✅ Patient found in local cache: Richard Bartley, ID: 92b45a6e-a736-4268-8194-cda2951c948d
[14:05:08] ✅    ✅ Existing patient found with ID: 92b45a6e-a736-4268-8194-cda2951c948d
[14:05:08] 🔄 
🔄 Step 6: Pushing order to API...
[14:05:08] [DOC: 9232165] ℹ️  Pushing order via API for patient ID: 92b45a6e-a736-4268-8194-cda2951c948d
[14:05:10] [DOC: 9232165] ❌ Order push failed with status 201: {"id":"18d88e43-b386-485d-a45e-c8fc5ff08851","orderWAVId":"ORD20045","orderNo":"3947012","orderDate":"04/09/2025","startOfCare":"10/20/2023","episodeStartDate":"04/12/2025","episodeEndDate":"06/10/2025","documentID":"9232165","mrn":"3947012","patientName":"Bartley, Richard","sentToPhysicianDate":"04/10/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/02/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"92b45a6e-a736-4268-8194-cda2951c948d","companyId":"d598757a-87c6-4192-bcde-ff8d6e0b91ad","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[14:05:10] ❌    ❌ Failed to push order
[14:05:10] 🔄 
🔄 Step 7: Writing to CSV...
[14:05:10] [DOC: 9232165] ℹ️  Calculated age: 62 from DOB: 10/08/1962
[14:05:10] [DOC: 9232165] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:05:10] [DOC: 9232165] ℹ️  Payer Source extracted: ''
[14:05:10] [DOC: 9232165] ℹ️  Diagnosis codes being written:
[14:05:10] [DOC: 9232165] ℹ️    - Latest_Episode_Firstdiagnosis: 'N31.9'
[14:05:10] [DOC: 9232165] ℹ️    - Latest_Episode_Seconddiagnosis: 'F33.2'
[14:05:10] [DOC: 9232165] ℹ️    - Latest_Episode_Thirddiagnosis: 'G93.1'
[14:05:10] [DOC: 9232165] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G40.211'
[14:05:10] [DOC: 9232165] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E03.9'
[14:05:10] [DOC: 9232165] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I10'
[14:05:10] [DOC: 9232165] ✅ Patient data written to CSV: Richard Bartley | Sex: MALE | Age: 62 | Service: Skilled Nursing | Payer:  | MRN: 3947012
[14:05:10] ✅    ✅ Document 9232165 processed and saved successfully
[14:05:10] 🔄 
🔄 Step 8: Saving API details...
[14:05:10] [DOC: 9232165] ℹ️  API push details saved for document 9232165
[14:05:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232162                         ║
================================================================================
[14:05:10] ℹ️  Agency: Nizhoni Health-Fall River
[14:05:10] ℹ️  Date: 04/10/2025
[14:05:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:05:20] [DOC: 9232162] ✅ Text extracted using pdfplumber (12331 chars)
[14:05:20] ✅    ✅ Text extracted using pdfplumber (12331 chars)
[14:05:20] 🔄 
🔄 Step 2: Extracting patient data...
[14:05:23] ℹ️  AI extracted raw sex value: 'F'
[14:05:23] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:05:23] ℹ️  AI extracted payer source: 'None'
[14:05:23] ℹ️  AI extracted diagnoses:
[14:05:23] ℹ️    - Diagnosis 1: 'F31.9'
[14:05:23] ℹ️    - Diagnosis 2: 'G80.9'
[14:05:23] ℹ️    - Diagnosis 3: 'F20.9'
[14:05:23] ℹ️    - Diagnosis 4: 'I10'
[14:05:23] ℹ️    - Diagnosis 5: 'F41.1'
[14:05:23] ℹ️    - Diagnosis 6: 'E53.8'
[14:05:23] ℹ️  Final extracted MRN: '17207020'
[14:05:23] ℹ️  Final extracted Sex: 'FEMALE'
[14:05:23] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:05:23] ℹ️  Final extracted Payer Source: ''
[14:05:23] ✅ Patient data extraction completed successfully
[14:05:23] ✅    ✅ Patient data extracted successfully
[14:05:23] 📊 Patient Response
     └─ patientFName: Tammy
     └─ patientLName: Alves
     └─ dob: 04/30/1981
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 17207020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100000511244
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'G80.9', 'thirdDiagnosis': 'F20.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'F41.1', 'sixthDiagnosis': 'E53.8'}]
[14:05:23] ✅    ✅ Patient identified: Tammy Alves
[14:05:23] ✅    ✅ Patient name validation passed
[14:05:23] 🔄 
🔄 Step 3: Processing patient dates...
[14:05:23] [DOC: 9232162] ℹ️  DOB normalized: 04/30/1981
[14:05:23] [DOC: 9232162] ℹ️  Episode startOfCare normalized: 03/26/2025
[14:05:23] [DOC: 9232162] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[14:05:23] [DOC: 9232162] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[14:05:23] [DOC: 9232162] ✅ Patient date processing completed successfully
[14:05:23] ✅    ✅ Date processing completed
[14:05:23] 📊 Processed Patient Data
     └─ patientFName: Tammy
     └─ patientLName: Alves
     └─ dob: 04/30/1981
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 17207020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100000511244
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'G80.9', 'thirdDiagnosis': 'F20.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'F41.1', 'sixthDiagnosis': 'E53.8'}]
[14:05:23] 🔄 
🔄 Step 4: Extracting order data...
[14:05:26] ℹ️  Order extraction - MRN: '17207020'
[14:05:26] ℹ️  Order extraction - Sex: 'FEMALE'
[14:05:26] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:05:26] ℹ️  Order extraction - Payer Source: ''
[14:05:26] ✅ Order data extraction completed successfully
[14:05:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:05:26] ℹ️  Using MRN from patient data: '17207020' over '17207020'
[14:05:26] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:05:26] ✅ Patient name cross-validation successful
[14:05:26] ✅    ✅ Data merged successfully
[14:05:27] ✅    ✅ Order data extracted and validated
[14:05:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:05:27] [DOC: 9232162] ✅ Patient found in local cache: Tammy Alves, ID: b762ac43-5719-4426-a8a1-b93c8317b643
[14:05:27] ✅    ✅ Existing patient found with ID: b762ac43-5719-4426-a8a1-b93c8317b643
[14:05:27] 🔄 
🔄 Step 6: Pushing order to API...
[14:05:27] [DOC: 9232162] ℹ️  Pushing order via API for patient ID: b762ac43-5719-4426-a8a1-b93c8317b643
[14:05:33] [DOC: 9232162] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:05:33] ❌    ❌ Failed to push order
[14:05:33] 🔄 
🔄 Step 7: Writing to CSV...
[14:05:33] [DOC: 9232162] ℹ️  Calculated age: 44 from DOB: 04/30/1981
[14:05:33] [DOC: 9232162] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:05:33] [DOC: 9232162] ℹ️  Payer Source extracted: ''
[14:05:33] [DOC: 9232162] ℹ️  Diagnosis codes being written:
[14:05:33] [DOC: 9232162] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.9'
[14:05:33] [DOC: 9232162] ℹ️    - Latest_Episode_Seconddiagnosis: 'G80.9'
[14:05:33] [DOC: 9232162] ℹ️    - Latest_Episode_Thirddiagnosis: 'F20.9'
[14:05:33] [DOC: 9232162] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[14:05:33] [DOC: 9232162] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.1'
[14:05:33] [DOC: 9232162] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E53.8'
[14:05:33] [DOC: 9232162] ✅ Patient data written to CSV: Tammy Alves | Sex: FEMALE | Age: 44 | Service: Skilled Nursing | Payer:  | MRN: 17207020
[14:05:33] ✅    ✅ Document 9232162 processed and saved successfully
[14:05:33] 🔄 
🔄 Step 8: Saving API details...
[14:05:33] [DOC: 9232162] ℹ️  API push details saved for document 9232162
[14:05:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232160                         ║
================================================================================
[14:05:33] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:05:33] ℹ️  Date: 04/10/2025
[14:05:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:05:35] [DOC: 9232160] ✅ Text extracted using pdfplumber (1087 chars)
[14:05:35] ✅    ✅ Text extracted using pdfplumber (1087 chars)
[14:05:35] 🔄 
🔄 Step 2: Extracting patient data...
[14:05:38] ℹ️  AI extracted raw sex value: 'F'
[14:05:38] ℹ️  AI extracted service line: 'Occupational Therapy'
[14:05:38] ℹ️  AI extracted payer source: ''
[14:05:38] ℹ️  AI extracted diagnoses:
[14:05:38] ℹ️    - Diagnosis 1: 'CVA'
[14:05:38] ℹ️    - Diagnosis 2: ''
[14:05:38] ℹ️    - Diagnosis 3: ''
[14:05:38] ℹ️    - Diagnosis 4: ''
[14:05:38] ℹ️    - Diagnosis 5: ''
[14:05:38] ℹ️    - Diagnosis 6: ''
[14:05:38] ℹ️  Final extracted MRN: '2794259'
[14:05:38] ℹ️  Final extracted Sex: 'FEMALE'
[14:05:38] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[14:05:38] ℹ️  Final extracted Payer Source: ''
[14:05:38] ✅ Patient data extraction completed successfully
[14:05:38] ✅    ✅ Patient data extracted successfully
[14:05:38] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Normandin
     └─ dob: 09/26/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2794259
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'CVA', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:05:38] ✅    ✅ Patient identified: Joyce Normandin
[14:05:38] ✅    ✅ Patient name validation passed
[14:05:38] 🔄 
🔄 Step 3: Processing patient dates...
[14:05:38] [DOC: 9232160] ℹ️  DOB normalized: 09/26/1950
[14:05:38] [DOC: 9232160] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[14:05:38] [DOC: 9232160] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[14:05:38] [DOC: 9232160] ✅ Patient date processing completed successfully
[14:05:38] ✅    ✅ Date processing completed
[14:05:38] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Normandin
     └─ dob: 09/26/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2794259
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'CVA', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:05:38] 🔄 
🔄 Step 4: Extracting order data...
[14:05:40] ℹ️  Order extraction - MRN: '2794259'
[14:05:40] ℹ️  Order extraction - Sex: 'FEMALE'
[14:05:40] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[14:05:40] ℹ️  Order extraction - Payer Source: ''
[14:05:40] ✅ Order data extraction completed successfully
[14:05:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:05:40] ℹ️  Using MRN from patient data: '2794259' over '2794259'
[14:05:40] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[14:05:40] ✅ Patient name cross-validation successful
[14:05:40] ✅    ✅ Data merged successfully
[14:05:41] ✅    ✅ Order data extracted and validated
[14:05:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:05:47] [DOC: 9232160] ✅ Patient exists in API: Joyce Normandin, ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[14:05:47] ✅    ✅ Existing patient found with ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[14:05:47] 🔄 
🔄 Step 6: Pushing order to API...
[14:05:47] [DOC: 9232160] ℹ️  Pushing order via API for patient ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[14:05:48] [DOC: 9232160] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12922"}
[14:05:48] ❌    ❌ Failed to push order
[14:05:48] 🔄 
🔄 Step 7: Writing to CSV...
[14:05:48] [DOC: 9232160] ℹ️  Calculated age: 74 from DOB: 09/26/1950
[14:05:48] [DOC: 9232160] ℹ️  Service Line extracted: 'Occupational Therapy'
[14:05:48] [DOC: 9232160] ℹ️  Payer Source extracted: ''
[14:05:48] [DOC: 9232160] ℹ️  Diagnosis codes being written:
[14:05:48] [DOC: 9232160] ℹ️    - Latest_Episode_Firstdiagnosis: 'CVA'
[14:05:48] [DOC: 9232160] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:05:48] [DOC: 9232160] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:05:48] [DOC: 9232160] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:05:48] [DOC: 9232160] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:05:48] [DOC: 9232160] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:05:48] [DOC: 9232160] ✅ Patient data written to CSV: Joyce Normandin | Sex: FEMALE | Age: 74 | Service: Occupational Therapy | Payer:  | MRN: 2794259
[14:05:48] ✅    ✅ Document 9232160 processed and saved successfully
[14:05:48] 🔄 
🔄 Step 8: Saving API details...
[14:05:48] [DOC: 9232160] ℹ️  API push details saved for document 9232160
[14:05:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232156                         ║
================================================================================
[14:05:48] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:05:48] ℹ️  Date: 04/10/2025
[14:05:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:05:52] [DOC: 9232156] ✅ Text extracted using pdfplumber (1087 chars)
[14:05:52] ✅    ✅ Text extracted using pdfplumber (1087 chars)
[14:05:52] 🔄 
🔄 Step 2: Extracting patient data...
[14:05:55] ℹ️  AI extracted raw sex value: 'F'
[14:05:55] ℹ️  AI extracted service line: 'Occupational Therapy'
[14:05:55] ℹ️  AI extracted payer source: ''
[14:05:55] ℹ️  AI extracted diagnoses:
[14:05:55] ℹ️    - Diagnosis 1: 'CVA'
[14:05:55] ℹ️    - Diagnosis 2: ''
[14:05:55] ℹ️    - Diagnosis 3: ''
[14:05:55] ℹ️    - Diagnosis 4: ''
[14:05:55] ℹ️    - Diagnosis 5: ''
[14:05:55] ℹ️    - Diagnosis 6: ''
[14:05:55] ℹ️  Final extracted MRN: '2794259'
[14:05:55] ℹ️  Final extracted Sex: 'FEMALE'
[14:05:55] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[14:05:55] ℹ️  Final extracted Payer Source: ''
[14:05:55] ✅ Patient data extraction completed successfully
[14:05:55] ✅    ✅ Patient data extracted successfully
[14:05:55] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Normandin
     └─ dob: 09/26/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2794259
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'CVA', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:05:55] ✅    ✅ Patient identified: Joyce Normandin
[14:05:55] ✅    ✅ Patient name validation passed
[14:05:55] 🔄 
🔄 Step 3: Processing patient dates...
[14:05:55] [DOC: 9232156] ℹ️  DOB normalized: 09/26/1950
[14:05:55] [DOC: 9232156] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[14:05:55] [DOC: 9232156] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[14:05:55] [DOC: 9232156] ✅ Patient date processing completed successfully
[14:05:55] ✅    ✅ Date processing completed
[14:05:55] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Normandin
     └─ dob: 09/26/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2794259
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'CVA', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:05:55] 🔄 
🔄 Step 4: Extracting order data...
[14:05:57] ℹ️  Order extraction - MRN: '2794259'
[14:05:57] ℹ️  Order extraction - Sex: 'FEMALE'
[14:05:57] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[14:05:57] ℹ️  Order extraction - Payer Source: ''
[14:05:57] ✅ Order data extraction completed successfully
[14:05:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:05:57] ℹ️  Using MRN from patient data: '2794259' over '2794259'
[14:05:57] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[14:05:57] ✅ Patient name cross-validation successful
[14:05:57] ✅    ✅ Data merged successfully
[14:05:58] ✅    ✅ Order data extracted and validated
[14:05:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:05:58] [DOC: 9232156] ✅ Patient found in local cache: Joyce Normandin, ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[14:05:58] ✅    ✅ Existing patient found with ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[14:05:58] 🔄 
🔄 Step 6: Pushing order to API...
[14:05:58] [DOC: 9232156] ℹ️  Pushing order via API for patient ID: 9720bbd6-f59e-4773-80f0-6ac1827545d7
[14:06:00] [DOC: 9232156] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12922"}
[14:06:00] ❌    ❌ Failed to push order
[14:06:00] 🔄 
🔄 Step 7: Writing to CSV...
[14:06:00] [DOC: 9232156] ℹ️  Calculated age: 74 from DOB: 09/26/1950
[14:06:00] [DOC: 9232156] ℹ️  Service Line extracted: 'Occupational Therapy'
[14:06:00] [DOC: 9232156] ℹ️  Payer Source extracted: ''
[14:06:00] [DOC: 9232156] ℹ️  Diagnosis codes being written:
[14:06:00] [DOC: 9232156] ℹ️    - Latest_Episode_Firstdiagnosis: 'CVA'
[14:06:00] [DOC: 9232156] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:06:00] [DOC: 9232156] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:06:00] [DOC: 9232156] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:06:00] [DOC: 9232156] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:06:00] [DOC: 9232156] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:06:00] [DOC: 9232156] ✅ Patient data written to CSV: Joyce Normandin | Sex: FEMALE | Age: 74 | Service: Occupational Therapy | Payer:  | MRN: 2794259
[14:06:00] ✅    ✅ Document 9232156 processed and saved successfully
[14:06:00] 🔄 
🔄 Step 8: Saving API details...
[14:06:00] [DOC: 9232156] ℹ️  API push details saved for document 9232156
[14:06:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232154                         ║
================================================================================
[14:06:00] ℹ️  Agency: Dartmouth HH
[14:06:00] ℹ️  Date: 04/10/2025
[14:06:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:06:05] [DOC: 9232154] ✅ Text extracted using pdfplumber (15304 chars)
[14:06:05] ✅    ✅ Text extracted using pdfplumber (15292 chars)
[14:06:05] 🔄 
🔄 Step 2: Extracting patient data...
[14:06:08] ℹ️  AI extracted raw sex value: 'F'
[14:06:08] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:06:08] ℹ️  AI extracted payer source: 'None'
[14:06:08] ℹ️  AI extracted diagnoses:
[14:06:08] ℹ️    - Diagnosis 1: 'Z47.1'
[14:06:08] ℹ️    - Diagnosis 2: 'Z96.652'
[14:06:08] ℹ️    - Diagnosis 3: 'M54.40'
[14:06:08] ℹ️    - Diagnosis 4: 'M19.071'
[14:06:08] ℹ️    - Diagnosis 5: 'N18.4'
[14:06:08] ℹ️    - Diagnosis 6: 'I73.00'
[14:06:08] ℹ️  Final extracted MRN: '6034015'
[14:06:08] ℹ️  Final extracted Sex: 'FEMALE'
[14:06:08] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:06:08] ℹ️  Final extracted Payer Source: ''
[14:06:08] ✅ Patient data extraction completed successfully
[14:06:08] ✅    ✅ Patient data extracted successfully
[14:06:08] 📊 Patient Response
     └─ patientFName: Margaret
     └─ patientLName: Peart
     └─ dob: 06/23/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6034015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.652', 'thirdDiagnosis': 'M54.40', 'fourthDiagnosis': 'M19.071', 'fifthDiagnosis': 'N18.4', 'sixthDiagnosis': 'I73.00'}]
[14:06:08] ✅    ✅ Patient identified: Margaret Peart
[14:06:08] ✅    ✅ Patient name validation passed
[14:06:08] 🔄 
🔄 Step 3: Processing patient dates...
[14:06:08] [DOC: 9232154] ℹ️  DOB normalized: 06/23/1945
[14:06:08] [DOC: 9232154] ℹ️  Episode startOfCare normalized: 03/27/2025
[14:06:08] [DOC: 9232154] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[14:06:08] [DOC: 9232154] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[14:06:08] [DOC: 9232154] ✅ Patient date processing completed successfully
[14:06:08] ✅    ✅ Date processing completed
[14:06:08] 📊 Processed Patient Data
     └─ patientFName: Margaret
     └─ patientLName: Peart
     └─ dob: 06/23/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6034015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.652', 'thirdDiagnosis': 'M54.40', 'fourthDiagnosis': 'M19.071', 'fifthDiagnosis': 'N18.4', 'sixthDiagnosis': 'I73.00'}]
[14:06:08] 🔄 
🔄 Step 4: Extracting order data...
[14:06:11] ℹ️  Order extraction - MRN: '6034015'
[14:06:11] ℹ️  Order extraction - Sex: 'FEMALE'
[14:06:11] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:06:11] ℹ️  Order extraction - Payer Source: ''
[14:06:11] ✅ Order data extraction completed successfully
[14:06:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:06:11] ℹ️  Using MRN from patient data: '6034015' over '6034015'
[14:06:11] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:06:11] ✅ Patient name cross-validation successful
[14:06:11] ✅    ✅ Data merged successfully
[14:06:12] ✅    ✅ Order data extracted and validated
[14:06:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:06:12] [DOC: 9232154] ✅ Patient found in local cache: Margaret Peart, ID: 0db0333d-8306-4556-a304-4845228fdb62
[14:06:12] ✅    ✅ Existing patient found with ID: 0db0333d-8306-4556-a304-4845228fdb62
[14:06:12] 🔄 
🔄 Step 6: Pushing order to API...
[14:06:12] [DOC: 9232154] ℹ️  Pushing order via API for patient ID: 0db0333d-8306-4556-a304-4845228fdb62
[14:06:13] [DOC: 9232154] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:06:13] ❌    ❌ Failed to push order
[14:06:13] 🔄 
🔄 Step 7: Writing to CSV...
[14:06:13] [DOC: 9232154] ℹ️  Calculated age: 79 from DOB: 06/23/1945
[14:06:13] [DOC: 9232154] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:06:13] [DOC: 9232154] ℹ️  Payer Source extracted: ''
[14:06:13] [DOC: 9232154] ℹ️  Diagnosis codes being written:
[14:06:13] [DOC: 9232154] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[14:06:13] [DOC: 9232154] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z96.652'
[14:06:13] [DOC: 9232154] ℹ️    - Latest_Episode_Thirddiagnosis: 'M54.40'
[14:06:13] [DOC: 9232154] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M19.071'
[14:06:13] [DOC: 9232154] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.4'
[14:06:13] [DOC: 9232154] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I73.00'
[14:06:13] [DOC: 9232154] ✅ Patient data written to CSV: Margaret Peart | Sex: FEMALE | Age: 79 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: 6034015
[14:06:13] ✅    ✅ Document 9232154 processed and saved successfully
[14:06:13] 🔄 
🔄 Step 8: Saving API details...
[14:06:13] [DOC: 9232154] ℹ️  API push details saved for document 9232154
[14:06:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232152                         ║
================================================================================
[14:06:13] ℹ️  Agency: Dartmouth HH
[14:06:13] ℹ️  Date: 04/10/2025
[14:06:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:06:20] [DOC: 9232152] ✅ Text extracted using pdfplumber (19534 chars)
[14:06:20] ✅    ✅ Text extracted using pdfplumber (19522 chars)
[14:06:20] 🔄 
🔄 Step 2: Extracting patient data...
[14:06:23] ℹ️  AI extracted raw sex value: 'M'
[14:06:23] ℹ️  AI extracted service line: 'Skilled Nursing, HHA'
[14:06:23] ℹ️  AI extracted payer source: ''
[14:06:23] ℹ️  AI extracted diagnoses:
[14:06:23] ℹ️    - Diagnosis 1: 'I13.0'
[14:06:23] ℹ️    - Diagnosis 2: 'I50.42'
[14:06:23] ℹ️    - Diagnosis 3: 'E11.22'
[14:06:23] ℹ️    - Diagnosis 4: 'N18.30'
[14:06:23] ℹ️    - Diagnosis 5: 'D63.1'
[14:06:23] ℹ️    - Diagnosis 6: 'G20.C'
[14:06:23] ℹ️  Final extracted MRN: '842002'
[14:06:23] ℹ️  Final extracted Sex: 'MALE'
[14:06:23] ℹ️  Final extracted Service Line: 'Skilled Nursing, HHA'
[14:06:23] ℹ️  Final extracted Payer Source: ''
[14:06:23] ✅ Patient data extraction completed successfully
[14:06:23] ✅    ✅ Patient data extracted successfully
[14:06:23] 📊 Patient Response
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.42', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'G20.C'}]
[14:06:23] ✅    ✅ Patient identified: Johannes Bjornson
[14:06:23] ✅    ✅ Patient name validation passed
[14:06:23] 🔄 
🔄 Step 3: Processing patient dates...
[14:06:23] [DOC: 9232152] ℹ️  DOB normalized: 02/09/1942
[14:06:23] [DOC: 9232152] ℹ️  Episode startOfCare normalized: 10/10/2024
[14:06:23] [DOC: 9232152] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[14:06:23] [DOC: 9232152] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[14:06:23] [DOC: 9232152] ✅ Patient date processing completed successfully
[14:06:23] ✅    ✅ Date processing completed
[14:06:23] 📊 Processed Patient Data
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.42', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'G20.C'}]
[14:06:23] 🔄 
🔄 Step 4: Extracting order data...
[14:06:26] ℹ️  Order extraction - MRN: '842002'
[14:06:26] ℹ️  Order extraction - Sex: 'MALE'
[14:06:26] ℹ️  Order extraction - Service Line: 'Skilled Nursing, HHA'
[14:06:26] ℹ️  Order extraction - Payer Source: ''
[14:06:26] ✅ Order data extraction completed successfully
[14:06:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:06:26] ℹ️  Using MRN from patient data: '842002' over '842002'
[14:06:26] ℹ️  Service line consistent in both sources: 'Skilled Nursing, HHA'
[14:06:26] ✅ Patient name cross-validation successful
[14:06:26] ✅    ✅ Data merged successfully
[14:06:27] ✅    ✅ Order data extracted and validated
[14:06:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:06:27] [DOC: 9232152] ✅ Patient found in local cache: Johannes Bjornson, ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[14:06:27] ✅    ✅ Existing patient found with ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[14:06:27] 🔄 
🔄 Step 6: Pushing order to API...
[14:06:27] [DOC: 9232152] ℹ️  Pushing order via API for patient ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[14:06:29] [DOC: 9232152] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:06:29] ❌    ❌ Failed to push order
[14:06:29] 🔄 
🔄 Step 7: Writing to CSV...
[14:06:29] [DOC: 9232152] ℹ️  Calculated age: 83 from DOB: 02/09/1942
[14:06:29] [DOC: 9232152] ℹ️  Service Line extracted: 'Skilled Nursing, HHA'
[14:06:29] [DOC: 9232152] ℹ️  Payer Source extracted: ''
[14:06:29] [DOC: 9232152] ℹ️  Diagnosis codes being written:
[14:06:29] [DOC: 9232152] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[14:06:29] [DOC: 9232152] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.42'
[14:06:29] [DOC: 9232152] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[14:06:29] [DOC: 9232152] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.30'
[14:06:29] [DOC: 9232152] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D63.1'
[14:06:29] [DOC: 9232152] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G20.C'
[14:06:29] [DOC: 9232152] ✅ Patient data written to CSV: Johannes Bjornson | Sex: MALE | Age: 83 | Service: Skilled Nursing, HHA | Payer:  | MRN: 842002
[14:06:29] ✅    ✅ Document 9232152 processed and saved successfully
[14:06:29] 🔄 
🔄 Step 8: Saving API details...
[14:06:29] [DOC: 9232152] ℹ️  API push details saved for document 9232152
[14:06:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232150                         ║
================================================================================
[14:06:29] ℹ️  Agency: Dartmouth HH
[14:06:29] ℹ️  Date: 04/10/2025
[14:06:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:06:31] [DOC: 9232150] ✅ Text extracted using pdfplumber (9896 chars)
[14:06:31] ✅    ✅ Text extracted using pdfplumber (9884 chars)
[14:06:31] 🔄 
🔄 Step 2: Extracting patient data...
[14:06:34] ℹ️  AI extracted raw sex value: 'M'
[14:06:34] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:06:34] ℹ️  AI extracted payer source: ''
[14:06:34] ℹ️  AI extracted diagnoses:
[14:06:34] ℹ️    - Diagnosis 1: 'C79.11'
[14:06:34] ℹ️    - Diagnosis 2: 'Z48.03'
[14:06:34] ℹ️    - Diagnosis 3: 'N28.89'
[14:06:34] ℹ️    - Diagnosis 4: 'C47.9'
[14:06:34] ℹ️    - Diagnosis 5: 'C61'
[14:06:34] ℹ️    - Diagnosis 6: 'C79.51'
[14:06:34] ℹ️  Final extracted MRN: '3076015'
[14:06:34] ℹ️  Final extracted Sex: 'MALE'
[14:06:34] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:06:34] ℹ️  Final extracted Payer Source: ''
[14:06:34] ✅ Patient data extraction completed successfully
[14:06:34] ✅    ✅ Patient data extracted successfully
[14:06:34] 📊 Patient Response
     └─ patientFName: Antonio
     └─ patientLName: Castro
     └─ dob: 07/10/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 3076015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/11/2024', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'C79.11', 'secondDiagnosis': 'Z48.03', 'thirdDiagnosis': 'N28.89', 'fourthDiagnosis': 'C47.9', 'fifthDiagnosis': 'C61', 'sixthDiagnosis': 'C79.51'}]
[14:06:34] ✅    ✅ Patient identified: Antonio Castro
[14:06:34] ✅    ✅ Patient name validation passed
[14:06:34] 🔄 
🔄 Step 3: Processing patient dates...
[14:06:34] [DOC: 9232150] ℹ️  DOB normalized: 07/10/1954
[14:06:34] [DOC: 9232150] ℹ️  Episode startOfCare normalized: 10/11/2024
[14:06:34] [DOC: 9232150] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[14:06:34] [DOC: 9232150] ℹ️  Episode endOfEpisode normalized: 06/07/2025
[14:06:34] [DOC: 9232150] ✅ Patient date processing completed successfully
[14:06:34] ✅    ✅ Date processing completed
[14:06:34] 📊 Processed Patient Data
     └─ patientFName: Antonio
     └─ patientLName: Castro
     └─ dob: 07/10/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 3076015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/11/2024', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'C79.11', 'secondDiagnosis': 'Z48.03', 'thirdDiagnosis': 'N28.89', 'fourthDiagnosis': 'C47.9', 'fifthDiagnosis': 'C61', 'sixthDiagnosis': 'C79.51'}]
[14:06:34] 🔄 
🔄 Step 4: Extracting order data...
[14:06:37] ℹ️  Order extraction - MRN: '3076015'
[14:06:37] ℹ️  Order extraction - Sex: 'MALE'
[14:06:37] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:06:37] ℹ️  Order extraction - Payer Source: ''
[14:06:37] ✅ Order data extraction completed successfully
[14:06:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:06:37] ℹ️  Using MRN from patient data: '3076015' over '3076015'
[14:06:37] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[14:06:37] ✅ Patient name cross-validation successful
[14:06:37] ✅    ✅ Data merged successfully
[14:06:38] ✅    ✅ Order data extracted and validated
[14:06:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:06:50] [DOC: 9232150] ℹ️  Patient not found in cache or API: Antonio Castro
[14:06:50] [DOC: 9232150] ℹ️  Patient not found, creating new patient via API...
[14:06:50] [DOC: 9232150] ℹ️  Creating patient via API: Antonio Castro
[14:06:52] [DOC: 9232150] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:06:52] ❌    ❌ Failed to create patient
[14:06:52] [DOC: 9232150] ℹ️  API push details saved for document 9232150
================================================================================
║                        Processing Document ID: 9232149                         ║
================================================================================
[14:06:52] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:06:52] ℹ️  Date: 04/10/2025
[14:06:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:06:53] [DOC: 9232149] ✅ Text extracted using pdfplumber (2355 chars)
[14:06:53] ✅    ✅ Text extracted using pdfplumber (2355 chars)
[14:06:53] 🔄 
🔄 Step 2: Extracting patient data...
[14:06:56] ℹ️  AI extracted raw sex value: 'M'
[14:06:56] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[14:06:56] ℹ️  AI extracted payer source: ''
[14:06:56] ℹ️  AI extracted diagnoses:
[14:06:56] ℹ️    - Diagnosis 1: ''
[14:06:56] ℹ️    - Diagnosis 2: ''
[14:06:56] ℹ️    - Diagnosis 3: ''
[14:06:56] ℹ️    - Diagnosis 4: ''
[14:06:56] ℹ️    - Diagnosis 5: ''
[14:06:56] ℹ️    - Diagnosis 6: ''
[14:06:56] ℹ️  Final extracted MRN: '2145411'
[14:06:56] ℹ️  Final extracted Sex: 'MALE'
[14:06:56] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[14:06:56] ℹ️  Final extracted Payer Source: ''
[14:06:56] ✅ Patient data extraction completed successfully
[14:06:56] ✅    ✅ Patient data extracted successfully
[14:06:56] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Mannes
     └─ dob: 05/18/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 2145411
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:06:56] ✅    ✅ Patient identified: John Mannes
[14:06:56] ✅    ✅ Patient name validation passed
[14:06:56] 🔄 
🔄 Step 3: Processing patient dates...
[14:06:56] [DOC: 9232149] ℹ️  DOB normalized: 05/18/1946
[14:06:56] [DOC: 9232149] ✅ Patient date processing completed successfully
[14:06:56] ✅    ✅ Date processing completed
[14:06:56] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Mannes
     └─ dob: 05/18/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 2145411
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:06:56] 🔄 
🔄 Step 4: Extracting order data...
[14:06:58] ℹ️  Order extraction - MRN: '2145411'
[14:06:58] ℹ️  Order extraction - Sex: 'MALE'
[14:06:58] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[14:06:58] ℹ️  Order extraction - Payer Source: ''
[14:06:58] ✅ Order data extraction completed successfully
[14:06:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:06:58] ℹ️  Using MRN from patient data: '2145411' over '2145411'
[14:06:58] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[14:06:58] ✅ Patient name cross-validation successful
[14:06:58] ✅    ✅ Data merged successfully
[14:06:59] ✅    ✅ Order data extracted and validated
[14:06:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:06:59] [DOC: 9232149] ✅ Patient found in local cache: John Mannes, ID: 537a377b-351e-4155-98f6-dd0d32dedc84
[14:06:59] ✅    ✅ Existing patient found with ID: 537a377b-351e-4155-98f6-dd0d32dedc84
[14:06:59] 🔄 
🔄 Step 6: Pushing order to API...
[14:06:59] [DOC: 9232149] ℹ️  Pushing order via API for patient ID: 537a377b-351e-4155-98f6-dd0d32dedc84
[14:07:01] [DOC: 9232149] ❌ Order push failed with status 201: {"id":"378a75be-8856-4f5d-be3e-3770308566bf","orderWAVId":"ORD20046","orderNo":"1080136, 1080140, 1080141","orderDate":"04/09/2025","startOfCare":"03/12/2025","episodeStartDate":"03/12/2025","episodeEndDate":"05/10/2025","documentID":"9232149","mrn":"2145411","patientName":"Mannes,John O","sentToPhysicianDate":"04/10/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/14/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"537a377b-351e-4155-98f6-dd0d32dedc84","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[14:07:01] ❌    ❌ Failed to push order
[14:07:01] 🔄 
🔄 Step 7: Writing to CSV...
[14:07:01] [DOC: 9232149] ℹ️  Calculated age: 79 from DOB: 05/18/1946
[14:07:01] [DOC: 9232149] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[14:07:01] [DOC: 9232149] ℹ️  Payer Source extracted: ''
[14:07:01] [DOC: 9232149] ℹ️  Diagnosis codes being written:
[14:07:01] [DOC: 9232149] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:07:01] [DOC: 9232149] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:07:01] [DOC: 9232149] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:07:01] [DOC: 9232149] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:07:01] [DOC: 9232149] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:07:01] [DOC: 9232149] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:07:01] [DOC: 9232149] ✅ Patient data written to CSV: John Mannes | Sex: MALE | Age: 79 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 2145411
[14:07:01] ✅    ✅ Document 9232149 processed and saved successfully
[14:07:01] 🔄 
🔄 Step 8: Saving API details...
[14:07:01] [DOC: 9232149] ℹ️  API push details saved for document 9232149
[14:07:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232147                         ║
================================================================================
[14:07:01] ℹ️  Agency: Dartmouth HH
[14:07:01] ℹ️  Date: 04/10/2025
[14:07:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:07:04] [DOC: 9232147] ✅ Text extracted using pdfplumber (17115 chars)
[14:07:04] ✅    ✅ Text extracted using pdfplumber (17103 chars)
[14:07:04] 🔄 
🔄 Step 2: Extracting patient data...
[14:07:07] ℹ️  AI extracted raw sex value: 'F'
[14:07:07] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[14:07:07] ℹ️  AI extracted payer source: ''
[14:07:07] ℹ️  AI extracted diagnoses:
[14:07:07] ℹ️    - Diagnosis 1: 'S06.6XAD'
[14:07:07] ℹ️    - Diagnosis 2: 'N13.2'
[14:07:07] ℹ️    - Diagnosis 3: 'N12'
[14:07:07] ℹ️    - Diagnosis 4: 'Z96.0'
[14:07:07] ℹ️    - Diagnosis 5: 'I13.0'
[14:07:07] ℹ️    - Diagnosis 6: 'I50.33'
[14:07:07] ℹ️  Final extracted MRN: '5862015'
[14:07:07] ℹ️  Final extracted Sex: 'FEMALE'
[14:07:07] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[14:07:07] ℹ️  Final extracted Payer Source: ''
[14:07:07] ✅ Patient data extraction completed successfully
[14:07:07] ✅    ✅ Patient data extracted successfully
[14:07:07] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '02/08/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'S06.6XAD', 'secondDiagnosis': 'N13.2', 'thirdDiagnosis': 'N12', 'fourthDiagnosis': 'Z96.0', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.33'}]
[14:07:07] ✅    ✅ Patient identified: Janice Arruda
[14:07:07] ✅    ✅ Patient name validation passed
[14:07:07] 🔄 
🔄 Step 3: Processing patient dates...
[14:07:07] [DOC: 9232147] ℹ️  DOB normalized: 01/24/1950
[14:07:07] [DOC: 9232147] ℹ️  Episode startOfCare normalized: 02/08/2025
[14:07:07] [DOC: 9232147] ℹ️  Episode startOfEpisode normalized: 02/08/2025
[14:07:07] [DOC: 9232147] ℹ️  Episode endOfEpisode normalized: 06/07/2025
[14:07:07] [DOC: 9232147] ✅ Patient date processing completed successfully
[14:07:07] ✅    ✅ Date processing completed
[14:07:07] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '02/08/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'S06.6XAD', 'secondDiagnosis': 'N13.2', 'thirdDiagnosis': 'N12', 'fourthDiagnosis': 'Z96.0', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.33'}]
[14:07:07] 🔄 
🔄 Step 4: Extracting order data...
[14:07:10] ℹ️  Order extraction - MRN: '5862015'
[14:07:10] ℹ️  Order extraction - Sex: 'FEMALE'
[14:07:10] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[14:07:10] ℹ️  Order extraction - Payer Source: ''
[14:07:10] ✅ Order data extraction completed successfully
[14:07:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:07:10] ℹ️  Using MRN from patient data: '5862015' over '5862015'
[14:07:10] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy' + Order='Skilled Nursing, PT' = 'PT, Physical Therapy, Skilled Nursing'
[14:07:10] ✅ Patient name cross-validation successful
[14:07:10] ✅    ✅ Data merged successfully
[14:07:11] ✅    ✅ Order data extracted and validated
[14:07:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:07:11] [DOC: 9232147] ✅ Patient found in local cache: Janice Arruda, ID: cc67108f-d504-4858-959a-d21d91141958
[14:07:11] ✅    ✅ Existing patient found with ID: cc67108f-d504-4858-959a-d21d91141958
[14:07:11] 🔄 
🔄 Step 6: Pushing order to API...
[14:07:11] [DOC: 9232147] ℹ️  Pushing order via API for patient ID: cc67108f-d504-4858-959a-d21d91141958
[14:07:12] [DOC: 9232147] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:07:12] ❌    ❌ Failed to push order
[14:07:12] 🔄 
🔄 Step 7: Writing to CSV...
[14:07:12] [DOC: 9232147] ℹ️  Calculated age: 75 from DOB: 01/24/1950
[14:07:12] [DOC: 9232147] ℹ️  Service Line extracted: 'PT, Physical Therapy, Skilled Nursing'
[14:07:12] [DOC: 9232147] ℹ️  Payer Source extracted: ''
[14:07:12] [DOC: 9232147] ℹ️  Diagnosis codes being written:
[14:07:12] [DOC: 9232147] ℹ️    - Latest_Episode_Firstdiagnosis: 'S06.6XAD'
[14:07:12] [DOC: 9232147] ℹ️    - Latest_Episode_Seconddiagnosis: 'N13.2'
[14:07:12] [DOC: 9232147] ℹ️    - Latest_Episode_Thirddiagnosis: 'N12'
[14:07:12] [DOC: 9232147] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Z96.0'
[14:07:12] [DOC: 9232147] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I13.0'
[14:07:12] [DOC: 9232147] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I50.33'
[14:07:12] [DOC: 9232147] ✅ Patient data written to CSV: Janice Arruda | Sex: FEMALE | Age: 75 | Service: PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 5862015
[14:07:12] ✅    ✅ Document 9232147 processed and saved successfully
[14:07:12] 🔄 
🔄 Step 8: Saving API details...
[14:07:12] [DOC: 9232147] ℹ️  API push details saved for document 9232147
[14:07:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232148                         ║
================================================================================
[14:07:12] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:07:12] ℹ️  Date: 04/10/2025
[14:07:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:07:13] [DOC: 9232148] ✅ Text extracted using pdfplumber (1125 chars)
[14:07:13] ✅    ✅ Text extracted using pdfplumber (1125 chars)
[14:07:13] 🔄 
🔄 Step 2: Extracting patient data...
[14:07:16] ℹ️  AI extracted raw sex value: 'F'
[14:07:16] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:07:16] ℹ️  AI extracted payer source: ''
[14:07:16] ℹ️  AI extracted diagnoses:
[14:07:16] ℹ️    - Diagnosis 1: ''
[14:07:16] ℹ️    - Diagnosis 2: ''
[14:07:16] ℹ️    - Diagnosis 3: ''
[14:07:16] ℹ️    - Diagnosis 4: ''
[14:07:16] ℹ️    - Diagnosis 5: ''
[14:07:16] ℹ️    - Diagnosis 6: ''
[14:07:16] ℹ️  Final extracted MRN: '2607201'
[14:07:16] ℹ️  Final extracted Sex: 'FEMALE'
[14:07:16] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:07:16] ℹ️  Final extracted Payer Source: ''
[14:07:16] ✅ Patient data extraction completed successfully
[14:07:16] ✅    ✅ Patient data extracted successfully
[14:07:16] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Kamm
     └─ dob: 08/02/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2607201
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:07:16] ✅    ✅ Patient identified: Theresa Kamm
[14:07:16] ✅    ✅ Patient name validation passed
[14:07:16] 🔄 
🔄 Step 3: Processing patient dates...
[14:07:16] [DOC: 9232148] ℹ️  DOB normalized: 08/02/1939
[14:07:16] [DOC: 9232148] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[14:07:16] [DOC: 9232148] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[14:07:16] [DOC: 9232148] ✅ Patient date processing completed successfully
[14:07:16] ✅    ✅ Date processing completed
[14:07:16] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Kamm
     └─ dob: 08/02/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2607201
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:07:16] 🔄 
🔄 Step 4: Extracting order data...
[14:07:18] ℹ️  Order extraction - MRN: '2607201'
[14:07:18] ℹ️  Order extraction - Sex: 'FEMALE'
[14:07:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:07:18] ℹ️  Order extraction - Payer Source: ''
[14:07:18] ✅ Order data extraction completed successfully
[14:07:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:07:18] ℹ️  Using MRN from patient data: '2607201' over '2607201'
[14:07:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:07:18] ✅ Patient name cross-validation successful
[14:07:18] ✅    ✅ Data merged successfully
[14:07:20] ✅    ✅ Order data extracted and validated
[14:07:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:07:30] [DOC: 9232148] ℹ️  Patient not found in cache or API: Theresa Kamm
[14:07:30] [DOC: 9232148] ℹ️  Patient not found, creating new patient via API...
[14:07:30] [DOC: 9232148] ℹ️  Creating patient via API: Theresa Kamm
[14:07:32] [DOC: 9232148] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:07:32] ❌    ❌ Failed to create patient
[14:07:32] [DOC: 9232148] ℹ️  API push details saved for document 9232148
================================================================================
║                        Processing Document ID: 9232146                         ║
================================================================================
[14:07:32] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:07:32] ℹ️  Date: 04/10/2025
[14:07:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:07:33] [DOC: 9232146] ✅ Text extracted using pdfplumber (1616 chars)
[14:07:33] ✅    ✅ Text extracted using pdfplumber (1616 chars)
[14:07:33] 🔄 
🔄 Step 2: Extracting patient data...
[14:07:35] ℹ️  AI extracted raw sex value: 'M'
[14:07:35] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[14:07:35] ℹ️  AI extracted payer source: ''
[14:07:35] ℹ️  AI extracted diagnoses:
[14:07:35] ℹ️    - Diagnosis 1: ''
[14:07:35] ℹ️    - Diagnosis 2: ''
[14:07:35] ℹ️    - Diagnosis 3: ''
[14:07:35] ℹ️    - Diagnosis 4: ''
[14:07:35] ℹ️    - Diagnosis 5: ''
[14:07:35] ℹ️    - Diagnosis 6: ''
[14:07:35] ℹ️  Final extracted MRN: '2571325'
[14:07:35] ℹ️  Final extracted Sex: 'MALE'
[14:07:35] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[14:07:35] ℹ️  Final extracted Payer Source: ''
[14:07:35] ✅ Patient data extraction completed successfully
[14:07:35] ✅    ✅ Patient data extracted successfully
[14:07:35] 📊 Patient Response
     └─ patientFName: Rodney
     └─ patientLName: Hill
     └─ dob: 08/12/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: 2571325
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:07:35] ✅    ✅ Patient identified: Rodney Hill
[14:07:35] ✅    ✅ Patient name validation passed
[14:07:35] 🔄 
🔄 Step 3: Processing patient dates...
[14:07:35] [DOC: 9232146] ℹ️  DOB normalized: 08/12/1960
[14:07:35] [DOC: 9232146] ✅ Patient date processing completed successfully
[14:07:35] ✅    ✅ Date processing completed
[14:07:35] 📊 Processed Patient Data
     └─ patientFName: Rodney
     └─ patientLName: Hill
     └─ dob: 08/12/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: 2571325
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:07:35] 🔄 
🔄 Step 4: Extracting order data...
[14:07:38] ℹ️  Order extraction - MRN: '2571325'
[14:07:38] ℹ️  Order extraction - Sex: 'MALE'
[14:07:38] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy'
[14:07:38] ℹ️  Order extraction - Payer Source: ''
[14:07:38] ✅ Order data extraction completed successfully
[14:07:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:07:38] ℹ️  Using MRN from patient data: '2571325' over '2571325'
[14:07:38] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy'
[14:07:38] ✅ Patient name cross-validation successful
[14:07:38] ✅    ✅ Data merged successfully
[14:07:39] ✅    ✅ Order data extracted and validated
[14:07:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:07:43] [DOC: 9232146] ℹ️  Patient not found in cache or API: Rodney Hill
[14:07:43] [DOC: 9232146] ℹ️  Patient not found, creating new patient via API...
[14:07:43] [DOC: 9232146] ℹ️  Creating patient via API: Rodney Hill
[14:07:44] [DOC: 9232146] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:07:44] ❌    ❌ Failed to create patient
[14:07:44] [DOC: 9232146] ℹ️  API push details saved for document 9232146
================================================================================
║                        Processing Document ID: 9232142                         ║
================================================================================
[14:07:44] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:07:44] ℹ️  Date: 04/10/2025
[14:07:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:07:46] [DOC: 9232142] ✅ Text extracted using pdfplumber (1157 chars)
[14:07:46] ✅    ✅ Text extracted using pdfplumber (1157 chars)
[14:07:46] 🔄 
🔄 Step 2: Extracting patient data...
[14:07:49] ℹ️  AI extracted raw sex value: 'F'
[14:07:49] ℹ️  AI extracted service line: 'Physical Therapy'
[14:07:49] ℹ️  AI extracted payer source: ''
[14:07:49] ℹ️  AI extracted diagnoses:
[14:07:49] ℹ️    - Diagnosis 1: ''
[14:07:49] ℹ️    - Diagnosis 2: ''
[14:07:49] ℹ️    - Diagnosis 3: ''
[14:07:49] ℹ️    - Diagnosis 4: ''
[14:07:49] ℹ️    - Diagnosis 5: ''
[14:07:49] ℹ️    - Diagnosis 6: ''
[14:07:49] ℹ️  Final extracted MRN: '2450273'
[14:07:49] ℹ️  Final extracted Sex: 'FEMALE'
[14:07:49] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:07:49] ℹ️  Final extracted Payer Source: ''
[14:07:49] ✅ Patient data extraction completed successfully
[14:07:49] ✅    ✅ Patient data extracted successfully
[14:07:49] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Estacio
     └─ dob: 12/14/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2450273
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:07:49] ✅    ✅ Patient identified: Maria Estacio
[14:07:49] ✅    ✅ Patient name validation passed
[14:07:49] 🔄 
🔄 Step 3: Processing patient dates...
[14:07:49] [DOC: 9232142] ℹ️  DOB normalized: 12/14/1935
[14:07:49] [DOC: 9232142] ✅ Patient date processing completed successfully
[14:07:49] ✅    ✅ Date processing completed
[14:07:49] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Estacio
     └─ dob: 12/14/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2450273
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:07:49] 🔄 
🔄 Step 4: Extracting order data...
[14:07:51] ℹ️  Order extraction - MRN: '2450273'
[14:07:51] ℹ️  Order extraction - Sex: 'FEMALE'
[14:07:51] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[14:07:51] ℹ️  Order extraction - Payer Source: ''
[14:07:51] ✅ Order data extraction completed successfully
[14:07:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:07:51] ℹ️  Using MRN from patient data: '2450273' over '2450273'
[14:07:51] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[14:07:51] ✅ Patient name cross-validation successful
[14:07:51] ✅    ✅ Data merged successfully
[14:07:52] ✅    ✅ Order data extracted and validated
[14:07:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:07:58] [DOC: 9232142] ℹ️  Patient not found in cache or API: Maria Estacio
[14:07:58] [DOC: 9232142] ℹ️  Patient not found, creating new patient via API...
[14:07:58] [DOC: 9232142] ℹ️  Creating patient via API: Maria Estacio
[14:07:59] [DOC: 9232142] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:07:59] ❌    ❌ Failed to create patient
[14:07:59] [DOC: 9232142] ℹ️  API push details saved for document 9232142
================================================================================
║                        Processing Document ID: 9232141                         ║
================================================================================
[14:07:59] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:07:59] ℹ️  Date: 04/10/2025
[14:07:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:08:01] [DOC: 9232141] ✅ Text extracted using pdfplumber (997 chars)
[14:08:01] ✅    ✅ Text extracted using pdfplumber (997 chars)
[14:08:01] 🔄 
🔄 Step 2: Extracting patient data...
[14:08:03] ℹ️  AI extracted raw sex value: 'M'
[14:08:03] ℹ️  AI extracted service line: 'Occupational Therapy'
[14:08:03] ℹ️  AI extracted payer source: ''
[14:08:03] ℹ️  AI extracted diagnoses:
[14:08:03] ℹ️    - Diagnosis 1: 'None'
[14:08:03] ℹ️    - Diagnosis 2: 'None'
[14:08:03] ℹ️    - Diagnosis 3: 'None'
[14:08:03] ℹ️    - Diagnosis 4: 'None'
[14:08:03] ℹ️    - Diagnosis 5: 'None'
[14:08:03] ℹ️    - Diagnosis 6: 'None'
[14:08:03] ℹ️  Final extracted MRN: '2447688'
[14:08:03] ℹ️  Final extracted Sex: 'MALE'
[14:08:03] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[14:08:03] ℹ️  Final extracted Payer Source: ''
[14:08:03] ✅ Patient data extraction completed successfully
[14:08:03] ✅    ✅ Patient data extracted successfully
[14:08:03] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/13/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:08:03] ✅    ✅ Patient identified: George England
[14:08:03] ✅    ✅ Patient name validation passed
[14:08:03] 🔄 
🔄 Step 3: Processing patient dates...
[14:08:03] [DOC: 9232141] ℹ️  DOB normalized: 08/26/1924
[14:08:03] [DOC: 9232141] ℹ️  Episode startOfEpisode normalized: 04/13/2025
[14:08:03] [DOC: 9232141] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[14:08:03] [DOC: 9232141] ✅ Patient date processing completed successfully
[14:08:03] ✅    ✅ Date processing completed
[14:08:03] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: England
     └─ dob: 08/26/1924
     └─ patientSex: MALE
     └─ medicalRecordNo: 2447688
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '05/10/2025'}]
[14:08:03] 🔄 
🔄 Step 4: Extracting order data...
[14:08:06] ℹ️  Order extraction - MRN: '2447688'
[14:08:06] ℹ️  Order extraction - Sex: 'MALE'
[14:08:06] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[14:08:06] ℹ️  Order extraction - Payer Source: ''
[14:08:06] ✅ Order data extraction completed successfully
[14:08:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:08:06] ℹ️  Using MRN from patient data: '2447688' over '2447688'
[14:08:06] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[14:08:06] ✅ Patient name cross-validation successful
[14:08:06] ✅    ✅ Data merged successfully
[14:08:07] ✅    ✅ Order data extracted and validated
[14:08:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:08:07] [DOC: 9232141] ✅ Patient found in local cache: George England, ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[14:08:07] ✅    ✅ Existing patient found with ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[14:08:07] 🔄 
🔄 Step 6: Pushing order to API...
[14:08:07] [DOC: 9232141] ℹ️  Pushing order via API for patient ID: 9e630b2a-6bbf-4ea5-b7c5-596174a81f4a
[14:08:08] [DOC: 9232141] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14166"}
[14:08:08] ❌    ❌ Failed to push order
[14:08:08] 🔄 
🔄 Step 7: Writing to CSV...
[14:08:08] [DOC: 9232141] ℹ️  Calculated age: 100 from DOB: 08/26/1924
[14:08:08] [DOC: 9232141] ℹ️  Service Line extracted: 'Occupational Therapy'
[14:08:08] [DOC: 9232141] ℹ️  Payer Source extracted: ''
[14:08:08] [DOC: 9232141] ℹ️  Diagnosis codes being written:
[14:08:08] [DOC: 9232141] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:08:08] [DOC: 9232141] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:08:08] [DOC: 9232141] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:08:08] [DOC: 9232141] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:08:08] [DOC: 9232141] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:08:08] [DOC: 9232141] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:08:08] [DOC: 9232141] ✅ Patient data written to CSV: George England | Sex: MALE | Age: 100 | Service: Occupational Therapy | Payer:  | MRN: 2447688
[14:08:08] ✅    ✅ Document 9232141 processed and saved successfully
[14:08:08] 🔄 
🔄 Step 8: Saving API details...
[14:08:08] [DOC: 9232141] ℹ️  API push details saved for document 9232141
[14:08:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232138                         ║
================================================================================
[14:08:08] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[14:08:08] ℹ️  Date: 04/10/2025
[14:08:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:08:10] [DOC: 9232138] ✅ Text extracted using pdfplumber (2103 chars)
[14:08:10] ✅    ✅ Text extracted using pdfplumber (2103 chars)
[14:08:10] 🔄 
🔄 Step 2: Extracting patient data...
[14:08:12] ℹ️  AI extracted raw sex value: 'M'
[14:08:12] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[14:08:12] ℹ️  AI extracted payer source: ''
[14:08:12] ℹ️  AI extracted diagnoses:
[14:08:12] ℹ️    - Diagnosis 1: ''
[14:08:12] ℹ️    - Diagnosis 2: ''
[14:08:12] ℹ️    - Diagnosis 3: ''
[14:08:12] ℹ️    - Diagnosis 4: ''
[14:08:12] ℹ️    - Diagnosis 5: ''
[14:08:12] ℹ️    - Diagnosis 6: ''
[14:08:12] ℹ️  Final extracted MRN: '2261639'
[14:08:12] ℹ️  Final extracted Sex: 'MALE'
[14:08:12] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[14:08:12] ℹ️  Final extracted Payer Source: ''
[14:08:12] ✅ Patient data extraction completed successfully
[14:08:12] ✅    ✅ Patient data extracted successfully
[14:08:12] 📊 Patient Response
     └─ patientFName: Webster
     └─ patientLName: Bowen
     └─ dob: 09/12/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 2261639
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:08:12] ✅    ✅ Patient identified: Webster Bowen
[14:08:12] ✅    ✅ Patient name validation passed
[14:08:12] 🔄 
🔄 Step 3: Processing patient dates...
[14:08:12] [DOC: 9232138] ℹ️  DOB normalized: 09/12/1949
[14:08:12] [DOC: 9232138] ✅ Patient date processing completed successfully
[14:08:12] ✅    ✅ Date processing completed
[14:08:12] 📊 Processed Patient Data
     └─ patientFName: Webster
     └─ patientLName: Bowen
     └─ dob: 09/12/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 2261639
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:08:12] 🔄 
🔄 Step 4: Extracting order data...
[14:08:15] ℹ️  Order extraction - MRN: '2261639'
[14:08:15] ℹ️  Order extraction - Sex: 'MALE'
[14:08:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[14:08:15] ℹ️  Order extraction - Payer Source: ''
[14:08:15] ✅ Order data extraction completed successfully
[14:08:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:08:15] ℹ️  Using MRN from patient data: '2261639' over '2261639'
[14:08:15] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[14:08:15] ✅ Patient name cross-validation successful
[14:08:15] ✅    ✅ Data merged successfully
[14:08:19] ✅    ✅ Order data extracted and validated
[14:08:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:08:24] [DOC: 9232138] ℹ️  Patient not found in cache or API: Webster Bowen
[14:08:24] [DOC: 9232138] ℹ️  Patient not found, creating new patient via API...
[14:08:24] [DOC: 9232138] ℹ️  Creating patient via API: Webster Bowen
[14:08:26] [DOC: 9232138] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:08:26] ❌    ❌ Failed to create patient
[14:08:26] [DOC: 9232138] ℹ️  API push details saved for document 9232138
================================================================================
║                        Processing Document ID: 2169148                         ║
================================================================================
[14:08:26] ℹ️  Agency: Visiting Rehab & Nursing Services
[14:08:26] ℹ️  Date: 04/09/2025
[14:08:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:08:28] [DOC: 2169148] ❌ Critical failure in get_pdf_text: Invalid response format
[14:08:28] ❌ Failed to extract text for Doc ID 2169148
[14:08:28] [DOC: 2169148] ℹ️  API push details saved for document 2169148
================================================================================
║                        Processing Document ID: 9229863                         ║
================================================================================
[14:08:28] ℹ️  Agency: Nizhoni Health-Fall River
[14:08:28] ℹ️  Date: 04/09/2025
[14:08:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:08:33] [DOC: 9229863] ✅ Text extracted using pdfplumber (12692 chars)
[14:08:33] ✅    ✅ Text extracted using pdfplumber (12692 chars)
[14:08:33] 🔄 
🔄 Step 2: Extracting patient data...
[14:08:36] ℹ️  AI extracted raw sex value: 'M'
[14:08:36] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:08:36] ℹ️  AI extracted payer source: 'None'
[14:08:36] ℹ️  AI extracted diagnoses:
[14:08:36] ℹ️    - Diagnosis 1: 'F20.9'
[14:08:36] ℹ️    - Diagnosis 2: 'F31.9'
[14:08:36] ℹ️    - Diagnosis 3: 'F41.9'
[14:08:36] ℹ️    - Diagnosis 4: 'I10'
[14:08:36] ℹ️    - Diagnosis 5: 'J09.X2'
[14:08:36] ℹ️    - Diagnosis 6: 'K21.9'
[14:08:36] ℹ️  Final extracted MRN: '10506'
[14:08:36] ℹ️  Final extracted Sex: 'MALE'
[14:08:36] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:08:36] ℹ️  Final extracted Payer Source: ''
[14:08:36] ✅ Patient data extraction completed successfully
[14:08:36] ✅    ✅ Patient data extracted successfully
[14:08:36] 📊 Patient Response
     └─ patientFName: Matthew
     └─ patientLName: Boyd
     └─ dob: 01/02/1959
     └─ patientSex: MALE
     └─ medicalRecordNo: 10506
     └─ billingProvider: Innovive Health
     └─ npi: 100011528617
     └─ physicianNPI: 
     └─ nameOfAgency: Nizhoni Health Systems DBA Innovive Health
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2023', 'startOfEpisode': '11/22/2023', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'F31.9', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'J09.X2', 'sixthDiagnosis': 'K21.9'}]
[14:08:36] ✅    ✅ Patient identified: Matthew Boyd
[14:08:36] ✅    ✅ Patient name validation passed
[14:08:36] 🔄 
🔄 Step 3: Processing patient dates...
[14:08:36] [DOC: 9229863] ℹ️  DOB normalized: 01/02/1959
[14:08:36] [DOC: 9229863] ℹ️  Episode startOfCare normalized: 11/07/2023
[14:08:36] [DOC: 9229863] ℹ️  Episode startOfEpisode normalized: 11/22/2023
[14:08:36] [DOC: 9229863] ℹ️  Episode endOfEpisode normalized: 05/14/2025
[14:08:36] [DOC: 9229863] ✅ Patient date processing completed successfully
[14:08:36] ✅    ✅ Date processing completed
[14:08:36] 📊 Processed Patient Data
     └─ patientFName: Matthew
     └─ patientLName: Boyd
     └─ dob: 01/02/1959
     └─ patientSex: MALE
     └─ medicalRecordNo: 10506
     └─ billingProvider: Innovive Health
     └─ npi: 100011528617
     └─ physicianNPI: 
     └─ nameOfAgency: Nizhoni Health Systems DBA Innovive Health
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2023', 'startOfEpisode': '11/22/2023', 'endOfEpisode': '05/14/2025', 'firstDiagnosis': 'F20.9', 'secondDiagnosis': 'F31.9', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'J09.X2', 'sixthDiagnosis': 'K21.9'}]
[14:08:36] 🔄 
🔄 Step 4: Extracting order data...
[14:08:39] ℹ️  Order extraction - MRN: '10506'
[14:08:39] ℹ️  Order extraction - Sex: 'MALE'
[14:08:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:08:39] ℹ️  Order extraction - Payer Source: ''
[14:08:39] ✅ Order data extraction completed successfully
[14:08:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:08:39] ℹ️  Using MRN from patient data: '10506' over '10506'
[14:08:39] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:08:39] ✅ Patient name cross-validation successful
[14:08:39] ✅    ✅ Data merged successfully
[14:08:40] ✅    ✅ Order data extracted and validated
[14:08:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:08:54] [DOC: 9229863] ℹ️  Patient not found in cache or API: Matthew Boyd
[14:08:54] [DOC: 9229863] ℹ️  Patient not found, creating new patient via API...
[14:08:54] [DOC: 9229863] ℹ️  Creating patient via API: Matthew Boyd
[14:08:55] [DOC: 9229863] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:08:55] ❌    ❌ Failed to create patient
[14:08:55] [DOC: 9229863] ℹ️  API push details saved for document 9229863
================================================================================
║                        Processing Document ID: 9229807                         ║
================================================================================
[14:08:55] ℹ️  Agency: Nizhoni Health-Fall River
[14:08:55] ℹ️  Date: 04/09/2025
[14:08:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:08:59] [DOC: 9229807] ✅ Text extracted using pdfplumber (17820 chars)
[14:08:59] ✅    ✅ Text extracted using pdfplumber (17820 chars)
[14:08:59] 🔄 
🔄 Step 2: Extracting patient data...
[14:09:02] ℹ️  AI extracted raw sex value: 'F'
[14:09:02] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:09:02] ℹ️  AI extracted payer source: 'None'
[14:09:02] ℹ️  AI extracted diagnoses:
[14:09:02] ℹ️    - Diagnosis 1: 'F41.8'
[14:09:02] ℹ️    - Diagnosis 2: 'M15.9'
[14:09:02] ℹ️    - Diagnosis 3: 'J44.9'
[14:09:02] ℹ️    - Diagnosis 4: 'I12.9'
[14:09:02] ℹ️    - Diagnosis 5: 'N18.30'
[14:09:02] ℹ️    - Diagnosis 6: 'G89.29'
[14:09:02] ℹ️  Final extracted MRN: '25598'
[14:09:02] ℹ️  Final extracted Sex: 'FEMALE'
[14:09:02] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:09:02] ℹ️  Final extracted Payer Source: ''
[14:09:02] ✅ Patient data extraction completed successfully
[14:09:02] ✅    ✅ Patient data extracted successfully
[14:09:02] 📊 Patient Response
     └─ patientFName: Helena
     └─ patientLName: Brooks
     └─ dob: 05/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 25598
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100013464654
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '07/15/2018', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'F41.8', 'secondDiagnosis': 'M15.9', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'G89.29'}]
[14:09:02] ✅    ✅ Patient identified: Helena Brooks
[14:09:02] ✅    ✅ Patient name validation passed
[14:09:02] 🔄 
🔄 Step 3: Processing patient dates...
[14:09:02] [DOC: 9229807] ℹ️  DOB normalized: 05/27/1958
[14:09:02] [DOC: 9229807] ℹ️  Episode startOfCare normalized: 07/15/2018
[14:09:02] [DOC: 9229807] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[14:09:02] [DOC: 9229807] ℹ️  Episode endOfEpisode normalized: 06/07/2025
[14:09:02] [DOC: 9229807] ✅ Patient date processing completed successfully
[14:09:02] ✅    ✅ Date processing completed
[14:09:02] 📊 Processed Patient Data
     └─ patientFName: Helena
     └─ patientLName: Brooks
     └─ dob: 05/27/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 25598
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100013464654
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '07/15/2018', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'F41.8', 'secondDiagnosis': 'M15.9', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'G89.29'}]
[14:09:02] 🔄 
🔄 Step 4: Extracting order data...
[14:09:05] ℹ️  Order extraction - MRN: '25598'
[14:09:05] ℹ️  Order extraction - Sex: 'FEMALE'
[14:09:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:09:05] ℹ️  Order extraction - Payer Source: ''
[14:09:05] ✅ Order data extraction completed successfully
[14:09:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:09:05] ℹ️  Using MRN from patient data: '25598' over '25598'
[14:09:05] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:09:05] ✅ Patient name cross-validation successful
[14:09:05] ✅    ✅ Data merged successfully
[14:09:06] ✅    ✅ Order data extracted and validated
[14:09:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:09:29] [DOC: 9229807] ✅ Patient exists in API: Helena Brooks, ID: c6d8a3a9-d724-4430-be8c-467e9ac45674
[14:09:29] ✅    ✅ Existing patient found with ID: c6d8a3a9-d724-4430-be8c-467e9ac45674
[14:09:29] 🔄 
🔄 Step 6: Pushing order to API...
[14:09:29] [DOC: 9229807] ℹ️  Pushing order via API for patient ID: c6d8a3a9-d724-4430-be8c-467e9ac45674
[14:09:31] [DOC: 9229807] ❌ Order push failed with status 201: {"id":"8a1fb637-c783-446d-9924-7cddcb6b1d26","orderWAVId":"ORD20047","orderNo":"25598","orderDate":"04/08/2025","startOfCare":"07/15/2018","episodeStartDate":"04/09/2025","episodeEndDate":"06/07/2025","documentID":"9229807","mrn":"25598","patientName":"Brooks, Helena","sentToPhysicianDate":"04/09/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":null,"signedByPhysicianStatus":false,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"c6d8a3a9-d724-4430-be8c-467e9ac45674","companyId":"d598757a-87c6-4192-bcde-ff8d6e0b91ad","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[14:09:31] ❌    ❌ Failed to push order
[14:09:31] 🔄 
🔄 Step 7: Writing to CSV...
[14:09:31] [DOC: 9229807] ℹ️  Calculated age: 67 from DOB: 05/27/1958
[14:09:31] [DOC: 9229807] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:09:31] [DOC: 9229807] ℹ️  Payer Source extracted: ''
[14:09:31] [DOC: 9229807] ℹ️  Diagnosis codes being written:
[14:09:31] [DOC: 9229807] ℹ️    - Latest_Episode_Firstdiagnosis: 'F41.8'
[14:09:31] [DOC: 9229807] ℹ️    - Latest_Episode_Seconddiagnosis: 'M15.9'
[14:09:31] [DOC: 9229807] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.9'
[14:09:31] [DOC: 9229807] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I12.9'
[14:09:31] [DOC: 9229807] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.30'
[14:09:31] [DOC: 9229807] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G89.29'
[14:09:31] [DOC: 9229807] ✅ Patient data written to CSV: Helena Brooks | Sex: FEMALE | Age: 67 | Service: Skilled Nursing | Payer:  | MRN: 25598
[14:09:31] ✅    ✅ Document 9229807 processed and saved successfully
[14:09:31] 🔄 
🔄 Step 8: Saving API details...
[14:09:31] [DOC: 9229807] ℹ️  API push details saved for document 9229807
[14:09:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9232067                         ║
================================================================================
[14:09:31] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[14:09:31] ℹ️  Date: 04/09/2025
[14:09:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:09:33] [DOC: 9232067] ✅ Text extracted using pdfplumber (2168 chars)
[14:09:33] ✅    ✅ Text extracted using pdfplumber (2156 chars)
[14:09:33] 🔄 
🔄 Step 2: Extracting patient data...
[14:09:36] ℹ️  AI extracted raw sex value: ''
[14:09:36] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:09:36] ℹ️  AI extracted payer source: 'Medicare'
[14:09:36] ℹ️  AI extracted diagnoses:
[14:09:36] ℹ️    - Diagnosis 1: 'None'
[14:09:36] ℹ️    - Diagnosis 2: 'None'
[14:09:36] ℹ️    - Diagnosis 3: 'None'
[14:09:36] ℹ️    - Diagnosis 4: 'None'
[14:09:36] ℹ️    - Diagnosis 5: 'None'
[14:09:36] ℹ️    - Diagnosis 6: 'None'
[14:09:36] ℹ️  Final extracted MRN: '28700005205301'
[14:09:36] ℹ️  Final extracted Sex: ''
[14:09:36] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:09:36] ℹ️  Final extracted Payer Source: 'Medicare'
[14:09:36] ✅ Patient data extraction completed successfully
[14:09:36] ✅    ✅ Patient data extracted successfully
[14:09:36] 📊 Patient Response
     └─ patientFName: LAURA
     └─ patientLName: RAMSHEAD
     └─ dob: 05/09/1936
     └─ patientSex: 
     └─ medicalRecordNo: 28700005205301
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/19/2025', 'endOfEpisode': '03/04/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:09:36] ✅    ✅ Patient identified: LAURA RAMSHEAD
[14:09:36] ✅    ✅ Patient name validation passed
[14:09:36] 🔄 
🔄 Step 3: Processing patient dates...
[14:09:36] [DOC: 9232067] ℹ️  DOB normalized: 05/09/1936
[14:09:36] [DOC: 9232067] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[14:09:36] [DOC: 9232067] ℹ️  Episode endOfEpisode normalized: 03/04/2025
[14:09:36] [DOC: 9232067] ✅ Patient date processing completed successfully
[14:09:36] ✅    ✅ Date processing completed
[14:09:36] 📊 Processed Patient Data
     └─ patientFName: LAURA
     └─ patientLName: RAMSHEAD
     └─ dob: 05/09/1936
     └─ patientSex: 
     └─ medicalRecordNo: 28700005205301
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '03/04/2025'}]
[14:09:36] 🔄 
🔄 Step 4: Extracting order data...
[14:09:39] ℹ️  Order extraction - MRN: '28700005205301'
[14:09:39] ℹ️  Order extraction - Sex: ''
[14:09:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:09:39] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:09:39] ✅ Order data extraction completed successfully
[14:09:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:09:39] ℹ️  Using MRN from patient data: '28700005205301' over '28700005205301'
[14:09:39] ℹ️  Inferred sex as FEMALE from name: LAURA
[14:09:39] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:09:39] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:09:39] ✅ Patient name cross-validation successful
[14:09:39] ✅    ✅ Data merged successfully
[14:09:40] ✅    ✅ Order data extracted and validated
[14:09:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:10:05] [DOC: 9232067] ℹ️  Patient not found in cache or API: LAURA RAMSHEAD
[14:10:05] [DOC: 9232067] ℹ️  Patient not found, creating new patient via API...
[14:10:05] [DOC: 9232067] ℹ️  Creating patient via API: LAURA RAMSHEAD
[14:10:06] [DOC: 9232067] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:10:06] ❌    ❌ Failed to create patient
[14:10:06] [DOC: 9232067] ℹ️  API push details saved for document 9232067
================================================================================
║                        Processing Document ID: 9232066                         ║
================================================================================
[14:10:06] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[14:10:06] ℹ️  Date: 04/09/2025
[14:10:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:10:11] [DOC: 9232066] ✅ Text extracted using pdfplumber (1790 chars)
[14:10:11] ✅    ✅ Text extracted using pdfplumber (1778 chars)
[14:10:11] 🔄 
🔄 Step 2: Extracting patient data...
[14:10:14] ℹ️  AI extracted raw sex value: ''
[14:10:14] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:10:14] ℹ️  AI extracted payer source: 'Medicare'
[14:10:14] ℹ️  AI extracted diagnoses:
[14:10:14] ℹ️    - Diagnosis 1: ''
[14:10:14] ℹ️    - Diagnosis 2: ''
[14:10:14] ℹ️    - Diagnosis 3: ''
[14:10:14] ℹ️    - Diagnosis 4: ''
[14:10:14] ℹ️    - Diagnosis 5: ''
[14:10:14] ℹ️    - Diagnosis 6: ''
[14:10:14] ℹ️  Final extracted MRN: '28700005205301'
[14:10:14] ℹ️  Final extracted Sex: ''
[14:10:14] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:10:14] ℹ️  Final extracted Payer Source: 'Medicare'
[14:10:14] ✅ Patient data extraction completed successfully
[14:10:14] ✅    ✅ Patient data extracted successfully
[14:10:14] 📊 Patient Response
     └─ patientFName: LAURA
     └─ patientLName: RAMSHEAD
     └─ dob: 05/09/1936
     └─ patientSex: 
     └─ medicalRecordNo: 28700005205301
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '03/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:10:14] ✅    ✅ Patient identified: LAURA RAMSHEAD
[14:10:14] ✅    ✅ Patient name validation passed
[14:10:14] 🔄 
🔄 Step 3: Processing patient dates...
[14:10:14] [DOC: 9232066] ℹ️  DOB normalized: 05/09/1936
[14:10:14] [DOC: 9232066] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[14:10:14] [DOC: 9232066] ℹ️  Episode endOfEpisode normalized: 03/04/2025
[14:10:14] [DOC: 9232066] ✅ Patient date processing completed successfully
[14:10:14] ✅    ✅ Date processing completed
[14:10:14] 📊 Processed Patient Data
     └─ patientFName: LAURA
     └─ patientLName: RAMSHEAD
     └─ dob: 05/09/1936
     └─ patientSex: 
     └─ medicalRecordNo: 28700005205301
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 227539 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '03/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:10:14] 🔄 
🔄 Step 4: Extracting order data...
[14:10:16] ℹ️  Order extraction - MRN: '28700005205301'
[14:10:16] ℹ️  Order extraction - Sex: ''
[14:10:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:10:16] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:10:16] ✅ Order data extraction completed successfully
[14:10:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:10:16] ℹ️  Using MRN from patient data: '28700005205301' over '28700005205301'
[14:10:16] ℹ️  Inferred sex as FEMALE from name: LAURA
[14:10:16] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:10:16] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:10:16] ✅ Patient name cross-validation successful
[14:10:16] ✅    ✅ Data merged successfully
[14:10:17] ✅    ✅ Order data extracted and validated
[14:10:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:10:44] [DOC: 9232066] ℹ️  Patient not found in cache or API: LAURA RAMSHEAD
[14:10:44] [DOC: 9232066] ℹ️  Patient not found, creating new patient via API...
[14:10:44] [DOC: 9232066] ℹ️  Creating patient via API: LAURA RAMSHEAD
[14:10:45] [DOC: 9232066] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:10:45] ❌    ❌ Failed to create patient
[14:10:45] [DOC: 9232066] ℹ️  API push details saved for document 9232066
================================================================================
║                        Processing Document ID: 9232058                         ║
================================================================================
[14:10:45] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[14:10:45] ℹ️  Date: 04/09/2025
[14:10:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:10:48] [DOC: 9232058] ✅ Text extracted using pdfplumber (22028 chars)
[14:10:48] ✅    ✅ Text extracted using pdfplumber (22028 chars)
[14:10:48] 🔄 
🔄 Step 2: Extracting patient data...
[14:10:51] ℹ️  AI extracted raw sex value: 'M'
[14:10:51] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:10:51] ℹ️  AI extracted payer source: 'Medicare'
[14:10:51] ℹ️  AI extracted diagnoses:
[14:10:51] ℹ️    - Diagnosis 1: 'L03.311'
[14:10:51] ℹ️    - Diagnosis 2: 'L02.211'
[14:10:51] ℹ️    - Diagnosis 3: 'B95.61'
[14:10:51] ℹ️    - Diagnosis 4: 'N17.9'
[14:10:51] ℹ️    - Diagnosis 5: 'I10'
[14:10:51] ℹ️    - Diagnosis 6: 'E11.21'
[14:10:51] ℹ️  Final extracted MRN: '28700210537101'
[14:10:51] ℹ️  Final extracted Sex: 'MALE'
[14:10:51] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:10:51] ℹ️  Final extracted Payer Source: 'Medicare'
[14:10:51] ✅ Patient data extraction completed successfully
[14:10:51] ✅    ✅ Patient data extracted successfully
[14:10:51] 📊 Patient Response
     └─ patientFName: DANIEL
     └─ patientLName: CORREIA
     └─ dob: 02/24/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700210537101
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 417 RIVET ST
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'L03.311', 'secondDiagnosis': 'L02.211', 'thirdDiagnosis': 'B95.61', 'fourthDiagnosis': 'N17.9', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E11.21'}]
[14:10:51] ✅    ✅ Patient identified: DANIEL CORREIA
[14:10:51] ✅    ✅ Patient name validation passed
[14:10:51] 🔄 
🔄 Step 3: Processing patient dates...
[14:10:51] [DOC: 9232058] ℹ️  DOB normalized: 02/24/1956
[14:10:51] [DOC: 9232058] ℹ️  Episode startOfCare normalized: 03/27/2025
[14:10:51] [DOC: 9232058] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[14:10:51] [DOC: 9232058] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[14:10:51] [DOC: 9232058] ✅ Patient date processing completed successfully
[14:10:51] ✅    ✅ Date processing completed
[14:10:51] 📊 Processed Patient Data
     └─ patientFName: DANIEL
     └─ patientLName: CORREIA
     └─ dob: 02/24/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700210537101
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 417 RIVET ST
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'L03.311', 'secondDiagnosis': 'L02.211', 'thirdDiagnosis': 'B95.61', 'fourthDiagnosis': 'N17.9', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E11.21'}]
[14:10:51] 🔄 
🔄 Step 4: Extracting order data...
[14:10:54] ℹ️  Order extraction - MRN: '28700210537101'
[14:10:54] ℹ️  Order extraction - Sex: 'MALE'
[14:10:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:10:54] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:10:54] ✅ Order data extraction completed successfully
[14:10:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:10:54] ℹ️  Using MRN from patient data: '28700210537101' over '28700210537101'
[14:10:54] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:10:54] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:10:54] ✅ Patient name cross-validation successful
[14:10:54] ✅    ✅ Data merged successfully
[14:10:55] ✅    ✅ Order data extracted and validated
[14:10:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:10:55] [DOC: 9232058] ✅ Patient found in local cache: DANIEL CORREIA, ID: cb8b090e-5a6b-4260-b138-28d8bba8963e
[14:10:55] ✅    ✅ Existing patient found with ID: cb8b090e-5a6b-4260-b138-28d8bba8963e
[14:10:55] 🔄 
🔄 Step 6: Pushing order to API...
[14:10:55] [DOC: 9232058] ℹ️  Pushing order via API for patient ID: cb8b090e-5a6b-4260-b138-28d8bba8963e
[14:10:57] [DOC: 9232058] ❌ Order push failed with status 201: {"id":"00d288b2-a07f-4415-9af1-a6e08de8d34f","orderWAVId":"ORD20048","orderNo":"HOME HEALTH CERTIFICATION AND PLAN OF CARE 12306242","orderDate":"03/27/2025","startOfCare":"03/27/2025","episodeStartDate":"03/27/2025","episodeEndDate":"05/25/2025","documentID":"9232058","mrn":"28700210537101","patientName":"DANIEL CORREIA","sentToPhysicianDate":"04/09/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/16/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"cb8b090e-5a6b-4260-b138-28d8bba8963e","companyId":"532ae690-17f2-4fb0-b9ec-e3ef8634f57d","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[14:10:57] ❌    ❌ Failed to push order
[14:10:57] 🔄 
🔄 Step 7: Writing to CSV...
[14:10:57] [DOC: 9232058] ℹ️  Calculated age: 69 from DOB: 02/24/1956
[14:10:57] [DOC: 9232058] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:10:57] [DOC: 9232058] ℹ️  Payer Source extracted: 'Medicare'
[14:10:57] [DOC: 9232058] ℹ️  Diagnosis codes being written:
[14:10:57] [DOC: 9232058] ℹ️    - Latest_Episode_Firstdiagnosis: 'L03.311'
[14:10:57] [DOC: 9232058] ℹ️    - Latest_Episode_Seconddiagnosis: 'L02.211'
[14:10:57] [DOC: 9232058] ℹ️    - Latest_Episode_Thirddiagnosis: 'B95.61'
[14:10:57] [DOC: 9232058] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N17.9'
[14:10:57] [DOC: 9232058] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[14:10:57] [DOC: 9232058] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E11.21'
[14:10:57] [DOC: 9232058] ✅ Patient data written to CSV: DANIEL CORREIA | Sex: MALE | Age: 69 | Service: Skilled Nursing | Payer: Medicare | MRN: 28700210537101
[14:10:57] ✅    ✅ Document 9232058 processed and saved successfully
[14:10:57] 🔄 
🔄 Step 8: Saving API details...
[14:10:57] [DOC: 9232058] ℹ️  API push details saved for document 9232058
[14:10:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231465                         ║
================================================================================
[14:10:57] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:10:57] ℹ️  Date: 04/09/2025
[14:10:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:11:00] [DOC: 9231465] ✅ Text extracted using pdfplumber (12949 chars)
[14:11:00] ✅    ✅ Text extracted using pdfplumber (12949 chars)
[14:11:00] 🔄 
🔄 Step 2: Extracting patient data...
[14:11:03] ℹ️  AI extracted raw sex value: 'F'
[14:11:03] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:11:03] ℹ️  AI extracted payer source: 'Medicare'
[14:11:03] ℹ️  AI extracted diagnoses:
[14:11:03] ℹ️    - Diagnosis 1: 'J43.2'
[14:11:03] ℹ️    - Diagnosis 2: 'J18.8'
[14:11:03] ℹ️    - Diagnosis 3: 'J96.21'
[14:11:03] ℹ️    - Diagnosis 4: 'J96.22'
[14:11:03] ℹ️    - Diagnosis 5: 'G93.41'
[14:11:03] ℹ️    - Diagnosis 6: 'I11.0'
[14:11:03] ℹ️  Final extracted MRN: '100994784'
[14:11:03] ℹ️  Final extracted Sex: 'FEMALE'
[14:11:03] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:11:03] ℹ️  Final extracted Payer Source: 'Medicare'
[14:11:03] ✅ Patient data extraction completed successfully
[14:11:03] ✅    ✅ Patient data extracted successfully
[14:11:03] 📊 Patient Response
     └─ patientFName: Aida
     └─ patientLName: Torres
     └─ dob: 09/03/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100994784
     └─ billingProvider: Dirican, Ahmet MD
     └─ npi: 1396723813
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 62 Adams St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (508) 991-9298
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2022', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'J43.2', 'secondDiagnosis': 'J18.8', 'thirdDiagnosis': 'J96.21', 'fourthDiagnosis': 'J96.22', 'fifthDiagnosis': 'G93.41', 'sixthDiagnosis': 'I11.0'}]
[14:11:03] ✅    ✅ Patient identified: Aida Torres
[14:11:03] ✅    ✅ Patient name validation passed
[14:11:03] 🔄 
🔄 Step 3: Processing patient dates...
[14:11:03] [DOC: 9231465] ℹ️  DOB normalized: 09/03/1947
[14:11:03] [DOC: 9231465] ℹ️  Episode startOfCare normalized: 12/01/2022
[14:11:03] [DOC: 9231465] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[14:11:03] [DOC: 9231465] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[14:11:03] [DOC: 9231465] ✅ Patient date processing completed successfully
[14:11:03] ✅    ✅ Date processing completed
[14:11:03] 📊 Processed Patient Data
     └─ patientFName: Aida
     └─ patientLName: Torres
     └─ dob: 09/03/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100994784
     └─ billingProvider: Dirican, Ahmet MD
     └─ npi: 1396723813
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 62 Adams St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (508) 991-9298
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2022', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'J43.2', 'secondDiagnosis': 'J18.8', 'thirdDiagnosis': 'J96.21', 'fourthDiagnosis': 'J96.22', 'fifthDiagnosis': 'G93.41', 'sixthDiagnosis': 'I11.0'}]
[14:11:03] 🔄 
🔄 Step 4: Extracting order data...
[14:11:06] ℹ️  Order extraction - MRN: '100994784'
[14:11:06] ℹ️  Order extraction - Sex: 'FEMALE'
[14:11:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:11:06] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:11:06] ✅ Order data extraction completed successfully
[14:11:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:11:06] ℹ️  Using MRN from patient data: '100994784' over '100994784'
[14:11:06] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:11:06] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:11:06] ✅ Patient name cross-validation successful
[14:11:06] ✅    ✅ Data merged successfully
[14:11:07] ✅    ✅ Order data extracted and validated
[14:11:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:11:38] [DOC: 9231465] ✅ Patient exists in API: Aida Torres, ID: fac206fe-c39b-4ab1-b532-654dcc4f3a03
[14:11:38] ✅    ✅ Existing patient found with ID: fac206fe-c39b-4ab1-b532-654dcc4f3a03
[14:11:38] 🔄 
🔄 Step 6: Pushing order to API...
[14:11:38] [DOC: 9231465] ℹ️  Pushing order via API for patient ID: fac206fe-c39b-4ab1-b532-654dcc4f3a03
[14:11:39] [DOC: 9231465] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12914"}
[14:11:39] ❌    ❌ Failed to push order
[14:11:39] 🔄 
🔄 Step 7: Writing to CSV...
[14:11:39] [DOC: 9231465] ℹ️  Calculated age: 77 from DOB: 09/03/1947
[14:11:39] [DOC: 9231465] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:11:39] [DOC: 9231465] ℹ️  Payer Source extracted: 'Medicare'
[14:11:39] [DOC: 9231465] ℹ️  Diagnosis codes being written:
[14:11:39] [DOC: 9231465] ℹ️    - Latest_Episode_Firstdiagnosis: 'J43.2'
[14:11:39] [DOC: 9231465] ℹ️    - Latest_Episode_Seconddiagnosis: 'J18.8'
[14:11:39] [DOC: 9231465] ℹ️    - Latest_Episode_Thirddiagnosis: 'J96.21'
[14:11:39] [DOC: 9231465] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J96.22'
[14:11:39] [DOC: 9231465] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G93.41'
[14:11:39] [DOC: 9231465] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I11.0'
[14:11:39] [DOC: 9231465] ✅ Patient data written to CSV: Aida Torres | Sex: FEMALE | Age: 77 | Service: Skilled Nursing | Payer: Medicare | MRN: 100994784
[14:11:39] ✅    ✅ Document 9231465 processed and saved successfully
[14:11:39] 🔄 
🔄 Step 8: Saving API details...
[14:11:39] [DOC: 9231465] ℹ️  API push details saved for document 9231465
[14:11:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231462                         ║
================================================================================
[14:11:39] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:11:39] ℹ️  Date: 04/09/2025
[14:11:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:11:41] [DOC: 9231462] ✅ Text extracted using pdfplumber (1527 chars)
[14:11:41] ✅    ✅ Text extracted using pdfplumber (1527 chars)
[14:11:41] 🔄 
🔄 Step 2: Extracting patient data...
[14:11:44] ℹ️  AI extracted raw sex value: ''
[14:11:44] ℹ️  AI extracted service line: 'Physical Therapy'
[14:11:44] ℹ️  AI extracted payer source: ''
[14:11:44] ℹ️  AI extracted diagnoses:
[14:11:44] ℹ️    - Diagnosis 1: 'G20.A1'
[14:11:44] ℹ️    - Diagnosis 2: 'I11.9'
[14:11:44] ℹ️    - Diagnosis 3: 'E11.40'
[14:11:44] ℹ️    - Diagnosis 4: 'None'
[14:11:44] ℹ️    - Diagnosis 5: 'None'
[14:11:44] ℹ️    - Diagnosis 6: 'None'
[14:11:44] ℹ️  Final extracted MRN: 'MA241007025405'
[14:11:44] ℹ️  Final extracted Sex: ''
[14:11:44] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:11:44] ℹ️  Final extracted Payer Source: ''
[14:11:44] ✅ Patient data extraction completed successfully
[14:11:44] ✅    ✅ Patient data extracted successfully
[14:11:44] 📊 Patient Response
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:11:44] ✅    ✅ Patient identified: Gordonna Walker
[14:11:44] ✅    ✅ Patient name validation passed
[14:11:44] 🔄 
🔄 Step 3: Processing patient dates...
[14:11:44] [DOC: 9231462] ℹ️  DOB normalized: 02/21/1954
[14:11:44] [DOC: 9231462] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[14:11:44] [DOC: 9231462] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[14:11:44] [DOC: 9231462] ✅ Patient date processing completed successfully
[14:11:44] ✅    ✅ Date processing completed
[14:11:44] 📊 Processed Patient Data
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40'}]
[14:11:44] 🔄 
🔄 Step 4: Extracting order data...
[14:11:47] ℹ️  Order extraction - MRN: 'MA241007025405'
[14:11:47] ℹ️  Order extraction - Sex: ''
[14:11:47] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[14:11:47] ℹ️  Order extraction - Payer Source: ''
[14:11:47] ✅ Order data extraction completed successfully
[14:11:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:11:47] ℹ️  Using MRN from patient data: 'MA241007025405' over 'MA241007025405'
[14:11:47] ⚠️  Could not determine sex using any available method
[14:11:47] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[14:11:47] ✅ Patient name cross-validation successful
[14:11:47] ✅    ✅ Data merged successfully
[14:11:49] ✅    ✅ Order data extracted and validated
[14:11:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:11:49] [DOC: 9231462] ✅ Patient found in local cache: Gordonna Walker, ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:11:49] ✅    ✅ Existing patient found with ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:11:49] 🔄 
🔄 Step 6: Pushing order to API...
[14:11:49] [DOC: 9231462] ℹ️  Pushing order via API for patient ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:11:50] [DOC: 9231462] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14405"}
[14:11:50] ❌    ❌ Failed to push order
[14:11:50] 🔄 
🔄 Step 7: Writing to CSV...
[14:11:50] [DOC: 9231462] ℹ️  Calculated age: 71 from DOB: 02/21/1954
[14:11:50] [DOC: 9231462] ℹ️  Service Line extracted: 'Physical Therapy'
[14:11:50] [DOC: 9231462] ℹ️  Payer Source extracted: ''
[14:11:50] [DOC: 9231462] ℹ️  Diagnosis codes being written:
[14:11:50] [DOC: 9231462] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[14:11:50] [DOC: 9231462] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.9'
[14:11:50] [DOC: 9231462] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.40'
[14:11:50] [DOC: 9231462] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:11:50] [DOC: 9231462] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:11:50] [DOC: 9231462] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:11:50] [DOC: 9231462] ✅ Patient data written to CSV: Gordonna Walker | Sex:  | Age: 71 | Service: Physical Therapy | Payer:  | MRN: MA241007025405
[14:11:50] ✅    ✅ Document 9231462 processed and saved successfully
[14:11:50] 🔄 
🔄 Step 8: Saving API details...
[14:11:50] [DOC: 9231462] ℹ️  API push details saved for document 9231462
[14:11:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231461                         ║
================================================================================
[14:11:50] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:11:50] ℹ️  Date: 04/09/2025
[14:11:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:11:54] [DOC: 9231461] ✅ Text extracted using pdfplumber (18825 chars)
[14:11:54] ✅    ✅ Text extracted using pdfplumber (18825 chars)
[14:11:54] 🔄 
🔄 Step 2: Extracting patient data...
[14:11:57] ℹ️  AI extracted raw sex value: 'F'
[14:11:57] ℹ️  AI extracted service line: 'PT'
[14:11:57] ℹ️  AI extracted payer source: ''
[14:11:57] ℹ️  AI extracted diagnoses:
[14:11:57] ℹ️    - Diagnosis 1: ''
[14:11:57] ℹ️    - Diagnosis 2: ''
[14:11:57] ℹ️    - Diagnosis 3: ''
[14:11:57] ℹ️    - Diagnosis 4: ''
[14:11:57] ℹ️    - Diagnosis 5: ''
[14:11:57] ℹ️    - Diagnosis 6: ''
[14:11:57] ℹ️  Final extracted MRN: 'MA241007025405'
[14:11:57] ℹ️  Final extracted Sex: 'FEMALE'
[14:11:57] ℹ️  Final extracted Service Line: 'PT'
[14:11:57] ℹ️  Final extracted Payer Source: ''
[14:11:57] ✅ Patient data extraction completed successfully
[14:11:57] ✅    ✅ Patient data extracted successfully
[14:11:57] 📊 Patient Response
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:11:57] ✅    ✅ Patient identified: Gordonna Walker
[14:11:57] ✅    ✅ Patient name validation passed
[14:11:57] 🔄 
🔄 Step 3: Processing patient dates...
[14:11:57] [DOC: 9231461] ℹ️  DOB normalized: 02/21/1954
[14:11:57] [DOC: 9231461] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[14:11:57] [DOC: 9231461] ✅ Patient date processing completed successfully
[14:11:57] ✅    ✅ Date processing completed
[14:11:57] 📊 Processed Patient Data
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:11:57] 🔄 
🔄 Step 4: Extracting order data...
[14:12:00] ℹ️  Order extraction - MRN: 'MA241007025405'
[14:12:00] ℹ️  Order extraction - Sex: 'FEMALE'
[14:12:00] ℹ️  Order extraction - Service Line: 'PT'
[14:12:00] ℹ️  Order extraction - Payer Source: ''
[14:12:00] ✅ Order data extraction completed successfully
[14:12:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:12:00] ℹ️  Using MRN from patient data: 'MA241007025405' over 'MA241007025405'
[14:12:00] ℹ️  Service line consistent in both sources: 'PT'
[14:12:00] ✅ Patient name cross-validation successful
[14:12:00] ✅    ✅ Data merged successfully
[14:12:02] ✅    ✅ Order data extracted and validated
[14:12:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:12:02] [DOC: 9231461] ✅ Patient found in local cache: Gordonna Walker, ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:02] ✅    ✅ Existing patient found with ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:02] 🔄 
🔄 Step 6: Pushing order to API...
[14:12:02] [DOC: 9231461] ℹ️  Pushing order via API for patient ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:03] [DOC: 9231461] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:12:03] ❌    ❌ Failed to push order
[14:12:03] 🔄 
🔄 Step 7: Writing to CSV...
[14:12:03] [DOC: 9231461] ℹ️  Calculated age: 71 from DOB: 02/21/1954
[14:12:03] [DOC: 9231461] ℹ️  Service Line extracted: 'PT'
[14:12:03] [DOC: 9231461] ℹ️  Payer Source extracted: ''
[14:12:03] [DOC: 9231461] ℹ️  Diagnosis codes being written:
[14:12:03] [DOC: 9231461] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:12:03] [DOC: 9231461] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:12:03] [DOC: 9231461] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:12:03] [DOC: 9231461] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:12:03] [DOC: 9231461] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:12:03] [DOC: 9231461] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:12:03] [DOC: 9231461] ✅ Patient data written to CSV: Gordonna Walker | Sex: FEMALE | Age: 71 | Service: PT | Payer:  | MRN: MA241007025405
[14:12:03] ✅    ✅ Document 9231461 processed and saved successfully
[14:12:03] 🔄 
🔄 Step 8: Saving API details...
[14:12:03] [DOC: 9231461] ℹ️  API push details saved for document 9231461
[14:12:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231458                         ║
================================================================================
[14:12:03] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:12:03] ℹ️  Date: 04/09/2025
[14:12:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:12:05] [DOC: 9231458] ✅ Text extracted using pdfplumber (1388 chars)
[14:12:05] ✅    ✅ Text extracted using pdfplumber (1388 chars)
[14:12:05] 🔄 
🔄 Step 2: Extracting patient data...
[14:12:08] ℹ️  AI extracted raw sex value: ''
[14:12:08] ℹ️  AI extracted service line: 'Physical Therapy'
[14:12:08] ℹ️  AI extracted payer source: ''
[14:12:08] ℹ️  AI extracted diagnoses:
[14:12:08] ℹ️    - Diagnosis 1: 'G20.A1'
[14:12:08] ℹ️    - Diagnosis 2: 'I11.9'
[14:12:08] ℹ️    - Diagnosis 3: 'E11.40'
[14:12:08] ℹ️    - Diagnosis 4: ''
[14:12:08] ℹ️    - Diagnosis 5: ''
[14:12:08] ℹ️    - Diagnosis 6: ''
[14:12:08] ℹ️  Final extracted MRN: 'MA241007025405'
[14:12:08] ℹ️  Final extracted Sex: ''
[14:12:08] ℹ️  Final extracted Service Line: 'Physical Therapy'
[14:12:08] ℹ️  Final extracted Payer Source: ''
[14:12:08] ✅ Patient data extraction completed successfully
[14:12:08] ✅    ✅ Patient data extracted successfully
[14:12:08] 📊 Patient Response
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:12:08] ✅    ✅ Patient identified: Gordonna Walker
[14:12:08] ✅    ✅ Patient name validation passed
[14:12:08] 🔄 
🔄 Step 3: Processing patient dates...
[14:12:08] [DOC: 9231458] ℹ️  DOB normalized: 02/21/1954
[14:12:08] [DOC: 9231458] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[14:12:08] [DOC: 9231458] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[14:12:08] [DOC: 9231458] ✅ Patient date processing completed successfully
[14:12:08] ✅    ✅ Date processing completed
[14:12:08] 📊 Processed Patient Data
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:12:08] 🔄 
🔄 Step 4: Extracting order data...
[14:12:11] ℹ️  Order extraction - MRN: 'MA241007025405'
[14:12:11] ℹ️  Order extraction - Sex: ''
[14:12:11] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[14:12:11] ℹ️  Order extraction - Payer Source: ''
[14:12:11] ✅ Order data extraction completed successfully
[14:12:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:12:11] ℹ️  Using MRN from patient data: 'MA241007025405' over 'MA241007025405'
[14:12:11] ⚠️  Could not determine sex using any available method
[14:12:11] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[14:12:11] ✅ Patient name cross-validation successful
[14:12:11] ✅    ✅ Data merged successfully
[14:12:12] ✅    ✅ Order data extracted and validated
[14:12:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:12:12] [DOC: 9231458] ✅ Patient found in local cache: Gordonna Walker, ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:12] ✅    ✅ Existing patient found with ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:12] 🔄 
🔄 Step 6: Pushing order to API...
[14:12:12] [DOC: 9231458] ℹ️  Pushing order via API for patient ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:13] [DOC: 9231458] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14407"}
[14:12:13] ❌    ❌ Failed to push order
[14:12:13] 🔄 
🔄 Step 7: Writing to CSV...
[14:12:13] [DOC: 9231458] ℹ️  Calculated age: 71 from DOB: 02/21/1954
[14:12:13] [DOC: 9231458] ℹ️  Service Line extracted: 'Physical Therapy'
[14:12:13] [DOC: 9231458] ℹ️  Payer Source extracted: ''
[14:12:13] [DOC: 9231458] ℹ️  Diagnosis codes being written:
[14:12:13] [DOC: 9231458] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[14:12:13] [DOC: 9231458] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.9'
[14:12:13] [DOC: 9231458] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.40'
[14:12:13] [DOC: 9231458] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:12:13] [DOC: 9231458] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:12:13] [DOC: 9231458] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:12:13] [DOC: 9231458] ✅ Patient data written to CSV: Gordonna Walker | Sex:  | Age: 71 | Service: Physical Therapy | Payer:  | MRN: MA241007025405
[14:12:13] ✅    ✅ Document 9231458 processed and saved successfully
[14:12:13] 🔄 
🔄 Step 8: Saving API details...
[14:12:13] [DOC: 9231458] ℹ️  API push details saved for document 9231458
[14:12:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231456                         ║
================================================================================
[14:12:13] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:12:13] ℹ️  Date: 04/09/2025
[14:12:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:12:15] [DOC: 9231456] ✅ Text extracted using pdfplumber (1490 chars)
[14:12:15] ✅    ✅ Text extracted using pdfplumber (1490 chars)
[14:12:15] 🔄 
🔄 Step 2: Extracting patient data...
[14:12:18] ℹ️  AI extracted raw sex value: ''
[14:12:18] ℹ️  AI extracted service line: 'Occupational Therapy'
[14:12:18] ℹ️  AI extracted payer source: ''
[14:12:18] ℹ️  AI extracted diagnoses:
[14:12:18] ℹ️    - Diagnosis 1: 'G20.A1'
[14:12:18] ℹ️    - Diagnosis 2: 'I11.9'
[14:12:18] ℹ️    - Diagnosis 3: 'E11.40'
[14:12:18] ℹ️    - Diagnosis 4: ''
[14:12:18] ℹ️    - Diagnosis 5: ''
[14:12:18] ℹ️    - Diagnosis 6: ''
[14:12:18] ℹ️  Final extracted MRN: 'MA241007025405'
[14:12:18] ℹ️  Final extracted Sex: ''
[14:12:18] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[14:12:18] ℹ️  Final extracted Payer Source: ''
[14:12:18] ✅ Patient data extraction completed successfully
[14:12:18] ✅    ✅ Patient data extracted successfully
[14:12:18] 📊 Patient Response
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:12:18] ✅    ✅ Patient identified: Gordonna Walker
[14:12:18] ✅    ✅ Patient name validation passed
[14:12:18] 🔄 
🔄 Step 3: Processing patient dates...
[14:12:18] [DOC: 9231456] ℹ️  DOB normalized: 02/21/1954
[14:12:18] [DOC: 9231456] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[14:12:18] [DOC: 9231456] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[14:12:18] [DOC: 9231456] ✅ Patient date processing completed successfully
[14:12:18] ✅    ✅ Date processing completed
[14:12:18] 📊 Processed Patient Data
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:12:18] 🔄 
🔄 Step 4: Extracting order data...
[14:12:20] ℹ️  Order extraction - MRN: 'MA241007025405'
[14:12:20] ℹ️  Order extraction - Sex: ''
[14:12:20] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[14:12:20] ℹ️  Order extraction - Payer Source: ''
[14:12:20] ✅ Order data extraction completed successfully
[14:12:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:12:20] ℹ️  Using MRN from patient data: 'MA241007025405' over 'MA241007025405'
[14:12:20] ⚠️  Could not determine sex using any available method
[14:12:20] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[14:12:20] ✅ Patient name cross-validation successful
[14:12:20] ✅    ✅ Data merged successfully
[14:12:22] ✅    ✅ Order data extracted and validated
[14:12:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:12:22] [DOC: 9231456] ✅ Patient found in local cache: Gordonna Walker, ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:22] ✅    ✅ Existing patient found with ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:22] 🔄 
🔄 Step 6: Pushing order to API...
[14:12:22] [DOC: 9231456] ℹ️  Pushing order via API for patient ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:23] [DOC: 9231456] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14409"}
[14:12:23] ❌    ❌ Failed to push order
[14:12:23] 🔄 
🔄 Step 7: Writing to CSV...
[14:12:23] [DOC: 9231456] ℹ️  Calculated age: 71 from DOB: 02/21/1954
[14:12:23] [DOC: 9231456] ℹ️  Service Line extracted: 'Occupational Therapy'
[14:12:23] [DOC: 9231456] ℹ️  Payer Source extracted: ''
[14:12:23] [DOC: 9231456] ℹ️  Diagnosis codes being written:
[14:12:23] [DOC: 9231456] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[14:12:23] [DOC: 9231456] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.9'
[14:12:23] [DOC: 9231456] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.40'
[14:12:23] [DOC: 9231456] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:12:23] [DOC: 9231456] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:12:23] [DOC: 9231456] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:12:23] [DOC: 9231456] ✅ Patient data written to CSV: Gordonna Walker | Sex:  | Age: 71 | Service: Occupational Therapy | Payer:  | MRN: MA241007025405
[14:12:23] ✅    ✅ Document 9231456 processed and saved successfully
[14:12:23] 🔄 
🔄 Step 8: Saving API details...
[14:12:23] [DOC: 9231456] ℹ️  API push details saved for document 9231456
[14:12:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231449                         ║
================================================================================
[14:12:23] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:12:23] ℹ️  Date: 04/09/2025
[14:12:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:12:25] [DOC: 9231449] ✅ Text extracted using pdfplumber (1438 chars)
[14:12:25] ✅    ✅ Text extracted using pdfplumber (1438 chars)
[14:12:25] 🔄 
🔄 Step 2: Extracting patient data...
[14:12:28] ℹ️  AI extracted raw sex value: ''
[14:12:28] ℹ️  AI extracted service line: 'HHA'
[14:12:28] ℹ️  AI extracted payer source: ''
[14:12:28] ℹ️  AI extracted diagnoses:
[14:12:28] ℹ️    - Diagnosis 1: 'G20.A1'
[14:12:28] ℹ️    - Diagnosis 2: 'I11.9'
[14:12:28] ℹ️    - Diagnosis 3: 'E11.40'
[14:12:28] ℹ️    - Diagnosis 4: ''
[14:12:28] ℹ️    - Diagnosis 5: ''
[14:12:28] ℹ️    - Diagnosis 6: ''
[14:12:28] ℹ️  Final extracted MRN: 'MA241007025405'
[14:12:28] ℹ️  Final extracted Sex: ''
[14:12:28] ℹ️  Final extracted Service Line: 'HHA'
[14:12:28] ℹ️  Final extracted Payer Source: ''
[14:12:28] ✅ Patient data extraction completed successfully
[14:12:28] ✅    ✅ Patient data extracted successfully
[14:12:28] 📊 Patient Response
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:12:28] ✅    ✅ Patient identified: Gordonna Walker
[14:12:28] ✅    ✅ Patient name validation passed
[14:12:28] 🔄 
🔄 Step 3: Processing patient dates...
[14:12:28] [DOC: 9231449] ℹ️  DOB normalized: 02/21/1954
[14:12:28] [DOC: 9231449] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[14:12:28] [DOC: 9231449] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[14:12:28] [DOC: 9231449] ✅ Patient date processing completed successfully
[14:12:28] ✅    ✅ Date processing completed
[14:12:28] 📊 Processed Patient Data
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:12:28] 🔄 
🔄 Step 4: Extracting order data...
[14:12:31] ℹ️  Order extraction - MRN: 'MA241007025405'
[14:12:31] ℹ️  Order extraction - Sex: ''
[14:12:31] ℹ️  Order extraction - Service Line: 'HHA'
[14:12:31] ℹ️  Order extraction - Payer Source: ''
[14:12:31] ✅ Order data extraction completed successfully
[14:12:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:12:31] ℹ️  Using MRN from patient data: 'MA241007025405' over 'MA241007025405'
[14:12:31] ⚠️  Could not determine sex using any available method
[14:12:31] ℹ️  Service line consistent in both sources: 'HHA'
[14:12:31] ✅ Patient name cross-validation successful
[14:12:31] ✅    ✅ Data merged successfully
[14:12:32] ✅    ✅ Order data extracted and validated
[14:12:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:12:32] [DOC: 9231449] ✅ Patient found in local cache: Gordonna Walker, ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:32] ✅    ✅ Existing patient found with ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:32] 🔄 
🔄 Step 6: Pushing order to API...
[14:12:32] [DOC: 9231449] ℹ️  Pushing order via API for patient ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:35] [DOC: 9231449] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14411"}
[14:12:35] ❌    ❌ Failed to push order
[14:12:35] 🔄 
🔄 Step 7: Writing to CSV...
[14:12:35] [DOC: 9231449] ℹ️  Calculated age: 71 from DOB: 02/21/1954
[14:12:35] [DOC: 9231449] ℹ️  Service Line extracted: 'HHA'
[14:12:35] [DOC: 9231449] ℹ️  Payer Source extracted: ''
[14:12:35] [DOC: 9231449] ℹ️  Diagnosis codes being written:
[14:12:35] [DOC: 9231449] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[14:12:35] [DOC: 9231449] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.9'
[14:12:35] [DOC: 9231449] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.40'
[14:12:35] [DOC: 9231449] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:12:35] [DOC: 9231449] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:12:35] [DOC: 9231449] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:12:35] [DOC: 9231449] ✅ Patient data written to CSV: Gordonna Walker | Sex:  | Age: 71 | Service: HHA | Payer:  | MRN: MA241007025405
[14:12:35] ✅    ✅ Document 9231449 processed and saved successfully
[14:12:35] 🔄 
🔄 Step 8: Saving API details...
[14:12:35] [DOC: 9231449] ℹ️  API push details saved for document 9231449
[14:12:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231445                         ║
================================================================================
[14:12:35] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:12:35] ℹ️  Date: 04/09/2025
[14:12:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:12:38] [DOC: 9231445] ✅ Text extracted using pdfplumber (13050 chars)
[14:12:38] ✅    ✅ Text extracted using pdfplumber (13050 chars)
[14:12:38] 🔄 
🔄 Step 2: Extracting patient data...
[14:12:41] ℹ️  AI extracted raw sex value: ''
[14:12:41] ℹ️  AI extracted service line: 'OT'
[14:12:41] ℹ️  AI extracted payer source: ''
[14:12:41] ℹ️  AI extracted diagnoses:
[14:12:41] ℹ️    - Diagnosis 1: ''
[14:12:41] ℹ️    - Diagnosis 2: ''
[14:12:41] ℹ️    - Diagnosis 3: ''
[14:12:41] ℹ️    - Diagnosis 4: ''
[14:12:41] ℹ️    - Diagnosis 5: ''
[14:12:41] ℹ️    - Diagnosis 6: ''
[14:12:41] ℹ️  Final extracted MRN: 'MA241007025405'
[14:12:41] ℹ️  Final extracted Sex: ''
[14:12:41] ℹ️  Final extracted Service Line: 'OT'
[14:12:41] ℹ️  Final extracted Payer Source: ''
[14:12:41] ✅ Patient data extraction completed successfully
[14:12:41] ✅    ✅ Patient data extracted successfully
[14:12:41] 📊 Patient Response
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:12:41] ✅    ✅ Patient identified: Gordonna Walker
[14:12:41] ✅    ✅ Patient name validation passed
[14:12:41] 🔄 
🔄 Step 3: Processing patient dates...
[14:12:41] [DOC: 9231445] ℹ️  DOB normalized: 02/21/1954
[14:12:41] [DOC: 9231445] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[14:12:41] [DOC: 9231445] ✅ Patient date processing completed successfully
[14:12:41] ✅    ✅ Date processing completed
[14:12:41] 📊 Processed Patient Data
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: Dr. Shih, David J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:12:41] 🔄 
🔄 Step 4: Extracting order data...
[14:12:44] ℹ️  Order extraction - MRN: 'MA241007025405'
[14:12:44] ℹ️  Order extraction - Sex: ''
[14:12:44] ℹ️  Order extraction - Service Line: 'OT'
[14:12:44] ℹ️  Order extraction - Payer Source: ''
[14:12:44] ✅ Order data extraction completed successfully
[14:12:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:12:44] ℹ️  Using MRN from patient data: 'MA241007025405' over 'MA241007025405'
[14:12:44] ⚠️  Could not determine sex using any available method
[14:12:44] ℹ️  Service line consistent in both sources: 'OT'
[14:12:44] ✅ Patient name cross-validation successful
[14:12:44] ✅    ✅ Data merged successfully
[14:12:45] ✅    ✅ Order data extracted and validated
[14:12:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:12:45] [DOC: 9231445] ✅ Patient found in local cache: Gordonna Walker, ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:45] ✅    ✅ Existing patient found with ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:45] 🔄 
🔄 Step 6: Pushing order to API...
[14:12:45] [DOC: 9231445] ℹ️  Pushing order via API for patient ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:46] [DOC: 9231445] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:12:46] ❌    ❌ Failed to push order
[14:12:46] 🔄 
🔄 Step 7: Writing to CSV...
[14:12:46] [DOC: 9231445] ℹ️  Calculated age: 71 from DOB: 02/21/1954
[14:12:46] [DOC: 9231445] ℹ️  Service Line extracted: 'OT'
[14:12:46] [DOC: 9231445] ℹ️  Payer Source extracted: ''
[14:12:46] [DOC: 9231445] ℹ️  Diagnosis codes being written:
[14:12:46] [DOC: 9231445] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:12:46] [DOC: 9231445] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:12:46] [DOC: 9231445] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:12:46] [DOC: 9231445] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:12:46] [DOC: 9231445] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:12:46] [DOC: 9231445] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:12:46] [DOC: 9231445] ✅ Patient data written to CSV: Gordonna Walker | Sex:  | Age: 71 | Service: OT | Payer:  | MRN: MA241007025405
[14:12:46] ✅    ✅ Document 9231445 processed and saved successfully
[14:12:46] 🔄 
🔄 Step 8: Saving API details...
[14:12:46] [DOC: 9231445] ℹ️  API push details saved for document 9231445
[14:12:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231442                         ║
================================================================================
[14:12:46] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:12:46] ℹ️  Date: 04/09/2025
[14:12:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:12:49] [DOC: 9231442] ✅ Text extracted using pdfplumber (1233 chars)
[14:12:49] ✅    ✅ Text extracted using pdfplumber (1233 chars)
[14:12:49] 🔄 
🔄 Step 2: Extracting patient data...
[14:12:52] ℹ️  AI extracted raw sex value: ''
[14:12:52] ℹ️  AI extracted service line: ''
[14:12:52] ℹ️  AI extracted payer source: ''
[14:12:52] ℹ️  AI extracted diagnoses:
[14:12:52] ℹ️    - Diagnosis 1: 'G20.A1'
[14:12:52] ℹ️    - Diagnosis 2: 'I11.9'
[14:12:52] ℹ️    - Diagnosis 3: 'E11.40'
[14:12:52] ℹ️    - Diagnosis 4: ''
[14:12:52] ℹ️    - Diagnosis 5: ''
[14:12:52] ℹ️    - Diagnosis 6: ''
[14:12:52] ℹ️  Final extracted MRN: 'MA241007025405'
[14:12:52] ℹ️  Final extracted Sex: ''
[14:12:52] ℹ️  Final extracted Service Line: ''
[14:12:52] ℹ️  Final extracted Payer Source: ''
[14:12:52] ✅ Patient data extraction completed successfully
[14:12:52] ✅    ✅ Patient data extracted successfully
[14:12:52] 📊 Patient Response
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:12:52] ✅    ✅ Patient identified: Gordonna Walker
[14:12:52] ✅    ✅ Patient name validation passed
[14:12:52] 🔄 
🔄 Step 3: Processing patient dates...
[14:12:52] [DOC: 9231442] ℹ️  DOB normalized: 02/21/1954
[14:12:52] [DOC: 9231442] ℹ️  Episode startOfCare normalized: 03/24/2025
[14:12:52] [DOC: 9231442] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[14:12:52] [DOC: 9231442] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[14:12:52] [DOC: 9231442] ✅ Patient date processing completed successfully
[14:12:52] ✅    ✅ Date processing completed
[14:12:52] 📊 Processed Patient Data
     └─ patientFName: Gordonna
     └─ patientLName: Walker
     └─ dob: 02/21/1954
     └─ patientSex: 
     └─ medicalRecordNo: MA241007025405
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I11.9', 'thirdDiagnosis': 'E11.40', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:12:52] 🔄 
🔄 Step 4: Extracting order data...
[14:12:54] ℹ️  Order extraction - MRN: 'MA241007025405'
[14:12:54] ℹ️  Order extraction - Sex: ''
[14:12:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:12:54] ℹ️  Order extraction - Payer Source: ''
[14:12:54] ✅ Order data extraction completed successfully
[14:12:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:12:54] ℹ️  Using MRN from patient data: 'MA241007025405' over 'MA241007025405'
[14:12:54] ⚠️  Could not determine sex using any available method
[14:12:54] ℹ️  Using service line from order data: 'Skilled Nursing'
[14:12:54] ✅ Patient name cross-validation successful
[14:12:54] ✅    ✅ Data merged successfully
[14:12:55] ✅    ✅ Order data extracted and validated
[14:12:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:12:55] [DOC: 9231442] ✅ Patient found in local cache: Gordonna Walker, ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:55] ✅    ✅ Existing patient found with ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:55] 🔄 
🔄 Step 6: Pushing order to API...
[14:12:55] [DOC: 9231442] ℹ️  Pushing order via API for patient ID: 8465c52c-fe9b-42f1-aff0-4b3dc61df1d3
[14:12:57] [DOC: 9231442] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14412"}
[14:12:57] ❌    ❌ Failed to push order
[14:12:57] 🔄 
🔄 Step 7: Writing to CSV...
[14:12:57] [DOC: 9231442] ℹ️  Calculated age: 71 from DOB: 02/21/1954
[14:12:57] [DOC: 9231442] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:12:57] [DOC: 9231442] ℹ️  Payer Source extracted: ''
[14:12:57] [DOC: 9231442] ℹ️  Diagnosis codes being written:
[14:12:57] [DOC: 9231442] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[14:12:57] [DOC: 9231442] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.9'
[14:12:57] [DOC: 9231442] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.40'
[14:12:57] [DOC: 9231442] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:12:57] [DOC: 9231442] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:12:57] [DOC: 9231442] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:12:57] [DOC: 9231442] ✅ Patient data written to CSV: Gordonna Walker | Sex:  | Age: 71 | Service: Skilled Nursing | Payer:  | MRN: MA241007025405
[14:12:57] ✅    ✅ Document 9231442 processed and saved successfully
[14:12:57] 🔄 
🔄 Step 8: Saving API details...
[14:12:57] [DOC: 9231442] ℹ️  API push details saved for document 9231442
[14:12:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231355                         ║
================================================================================
[14:12:57] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:12:57] ℹ️  Date: 04/09/2025
[14:12:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:12:59] [DOC: 9231355] ✅ Text extracted using pdfplumber (1463 chars)
[14:12:59] ✅    ✅ Text extracted using pdfplumber (1451 chars)
[14:12:59] 🔄 
🔄 Step 2: Extracting patient data...
[14:13:02] ℹ️  AI extracted raw sex value: ''
[14:13:02] ℹ️  AI extracted service line: 'Occupational Therapy'
[14:13:02] ℹ️  AI extracted payer source: ''
[14:13:02] ℹ️  AI extracted diagnoses:
[14:13:02] ℹ️    - Diagnosis 1: 'L03.116'
[14:13:02] ℹ️    - Diagnosis 2: 'B96.5'
[14:13:02] ℹ️    - Diagnosis 3: 'E11.51'
[14:13:02] ℹ️    - Diagnosis 4: 'None'
[14:13:02] ℹ️    - Diagnosis 5: 'None'
[14:13:02] ℹ️    - Diagnosis 6: 'None'
[14:13:02] ℹ️  Final extracted MRN: 'MA221025055606'
[14:13:02] ℹ️  Final extracted Sex: ''
[14:13:02] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[14:13:02] ℹ️  Final extracted Payer Source: ''
[14:13:02] ✅ Patient data extraction completed successfully
[14:13:02] ✅    ✅ Patient data extracted successfully
[14:13:02] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Santos
     └─ dob: 05/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221025055606
     └─ billingProvider: Ahmet Dirican MD
     └─ npi: 1396723813
     └─ physicianNPI: 1396723813
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'L03.116', 'secondDiagnosis': 'B96.5', 'thirdDiagnosis': 'E11.51', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:13:02] ✅    ✅ Patient identified: Donald Santos
[14:13:02] ✅    ✅ Patient name validation passed
[14:13:02] 🔄 
🔄 Step 3: Processing patient dates...
[14:13:02] [DOC: 9231355] ℹ️  DOB normalized: 05/04/1956
[14:13:02] [DOC: 9231355] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[14:13:02] [DOC: 9231355] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[14:13:02] [DOC: 9231355] ✅ Patient date processing completed successfully
[14:13:02] ✅    ✅ Date processing completed
[14:13:02] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Santos
     └─ dob: 05/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221025055606
     └─ billingProvider: Ahmet Dirican MD
     └─ npi: 1396723813
     └─ physicianNPI: 1396723813
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'L03.116', 'secondDiagnosis': 'B96.5', 'thirdDiagnosis': 'E11.51'}]
[14:13:02] 🔄 
🔄 Step 4: Extracting order data...
[14:13:05] ℹ️  Order extraction - MRN: 'MA221025055606'
[14:13:05] ℹ️  Order extraction - Sex: ''
[14:13:05] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[14:13:05] ℹ️  Order extraction - Payer Source: ''
[14:13:05] ✅ Order data extraction completed successfully
[14:13:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:13:05] ℹ️  Using MRN from patient data: 'MA221025055606' over 'MA221025055606'
[14:13:05] ℹ️  Inferred sex as MALE from name: Donald
[14:13:05] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[14:13:05] ✅ Patient name cross-validation successful
[14:13:05] ✅    ✅ Data merged successfully
[14:13:06] ✅    ✅ Order data extracted and validated
[14:13:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:13:06] [DOC: 9231355] ✅ Patient found in local cache: Donald Santos, ID: 598d9260-7728-4455-8713-61626ca9d576
[14:13:06] ✅    ✅ Existing patient found with ID: 598d9260-7728-4455-8713-61626ca9d576
[14:13:06] 🔄 
🔄 Step 6: Pushing order to API...
[14:13:06] [DOC: 9231355] ℹ️  Pushing order via API for patient ID: 598d9260-7728-4455-8713-61626ca9d576
[14:13:07] [DOC: 9231355] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14376"}
[14:13:07] ❌    ❌ Failed to push order
[14:13:07] 🔄 
🔄 Step 7: Writing to CSV...
[14:13:07] [DOC: 9231355] ℹ️  Calculated age: 69 from DOB: 05/04/1956
[14:13:07] [DOC: 9231355] ℹ️  Service Line extracted: 'Occupational Therapy'
[14:13:07] [DOC: 9231355] ℹ️  Payer Source extracted: ''
[14:13:07] [DOC: 9231355] ℹ️  Diagnosis codes being written:
[14:13:07] [DOC: 9231355] ℹ️    - Latest_Episode_Firstdiagnosis: 'L03.116'
[14:13:07] [DOC: 9231355] ℹ️    - Latest_Episode_Seconddiagnosis: 'B96.5'
[14:13:07] [DOC: 9231355] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.51'
[14:13:07] [DOC: 9231355] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:13:07] [DOC: 9231355] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:13:07] [DOC: 9231355] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:13:07] [DOC: 9231355] ✅ Patient data written to CSV: Donald Santos | Sex: MALE | Age: 69 | Service: Occupational Therapy | Payer:  | MRN: MA221025055606
[14:13:07] ✅    ✅ Document 9231355 processed and saved successfully
[14:13:07] 🔄 
🔄 Step 8: Saving API details...
[14:13:07] [DOC: 9231355] ℹ️  API push details saved for document 9231355
[14:13:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231352                         ║
================================================================================
[14:13:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:13:07] ℹ️  Date: 04/09/2025
[14:13:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:13:10] [DOC: 9231352] ✅ Text extracted using pdfplumber (10445 chars)
[14:13:10] ✅    ✅ Text extracted using pdfplumber (10433 chars)
[14:13:10] 🔄 
🔄 Step 2: Extracting patient data...
[14:13:13] ℹ️  AI extracted raw sex value: 'M'
[14:13:13] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:13:13] ℹ️  AI extracted payer source: 'Medicare'
[14:13:13] ℹ️  AI extracted diagnoses:
[14:13:13] ℹ️    - Diagnosis 1: 'L03.116'
[14:13:13] ℹ️    - Diagnosis 2: 'B96.5'
[14:13:13] ℹ️    - Diagnosis 3: 'E11.51'
[14:13:13] ℹ️    - Diagnosis 4: 'I70.242'
[14:13:13] ℹ️    - Diagnosis 5: 'None'
[14:13:13] ℹ️    - Diagnosis 6: 'None'
[14:13:13] ℹ️  Final extracted MRN: 'MA221025055606'
[14:13:13] ℹ️  Final extracted Sex: 'MALE'
[14:13:13] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:13:13] ℹ️  Final extracted Payer Source: 'Medicare'
[14:13:13] ✅ Patient data extraction completed successfully
[14:13:13] ✅    ✅ Patient data extracted successfully
[14:13:13] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Santos
     └─ dob: 05/04/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: MA221025055606
     └─ billingProvider: Dirican, Ahmet MD
     └─ npi: 1396723813
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 251 Walnut St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 994-3120
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/03/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'L03.116', 'secondDiagnosis': 'B96.5', 'thirdDiagnosis': 'E11.51', 'fourthDiagnosis': 'I70.242', 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:13:13] ✅    ✅ Patient identified: Donald Santos
[14:13:13] ✅    ✅ Patient name validation passed
[14:13:13] 🔄 
🔄 Step 3: Processing patient dates...
[14:13:13] [DOC: 9231352] ℹ️  DOB normalized: 05/04/1956
[14:13:13] [DOC: 9231352] ℹ️  Episode startOfCare normalized: 02/03/2025
[14:13:13] [DOC: 9231352] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[14:13:13] [DOC: 9231352] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[14:13:13] [DOC: 9231352] ✅ Patient date processing completed successfully
[14:13:13] ✅    ✅ Date processing completed
[14:13:13] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Santos
     └─ dob: 05/04/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: MA221025055606
     └─ billingProvider: Dirican, Ahmet MD
     └─ npi: 1396723813
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 251 Walnut St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 994-3120
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/03/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'L03.116', 'secondDiagnosis': 'B96.5', 'thirdDiagnosis': 'E11.51', 'fourthDiagnosis': 'I70.242'}]
[14:13:13] 🔄 
🔄 Step 4: Extracting order data...
[14:13:16] ℹ️  Order extraction - MRN: 'MA221025055606'
[14:13:16] ℹ️  Order extraction - Sex: 'MALE'
[14:13:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:13:16] ℹ️  Order extraction - Payer Source: 'Medicare'
[14:13:16] ✅ Order data extraction completed successfully
[14:13:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:13:16] ℹ️  Using MRN from patient data: 'MA221025055606' over 'MA221025055606'
[14:13:16] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:13:16] ℹ️  Payer source consistent in both sources: 'Medicare'
[14:13:16] ✅ Patient name cross-validation successful
[14:13:16] ✅    ✅ Data merged successfully
[14:13:17] ✅    ✅ Order data extracted and validated
[14:13:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:13:17] [DOC: 9231352] ✅ Patient found in local cache: Donald Santos, ID: 598d9260-7728-4455-8713-61626ca9d576
[14:13:17] ✅    ✅ Existing patient found with ID: 598d9260-7728-4455-8713-61626ca9d576
[14:13:17] 🔄 
🔄 Step 6: Pushing order to API...
[14:13:17] [DOC: 9231352] ℹ️  Pushing order via API for patient ID: 598d9260-7728-4455-8713-61626ca9d576
[14:13:19] [DOC: 9231352] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14378"}
[14:13:19] ❌    ❌ Failed to push order
[14:13:19] 🔄 
🔄 Step 7: Writing to CSV...
[14:13:19] [DOC: 9231352] ℹ️  Calculated age: 69 from DOB: 05/04/1956
[14:13:19] [DOC: 9231352] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[14:13:19] [DOC: 9231352] ℹ️  Payer Source extracted: 'Medicare'
[14:13:19] [DOC: 9231352] ℹ️  Diagnosis codes being written:
[14:13:19] [DOC: 9231352] ℹ️    - Latest_Episode_Firstdiagnosis: 'L03.116'
[14:13:19] [DOC: 9231352] ℹ️    - Latest_Episode_Seconddiagnosis: 'B96.5'
[14:13:19] [DOC: 9231352] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.51'
[14:13:19] [DOC: 9231352] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I70.242'
[14:13:19] [DOC: 9231352] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:13:19] [DOC: 9231352] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:13:19] [DOC: 9231352] ✅ Patient data written to CSV: Donald Santos | Sex: MALE | Age: 69 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: MA221025055606
[14:13:19] ✅    ✅ Document 9231352 processed and saved successfully
[14:13:19] 🔄 
🔄 Step 8: Saving API details...
[14:13:19] [DOC: 9231352] ℹ️  API push details saved for document 9231352
[14:13:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231350                         ║
================================================================================
[14:13:19] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[14:13:19] ℹ️  Date: 04/09/2025
[14:13:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:13:24] [DOC: 9231350] ✅ Text extracted using pdfplumber (14734 chars)
[14:13:24] ✅    ✅ Text extracted using pdfplumber (14734 chars)
[14:13:24] 🔄 
🔄 Step 2: Extracting patient data...
[14:13:27] ℹ️  AI extracted raw sex value: ''
[14:13:27] ℹ️  AI extracted service line: 'OT'
[14:13:27] ℹ️  AI extracted payer source: ''
[14:13:27] ℹ️  AI extracted diagnoses:
[14:13:27] ℹ️    - Diagnosis 1: 'LLE cellulitis'
[14:13:27] ℹ️    - Diagnosis 2: 'bradycardia'
[14:13:27] ℹ️    - Diagnosis 3: ''
[14:13:27] ℹ️    - Diagnosis 4: ''
[14:13:27] ℹ️    - Diagnosis 5: ''
[14:13:27] ℹ️    - Diagnosis 6: ''
[14:13:27] ℹ️  Final extracted MRN: 'MA221025055606'
[14:13:27] ℹ️  Final extracted Sex: ''
[14:13:27] ℹ️  Final extracted Service Line: 'OT'
[14:13:27] ℹ️  Final extracted Payer Source: ''
[14:13:27] ✅ Patient data extraction completed successfully
[14:13:27] ✅    ✅ Patient data extracted successfully
[14:13:27] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Santos
     └─ dob: 05/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221025055606
     └─ billingProvider: DIAS-REGUS, MARY R. NP
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '', 'firstDiagnosis': 'LLE cellulitis', 'secondDiagnosis': 'bradycardia', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:13:27] ✅    ✅ Patient identified: Donald Santos
[14:13:27] ✅    ✅ Patient name validation passed
[14:13:27] 🔄 
🔄 Step 3: Processing patient dates...
[14:13:27] [DOC: 9231350] ℹ️  DOB normalized: 05/04/1956
[14:13:27] [DOC: 9231350] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[14:13:27] [DOC: 9231350] ✅ Patient date processing completed successfully
[14:13:27] ✅    ✅ Date processing completed
[14:13:27] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Santos
     └─ dob: 05/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221025055606
     └─ billingProvider: DIAS-REGUS, MARY R. NP
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '', 'firstDiagnosis': 'LLE cellulitis', 'secondDiagnosis': 'bradycardia', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:13:27] 🔄 
🔄 Step 4: Extracting order data...
[14:13:30] ℹ️  Order extraction - MRN: 'MA221025055606'
[14:13:30] ℹ️  Order extraction - Sex: ''
[14:13:30] ℹ️  Order extraction - Service Line: 'OT'
[14:13:30] ℹ️  Order extraction - Payer Source: ''
[14:13:30] ✅ Order data extraction completed successfully
[14:13:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:13:30] ℹ️  Using MRN from patient data: 'MA221025055606' over 'MA221025055606'
[14:13:30] ℹ️  Inferred sex as MALE from name: Donald
[14:13:30] ℹ️  Service line consistent in both sources: 'OT'
[14:13:30] ✅ Patient name cross-validation successful
[14:13:30] ✅    ✅ Data merged successfully
[14:13:31] ✅    ✅ Order data extracted and validated
[14:13:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:13:31] [DOC: 9231350] ✅ Patient found in local cache: Donald Santos, ID: 598d9260-7728-4455-8713-61626ca9d576
[14:13:31] ✅    ✅ Existing patient found with ID: 598d9260-7728-4455-8713-61626ca9d576
[14:13:31] 🔄 
🔄 Step 6: Pushing order to API...
[14:13:31] [DOC: 9231350] ℹ️  Pushing order via API for patient ID: 598d9260-7728-4455-8713-61626ca9d576
[14:13:32] [DOC: 9231350] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:13:32] ❌    ❌ Failed to push order
[14:13:32] 🔄 
🔄 Step 7: Writing to CSV...
[14:13:32] [DOC: 9231350] ℹ️  Calculated age: 69 from DOB: 05/04/1956
[14:13:32] [DOC: 9231350] ℹ️  Service Line extracted: 'OT'
[14:13:32] [DOC: 9231350] ℹ️  Payer Source extracted: ''
[14:13:32] [DOC: 9231350] ℹ️  Diagnosis codes being written:
[14:13:32] [DOC: 9231350] ℹ️    - Latest_Episode_Firstdiagnosis: 'LLE cellulitis'
[14:13:32] [DOC: 9231350] ℹ️    - Latest_Episode_Seconddiagnosis: 'bradycardia'
[14:13:32] [DOC: 9231350] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:13:32] [DOC: 9231350] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:13:32] [DOC: 9231350] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:13:32] [DOC: 9231350] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:13:32] [DOC: 9231350] ✅ Patient data written to CSV: Donald Santos | Sex: MALE | Age: 69 | Service: OT | Payer:  | MRN: MA221025055606
[14:13:32] ✅    ✅ Document 9231350 processed and saved successfully
[14:13:32] 🔄 
🔄 Step 8: Saving API details...
[14:13:32] [DOC: 9231350] ℹ️  API push details saved for document 9231350
[14:13:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9231058                         ║
================================================================================
[14:13:32] ℹ️  Agency: Alphacare Home Health Agency
[14:13:32] ℹ️  Date: 04/09/2025
[14:13:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:13:47] [DOC: 9231058] ✅ Text extracted using pdfplumber (345 chars)
[14:13:47] ✅    ✅ Text extracted using pdfplumber (345 chars)
[14:13:47] 🔄 
🔄 Step 2: Extracting patient data...
[14:13:49] ℹ️  AI extracted raw sex value: ''
[14:13:49] ℹ️  AI extracted service line: ''
[14:13:49] ℹ️  AI extracted payer source: ''
[14:13:49] ℹ️  AI extracted diagnoses:
[14:13:49] ℹ️    - Diagnosis 1: ''
[14:13:49] ℹ️    - Diagnosis 2: ''
[14:13:49] ℹ️    - Diagnosis 3: ''
[14:13:49] ℹ️    - Diagnosis 4: ''
[14:13:49] ℹ️    - Diagnosis 5: ''
[14:13:49] ℹ️    - Diagnosis 6: ''
[14:13:49] ℹ️  Final extracted MRN: ''
[14:13:49] ℹ️  Final extracted Sex: ''
[14:13:49] ℹ️  Final extracted Service Line: ''
[14:13:49] ℹ️  Final extracted Payer Source: ''
[14:13:49] ✅ Patient data extraction completed successfully
[14:13:49] ✅    ✅ Patient data extracted successfully
[14:13:49] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Dr. Pothier, Jahn A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:13:49] ⚠️     ❌ Insufficient patient data extracted
[14:13:49] [DOC: 9231058] ℹ️  API push details saved for document 9231058
================================================================================
║                        Processing Document ID: 9230858                         ║
================================================================================
[14:13:49] ℹ️  Agency: Dartmouth HH
[14:13:49] ℹ️  Date: 04/09/2025
[14:13:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:13:57] [DOC: 9230858] ✅ Text extracted using pdfplumber (13404 chars)
[14:13:57] ✅    ✅ Text extracted using pdfplumber (13404 chars)
[14:13:57] 🔄 
🔄 Step 2: Extracting patient data...
[14:14:00] ℹ️  AI extracted raw sex value: 'M'
[14:14:00] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT, Diet'
[14:14:00] ℹ️  AI extracted payer source: ''
[14:14:00] ℹ️  AI extracted diagnoses:
[14:14:00] ℹ️    - Diagnosis 1: 'C18.7'
[14:14:00] ℹ️    - Diagnosis 2: 'C78.7'
[14:14:00] ℹ️    - Diagnosis 3: 'D61.818'
[14:14:00] ℹ️    - Diagnosis 4: 'E78.2'
[14:14:00] ℹ️    - Diagnosis 5: 'M47.812'
[14:14:00] ℹ️    - Diagnosis 6: 'N40.1'
[14:14:00] ℹ️  Final extracted MRN: '227027'
[14:14:00] ℹ️  Final extracted Sex: 'MALE'
[14:14:00] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT, Diet'
[14:14:00] ℹ️  Final extracted Payer Source: ''
[14:14:00] ✅ Patient data extraction completed successfully
[14:14:00] ✅    ✅ Patient data extracted successfully
[14:14:00] 📊 Patient Response
     └─ patientFName: Matias
     └─ patientLName: Joao
     └─ dob: 04/20/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, Diet
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'C18.7', 'secondDiagnosis': 'C78.7', 'thirdDiagnosis': 'D61.818', 'fourthDiagnosis': 'E78.2', 'fifthDiagnosis': 'M47.812', 'sixthDiagnosis': 'N40.1'}]
[14:14:00] ✅    ✅ Patient identified: Matias Joao
[14:14:00] ✅    ✅ Patient name validation passed
[14:14:00] 🔄 
🔄 Step 3: Processing patient dates...
[14:14:00] [DOC: 9230858] ℹ️  DOB normalized: 04/20/1954
[14:14:00] [DOC: 9230858] ℹ️  Episode startOfCare normalized: 03/26/2025
[14:14:00] [DOC: 9230858] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[14:14:00] [DOC: 9230858] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[14:14:00] [DOC: 9230858] ✅ Patient date processing completed successfully
[14:14:00] ✅    ✅ Date processing completed
[14:14:00] 📊 Processed Patient Data
     └─ patientFName: Matias
     └─ patientLName: Joao
     └─ dob: 04/20/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, Diet
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'C18.7', 'secondDiagnosis': 'C78.7', 'thirdDiagnosis': 'D61.818', 'fourthDiagnosis': 'E78.2', 'fifthDiagnosis': 'M47.812', 'sixthDiagnosis': 'N40.1'}]
[14:14:00] 🔄 
🔄 Step 4: Extracting order data...
[14:14:03] ℹ️  Order extraction - MRN: '227027'
[14:14:03] ℹ️  Order extraction - Sex: 'MALE'
[14:14:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT, Diet'
[14:14:03] ℹ️  Order extraction - Payer Source: ''
[14:14:03] ✅ Order data extraction completed successfully
[14:14:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:14:03] ℹ️  Using MRN from patient data: '227027' over '227027'
[14:14:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT, Diet'
[14:14:03] ✅ Patient name cross-validation successful
[14:14:03] ✅    ✅ Data merged successfully
[14:14:04] ✅    ✅ Order data extracted and validated
[14:14:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:14:43] [DOC: 9230858] ℹ️  Patient not found in cache or API: Matias Joao
[14:14:43] [DOC: 9230858] ℹ️  Patient not found, creating new patient via API...
[14:14:43] [DOC: 9230858] ℹ️  Creating patient via API: Matias Joao
[14:14:44] [DOC: 9230858] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:14:44] ❌    ❌ Failed to create patient
[14:14:44] [DOC: 9230858] ℹ️  API push details saved for document 9230858
================================================================================
║                        Processing Document ID: 9230844                         ║
================================================================================
[14:14:44] ℹ️  Agency: Dartmouth HH
[14:14:44] ℹ️  Date: 04/09/2025
[14:14:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:14:48] [DOC: 9230844] ✅ Text extracted using pdfplumber (11501 chars)
[14:14:48] ✅    ✅ Text extracted using pdfplumber (11489 chars)
[14:14:48] 🔄 
🔄 Step 2: Extracting patient data...
[14:14:51] ℹ️  AI extracted raw sex value: 'F'
[14:14:51] ℹ️  AI extracted service line: 'PT'
[14:14:51] ℹ️  AI extracted payer source: 'None'
[14:14:51] ℹ️  AI extracted diagnoses:
[14:14:51] ℹ️    - Diagnosis 1: 'Z47.1'
[14:14:51] ℹ️    - Diagnosis 2: 'M24.573'
[14:14:51] ℹ️    - Diagnosis 3: 'M79.672'
[14:14:51] ℹ️    - Diagnosis 4: 'M47.22'
[14:14:51] ℹ️    - Diagnosis 5: 'M51.26'
[14:14:51] ℹ️    - Diagnosis 6: 'M54.17'
[14:14:51] ℹ️  Final extracted MRN: '227027'
[14:14:51] ℹ️  Final extracted Sex: 'FEMALE'
[14:14:51] ℹ️  Final extracted Service Line: 'PT'
[14:14:51] ℹ️  Final extracted Payer Source: ''
[14:14:51] ✅ Patient data extraction completed successfully
[14:14:51] ✅    ✅ Patient data extracted successfully
[14:14:51] 📊 Patient Response
     └─ patientFName: Cheryl
     └─ patientLName: Johnson
     └─ dob: 11/04/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M24.573', 'thirdDiagnosis': 'M79.672', 'fourthDiagnosis': 'M47.22', 'fifthDiagnosis': 'M51.26', 'sixthDiagnosis': 'M54.17'}]
[14:14:51] ✅    ✅ Patient identified: Cheryl Johnson
[14:14:51] ✅    ✅ Patient name validation passed
[14:14:51] 🔄 
🔄 Step 3: Processing patient dates...
[14:14:51] [DOC: 9230844] ℹ️  DOB normalized: 11/04/1958
[14:14:51] [DOC: 9230844] ℹ️  Episode startOfCare normalized: 04/04/2025
[14:14:51] [DOC: 9230844] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[14:14:51] [DOC: 9230844] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[14:14:51] [DOC: 9230844] ✅ Patient date processing completed successfully
[14:14:51] ✅    ✅ Date processing completed
[14:14:51] 📊 Processed Patient Data
     └─ patientFName: Cheryl
     └─ patientLName: Johnson
     └─ dob: 11/04/1958
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M24.573', 'thirdDiagnosis': 'M79.672', 'fourthDiagnosis': 'M47.22', 'fifthDiagnosis': 'M51.26', 'sixthDiagnosis': 'M54.17'}]
[14:14:51] 🔄 
🔄 Step 4: Extracting order data...
[14:14:53] ℹ️  Order extraction - MRN: '227027'
[14:14:53] ℹ️  Order extraction - Sex: 'FEMALE'
[14:14:53] ℹ️  Order extraction - Service Line: 'PT, RN'
[14:14:53] ℹ️  Order extraction - Payer Source: ''
[14:14:53] ✅ Order data extraction completed successfully
[14:14:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:14:53] ℹ️  Using MRN from patient data: '227027' over '227027'
[14:14:53] ℹ️  Combined service lines: Patient='PT' + Order='PT, RN' = 'PT, RN'
[14:14:53] ✅ Patient name cross-validation successful
[14:14:53] ✅    ✅ Data merged successfully
[14:14:54] ✅    ✅ Order data extracted and validated
[14:14:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:15:12] [DOC: 9230844] ✅ Patient exists in API: Cheryl Johnson, ID: 2b29e691-01d3-427b-adc3-77185ce09f8e
[14:15:12] ✅    ✅ Existing patient found with ID: 2b29e691-01d3-427b-adc3-77185ce09f8e
[14:15:12] 🔄 
🔄 Step 6: Pushing order to API...
[14:15:12] [DOC: 9230844] ℹ️  Pushing order via API for patient ID: 2b29e691-01d3-427b-adc3-77185ce09f8e
[14:15:14] [DOC: 9230844] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:15:14] ❌    ❌ Failed to push order
[14:15:14] 🔄 
🔄 Step 7: Writing to CSV...
[14:15:14] [DOC: 9230844] ℹ️  Calculated age: 66 from DOB: 11/04/1958
[14:15:14] [DOC: 9230844] ℹ️  Service Line extracted: 'PT, RN'
[14:15:14] [DOC: 9230844] ℹ️  Payer Source extracted: ''
[14:15:14] [DOC: 9230844] ℹ️  Diagnosis codes being written:
[14:15:14] [DOC: 9230844] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[14:15:14] [DOC: 9230844] ℹ️    - Latest_Episode_Seconddiagnosis: 'M24.573'
[14:15:14] [DOC: 9230844] ℹ️    - Latest_Episode_Thirddiagnosis: 'M79.672'
[14:15:14] [DOC: 9230844] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M47.22'
[14:15:14] [DOC: 9230844] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M51.26'
[14:15:14] [DOC: 9230844] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M54.17'
[14:15:14] [DOC: 9230844] ✅ Patient data written to CSV: Cheryl Johnson | Sex: FEMALE | Age: 66 | Service: PT, RN | Payer:  | MRN: 227027
[14:15:14] ✅    ✅ Document 9230844 processed and saved successfully
[14:15:14] 🔄 
🔄 Step 8: Saving API details...
[14:15:14] [DOC: 9230844] ℹ️  API push details saved for document 9230844
[14:15:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230835                         ║
================================================================================
[14:15:14] ℹ️  Agency: Dartmouth HH
[14:15:14] ℹ️  Date: 04/09/2025
[14:15:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:15:17] [DOC: 9230835] ✅ Text extracted using pdfplumber (11014 chars)
[14:15:17] ✅    ✅ Text extracted using pdfplumber (11002 chars)
[14:15:17] 🔄 
🔄 Step 2: Extracting patient data...
[14:15:20] ℹ️  AI extracted raw sex value: 'F'
[14:15:20] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:15:20] ℹ️  AI extracted payer source: ''
[14:15:20] ℹ️  AI extracted diagnoses:
[14:15:20] ℹ️    - Diagnosis 1: 'C54.1'
[14:15:20] ℹ️    - Diagnosis 2: 'R18.0'
[14:15:20] ℹ️    - Diagnosis 3: 'K74.3'
[14:15:20] ℹ️    - Diagnosis 4: 'I85.00'
[14:15:20] ℹ️    - Diagnosis 5: 'I13.0'
[14:15:20] ℹ️    - Diagnosis 6: 'I50.31'
[14:15:20] ℹ️  Final extracted MRN: '5662015'
[14:15:20] ℹ️  Final extracted Sex: 'FEMALE'
[14:15:20] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:15:20] ℹ️  Final extracted Payer Source: ''
[14:15:20] ✅ Patient data extraction completed successfully
[14:15:20] ✅    ✅ Patient data extracted successfully
[14:15:20] 📊 Patient Response
     └─ patientFName: Betty J
     └─ patientLName: Mendonca
     └─ dob: 04/08/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5662015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Tracey Community Nurse Inc Cooley
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/07/2024', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'C54.1', 'secondDiagnosis': 'R18.0', 'thirdDiagnosis': 'K74.3', 'fourthDiagnosis': 'I85.00', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.31'}]
[14:15:20] ✅    ✅ Patient identified: Betty J Mendonca
[14:15:20] ✅    ✅ Patient name validation passed
[14:15:20] 🔄 
🔄 Step 3: Processing patient dates...
[14:15:20] [DOC: 9230835] ℹ️  DOB normalized: 04/08/1948
[14:15:20] [DOC: 9230835] ℹ️  Episode startOfCare normalized: 12/07/2024
[14:15:20] [DOC: 9230835] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[14:15:20] [DOC: 9230835] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[14:15:20] [DOC: 9230835] ✅ Patient date processing completed successfully
[14:15:20] ✅    ✅ Date processing completed
[14:15:20] 📊 Processed Patient Data
     └─ patientFName: Betty J
     └─ patientLName: Mendonca
     └─ dob: 04/08/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5662015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Tracey Community Nurse Inc Cooley
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/07/2024', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'C54.1', 'secondDiagnosis': 'R18.0', 'thirdDiagnosis': 'K74.3', 'fourthDiagnosis': 'I85.00', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.31'}]
[14:15:20] 🔄 
🔄 Step 4: Extracting order data...
[14:15:22] ℹ️  Order extraction - MRN: '5662015'
[14:15:22] ℹ️  Order extraction - Sex: 'FEMALE'
[14:15:22] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:15:22] ℹ️  Order extraction - Payer Source: ''
[14:15:22] ✅ Order data extraction completed successfully
[14:15:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:15:22] ℹ️  Using MRN from patient data: '5662015' over '5662015'
[14:15:22] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:15:22] ✅ Patient name cross-validation successful
[14:15:22] ✅    ✅ Data merged successfully
[14:15:23] ✅    ✅ Order data extracted and validated
[14:15:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:15:44] [DOC: 9230835] ℹ️  Patient not found in cache or API: Betty J Mendonca
[14:15:44] [DOC: 9230835] ℹ️  Patient not found, creating new patient via API...
[14:15:44] [DOC: 9230835] ℹ️  Creating patient via API: Betty J Mendonca
[14:15:45] [DOC: 9230835] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[14:15:45] ❌    ❌ Failed to create patient
[14:15:45] [DOC: 9230835] ℹ️  API push details saved for document 9230835
================================================================================
║                        Processing Document ID: 9230825                         ║
================================================================================
[14:15:45] ℹ️  Agency: Dartmouth HH
[14:15:45] ℹ️  Date: 04/09/2025
[14:15:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:15:47] [DOC: 9230825] ✅ Text extracted using pdfplumber (16319 chars)
[14:15:47] ✅    ✅ Text extracted using pdfplumber (16319 chars)
[14:15:47] 🔄 
🔄 Step 2: Extracting patient data...
[14:15:50] ℹ️  AI extracted raw sex value: 'F'
[14:15:50] ℹ️  AI extracted service line: 'PT, OT, SLP, RN'
[14:15:50] ℹ️  AI extracted payer source: ''
[14:15:50] ℹ️  AI extracted diagnoses:
[14:15:50] ℹ️    - Diagnosis 1: 'M54.12'
[14:15:50] ℹ️    - Diagnosis 2: 'M79.641'
[14:15:50] ℹ️    - Diagnosis 3: 'M79.642'
[14:15:50] ℹ️    - Diagnosis 4: 'M19.041'
[14:15:50] ℹ️    - Diagnosis 5: 'M19.042'
[14:15:50] ℹ️    - Diagnosis 6: 'G56.03'
[14:15:50] ℹ️  Final extracted MRN: '227027'
[14:15:50] ℹ️  Final extracted Sex: 'FEMALE'
[14:15:50] ℹ️  Final extracted Service Line: 'PT, OT, SLP, RN'
[14:15:50] ℹ️  Final extracted Payer Source: ''
[14:15:50] ✅ Patient data extraction completed successfully
[14:15:50] ✅    ✅ Patient data extracted successfully
[14:15:50] 📊 Patient Response
     └─ patientFName: Pascualina
     └─ patientLName: Costa
     └─ dob: 12/10/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT, SLP, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'M54.12', 'secondDiagnosis': 'M79.641', 'thirdDiagnosis': 'M79.642', 'fourthDiagnosis': 'M19.041', 'fifthDiagnosis': 'M19.042', 'sixthDiagnosis': 'G56.03'}]
[14:15:50] ✅    ✅ Patient identified: Pascualina Costa
[14:15:50] ✅    ✅ Patient name validation passed
[14:15:50] 🔄 
🔄 Step 3: Processing patient dates...
[14:15:50] [DOC: 9230825] ℹ️  DOB normalized: 12/10/1935
[14:15:50] [DOC: 9230825] ℹ️  Episode startOfCare normalized: 04/04/2025
[14:15:50] [DOC: 9230825] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[14:15:50] [DOC: 9230825] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[14:15:50] [DOC: 9230825] ✅ Patient date processing completed successfully
[14:15:50] ✅    ✅ Date processing completed
[14:15:50] 📊 Processed Patient Data
     └─ patientFName: Pascualina
     └─ patientLName: Costa
     └─ dob: 12/10/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT, SLP, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'M54.12', 'secondDiagnosis': 'M79.641', 'thirdDiagnosis': 'M79.642', 'fourthDiagnosis': 'M19.041', 'fifthDiagnosis': 'M19.042', 'sixthDiagnosis': 'G56.03'}]
[14:15:50] 🔄 
🔄 Step 4: Extracting order data...
[14:15:53] ℹ️  Order extraction - MRN: '227027'
[14:15:53] ℹ️  Order extraction - Sex: 'FEMALE'
[14:15:53] ℹ️  Order extraction - Service Line: 'PT, OT, SLP, Skilled Nursing'
[14:15:53] ℹ️  Order extraction - Payer Source: ''
[14:15:53] ✅ Order data extraction completed successfully
[14:15:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:15:53] ℹ️  Using MRN from patient data: '227027' over '227027'
[14:15:53] ℹ️  Combined service lines: Patient='PT, OT, SLP, RN' + Order='PT, OT, SLP, Skilled Nursing' = 'OT, PT, RN, SLP, Skilled Nursing'
[14:15:53] ✅ Patient name cross-validation successful
[14:15:53] ✅    ✅ Data merged successfully
[14:15:54] ✅    ✅ Order data extracted and validated
[14:15:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:15:54] [DOC: 9230825] ✅ Patient found in local cache: Pascualina Costa, ID: cb0d604b-ae64-4265-b4ee-470e611dd434
[14:15:54] ✅    ✅ Existing patient found with ID: cb0d604b-ae64-4265-b4ee-470e611dd434
[14:15:54] 🔄 
🔄 Step 6: Pushing order to API...
[14:15:54] [DOC: 9230825] ℹ️  Pushing order via API for patient ID: cb0d604b-ae64-4265-b4ee-470e611dd434
[14:15:56] [DOC: 9230825] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:15:56] ❌    ❌ Failed to push order
[14:15:56] 🔄 
🔄 Step 7: Writing to CSV...
[14:15:56] [DOC: 9230825] ℹ️  Calculated age: 89 from DOB: 12/10/1935
[14:15:56] [DOC: 9230825] ℹ️  Service Line extracted: 'OT, PT, RN, SLP, Skilled Nursing'
[14:15:56] [DOC: 9230825] ℹ️  Payer Source extracted: ''
[14:15:56] [DOC: 9230825] ℹ️  Diagnosis codes being written:
[14:15:56] [DOC: 9230825] ℹ️    - Latest_Episode_Firstdiagnosis: 'M54.12'
[14:15:56] [DOC: 9230825] ℹ️    - Latest_Episode_Seconddiagnosis: 'M79.641'
[14:15:56] [DOC: 9230825] ℹ️    - Latest_Episode_Thirddiagnosis: 'M79.642'
[14:15:56] [DOC: 9230825] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M19.041'
[14:15:56] [DOC: 9230825] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M19.042'
[14:15:56] [DOC: 9230825] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G56.03'
[14:15:56] [DOC: 9230825] ✅ Patient data written to CSV: Pascualina Costa | Sex: FEMALE | Age: 89 | Service: OT, PT, RN, SLP, Skilled Nursing | Payer:  | MRN: 227027
[14:15:56] ✅    ✅ Document 9230825 processed and saved successfully
[14:15:56] 🔄 
🔄 Step 8: Saving API details...
[14:15:56] [DOC: 9230825] ℹ️  API push details saved for document 9230825
[14:15:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9230759                         ║
================================================================================
[14:15:56] ℹ️  Agency: Brockton Home Health Care
[14:15:56] ℹ️  Date: 04/09/2025
[14:15:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:15:58] [DOC: 9230759] ✅ Text extracted using pdfplumber (1205 chars)
[14:15:58] ✅    ✅ Text extracted using pdfplumber (1193 chars)
[14:15:58] 🔄 
🔄 Step 2: Extracting patient data...
[14:16:01] ℹ️  AI extracted raw sex value: 'M'
[14:16:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:16:01] ℹ️  AI extracted payer source: ''
[14:16:01] ℹ️  AI extracted diagnoses:
[14:16:01] ℹ️    - Diagnosis 1: ''
[14:16:01] ℹ️    - Diagnosis 2: ''
[14:16:01] ℹ️    - Diagnosis 3: ''
[14:16:01] ℹ️    - Diagnosis 4: ''
[14:16:01] ℹ️    - Diagnosis 5: ''
[14:16:01] ℹ️    - Diagnosis 6: ''
[14:16:01] ℹ️  Final extracted MRN: 'BHHA1887764'
[14:16:01] ℹ️  Final extracted Sex: 'MALE'
[14:16:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:16:01] ℹ️  Final extracted Payer Source: ''
[14:16:01] ✅ Patient data extraction completed successfully
[14:16:01] ✅    ✅ Patient data extracted successfully
[14:16:01] 📊 Patient Response
     └─ patientFName: EARL
     └─ patientLName: THOMPSON
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: Maalouf-kaleshian, Karine M.D.
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY SOC SUITE 20
     └─ city: BROCKTON
     └─ state: MA
     └─ zip: 02301
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/29/2024', 'startOfEpisode': '04/29/2024', 'endOfEpisode': '06/27/2024', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:16:01] ✅    ✅ Patient identified: EARL THOMPSON
[14:16:01] ✅    ✅ Patient name validation passed
[14:16:01] 🔄 
🔄 Step 3: Processing patient dates...
[14:16:01] [DOC: 9230759] ℹ️  DOB normalized: 05/31/2002
[14:16:01] [DOC: 9230759] ℹ️  Episode startOfCare normalized: 04/29/2024
[14:16:01] [DOC: 9230759] ℹ️  Episode startOfEpisode normalized: 04/29/2024
[14:16:01] [DOC: 9230759] ℹ️  Episode endOfEpisode normalized: 06/27/2024
[14:16:01] [DOC: 9230759] ✅ Patient date processing completed successfully
[14:16:01] ✅    ✅ Date processing completed
[14:16:01] 📊 Processed Patient Data
     └─ patientFName: EARL
     └─ patientLName: THOMPSON
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: Maalouf-kaleshian, Karine M.D.
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY SOC SUITE 20
     └─ city: BROCKTON
     └─ state: MA
     └─ zip: 02301
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/29/2024', 'startOfEpisode': '04/29/2024', 'endOfEpisode': '06/27/2024', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:16:01] 🔄 
🔄 Step 4: Extracting order data...
[14:16:03] ℹ️  Order extraction - MRN: 'BHHA1887764'
[14:16:03] ℹ️  Order extraction - Sex: 'MALE'
[14:16:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:16:03] ℹ️  Order extraction - Payer Source: ''
[14:16:03] ✅ Order data extraction completed successfully
[14:16:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:16:03] ℹ️  Using MRN from patient data: 'BHHA1887764' over 'BHHA1887764'
[14:16:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:16:03] ✅ Patient name cross-validation successful
[14:16:03] ✅    ✅ Data merged successfully
[14:16:04] ⚠️     ❌ Skipping - missing company ID for agency: Brockton Home Health Care
[14:16:04] [DOC: 9230759] ℹ️  API push details saved for document 9230759
================================================================================
║                        Processing Document ID: 9230758                         ║
================================================================================
[14:16:04] ℹ️  Agency: Brockton Home Health Care
[14:16:04] ℹ️  Date: 04/09/2025
[14:16:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:16:06] [DOC: 9230758] ✅ Text extracted using pdfplumber (2994 chars)
[14:16:06] ✅    ✅ Text extracted using pdfplumber (2970 chars)
[14:16:06] 🔄 
🔄 Step 2: Extracting patient data...
[14:16:09] ℹ️  AI extracted raw sex value: 'M'
[14:16:09] ℹ️  AI extracted service line: 'RN'
[14:16:09] ℹ️  AI extracted payer source: ''
[14:16:09] ℹ️  AI extracted diagnoses:
[14:16:09] ℹ️    - Diagnosis 1: 'None'
[14:16:09] ℹ️    - Diagnosis 2: 'None'
[14:16:09] ℹ️    - Diagnosis 3: 'None'
[14:16:09] ℹ️    - Diagnosis 4: 'None'
[14:16:09] ℹ️    - Diagnosis 5: 'None'
[14:16:09] ℹ️    - Diagnosis 6: 'None'
[14:16:09] ℹ️  Final extracted MRN: 'BHHA1887764'
[14:16:09] ℹ️  Final extracted Sex: 'MALE'
[14:16:09] ℹ️  Final extracted Service Line: 'RN'
[14:16:09] ℹ️  Final extracted Payer Source: ''
[14:16:09] ✅ Patient data extraction completed successfully
[14:16:09] ✅    ✅ Patient data extracted successfully
[14:16:09] 📊 Patient Response
     └─ patientFName: EARL
     └─ patientLName: THOMPSON
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: Maalouf-kaleshian, Karine M.D.
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY SUITE 20
     └─ city: BROCKTON
     └─ state: MA
     └─ zip: 02301
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/29/2024', 'endOfEpisode': '06/27/2024', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[14:16:09] ✅    ✅ Patient identified: EARL THOMPSON
[14:16:09] ✅    ✅ Patient name validation passed
[14:16:09] 🔄 
🔄 Step 3: Processing patient dates...
[14:16:09] [DOC: 9230758] ℹ️  DOB normalized: 05/31/2002
[14:16:09] [DOC: 9230758] ℹ️  Episode startOfEpisode normalized: 04/29/2024
[14:16:09] [DOC: 9230758] ℹ️  Episode endOfEpisode normalized: 06/27/2024
[14:16:09] [DOC: 9230758] ✅ Patient date processing completed successfully
[14:16:09] ✅    ✅ Date processing completed
[14:16:09] 📊 Processed Patient Data
     └─ patientFName: EARL
     └─ patientLName: THOMPSON
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: Maalouf-kaleshian, Karine M.D.
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY SUITE 20
     └─ city: BROCKTON
     └─ state: MA
     └─ zip: 02301
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/29/2024', 'endOfEpisode': '06/27/2024'}]
[14:16:09] 🔄 
🔄 Step 4: Extracting order data...
[14:16:11] ℹ️  Order extraction - MRN: 'BHHA1887764'
[14:16:11] ℹ️  Order extraction - Sex: 'MALE'
[14:16:11] ℹ️  Order extraction - Service Line: 'RN'
[14:16:11] ℹ️  Order extraction - Payer Source: ''
[14:16:11] ✅ Order data extraction completed successfully
[14:16:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:16:11] ℹ️  Using MRN from patient data: 'BHHA1887764' over 'BHHA1887764'
[14:16:11] ℹ️  Service line consistent in both sources: 'RN'
[14:16:11] ✅ Patient name cross-validation successful
[14:16:11] ✅    ✅ Data merged successfully
[14:16:12] ⚠️     ❌ Skipping - missing company ID for agency: Brockton Home Health Care
[14:16:12] [DOC: 9230758] ℹ️  API push details saved for document 9230758
================================================================================
║                        Processing Document ID: 9230761                         ║
================================================================================
[14:16:12] ℹ️  Agency: Brockton Home Health Care
[14:16:12] ℹ️  Date: 04/09/2025
[14:16:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:16:16] [DOC: 9230761] ✅ Text extracted using pdfplumber (17035 chars)
[14:16:16] ✅    ✅ Text extracted using pdfplumber (17035 chars)
[14:16:16] 🔄 
🔄 Step 2: Extracting patient data...
[14:16:20] ℹ️  AI extracted raw sex value: 'M'
[14:16:20] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:16:20] ℹ️  AI extracted payer source: ''
[14:16:20] ℹ️  AI extracted diagnoses:
[14:16:20] ℹ️    - Diagnosis 1: 'F25.0'
[14:16:20] ℹ️    - Diagnosis 2: 'F32.A'
[14:16:20] ℹ️    - Diagnosis 3: 'G47.9'
[14:16:20] ℹ️    - Diagnosis 4: 'Z91.51'
[14:16:20] ℹ️    - Diagnosis 5: 'K21.9'
[14:16:20] ℹ️    - Diagnosis 6: 'J45.909'
[14:16:20] ℹ️  Final extracted MRN: 'BHHA1887764'
[14:16:20] ℹ️  Final extracted Sex: 'MALE'
[14:16:20] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:16:20] ℹ️  Final extracted Payer Source: ''
[14:16:20] ✅ Patient data extraction completed successfully
[14:16:20] ✅    ✅ Patient data extracted successfully
[14:16:20] 📊 Patient Response
     └─ patientFName: Earl
     └─ patientLName: Thompson
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: MAALOUF-KALESHIAN, KARINE M.D.
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY SUITE 20
     └─ city: BROCKTON
     └─ state: MA
     └─ zip: 02301-7225
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/29/2024', 'startOfEpisode': '04/29/2024', 'endOfEpisode': '06/27/2024', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'F32.A', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': 'Z91.51', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'J45.909'}]
[14:16:20] ✅    ✅ Patient identified: Earl Thompson
[14:16:20] ✅    ✅ Patient name validation passed
[14:16:20] 🔄 
🔄 Step 3: Processing patient dates...
[14:16:20] [DOC: 9230761] ℹ️  DOB normalized: 05/31/2002
[14:16:20] [DOC: 9230761] ℹ️  Episode startOfCare normalized: 04/29/2024
[14:16:20] [DOC: 9230761] ℹ️  Episode startOfEpisode normalized: 04/29/2024
[14:16:20] [DOC: 9230761] ℹ️  Episode endOfEpisode normalized: 06/27/2024
[14:16:20] [DOC: 9230761] ✅ Patient date processing completed successfully
[14:16:20] ✅    ✅ Date processing completed
[14:16:20] 📊 Processed Patient Data
     └─ patientFName: Earl
     └─ patientLName: Thompson
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: MAALOUF-KALESHIAN, KARINE M.D.
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY SUITE 20
     └─ city: BROCKTON
     └─ state: MA
     └─ zip: 02301-7225
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/29/2024', 'startOfEpisode': '04/29/2024', 'endOfEpisode': '06/27/2024', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'F32.A', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': 'Z91.51', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'J45.909'}]
[14:16:20] 🔄 
🔄 Step 4: Extracting order data...
[14:16:23] ℹ️  Order extraction - MRN: 'BHHA1887764'
[14:16:23] ℹ️  Order extraction - Sex: 'MALE'
[14:16:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[14:16:23] ℹ️  Order extraction - Payer Source: ''
[14:16:23] ✅ Order data extraction completed successfully
[14:16:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:16:23] ℹ️  Using MRN from patient data: 'BHHA1887764' over 'BHHA1887764'
[14:16:23] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[14:16:23] ✅ Patient name cross-validation successful
[14:16:23] ✅    ✅ Data merged successfully
[14:16:24] ⚠️     ❌ Skipping - missing company ID for agency: Brockton Home Health Care
[14:16:24] [DOC: 9230761] ℹ️  API push details saved for document 9230761
================================================================================
║                        Processing Document ID: 9230571                         ║
================================================================================
[14:16:24] ℹ️  Agency: Beacon Hospice Care, an Amedisys Company (4420) Fall River
[14:16:24] ℹ️  Date: 04/09/2025
[14:16:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:16:25] [DOC: 9230571] ❌ Critical failure in get_pdf_text: Invalid response format
[14:16:25] ❌ Failed to extract text for Doc ID 9230571
[14:16:25] [DOC: 9230571] ℹ️  API push details saved for document 9230571
================================================================================
║                        Processing Document ID: 9230565                         ║
================================================================================
[14:16:25] ℹ️  Agency: Beacon Hospice Care, an Amedisys Company (4420) Fall River
[14:16:25] ℹ️  Date: 04/09/2025
[14:16:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:16:26] [DOC: 9230565] ❌ Critical failure in get_pdf_text: Invalid response format
[14:16:26] ❌ Failed to extract text for Doc ID 9230565
[14:16:26] [DOC: 9230565] ℹ️  API push details saved for document 9230565
================================================================================
║                        Processing Document ID: 9230431                         ║
================================================================================
[14:16:26] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[14:16:26] ℹ️  Date: 04/09/2025
[14:16:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[14:16:28] [DOC: 9230431] ✅ Text extracted using pdfplumber (1263 chars)
[14:16:28] ✅    ✅ Text extracted using pdfplumber (1263 chars)
[14:16:28] 🔄 
🔄 Step 2: Extracting patient data...
[14:16:31] ℹ️  AI extracted raw sex value: 'M'
[14:16:31] ℹ️  AI extracted service line: 'Skilled Nursing'
[14:16:31] ℹ️  AI extracted payer source: 'Medicaid/MA'
[14:16:31] ℹ️  AI extracted diagnoses:
[14:16:31] ℹ️    - Diagnosis 1: ''
[14:16:31] ℹ️    - Diagnosis 2: ''
[14:16:31] ℹ️    - Diagnosis 3: ''
[14:16:31] ℹ️    - Diagnosis 4: ''
[14:16:31] ℹ️    - Diagnosis 5: ''
[14:16:31] ℹ️    - Diagnosis 6: ''
[14:16:31] ℹ️  Final extracted MRN: '879'
[14:16:31] ℹ️  Final extracted Sex: 'MALE'
[14:16:31] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[14:16:31] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[14:16:31] ✅ Patient data extraction completed successfully
[14:16:31] ✅    ✅ Patient data extracted successfully
[14:16:31] 📊 Patient Response
     └─ patientFName: Sean R
     └─ patientLName: McCarthy
     └─ dob: 09/16/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 879
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2024', 'startOfEpisode': '01/24/2025', 'endOfEpisode': '03/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:16:31] ✅    ✅ Patient identified: Sean R McCarthy
[14:16:31] ✅    ✅ Patient name validation passed
[14:16:31] 🔄 
🔄 Step 3: Processing patient dates...
[14:16:31] [DOC: 9230431] ℹ️  DOB normalized: 09/16/1969
[14:16:31] [DOC: 9230431] ℹ️  Episode startOfCare normalized: 03/30/2024
[14:16:31] [DOC: 9230431] ℹ️  Episode startOfEpisode normalized: 01/24/2025
[14:16:31] [DOC: 9230431] ℹ️  Episode endOfEpisode normalized: 03/24/2025
[14:16:31] [DOC: 9230431] ✅ Patient date processing completed successfully
[14:16:31] ✅    ✅ Date processing completed
[14:16:31] 📊 Processed Patient Data
     └─ patientFName: Sean R
     └─ patientLName: McCarthy
     └─ dob: 09/16/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 879
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2024', 'startOfEpisode': '01/24/2025', 'endOfEpisode': '03/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[14:16:31] 🔄 
🔄 Step 4: Extracting order data...
[14:16:34] ℹ️  Order extraction - MRN: '879'
[14:16:34] ℹ️  Order extraction - Sex: 'MALE'
[14:16:34] ℹ️  Order extraction - Service Line: ''
[14:16:34] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[14:16:34] ✅ Order data extraction completed successfully
[14:16:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[14:16:34] ℹ️  Using MRN from patient data: '879' over '879'
[14:16:34] ℹ️  Using service line from patient data: 'Skilled Nursing'
[14:16:34] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[14:16:34] ✅ Patient name cross-validation successful
[14:16:34] ✅    ✅ Data merged successfully
[14:16:35] ✅    ✅ Order data extracted and validated
[14:16:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[14:17:29] [DOC: 9230431] ✅ Patient exists in API: Sean R McCarthy, ID: 3b7c4c27-b1aa-4316-acf8-d16068b27ef3
[14:17:29] ✅    ✅ Existing patient found with ID: 3b7c4c27-b1aa-4316-acf8-d16068b27ef3
[14:17:29] 🔄 
🔄 Step 6: Pushing order to API...
[14:17:29] [DOC: 9230431] ℹ️  Pushing order via API for patient ID: 3b7c4c27-b1aa-4316-acf8-d16068b27ef3
[14:17:30] [DOC: 9230431] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[14:17:30] ❌    ❌ Failed to push order
[14:17:30] 🔄 
🔄 Step 7: Writing to CSV...
[14:17:30] [DOC: 9230431] ℹ️  Calculated age: 55 from DOB: 09/16/1969
[14:17:30] [DOC: 9230431] ℹ️  Service Line extracted: 'Skilled Nursing'
[14:17:30] [DOC: 9230431] ℹ️  Payer Source extracted: 'Medicaid/MA'
[14:17:30] [DOC: 9230431] ℹ️  Diagnosis codes being written:
[14:17:30] [DOC: 9230431] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[14:17:30] [DOC: 9230431] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[14:17:30] [DOC: 9230431] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[14:17:30] [DOC: 9230431] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[14:17:30] [DOC: 9230431] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[14:17:30] [DOC: 9230431] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[14:17:30] [DOC: 9230431] ✅ Patient data written to CSV: Sean R McCarthy | Sex: MALE | Age: 55 | Service: Skilled Nursing | Payer: Medicaid/MA | MRN: 879
[14:17:30] ✅    ✅ Document 9230431 processed and saved successfully
[14:17:30] 🔄 
🔄 Step 8: Saving API details...
[14:17:30] [DOC: 9230431] ℹ️  API push details saved for document 9230431
[14:17:30] ✅    ✅ API details saved
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[14:17:30] ℹ️  Total Processed: 100
[14:17:30] ℹ️  CSV Success: 57
[14:17:30] ℹ️  CSV Errors: 9
[14:17:30] ℹ️  API Success: 0
[14:17:30] ℹ️  API Errors: 91
[14:17:30] ℹ️  CSV Success Rate: 57.0%
[14:17:30] ℹ️  API Success Rate: 0.0%
[14:17:30] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250608_134615.csv
[14:17:30] ℹ️  API Details File: api_outputs/api_push_details_20250608_134615.csv
================================================================================
║          ============================================================          ║
================================================================================
