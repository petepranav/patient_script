================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[18:06:58] ℹ️  CSV Data Extraction & API Push Tool
[18:06:58] ℹ️  
[18:06:58] ℹ️  Features:
[18:06:58] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[18:06:58] ℹ️  - AI-powered patient and order data extraction
[18:06:58] ℹ️  - Enhanced error handling and logging
[18:06:58] ℹ️  - Full API integration (patient creation + order pushing)
[18:06:58] ℹ️  - CSV output with comprehensive patient data
[18:06:58] ℹ️  - Detailed API tracking with remarks for every document
[18:06:58] ℹ️  - Complete audit trail of all processing attempts
[18:06:58] ℹ️  
[18:06:58] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[18:06:58] ✅ Created output CSV file: csv_outputs/extracted_patients_20250607_180658.csv
[18:06:58] ✅ Created API details CSV file: api_outputs/api_push_details_20250607_180658.csv
================================================================================
║                        Processing Document ID: 9259574                         ║
================================================================================
[18:06:58] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:06:58] ℹ️  Date: 04/24/2025
[18:06:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:07:00] [DOC: 9259574] ✅ Text extracted using pdfplumber (1691 chars)
[18:07:00] ✅    ✅ Text extracted using pdfplumber (1691 chars)
[18:07:00] 🔄 
🔄 Step 2: Extracting patient data...
[18:07:04] ℹ️  AI extracted raw sex value: 'F'
[18:07:04] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:07:04] ℹ️  AI extracted payer source: ''
[18:07:04] ℹ️  AI extracted diagnoses:
[18:07:04] ℹ️    - Diagnosis 1: ''
[18:07:04] ℹ️    - Diagnosis 2: ''
[18:07:04] ℹ️    - Diagnosis 3: ''
[18:07:04] ℹ️    - Diagnosis 4: ''
[18:07:04] ℹ️    - Diagnosis 5: ''
[18:07:04] ℹ️    - Diagnosis 6: ''
[18:07:04] ℹ️  Final extracted MRN: '2761021'
[18:07:04] ℹ️  Final extracted Sex: 'FEMALE'
[18:07:04] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:07:04] ℹ️  Final extracted Payer Source: ''
[18:07:04] ✅ Patient data extraction completed successfully
[18:07:04] ✅    ✅ Patient data extracted successfully
[18:07:04] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Moniz
     └─ dob: 07/09/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2761021
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:07:04] ✅    ✅ Patient identified: Theresa Moniz
[18:07:04] ✅    ✅ Patient name validation passed
[18:07:04] 🔄 
🔄 Step 3: Processing patient dates...
[18:07:04] [DOC: 9259574] ℹ️  DOB normalized: 07/09/1956
[18:07:04] [DOC: 9259574] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[18:07:04] [DOC: 9259574] ✅ Patient date processing completed successfully
[18:07:04] ✅    ✅ Date processing completed
[18:07:04] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Moniz
     └─ dob: 07/09/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2761021
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:07:04] 🔄 
🔄 Step 4: Extracting order data...
[18:07:06] ℹ️  Order extraction - MRN: '2761021'
[18:07:06] ℹ️  Order extraction - Sex: 'FEMALE'
[18:07:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:07:06] ℹ️  Order extraction - Payer Source: ''
[18:07:06] ✅ Order data extraction completed successfully
[18:07:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:07:06] ℹ️  Using MRN from patient data: '2761021' over '2761021'
[18:07:06] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:07:06] ✅ Patient name cross-validation successful
[18:07:06] ✅    ✅ Data merged successfully
[18:07:07] ✅    ✅ Order data extracted and validated
[18:07:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:07:14] [DOC: 9259574] ℹ️  Patient not found in cache or API: Theresa Moniz
[18:07:14] [DOC: 9259574] ℹ️  Patient not found, creating new patient via API...
[18:07:14] [DOC: 9259574] ℹ️  Creating patient via API: Theresa Moniz
[18:07:15] [DOC: 9259574] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:07:15] ❌    ❌ Failed to create patient
[18:07:15] [DOC: 9259574] ℹ️  API push details saved for document 9259574
================================================================================
║                        Processing Document ID: 9259573                         ║
================================================================================
[18:07:15] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:07:15] ℹ️  Date: 04/24/2025
[18:07:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:07:16] [DOC: 9259573] ✅ Text extracted using pdfplumber (1235 chars)
[18:07:16] ✅    ✅ Text extracted using pdfplumber (1235 chars)
[18:07:16] 🔄 
🔄 Step 2: Extracting patient data...
[18:07:19] ℹ️  AI extracted raw sex value: 'F'
[18:07:19] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:07:19] ℹ️  AI extracted payer source: ''
[18:07:19] ℹ️  AI extracted diagnoses:
[18:07:19] ℹ️    - Diagnosis 1: ''
[18:07:19] ℹ️    - Diagnosis 2: ''
[18:07:19] ℹ️    - Diagnosis 3: ''
[18:07:19] ℹ️    - Diagnosis 4: ''
[18:07:19] ℹ️    - Diagnosis 5: ''
[18:07:19] ℹ️    - Diagnosis 6: ''
[18:07:19] ℹ️  Final extracted MRN: '2687695'
[18:07:19] ℹ️  Final extracted Sex: 'FEMALE'
[18:07:19] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:07:19] ℹ️  Final extracted Payer Source: ''
[18:07:19] ✅ Patient data extraction completed successfully
[18:07:19] ✅    ✅ Patient data extracted successfully
[18:07:19] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Maiato
     └─ dob: 03/29/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2687695
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:07:19] ✅    ✅ Patient identified: Maria Maiato
[18:07:19] ✅    ✅ Patient name validation passed
[18:07:19] 🔄 
🔄 Step 3: Processing patient dates...
[18:07:19] [DOC: 9259573] ℹ️  DOB normalized: 03/29/1952
[18:07:19] [DOC: 9259573] ✅ Patient date processing completed successfully
[18:07:19] ✅    ✅ Date processing completed
[18:07:19] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Maiato
     └─ dob: 03/29/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2687695
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:07:19] 🔄 
🔄 Step 4: Extracting order data...
[18:07:21] ℹ️  Order extraction - MRN: '2687695'
[18:07:21] ℹ️  Order extraction - Sex: 'FEMALE'
[18:07:21] ℹ️  Order extraction - Service Line: 'SN'
[18:07:21] ℹ️  Order extraction - Payer Source: ''
[18:07:21] ✅ Order data extraction completed successfully
[18:07:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:07:21] ℹ️  Using MRN from patient data: '2687695' over '2687695'
[18:07:21] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[18:07:21] ✅ Patient name cross-validation successful
[18:07:21] ✅    ✅ Data merged successfully
[18:07:22] ✅    ✅ Order data extracted and validated
[18:07:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:07:49] [DOC: 9259573] ✅ Patient exists in API: Maria Maiato, ID: a92d350b-6287-4f07-a2c9-09b4c329691a
[18:07:49] ✅    ✅ Existing patient found with ID: a92d350b-6287-4f07-a2c9-09b4c329691a
[18:07:49] 🔄 
🔄 Step 6: Pushing order to API...
[18:07:49] [DOC: 9259573] ℹ️  Pushing order via API for patient ID: a92d350b-6287-4f07-a2c9-09b4c329691a
[18:07:50] [DOC: 9259573] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13309"}
[18:07:50] ❌    ❌ Failed to push order
[18:07:50] 🔄 
🔄 Step 7: Writing to CSV...
[18:07:50] [DOC: 9259573] ℹ️  Calculated age: 73 from DOB: 03/29/1952
[18:07:50] [DOC: 9259573] ℹ️  Service Line extracted: 'SN, Skilled Nursing'
[18:07:50] [DOC: 9259573] ℹ️  Payer Source extracted: ''
[18:07:50] [DOC: 9259573] ℹ️  Diagnosis codes being written:
[18:07:50] [DOC: 9259573] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:07:50] [DOC: 9259573] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:07:50] [DOC: 9259573] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:07:50] [DOC: 9259573] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:07:50] [DOC: 9259573] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:07:50] [DOC: 9259573] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:07:50] [DOC: 9259573] ✅ Patient data written to CSV: Maria Maiato | Sex: FEMALE | Age: 73 | Service: SN, Skilled Nursing | Payer:  | MRN: 2687695
[18:07:50] ✅    ✅ Document 9259573 processed and saved successfully
[18:07:50] 🔄 
🔄 Step 8: Saving API details...
[18:07:50] [DOC: 9259573] ℹ️  API push details saved for document 9259573
[18:07:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9259571                         ║
================================================================================
[18:07:50] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:07:50] ℹ️  Date: 04/24/2025
[18:07:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:07:52] [DOC: 9259571] ✅ Text extracted using pdfplumber (1968 chars)
[18:07:52] ✅    ✅ Text extracted using pdfplumber (1968 chars)
[18:07:52] 🔄 
🔄 Step 2: Extracting patient data...
[18:07:55] ℹ️  AI extracted raw sex value: 'M'
[18:07:55] ℹ️  AI extracted service line: 'Nursing'
[18:07:55] ℹ️  AI extracted payer source: ''
[18:07:55] ℹ️  AI extracted diagnoses:
[18:07:55] ℹ️    - Diagnosis 1: ''
[18:07:55] ℹ️    - Diagnosis 2: ''
[18:07:55] ℹ️    - Diagnosis 3: ''
[18:07:55] ℹ️    - Diagnosis 4: ''
[18:07:55] ℹ️    - Diagnosis 5: ''
[18:07:55] ℹ️    - Diagnosis 6: ''
[18:07:55] ℹ️  Final extracted MRN: '3170225'
[18:07:55] ℹ️  Final extracted Sex: 'MALE'
[18:07:55] ℹ️  Final extracted Service Line: 'Nursing'
[18:07:55] ℹ️  Final extracted Payer Source: ''
[18:07:55] ✅ Patient data extraction completed successfully
[18:07:55] ✅    ✅ Patient data extracted successfully
[18:07:55] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:07:55] ✅    ✅ Patient identified: Donald Maceachern
[18:07:55] ✅    ✅ Patient name validation passed
[18:07:55] 🔄 
🔄 Step 3: Processing patient dates...
[18:07:55] [DOC: 9259571] ℹ️  DOB normalized: 11/18/1939
[18:07:55] [DOC: 9259571] ✅ Patient date processing completed successfully
[18:07:55] ✅    ✅ Date processing completed
[18:07:55] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Maceachern
     └─ dob: 11/18/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3170225
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:07:55] 🔄 
🔄 Step 4: Extracting order data...
[18:07:57] ℹ️  Order extraction - MRN: '3170225'
[18:07:57] ℹ️  Order extraction - Sex: 'MALE'
[18:07:57] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:07:57] ℹ️  Order extraction - Payer Source: ''
[18:07:57] ✅ Order data extraction completed successfully
[18:07:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:07:57] ℹ️  Using MRN from patient data: '3170225' over '3170225'
[18:07:57] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[18:07:57] ✅ Patient name cross-validation successful
[18:07:57] ✅    ✅ Data merged successfully
[18:07:58] ⚠️     ❌ Skipping - missing episode start date
[18:07:58] [DOC: 9259571] ℹ️  API push details saved for document 9259571
================================================================================
║                        Processing Document ID: 9259568                         ║
================================================================================
[18:07:58] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:07:58] ℹ️  Date: 04/24/2025
[18:07:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:08:00] [DOC: 9259568] ✅ Text extracted using pdfplumber (1240 chars)
[18:08:00] ✅    ✅ Text extracted using pdfplumber (1240 chars)
[18:08:00] 🔄 
🔄 Step 2: Extracting patient data...
[18:08:03] ℹ️  AI extracted raw sex value: 'M'
[18:08:03] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:08:03] ℹ️  AI extracted payer source: ''
[18:08:03] ℹ️  AI extracted diagnoses:
[18:08:03] ℹ️    - Diagnosis 1: 'None'
[18:08:03] ℹ️    - Diagnosis 2: 'None'
[18:08:03] ℹ️    - Diagnosis 3: 'None'
[18:08:03] ℹ️    - Diagnosis 4: 'None'
[18:08:03] ℹ️    - Diagnosis 5: 'None'
[18:08:03] ℹ️    - Diagnosis 6: 'None'
[18:08:03] ℹ️  Final extracted MRN: '2679776'
[18:08:03] ℹ️  Final extracted Sex: 'MALE'
[18:08:03] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:08:03] ℹ️  Final extracted Payer Source: ''
[18:08:03] ✅ Patient data extraction completed successfully
[18:08:03] ✅    ✅ Patient data extracted successfully
[18:08:03] 📊 Patient Response
     └─ patientFName: Milton
     └─ patientLName: MacDonald
     └─ dob: 03/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 2679776
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/19/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:08:03] ✅    ✅ Patient identified: Milton MacDonald
[18:08:03] ✅    ✅ Patient name validation passed
[18:08:03] 🔄 
🔄 Step 3: Processing patient dates...
[18:08:03] [DOC: 9259568] ℹ️  DOB normalized: 03/20/1939
[18:08:03] [DOC: 9259568] ℹ️  Episode startOfEpisode normalized: 04/19/2025
[18:08:03] [DOC: 9259568] ✅ Patient date processing completed successfully
[18:08:03] ✅    ✅ Date processing completed
[18:08:03] 📊 Processed Patient Data
     └─ patientFName: Milton
     └─ patientLName: MacDonald
     └─ dob: 03/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 2679776
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/19/2025'}]
[18:08:03] 🔄 
🔄 Step 4: Extracting order data...
[18:08:05] ℹ️  Order extraction - MRN: '2679776'
[18:08:05] ℹ️  Order extraction - Sex: 'MALE'
[18:08:05] ℹ️  Order extraction - Service Line: 'SN'
[18:08:05] ℹ️  Order extraction - Payer Source: ''
[18:08:05] ✅ Order data extraction completed successfully
[18:08:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:08:05] ℹ️  Using MRN from patient data: '2679776' over '2679776'
[18:08:05] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[18:08:05] ✅ Patient name cross-validation successful
[18:08:05] ✅    ✅ Data merged successfully
[18:08:07] ✅    ✅ Order data extracted and validated
[18:08:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:08:07] [DOC: 9259568] ✅ Patient found in local cache: Milton MacDonald, ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[18:08:07] ✅    ✅ Existing patient found with ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[18:08:07] 🔄 
🔄 Step 6: Pushing order to API...
[18:08:07] [DOC: 9259568] ℹ️  Pushing order via API for patient ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[18:08:08] [DOC: 9259568] ❌ Order push failed with status 201: {"id":"c9a613b5-68b5-48d3-b807-63ead3df26cf","orderWAVId":"ORD19978","orderNo":"1084420, 1084727","orderDate":"04/22/2025","startOfCare":"04/19/2025","episodeStartDate":"04/19/2025","episodeEndDate":"06/17/2025","documentID":"9259568","mrn":"2679776","patientName":"MacDonald,Milton M","sentToPhysicianDate":"04/24/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/09/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"7aac5721-c2a3-4529-a771-b4ad8c6af027","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[18:08:08] ❌    ❌ Failed to push order
[18:08:08] 🔄 
🔄 Step 7: Writing to CSV...
[18:08:08] [DOC: 9259568] ℹ️  Calculated age: 86 from DOB: 03/20/1939
[18:08:08] [DOC: 9259568] ℹ️  Service Line extracted: 'SN, Skilled Nursing'
[18:08:08] [DOC: 9259568] ℹ️  Payer Source extracted: ''
[18:08:08] [DOC: 9259568] ℹ️  Diagnosis codes being written:
[18:08:08] [DOC: 9259568] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:08:08] [DOC: 9259568] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:08:08] [DOC: 9259568] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:08:08] [DOC: 9259568] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:08:08] [DOC: 9259568] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:08:08] [DOC: 9259568] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:08:08] [DOC: 9259568] ✅ Patient data written to CSV: Milton MacDonald | Sex: MALE | Age: 86 | Service: SN, Skilled Nursing | Payer:  | MRN: 2679776
[18:08:08] ✅    ✅ Document 9259568 processed and saved successfully
[18:08:08] 🔄 
🔄 Step 8: Saving API details...
[18:08:08] [DOC: 9259568] ℹ️  API push details saved for document 9259568
[18:08:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9259566                         ║
================================================================================
[18:08:08] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:08:08] ℹ️  Date: 04/24/2025
[18:08:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:08:12] [DOC: 9259566] ✅ Text extracted using pdfplumber (33204 chars)
[18:08:12] ✅    ✅ Text extracted using pdfplumber (33204 chars)
[18:08:12] 🔄 
🔄 Step 2: Extracting patient data...
[18:08:16] ℹ️  AI extracted raw sex value: 'M'
[18:08:16] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, Clergy, HHA'
[18:08:16] ℹ️  AI extracted payer source: ''
[18:08:16] ℹ️  AI extracted diagnoses:
[18:08:16] ℹ️    - Diagnosis 1: 'K92.2'
[18:08:16] ℹ️    - Diagnosis 2: 'D62'
[18:08:16] ℹ️    - Diagnosis 3: 'K62.5'
[18:08:16] ℹ️    - Diagnosis 4: 'R55'
[18:08:16] ℹ️    - Diagnosis 5: 'G31.01'
[18:08:16] ℹ️    - Diagnosis 6: 'N40.0'
[18:08:16] ℹ️  Final extracted MRN: '2679776'
[18:08:16] ℹ️  Final extracted Sex: 'MALE'
[18:08:16] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, Clergy, HHA'
[18:08:16] ℹ️  Final extracted Payer Source: ''
[18:08:16] ✅ Patient data extraction completed successfully
[18:08:16] ✅    ✅ Patient data extracted successfully
[18:08:16] 📊 Patient Response
     └─ patientFName: Milton
     └─ patientLName: MacDonald
     └─ dob: 03/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 2679776
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2025', 'startOfEpisode': '04/19/2025', 'endOfEpisode': '07/17/2025', 'firstDiagnosis': 'K92.2', 'secondDiagnosis': 'D62', 'thirdDiagnosis': 'K62.5', 'fourthDiagnosis': 'R55', 'fifthDiagnosis': 'G31.01', 'sixthDiagnosis': 'N40.0'}]
[18:08:16] ✅    ✅ Patient identified: Milton MacDonald
[18:08:16] ✅    ✅ Patient name validation passed
[18:08:16] 🔄 
🔄 Step 3: Processing patient dates...
[18:08:16] [DOC: 9259566] ℹ️  DOB normalized: 03/20/1939
[18:08:16] [DOC: 9259566] ℹ️  Episode startOfCare normalized: 04/19/2025
[18:08:16] [DOC: 9259566] ℹ️  Episode startOfEpisode normalized: 04/19/2025
[18:08:16] [DOC: 9259566] ℹ️  Episode endOfEpisode normalized: 07/17/2025
[18:08:16] [DOC: 9259566] ✅ Patient date processing completed successfully
[18:08:16] ✅    ✅ Date processing completed
[18:08:16] 📊 Processed Patient Data
     └─ patientFName: Milton
     └─ patientLName: MacDonald
     └─ dob: 03/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 2679776
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, MSW, Clergy, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2025', 'startOfEpisode': '04/19/2025', 'endOfEpisode': '07/17/2025', 'firstDiagnosis': 'K92.2', 'secondDiagnosis': 'D62', 'thirdDiagnosis': 'K62.5', 'fourthDiagnosis': 'R55', 'fifthDiagnosis': 'G31.01', 'sixthDiagnosis': 'N40.0'}]
[18:08:16] 🔄 
🔄 Step 4: Extracting order data...
[18:08:19] ℹ️  Order extraction - MRN: '2679776'
[18:08:19] ℹ️  Order extraction - Sex: 'MALE'
[18:08:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, Clergy, HHA'
[18:08:19] ℹ️  Order extraction - Payer Source: ''
[18:08:19] ✅ Order data extraction completed successfully
[18:08:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:08:19] ℹ️  Using MRN from patient data: '2679776' over '2679776'
[18:08:19] ℹ️  Service line consistent in both sources: 'Skilled Nursing, MSW, Clergy, HHA'
[18:08:19] ✅ Patient name cross-validation successful
[18:08:19] ✅    ✅ Data merged successfully
[18:08:20] ✅    ✅ Order data extracted and validated
[18:08:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:08:20] [DOC: 9259566] ✅ Patient found in local cache: Milton MacDonald, ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[18:08:20] ✅    ✅ Existing patient found with ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[18:08:20] 🔄 
🔄 Step 6: Pushing order to API...
[18:08:20] [DOC: 9259566] ℹ️  Pushing order via API for patient ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[18:08:22] [DOC: 9259566] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13298"}
[18:08:22] ❌    ❌ Failed to push order
[18:08:22] 🔄 
🔄 Step 7: Writing to CSV...
[18:08:22] [DOC: 9259566] ℹ️  Calculated age: 86 from DOB: 03/20/1939
[18:08:22] [DOC: 9259566] ℹ️  Service Line extracted: 'Skilled Nursing, MSW, Clergy, HHA'
[18:08:22] [DOC: 9259566] ℹ️  Payer Source extracted: ''
[18:08:22] [DOC: 9259566] ℹ️  Diagnosis codes being written:
[18:08:22] [DOC: 9259566] ℹ️    - Latest_Episode_Firstdiagnosis: 'K92.2'
[18:08:22] [DOC: 9259566] ℹ️    - Latest_Episode_Seconddiagnosis: 'D62'
[18:08:22] [DOC: 9259566] ℹ️    - Latest_Episode_Thirddiagnosis: 'K62.5'
[18:08:22] [DOC: 9259566] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R55'
[18:08:22] [DOC: 9259566] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G31.01'
[18:08:22] [DOC: 9259566] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N40.0'
[18:08:22] [DOC: 9259566] ✅ Patient data written to CSV: Milton MacDonald | Sex: MALE | Age: 86 | Service: Skilled Nursing, MSW, Clergy, HHA | Payer:  | MRN: 2679776
[18:08:22] ✅    ✅ Document 9259566 processed and saved successfully
[18:08:22] 🔄 
🔄 Step 8: Saving API details...
[18:08:22] [DOC: 9259566] ℹ️  API push details saved for document 9259566
[18:08:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9259551                         ║
================================================================================
[18:08:22] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:08:22] ℹ️  Date: 04/24/2025
[18:08:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:08:24] [DOC: 9259551] ✅ Text extracted using pdfplumber (9827 chars)
[18:08:24] ✅    ✅ Text extracted using pdfplumber (9827 chars)
[18:08:24] 🔄 
🔄 Step 2: Extracting patient data...
[18:08:27] ℹ️  AI extracted raw sex value: 'M'
[18:08:27] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:08:27] ℹ️  AI extracted payer source: ''
[18:08:27] ℹ️  AI extracted diagnoses:
[18:08:27] ℹ️    - Diagnosis 1: 'Z48.01'
[18:08:27] ℹ️    - Diagnosis 2: 'Z47.81'
[18:08:27] ℹ️    - Diagnosis 3: 'E11.69'
[18:08:27] ℹ️    - Diagnosis 4: 'M86.9'
[18:08:27] ℹ️    - Diagnosis 5: 'I50.32'
[18:08:27] ℹ️    - Diagnosis 6: 'G47.33'
[18:08:27] ℹ️  Final extracted MRN: '2540899'
[18:08:27] ℹ️  Final extracted Sex: 'MALE'
[18:08:27] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:08:27] ℹ️  Final extracted Payer Source: ''
[18:08:27] ✅ Patient data extraction completed successfully
[18:08:27] ✅    ✅ Patient data extracted successfully
[18:08:27] 📊 Patient Response
     └─ patientFName: Thomas
     └─ patientLName: Grondski
     └─ dob: 02/15/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 2540899
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/13/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'Z48.01', 'secondDiagnosis': 'Z47.81', 'thirdDiagnosis': 'E11.69', 'fourthDiagnosis': 'M86.9', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'G47.33'}]
[18:08:27] ✅    ✅ Patient identified: Thomas Grondski
[18:08:27] ✅    ✅ Patient name validation passed
[18:08:27] 🔄 
🔄 Step 3: Processing patient dates...
[18:08:27] [DOC: 9259551] ℹ️  DOB normalized: 02/15/1952
[18:08:27] [DOC: 9259551] ℹ️  Episode startOfCare normalized: 02/13/2025
[18:08:27] [DOC: 9259551] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[18:08:27] [DOC: 9259551] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[18:08:27] [DOC: 9259551] ✅ Patient date processing completed successfully
[18:08:27] ✅    ✅ Date processing completed
[18:08:27] 📊 Processed Patient Data
     └─ patientFName: Thomas
     └─ patientLName: Grondski
     └─ dob: 02/15/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 2540899
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/13/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'Z48.01', 'secondDiagnosis': 'Z47.81', 'thirdDiagnosis': 'E11.69', 'fourthDiagnosis': 'M86.9', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'G47.33'}]
[18:08:27] 🔄 
🔄 Step 4: Extracting order data...
[18:08:30] ℹ️  Order extraction - MRN: '2540899'
[18:08:30] ℹ️  Order extraction - Sex: 'MALE'
[18:08:30] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:08:30] ℹ️  Order extraction - Payer Source: ''
[18:08:30] ✅ Order data extraction completed successfully
[18:08:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:08:30] ℹ️  Using MRN from patient data: '2540899' over '2540899'
[18:08:30] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:08:30] ✅ Patient name cross-validation successful
[18:08:30] ✅    ✅ Data merged successfully
[18:08:31] ✅    ✅ Order data extracted and validated
[18:08:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:08:31] [DOC: 9259551] ✅ Patient found in local cache: Thomas Grondski, ID: 0d9b4627-ba88-40a7-8913-0bdb5357a676
[18:08:31] ✅    ✅ Existing patient found with ID: 0d9b4627-ba88-40a7-8913-0bdb5357a676
[18:08:31] 🔄 
🔄 Step 6: Pushing order to API...
[18:08:31] [DOC: 9259551] ℹ️  Pushing order via API for patient ID: 0d9b4627-ba88-40a7-8913-0bdb5357a676
[18:08:33] [DOC: 9259551] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13064"}
[18:08:33] ❌    ❌ Failed to push order
[18:08:33] 🔄 
🔄 Step 7: Writing to CSV...
[18:08:33] [DOC: 9259551] ℹ️  Calculated age: 73 from DOB: 02/15/1952
[18:08:33] [DOC: 9259551] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:08:33] [DOC: 9259551] ℹ️  Payer Source extracted: ''
[18:08:33] [DOC: 9259551] ℹ️  Diagnosis codes being written:
[18:08:33] [DOC: 9259551] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z48.01'
[18:08:33] [DOC: 9259551] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z47.81'
[18:08:33] [DOC: 9259551] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.69'
[18:08:33] [DOC: 9259551] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M86.9'
[18:08:33] [DOC: 9259551] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.32'
[18:08:33] [DOC: 9259551] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G47.33'
[18:08:33] [DOC: 9259551] ✅ Patient data written to CSV: Thomas Grondski | Sex: MALE | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: 2540899
[18:08:33] ✅    ✅ Document 9259551 processed and saved successfully
[18:08:33] 🔄 
🔄 Step 8: Saving API details...
[18:08:33] [DOC: 9259551] ℹ️  API push details saved for document 9259551
[18:08:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9259541                         ║
================================================================================
[18:08:33] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:08:33] ℹ️  Date: 04/24/2025
[18:08:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:08:36] [DOC: 9259541] ✅ Text extracted using pdfplumber (24012 chars)
[18:08:36] ✅    ✅ Text extracted using pdfplumber (24002 chars)
[18:08:36] 🔄 
🔄 Step 2: Extracting patient data...
[18:08:39] ℹ️  AI extracted raw sex value: 'F'
[18:08:39] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy, Home Health Aide'
[18:08:39] ℹ️  AI extracted payer source: ''
[18:08:39] ℹ️  AI extracted diagnoses:
[18:08:39] ℹ️    - Diagnosis 1: 'G93.41'
[18:08:39] ℹ️    - Diagnosis 2: 'J69.0'
[18:08:39] ℹ️    - Diagnosis 3: 'R13.12'
[18:08:39] ℹ️    - Diagnosis 4: 'G30.1'
[18:08:39] ℹ️    - Diagnosis 5: 'F02.84'
[18:08:39] ℹ️    - Diagnosis 6: 'F02.83'
[18:08:39] ℹ️  Final extracted MRN: '2526196'
[18:08:39] ℹ️  Final extracted Sex: 'FEMALE'
[18:08:39] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy, Home Health Aide'
[18:08:39] ℹ️  Final extracted Payer Source: ''
[18:08:39] ✅ Patient data extraction completed successfully
[18:08:39] ✅    ✅ Patient data extracted successfully
[18:08:39] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Gonsalves
     └─ dob: 09/08/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2526196
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/09/2025', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '06/08/2025', 'firstDiagnosis': 'G93.41', 'secondDiagnosis': 'J69.0', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': 'G30.1', 'fifthDiagnosis': 'F02.84', 'sixthDiagnosis': 'F02.83'}]
[18:08:39] ✅    ✅ Patient identified: Virginia Gonsalves
[18:08:39] ✅    ✅ Patient name validation passed
[18:08:39] 🔄 
🔄 Step 3: Processing patient dates...
[18:08:39] [DOC: 9259541] ℹ️  DOB normalized: 09/08/1936
[18:08:39] [DOC: 9259541] ℹ️  Episode startOfCare normalized: 04/09/2025
[18:08:39] [DOC: 9259541] ℹ️  Episode startOfEpisode normalized: 04/10/2025
[18:08:39] [DOC: 9259541] ℹ️  Episode endOfEpisode normalized: 06/08/2025
[18:08:39] [DOC: 9259541] ✅ Patient date processing completed successfully
[18:08:39] ✅    ✅ Date processing completed
[18:08:39] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Gonsalves
     └─ dob: 09/08/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2526196
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/09/2025', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '06/08/2025', 'firstDiagnosis': 'G93.41', 'secondDiagnosis': 'J69.0', 'thirdDiagnosis': 'R13.12', 'fourthDiagnosis': 'G30.1', 'fifthDiagnosis': 'F02.84', 'sixthDiagnosis': 'F02.83'}]
[18:08:39] 🔄 
🔄 Step 4: Extracting order data...
[18:08:42] ℹ️  Order extraction - MRN: '2526196'
[18:08:42] ℹ️  Order extraction - Sex: 'FEMALE'
[18:08:42] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy, Home Health Aide'
[18:08:42] ℹ️  Order extraction - Payer Source: ''
[18:08:42] ✅ Order data extraction completed successfully
[18:08:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:08:42] ℹ️  Using MRN from patient data: '2526196' over '2526196'
[18:08:42] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy, Home Health Aide'
[18:08:42] ✅ Patient name cross-validation successful
[18:08:42] ✅    ✅ Data merged successfully
[18:08:44] ✅    ✅ Order data extracted and validated
[18:08:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:09:11] [DOC: 9259541] ℹ️  Patient not found in cache or API: Virginia Gonsalves
[18:09:11] [DOC: 9259541] ℹ️  Patient not found, creating new patient via API...
[18:09:11] [DOC: 9259541] ℹ️  Creating patient via API: Virginia Gonsalves
[18:09:12] [DOC: 9259541] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:09:12] ❌    ❌ Failed to create patient
[18:09:12] [DOC: 9259541] ℹ️  API push details saved for document 9259541
================================================================================
║                        Processing Document ID: 9259537                         ║
================================================================================
[18:09:12] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:09:12] ℹ️  Date: 04/24/2025
[18:09:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:09:14] [DOC: 9259537] ✅ Text extracted using pdfplumber (1001 chars)
[18:09:14] ✅    ✅ Text extracted using pdfplumber (1001 chars)
[18:09:14] 🔄 
🔄 Step 2: Extracting patient data...
[18:09:17] ℹ️  AI extracted raw sex value: 'F'
[18:09:17] ℹ️  AI extracted service line: 'RN'
[18:09:17] ℹ️  AI extracted payer source: ''
[18:09:17] ℹ️  AI extracted diagnoses:
[18:09:17] ℹ️    - Diagnosis 1: ''
[18:09:17] ℹ️    - Diagnosis 2: ''
[18:09:17] ℹ️    - Diagnosis 3: ''
[18:09:17] ℹ️    - Diagnosis 4: ''
[18:09:17] ℹ️    - Diagnosis 5: ''
[18:09:17] ℹ️    - Diagnosis 6: ''
[18:09:17] ℹ️  Final extracted MRN: '2520814'
[18:09:17] ℹ️  Final extracted Sex: 'FEMALE'
[18:09:17] ℹ️  Final extracted Service Line: 'RN'
[18:09:17] ℹ️  Final extracted Payer Source: ''
[18:09:17] ✅ Patient data extraction completed successfully
[18:09:17] ✅    ✅ Patient data extracted successfully
[18:09:17] 📊 Patient Response
     └─ patientFName: Beverly
     └─ patientLName: Gomes
     └─ dob: 03/20/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2520814
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:09:17] ✅    ✅ Patient identified: Beverly Gomes
[18:09:17] ✅    ✅ Patient name validation passed
[18:09:17] 🔄 
🔄 Step 3: Processing patient dates...
[18:09:17] [DOC: 9259537] ℹ️  DOB normalized: 03/20/1952
[18:09:17] [DOC: 9259537] ✅ Patient date processing completed successfully
[18:09:17] ✅    ✅ Date processing completed
[18:09:17] 📊 Processed Patient Data
     └─ patientFName: Beverly
     └─ patientLName: Gomes
     └─ dob: 03/20/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2520814
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:09:17] 🔄 
🔄 Step 4: Extracting order data...
[18:09:19] ℹ️  Order extraction - MRN: '2520814'
[18:09:19] ℹ️  Order extraction - Sex: 'FEMALE'
[18:09:19] ℹ️  Order extraction - Service Line: ''
[18:09:19] ℹ️  Order extraction - Payer Source: ''
[18:09:19] ✅ Order data extraction completed successfully
[18:09:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:09:19] ℹ️  Using MRN from patient data: '2520814' over '2520814'
[18:09:19] ℹ️  Using service line from patient data: 'RN'
[18:09:19] ✅ Patient name cross-validation successful
[18:09:19] ✅    ✅ Data merged successfully
[18:09:20] ⚠️     ❌ Skipping - missing episode start date
[18:09:20] [DOC: 9259537] ℹ️  API push details saved for document 9259537
================================================================================
║                        Processing Document ID: 9259531                         ║
================================================================================
[18:09:20] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:09:20] ℹ️  Date: 04/24/2025
[18:09:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:09:23] [DOC: 9259531] ✅ Text extracted using pdfplumber (20362 chars)
[18:09:23] ✅    ✅ Text extracted using pdfplumber (20362 chars)
[18:09:23] 🔄 
🔄 Step 2: Extracting patient data...
[18:09:27] ℹ️  AI extracted raw sex value: 'Female'
[18:09:27] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy, Home Health Aide'
[18:09:27] ℹ️  AI extracted payer source: ''
[18:09:27] ℹ️  AI extracted diagnoses:
[18:09:27] ℹ️    - Diagnosis 1: 'M62.82'
[18:09:27] ℹ️    - Diagnosis 2: 'G93.41'
[18:09:27] ℹ️    - Diagnosis 3: 'W19.XXXD'
[18:09:27] ℹ️    - Diagnosis 4: 'I48.91'
[18:09:27] ℹ️    - Diagnosis 5: 'I10'
[18:09:27] ℹ️    - Diagnosis 6: 'I24.89'
[18:09:27] ℹ️  Final extracted MRN: '2520814'
[18:09:27] ℹ️  Final extracted Sex: 'FEMALE'
[18:09:27] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy, Home Health Aide'
[18:09:27] ℹ️  Final extracted Payer Source: ''
[18:09:27] ✅ Patient data extraction completed successfully
[18:09:27] ✅    ✅ Patient data extracted successfully
[18:09:27] 📊 Patient Response
     └─ patientFName: Beverly
     └─ patientLName: Gomes
     └─ dob: 03/20/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2520814
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Occupational Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'M62.82', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'W19.XXXD', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'I24.89'}]
[18:09:27] ✅    ✅ Patient identified: Beverly Gomes
[18:09:27] ✅    ✅ Patient name validation passed
[18:09:27] 🔄 
🔄 Step 3: Processing patient dates...
[18:09:27] [DOC: 9259531] ℹ️  DOB normalized: 03/20/1952
[18:09:27] [DOC: 9259531] ℹ️  Episode startOfCare normalized: 03/27/2025
[18:09:27] [DOC: 9259531] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[18:09:27] [DOC: 9259531] ℹ️  Episode endOfEpisode normalized: 05/26/2025
[18:09:27] [DOC: 9259531] ✅ Patient date processing completed successfully
[18:09:27] ✅    ✅ Date processing completed
[18:09:27] 📊 Processed Patient Data
     └─ patientFName: Beverly
     └─ patientLName: Gomes
     └─ dob: 03/20/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2520814
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Occupational Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'M62.82', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'W19.XXXD', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'I24.89'}]
[18:09:27] 🔄 
🔄 Step 4: Extracting order data...
[18:09:30] ℹ️  Order extraction - MRN: '2520814'
[18:09:30] ℹ️  Order extraction - Sex: 'FEMALE'
[18:09:30] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Occupational Therapy, Home Health Aide'
[18:09:30] ℹ️  Order extraction - Payer Source: ''
[18:09:30] ✅ Order data extraction completed successfully
[18:09:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:09:30] ℹ️  Using MRN from patient data: '2520814' over '2520814'
[18:09:30] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Occupational Therapy, Home Health Aide'
[18:09:30] ✅ Patient name cross-validation successful
[18:09:30] ✅    ✅ Data merged successfully
[18:09:31] ✅    ✅ Order data extracted and validated
[18:09:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:09:37] [DOC: 9259531] ✅ Patient exists in API: Beverly Gomes, ID: 5411e274-77ab-4da3-9089-305aae1f9f9c
[18:09:37] ✅    ✅ Existing patient found with ID: 5411e274-77ab-4da3-9089-305aae1f9f9c
[18:09:37] 🔄 
🔄 Step 6: Pushing order to API...
[18:09:37] [DOC: 9259531] ℹ️  Pushing order via API for patient ID: 5411e274-77ab-4da3-9089-305aae1f9f9c
[18:09:38] [DOC: 9259531] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13044"}
[18:09:38] ❌    ❌ Failed to push order
[18:09:38] 🔄 
🔄 Step 7: Writing to CSV...
[18:09:38] [DOC: 9259531] ℹ️  Calculated age: 73 from DOB: 03/20/1952
[18:09:38] [DOC: 9259531] ℹ️  Service Line extracted: 'Skilled Nursing, Occupational Therapy, Home Health Aide'
[18:09:38] [DOC: 9259531] ℹ️  Payer Source extracted: ''
[18:09:38] [DOC: 9259531] ℹ️  Diagnosis codes being written:
[18:09:38] [DOC: 9259531] ℹ️    - Latest_Episode_Firstdiagnosis: 'M62.82'
[18:09:38] [DOC: 9259531] ℹ️    - Latest_Episode_Seconddiagnosis: 'G93.41'
[18:09:38] [DOC: 9259531] ℹ️    - Latest_Episode_Thirddiagnosis: 'W19.XXXD'
[18:09:38] [DOC: 9259531] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.91'
[18:09:38] [DOC: 9259531] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[18:09:38] [DOC: 9259531] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I24.89'
[18:09:38] [DOC: 9259531] ✅ Patient data written to CSV: Beverly Gomes | Sex: FEMALE | Age: 73 | Service: Skilled Nursing, Occupational Therapy, Home Health Aide | Payer:  | MRN: 2520814
[18:09:38] ✅    ✅ Document 9259531 processed and saved successfully
[18:09:38] 🔄 
🔄 Step 8: Saving API details...
[18:09:38] [DOC: 9259531] ℹ️  API push details saved for document 9259531
[18:09:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9259528                         ║
================================================================================
[18:09:38] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:09:38] ℹ️  Date: 04/24/2025
[18:09:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:09:39] [DOC: 9259528] ✅ Text extracted using pdfplumber (1297 chars)
[18:09:39] ✅    ✅ Text extracted using pdfplumber (1297 chars)
[18:09:39] 🔄 
🔄 Step 2: Extracting patient data...
[18:09:42] ℹ️  AI extracted raw sex value: 'M'
[18:09:42] ℹ️  AI extracted service line: 'OT'
[18:09:42] ℹ️  AI extracted payer source: ''
[18:09:42] ℹ️  AI extracted diagnoses:
[18:09:42] ℹ️    - Diagnosis 1: ''
[18:09:42] ℹ️    - Diagnosis 2: ''
[18:09:42] ℹ️    - Diagnosis 3: ''
[18:09:42] ℹ️    - Diagnosis 4: ''
[18:09:42] ℹ️    - Diagnosis 5: ''
[18:09:42] ℹ️    - Diagnosis 6: ''
[18:09:42] ℹ️  Final extracted MRN: '2475455'
[18:09:42] ℹ️  Final extracted Sex: 'MALE'
[18:09:42] ℹ️  Final extracted Service Line: 'OT'
[18:09:42] ℹ️  Final extracted Payer Source: ''
[18:09:42] ✅ Patient data extraction completed successfully
[18:09:42] ✅    ✅ Patient data extracted successfully
[18:09:42] 📊 Patient Response
     └─ patientFName: Jay
     └─ patientLName: Flanagan
     └─ dob: 11/01/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 2475455
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:09:42] ✅    ✅ Patient identified: Jay Flanagan
[18:09:42] ✅    ✅ Patient name validation passed
[18:09:42] 🔄 
🔄 Step 3: Processing patient dates...
[18:09:42] [DOC: 9259528] ℹ️  DOB normalized: 11/01/1951
[18:09:42] [DOC: 9259528] ✅ Patient date processing completed successfully
[18:09:42] ✅    ✅ Date processing completed
[18:09:42] 📊 Processed Patient Data
     └─ patientFName: Jay
     └─ patientLName: Flanagan
     └─ dob: 11/01/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 2475455
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:09:42] 🔄 
🔄 Step 4: Extracting order data...
[18:09:44] ℹ️  Order extraction - MRN: '2475455'
[18:09:44] ℹ️  Order extraction - Sex: 'MALE'
[18:09:44] ℹ️  Order extraction - Service Line: ''
[18:09:44] ℹ️  Order extraction - Payer Source: ''
[18:09:44] ✅ Order data extraction completed successfully
[18:09:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:09:44] ℹ️  Using MRN from patient data: '2475455' over '2475455'
[18:09:44] ℹ️  Using service line from patient data: 'OT'
[18:09:44] ✅ Patient name cross-validation successful
[18:09:44] ✅    ✅ Data merged successfully
[18:09:46] ⚠️     ❌ Skipping - missing episode start date
[18:09:46] [DOC: 9259528] ℹ️  API push details saved for document 9259528
================================================================================
║                        Processing Document ID: 9259526                         ║
================================================================================
[18:09:46] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:09:46] ℹ️  Date: 04/24/2025
[18:09:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:09:47] [DOC: 9259526] ✅ Text extracted using pdfplumber (1355 chars)
[18:09:47] ✅    ✅ Text extracted using pdfplumber (1355 chars)
[18:09:47] 🔄 
🔄 Step 2: Extracting patient data...
[18:09:49] ℹ️  AI extracted raw sex value: 'F'
[18:09:49] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:09:49] ℹ️  AI extracted payer source: ''
[18:09:49] ℹ️  AI extracted diagnoses:
[18:09:49] ℹ️    - Diagnosis 1: ''
[18:09:49] ℹ️    - Diagnosis 2: ''
[18:09:49] ℹ️    - Diagnosis 3: ''
[18:09:49] ℹ️    - Diagnosis 4: ''
[18:09:49] ℹ️    - Diagnosis 5: ''
[18:09:49] ℹ️    - Diagnosis 6: ''
[18:09:49] ℹ️  Final extracted MRN: '2158031'
[18:09:49] ℹ️  Final extracted Sex: 'FEMALE'
[18:09:49] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:09:49] ℹ️  Final extracted Payer Source: ''
[18:09:49] ✅ Patient data extraction completed successfully
[18:09:49] ✅    ✅ Patient data extracted successfully
[18:09:49] 📊 Patient Response
     └─ patientFName: Norma
     └─ patientLName: Dyer
     └─ dob: 11/13/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2158031
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/22/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:09:49] ✅    ✅ Patient identified: Norma Dyer
[18:09:49] ✅    ✅ Patient name validation passed
[18:09:49] 🔄 
🔄 Step 3: Processing patient dates...
[18:09:49] [DOC: 9259526] ℹ️  DOB normalized: 11/13/1931
[18:09:49] [DOC: 9259526] ℹ️  Episode startOfEpisode normalized: 04/22/2025
[18:09:49] [DOC: 9259526] ✅ Patient date processing completed successfully
[18:09:49] ✅    ✅ Date processing completed
[18:09:49] 📊 Processed Patient Data
     └─ patientFName: Norma
     └─ patientLName: Dyer
     └─ dob: 11/13/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2158031
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/22/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:09:49] 🔄 
🔄 Step 4: Extracting order data...
[18:09:52] ℹ️  Order extraction - MRN: '2158031'
[18:09:52] ℹ️  Order extraction - Sex: 'FEMALE'
[18:09:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:09:52] ℹ️  Order extraction - Payer Source: ''
[18:09:52] ✅ Order data extraction completed successfully
[18:09:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:09:52] ℹ️  Using MRN from patient data: '2158031' over '2158031'
[18:09:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:09:52] ✅ Patient name cross-validation successful
[18:09:52] ✅    ✅ Data merged successfully
[18:09:54] ✅    ✅ Order data extracted and validated
[18:09:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:09:54] [DOC: 9259526] ✅ Patient found in local cache: Norma Dyer, ID: 5ca2359c-d429-4962-bcd9-bc06407ed3cc
[18:09:54] ✅    ✅ Existing patient found with ID: 5ca2359c-d429-4962-bcd9-bc06407ed3cc
[18:09:54] 🔄 
🔄 Step 6: Pushing order to API...
[18:09:54] [DOC: 9259526] ℹ️  Pushing order via API for patient ID: 5ca2359c-d429-4962-bcd9-bc06407ed3cc
[18:09:55] [DOC: 9259526] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13707"}
[18:09:55] ❌    ❌ Failed to push order
[18:09:55] 🔄 
🔄 Step 7: Writing to CSV...
[18:09:55] [DOC: 9259526] ℹ️  Calculated age: 93 from DOB: 11/13/1931
[18:09:55] [DOC: 9259526] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:09:55] [DOC: 9259526] ℹ️  Payer Source extracted: ''
[18:09:55] [DOC: 9259526] ℹ️  Diagnosis codes being written:
[18:09:55] [DOC: 9259526] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:09:55] [DOC: 9259526] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:09:55] [DOC: 9259526] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:09:55] [DOC: 9259526] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:09:55] [DOC: 9259526] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:09:55] [DOC: 9259526] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:09:55] [DOC: 9259526] ✅ Patient data written to CSV: Norma Dyer | Sex: FEMALE | Age: 93 | Service: Skilled Nursing | Payer:  | MRN: 2158031
[18:09:55] ✅    ✅ Document 9259526 processed and saved successfully
[18:09:55] 🔄 
🔄 Step 8: Saving API details...
[18:09:55] [DOC: 9259526] ℹ️  API push details saved for document 9259526
[18:09:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9259507                         ║
================================================================================
[18:09:55] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:09:55] ℹ️  Date: 04/24/2025
[18:09:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:09:56] [DOC: 9259507] ✅ Text extracted using pdfplumber (1396 chars)
[18:09:56] ✅    ✅ Text extracted using pdfplumber (1396 chars)
[18:09:56] 🔄 
🔄 Step 2: Extracting patient data...
[18:09:59] ℹ️  AI extracted raw sex value: 'M'
[18:09:59] ℹ️  AI extracted service line: 'RN'
[18:09:59] ℹ️  AI extracted payer source: ''
[18:09:59] ℹ️  AI extracted diagnoses:
[18:09:59] ℹ️    - Diagnosis 1: 'None'
[18:09:59] ℹ️    - Diagnosis 2: 'None'
[18:09:59] ℹ️    - Diagnosis 3: 'None'
[18:09:59] ℹ️    - Diagnosis 4: 'None'
[18:09:59] ℹ️    - Diagnosis 5: 'None'
[18:09:59] ℹ️    - Diagnosis 6: 'None'
[18:09:59] ℹ️  Final extracted MRN: '2300646'
[18:09:59] ℹ️  Final extracted Sex: 'MALE'
[18:09:59] ℹ️  Final extracted Service Line: 'RN'
[18:09:59] ℹ️  Final extracted Payer Source: ''
[18:09:59] ✅ Patient data extraction completed successfully
[18:09:59] ✅    ✅ Patient data extracted successfully
[18:09:59] 📊 Patient Response
     └─ patientFName: Luis
     └─ patientLName: Canto
     └─ dob: 07/23/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2300646
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:09:59] ✅    ✅ Patient identified: Luis Canto
[18:09:59] ✅    ✅ Patient name validation passed
[18:09:59] 🔄 
🔄 Step 3: Processing patient dates...
[18:09:59] [DOC: 9259507] ℹ️  DOB normalized: 07/23/1942
[18:09:59] [DOC: 9259507] ✅ Patient date processing completed successfully
[18:09:59] ✅    ✅ Date processing completed
[18:09:59] 📊 Processed Patient Data
     └─ patientFName: Luis
     └─ patientLName: Canto
     └─ dob: 07/23/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2300646
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[18:09:59] 🔄 
🔄 Step 4: Extracting order data...
[18:10:01] ℹ️  Order extraction - MRN: '2300646'
[18:10:01] ℹ️  Order extraction - Sex: 'MALE'
[18:10:01] ℹ️  Order extraction - Service Line: ''
[18:10:01] ℹ️  Order extraction - Payer Source: ''
[18:10:01] ✅ Order data extraction completed successfully
[18:10:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:10:01] ℹ️  Using MRN from patient data: '2300646' over '2300646'
[18:10:01] ℹ️  Using service line from patient data: 'RN'
[18:10:01] ✅ Patient name cross-validation successful
[18:10:01] ✅    ✅ Data merged successfully
[18:10:02] ✅    ✅ Order data extracted and validated
[18:10:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:10:32] [DOC: 9259507] ✅ Patient exists in API: Luis Canto, ID: d02d626b-38f6-46bb-92b6-df8f8e99574c
[18:10:32] ✅    ✅ Existing patient found with ID: d02d626b-38f6-46bb-92b6-df8f8e99574c
[18:10:32] 🔄 
🔄 Step 6: Pushing order to API...
[18:10:32] [DOC: 9259507] ℹ️  Pushing order via API for patient ID: d02d626b-38f6-46bb-92b6-df8f8e99574c
[18:10:34] [DOC: 9259507] ❌ Order push failed with status 201: {"id":"3ee3fde7-05a1-4799-b237-3bd1e9ad3e5a","orderWAVId":"ORD19979","orderNo":"1084780, 1084781","orderDate":"04/22/2025","startOfCare":"02/14/2025","episodeStartDate":"02/14/2025","episodeEndDate":"04/14/2025","documentID":"9259507","mrn":"2300646","patientName":"Canto,Luis A","sentToPhysicianDate":"04/24/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/07/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"d02d626b-38f6-46bb-92b6-df8f8e99574c","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[18:10:34] ❌    ❌ Failed to push order
[18:10:34] 🔄 
🔄 Step 7: Writing to CSV...
[18:10:34] [DOC: 9259507] ℹ️  Calculated age: 82 from DOB: 07/23/1942
[18:10:34] [DOC: 9259507] ℹ️  Service Line extracted: 'RN'
[18:10:34] [DOC: 9259507] ℹ️  Payer Source extracted: ''
[18:10:34] [DOC: 9259507] ℹ️  Diagnosis codes being written:
[18:10:34] [DOC: 9259507] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:10:34] [DOC: 9259507] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:10:34] [DOC: 9259507] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:10:34] [DOC: 9259507] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:10:34] [DOC: 9259507] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:10:34] [DOC: 9259507] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:10:34] [DOC: 9259507] ✅ Patient data written to CSV: Luis Canto | Sex: MALE | Age: 82 | Service: RN | Payer:  | MRN: 2300646
[18:10:34] ✅    ✅ Document 9259507 processed and saved successfully
[18:10:34] 🔄 
🔄 Step 8: Saving API details...
[18:10:34] [DOC: 9259507] ℹ️  API push details saved for document 9259507
[18:10:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9259504                         ║
================================================================================
[18:10:34] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:10:34] ℹ️  Date: 04/24/2025
[18:10:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:10:38] [DOC: 9259504] ✅ Text extracted using pdfplumber (19860 chars)
[18:10:38] ✅    ✅ Text extracted using pdfplumber (19860 chars)
[18:10:38] 🔄 
🔄 Step 2: Extracting patient data...
[18:10:41] ℹ️  AI extracted raw sex value: 'M'
[18:10:41] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[18:10:41] ℹ️  AI extracted payer source: 'None'
[18:10:41] ℹ️  AI extracted diagnoses:
[18:10:41] ℹ️    - Diagnosis 1: 'I21.02'
[18:10:41] ℹ️    - Diagnosis 2: 'I25.10'
[18:10:41] ℹ️    - Diagnosis 3: 'I11.0'
[18:10:41] ℹ️    - Diagnosis 4: 'I50.23'
[18:10:41] ℹ️    - Diagnosis 5: 'R62.7'
[18:10:41] ℹ️    - Diagnosis 6: 'C25.1'
[18:10:41] ℹ️  Final extracted MRN: '2255954'
[18:10:41] ℹ️  Final extracted Sex: 'MALE'
[18:10:41] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[18:10:41] ℹ️  Final extracted Payer Source: ''
[18:10:41] ✅ Patient data extraction completed successfully
[18:10:41] ✅    ✅ Patient data extracted successfully
[18:10:41] 📊 Patient Response
     └─ patientFName: Eugene
     └─ patientLName: Botelho
     └─ dob: 08/31/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 2255954
     └─ billingProvider: Michael A. Hait
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: None
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '06/11/2025', 'firstDiagnosis': 'I21.02', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.23', 'fifthDiagnosis': 'R62.7', 'sixthDiagnosis': 'C25.1'}]
[18:10:41] ✅    ✅ Patient identified: Eugene Botelho
[18:10:41] ✅    ✅ Patient name validation passed
[18:10:41] 🔄 
🔄 Step 3: Processing patient dates...
[18:10:41] [DOC: 9259504] ℹ️  DOB normalized: 08/31/1937
[18:10:41] [DOC: 9259504] ℹ️  Episode startOfCare normalized: 04/12/2025
[18:10:41] [DOC: 9259504] ℹ️  Episode startOfEpisode normalized: 04/13/2025
[18:10:41] [DOC: 9259504] ℹ️  Episode endOfEpisode normalized: 06/11/2025
[18:10:41] [DOC: 9259504] ✅ Patient date processing completed successfully
[18:10:41] ✅    ✅ Date processing completed
[18:10:41] 📊 Processed Patient Data
     └─ patientFName: Eugene
     └─ patientLName: Botelho
     └─ dob: 08/31/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 2255954
     └─ billingProvider: Michael A. Hait
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '06/11/2025', 'firstDiagnosis': 'I21.02', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.23', 'fifthDiagnosis': 'R62.7', 'sixthDiagnosis': 'C25.1'}]
[18:10:41] 🔄 
🔄 Step 4: Extracting order data...
[18:10:44] ℹ️  Order extraction - MRN: '2255954'
[18:10:44] ℹ️  Order extraction - Sex: 'MALE'
[18:10:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[18:10:44] ℹ️  Order extraction - Payer Source: ''
[18:10:44] ✅ Order data extraction completed successfully
[18:10:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:10:44] ℹ️  Using MRN from patient data: '2255954' over '2255954'
[18:10:44] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[18:10:44] ✅ Patient name cross-validation successful
[18:10:44] ✅    ✅ Data merged successfully
[18:10:45] ✅    ✅ Order data extracted and validated
[18:10:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:10:51] [DOC: 9259504] ✅ Patient exists in API: Eugene Botelho, ID: 0b53f9ae-8c88-4f4e-bc61-a03f12d40821
[18:10:51] ✅    ✅ Existing patient found with ID: 0b53f9ae-8c88-4f4e-bc61-a03f12d40821
[18:10:51] 🔄 
🔄 Step 6: Pushing order to API...
[18:10:51] [DOC: 9259504] ℹ️  Pushing order via API for patient ID: 0b53f9ae-8c88-4f4e-bc61-a03f12d40821
[18:10:53] [DOC: 9259504] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13217"}
[18:10:53] ❌    ❌ Failed to push order
[18:10:53] 🔄 
🔄 Step 7: Writing to CSV...
[18:10:53] [DOC: 9259504] ℹ️  Calculated age: 87 from DOB: 08/31/1937
[18:10:53] [DOC: 9259504] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[18:10:53] [DOC: 9259504] ℹ️  Payer Source extracted: ''
[18:10:53] [DOC: 9259504] ℹ️  Diagnosis codes being written:
[18:10:53] [DOC: 9259504] ℹ️    - Latest_Episode_Firstdiagnosis: 'I21.02'
[18:10:53] [DOC: 9259504] ℹ️    - Latest_Episode_Seconddiagnosis: 'I25.10'
[18:10:53] [DOC: 9259504] ℹ️    - Latest_Episode_Thirddiagnosis: 'I11.0'
[18:10:53] [DOC: 9259504] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.23'
[18:10:53] [DOC: 9259504] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R62.7'
[18:10:53] [DOC: 9259504] ℹ️    - Latest_Episode_Sixthdiagnosis: 'C25.1'
[18:10:53] [DOC: 9259504] ✅ Patient data written to CSV: Eugene Botelho | Sex: MALE | Age: 87 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 2255954
[18:10:53] ✅    ✅ Document 9259504 processed and saved successfully
[18:10:53] 🔄 
🔄 Step 8: Saving API details...
[18:10:53] [DOC: 9259504] ℹ️  API push details saved for document 9259504
[18:10:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9259497                         ║
================================================================================
[18:10:53] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:10:53] ℹ️  Date: 04/24/2025
[18:10:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:10:54] [DOC: 9259497] ✅ Text extracted using pdfplumber (2612 chars)
[18:10:54] ✅    ✅ Text extracted using pdfplumber (2612 chars)
[18:10:54] 🔄 
🔄 Step 2: Extracting patient data...
[18:10:57] ℹ️  AI extracted raw sex value: 'M'
[18:10:57] ℹ️  AI extracted service line: 'Physical Therapy'
[18:10:57] ℹ️  AI extracted payer source: ''
[18:10:57] ℹ️  AI extracted diagnoses:
[18:10:57] ℹ️    - Diagnosis 1: ''
[18:10:57] ℹ️    - Diagnosis 2: ''
[18:10:57] ℹ️    - Diagnosis 3: ''
[18:10:57] ℹ️    - Diagnosis 4: ''
[18:10:57] ℹ️    - Diagnosis 5: ''
[18:10:57] ℹ️    - Diagnosis 6: ''
[18:10:57] ℹ️  Final extracted MRN: '2005206'
[18:10:57] ℹ️  Final extracted Sex: 'MALE'
[18:10:57] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:10:57] ℹ️  Final extracted Payer Source: ''
[18:10:57] ✅ Patient data extraction completed successfully
[18:10:57] ✅    ✅ Patient data extracted successfully
[18:10:57] 📊 Patient Response
     └─ patientFName: Jose
     └─ patientLName: Baptista
     └─ dob: 07/02/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2005206
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:10:57] ✅    ✅ Patient identified: Jose Baptista
[18:10:57] ✅    ✅ Patient name validation passed
[18:10:57] 🔄 
🔄 Step 3: Processing patient dates...
[18:10:57] [DOC: 9259497] ℹ️  DOB normalized: 07/02/1934
[18:10:57] [DOC: 9259497] ✅ Patient date processing completed successfully
[18:10:57] ✅    ✅ Date processing completed
[18:10:57] 📊 Processed Patient Data
     └─ patientFName: Jose
     └─ patientLName: Baptista
     └─ dob: 07/02/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2005206
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:10:57] 🔄 
🔄 Step 4: Extracting order data...
[18:10:59] ℹ️  Order extraction - MRN: '2005206'
[18:10:59] ℹ️  Order extraction - Sex: 'MALE'
[18:10:59] ℹ️  Order extraction - Service Line: ''
[18:10:59] ℹ️  Order extraction - Payer Source: ''
[18:10:59] ✅ Order data extraction completed successfully
[18:10:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:10:59] ℹ️  Using MRN from patient data: '2005206' over '2005206'
[18:10:59] ℹ️  Using service line from patient data: 'Physical Therapy'
[18:10:59] ✅ Patient name cross-validation successful
[18:10:59] ✅    ✅ Data merged successfully
[18:11:01] ⚠️     ❌ Skipping - missing episode start date
[18:11:01] [DOC: 9259497] ℹ️  API push details saved for document 9259497
================================================================================
║                        Processing Document ID: 9259495                         ║
================================================================================
[18:11:01] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:11:01] ℹ️  Date: 04/24/2025
[18:11:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:11:15] [DOC: 9259495] ✅ Text extracted using pdfplumber (15814 chars)
[18:11:15] ✅    ✅ Text extracted using pdfplumber (15814 chars)
[18:11:15] 🔄 
🔄 Step 2: Extracting patient data...
[18:11:18] ℹ️  AI extracted raw sex value: 'M'
[18:11:18] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[18:11:18] ℹ️  AI extracted payer source: ''
[18:11:18] ℹ️  AI extracted diagnoses:
[18:11:18] ℹ️    - Diagnosis 1: 'G20.A1'
[18:11:18] ℹ️    - Diagnosis 2: 'I88.0'
[18:11:18] ℹ️    - Diagnosis 3: 'R53.1'
[18:11:18] ℹ️    - Diagnosis 4: 'I10'
[18:11:18] ℹ️    - Diagnosis 5: 'N13.30'
[18:11:18] ℹ️    - Diagnosis 6: 'N40.1'
[18:11:18] ℹ️  Final extracted MRN: '2211831'
[18:11:18] ℹ️  Final extracted Sex: 'MALE'
[18:11:18] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[18:11:18] ℹ️  Final extracted Payer Source: ''
[18:11:18] ✅ Patient data extraction completed successfully
[18:11:18] ✅    ✅ Patient data extracted successfully
[18:11:18] 📊 Patient Response
     └─ patientFName: Viriato
     └─ patientLName: Bala
     └─ dob: 11/12/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 2211831
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/10/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I88.0', 'thirdDiagnosis': 'R53.1', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'N13.30', 'sixthDiagnosis': 'N40.1'}]
[18:11:18] ✅    ✅ Patient identified: Viriato Bala
[18:11:18] ✅    ✅ Patient name validation passed
[18:11:18] 🔄 
🔄 Step 3: Processing patient dates...
[18:11:18] [DOC: 9259495] ℹ️  DOB normalized: 11/12/1937
[18:11:18] [DOC: 9259495] ℹ️  Episode startOfCare normalized: 02/10/2025
[18:11:18] [DOC: 9259495] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[18:11:18] [DOC: 9259495] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[18:11:18] [DOC: 9259495] ✅ Patient date processing completed successfully
[18:11:18] ✅    ✅ Date processing completed
[18:11:18] 📊 Processed Patient Data
     └─ patientFName: Viriato
     └─ patientLName: Bala
     └─ dob: 11/12/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 2211831
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/10/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I88.0', 'thirdDiagnosis': 'R53.1', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'N13.30', 'sixthDiagnosis': 'N40.1'}]
[18:11:18] 🔄 
🔄 Step 4: Extracting order data...
[18:11:21] ℹ️  Order extraction - MRN: '2211831'
[18:11:21] ℹ️  Order extraction - Sex: 'MALE'
[18:11:21] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy'
[18:11:21] ℹ️  Order extraction - Payer Source: ''
[18:11:21] ✅ Order data extraction completed successfully
[18:11:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:11:21] ℹ️  Using MRN from patient data: '2211831' over '2211831'
[18:11:21] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy'
[18:11:21] ✅ Patient name cross-validation successful
[18:11:21] ✅    ✅ Data merged successfully
[18:11:22] ✅    ✅ Order data extracted and validated
[18:11:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:11:22] [DOC: 9259495] ✅ Patient found in local cache: Viriato Bala, ID: b70c4038-8eef-4f28-b15b-74771b9982ae
[18:11:22] ✅    ✅ Existing patient found with ID: b70c4038-8eef-4f28-b15b-74771b9982ae
[18:11:22] 🔄 
🔄 Step 6: Pushing order to API...
[18:11:22] [DOC: 9259495] ℹ️  Pushing order via API for patient ID: b70c4038-8eef-4f28-b15b-74771b9982ae
[18:11:24] [DOC: 9259495] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12982"}
[18:11:24] ❌    ❌ Failed to push order
[18:11:24] 🔄 
🔄 Step 7: Writing to CSV...
[18:11:24] [DOC: 9259495] ℹ️  Calculated age: 87 from DOB: 11/12/1937
[18:11:24] [DOC: 9259495] ℹ️  Service Line extracted: 'Physical Therapy, Occupational Therapy'
[18:11:24] [DOC: 9259495] ℹ️  Payer Source extracted: ''
[18:11:24] [DOC: 9259495] ℹ️  Diagnosis codes being written:
[18:11:24] [DOC: 9259495] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[18:11:24] [DOC: 9259495] ℹ️    - Latest_Episode_Seconddiagnosis: 'I88.0'
[18:11:24] [DOC: 9259495] ℹ️    - Latest_Episode_Thirddiagnosis: 'R53.1'
[18:11:24] [DOC: 9259495] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[18:11:24] [DOC: 9259495] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N13.30'
[18:11:24] [DOC: 9259495] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N40.1'
[18:11:24] [DOC: 9259495] ✅ Patient data written to CSV: Viriato Bala | Sex: MALE | Age: 87 | Service: Physical Therapy, Occupational Therapy | Payer:  | MRN: 2211831
[18:11:24] ✅    ✅ Document 9259495 processed and saved successfully
[18:11:24] 🔄 
🔄 Step 8: Saving API details...
[18:11:24] [DOC: 9259495] ℹ️  API push details saved for document 9259495
[18:11:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258663                         ║
================================================================================
[18:11:24] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:11:24] ℹ️  Date: 04/24/2025
[18:11:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:11:27] [DOC: 9258663] ✅ Text extracted using pdfplumber (12349 chars)
[18:11:27] ✅    ✅ Text extracted using pdfplumber (12349 chars)
[18:11:27] 🔄 
🔄 Step 2: Extracting patient data...
[18:11:30] ℹ️  AI extracted raw sex value: 'F'
[18:11:30] ℹ️  AI extracted service line: 'OT'
[18:11:30] ℹ️  AI extracted payer source: 'None'
[18:11:30] ℹ️  AI extracted diagnoses:
[18:11:30] ℹ️    - Diagnosis 1: 'J44.1'
[18:11:30] ℹ️    - Diagnosis 2: 'M62.84'
[18:11:30] ℹ️    - Diagnosis 3: 'None'
[18:11:30] ℹ️    - Diagnosis 4: 'None'
[18:11:30] ℹ️    - Diagnosis 5: 'None'
[18:11:30] ℹ️    - Diagnosis 6: 'None'
[18:11:30] ℹ️  Final extracted MRN: 'MA250130025704'
[18:11:30] ℹ️  Final extracted Sex: 'FEMALE'
[18:11:30] ℹ️  Final extracted Service Line: 'OT'
[18:11:30] ℹ️  Final extracted Payer Source: ''
[18:11:30] ✅ Patient data extraction completed successfully
[18:11:30] ✅    ✅ Patient data extracted successfully
[18:11:30] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/05/2025', 'endOfEpisode': None, 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'M62.84', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:11:30] ✅    ✅ Patient identified: Theresa Racine
[18:11:30] ✅    ✅ Patient name validation passed
[18:11:30] 🔄 
🔄 Step 3: Processing patient dates...
[18:11:30] [DOC: 9258663] ℹ️  DOB normalized: 02/10/1957
[18:11:30] [DOC: 9258663] ℹ️  Episode startOfEpisode normalized: 03/05/2025
[18:11:30] [DOC: 9258663] ✅ Patient date processing completed successfully
[18:11:30] ✅    ✅ Date processing completed
[18:11:30] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/05/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'M62.84'}]
[18:11:30] 🔄 
🔄 Step 4: Extracting order data...
[18:11:32] ℹ️  Order extraction - MRN: 'MA250130025704'
[18:11:32] ℹ️  Order extraction - Sex: 'FEMALE'
[18:11:32] ℹ️  Order extraction - Service Line: 'OT'
[18:11:32] ℹ️  Order extraction - Payer Source: ''
[18:11:32] ✅ Order data extraction completed successfully
[18:11:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:11:32] ℹ️  Using MRN from patient data: 'MA250130025704' over 'MA250130025704'
[18:11:32] ℹ️  Service line consistent in both sources: 'OT'
[18:11:32] ✅ Patient name cross-validation successful
[18:11:32] ✅    ✅ Data merged successfully
[18:11:34] ⚠️     ❌ Skipping - missing episode start date
[18:11:34] [DOC: 9258663] ℹ️  API push details saved for document 9258663
================================================================================
║                        Processing Document ID: 9258661                         ║
================================================================================
[18:11:34] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:11:34] ℹ️  Date: 04/24/2025
[18:11:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:11:37] [DOC: 9258661] ✅ Text extracted using pdfplumber (1686 chars)
[18:11:37] ✅    ✅ Text extracted using pdfplumber (1686 chars)
[18:11:37] 🔄 
🔄 Step 2: Extracting patient data...
[18:11:40] ℹ️  AI extracted raw sex value: ''
[18:11:40] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:11:40] ℹ️  AI extracted payer source: ''
[18:11:40] ℹ️  AI extracted diagnoses:
[18:11:40] ℹ️    - Diagnosis 1: 'E11.65'
[18:11:40] ℹ️    - Diagnosis 2: 'I10'
[18:11:40] ℹ️    - Diagnosis 3: 'H54.8'
[18:11:40] ℹ️    - Diagnosis 4: 'None'
[18:11:40] ℹ️    - Diagnosis 5: 'None'
[18:11:40] ℹ️    - Diagnosis 6: 'None'
[18:11:40] ℹ️  Final extracted MRN: 'MA210907053505'
[18:11:40] ℹ️  Final extracted Sex: ''
[18:11:40] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:11:40] ℹ️  Final extracted Payer Source: ''
[18:11:40] ✅ Patient data extraction completed successfully
[18:11:40] ✅    ✅ Patient data extracted successfully
[18:11:40] 📊 Patient Response
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:11:40] ✅    ✅ Patient identified: Rolande Morrell
[18:11:40] ✅    ✅ Patient name validation passed
[18:11:40] 🔄 
🔄 Step 3: Processing patient dates...
[18:11:40] [DOC: 9258661] ℹ️  DOB normalized: 05/15/1935
[18:11:40] [DOC: 9258661] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[18:11:40] [DOC: 9258661] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[18:11:40] [DOC: 9258661] ✅ Patient date processing completed successfully
[18:11:40] ✅    ✅ Date processing completed
[18:11:40] 📊 Processed Patient Data
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8'}]
[18:11:40] 🔄 
🔄 Step 4: Extracting order data...
[18:11:42] ℹ️  Order extraction - MRN: 'MA210907053505'
[18:11:42] ℹ️  Order extraction - Sex: ''
[18:11:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:11:42] ℹ️  Order extraction - Payer Source: ''
[18:11:42] ✅ Order data extraction completed successfully
[18:11:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:11:42] ℹ️  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[18:11:42] ⚠️  Could not determine sex using any available method
[18:11:42] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:11:42] ✅ Patient name cross-validation successful
[18:11:42] ✅    ✅ Data merged successfully
[18:11:44] ✅    ✅ Order data extracted and validated
[18:11:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:11:44] [DOC: 9258661] ✅ Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[18:11:44] ✅    ✅ Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[18:11:44] 🔄 
🔄 Step 6: Pushing order to API...
[18:11:44] [DOC: 9258661] ℹ️  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[18:11:45] [DOC: 9258661] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14149"}
[18:11:45] ❌    ❌ Failed to push order
[18:11:45] 🔄 
🔄 Step 7: Writing to CSV...
[18:11:45] [DOC: 9258661] ℹ️  Calculated age: 90 from DOB: 05/15/1935
[18:11:45] [DOC: 9258661] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:11:45] [DOC: 9258661] ℹ️  Payer Source extracted: ''
[18:11:45] [DOC: 9258661] ℹ️  Diagnosis codes being written:
[18:11:45] [DOC: 9258661] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[18:11:45] [DOC: 9258661] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[18:11:45] [DOC: 9258661] ℹ️    - Latest_Episode_Thirddiagnosis: 'H54.8'
[18:11:45] [DOC: 9258661] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:11:45] [DOC: 9258661] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:11:45] [DOC: 9258661] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:11:45] [DOC: 9258661] ✅ Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: Skilled Nursing | Payer:  | MRN: MA210907053505
[18:11:45] ✅    ✅ Document 9258661 processed and saved successfully
[18:11:45] 🔄 
🔄 Step 8: Saving API details...
[18:11:45] [DOC: 9258661] ℹ️  API push details saved for document 9258661
[18:11:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258658                         ║
================================================================================
[18:11:45] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:11:45] ℹ️  Date: 04/24/2025
[18:11:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:11:47] [DOC: 9258658] ✅ Text extracted using pdfplumber (1147 chars)
[18:11:47] ✅    ✅ Text extracted using pdfplumber (1147 chars)
[18:11:47] 🔄 
🔄 Step 2: Extracting patient data...
[18:11:50] ℹ️  AI extracted raw sex value: ''
[18:11:50] ℹ️  AI extracted service line: 'Speech Therapy'
[18:11:50] ℹ️  AI extracted payer source: ''
[18:11:50] ℹ️  AI extracted diagnoses:
[18:11:50] ℹ️    - Diagnosis 1: 'E11.65'
[18:11:50] ℹ️    - Diagnosis 2: 'I10'
[18:11:50] ℹ️    - Diagnosis 3: 'H54.8'
[18:11:50] ℹ️    - Diagnosis 4: ''
[18:11:50] ℹ️    - Diagnosis 5: ''
[18:11:50] ℹ️    - Diagnosis 6: ''
[18:11:50] ℹ️  Final extracted MRN: 'MA210907053505'
[18:11:50] ℹ️  Final extracted Sex: ''
[18:11:50] ℹ️  Final extracted Service Line: 'Speech Therapy'
[18:11:50] ℹ️  Final extracted Payer Source: ''
[18:11:50] ✅ Patient data extraction completed successfully
[18:11:50] ✅    ✅ Patient data extracted successfully
[18:11:50] 📊 Patient Response
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:11:50] ✅    ✅ Patient identified: Rolande Morrell
[18:11:50] ✅    ✅ Patient name validation passed
[18:11:50] 🔄 
🔄 Step 3: Processing patient dates...
[18:11:50] [DOC: 9258658] ℹ️  DOB normalized: 05/15/1935
[18:11:50] [DOC: 9258658] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[18:11:50] [DOC: 9258658] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[18:11:50] [DOC: 9258658] ✅ Patient date processing completed successfully
[18:11:50] ✅    ✅ Date processing completed
[18:11:50] 📊 Processed Patient Data
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:11:50] 🔄 
🔄 Step 4: Extracting order data...
[18:11:53] ℹ️  Order extraction - MRN: 'MA210907053505'
[18:11:53] ℹ️  Order extraction - Sex: ''
[18:11:53] ℹ️  Order extraction - Service Line: 'Speech Therapy'
[18:11:53] ℹ️  Order extraction - Payer Source: ''
[18:11:53] ✅ Order data extraction completed successfully
[18:11:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:11:53] ℹ️  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[18:11:53] ⚠️  Could not determine sex using any available method
[18:11:53] ℹ️  Service line consistent in both sources: 'Speech Therapy'
[18:11:53] ✅ Patient name cross-validation successful
[18:11:53] ✅    ✅ Data merged successfully
[18:11:54] ✅    ✅ Order data extracted and validated
[18:11:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:11:54] [DOC: 9258658] ✅ Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[18:11:54] ✅    ✅ Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[18:11:54] 🔄 
🔄 Step 6: Pushing order to API...
[18:11:54] [DOC: 9258658] ℹ️  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[18:11:56] [DOC: 9258658] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14151"}
[18:11:56] ❌    ❌ Failed to push order
[18:11:56] 🔄 
🔄 Step 7: Writing to CSV...
[18:11:56] [DOC: 9258658] ℹ️  Calculated age: 90 from DOB: 05/15/1935
[18:11:56] [DOC: 9258658] ℹ️  Service Line extracted: 'Speech Therapy'
[18:11:56] [DOC: 9258658] ℹ️  Payer Source extracted: ''
[18:11:56] [DOC: 9258658] ℹ️  Diagnosis codes being written:
[18:11:56] [DOC: 9258658] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[18:11:56] [DOC: 9258658] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[18:11:56] [DOC: 9258658] ℹ️    - Latest_Episode_Thirddiagnosis: 'H54.8'
[18:11:56] [DOC: 9258658] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:11:56] [DOC: 9258658] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:11:56] [DOC: 9258658] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:11:56] [DOC: 9258658] ✅ Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: Speech Therapy | Payer:  | MRN: MA210907053505
[18:11:56] ✅    ✅ Document 9258658 processed and saved successfully
[18:11:56] 🔄 
🔄 Step 8: Saving API details...
[18:11:56] [DOC: 9258658] ℹ️  API push details saved for document 9258658
[18:11:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258657                         ║
================================================================================
[18:11:56] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:11:56] ℹ️  Date: 04/24/2025
[18:11:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:11:58] [DOC: 9258657] ✅ Text extracted using pdfplumber (1371 chars)
[18:11:58] ✅    ✅ Text extracted using pdfplumber (1371 chars)
[18:11:58] 🔄 
🔄 Step 2: Extracting patient data...
[18:12:02] ℹ️  AI extracted raw sex value: ''
[18:12:02] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:12:02] ℹ️  AI extracted payer source: ''
[18:12:02] ℹ️  AI extracted diagnoses:
[18:12:02] ℹ️    - Diagnosis 1: 'E11.65'
[18:12:02] ℹ️    - Diagnosis 2: 'I10'
[18:12:02] ℹ️    - Diagnosis 3: 'H54.8'
[18:12:02] ℹ️    - Diagnosis 4: 'None'
[18:12:02] ℹ️    - Diagnosis 5: 'None'
[18:12:02] ℹ️    - Diagnosis 6: 'None'
[18:12:02] ℹ️  Final extracted MRN: 'MA210907053505'
[18:12:02] ℹ️  Final extracted Sex: ''
[18:12:02] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:12:02] ℹ️  Final extracted Payer Source: ''
[18:12:02] ✅ Patient data extraction completed successfully
[18:12:02] ✅    ✅ Patient data extracted successfully
[18:12:02] 📊 Patient Response
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:12:02] ✅    ✅ Patient identified: Rolande Morrell
[18:12:02] ✅    ✅ Patient name validation passed
[18:12:02] 🔄 
🔄 Step 3: Processing patient dates...
[18:12:02] [DOC: 9258657] ℹ️  DOB normalized: 05/15/1935
[18:12:02] [DOC: 9258657] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[18:12:02] [DOC: 9258657] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[18:12:02] [DOC: 9258657] ✅ Patient date processing completed successfully
[18:12:02] ✅    ✅ Date processing completed
[18:12:02] 📊 Processed Patient Data
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8'}]
[18:12:02] 🔄 
🔄 Step 4: Extracting order data...
[18:12:04] ℹ️  Order extraction - MRN: 'MA210907053505'
[18:12:04] ℹ️  Order extraction - Sex: ''
[18:12:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:12:04] ℹ️  Order extraction - Payer Source: ''
[18:12:04] ✅ Order data extraction completed successfully
[18:12:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:12:04] ℹ️  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[18:12:04] ⚠️  Could not determine sex using any available method
[18:12:04] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:12:04] ✅ Patient name cross-validation successful
[18:12:04] ✅    ✅ Data merged successfully
[18:12:06] ✅    ✅ Order data extracted and validated
[18:12:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:12:06] [DOC: 9258657] ✅ Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[18:12:06] ✅    ✅ Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[18:12:06] 🔄 
🔄 Step 6: Pushing order to API...
[18:12:06] [DOC: 9258657] ℹ️  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[18:12:07] [DOC: 9258657] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14153"}
[18:12:07] ❌    ❌ Failed to push order
[18:12:07] 🔄 
🔄 Step 7: Writing to CSV...
[18:12:07] [DOC: 9258657] ℹ️  Calculated age: 90 from DOB: 05/15/1935
[18:12:07] [DOC: 9258657] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:12:07] [DOC: 9258657] ℹ️  Payer Source extracted: ''
[18:12:07] [DOC: 9258657] ℹ️  Diagnosis codes being written:
[18:12:07] [DOC: 9258657] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[18:12:07] [DOC: 9258657] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[18:12:07] [DOC: 9258657] ℹ️    - Latest_Episode_Thirddiagnosis: 'H54.8'
[18:12:07] [DOC: 9258657] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:12:07] [DOC: 9258657] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:12:07] [DOC: 9258657] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:12:07] [DOC: 9258657] ✅ Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: Skilled Nursing | Payer:  | MRN: MA210907053505
[18:12:07] ✅    ✅ Document 9258657 processed and saved successfully
[18:12:07] 🔄 
🔄 Step 8: Saving API details...
[18:12:07] [DOC: 9258657] ℹ️  API push details saved for document 9258657
[18:12:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258651                         ║
================================================================================
[18:12:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:12:07] ℹ️  Date: 04/24/2025
[18:12:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:12:10] [DOC: 9258651] ✅ Text extracted using pdfplumber (12704 chars)
[18:12:10] ✅    ✅ Text extracted using pdfplumber (12704 chars)
[18:12:10] 🔄 
🔄 Step 2: Extracting patient data...
[18:12:13] ℹ️  AI extracted raw sex value: 'M'
[18:12:13] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[18:12:13] ℹ️  AI extracted payer source: 'Medicare'
[18:12:13] ℹ️  AI extracted diagnoses:
[18:12:13] ℹ️    - Diagnosis 1: 'G30.9'
[18:12:13] ℹ️    - Diagnosis 2: 'F02.811'
[18:12:13] ℹ️    - Diagnosis 3: 'E03.9'
[18:12:13] ℹ️    - Diagnosis 4: 'E43'
[18:12:13] ℹ️    - Diagnosis 5: 'E87.6'
[18:12:13] ℹ️    - Diagnosis 6: 'N40.1'
[18:12:13] ℹ️  Final extracted MRN: 'MA211216013006'
[18:12:13] ℹ️  Final extracted Sex: 'MALE'
[18:12:13] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[18:12:13] ℹ️  Final extracted Payer Source: 'Medicare'
[18:12:13] ✅ Patient data extraction completed successfully
[18:12:13] ✅    ✅ Patient data extracted successfully
[18:12:13] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Fernandes
     └─ dob: 01/21/1930
     └─ patientSex: MALE
     └─ medicalRecordNo: MA211216013006
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 995-1597
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/18/2024', 'startOfEpisode': '11/17/2024', 'endOfEpisode': '01/15/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'F02.811', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': 'E43', 'fifthDiagnosis': 'E87.6', 'sixthDiagnosis': 'N40.1'}]
[18:12:13] ✅    ✅ Patient identified: Manuel Fernandes
[18:12:13] ✅    ✅ Patient name validation passed
[18:12:13] 🔄 
🔄 Step 3: Processing patient dates...
[18:12:13] [DOC: 9258651] ℹ️  DOB normalized: 01/21/1930
[18:12:13] [DOC: 9258651] ℹ️  Episode startOfCare normalized: 09/18/2024
[18:12:13] [DOC: 9258651] ℹ️  Episode startOfEpisode normalized: 11/17/2024
[18:12:13] [DOC: 9258651] ℹ️  Episode endOfEpisode normalized: 01/15/2025
[18:12:13] [DOC: 9258651] ✅ Patient date processing completed successfully
[18:12:13] ✅    ✅ Date processing completed
[18:12:13] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Fernandes
     └─ dob: 01/21/1930
     └─ patientSex: MALE
     └─ medicalRecordNo: MA211216013006
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 995-1597
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/18/2024', 'startOfEpisode': '11/17/2024', 'endOfEpisode': '01/15/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'F02.811', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': 'E43', 'fifthDiagnosis': 'E87.6', 'sixthDiagnosis': 'N40.1'}]
[18:12:13] 🔄 
🔄 Step 4: Extracting order data...
[18:12:16] ℹ️  Order extraction - MRN: 'MA211216013006'
[18:12:16] ℹ️  Order extraction - Sex: 'MALE'
[18:12:16] ℹ️  Order extraction - Service Line: 'PT'
[18:12:16] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:12:16] ✅ Order data extraction completed successfully
[18:12:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:12:16] ℹ️  Using MRN from patient data: 'MA211216013006' over 'MA211216013006'
[18:12:16] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy' + Order='PT' = 'Occupational Therapy, PT, Physical Therapy'
[18:12:16] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:12:16] ✅ Patient name cross-validation successful
[18:12:16] ✅    ✅ Data merged successfully
[18:12:17] ✅    ✅ Order data extracted and validated
[18:12:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:12:24] [DOC: 9258651] ✅ Patient exists in API: Manuel Fernandes, ID: 62f0944f-7b59-4e6e-9f8f-94e34c1716f6
[18:12:24] ✅    ✅ Existing patient found with ID: 62f0944f-7b59-4e6e-9f8f-94e34c1716f6
[18:12:24] 🔄 
🔄 Step 6: Pushing order to API...
[18:12:24] [DOC: 9258651] ℹ️  Pushing order via API for patient ID: 62f0944f-7b59-4e6e-9f8f-94e34c1716f6
[18:12:25] [DOC: 9258651] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13967"}
[18:12:25] ❌    ❌ Failed to push order
[18:12:25] 🔄 
🔄 Step 7: Writing to CSV...
[18:12:25] [DOC: 9258651] ℹ️  Calculated age: 95 from DOB: 01/21/1930
[18:12:25] [DOC: 9258651] ℹ️  Service Line extracted: 'Occupational Therapy, PT, Physical Therapy'
[18:12:25] [DOC: 9258651] ℹ️  Payer Source extracted: 'Medicare'
[18:12:25] [DOC: 9258651] ℹ️  Diagnosis codes being written:
[18:12:25] [DOC: 9258651] ℹ️    - Latest_Episode_Firstdiagnosis: 'G30.9'
[18:12:25] [DOC: 9258651] ℹ️    - Latest_Episode_Seconddiagnosis: 'F02.811'
[18:12:25] [DOC: 9258651] ℹ️    - Latest_Episode_Thirddiagnosis: 'E03.9'
[18:12:25] [DOC: 9258651] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E43'
[18:12:25] [DOC: 9258651] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E87.6'
[18:12:25] [DOC: 9258651] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N40.1'
[18:12:25] [DOC: 9258651] ✅ Patient data written to CSV: Manuel Fernandes | Sex: MALE | Age: 95 | Service: Occupational Therapy, PT, Physical Therapy | Payer: Medicare | MRN: MA211216013006
[18:12:25] ✅    ✅ Document 9258651 processed and saved successfully
[18:12:25] 🔄 
🔄 Step 8: Saving API details...
[18:12:25] [DOC: 9258651] ℹ️  API push details saved for document 9258651
[18:12:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258545                         ║
================================================================================
[18:12:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:12:25] ℹ️  Date: 04/24/2025
[18:12:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:12:28] [DOC: 9258545] ✅ Text extracted using pdfplumber (8646 chars)
[18:12:28] ✅    ✅ Text extracted using pdfplumber (8646 chars)
[18:12:28] 🔄 
🔄 Step 2: Extracting patient data...
[18:12:31] ℹ️  AI extracted raw sex value: 'F'
[18:12:31] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy, Skilled Nursing'
[18:12:31] ℹ️  AI extracted payer source: 'None'
[18:12:31] ℹ️  AI extracted diagnoses:
[18:12:31] ℹ️    - Diagnosis 1: 'I110'
[18:12:31] ℹ️    - Diagnosis 2: 'I5032'
[18:12:31] ℹ️    - Diagnosis 3: 'None'
[18:12:31] ℹ️    - Diagnosis 4: 'None'
[18:12:31] ℹ️    - Diagnosis 5: 'None'
[18:12:31] ℹ️    - Diagnosis 6: 'None'
[18:12:31] ℹ️  Final extracted MRN: 'MA221012094404'
[18:12:31] ℹ️  Final extracted Sex: 'FEMALE'
[18:12:31] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy, Skilled Nursing'
[18:12:31] ℹ️  Final extracted Payer Source: ''
[18:12:31] ✅ Patient data extraction completed successfully
[18:12:31] ✅    ✅ Patient data extracted successfully
[18:12:31] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I110', 'secondDiagnosis': 'I5032', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:12:31] ✅    ✅ Patient identified: Maria Ferreira
[18:12:31] ✅    ✅ Patient name validation passed
[18:12:31] 🔄 
🔄 Step 3: Processing patient dates...
[18:12:31] [DOC: 9258545] ℹ️  DOB normalized: 09/29/1944
[18:12:31] [DOC: 9258545] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[18:12:31] [DOC: 9258545] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[18:12:31] [DOC: 9258545] ✅ Patient date processing completed successfully
[18:12:31] ✅    ✅ Date processing completed
[18:12:31] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I110', 'secondDiagnosis': 'I5032'}]
[18:12:31] 🔄 
🔄 Step 4: Extracting order data...
[18:12:34] ℹ️  Order extraction - MRN: 'MA221012094404'
[18:12:34] ℹ️  Order extraction - Sex: 'FEMALE'
[18:12:34] ℹ️  Order extraction - Service Line: 'Physical Therapy,Occupational Therapy,Skilled Nursing'
[18:12:34] ℹ️  Order extraction - Payer Source: ''
[18:12:34] ✅ Order data extraction completed successfully
[18:12:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:12:34] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[18:12:34] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy, Skilled Nursing' + Order='Physical Therapy,Occupational Therapy,Skilled Nursing' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[18:12:34] ✅ Patient name cross-validation successful
[18:12:34] ✅    ✅ Data merged successfully
[18:12:35] ✅    ✅ Order data extracted and validated
[18:12:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:12:35] [DOC: 9258545] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:12:35] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:12:35] 🔄 
🔄 Step 6: Pushing order to API...
[18:12:35] [DOC: 9258545] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:12:36] [DOC: 9258545] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13984"}
[18:12:36] ❌    ❌ Failed to push order
[18:12:36] 🔄 
🔄 Step 7: Writing to CSV...
[18:12:36] [DOC: 9258545] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[18:12:36] [DOC: 9258545] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[18:12:36] [DOC: 9258545] ℹ️  Payer Source extracted: ''
[18:12:36] [DOC: 9258545] ℹ️  Diagnosis codes being written:
[18:12:36] [DOC: 9258545] ℹ️    - Latest_Episode_Firstdiagnosis: 'I110'
[18:12:36] [DOC: 9258545] ℹ️    - Latest_Episode_Seconddiagnosis: 'I5032'
[18:12:36] [DOC: 9258545] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:12:36] [DOC: 9258545] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:12:36] [DOC: 9258545] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:12:36] [DOC: 9258545] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:12:36] [DOC: 9258545] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Occupational Therapy, Physical Therapy, Skilled Nursing | Payer:  | MRN: MA221012094404
[18:12:36] ✅    ✅ Document 9258545 processed and saved successfully
[18:12:36] 🔄 
🔄 Step 8: Saving API details...
[18:12:36] [DOC: 9258545] ℹ️  API push details saved for document 9258545
[18:12:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258542                         ║
================================================================================
[18:12:36] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:12:36] ℹ️  Date: 04/24/2025
[18:12:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:12:39] [DOC: 9258542] ✅ Text extracted using pdfplumber (1474 chars)
[18:12:39] ✅    ✅ Text extracted using pdfplumber (1462 chars)
[18:12:39] 🔄 
🔄 Step 2: Extracting patient data...
[18:12:42] ℹ️  AI extracted raw sex value: ''
[18:12:42] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:12:42] ℹ️  AI extracted payer source: ''
[18:12:42] ℹ️  AI extracted diagnoses:
[18:12:42] ℹ️    - Diagnosis 1: 'I11.0'
[18:12:42] ℹ️    - Diagnosis 2: 'I50.32'
[18:12:42] ℹ️    - Diagnosis 3: 'None'
[18:12:42] ℹ️    - Diagnosis 4: 'None'
[18:12:42] ℹ️    - Diagnosis 5: 'None'
[18:12:42] ℹ️    - Diagnosis 6: 'None'
[18:12:42] ℹ️  Final extracted MRN: 'MA221012094404'
[18:12:42] ℹ️  Final extracted Sex: ''
[18:12:42] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:12:42] ℹ️  Final extracted Payer Source: ''
[18:12:42] ✅ Patient data extraction completed successfully
[18:12:42] ✅    ✅ Patient data extracted successfully
[18:12:42] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:12:42] ✅    ✅ Patient identified: Maria Ferreira
[18:12:42] ✅    ✅ Patient name validation passed
[18:12:42] 🔄 
🔄 Step 3: Processing patient dates...
[18:12:42] [DOC: 9258542] ℹ️  DOB normalized: 09/29/1944
[18:12:42] [DOC: 9258542] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[18:12:42] [DOC: 9258542] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[18:12:42] [DOC: 9258542] ✅ Patient date processing completed successfully
[18:12:42] ✅    ✅ Date processing completed
[18:12:42] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32'}]
[18:12:42] 🔄 
🔄 Step 4: Extracting order data...
[18:12:45] ℹ️  Order extraction - MRN: 'MA221012094404'
[18:12:45] ℹ️  Order extraction - Sex: ''
[18:12:45] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:12:45] ℹ️  Order extraction - Payer Source: ''
[18:12:45] ✅ Order data extraction completed successfully
[18:12:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:12:45] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[18:12:45] ℹ️  Inferred sex as FEMALE from name: Maria
[18:12:45] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:12:45] ✅ Patient name cross-validation successful
[18:12:45] ✅    ✅ Data merged successfully
[18:12:46] ✅    ✅ Order data extracted and validated
[18:12:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:12:46] [DOC: 9258542] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:12:46] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:12:46] 🔄 
🔄 Step 6: Pushing order to API...
[18:12:46] [DOC: 9258542] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:12:47] [DOC: 9258542] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13985"}
[18:12:47] ❌    ❌ Failed to push order
[18:12:47] 🔄 
🔄 Step 7: Writing to CSV...
[18:12:47] [DOC: 9258542] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[18:12:47] [DOC: 9258542] ℹ️  Service Line extracted: 'Occupational Therapy'
[18:12:47] [DOC: 9258542] ℹ️  Payer Source extracted: ''
[18:12:47] [DOC: 9258542] ℹ️  Diagnosis codes being written:
[18:12:47] [DOC: 9258542] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[18:12:47] [DOC: 9258542] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[18:12:47] [DOC: 9258542] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:12:47] [DOC: 9258542] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:12:47] [DOC: 9258542] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:12:47] [DOC: 9258542] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:12:47] [DOC: 9258542] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Occupational Therapy | Payer:  | MRN: MA221012094404
[18:12:47] ✅    ✅ Document 9258542 processed and saved successfully
[18:12:47] 🔄 
🔄 Step 8: Saving API details...
[18:12:47] [DOC: 9258542] ℹ️  API push details saved for document 9258542
[18:12:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258539                         ║
================================================================================
[18:12:47] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:12:47] ℹ️  Date: 04/24/2025
[18:12:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:12:50] [DOC: 9258539] ✅ Text extracted using pdfplumber (1382 chars)
[18:12:50] ✅    ✅ Text extracted using pdfplumber (1370 chars)
[18:12:50] 🔄 
🔄 Step 2: Extracting patient data...
[18:12:53] ℹ️  AI extracted raw sex value: ''
[18:12:53] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:12:53] ℹ️  AI extracted payer source: ''
[18:12:53] ℹ️  AI extracted diagnoses:
[18:12:53] ℹ️    - Diagnosis 1: 'I11.0'
[18:12:53] ℹ️    - Diagnosis 2: 'I50.32'
[18:12:53] ℹ️    - Diagnosis 3: 'None'
[18:12:53] ℹ️    - Diagnosis 4: 'None'
[18:12:53] ℹ️    - Diagnosis 5: 'None'
[18:12:53] ℹ️    - Diagnosis 6: 'None'
[18:12:53] ℹ️  Final extracted MRN: 'MA221012094404'
[18:12:53] ℹ️  Final extracted Sex: ''
[18:12:53] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:12:53] ℹ️  Final extracted Payer Source: ''
[18:12:53] ✅ Patient data extraction completed successfully
[18:12:53] ✅    ✅ Patient data extracted successfully
[18:12:53] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:12:53] ✅    ✅ Patient identified: Maria Ferreira
[18:12:53] ✅    ✅ Patient name validation passed
[18:12:53] 🔄 
🔄 Step 3: Processing patient dates...
[18:12:53] [DOC: 9258539] ℹ️  DOB normalized: 09/29/1944
[18:12:53] [DOC: 9258539] ℹ️  Episode startOfEpisode normalized: 01/29/2025
[18:12:53] [DOC: 9258539] ℹ️  Episode endOfEpisode normalized: 03/29/2025
[18:12:53] [DOC: 9258539] ✅ Patient date processing completed successfully
[18:12:53] ✅    ✅ Date processing completed
[18:12:53] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/29/2025', 'endOfEpisode': '03/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.32'}]
[18:12:53] 🔄 
🔄 Step 4: Extracting order data...
[18:12:55] ℹ️  Order extraction - MRN: 'MA221012094404'
[18:12:55] ℹ️  Order extraction - Sex: ''
[18:12:55] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:12:55] ℹ️  Order extraction - Payer Source: ''
[18:12:55] ✅ Order data extraction completed successfully
[18:12:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:12:55] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[18:12:55] ℹ️  Inferred sex as FEMALE from name: Maria
[18:12:55] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:12:55] ✅ Patient name cross-validation successful
[18:12:55] ✅    ✅ Data merged successfully
[18:12:57] ✅    ✅ Order data extracted and validated
[18:12:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:12:57] [DOC: 9258539] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:12:57] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:12:57] 🔄 
🔄 Step 6: Pushing order to API...
[18:12:57] [DOC: 9258539] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[18:12:58] [DOC: 9258539] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13986"}
[18:12:58] ❌    ❌ Failed to push order
[18:12:58] 🔄 
🔄 Step 7: Writing to CSV...
[18:12:58] [DOC: 9258539] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[18:12:58] [DOC: 9258539] ℹ️  Service Line extracted: 'Occupational Therapy'
[18:12:58] [DOC: 9258539] ℹ️  Payer Source extracted: ''
[18:12:58] [DOC: 9258539] ℹ️  Diagnosis codes being written:
[18:12:58] [DOC: 9258539] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[18:12:58] [DOC: 9258539] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[18:12:58] [DOC: 9258539] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:12:58] [DOC: 9258539] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:12:58] [DOC: 9258539] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:12:58] [DOC: 9258539] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:12:58] [DOC: 9258539] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Occupational Therapy | Payer:  | MRN: MA221012094404
[18:12:58] ✅    ✅ Document 9258539 processed and saved successfully
[18:12:58] 🔄 
🔄 Step 8: Saving API details...
[18:12:58] [DOC: 9258539] ℹ️  API push details saved for document 9258539
[18:12:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258533                         ║
================================================================================
[18:12:58] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:12:58] ℹ️  Date: 04/24/2025
[18:12:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:13:00] [DOC: 9258533] ✅ Text extracted using pdfplumber (1552 chars)
[18:13:00] ✅    ✅ Text extracted using pdfplumber (1552 chars)
[18:13:00] 🔄 
🔄 Step 2: Extracting patient data...
[18:13:03] ℹ️  AI extracted raw sex value: ''
[18:13:03] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:13:03] ℹ️  AI extracted payer source: ''
[18:13:03] ℹ️  AI extracted diagnoses:
[18:13:03] ℹ️    - Diagnosis 1: 'G40.909'
[18:13:03] ℹ️    - Diagnosis 2: 'F51.04'
[18:13:03] ℹ️    - Diagnosis 3: 'G81.94'
[18:13:03] ℹ️    - Diagnosis 4: ''
[18:13:03] ℹ️    - Diagnosis 5: ''
[18:13:03] ℹ️    - Diagnosis 6: ''
[18:13:03] ℹ️  Final extracted MRN: 'MA240318025203'
[18:13:03] ℹ️  Final extracted Sex: ''
[18:13:03] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:13:03] ℹ️  Final extracted Payer Source: ''
[18:13:03] ✅ Patient data extraction completed successfully
[18:13:03] ✅    ✅ Patient data extracted successfully
[18:13:03] 📊 Patient Response
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:13:03] ✅    ✅ Patient identified: Dale Brooks
[18:13:03] ✅    ✅ Patient name validation passed
[18:13:03] 🔄 
🔄 Step 3: Processing patient dates...
[18:13:03] [DOC: 9258533] ℹ️  DOB normalized: 02/24/1952
[18:13:03] [DOC: 9258533] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[18:13:03] [DOC: 9258533] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[18:13:03] [DOC: 9258533] ✅ Patient date processing completed successfully
[18:13:03] ✅    ✅ Date processing completed
[18:13:03] 📊 Processed Patient Data
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:13:03] 🔄 
🔄 Step 4: Extracting order data...
[18:13:06] ℹ️  Order extraction - MRN: 'MA240318025203'
[18:13:06] ℹ️  Order extraction - Sex: ''
[18:13:06] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:13:06] ℹ️  Order extraction - Payer Source: ''
[18:13:06] ✅ Order data extraction completed successfully
[18:13:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:13:06] ℹ️  Using MRN from patient data: 'MA240318025203' over 'MA240318025203'
[18:13:06] ⚠️  Could not determine sex using any available method
[18:13:06] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:13:06] ✅ Patient name cross-validation successful
[18:13:06] ✅    ✅ Data merged successfully
[18:13:07] ✅    ✅ Order data extracted and validated
[18:13:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:13:14] [DOC: 9258533] ✅ Patient exists in API: Dale Brooks, ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:13:14] ✅    ✅ Existing patient found with ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:13:14] 🔄 
🔄 Step 6: Pushing order to API...
[18:13:14] [DOC: 9258533] ℹ️  Pushing order via API for patient ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:13:15] [DOC: 9258533] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13361"}
[18:13:15] ❌    ❌ Failed to push order
[18:13:15] 🔄 
🔄 Step 7: Writing to CSV...
[18:13:15] [DOC: 9258533] ℹ️  Calculated age: 73 from DOB: 02/24/1952
[18:13:15] [DOC: 9258533] ℹ️  Service Line extracted: 'Occupational Therapy'
[18:13:15] [DOC: 9258533] ℹ️  Payer Source extracted: ''
[18:13:15] [DOC: 9258533] ℹ️  Diagnosis codes being written:
[18:13:15] [DOC: 9258533] ℹ️    - Latest_Episode_Firstdiagnosis: 'G40.909'
[18:13:15] [DOC: 9258533] ℹ️    - Latest_Episode_Seconddiagnosis: 'F51.04'
[18:13:15] [DOC: 9258533] ℹ️    - Latest_Episode_Thirddiagnosis: 'G81.94'
[18:13:15] [DOC: 9258533] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:13:15] [DOC: 9258533] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:13:15] [DOC: 9258533] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:13:15] [DOC: 9258533] ✅ Patient data written to CSV: Dale Brooks | Sex:  | Age: 73 | Service: Occupational Therapy | Payer:  | MRN: MA240318025203
[18:13:15] ✅    ✅ Document 9258533 processed and saved successfully
[18:13:15] 🔄 
🔄 Step 8: Saving API details...
[18:13:15] [DOC: 9258533] ℹ️  API push details saved for document 9258533
[18:13:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258532                         ║
================================================================================
[18:13:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:13:15] ℹ️  Date: 04/24/2025
[18:13:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:13:18] [DOC: 9258532] ✅ Text extracted using pdfplumber (1547 chars)
[18:13:18] ✅    ✅ Text extracted using pdfplumber (1547 chars)
[18:13:18] 🔄 
🔄 Step 2: Extracting patient data...
[18:13:21] ℹ️  AI extracted raw sex value: ''
[18:13:21] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:13:21] ℹ️  AI extracted payer source: ''
[18:13:21] ℹ️  AI extracted diagnoses:
[18:13:21] ℹ️    - Diagnosis 1: 'G40.909'
[18:13:21] ℹ️    - Diagnosis 2: 'F51.04'
[18:13:21] ℹ️    - Diagnosis 3: 'G81.94'
[18:13:21] ℹ️    - Diagnosis 4: ''
[18:13:21] ℹ️    - Diagnosis 5: ''
[18:13:21] ℹ️    - Diagnosis 6: ''
[18:13:21] ℹ️  Final extracted MRN: 'MA240318025203'
[18:13:21] ℹ️  Final extracted Sex: ''
[18:13:21] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:13:21] ℹ️  Final extracted Payer Source: ''
[18:13:21] ✅ Patient data extraction completed successfully
[18:13:21] ✅    ✅ Patient data extracted successfully
[18:13:21] 📊 Patient Response
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:13:21] ✅    ✅ Patient identified: Dale Brooks
[18:13:21] ✅    ✅ Patient name validation passed
[18:13:21] 🔄 
🔄 Step 3: Processing patient dates...
[18:13:21] [DOC: 9258532] ℹ️  DOB normalized: 02/24/1952
[18:13:21] [DOC: 9258532] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[18:13:21] [DOC: 9258532] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[18:13:21] [DOC: 9258532] ✅ Patient date processing completed successfully
[18:13:21] ✅    ✅ Date processing completed
[18:13:21] 📊 Processed Patient Data
     └─ patientFName: Dale
     └─ patientLName: Brooks
     └─ dob: 02/24/1952
     └─ patientSex: 
     └─ medicalRecordNo: MA240318025203
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'G40.909', 'secondDiagnosis': 'F51.04', 'thirdDiagnosis': 'G81.94', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:13:21] 🔄 
🔄 Step 4: Extracting order data...
[18:13:24] ℹ️  Order extraction - MRN: 'MA240318025203'
[18:13:24] ℹ️  Order extraction - Sex: ''
[18:13:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:13:24] ℹ️  Order extraction - Payer Source: ''
[18:13:24] ✅ Order data extraction completed successfully
[18:13:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:13:24] ℹ️  Using MRN from patient data: 'MA240318025203' over 'MA240318025203'
[18:13:24] ⚠️  Could not determine sex using any available method
[18:13:24] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:13:24] ✅ Patient name cross-validation successful
[18:13:24] ✅    ✅ Data merged successfully
[18:13:25] ✅    ✅ Order data extracted and validated
[18:13:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:13:25] [DOC: 9258532] ✅ Patient found in local cache: Dale Brooks, ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:13:25] ✅    ✅ Existing patient found with ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:13:25] 🔄 
🔄 Step 6: Pushing order to API...
[18:13:25] [DOC: 9258532] ℹ️  Pushing order via API for patient ID: 5c16ceb0-3da9-454d-9ce2-6401bfd89c5c
[18:13:26] [DOC: 9258532] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13362"}
[18:13:26] ❌    ❌ Failed to push order
[18:13:26] 🔄 
🔄 Step 7: Writing to CSV...
[18:13:26] [DOC: 9258532] ℹ️  Calculated age: 73 from DOB: 02/24/1952
[18:13:26] [DOC: 9258532] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:13:26] [DOC: 9258532] ℹ️  Payer Source extracted: ''
[18:13:26] [DOC: 9258532] ℹ️  Diagnosis codes being written:
[18:13:26] [DOC: 9258532] ℹ️    - Latest_Episode_Firstdiagnosis: 'G40.909'
[18:13:26] [DOC: 9258532] ℹ️    - Latest_Episode_Seconddiagnosis: 'F51.04'
[18:13:26] [DOC: 9258532] ℹ️    - Latest_Episode_Thirddiagnosis: 'G81.94'
[18:13:26] [DOC: 9258532] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:13:26] [DOC: 9258532] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:13:26] [DOC: 9258532] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:13:26] [DOC: 9258532] ✅ Patient data written to CSV: Dale Brooks | Sex:  | Age: 73 | Service: Skilled Nursing | Payer:  | MRN: MA240318025203
[18:13:26] ✅    ✅ Document 9258532 processed and saved successfully
[18:13:26] 🔄 
🔄 Step 8: Saving API details...
[18:13:26] [DOC: 9258532] ℹ️  API push details saved for document 9258532
[18:13:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258525                         ║
================================================================================
[18:13:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:13:26] ℹ️  Date: 04/24/2025
[18:13:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:13:29] [DOC: 9258525] ✅ Text extracted using pdfplumber (4255 chars)
[18:13:29] ✅    ✅ Text extracted using pdfplumber (4243 chars)
[18:13:29] 🔄 
🔄 Step 2: Extracting patient data...
[18:13:32] ℹ️  AI extracted raw sex value: ''
[18:13:32] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:13:32] ℹ️  AI extracted payer source: ''
[18:13:32] ℹ️  AI extracted diagnoses:
[18:13:32] ℹ️    - Diagnosis 1: 'E11.65'
[18:13:32] ℹ️    - Diagnosis 2: 'E03.9'
[18:13:32] ℹ️    - Diagnosis 3: 'E55.9'
[18:13:32] ℹ️    - Diagnosis 4: 'None'
[18:13:32] ℹ️    - Diagnosis 5: 'None'
[18:13:32] ℹ️    - Diagnosis 6: 'None'
[18:13:32] ℹ️  Final extracted MRN: 'MA241011025604'
[18:13:32] ℹ️  Final extracted Sex: ''
[18:13:32] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:13:32] ℹ️  Final extracted Payer Source: ''
[18:13:32] ✅ Patient data extraction completed successfully
[18:13:32] ✅    ✅ Patient data extracted successfully
[18:13:32] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Medeiros
     └─ dob: 02/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA241011025604
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E55.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:13:32] ✅    ✅ Patient identified: Maria Medeiros
[18:13:32] ✅    ✅ Patient name validation passed
[18:13:32] 🔄 
🔄 Step 3: Processing patient dates...
[18:13:32] [DOC: 9258525] ℹ️  DOB normalized: 02/04/1956
[18:13:32] [DOC: 9258525] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[18:13:32] [DOC: 9258525] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[18:13:32] [DOC: 9258525] ✅ Patient date processing completed successfully
[18:13:32] ✅    ✅ Date processing completed
[18:13:32] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Medeiros
     └─ dob: 02/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA241011025604
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E55.9'}]
[18:13:32] 🔄 
🔄 Step 4: Extracting order data...
[18:13:34] ℹ️  Order extraction - MRN: 'MA241011025604'
[18:13:34] ℹ️  Order extraction - Sex: ''
[18:13:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:13:34] ℹ️  Order extraction - Payer Source: ''
[18:13:34] ✅ Order data extraction completed successfully
[18:13:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:13:34] ℹ️  Using MRN from patient data: 'MA241011025604' over 'MA241011025604'
[18:13:34] ℹ️  Inferred sex as FEMALE from name: Maria
[18:13:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:13:34] ✅ Patient name cross-validation successful
[18:13:34] ✅    ✅ Data merged successfully
[18:13:36] ✅    ✅ Order data extracted and validated
[18:13:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:13:41] [DOC: 9258525] ℹ️  Patient not found in cache or API: Maria Medeiros
[18:13:41] [DOC: 9258525] ℹ️  Patient not found, creating new patient via API...
[18:13:41] [DOC: 9258525] ℹ️  Creating patient via API: Maria Medeiros
[18:13:42] [DOC: 9258525] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:13:42] ❌    ❌ Failed to create patient
[18:13:42] [DOC: 9258525] ℹ️  API push details saved for document 9258525
================================================================================
║                        Processing Document ID: 9258524                         ║
================================================================================
[18:13:42] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:13:42] ℹ️  Date: 04/24/2025
[18:13:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:13:45] [DOC: 9258524] ✅ Text extracted using pdfplumber (1488 chars)
[18:13:45] ✅    ✅ Text extracted using pdfplumber (1476 chars)
[18:13:45] 🔄 
🔄 Step 2: Extracting patient data...
[18:13:48] ℹ️  AI extracted raw sex value: ''
[18:13:48] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:13:48] ℹ️  AI extracted payer source: ''
[18:13:48] ℹ️  AI extracted diagnoses:
[18:13:48] ℹ️    - Diagnosis 1: 'E11.65'
[18:13:48] ℹ️    - Diagnosis 2: 'E03.9'
[18:13:48] ℹ️    - Diagnosis 3: 'E55.9'
[18:13:48] ℹ️    - Diagnosis 4: ''
[18:13:48] ℹ️    - Diagnosis 5: ''
[18:13:48] ℹ️    - Diagnosis 6: ''
[18:13:48] ℹ️  Final extracted MRN: 'MA241011025604'
[18:13:48] ℹ️  Final extracted Sex: ''
[18:13:48] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:13:48] ℹ️  Final extracted Payer Source: ''
[18:13:48] ✅ Patient data extraction completed successfully
[18:13:48] ✅    ✅ Patient data extracted successfully
[18:13:48] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Medeiros
     └─ dob: 02/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA241011025604
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E55.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:13:48] ✅    ✅ Patient identified: Maria Medeiros
[18:13:48] ✅    ✅ Patient name validation passed
[18:13:48] 🔄 
🔄 Step 3: Processing patient dates...
[18:13:48] [DOC: 9258524] ℹ️  DOB normalized: 02/04/1956
[18:13:48] [DOC: 9258524] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[18:13:48] [DOC: 9258524] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[18:13:48] [DOC: 9258524] ✅ Patient date processing completed successfully
[18:13:48] ✅    ✅ Date processing completed
[18:13:48] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Medeiros
     └─ dob: 02/04/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA241011025604
     └─ billingProvider: DAVID SHIH
     └─ npi: 1134197429
     └─ physicianNPI: 1134197429
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'E55.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:13:48] 🔄 
🔄 Step 4: Extracting order data...
[18:13:50] ℹ️  Order extraction - MRN: 'MA241011025604'
[18:13:50] ℹ️  Order extraction - Sex: ''
[18:13:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:13:50] ℹ️  Order extraction - Payer Source: ''
[18:13:50] ✅ Order data extraction completed successfully
[18:13:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:13:50] ℹ️  Using MRN from patient data: 'MA241011025604' over 'MA241011025604'
[18:13:50] ℹ️  Inferred sex as FEMALE from name: Maria
[18:13:50] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:13:50] ✅ Patient name cross-validation successful
[18:13:50] ✅    ✅ Data merged successfully
[18:13:52] ✅    ✅ Order data extracted and validated
[18:13:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:14:14] [DOC: 9258524] ℹ️  Patient not found in cache or API: Maria Medeiros
[18:14:14] [DOC: 9258524] ℹ️  Patient not found, creating new patient via API...
[18:14:14] [DOC: 9258524] ℹ️  Creating patient via API: Maria Medeiros
[18:14:15] [DOC: 9258524] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:14:15] ❌    ❌ Failed to create patient
[18:14:15] [DOC: 9258524] ℹ️  API push details saved for document 9258524
================================================================================
║                        Processing Document ID: 9258474                         ║
================================================================================
[18:14:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:14:15] ℹ️  Date: 04/24/2025
[18:14:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:14:21] [DOC: 9258474] ✅ Text extracted using pdfplumber (11370 chars)
[18:14:21] ✅    ✅ Text extracted using pdfplumber (11370 chars)
[18:14:21] 🔄 
🔄 Step 2: Extracting patient data...
[18:14:24] ℹ️  AI extracted raw sex value: 'F'
[18:14:24] ℹ️  AI extracted service line: 'OT'
[18:14:24] ℹ️  AI extracted payer source: 'None'
[18:14:24] ℹ️  AI extracted diagnoses:
[18:14:24] ℹ️    - Diagnosis 1: 'None'
[18:14:24] ℹ️    - Diagnosis 2: 'None'
[18:14:24] ℹ️    - Diagnosis 3: 'None'
[18:14:24] ℹ️    - Diagnosis 4: 'None'
[18:14:24] ℹ️    - Diagnosis 5: 'None'
[18:14:24] ℹ️    - Diagnosis 6: 'None'
[18:14:24] ℹ️  Final extracted MRN: 'MA201215069403'
[18:14:24] ℹ️  Final extracted Sex: 'FEMALE'
[18:14:24] ℹ️  Final extracted Service Line: 'OT'
[18:14:24] ℹ️  Final extracted Payer Source: ''
[18:14:24] ✅ Patient data extraction completed successfully
[18:14:24] ✅    ✅ Patient data extracted successfully
[18:14:24] 📊 Patient Response
     └─ patientFName: Kayla
     └─ patientLName: Debrito
     └─ dob: 06/03/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA201215069403
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Home Health Services
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/15/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:14:24] ✅    ✅ Patient identified: Kayla Debrito
[18:14:24] ✅    ✅ Patient name validation passed
[18:14:24] 🔄 
🔄 Step 3: Processing patient dates...
[18:14:24] [DOC: 9258474] ℹ️  DOB normalized: 06/03/1994
[18:14:24] [DOC: 9258474] ℹ️  Episode startOfEpisode normalized: 01/15/2025
[18:14:24] [DOC: 9258474] ✅ Patient date processing completed successfully
[18:14:24] ✅    ✅ Date processing completed
[18:14:24] 📊 Processed Patient Data
     └─ patientFName: Kayla
     └─ patientLName: Debrito
     └─ dob: 06/03/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA201215069403
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Home Health Services
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/15/2025'}]
[18:14:24] 🔄 
🔄 Step 4: Extracting order data...
[18:14:27] ℹ️  Order extraction - MRN: 'MA201215069403'
[18:14:27] ℹ️  Order extraction - Sex: 'FEMALE'
[18:14:27] ℹ️  Order extraction - Service Line: 'OT'
[18:14:27] ℹ️  Order extraction - Payer Source: ''
[18:14:27] ✅ Order data extraction completed successfully
[18:14:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:14:27] ℹ️  Using MRN from patient data: 'MA201215069403' over 'MA201215069403'
[18:14:27] ℹ️  Service line consistent in both sources: 'OT'
[18:14:27] ✅ Patient name cross-validation successful
[18:14:27] ✅    ✅ Data merged successfully
[18:14:28] ⚠️     ❌ Skipping - missing episode start date
[18:14:28] [DOC: 9258474] ℹ️  API push details saved for document 9258474
================================================================================
║                        Processing Document ID: 9258472                         ║
================================================================================
[18:14:28] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:14:28] ℹ️  Date: 04/24/2025
[18:14:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:14:30] [DOC: 9258472] ✅ Text extracted using pdfplumber (10564 chars)
[18:14:30] ✅    ✅ Text extracted using pdfplumber (10564 chars)
[18:14:30] 🔄 
🔄 Step 2: Extracting patient data...
[18:14:34] ℹ️  AI extracted raw sex value: 'F'
[18:14:34] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[18:14:34] ℹ️  AI extracted payer source: 'Medicare'
[18:14:34] ℹ️  AI extracted diagnoses:
[18:14:34] ℹ️    - Diagnosis 1: 'F84.2'
[18:14:34] ℹ️    - Diagnosis 2: 'G40.409'
[18:14:34] ℹ️    - Diagnosis 3: 'F79'
[18:14:34] ℹ️    - Diagnosis 4: 'F41.9'
[18:14:34] ℹ️    - Diagnosis 5: 'F51.4'
[18:14:34] ℹ️    - Diagnosis 6: 'G47.33'
[18:14:34] ℹ️  Final extracted MRN: '100022693186'
[18:14:34] ℹ️  Final extracted Sex: 'FEMALE'
[18:14:34] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[18:14:34] ℹ️  Final extracted Payer Source: 'Medicare'
[18:14:34] ✅ Patient data extraction completed successfully
[18:14:34] ✅    ✅ Patient data extracted successfully
[18:14:34] 📊 Patient Response
     └─ patientFName: Kayla
     └─ patientLName: Debrito
     └─ dob: 06/03/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100022693186
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 1881923936
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 997-0291
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/30/2024', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'F84.2', 'secondDiagnosis': 'G40.409', 'thirdDiagnosis': 'F79', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'F51.4', 'sixthDiagnosis': 'G47.33'}]
[18:14:34] ✅    ✅ Patient identified: Kayla Debrito
[18:14:34] ✅    ✅ Patient name validation passed
[18:14:34] 🔄 
🔄 Step 3: Processing patient dates...
[18:14:34] [DOC: 9258472] ℹ️  DOB normalized: 06/03/1994
[18:14:34] [DOC: 9258472] ℹ️  Episode startOfCare normalized: 12/30/2024
[18:14:34] [DOC: 9258472] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[18:14:34] [DOC: 9258472] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[18:14:34] [DOC: 9258472] ✅ Patient date processing completed successfully
[18:14:34] ✅    ✅ Date processing completed
[18:14:34] 📊 Processed Patient Data
     └─ patientFName: Kayla
     └─ patientLName: Debrito
     └─ dob: 06/03/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100022693186
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 1881923936
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 997-0291
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/30/2024', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'F84.2', 'secondDiagnosis': 'G40.409', 'thirdDiagnosis': 'F79', 'fourthDiagnosis': 'F41.9', 'fifthDiagnosis': 'F51.4', 'sixthDiagnosis': 'G47.33'}]
[18:14:34] 🔄 
🔄 Step 4: Extracting order data...
[18:14:37] ℹ️  Order extraction - MRN: '100022693186'
[18:14:37] ℹ️  Order extraction - Sex: 'FEMALE'
[18:14:37] ℹ️  Order extraction - Service Line: 'PT, OT'
[18:14:37] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:14:37] ✅ Order data extraction completed successfully
[18:14:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:14:37] ℹ️  Using MRN from patient data: '100022693186' over '100022693186'
[18:14:37] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy' + Order='PT, OT' = 'OT, Occupational Therapy, PT, Physical Therapy'
[18:14:37] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:14:37] ✅ Patient name cross-validation successful
[18:14:37] ✅    ✅ Data merged successfully
[18:14:38] ✅    ✅ Order data extracted and validated
[18:14:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:15:02] [DOC: 9258472] ✅ Patient exists in API: Kayla Debrito, ID: 5cfbdc9e-fd03-4084-b65d-8e701bf808bc
[18:15:02] ✅    ✅ Existing patient found with ID: 5cfbdc9e-fd03-4084-b65d-8e701bf808bc
[18:15:02] 🔄 
🔄 Step 6: Pushing order to API...
[18:15:02] [DOC: 9258472] ℹ️  Pushing order via API for patient ID: 5cfbdc9e-fd03-4084-b65d-8e701bf808bc
[18:15:04] [DOC: 9258472] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13795"}
[18:15:04] ❌    ❌ Failed to push order
[18:15:04] 🔄 
🔄 Step 7: Writing to CSV...
[18:15:04] [DOC: 9258472] ℹ️  Calculated age: 31 from DOB: 06/03/1994
[18:15:04] [DOC: 9258472] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy'
[18:15:04] [DOC: 9258472] ℹ️  Payer Source extracted: 'Medicare'
[18:15:04] [DOC: 9258472] ℹ️  Diagnosis codes being written:
[18:15:04] [DOC: 9258472] ℹ️    - Latest_Episode_Firstdiagnosis: 'F84.2'
[18:15:04] [DOC: 9258472] ℹ️    - Latest_Episode_Seconddiagnosis: 'G40.409'
[18:15:04] [DOC: 9258472] ℹ️    - Latest_Episode_Thirddiagnosis: 'F79'
[18:15:04] [DOC: 9258472] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F41.9'
[18:15:04] [DOC: 9258472] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F51.4'
[18:15:04] [DOC: 9258472] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G47.33'
[18:15:04] [DOC: 9258472] ✅ Patient data written to CSV: Kayla Debrito | Sex: FEMALE | Age: 31 | Service: OT, Occupational Therapy, PT, Physical Therapy | Payer: Medicare | MRN: 100022693186
[18:15:04] ✅    ✅ Document 9258472 processed and saved successfully
[18:15:04] 🔄 
🔄 Step 8: Saving API details...
[18:15:04] [DOC: 9258472] ℹ️  API push details saved for document 9258472
[18:15:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258448                         ║
================================================================================
[18:15:04] ℹ️  Agency: AccentCare Fall River
[18:15:04] ℹ️  Date: 04/24/2025
[18:15:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:15:08] [DOC: 9258448] ✅ Text extracted using pdfplumber (22844 chars)
[18:15:08] ✅    ✅ Text extracted using pdfplumber (22760 chars)
[18:15:08] 🔄 
🔄 Step 2: Extracting patient data...
[18:15:11] ℹ️  AI extracted raw sex value: 'M'
[18:15:11] ℹ️  AI extracted service line: 'Skilled Nursing, Speech Therapy'
[18:15:11] ℹ️  AI extracted payer source: 'Medicare'
[18:15:11] ℹ️  AI extracted diagnoses:
[18:15:11] ℹ️    - Diagnosis 1: 'G12.21'
[18:15:11] ℹ️    - Diagnosis 2: 'E05.00'
[18:15:11] ℹ️    - Diagnosis 3: 'E78.5'
[18:15:11] ℹ️    - Diagnosis 4: 'R13.10'
[18:15:11] ℹ️    - Diagnosis 5: 'Z43.1'
[18:15:11] ℹ️    - Diagnosis 6: 'Z85.46'
[18:15:11] ℹ️  Final extracted MRN: 'C0200237608801'
[18:15:11] ℹ️  Final extracted Sex: 'MALE'
[18:15:11] ℹ️  Final extracted Service Line: 'Skilled Nursing, Speech Therapy'
[18:15:11] ℹ️  Final extracted Payer Source: 'Medicare'
[18:15:11] ✅ Patient data extraction completed successfully
[18:15:11] ✅    ✅ Patient data extracted successfully
[18:15:11] 📊 Patient Response
     └─ patientFName: JOHANNES
     └─ patientLName: NAGTEGAAL
     └─ dob: 11/10/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: C0200237608801
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 1136 DRIFT RD
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Speech Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/17/2025', 'startOfEpisode': '04/17/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'G12.21', 'secondDiagnosis': 'E05.00', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'R13.10', 'fifthDiagnosis': 'Z43.1', 'sixthDiagnosis': 'Z85.46'}]
[18:15:11] ✅    ✅ Patient identified: JOHANNES NAGTEGAAL
[18:15:11] ✅    ✅ Patient name validation passed
[18:15:11] 🔄 
🔄 Step 3: Processing patient dates...
[18:15:11] [DOC: 9258448] ℹ️  DOB normalized: 11/10/1947
[18:15:11] [DOC: 9258448] ℹ️  Episode startOfCare normalized: 04/17/2025
[18:15:11] [DOC: 9258448] ℹ️  Episode startOfEpisode normalized: 04/17/2025
[18:15:11] [DOC: 9258448] ℹ️  Episode endOfEpisode normalized: 06/15/2025
[18:15:11] [DOC: 9258448] ✅ Patient date processing completed successfully
[18:15:11] ✅    ✅ Date processing completed
[18:15:11] 📊 Processed Patient Data
     └─ patientFName: JOHANNES
     └─ patientLName: NAGTEGAAL
     └─ dob: 11/10/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: C0200237608801
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 1136 DRIFT RD
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Speech Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/17/2025', 'startOfEpisode': '04/17/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'G12.21', 'secondDiagnosis': 'E05.00', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'R13.10', 'fifthDiagnosis': 'Z43.1', 'sixthDiagnosis': 'Z85.46'}]
[18:15:11] 🔄 
🔄 Step 4: Extracting order data...
[18:15:14] ℹ️  Order extraction - MRN: '227203'
[18:15:14] ℹ️  Order extraction - Sex: 'MALE'
[18:15:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Speech Therapy'
[18:15:14] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:15:14] ✅ Order data extraction completed successfully
[18:15:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:15:14] ℹ️  Using MRN from patient data: 'C0200237608801' over '227203'
[18:15:14] ℹ️  Combined service lines: Patient='Skilled Nursing, Speech Therapy' + Order='Skilled Nursing, Physical Therapy, Speech Therapy' = 'Physical Therapy, Skilled Nursing, Speech Therapy'
[18:15:14] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:15:14] ✅ Patient name cross-validation successful
[18:15:14] ✅    ✅ Data merged successfully
[18:15:16] ✅    ✅ Order data extracted and validated
[18:15:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:15:40] [DOC: 9258448] ℹ️  Patient not found in cache or API: JOHANNES NAGTEGAAL
[18:15:40] [DOC: 9258448] ℹ️  Patient not found, creating new patient via API...
[18:15:40] [DOC: 9258448] ℹ️  Creating patient via API: JOHANNES NAGTEGAAL
[18:15:41] [DOC: 9258448] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:15:41] ❌    ❌ Failed to create patient
[18:15:41] [DOC: 9258448] ℹ️  API push details saved for document 9258448
================================================================================
║                        Processing Document ID: 9258440                         ║
================================================================================
[18:15:41] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:15:41] ℹ️  Date: 04/24/2025
[18:15:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:15:43] [DOC: 9258440] ✅ Text extracted using pdfplumber (1240 chars)
[18:15:43] ✅    ✅ Text extracted using pdfplumber (1240 chars)
[18:15:43] 🔄 
🔄 Step 2: Extracting patient data...
[18:15:46] ℹ️  AI extracted raw sex value: ''
[18:15:46] ℹ️  AI extracted service line: 'Wound Care, Skilled Nursing'
[18:15:46] ℹ️  AI extracted payer source: ''
[18:15:46] ℹ️  AI extracted diagnoses:
[18:15:46] ℹ️    - Diagnosis 1: 'E10.65'
[18:15:46] ℹ️    - Diagnosis 2: 'G92.8'
[18:15:46] ℹ️    - Diagnosis 3: 'N17.9'
[18:15:46] ℹ️    - Diagnosis 4: ''
[18:15:46] ℹ️    - Diagnosis 5: ''
[18:15:46] ℹ️    - Diagnosis 6: ''
[18:15:46] ℹ️  Final extracted MRN: 'MA231019026103'
[18:15:46] ℹ️  Final extracted Sex: ''
[18:15:46] ℹ️  Final extracted Service Line: 'Wound Care, Skilled Nursing'
[18:15:46] ℹ️  Final extracted Payer Source: ''
[18:15:46] ✅ Patient data extraction completed successfully
[18:15:46] ✅    ✅ Patient data extracted successfully
[18:15:46] 📊 Patient Response
     └─ patientFName: Carl
     └─ patientLName: Weisman
     └─ dob: 02/05/1961
     └─ patientSex: 
     └─ medicalRecordNo: MA231019026103
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Wound Care, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/11/2025', 'endOfEpisode': '04/11/2025', 'firstDiagnosis': 'E10.65', 'secondDiagnosis': 'G92.8', 'thirdDiagnosis': 'N17.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:15:46] ✅    ✅ Patient identified: Carl Weisman
[18:15:46] ✅    ✅ Patient name validation passed
[18:15:46] 🔄 
🔄 Step 3: Processing patient dates...
[18:15:46] [DOC: 9258440] ℹ️  DOB normalized: 02/05/1961
[18:15:46] [DOC: 9258440] ℹ️  Episode startOfEpisode normalized: 02/11/2025
[18:15:46] [DOC: 9258440] ℹ️  Episode endOfEpisode normalized: 04/11/2025
[18:15:46] [DOC: 9258440] ✅ Patient date processing completed successfully
[18:15:46] ✅    ✅ Date processing completed
[18:15:46] 📊 Processed Patient Data
     └─ patientFName: Carl
     └─ patientLName: Weisman
     └─ dob: 02/05/1961
     └─ patientSex: 
     └─ medicalRecordNo: MA231019026103
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Wound Care, Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/11/2025', 'endOfEpisode': '04/11/2025', 'firstDiagnosis': 'E10.65', 'secondDiagnosis': 'G92.8', 'thirdDiagnosis': 'N17.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:15:46] 🔄 
🔄 Step 4: Extracting order data...
[18:15:49] ℹ️  Order extraction - MRN: 'MA231019026103'
[18:15:49] ℹ️  Order extraction - Sex: ''
[18:15:49] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:15:49] ℹ️  Order extraction - Payer Source: ''
[18:15:49] ✅ Order data extraction completed successfully
[18:15:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:15:49] ℹ️  Using MRN from patient data: 'MA231019026103' over 'MA231019026103'
[18:15:49] ⚠️  Could not determine sex using any available method
[18:15:49] ℹ️  Combined service lines: Patient='Wound Care, Skilled Nursing' + Order='Skilled Nursing' = 'Skilled Nursing, Wound Care'
[18:15:49] ✅ Patient name cross-validation successful
[18:15:49] ✅    ✅ Data merged successfully
[18:15:50] ✅    ✅ Order data extracted and validated
[18:15:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:16:35] [DOC: 9258440] ✅ Patient exists in API: Carl Weisman, ID: 66077570-f7f5-4f5e-b9df-6a7deaa8b8c6
[18:16:35] ✅    ✅ Existing patient found with ID: 66077570-f7f5-4f5e-b9df-6a7deaa8b8c6
[18:16:35] 🔄 
🔄 Step 6: Pushing order to API...
[18:16:35] [DOC: 9258440] ℹ️  Pushing order via API for patient ID: 66077570-f7f5-4f5e-b9df-6a7deaa8b8c6
[18:16:36] [DOC: 9258440] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14420"}
[18:16:36] ❌    ❌ Failed to push order
[18:16:36] 🔄 
🔄 Step 7: Writing to CSV...
[18:16:36] [DOC: 9258440] ℹ️  Calculated age: 64 from DOB: 02/05/1961
[18:16:36] [DOC: 9258440] ℹ️  Service Line extracted: 'Skilled Nursing, Wound Care'
[18:16:36] [DOC: 9258440] ℹ️  Payer Source extracted: ''
[18:16:36] [DOC: 9258440] ℹ️  Diagnosis codes being written:
[18:16:36] [DOC: 9258440] ℹ️    - Latest_Episode_Firstdiagnosis: 'E10.65'
[18:16:36] [DOC: 9258440] ℹ️    - Latest_Episode_Seconddiagnosis: 'G92.8'
[18:16:36] [DOC: 9258440] ℹ️    - Latest_Episode_Thirddiagnosis: 'N17.9'
[18:16:36] [DOC: 9258440] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:16:36] [DOC: 9258440] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:16:36] [DOC: 9258440] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:16:36] [DOC: 9258440] ✅ Patient data written to CSV: Carl Weisman | Sex:  | Age: 64 | Service: Skilled Nursing, Wound Care | Payer:  | MRN: MA231019026103
[18:16:36] ✅    ✅ Document 9258440 processed and saved successfully
[18:16:36] 🔄 
🔄 Step 8: Saving API details...
[18:16:36] [DOC: 9258440] ℹ️  API push details saved for document 9258440
[18:16:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258438                         ║
================================================================================
[18:16:36] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:16:36] ℹ️  Date: 04/24/2025
[18:16:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:16:39] [DOC: 9258438] ✅ Text extracted using pdfplumber (1202 chars)
[18:16:39] ✅    ✅ Text extracted using pdfplumber (1202 chars)
[18:16:39] 🔄 
🔄 Step 2: Extracting patient data...
[18:16:42] ℹ️  AI extracted raw sex value: ''
[18:16:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:16:42] ℹ️  AI extracted payer source: ''
[18:16:42] ℹ️  AI extracted diagnoses:
[18:16:42] ℹ️    - Diagnosis 1: 'S72.111'
[18:16:42] ℹ️    - Diagnosis 2: 'S82.091'
[18:16:42] ℹ️    - Diagnosis 3: 'M25.562'
[18:16:42] ℹ️    - Diagnosis 4: ''
[18:16:42] ℹ️    - Diagnosis 5: ''
[18:16:42] ℹ️    - Diagnosis 6: ''
[18:16:42] ℹ️  Final extracted MRN: 'MA250124104906'
[18:16:42] ℹ️  Final extracted Sex: ''
[18:16:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:16:42] ℹ️  Final extracted Payer Source: ''
[18:16:42] ✅ Patient data extraction completed successfully
[18:16:42] ✅    ✅ Patient data extracted successfully
[18:16:42] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: Carmo
     └─ dob: 10/06/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250124104906
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': 'S72.111', 'secondDiagnosis': 'S82.091', 'thirdDiagnosis': 'M25.562', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:16:42] ✅    ✅ Patient identified: George Carmo
[18:16:42] ✅    ✅ Patient name validation passed
[18:16:42] 🔄 
🔄 Step 3: Processing patient dates...
[18:16:42] [DOC: 9258438] ℹ️  DOB normalized: 10/06/1949
[18:16:42] [DOC: 9258438] ℹ️  Episode startOfEpisode normalized: 01/27/2025
[18:16:42] [DOC: 9258438] ℹ️  Episode endOfEpisode normalized: 03/27/2025
[18:16:42] [DOC: 9258438] ✅ Patient date processing completed successfully
[18:16:42] ✅    ✅ Date processing completed
[18:16:42] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: Carmo
     └─ dob: 10/06/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250124104906
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': 'S72.111', 'secondDiagnosis': 'S82.091', 'thirdDiagnosis': 'M25.562', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:16:42] 🔄 
🔄 Step 4: Extracting order data...
[18:16:44] ℹ️  Order extraction - MRN: 'MA250124104906'
[18:16:44] ℹ️  Order extraction - Sex: ''
[18:16:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:16:44] ℹ️  Order extraction - Payer Source: ''
[18:16:44] ✅ Order data extraction completed successfully
[18:16:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:16:44] ℹ️  Using MRN from patient data: 'MA250124104906' over 'MA250124104906'
[18:16:44] ℹ️  Inferred sex as MALE from name: George
[18:16:44] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:16:44] ✅ Patient name cross-validation successful
[18:16:44] ✅    ✅ Data merged successfully
[18:16:46] ✅    ✅ Order data extracted and validated
[18:16:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:16:52] [DOC: 9258438] ✅ Patient exists in API: George Carmo, ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[18:16:52] ✅    ✅ Existing patient found with ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[18:16:52] 🔄 
🔄 Step 6: Pushing order to API...
[18:16:52] [DOC: 9258438] ℹ️  Pushing order via API for patient ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[18:16:53] [DOC: 9258438] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13448"}
[18:16:53] ❌    ❌ Failed to push order
[18:16:53] 🔄 
🔄 Step 7: Writing to CSV...
[18:16:53] [DOC: 9258438] ℹ️  Calculated age: 75 from DOB: 10/06/1949
[18:16:53] [DOC: 9258438] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:16:53] [DOC: 9258438] ℹ️  Payer Source extracted: ''
[18:16:53] [DOC: 9258438] ℹ️  Diagnosis codes being written:
[18:16:53] [DOC: 9258438] ℹ️    - Latest_Episode_Firstdiagnosis: 'S72.111'
[18:16:53] [DOC: 9258438] ℹ️    - Latest_Episode_Seconddiagnosis: 'S82.091'
[18:16:53] [DOC: 9258438] ℹ️    - Latest_Episode_Thirddiagnosis: 'M25.562'
[18:16:53] [DOC: 9258438] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:16:53] [DOC: 9258438] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:16:53] [DOC: 9258438] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:16:53] [DOC: 9258438] ✅ Patient data written to CSV: George Carmo | Sex: MALE | Age: 75 | Service: Skilled Nursing | Payer:  | MRN: MA250124104906
[18:16:53] ✅    ✅ Document 9258438 processed and saved successfully
[18:16:53] 🔄 
🔄 Step 8: Saving API details...
[18:16:53] [DOC: 9258438] ℹ️  API push details saved for document 9258438
[18:16:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258437                         ║
================================================================================
[18:16:53] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:16:53] ℹ️  Date: 04/24/2025
[18:16:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:16:57] [DOC: 9258437] ✅ Text extracted using pdfplumber (1171 chars)
[18:16:57] ✅    ✅ Text extracted using pdfplumber (1171 chars)
[18:16:57] 🔄 
🔄 Step 2: Extracting patient data...
[18:17:00] ℹ️  AI extracted raw sex value: ''
[18:17:00] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:17:00] ℹ️  AI extracted payer source: ''
[18:17:00] ℹ️  AI extracted diagnoses:
[18:17:00] ℹ️    - Diagnosis 1: 'S72.111'
[18:17:00] ℹ️    - Diagnosis 2: 'S82.091'
[18:17:00] ℹ️    - Diagnosis 3: 'M25.562'
[18:17:00] ℹ️    - Diagnosis 4: 'None'
[18:17:00] ℹ️    - Diagnosis 5: 'None'
[18:17:00] ℹ️    - Diagnosis 6: 'None'
[18:17:00] ℹ️  Final extracted MRN: 'MA250124104906'
[18:17:00] ℹ️  Final extracted Sex: ''
[18:17:00] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:17:00] ℹ️  Final extracted Payer Source: ''
[18:17:00] ✅ Patient data extraction completed successfully
[18:17:00] ✅    ✅ Patient data extracted successfully
[18:17:00] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: Carmo
     └─ dob: 10/06/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250124104906
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': 'S72.111', 'secondDiagnosis': 'S82.091', 'thirdDiagnosis': 'M25.562', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:17:00] ✅    ✅ Patient identified: George Carmo
[18:17:00] ✅    ✅ Patient name validation passed
[18:17:00] 🔄 
🔄 Step 3: Processing patient dates...
[18:17:00] [DOC: 9258437] ℹ️  DOB normalized: 10/06/1949
[18:17:00] [DOC: 9258437] ℹ️  Episode startOfEpisode normalized: 01/27/2025
[18:17:00] [DOC: 9258437] ℹ️  Episode endOfEpisode normalized: 03/27/2025
[18:17:00] [DOC: 9258437] ✅ Patient date processing completed successfully
[18:17:00] ✅    ✅ Date processing completed
[18:17:00] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: Carmo
     └─ dob: 10/06/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250124104906
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': 'S72.111', 'secondDiagnosis': 'S82.091', 'thirdDiagnosis': 'M25.562'}]
[18:17:00] 🔄 
🔄 Step 4: Extracting order data...
[18:17:02] ℹ️  Order extraction - MRN: 'MA250124104906'
[18:17:02] ℹ️  Order extraction - Sex: ''
[18:17:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:17:02] ℹ️  Order extraction - Payer Source: ''
[18:17:02] ✅ Order data extraction completed successfully
[18:17:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:17:02] ℹ️  Using MRN from patient data: 'MA250124104906' over 'MA250124104906'
[18:17:02] ℹ️  Inferred sex as MALE from name: George
[18:17:02] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:17:02] ✅ Patient name cross-validation successful
[18:17:02] ✅    ✅ Data merged successfully
[18:17:04] ✅    ✅ Order data extracted and validated
[18:17:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:17:04] [DOC: 9258437] ✅ Patient found in local cache: George Carmo, ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[18:17:04] ✅    ✅ Existing patient found with ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[18:17:04] 🔄 
🔄 Step 6: Pushing order to API...
[18:17:04] [DOC: 9258437] ℹ️  Pushing order via API for patient ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[18:17:05] [DOC: 9258437] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13445"}
[18:17:05] ❌    ❌ Failed to push order
[18:17:05] 🔄 
🔄 Step 7: Writing to CSV...
[18:17:05] [DOC: 9258437] ℹ️  Calculated age: 75 from DOB: 10/06/1949
[18:17:05] [DOC: 9258437] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:17:05] [DOC: 9258437] ℹ️  Payer Source extracted: ''
[18:17:05] [DOC: 9258437] ℹ️  Diagnosis codes being written:
[18:17:05] [DOC: 9258437] ℹ️    - Latest_Episode_Firstdiagnosis: 'S72.111'
[18:17:05] [DOC: 9258437] ℹ️    - Latest_Episode_Seconddiagnosis: 'S82.091'
[18:17:05] [DOC: 9258437] ℹ️    - Latest_Episode_Thirddiagnosis: 'M25.562'
[18:17:05] [DOC: 9258437] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:17:05] [DOC: 9258437] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:17:05] [DOC: 9258437] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:17:05] [DOC: 9258437] ✅ Patient data written to CSV: George Carmo | Sex: MALE | Age: 75 | Service: Skilled Nursing | Payer:  | MRN: MA250124104906
[18:17:05] ✅    ✅ Document 9258437 processed and saved successfully
[18:17:05] 🔄 
🔄 Step 8: Saving API details...
[18:17:05] [DOC: 9258437] ℹ️  API push details saved for document 9258437
[18:17:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258435                         ║
================================================================================
[18:17:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:17:05] ℹ️  Date: 04/24/2025
[18:17:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:17:07] [DOC: 9258435] ✅ Text extracted using pdfplumber (1207 chars)
[18:17:07] ✅    ✅ Text extracted using pdfplumber (1207 chars)
[18:17:07] 🔄 
🔄 Step 2: Extracting patient data...
[18:17:10] ℹ️  AI extracted raw sex value: ''
[18:17:10] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:17:10] ℹ️  AI extracted payer source: ''
[18:17:10] ℹ️  AI extracted diagnoses:
[18:17:10] ℹ️    - Diagnosis 1: 'S72.111'
[18:17:10] ℹ️    - Diagnosis 2: 'S82.091'
[18:17:10] ℹ️    - Diagnosis 3: 'M25.562'
[18:17:10] ℹ️    - Diagnosis 4: 'None'
[18:17:10] ℹ️    - Diagnosis 5: 'None'
[18:17:10] ℹ️    - Diagnosis 6: 'None'
[18:17:10] ℹ️  Final extracted MRN: 'MA250124104906'
[18:17:10] ℹ️  Final extracted Sex: ''
[18:17:10] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:17:10] ℹ️  Final extracted Payer Source: ''
[18:17:10] ✅ Patient data extraction completed successfully
[18:17:10] ✅    ✅ Patient data extracted successfully
[18:17:10] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: Carmo
     └─ dob: 10/06/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250124104906
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': 'S72.111', 'secondDiagnosis': 'S82.091', 'thirdDiagnosis': 'M25.562', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:17:10] ✅    ✅ Patient identified: George Carmo
[18:17:10] ✅    ✅ Patient name validation passed
[18:17:10] 🔄 
🔄 Step 3: Processing patient dates...
[18:17:10] [DOC: 9258435] ℹ️  DOB normalized: 10/06/1949
[18:17:10] [DOC: 9258435] ℹ️  Episode startOfEpisode normalized: 01/27/2025
[18:17:10] [DOC: 9258435] ℹ️  Episode endOfEpisode normalized: 03/27/2025
[18:17:10] [DOC: 9258435] ✅ Patient date processing completed successfully
[18:17:10] ✅    ✅ Date processing completed
[18:17:10] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: Carmo
     └─ dob: 10/06/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250124104906
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': 'S72.111', 'secondDiagnosis': 'S82.091', 'thirdDiagnosis': 'M25.562'}]
[18:17:10] 🔄 
🔄 Step 4: Extracting order data...
[18:17:12] ℹ️  Order extraction - MRN: 'MA250124104906'
[18:17:12] ℹ️  Order extraction - Sex: ''
[18:17:12] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:17:12] ℹ️  Order extraction - Payer Source: ''
[18:17:12] ✅ Order data extraction completed successfully
[18:17:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:17:12] ℹ️  Using MRN from patient data: 'MA250124104906' over 'MA250124104906'
[18:17:12] ℹ️  Inferred sex as MALE from name: George
[18:17:12] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:17:12] ✅ Patient name cross-validation successful
[18:17:12] ✅    ✅ Data merged successfully
[18:17:14] ✅    ✅ Order data extracted and validated
[18:17:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:17:14] [DOC: 9258435] ✅ Patient found in local cache: George Carmo, ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[18:17:14] ✅    ✅ Existing patient found with ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[18:17:14] 🔄 
🔄 Step 6: Pushing order to API...
[18:17:14] [DOC: 9258435] ℹ️  Pushing order via API for patient ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[18:17:15] [DOC: 9258435] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13444"}
[18:17:15] ❌    ❌ Failed to push order
[18:17:15] 🔄 
🔄 Step 7: Writing to CSV...
[18:17:15] [DOC: 9258435] ℹ️  Calculated age: 75 from DOB: 10/06/1949
[18:17:15] [DOC: 9258435] ℹ️  Service Line extracted: 'Occupational Therapy'
[18:17:15] [DOC: 9258435] ℹ️  Payer Source extracted: ''
[18:17:15] [DOC: 9258435] ℹ️  Diagnosis codes being written:
[18:17:15] [DOC: 9258435] ℹ️    - Latest_Episode_Firstdiagnosis: 'S72.111'
[18:17:15] [DOC: 9258435] ℹ️    - Latest_Episode_Seconddiagnosis: 'S82.091'
[18:17:15] [DOC: 9258435] ℹ️    - Latest_Episode_Thirddiagnosis: 'M25.562'
[18:17:15] [DOC: 9258435] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:17:15] [DOC: 9258435] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:17:15] [DOC: 9258435] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:17:15] [DOC: 9258435] ✅ Patient data written to CSV: George Carmo | Sex: MALE | Age: 75 | Service: Occupational Therapy | Payer:  | MRN: MA250124104906
[18:17:15] ✅    ✅ Document 9258435 processed and saved successfully
[18:17:15] 🔄 
🔄 Step 8: Saving API details...
[18:17:15] [DOC: 9258435] ℹ️  API push details saved for document 9258435
[18:17:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258433                         ║
================================================================================
[18:17:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:17:15] ℹ️  Date: 04/24/2025
[18:17:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:17:22] [DOC: 9258433] ✅ Text extracted using pdfplumber (1280 chars)
[18:17:22] ✅    ✅ Text extracted using pdfplumber (1280 chars)
[18:17:22] 🔄 
🔄 Step 2: Extracting patient data...
[18:17:25] ℹ️  AI extracted raw sex value: ''
[18:17:25] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:17:25] ℹ️  AI extracted payer source: ''
[18:17:25] ℹ️  AI extracted diagnoses:
[18:17:25] ℹ️    - Diagnosis 1: 'S72.111'
[18:17:25] ℹ️    - Diagnosis 2: 'S82.091'
[18:17:25] ℹ️    - Diagnosis 3: 'M25.562'
[18:17:25] ℹ️    - Diagnosis 4: 'None'
[18:17:25] ℹ️    - Diagnosis 5: 'None'
[18:17:25] ℹ️    - Diagnosis 6: 'None'
[18:17:25] ℹ️  Final extracted MRN: 'MA250124104906'
[18:17:25] ℹ️  Final extracted Sex: ''
[18:17:25] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:17:25] ℹ️  Final extracted Payer Source: ''
[18:17:25] ✅ Patient data extraction completed successfully
[18:17:25] ✅    ✅ Patient data extracted successfully
[18:17:25] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: Carmo
     └─ dob: 10/06/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250124104906
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': 'S72.111', 'secondDiagnosis': 'S82.091', 'thirdDiagnosis': 'M25.562', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:17:25] ✅    ✅ Patient identified: George Carmo
[18:17:25] ✅    ✅ Patient name validation passed
[18:17:25] 🔄 
🔄 Step 3: Processing patient dates...
[18:17:25] [DOC: 9258433] ℹ️  DOB normalized: 10/06/1949
[18:17:25] [DOC: 9258433] ℹ️  Episode startOfEpisode normalized: 01/27/2025
[18:17:25] [DOC: 9258433] ℹ️  Episode endOfEpisode normalized: 03/27/2025
[18:17:25] [DOC: 9258433] ✅ Patient date processing completed successfully
[18:17:25] ✅    ✅ Date processing completed
[18:17:25] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: Carmo
     └─ dob: 10/06/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250124104906
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': 'S72.111', 'secondDiagnosis': 'S82.091', 'thirdDiagnosis': 'M25.562'}]
[18:17:25] 🔄 
🔄 Step 4: Extracting order data...
[18:17:27] ℹ️  Order extraction - MRN: 'MA250124104906'
[18:17:27] ℹ️  Order extraction - Sex: ''
[18:17:27] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:17:27] ℹ️  Order extraction - Payer Source: ''
[18:17:27] ✅ Order data extraction completed successfully
[18:17:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:17:27] ℹ️  Using MRN from patient data: 'MA250124104906' over 'MA250124104906'
[18:17:27] ℹ️  Inferred sex as MALE from name: George
[18:17:27] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:17:27] ✅ Patient name cross-validation successful
[18:17:27] ✅    ✅ Data merged successfully
[18:17:29] ✅    ✅ Order data extracted and validated
[18:17:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:17:29] [DOC: 9258433] ✅ Patient found in local cache: George Carmo, ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[18:17:29] ✅    ✅ Existing patient found with ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[18:17:29] 🔄 
🔄 Step 6: Pushing order to API...
[18:17:29] [DOC: 9258433] ℹ️  Pushing order via API for patient ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[18:17:30] [DOC: 9258433] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13449"}
[18:17:30] ❌    ❌ Failed to push order
[18:17:30] 🔄 
🔄 Step 7: Writing to CSV...
[18:17:30] [DOC: 9258433] ℹ️  Calculated age: 75 from DOB: 10/06/1949
[18:17:30] [DOC: 9258433] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:17:30] [DOC: 9258433] ℹ️  Payer Source extracted: ''
[18:17:30] [DOC: 9258433] ℹ️  Diagnosis codes being written:
[18:17:30] [DOC: 9258433] ℹ️    - Latest_Episode_Firstdiagnosis: 'S72.111'
[18:17:30] [DOC: 9258433] ℹ️    - Latest_Episode_Seconddiagnosis: 'S82.091'
[18:17:30] [DOC: 9258433] ℹ️    - Latest_Episode_Thirddiagnosis: 'M25.562'
[18:17:30] [DOC: 9258433] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:17:30] [DOC: 9258433] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:17:30] [DOC: 9258433] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:17:30] [DOC: 9258433] ✅ Patient data written to CSV: George Carmo | Sex: MALE | Age: 75 | Service: Skilled Nursing | Payer:  | MRN: MA250124104906
[18:17:30] ✅    ✅ Document 9258433 processed and saved successfully
[18:17:30] 🔄 
🔄 Step 8: Saving API details...
[18:17:30] [DOC: 9258433] ℹ️  API push details saved for document 9258433
[18:17:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258427                         ║
================================================================================
[18:17:30] ℹ️  Agency: Visiting Rehab & Nursing Services
[18:17:30] ℹ️  Date: 04/24/2025
[18:17:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:17:34] [DOC: 9258427] ✅ Text extracted using pdfplumber (8694 chars)
[18:17:34] ✅    ✅ Text extracted using pdfplumber (8694 chars)
[18:17:34] 🔄 
🔄 Step 2: Extracting patient data...
[18:17:37] ℹ️  AI extracted raw sex value: 'F'
[18:17:37] ℹ️  AI extracted service line: 'ST'
[18:17:37] ℹ️  AI extracted payer source: ''
[18:17:37] ℹ️  AI extracted diagnoses:
[18:17:37] ℹ️    - Diagnosis 1: 'R13.10'
[18:17:37] ℹ️    - Diagnosis 2: 'R13.12'
[18:17:37] ℹ️    - Diagnosis 3: ''
[18:17:37] ℹ️    - Diagnosis 4: ''
[18:17:37] ℹ️    - Diagnosis 5: ''
[18:17:37] ℹ️    - Diagnosis 6: ''
[18:17:37] ℹ️  Final extracted MRN: 'opbrMC6495'
[18:17:37] ℹ️  Final extracted Sex: 'FEMALE'
[18:17:37] ℹ️  Final extracted Service Line: 'ST'
[18:17:37] ℹ️  Final extracted Payer Source: ''
[18:17:37] ✅ Patient data extraction completed successfully
[18:17:37] ✅    ✅ Patient data extracted successfully
[18:17:37] 📊 Patient Response
     └─ patientFName: Anna
     └─ patientLName: Pedro
     └─ dob: 01/18/1968
     └─ patientSex: FEMALE
     └─ medicalRecordNo: opbrMC6495
     └─ billingProvider: Home Again Health Care, LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Home Again Health Care, LLC
     └─ address: 125 High Street , STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: 
     └─ phoneNumber: (877) 242-8771
     └─ serviceLine: ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/03/2025', 'startOfEpisode': '01/03/2025', 'endOfEpisode': '03/01/2025', 'firstDiagnosis': 'R13.10', 'secondDiagnosis': 'R13.12', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:17:37] ✅    ✅ Patient identified: Anna Pedro
[18:17:37] ✅    ✅ Patient name validation passed
[18:17:37] 🔄 
🔄 Step 3: Processing patient dates...
[18:17:37] [DOC: 9258427] ℹ️  DOB normalized: 01/18/1968
[18:17:37] [DOC: 9258427] ℹ️  Episode startOfCare normalized: 01/03/2025
[18:17:37] [DOC: 9258427] ℹ️  Episode startOfEpisode normalized: 01/03/2025
[18:17:37] [DOC: 9258427] ℹ️  Episode endOfEpisode normalized: 03/01/2025
[18:17:37] [DOC: 9258427] ✅ Patient date processing completed successfully
[18:17:37] ✅    ✅ Date processing completed
[18:17:37] 📊 Processed Patient Data
     └─ patientFName: Anna
     └─ patientLName: Pedro
     └─ dob: 01/18/1968
     └─ patientSex: FEMALE
     └─ medicalRecordNo: opbrMC6495
     └─ billingProvider: Home Again Health Care, LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Home Again Health Care, LLC
     └─ address: 125 High Street , STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: 
     └─ phoneNumber: (877) 242-8771
     └─ serviceLine: ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/03/2025', 'startOfEpisode': '01/03/2025', 'endOfEpisode': '03/01/2025', 'firstDiagnosis': 'R13.10', 'secondDiagnosis': 'R13.12', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:17:37] 🔄 
🔄 Step 4: Extracting order data...
[18:17:39] ℹ️  Order extraction - MRN: 'opbrMC6495'
[18:17:39] ℹ️  Order extraction - Sex: 'FEMALE'
[18:17:39] ℹ️  Order extraction - Service Line: 'ST'
[18:17:39] ℹ️  Order extraction - Payer Source: ''
[18:17:39] ✅ Order data extraction completed successfully
[18:17:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:17:39] ℹ️  Using MRN from patient data: 'opbrMC6495' over 'opbrMC6495'
[18:17:39] ℹ️  Service line consistent in both sources: 'ST'
[18:17:39] ✅ Patient name cross-validation successful
[18:17:39] ✅    ✅ Data merged successfully
[18:17:41] ✅    ✅ Order data extracted and validated
[18:17:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:17:58] [DOC: 9258427] ℹ️  Patient not found in cache or API: Anna Pedro
[18:17:58] [DOC: 9258427] ℹ️  Patient not found, creating new patient via API...
[18:17:58] [DOC: 9258427] ℹ️  Creating patient via API: Anna Pedro
[18:17:59] [DOC: 9258427] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:17:59] ❌    ❌ Failed to create patient
[18:17:59] [DOC: 9258427] ℹ️  API push details saved for document 9258427
================================================================================
║                        Processing Document ID: 9258426                         ║
================================================================================
[18:17:59] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:17:59] ℹ️  Date: 04/24/2025
[18:17:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:18:02] [DOC: 9258426] ✅ Text extracted using pdfplumber (1407 chars)
[18:18:02] ✅    ✅ Text extracted using pdfplumber (1407 chars)
[18:18:02] 🔄 
🔄 Step 2: Extracting patient data...
[18:18:05] ℹ️  AI extracted raw sex value: ''
[18:18:05] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:18:05] ℹ️  AI extracted payer source: ''
[18:18:05] ℹ️  AI extracted diagnoses:
[18:18:05] ℹ️    - Diagnosis 1: 'S72.111'
[18:18:05] ℹ️    - Diagnosis 2: 'S82.091'
[18:18:05] ℹ️    - Diagnosis 3: 'M25.562'
[18:18:05] ℹ️    - Diagnosis 4: 'None'
[18:18:05] ℹ️    - Diagnosis 5: 'None'
[18:18:05] ℹ️    - Diagnosis 6: 'None'
[18:18:05] ℹ️  Final extracted MRN: 'MA250124104906'
[18:18:05] ℹ️  Final extracted Sex: ''
[18:18:05] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:18:05] ℹ️  Final extracted Payer Source: ''
[18:18:05] ✅ Patient data extraction completed successfully
[18:18:05] ✅    ✅ Patient data extracted successfully
[18:18:05] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: Carmo
     └─ dob: 10/06/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250124104906
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': 'S72.111', 'secondDiagnosis': 'S82.091', 'thirdDiagnosis': 'M25.562', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:18:05] ✅    ✅ Patient identified: George Carmo
[18:18:05] ✅    ✅ Patient name validation passed
[18:18:05] 🔄 
🔄 Step 3: Processing patient dates...
[18:18:05] [DOC: 9258426] ℹ️  DOB normalized: 10/06/1949
[18:18:05] [DOC: 9258426] ℹ️  Episode startOfEpisode normalized: 01/27/2025
[18:18:05] [DOC: 9258426] ℹ️  Episode endOfEpisode normalized: 03/27/2025
[18:18:05] [DOC: 9258426] ✅ Patient date processing completed successfully
[18:18:05] ✅    ✅ Date processing completed
[18:18:05] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: Carmo
     └─ dob: 10/06/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250124104906
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/27/2025', 'endOfEpisode': '03/27/2025', 'firstDiagnosis': 'S72.111', 'secondDiagnosis': 'S82.091', 'thirdDiagnosis': 'M25.562'}]
[18:18:05] 🔄 
🔄 Step 4: Extracting order data...
[18:18:07] ℹ️  Order extraction - MRN: 'MA250124104906'
[18:18:07] ℹ️  Order extraction - Sex: ''
[18:18:07] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:18:07] ℹ️  Order extraction - Payer Source: ''
[18:18:07] ✅ Order data extraction completed successfully
[18:18:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:18:07] ℹ️  Using MRN from patient data: 'MA250124104906' over 'MA250124104906'
[18:18:07] ℹ️  Inferred sex as MALE from name: George
[18:18:07] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:18:07] ✅ Patient name cross-validation successful
[18:18:07] ✅    ✅ Data merged successfully
[18:18:08] ✅    ✅ Order data extracted and validated
[18:18:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:18:08] [DOC: 9258426] ✅ Patient found in local cache: George Carmo, ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[18:18:08] ✅    ✅ Existing patient found with ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[18:18:08] 🔄 
🔄 Step 6: Pushing order to API...
[18:18:08] [DOC: 9258426] ℹ️  Pushing order via API for patient ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[18:18:10] [DOC: 9258426] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13450"}
[18:18:10] ❌    ❌ Failed to push order
[18:18:10] 🔄 
🔄 Step 7: Writing to CSV...
[18:18:10] [DOC: 9258426] ℹ️  Calculated age: 75 from DOB: 10/06/1949
[18:18:10] [DOC: 9258426] ℹ️  Service Line extracted: 'Occupational Therapy'
[18:18:10] [DOC: 9258426] ℹ️  Payer Source extracted: ''
[18:18:10] [DOC: 9258426] ℹ️  Diagnosis codes being written:
[18:18:10] [DOC: 9258426] ℹ️    - Latest_Episode_Firstdiagnosis: 'S72.111'
[18:18:10] [DOC: 9258426] ℹ️    - Latest_Episode_Seconddiagnosis: 'S82.091'
[18:18:10] [DOC: 9258426] ℹ️    - Latest_Episode_Thirddiagnosis: 'M25.562'
[18:18:10] [DOC: 9258426] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:18:10] [DOC: 9258426] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:18:10] [DOC: 9258426] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:18:10] [DOC: 9258426] ✅ Patient data written to CSV: George Carmo | Sex: MALE | Age: 75 | Service: Occupational Therapy | Payer:  | MRN: MA250124104906
[18:18:10] ✅    ✅ Document 9258426 processed and saved successfully
[18:18:10] 🔄 
🔄 Step 8: Saving API details...
[18:18:10] [DOC: 9258426] ℹ️  API push details saved for document 9258426
[18:18:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258365                         ║
================================================================================
[18:18:10] ℹ️  Agency: Visiting Rehab & Nursing Services
[18:18:10] ℹ️  Date: 04/24/2025
[18:18:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:18:19] [DOC: 9258365] ✅ Text extracted using pdfplumber (14889 chars)
[18:18:19] ✅    ✅ Text extracted using pdfplumber (14889 chars)
[18:18:19] 🔄 
🔄 Step 2: Extracting patient data...
[18:18:23] ℹ️  AI extracted raw sex value: 'M'
[18:18:23] ℹ️  AI extracted service line: 'PT'
[18:18:23] ℹ️  AI extracted payer source: ''
[18:18:23] ℹ️  AI extracted diagnoses:
[18:18:23] ℹ️    - Diagnosis 1: 'G911'
[18:18:23] ℹ️    - Diagnosis 2: 'R26.9'
[18:18:23] ℹ️    - Diagnosis 3: 'None'
[18:18:23] ℹ️    - Diagnosis 4: 'None'
[18:18:23] ℹ️    - Diagnosis 5: 'None'
[18:18:23] ℹ️    - Diagnosis 6: 'None'
[18:18:23] ℹ️  Final extracted MRN: '1247807317'
[18:18:23] ℹ️  Final extracted Sex: 'MALE'
[18:18:23] ℹ️  Final extracted Service Line: 'PT'
[18:18:23] ℹ️  Final extracted Payer Source: ''
[18:18:23] ✅ Patient data extraction completed successfully
[18:18:23] ✅    ✅ Patient data extracted successfully
[18:18:23] 📊 Patient Response
     └─ patientFName: Dane
     └─ patientLName: Bjornson
     └─ dob: 08/06/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 1247807317
     └─ billingProvider: Home Again Health Care, LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Home Again Health Care, LLC
     └─ address: 125 High Street , STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: 
     └─ phoneNumber: (877) 242-8771
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/05/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': 'G911', 'secondDiagnosis': 'R26.9', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:18:23] ✅    ✅ Patient identified: Dane Bjornson
[18:18:23] ✅    ✅ Patient name validation passed
[18:18:23] 🔄 
🔄 Step 3: Processing patient dates...
[18:18:23] [DOC: 9258365] ℹ️  DOB normalized: 08/06/1964
[18:18:23] [DOC: 9258365] ℹ️  Episode startOfEpisode normalized: 01/05/2025
[18:18:23] [DOC: 9258365] ℹ️  Episode endOfEpisode normalized: 03/22/2025
[18:18:23] [DOC: 9258365] ✅ Patient date processing completed successfully
[18:18:23] ✅    ✅ Date processing completed
[18:18:23] 📊 Processed Patient Data
     └─ patientFName: Dane
     └─ patientLName: Bjornson
     └─ dob: 08/06/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 1247807317
     └─ billingProvider: Home Again Health Care, LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Home Again Health Care, LLC
     └─ address: 125 High Street , STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: 
     └─ phoneNumber: (877) 242-8771
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/05/2025', 'endOfEpisode': '03/22/2025', 'firstDiagnosis': 'G911', 'secondDiagnosis': 'R26.9'}]
[18:18:23] 🔄 
🔄 Step 4: Extracting order data...
[18:18:25] ℹ️  Order extraction - MRN: 'opbrMC0664'
[18:18:25] ℹ️  Order extraction - Sex: 'MALE'
[18:18:25] ℹ️  Order extraction - Service Line: 'PT'
[18:18:25] ℹ️  Order extraction - Payer Source: ''
[18:18:25] ✅ Order data extraction completed successfully
[18:18:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:18:25] ℹ️  Using MRN from patient data: '1247807317' over 'opbrMC0664'
[18:18:25] ℹ️  Service line consistent in both sources: 'PT'
[18:18:25] ✅ Patient name cross-validation successful
[18:18:25] ✅    ✅ Data merged successfully
[18:18:27] ✅    ✅ Order data extracted and validated
[18:18:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:18:45] [DOC: 9258365] ✅ Patient exists in API: Dane Bjornson, ID: a3b4e43f-e646-4fe1-bd66-38c3972a826f
[18:18:45] ✅    ✅ Existing patient found with ID: a3b4e43f-e646-4fe1-bd66-38c3972a826f
[18:18:45] 🔄 
🔄 Step 6: Pushing order to API...
[18:18:45] [DOC: 9258365] ℹ️  Pushing order via API for patient ID: a3b4e43f-e646-4fe1-bd66-38c3972a826f
[18:18:46] [DOC: 9258365] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[18:18:46] ❌    ❌ Failed to push order
[18:18:46] 🔄 
🔄 Step 7: Writing to CSV...
[18:18:46] [DOC: 9258365] ℹ️  Calculated age: 60 from DOB: 08/06/1964
[18:18:46] [DOC: 9258365] ℹ️  Service Line extracted: 'PT'
[18:18:46] [DOC: 9258365] ℹ️  Payer Source extracted: ''
[18:18:46] [DOC: 9258365] ℹ️  Diagnosis codes being written:
[18:18:46] [DOC: 9258365] ℹ️    - Latest_Episode_Firstdiagnosis: 'G911'
[18:18:46] [DOC: 9258365] ℹ️    - Latest_Episode_Seconddiagnosis: 'R26.9'
[18:18:46] [DOC: 9258365] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:18:46] [DOC: 9258365] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:18:46] [DOC: 9258365] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:18:46] [DOC: 9258365] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:18:46] [DOC: 9258365] ✅ Patient data written to CSV: Dane Bjornson | Sex: MALE | Age: 60 | Service: PT | Payer:  | MRN: 1247807317
[18:18:46] ✅    ✅ Document 9258365 processed and saved successfully
[18:18:46] 🔄 
🔄 Step 8: Saving API details...
[18:18:46] [DOC: 9258365] ℹ️  API push details saved for document 9258365
[18:18:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258111                         ║
================================================================================
[18:18:46] ℹ️  Agency: Relief Home Health Services
[18:18:46] ℹ️  Date: 04/24/2025
[18:18:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:18:52] [DOC: 9258111] ✅ Text extracted using pdfplumber (17635 chars)
[18:18:52] ✅    ✅ Text extracted using pdfplumber (17635 chars)
[18:18:52] 🔄 
🔄 Step 2: Extracting patient data...
[18:18:56] ℹ️  AI extracted raw sex value: 'M'
[18:18:56] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:18:56] ℹ️  AI extracted payer source: ''
[18:18:56] ℹ️  AI extracted diagnoses:
[18:18:56] ℹ️    - Diagnosis 1: 'E11.10'
[18:18:56] ℹ️    - Diagnosis 2: 'I12.9'
[18:18:56] ℹ️    - Diagnosis 3: 'N18.2'
[18:18:56] ℹ️    - Diagnosis 4: 'I82.491'
[18:18:56] ℹ️    - Diagnosis 5: 'J45.909'
[18:18:56] ℹ️    - Diagnosis 6: 'M54.50'
[18:18:56] ℹ️  Final extracted MRN: 'NB0988'
[18:18:56] ℹ️  Final extracted Sex: 'MALE'
[18:18:56] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:18:56] ℹ️  Final extracted Payer Source: ''
[18:18:56] ✅ Patient data extraction completed successfully
[18:18:56] ✅    ✅ Patient data extracted successfully
[18:18:56] 📊 Patient Response
     └─ patientFName: LEAH
     └─ patientLName: MIRANDA
     └─ dob: 04/15/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: NB0988
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1326028085
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 161C OAKDALE ST
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 971-1761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/28/2022', 'startOfEpisode': '10/18/2024', 'endOfEpisode': '12/16/2024', 'firstDiagnosis': 'E11.10', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'N18.2', 'fourthDiagnosis': 'I82.491', 'fifthDiagnosis': 'J45.909', 'sixthDiagnosis': 'M54.50'}]
[18:18:56] ✅    ✅ Patient identified: LEAH MIRANDA
[18:18:56] ✅    ✅ Patient name validation passed
[18:18:56] 🔄 
🔄 Step 3: Processing patient dates...
[18:18:56] [DOC: 9258111] ℹ️  DOB normalized: 04/15/1947
[18:18:56] [DOC: 9258111] ℹ️  Episode startOfCare normalized: 12/28/2022
[18:18:56] [DOC: 9258111] ℹ️  Episode startOfEpisode normalized: 10/18/2024
[18:18:56] [DOC: 9258111] ℹ️  Episode endOfEpisode normalized: 12/16/2024
[18:18:56] [DOC: 9258111] ✅ Patient date processing completed successfully
[18:18:56] ✅    ✅ Date processing completed
[18:18:56] 📊 Processed Patient Data
     └─ patientFName: LEAH
     └─ patientLName: MIRANDA
     └─ dob: 04/15/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: NB0988
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1326028085
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 161C OAKDALE ST
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 971-1761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/28/2022', 'startOfEpisode': '10/18/2024', 'endOfEpisode': '12/16/2024', 'firstDiagnosis': 'E11.10', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'N18.2', 'fourthDiagnosis': 'I82.491', 'fifthDiagnosis': 'J45.909', 'sixthDiagnosis': 'M54.50'}]
[18:18:56] 🔄 
🔄 Step 4: Extracting order data...
[18:18:59] ℹ️  Order extraction - MRN: 'NB0988'
[18:18:59] ℹ️  Order extraction - Sex: 'FEMALE'
[18:18:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:18:59] ℹ️  Order extraction - Payer Source: ''
[18:18:59] ✅ Order data extraction completed successfully
[18:18:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:18:59] ℹ️  Using MRN from patient data: 'NB0988' over 'NB0988'
[18:18:59] ⚠️  Sex mismatch: Patient='MALE' vs Order='FEMALE', using patient data
[18:18:59] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:18:59] ✅ Patient name cross-validation successful
[18:18:59] ✅    ✅ Data merged successfully
[18:19:00] ✅    ✅ Order data extracted and validated
[18:19:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:19:00] [DOC: 9258111] ✅ Patient found in local cache: LEAH MIRANDA, ID: 72b643f1-c294-4fdd-afdc-323a3e0148d5
[18:19:00] ✅    ✅ Existing patient found with ID: 72b643f1-c294-4fdd-afdc-323a3e0148d5
[18:19:00] 🔄 
🔄 Step 6: Pushing order to API...
[18:19:00] [DOC: 9258111] ℹ️  Pushing order via API for patient ID: 72b643f1-c294-4fdd-afdc-323a3e0148d5
[18:19:02] [DOC: 9258111] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[18:19:02] ❌    ❌ Failed to push order
[18:19:02] 🔄 
🔄 Step 7: Writing to CSV...
[18:19:02] [DOC: 9258111] ℹ️  Calculated age: 78 from DOB: 04/15/1947
[18:19:02] [DOC: 9258111] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:19:02] [DOC: 9258111] ℹ️  Payer Source extracted: ''
[18:19:02] [DOC: 9258111] ℹ️  Diagnosis codes being written:
[18:19:02] [DOC: 9258111] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.10'
[18:19:02] [DOC: 9258111] ℹ️    - Latest_Episode_Seconddiagnosis: 'I12.9'
[18:19:02] [DOC: 9258111] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.2'
[18:19:02] [DOC: 9258111] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I82.491'
[18:19:02] [DOC: 9258111] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J45.909'
[18:19:02] [DOC: 9258111] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M54.50'
[18:19:02] [DOC: 9258111] ✅ Patient data written to CSV: LEAH MIRANDA | Sex: MALE | Age: 78 | Service: Skilled Nursing | Payer:  | MRN: NB0988
[18:19:02] ✅    ✅ Document 9258111 processed and saved successfully
[18:19:02] 🔄 
🔄 Step 8: Saving API details...
[18:19:02] [DOC: 9258111] ℹ️  API push details saved for document 9258111
[18:19:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9257933                         ║
================================================================================
[18:19:02] ℹ️  Agency: Relief Home Health Services
[18:19:02] ℹ️  Date: 04/24/2025
[18:19:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:19:04] [DOC: 9257933] ✅ Text extracted using pdfplumber (2026 chars)
[18:19:04] ✅    ✅ Text extracted using pdfplumber (2026 chars)
[18:19:04] 🔄 
🔄 Step 2: Extracting patient data...
[18:19:07] ℹ️  AI extracted raw sex value: ''
[18:19:07] ℹ️  AI extracted service line: 'OT'
[18:19:07] ℹ️  AI extracted payer source: ''
[18:19:07] ℹ️  AI extracted diagnoses:
[18:19:07] ℹ️    - Diagnosis 1: ''
[18:19:07] ℹ️    - Diagnosis 2: ''
[18:19:07] ℹ️    - Diagnosis 3: ''
[18:19:07] ℹ️    - Diagnosis 4: ''
[18:19:07] ℹ️    - Diagnosis 5: ''
[18:19:07] ℹ️    - Diagnosis 6: ''
[18:19:07] ℹ️  Final extracted MRN: ''
[18:19:07] ℹ️  Final extracted Sex: ''
[18:19:07] ℹ️  Final extracted Service Line: 'OT'
[18:19:07] ℹ️  Final extracted Payer Source: ''
[18:19:07] ✅ Patient data extraction completed successfully
[18:19:07] ✅    ✅ Patient data extracted successfully
[18:19:07] 📊 Patient Response
     └─ patientFName: LEAH
     └─ patientLName: MIRANDA
     └─ dob: 04/15/1947
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1326028085
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 35 Winter Street
     └─ city: Hyannis
     └─ state: MA
     └─ zip: 02601
     └─ email: inquiries@reliefhhs.com
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/28/2022', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:19:07] ✅    ✅ Patient identified: LEAH MIRANDA
[18:19:07] ✅    ✅ Patient name validation passed
[18:19:07] 🔄 
🔄 Step 3: Processing patient dates...
[18:19:07] [DOC: 9257933] ℹ️  DOB normalized: 04/15/1947
[18:19:07] [DOC: 9257933] ℹ️  Episode startOfCare normalized: 12/28/2022
[18:19:07] [DOC: 9257933] ✅ Patient date processing completed successfully
[18:19:07] ✅    ✅ Date processing completed
[18:19:07] 📊 Processed Patient Data
     └─ patientFName: LEAH
     └─ patientLName: MIRANDA
     └─ dob: 04/15/1947
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1326028085
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 35 Winter Street
     └─ city: Hyannis
     └─ state: MA
     └─ zip: 02601
     └─ email: inquiries@reliefhhs.com
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/28/2022', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:19:07] 🔄 
🔄 Step 4: Extracting order data...
[18:19:09] ℹ️  Order extraction - MRN: ''
[18:19:09] ℹ️  Order extraction - Sex: ''
[18:19:09] ℹ️  Order extraction - Service Line: 'OT'
[18:19:09] ℹ️  Order extraction - Payer Source: ''
[18:19:09] ✅ Order data extraction completed successfully
[18:19:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:19:09] ⚠️  No MRN found in either patient or order data
[18:19:09] ⚠️  Could not determine sex using any available method
[18:19:09] ℹ️  Service line consistent in both sources: 'OT'
[18:19:09] ✅ Patient name cross-validation successful
[18:19:09] ✅    ✅ Data merged successfully
[18:19:10] ⚠️     ❌ Skipping - missing episode start date
[18:19:10] [DOC: 9257933] ℹ️  API push details saved for document 9257933
================================================================================
║                        Processing Document ID: 9257896                         ║
================================================================================
[18:19:10] ℹ️  Agency: Enhabit OF NEW ENGLAND - (SPR)
[18:19:10] ℹ️  Date: 04/24/2025
[18:19:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:19:14] [DOC: 9257896] ✅ Text extracted using pdfplumber (113 chars)
[18:19:14] ✅    ✅ Text extracted using pdfplumber (113 chars)
[18:19:14] 🔄 
🔄 Step 2: Extracting patient data...
[18:19:16] ℹ️  AI extracted raw sex value: ''
[18:19:16] ℹ️  AI extracted service line: ''
[18:19:16] ℹ️  AI extracted payer source: ''
[18:19:16] ℹ️  AI extracted diagnoses:
[18:19:16] ℹ️    - Diagnosis 1: ''
[18:19:16] ℹ️    - Diagnosis 2: ''
[18:19:16] ℹ️    - Diagnosis 3: ''
[18:19:16] ℹ️    - Diagnosis 4: ''
[18:19:16] ℹ️    - Diagnosis 5: ''
[18:19:16] ℹ️    - Diagnosis 6: ''
[18:19:16] ℹ️  Final extracted MRN: ''
[18:19:16] ℹ️  Final extracted Sex: ''
[18:19:16] ℹ️  Final extracted Service Line: ''
[18:19:16] ℹ️  Final extracted Payer Source: ''
[18:19:16] ✅ Patient data extraction completed successfully
[18:19:16] ✅    ✅ Patient data extracted successfully
[18:19:16] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Dr. MCCARTHY, COLM
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:19:16] ⚠️     ❌ Insufficient patient data extracted
[18:19:16] [DOC: 9257896] ℹ️  API push details saved for document 9257896
================================================================================
║                        Processing Document ID: 9257885                         ║
================================================================================
[18:19:16] ℹ️  Agency: Nizhoni Health-Fall River
[18:19:16] ℹ️  Date: 04/24/2025
[18:19:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:19:19] [DOC: 9257885] ✅ Text extracted using pdfplumber (10168 chars)
[18:19:19] ✅    ✅ Text extracted using pdfplumber (10168 chars)
[18:19:19] 🔄 
🔄 Step 2: Extracting patient data...
[18:19:23] ℹ️  AI extracted raw sex value: 'M'
[18:19:23] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:19:23] ℹ️  AI extracted payer source: 'None'
[18:19:23] ℹ️  AI extracted diagnoses:
[18:19:23] ℹ️    - Diagnosis 1: 'F31.9'
[18:19:23] ℹ️    - Diagnosis 2: 'E55.9'
[18:19:23] ℹ️    - Diagnosis 3: 'G47.00'
[18:19:23] ℹ️    - Diagnosis 4: 'K21.9'
[18:19:23] ℹ️    - Diagnosis 5: 'K58.8'
[18:19:23] ℹ️    - Diagnosis 6: 'R25.1'
[18:19:23] ℹ️  Final extracted MRN: '8496020'
[18:19:23] ℹ️  Final extracted Sex: 'MALE'
[18:19:23] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:19:23] ℹ️  Final extracted Payer Source: ''
[18:19:23] ✅ Patient data extraction completed successfully
[18:19:23] ✅    ✅ Patient data extracted successfully
[18:19:23] 📊 Patient Response
     └─ patientFName: Tate
     └─ patientLName: Cullen
     └─ dob: 11/23/2000
     └─ patientSex: MALE
     └─ medicalRecordNo: 8496020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100027938602
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive VNA
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/28/2023', 'startOfEpisode': '11/03/2023', 'endOfEpisode': '06/24/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'E55.9', 'thirdDiagnosis': 'G47.00', 'fourthDiagnosis': 'K21.9', 'fifthDiagnosis': 'K58.8', 'sixthDiagnosis': 'R25.1'}]
[18:19:23] ✅    ✅ Patient identified: Tate Cullen
[18:19:23] ✅    ✅ Patient name validation passed
[18:19:23] 🔄 
🔄 Step 3: Processing patient dates...
[18:19:23] [DOC: 9257885] ℹ️  DOB normalized: 11/23/2000
[18:19:23] [DOC: 9257885] ℹ️  Episode startOfCare normalized: 08/28/2023
[18:19:23] [DOC: 9257885] ℹ️  Episode startOfEpisode normalized: 11/03/2023
[18:19:23] [DOC: 9257885] ℹ️  Episode endOfEpisode normalized: 06/24/2025
[18:19:23] [DOC: 9257885] ✅ Patient date processing completed successfully
[18:19:23] ✅    ✅ Date processing completed
[18:19:23] 📊 Processed Patient Data
     └─ patientFName: Tate
     └─ patientLName: Cullen
     └─ dob: 11/23/2000
     └─ patientSex: MALE
     └─ medicalRecordNo: 8496020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100027938602
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive VNA
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/28/2023', 'startOfEpisode': '11/03/2023', 'endOfEpisode': '06/24/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'E55.9', 'thirdDiagnosis': 'G47.00', 'fourthDiagnosis': 'K21.9', 'fifthDiagnosis': 'K58.8', 'sixthDiagnosis': 'R25.1'}]
[18:19:23] 🔄 
🔄 Step 4: Extracting order data...
[18:19:25] ℹ️  Order extraction - MRN: '8496020'
[18:19:25] ℹ️  Order extraction - Sex: 'MALE'
[18:19:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:19:25] ℹ️  Order extraction - Payer Source: ''
[18:19:25] ✅ Order data extraction completed successfully
[18:19:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:19:25] ℹ️  Using MRN from patient data: '8496020' over '8496020'
[18:19:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:19:25] ✅ Patient name cross-validation successful
[18:19:25] ✅    ✅ Data merged successfully
[18:19:27] ✅    ✅ Order data extracted and validated
[18:19:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:19:56] [DOC: 9257885] ℹ️  Patient not found in cache or API: Tate Cullen
[18:19:56] [DOC: 9257885] ℹ️  Patient not found, creating new patient via API...
[18:19:56] [DOC: 9257885] ℹ️  Creating patient via API: Tate Cullen
[18:19:57] [DOC: 9257885] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:19:57] ❌    ❌ Failed to create patient
[18:19:57] [DOC: 9257885] ℹ️  API push details saved for document 9257885
================================================================================
║                        Processing Document ID: 9257869                         ║
================================================================================
[18:19:57] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:19:57] ℹ️  Date: 04/24/2025
[18:19:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:19:59] [DOC: 9257869] ✅ Text extracted using pdfplumber (1128 chars)
[18:19:59] ✅    ✅ Text extracted using pdfplumber (1128 chars)
[18:19:59] 🔄 
🔄 Step 2: Extracting patient data...
[18:20:02] ℹ️  AI extracted raw sex value: 'M'
[18:20:02] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:20:02] ℹ️  AI extracted payer source: ''
[18:20:02] ℹ️  AI extracted diagnoses:
[18:20:02] ℹ️    - Diagnosis 1: ''
[18:20:02] ℹ️    - Diagnosis 2: ''
[18:20:02] ℹ️    - Diagnosis 3: ''
[18:20:02] ℹ️    - Diagnosis 4: ''
[18:20:02] ℹ️    - Diagnosis 5: ''
[18:20:02] ℹ️    - Diagnosis 6: ''
[18:20:02] ℹ️  Final extracted MRN: '2475455'
[18:20:02] ℹ️  Final extracted Sex: 'MALE'
[18:20:02] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:20:02] ℹ️  Final extracted Payer Source: ''
[18:20:02] ✅ Patient data extraction completed successfully
[18:20:02] ✅    ✅ Patient data extracted successfully
[18:20:02] 📊 Patient Response
     └─ patientFName: Jay
     └─ patientLName: Flanagan
     └─ dob: 11/01/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 2475455
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:20:02] ✅    ✅ Patient identified: Jay Flanagan
[18:20:02] ✅    ✅ Patient name validation passed
[18:20:02] 🔄 
🔄 Step 3: Processing patient dates...
[18:20:02] [DOC: 9257869] ℹ️  DOB normalized: 11/01/1951
[18:20:02] [DOC: 9257869] ✅ Patient date processing completed successfully
[18:20:02] ✅    ✅ Date processing completed
[18:20:02] 📊 Processed Patient Data
     └─ patientFName: Jay
     └─ patientLName: Flanagan
     └─ dob: 11/01/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 2475455
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:20:02] 🔄 
🔄 Step 4: Extracting order data...
[18:20:04] ℹ️  Order extraction - MRN: '2475455'
[18:20:04] ℹ️  Order extraction - Sex: 'MALE'
[18:20:04] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:20:04] ℹ️  Order extraction - Payer Source: ''
[18:20:04] ✅ Order data extraction completed successfully
[18:20:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:20:04] ℹ️  Using MRN from patient data: '2475455' over '2475455'
[18:20:04] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:20:04] ✅ Patient name cross-validation successful
[18:20:04] ✅    ✅ Data merged successfully
[18:20:05] ✅    ✅ Order data extracted and validated
[18:20:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:20:41] [DOC: 9257869] ℹ️  Patient not found in cache or API: Jay Flanagan
[18:20:41] [DOC: 9257869] ℹ️  Patient not found, creating new patient via API...
[18:20:41] [DOC: 9257869] ℹ️  Creating patient via API: Jay Flanagan
[18:20:42] [DOC: 9257869] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:20:42] ❌    ❌ Failed to create patient
[18:20:42] [DOC: 9257869] ℹ️  API push details saved for document 9257869
================================================================================
║                        Processing Document ID: 9257773                         ║
================================================================================
[18:20:42] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[18:20:42] ℹ️  Date: 04/23/2025
[18:20:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:20:44] [DOC: 9257773] ✅ Text extracted using pdfplumber (1364 chars)
[18:20:44] ✅    ✅ Text extracted using pdfplumber (1352 chars)
[18:20:44] 🔄 
🔄 Step 2: Extracting patient data...
[18:20:47] ℹ️  AI extracted raw sex value: ''
[18:20:47] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:20:47] ℹ️  AI extracted payer source: 'Medicare'
[18:20:47] ℹ️  AI extracted diagnoses:
[18:20:47] ℹ️    - Diagnosis 1: 'None'
[18:20:47] ℹ️    - Diagnosis 2: 'None'
[18:20:47] ℹ️    - Diagnosis 3: 'None'
[18:20:47] ℹ️    - Diagnosis 4: 'None'
[18:20:47] ℹ️    - Diagnosis 5: 'None'
[18:20:47] ℹ️    - Diagnosis 6: 'None'
[18:20:47] ℹ️  Final extracted MRN: '28700211667001'
[18:20:47] ℹ️  Final extracted Sex: ''
[18:20:47] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:20:47] ℹ️  Final extracted Payer Source: 'Medicare'
[18:20:47] ✅ Patient data extraction completed successfully
[18:20:47] ✅    ✅ Patient data extracted successfully
[18:20:47] 📊 Patient Response
     └─ patientFName: HOLLY
     └─ patientLName: VOGEL
     └─ dob: 09/09/1947
     └─ patientSex: 
     └─ medicalRecordNo: 28700211667001
     └─ billingProvider: KARMINA BAUTISTA, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 535 FAUNCE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/20/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:20:47] ✅    ✅ Patient identified: HOLLY VOGEL
[18:20:47] ✅    ✅ Patient name validation passed
[18:20:47] 🔄 
🔄 Step 3: Processing patient dates...
[18:20:47] [DOC: 9257773] ℹ️  DOB normalized: 09/09/1947
[18:20:47] [DOC: 9257773] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[18:20:47] [DOC: 9257773] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[18:20:47] [DOC: 9257773] ✅ Patient date processing completed successfully
[18:20:47] ✅    ✅ Date processing completed
[18:20:47] 📊 Processed Patient Data
     └─ patientFName: HOLLY
     └─ patientLName: VOGEL
     └─ dob: 09/09/1947
     └─ patientSex: 
     └─ medicalRecordNo: 28700211667001
     └─ billingProvider: KARMINA BAUTISTA, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 535 FAUNCE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '04/07/2025'}]
[18:20:47] 🔄 
🔄 Step 4: Extracting order data...
[18:20:50] ℹ️  Order extraction - MRN: '28700211667001'
[18:20:50] ℹ️  Order extraction - Sex: ''
[18:20:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:20:50] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:20:50] ✅ Order data extraction completed successfully
[18:20:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:20:50] ℹ️  Using MRN from patient data: '28700211667001' over '28700211667001'
[18:20:50] ⚠️  Could not determine sex using any available method
[18:20:50] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:20:50] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:20:50] ✅ Patient name cross-validation successful
[18:20:50] ✅    ✅ Data merged successfully
[18:20:51] ✅    ✅ Order data extracted and validated
[18:20:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:21:05] [DOC: 9257773] ✅ Patient exists in API: HOLLY VOGEL, ID: e7fe7813-a7d0-4ab7-92ff-e32304f75064
[18:21:05] ✅    ✅ Existing patient found with ID: e7fe7813-a7d0-4ab7-92ff-e32304f75064
[18:21:05] 🔄 
🔄 Step 6: Pushing order to API...
[18:21:05] [DOC: 9257773] ℹ️  Pushing order via API for patient ID: e7fe7813-a7d0-4ab7-92ff-e32304f75064
[18:21:06] [DOC: 9257773] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14260"}
[18:21:06] ❌    ❌ Failed to push order
[18:21:06] 🔄 
🔄 Step 7: Writing to CSV...
[18:21:06] [DOC: 9257773] ℹ️  Calculated age: 77 from DOB: 09/09/1947
[18:21:06] [DOC: 9257773] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:21:06] [DOC: 9257773] ℹ️  Payer Source extracted: 'Medicare'
[18:21:06] [DOC: 9257773] ℹ️  Diagnosis codes being written:
[18:21:06] [DOC: 9257773] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:21:06] [DOC: 9257773] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:21:06] [DOC: 9257773] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:21:06] [DOC: 9257773] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:21:06] [DOC: 9257773] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:21:06] [DOC: 9257773] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:21:06] [DOC: 9257773] ✅ Patient data written to CSV: HOLLY VOGEL | Sex:  | Age: 77 | Service: Skilled Nursing | Payer: Medicare | MRN: 28700211667001
[18:21:06] ✅    ✅ Document 9257773 processed and saved successfully
[18:21:06] 🔄 
🔄 Step 8: Saving API details...
[18:21:06] [DOC: 9257773] ℹ️  API push details saved for document 9257773
[18:21:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9257771                         ║
================================================================================
[18:21:06] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[18:21:06] ℹ️  Date: 04/23/2025
[18:21:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:21:12] [DOC: 9257771] ✅ Text extracted using pdfplumber (17860 chars)
[18:21:12] ✅    ✅ Text extracted using pdfplumber (17800 chars)
[18:21:12] 🔄 
🔄 Step 2: Extracting patient data...
[18:21:16] ℹ️  AI extracted raw sex value: 'M'
[18:21:16] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:21:16] ℹ️  AI extracted payer source: 'Medicare'
[18:21:16] ℹ️  AI extracted diagnoses:
[18:21:16] ℹ️    - Diagnosis 1: 'Z48.812'
[18:21:16] ℹ️    - Diagnosis 2: 'I25.10'
[18:21:16] ℹ️    - Diagnosis 3: 'I10'
[18:21:16] ℹ️    - Diagnosis 4: 'I48.91'
[18:21:16] ℹ️    - Diagnosis 5: 'D62'
[18:21:16] ℹ️    - Diagnosis 6: 'I77.819'
[18:21:16] ℹ️  Final extracted MRN: '28700211636801'
[18:21:16] ℹ️  Final extracted Sex: 'MALE'
[18:21:16] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:21:16] ℹ️  Final extracted Payer Source: 'Medicare'
[18:21:16] ✅ Patient data extraction completed successfully
[18:21:16] ✅    ✅ Patient data extracted successfully
[18:21:16] 📊 Patient Response
     └─ patientFName: WILLIAM
     └─ patientLName: GROVELL
     └─ dob: 03/26/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700211636801
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'D62', 'sixthDiagnosis': 'I77.819'}]
[18:21:16] ✅    ✅ Patient identified: WILLIAM GROVELL
[18:21:16] ✅    ✅ Patient name validation passed
[18:21:16] 🔄 
🔄 Step 3: Processing patient dates...
[18:21:16] [DOC: 9257771] ℹ️  DOB normalized: 03/26/1949
[18:21:16] [DOC: 9257771] ℹ️  Episode startOfCare normalized: 04/11/2025
[18:21:16] [DOC: 9257771] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[18:21:16] [DOC: 9257771] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[18:21:16] [DOC: 9257771] ✅ Patient date processing completed successfully
[18:21:16] ✅    ✅ Date processing completed
[18:21:16] 📊 Processed Patient Data
     └─ patientFName: WILLIAM
     └─ patientLName: GROVELL
     └─ dob: 03/26/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700211636801
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'Z48.812', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'D62', 'sixthDiagnosis': 'I77.819'}]
[18:21:16] 🔄 
🔄 Step 4: Extracting order data...
[18:21:19] ℹ️  Order extraction - MRN: '28700211636801'
[18:21:19] ℹ️  Order extraction - Sex: 'MALE'
[18:21:19] ℹ️  Order extraction - Service Line: 'PT, OT, Skilled Nursing'
[18:21:19] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:21:19] ✅ Order data extraction completed successfully
[18:21:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:21:19] ℹ️  Using MRN from patient data: '28700211636801' over '28700211636801'
[18:21:19] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy' + Order='PT, OT, Skilled Nursing' = 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[18:21:19] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:21:19] ✅ Patient name cross-validation successful
[18:21:19] ✅    ✅ Data merged successfully
[18:21:20] ✅    ✅ Order data extracted and validated
[18:21:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:21:27] [DOC: 9257771] ℹ️  Patient not found in cache or API: WILLIAM GROVELL
[18:21:27] [DOC: 9257771] ℹ️  Patient not found, creating new patient via API...
[18:21:27] [DOC: 9257771] ℹ️  Creating patient via API: WILLIAM GROVELL
[18:21:28] [DOC: 9257771] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:21:28] ❌    ❌ Failed to create patient
[18:21:28] [DOC: 9257771] ℹ️  API push details saved for document 9257771
================================================================================
║                        Processing Document ID: 9257389                         ║
================================================================================
[18:21:28] ℹ️  Agency: Caretenders-Bourne
[18:21:28] ℹ️  Date: 04/23/2025
[18:21:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:21:36] [DOC: 9257389] ✅ Text extracted using pdfplumber (1158 chars)
[18:21:36] ✅    ✅ Text extracted using pdfplumber (1158 chars)
[18:21:36] 🔄 
🔄 Step 2: Extracting patient data...
[18:21:39] ℹ️  AI extracted raw sex value: ''
[18:21:39] ℹ️  AI extracted service line: 'SN'
[18:21:39] ℹ️  AI extracted payer source: ''
[18:21:39] ℹ️  AI extracted diagnoses:
[18:21:39] ℹ️    - Diagnosis 1: 'None'
[18:21:39] ℹ️    - Diagnosis 2: 'None'
[18:21:39] ℹ️    - Diagnosis 3: 'None'
[18:21:39] ℹ️    - Diagnosis 4: 'None'
[18:21:39] ℹ️    - Diagnosis 5: 'None'
[18:21:39] ℹ️    - Diagnosis 6: 'None'
[18:21:39] ℹ️  Final extracted MRN: 'CAP00316873901'
[18:21:39] ℹ️  Final extracted Sex: ''
[18:21:39] ℹ️  Final extracted Service Line: 'SN'
[18:21:39] ℹ️  Final extracted Payer Source: ''
[18:21:39] ✅ Patient data extraction completed successfully
[18:21:39] ✅    ✅ Patient data extracted successfully
[18:21:39] 📊 Patient Response
     └─ patientFName: DOROTHY
     └─ patientLName: PINTO
     └─ dob: 04/08/1938
     └─ patientSex: 
     └─ medicalRecordNo: CAP00316873901
     └─ billingProvider: Dr. JORDAN GULAREK
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: CARETENDERS - BOURNE
     └─ address: 535 FAUNCE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: SN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/20/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:21:39] ✅    ✅ Patient identified: DOROTHY PINTO
[18:21:39] ✅    ✅ Patient name validation passed
[18:21:39] 🔄 
🔄 Step 3: Processing patient dates...
[18:21:39] [DOC: 9257389] ℹ️  DOB normalized: 04/08/1938
[18:21:39] [DOC: 9257389] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[18:21:39] [DOC: 9257389] ✅ Patient date processing completed successfully
[18:21:39] ✅    ✅ Date processing completed
[18:21:39] 📊 Processed Patient Data
     └─ patientFName: DOROTHY
     └─ patientLName: PINTO
     └─ dob: 04/08/1938
     └─ patientSex: 
     └─ medicalRecordNo: CAP00316873901
     └─ billingProvider: Dr. JORDAN GULAREK
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: CARETENDERS - BOURNE
     └─ address: 535 FAUNCE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: SN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025'}]
[18:21:39] 🔄 
🔄 Step 4: Extracting order data...
[18:21:41] ℹ️  Order extraction - MRN: 'CAP00316873901'
[18:21:41] ℹ️  Order extraction - Sex: ''
[18:21:41] ℹ️  Order extraction - Service Line: 'SN'
[18:21:41] ℹ️  Order extraction - Payer Source: ''
[18:21:41] ✅ Order data extraction completed successfully
[18:21:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:21:41] ℹ️  Using MRN from patient data: 'CAP00316873901' over 'CAP00316873901'
[18:21:41] ℹ️  Inferred sex as FEMALE from name: DOROTHY
[18:21:41] ℹ️  Service line consistent in both sources: 'SN'
[18:21:41] ✅ Patient name cross-validation successful
[18:21:41] ✅    ✅ Data merged successfully
[18:21:43] ✅    ✅ Order data extracted and validated
[18:21:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:21:49] [DOC: 9257389] ℹ️  Patient not found in cache or API: DOROTHY PINTO
[18:21:49] [DOC: 9257389] ℹ️  Patient not found, creating new patient via API...
[18:21:49] [DOC: 9257389] ℹ️  Creating patient via API: DOROTHY PINTO
[18:21:50] [DOC: 9257389] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:21:50] ❌    ❌ Failed to create patient
[18:21:50] [DOC: 9257389] ℹ️  API push details saved for document 9257389
================================================================================
║                        Processing Document ID: 9257264                         ║
================================================================================
[18:21:50] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[18:21:50] ℹ️  Date: 04/23/2025
[18:21:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:21:55] [DOC: 9257264] ✅ Text extracted using pdfplumber (1786 chars)
[18:21:55] ✅    ✅ Text extracted using pdfplumber (1786 chars)
[18:21:55] 🔄 
🔄 Step 2: Extracting patient data...
[18:21:58] ℹ️  AI extracted raw sex value: 'F'
[18:21:58] ℹ️  AI extracted service line: 'HHA'
[18:21:58] ℹ️  AI extracted payer source: 'Commonwealth Care Alliance-One Care'
[18:21:58] ℹ️  AI extracted diagnoses:
[18:21:58] ℹ️    - Diagnosis 1: ''
[18:21:58] ℹ️    - Diagnosis 2: ''
[18:21:58] ℹ️    - Diagnosis 3: ''
[18:21:58] ℹ️    - Diagnosis 4: ''
[18:21:58] ℹ️    - Diagnosis 5: ''
[18:21:58] ℹ️    - Diagnosis 6: ''
[18:21:58] ℹ️  Final extracted MRN: '523'
[18:21:58] ℹ️  Final extracted Sex: 'FEMALE'
[18:21:58] ℹ️  Final extracted Service Line: 'HHA'
[18:21:58] ℹ️  Final extracted Payer Source: 'Commonwealth Care Alliance-One Care'
[18:21:58] ✅ Patient data extraction completed successfully
[18:21:58] ✅    ✅ Patient data extracted successfully
[18:21:58] 📊 Patient Response
     └─ patientFName: Dorothy
     └─ patientLName: Gomes
     └─ dob: 02/15/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 523
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1699745810
     └─ physicianNPI: 1699745810
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Commonwealth Care Alliance-One Care
     └─ episodeDiagnoses: [{'startOfCare': '10/19/2010', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:21:58] ✅    ✅ Patient identified: Dorothy Gomes
[18:21:58] ✅    ✅ Patient name validation passed
[18:21:58] 🔄 
🔄 Step 3: Processing patient dates...
[18:21:58] [DOC: 9257264] ℹ️  DOB normalized: 02/15/1959
[18:21:58] [DOC: 9257264] ℹ️  Episode startOfCare normalized: 10/19/2010
[18:21:58] [DOC: 9257264] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[18:21:58] [DOC: 9257264] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[18:21:58] [DOC: 9257264] ✅ Patient date processing completed successfully
[18:21:58] ✅    ✅ Date processing completed
[18:21:58] 📊 Processed Patient Data
     └─ patientFName: Dorothy
     └─ patientLName: Gomes
     └─ dob: 02/15/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 523
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1699745810
     └─ physicianNPI: 1699745810
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Commonwealth Care Alliance-One Care
     └─ episodeDiagnoses: [{'startOfCare': '10/19/2010', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:21:58] 🔄 
🔄 Step 4: Extracting order data...
[18:22:01] ℹ️  Order extraction - MRN: '523'
[18:22:01] ℹ️  Order extraction - Sex: 'FEMALE'
[18:22:01] ℹ️  Order extraction - Service Line: 'HHA'
[18:22:01] ℹ️  Order extraction - Payer Source: 'Commonwealth Care Alliance-One Care'
[18:22:01] ✅ Order data extraction completed successfully
[18:22:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:22:01] ℹ️  Using MRN from patient data: '523' over '523'
[18:22:01] ℹ️  Service line consistent in both sources: 'HHA'
[18:22:01] ℹ️  Payer source consistent in both sources: 'Commonwealth Care Alliance-One Care'
[18:22:01] ✅ Patient name cross-validation successful
[18:22:01] ✅    ✅ Data merged successfully
[18:22:02] ✅    ✅ Order data extracted and validated
[18:22:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:22:11] [DOC: 9257264] ✅ Patient exists in API: Dorothy Gomes, ID: 8a5fd1d7-8436-409e-bcf6-320aae333f88
[18:22:11] ✅    ✅ Existing patient found with ID: 8a5fd1d7-8436-409e-bcf6-320aae333f88
[18:22:11] 🔄 
🔄 Step 6: Pushing order to API...
[18:22:11] [DOC: 9257264] ℹ️  Pushing order via API for patient ID: 8a5fd1d7-8436-409e-bcf6-320aae333f88
[18:22:13] [DOC: 9257264] ❌ Order push failed with status 201: {"id":"5bfa65ff-da65-4299-b121-30dea88f2854","orderWAVId":"ORD19981","orderNo":"523","orderDate":"04/23/2025","startOfCare":"10/19/2010","episodeStartDate":"04/03/2025","episodeEndDate":"06/01/2025","documentID":"9257264","mrn":"523","patientName":"Gomes, Dorothy","sentToPhysicianDate":"04/23/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/25/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"INTERIM ORDERS","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"8a5fd1d7-8436-409e-bcf6-320aae333f88","companyId":"0f46ebbe-720c-4abb-8809-892864387620","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[18:22:13] ❌    ❌ Failed to push order
[18:22:13] 🔄 
🔄 Step 7: Writing to CSV...
[18:22:13] [DOC: 9257264] ℹ️  Calculated age: 66 from DOB: 02/15/1959
[18:22:13] [DOC: 9257264] ℹ️  Service Line extracted: 'HHA'
[18:22:13] [DOC: 9257264] ℹ️  Payer Source extracted: 'Commonwealth Care Alliance-One Care'
[18:22:13] [DOC: 9257264] ℹ️  Diagnosis codes being written:
[18:22:13] [DOC: 9257264] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:22:13] [DOC: 9257264] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:22:13] [DOC: 9257264] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:22:13] [DOC: 9257264] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:22:13] [DOC: 9257264] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:22:13] [DOC: 9257264] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:22:13] [DOC: 9257264] ✅ Patient data written to CSV: Dorothy Gomes | Sex: FEMALE | Age: 66 | Service: HHA | Payer: Commonwealth Care Alliance-One Care | MRN: 523
[18:22:13] ✅    ✅ Document 9257264 processed and saved successfully
[18:22:13] 🔄 
🔄 Step 8: Saving API details...
[18:22:13] [DOC: 9257264] ℹ️  API push details saved for document 9257264
[18:22:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9257169                         ║
================================================================================
[18:22:13] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[18:22:13] ℹ️  Date: 04/23/2025
[18:22:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:22:15] [DOC: 9257169] ✅ Text extracted using pdfplumber (1693 chars)
[18:22:15] ✅    ✅ Text extracted using pdfplumber (1693 chars)
[18:22:15] 🔄 
🔄 Step 2: Extracting patient data...
[18:22:18] ℹ️  AI extracted raw sex value: 'M'
[18:22:18] ℹ️  AI extracted service line: 'RN'
[18:22:18] ℹ️  AI extracted payer source: 'Senior Whole Health'
[18:22:18] ℹ️  AI extracted diagnoses:
[18:22:18] ℹ️    - Diagnosis 1: 'None'
[18:22:18] ℹ️    - Diagnosis 2: 'None'
[18:22:18] ℹ️    - Diagnosis 3: 'None'
[18:22:18] ℹ️    - Diagnosis 4: 'None'
[18:22:18] ℹ️    - Diagnosis 5: 'None'
[18:22:18] ℹ️    - Diagnosis 6: 'None'
[18:22:18] ℹ️  Final extracted MRN: '114004'
[18:22:18] ℹ️  Final extracted Sex: 'MALE'
[18:22:18] ℹ️  Final extracted Service Line: 'RN'
[18:22:18] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[18:22:18] ✅ Patient data extraction completed successfully
[18:22:18] ✅    ✅ Patient data extracted successfully
[18:22:18] 📊 Patient Response
     └─ patientFName: Donald
     └─ patientLName: Brown
     └─ dob: 06/18/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 114004
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 12 Ruth St Apt 320
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2018', 'startOfEpisode': None, 'endOfEpisode': '04/27/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:22:18] ✅    ✅ Patient identified: Donald Brown
[18:22:18] ✅    ✅ Patient name validation passed
[18:22:18] 🔄 
🔄 Step 3: Processing patient dates...
[18:22:18] [DOC: 9257169] ℹ️  DOB normalized: 06/18/1949
[18:22:18] [DOC: 9257169] ℹ️  Episode startOfCare normalized: 12/01/2018
[18:22:18] [DOC: 9257169] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[18:22:18] [DOC: 9257169] ✅ Patient date processing completed successfully
[18:22:18] ✅    ✅ Date processing completed
[18:22:18] 📊 Processed Patient Data
     └─ patientFName: Donald
     └─ patientLName: Brown
     └─ dob: 06/18/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 114004
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 12 Ruth St Apt 320
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '12/01/2018', 'endOfEpisode': '04/27/2025'}]
[18:22:18] 🔄 
🔄 Step 4: Extracting order data...
[18:22:21] ℹ️  Order extraction - MRN: '114004'
[18:22:21] ℹ️  Order extraction - Sex: 'MALE'
[18:22:21] ℹ️  Order extraction - Service Line: 'RN'
[18:22:21] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[18:22:21] ✅ Order data extraction completed successfully
[18:22:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:22:21] ℹ️  Using MRN from patient data: '114004' over '114004'
[18:22:21] ℹ️  Service line consistent in both sources: 'RN'
[18:22:21] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[18:22:21] ✅ Patient name cross-validation successful
[18:22:21] ✅    ✅ Data merged successfully
[18:22:22] ✅    ✅ Order data extracted and validated
[18:22:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:22:22] [DOC: 9257169] ✅ Patient found in local cache: Donald Brown, ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[18:22:22] ✅    ✅ Existing patient found with ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[18:22:22] 🔄 
🔄 Step 6: Pushing order to API...
[18:22:22] [DOC: 9257169] ℹ️  Pushing order via API for patient ID: 475b933b-2f10-4471-a1da-b798c6232ab6
[18:22:23] [DOC: 9257169] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[18:22:23] ❌    ❌ Failed to push order
[18:22:23] 🔄 
🔄 Step 7: Writing to CSV...
[18:22:23] [DOC: 9257169] ℹ️  Calculated age: 75 from DOB: 06/18/1949
[18:22:23] [DOC: 9257169] ℹ️  Service Line extracted: 'RN'
[18:22:23] [DOC: 9257169] ℹ️  Payer Source extracted: 'Senior Whole Health'
[18:22:23] [DOC: 9257169] ℹ️  Diagnosis codes being written:
[18:22:23] [DOC: 9257169] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:22:23] [DOC: 9257169] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:22:23] [DOC: 9257169] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:22:23] [DOC: 9257169] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:22:23] [DOC: 9257169] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:22:23] [DOC: 9257169] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:22:23] [DOC: 9257169] ✅ Patient data written to CSV: Donald Brown | Sex: MALE | Age: 75 | Service: RN | Payer: Senior Whole Health | MRN: 114004
[18:22:23] ✅    ✅ Document 9257169 processed and saved successfully
[18:22:23] 🔄 
🔄 Step 8: Saving API details...
[18:22:23] [DOC: 9257169] ℹ️  API push details saved for document 9257169
[18:22:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9257146                         ║
================================================================================
[18:22:23] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[18:22:23] ℹ️  Date: 04/23/2025
[18:22:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:22:25] [DOC: 9257146] ✅ Text extracted using pdfplumber (1425 chars)
[18:22:25] ✅    ✅ Text extracted using pdfplumber (1425 chars)
[18:22:25] 🔄 
🔄 Step 2: Extracting patient data...
[18:22:28] ℹ️  AI extracted raw sex value: 'M'
[18:22:28] ℹ️  AI extracted service line: 'RN'
[18:22:28] ℹ️  AI extracted payer source: 'Medicaid/MA'
[18:22:28] ℹ️  AI extracted diagnoses:
[18:22:28] ℹ️    - Diagnosis 1: ''
[18:22:28] ℹ️    - Diagnosis 2: ''
[18:22:28] ℹ️    - Diagnosis 3: ''
[18:22:28] ℹ️    - Diagnosis 4: ''
[18:22:28] ℹ️    - Diagnosis 5: ''
[18:22:28] ℹ️    - Diagnosis 6: ''
[18:22:28] ℹ️  Final extracted MRN: '343005'
[18:22:28] ℹ️  Final extracted Sex: 'MALE'
[18:22:28] ℹ️  Final extracted Service Line: 'RN'
[18:22:28] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[18:22:28] ✅ Patient data extraction completed successfully
[18:22:28] ✅    ✅ Patient data extracted successfully
[18:22:28] 📊 Patient Response
     └─ patientFName: Kevin
     └─ patientLName: Livramento
     └─ dob: 08/25/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 343005
     └─ billingProvider: Karine A Maalouf-Kaleshian, MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/27/2022', 'startOfEpisode': '', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:22:28] ✅    ✅ Patient identified: Kevin Livramento
[18:22:28] ✅    ✅ Patient name validation passed
[18:22:28] 🔄 
🔄 Step 3: Processing patient dates...
[18:22:28] [DOC: 9257146] ℹ️  DOB normalized: 08/25/1966
[18:22:28] [DOC: 9257146] ℹ️  Episode startOfCare normalized: 09/27/2022
[18:22:28] [DOC: 9257146] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[18:22:28] [DOC: 9257146] ✅ Patient date processing completed successfully
[18:22:28] ✅    ✅ Date processing completed
[18:22:28] 📊 Processed Patient Data
     └─ patientFName: Kevin
     └─ patientLName: Livramento
     └─ dob: 08/25/1966
     └─ patientSex: MALE
     └─ medicalRecordNo: 343005
     └─ billingProvider: Karine A Maalouf-Kaleshian, MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/27/2022', 'startOfEpisode': '', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:22:28] 🔄 
🔄 Step 4: Extracting order data...
[18:22:31] ℹ️  Order extraction - MRN: '343005'
[18:22:31] ℹ️  Order extraction - Sex: 'MALE'
[18:22:31] ℹ️  Order extraction - Service Line: 'HHA'
[18:22:31] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[18:22:31] ✅ Order data extraction completed successfully
[18:22:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:22:31] ℹ️  Using MRN from patient data: '343005' over '343005'
[18:22:31] ℹ️  Combined service lines: Patient='RN' + Order='HHA' = 'HHA, RN'
[18:22:31] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[18:22:31] ✅ Patient name cross-validation successful
[18:22:31] ✅    ✅ Data merged successfully
[18:22:32] ✅    ✅ Order data extracted and validated
[18:22:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:22:32] [DOC: 9257146] ✅ Patient found in local cache: Kevin Livramento, ID: 0421c82d-50f6-4c4a-9b9e-157bb352b9bb
[18:22:32] ✅    ✅ Existing patient found with ID: 0421c82d-50f6-4c4a-9b9e-157bb352b9bb
[18:22:32] 🔄 
🔄 Step 6: Pushing order to API...
[18:22:32] [DOC: 9257146] ℹ️  Pushing order via API for patient ID: 0421c82d-50f6-4c4a-9b9e-157bb352b9bb
[18:22:33] [DOC: 9257146] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[18:22:33] ❌    ❌ Failed to push order
[18:22:33] 🔄 
🔄 Step 7: Writing to CSV...
[18:22:33] [DOC: 9257146] ℹ️  Calculated age: 58 from DOB: 08/25/1966
[18:22:33] [DOC: 9257146] ℹ️  Service Line extracted: 'HHA, RN'
[18:22:33] [DOC: 9257146] ℹ️  Payer Source extracted: 'Medicaid/MA'
[18:22:33] [DOC: 9257146] ℹ️  Diagnosis codes being written:
[18:22:33] [DOC: 9257146] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:22:33] [DOC: 9257146] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:22:33] [DOC: 9257146] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:22:33] [DOC: 9257146] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:22:33] [DOC: 9257146] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:22:33] [DOC: 9257146] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:22:33] [DOC: 9257146] ✅ Patient data written to CSV: Kevin Livramento | Sex: MALE | Age: 58 | Service: HHA, RN | Payer: Medicaid/MA | MRN: 343005
[18:22:33] ✅    ✅ Document 9257146 processed and saved successfully
[18:22:33] 🔄 
🔄 Step 8: Saving API details...
[18:22:33] [DOC: 9257146] ℹ️  API push details saved for document 9257146
[18:22:33] ✅    ✅ API details saved
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[18:22:33] ℹ️  Total Processed: 49
[18:22:33] ℹ️  CSV Success: 31
[18:22:33] ℹ️  CSV Errors: 8
[18:22:33] ℹ️  API Success: 0
[18:22:33] ℹ️  API Errors: 41
[18:22:33] ℹ️  CSV Success Rate: 63.3%
[18:22:33] ℹ️  API Success Rate: 0.0%
[18:22:33] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250607_180658.csv
[18:22:33] ℹ️  API Details File: api_outputs/api_push_details_20250607_180658.csv
================================================================================
║          ============================================================          ║
================================================================================
