================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[02:32:49] ℹ️  CSV Data Extraction & API Push Tool
[02:32:49] ℹ️  
[02:32:49] ℹ️  Features:
[02:32:49] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[02:32:49] ℹ️  - AI-powered patient and order data extraction
[02:32:49] ℹ️  - Enhanced error handling and logging
[02:32:49] ℹ️  - Full API integration (patient creation + order pushing)
[02:32:49] ℹ️  - CSV output with comprehensive patient data
[02:32:49] ℹ️  - Detailed API tracking with remarks for every document
[02:32:49] ℹ️  - Complete audit trail of all processing attempts
[02:32:49] ℹ️  
[02:32:49] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[02:32:49] ✅ Created output CSV file: csv_outputs/extracted_patients_20250608_023249.csv
[02:32:49] ✅ Created API details CSV file: api_outputs/api_push_details_20250608_023249.csv
================================================================================
║                        Processing Document ID: 9252739                         ║
================================================================================
[02:32:49] ℹ️  Agency: Dartmouth HH
[02:32:49] ℹ️  Date: 04/22/2025
[02:32:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:32:51] [DOC: 9252739] ✅ Text extracted using pdfplumber (1066 chars)
[02:32:51] ✅    ✅ Text extracted using pdfplumber (1066 chars)
[02:32:51] 🔄 
🔄 Step 2: Extracting patient data...
[02:32:55] ℹ️  AI extracted raw sex value: 'M'
[02:32:55] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:32:55] ℹ️  AI extracted payer source: 'Medicare'
[02:32:55] ℹ️  AI extracted diagnoses:
[02:32:55] ℹ️    - Diagnosis 1: ''
[02:32:55] ℹ️    - Diagnosis 2: ''
[02:32:55] ℹ️    - Diagnosis 3: ''
[02:32:55] ℹ️    - Diagnosis 4: ''
[02:32:55] ℹ️    - Diagnosis 5: ''
[02:32:55] ℹ️    - Diagnosis 6: ''
[02:32:55] ℹ️  Final extracted MRN: '6129015'
[02:32:55] ℹ️  Final extracted Sex: 'MALE'
[02:32:55] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:32:55] ℹ️  Final extracted Payer Source: 'Medicare'
[02:32:55] ✅ Patient data extraction completed successfully
[02:32:55] ✅    ✅ Patient data extracted successfully
[02:32:55] 📊 Patient Response
     └─ patientFName: Theodore
     └─ patientLName: Small
     └─ dob: 09/25/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 6129015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:32:55] ✅    ✅ Patient identified: Theodore Small
[02:32:55] ✅    ✅ Patient name validation passed
[02:32:55] 🔄 
🔄 Step 3: Processing patient dates...
[02:32:55] [DOC: 9252739] ℹ️  DOB normalized: 09/25/1931
[02:32:55] [DOC: 9252739] ℹ️  Episode startOfCare normalized: 02/28/2025
[02:32:55] [DOC: 9252739] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[02:32:55] [DOC: 9252739] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[02:32:55] [DOC: 9252739] ✅ Patient date processing completed successfully
[02:32:55] ✅    ✅ Date processing completed
[02:32:55] 📊 Processed Patient Data
     └─ patientFName: Theodore
     └─ patientLName: Small
     └─ dob: 09/25/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 6129015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:32:55] 🔄 
🔄 Step 4: Extracting order data...
[02:32:58] ℹ️  Order extraction - MRN: '6129015'
[02:32:58] ℹ️  Order extraction - Sex: 'MALE'
[02:32:58] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:32:58] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:32:58] ✅ Order data extraction completed successfully
[02:32:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:32:58] ℹ️  Using MRN from patient data: '6129015' over '6129015'
[02:32:58] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:32:58] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:32:58] ✅ Patient name cross-validation successful
[02:32:58] ✅    ✅ Data merged successfully
[02:32:59] ✅    ✅ Order data extracted and validated
[02:32:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:32:59] [DOC: 9252739] ✅ Patient found in local cache: Theodore Small, ID: 8c849805-1775-4653-aa7c-ce211697fc95
[02:32:59] ✅    ✅ Existing patient found with ID: 8c849805-1775-4653-aa7c-ce211697fc95
[02:32:59] 🔄 
🔄 Step 6: Pushing order to API...
[02:32:59] [DOC: 9252739] ℹ️  Pushing order via API for patient ID: 8c849805-1775-4653-aa7c-ce211697fc95
[02:33:03] [DOC: 9252739] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:33:03] ❌    ❌ Failed to push order
[02:33:03] 🔄 
🔄 Step 7: Writing to CSV...
[02:33:03] [DOC: 9252739] ℹ️  Calculated age: 93 from DOB: 09/25/1931
[02:33:03] [DOC: 9252739] ℹ️  Service Line extracted: 'Skilled Nursing'
[02:33:03] [DOC: 9252739] ℹ️  Payer Source extracted: 'Medicare'
[02:33:03] [DOC: 9252739] ℹ️  Diagnosis codes being written:
[02:33:03] [DOC: 9252739] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:33:03] [DOC: 9252739] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:33:03] [DOC: 9252739] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:33:03] [DOC: 9252739] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:33:03] [DOC: 9252739] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:33:03] [DOC: 9252739] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:33:03] [DOC: 9252739] ✅ Patient data written to CSV: Theodore Small | Sex: MALE | Age: 93 | Service: Skilled Nursing | Payer: Medicare | MRN: 6129015
[02:33:03] ✅    ✅ Document 9252739 processed and saved successfully
[02:33:03] 🔄 
🔄 Step 8: Saving API details...
[02:33:03] [DOC: 9252739] ℹ️  API push details saved for document 9252739
[02:33:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252737                         ║
================================================================================
[02:33:03] ℹ️  Agency: Dartmouth HH
[02:33:03] ℹ️  Date: 04/22/2025
[02:33:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:33:05] [DOC: 9252737] ✅ Text extracted using pdfplumber (6476 chars)
[02:33:05] ✅    ✅ Text extracted using pdfplumber (6476 chars)
[02:33:05] 🔄 
🔄 Step 2: Extracting patient data...
[02:33:08] ℹ️  AI extracted raw sex value: 'M'
[02:33:08] ℹ️  AI extracted service line: 'Physical Therapy'
[02:33:08] ℹ️  AI extracted payer source: 'Medicare'
[02:33:08] ℹ️  AI extracted diagnoses:
[02:33:08] ℹ️    - Diagnosis 1: ''
[02:33:08] ℹ️    - Diagnosis 2: ''
[02:33:08] ℹ️    - Diagnosis 3: ''
[02:33:08] ℹ️    - Diagnosis 4: ''
[02:33:08] ℹ️    - Diagnosis 5: ''
[02:33:08] ℹ️    - Diagnosis 6: ''
[02:33:08] ℹ️  Final extracted MRN: '4937015'
[02:33:08] ℹ️  Final extracted Sex: 'MALE'
[02:33:08] ℹ️  Final extracted Service Line: 'Physical Therapy'
[02:33:08] ℹ️  Final extracted Payer Source: 'Medicare'
[02:33:08] ✅ Patient data extraction completed successfully
[02:33:08] ✅    ✅ Patient data extracted successfully
[02:33:08] 📊 Patient Response
     └─ patientFName: Harvey
     └─ patientLName: Lewis
     └─ dob: 05/02/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 4937015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/18/2024', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:33:08] ✅    ✅ Patient identified: Harvey Lewis
[02:33:08] ✅    ✅ Patient name validation passed
[02:33:08] 🔄 
🔄 Step 3: Processing patient dates...
[02:33:08] [DOC: 9252737] ℹ️  DOB normalized: 05/02/1949
[02:33:08] [DOC: 9252737] ℹ️  Episode startOfCare normalized: 12/18/2024
[02:33:08] [DOC: 9252737] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[02:33:08] [DOC: 9252737] ℹ️  Episode endOfEpisode normalized: 06/15/2025
[02:33:08] [DOC: 9252737] ✅ Patient date processing completed successfully
[02:33:08] ✅    ✅ Date processing completed
[02:33:08] 📊 Processed Patient Data
     └─ patientFName: Harvey
     └─ patientLName: Lewis
     └─ dob: 05/02/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 4937015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/18/2024', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:33:08] 🔄 
🔄 Step 4: Extracting order data...
[02:33:10] ℹ️  Order extraction - MRN: '4937015'
[02:33:10] ℹ️  Order extraction - Sex: 'MALE'
[02:33:10] ℹ️  Order extraction - Service Line: 'PT'
[02:33:10] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:33:10] ✅ Order data extraction completed successfully
[02:33:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:33:10] ℹ️  Using MRN from patient data: '4937015' over '4937015'
[02:33:10] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[02:33:10] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:33:10] ✅ Patient name cross-validation successful
[02:33:10] ✅    ✅ Data merged successfully
[02:33:12] ✅    ✅ Order data extracted and validated
[02:33:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:33:42] [DOC: 9252737] ✅ Patient exists in API: Harvey Lewis, ID: 173f09ed-5f3d-4120-a940-63a4db422257
[02:33:42] ✅    ✅ Existing patient found with ID: 173f09ed-5f3d-4120-a940-63a4db422257
[02:33:42] 🔄 
🔄 Step 6: Pushing order to API...
[02:33:42] [DOC: 9252737] ℹ️  Pushing order via API for patient ID: 173f09ed-5f3d-4120-a940-63a4db422257
[02:33:44] [DOC: 9252737] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:33:44] ❌    ❌ Failed to push order
[02:33:44] 🔄 
🔄 Step 7: Writing to CSV...
[02:33:44] [DOC: 9252737] ℹ️  Calculated age: 76 from DOB: 05/02/1949
[02:33:44] [DOC: 9252737] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[02:33:44] [DOC: 9252737] ℹ️  Payer Source extracted: 'Medicare'
[02:33:44] [DOC: 9252737] ℹ️  Diagnosis codes being written:
[02:33:44] [DOC: 9252737] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:33:44] [DOC: 9252737] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:33:44] [DOC: 9252737] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:33:44] [DOC: 9252737] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:33:44] [DOC: 9252737] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:33:44] [DOC: 9252737] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:33:44] [DOC: 9252737] ✅ Patient data written to CSV: Harvey Lewis | Sex: MALE | Age: 76 | Service: PT, Physical Therapy | Payer: Medicare | MRN: 4937015
[02:33:44] ✅    ✅ Document 9252737 processed and saved successfully
[02:33:44] 🔄 
🔄 Step 8: Saving API details...
[02:33:44] [DOC: 9252737] ℹ️  API push details saved for document 9252737
[02:33:44] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252735                         ║
================================================================================
[02:33:44] ℹ️  Agency: Dartmouth HH
[02:33:44] ℹ️  Date: 04/22/2025
[02:33:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:33:46] [DOC: 9252735] ✅ Text extracted using pdfplumber (1390 chars)
[02:33:46] ✅    ✅ Text extracted using pdfplumber (1390 chars)
[02:33:46] 🔄 
🔄 Step 2: Extracting patient data...
[02:33:49] ℹ️  AI extracted raw sex value: 'M'
[02:33:49] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:33:49] ℹ️  AI extracted payer source: 'Medicare'
[02:33:49] ℹ️  AI extracted diagnoses:
[02:33:49] ℹ️    - Diagnosis 1: ''
[02:33:49] ℹ️    - Diagnosis 2: ''
[02:33:49] ℹ️    - Diagnosis 3: ''
[02:33:49] ℹ️    - Diagnosis 4: ''
[02:33:49] ℹ️    - Diagnosis 5: ''
[02:33:49] ℹ️    - Diagnosis 6: ''
[02:33:49] ℹ️  Final extracted MRN: '6570009'
[02:33:49] ℹ️  Final extracted Sex: 'MALE'
[02:33:49] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:33:49] ℹ️  Final extracted Payer Source: 'Medicare'
[02:33:49] ✅ Patient data extraction completed successfully
[02:33:49] ✅    ✅ Patient data extracted successfully
[02:33:49] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Wood
     └─ dob: 01/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 6570009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/29/2024', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:33:49] ✅    ✅ Patient identified: James Wood
[02:33:49] ✅    ✅ Patient name validation passed
[02:33:49] 🔄 
🔄 Step 3: Processing patient dates...
[02:33:49] [DOC: 9252735] ℹ️  DOB normalized: 01/29/1944
[02:33:49] [DOC: 9252735] ℹ️  Episode startOfCare normalized: 10/29/2024
[02:33:49] [DOC: 9252735] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[02:33:49] [DOC: 9252735] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[02:33:49] [DOC: 9252735] ✅ Patient date processing completed successfully
[02:33:49] ✅    ✅ Date processing completed
[02:33:49] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Wood
     └─ dob: 01/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 6570009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/29/2024', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:33:49] 🔄 
🔄 Step 4: Extracting order data...
[02:33:51] ℹ️  Order extraction - MRN: ''
[02:33:51] ℹ️  Order extraction - Sex: 'MALE'
[02:33:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:33:51] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:33:51] ✅ Order data extraction completed successfully
[02:33:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:33:51] ℹ️  Using MRN from patient data: '6570009'
[02:33:51] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:33:51] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:33:51] ✅ Patient name cross-validation successful
[02:33:51] ✅    ✅ Data merged successfully
[02:33:53] ✅    ✅ Order data extracted and validated
[02:33:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:33:53] [DOC: 9252735] ✅ Patient found in local cache: James Wood, ID: b532915a-79b5-4b9d-9458-683e03933774
[02:33:53] ✅    ✅ Existing patient found with ID: b532915a-79b5-4b9d-9458-683e03933774
[02:33:53] 🔄 
🔄 Step 6: Pushing order to API...
[02:33:53] [DOC: 9252735] ℹ️  Pushing order via API for patient ID: b532915a-79b5-4b9d-9458-683e03933774
[02:33:54] [DOC: 9252735] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14427"}
[02:33:54] ❌    ❌ Failed to push order
[02:33:54] 🔄 
🔄 Step 7: Writing to CSV...
[02:33:54] [DOC: 9252735] ℹ️  Calculated age: 81 from DOB: 01/29/1944
[02:33:54] [DOC: 9252735] ℹ️  Service Line extracted: 'Skilled Nursing'
[02:33:54] [DOC: 9252735] ℹ️  Payer Source extracted: 'Medicare'
[02:33:54] [DOC: 9252735] ℹ️  Diagnosis codes being written:
[02:33:54] [DOC: 9252735] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:33:54] [DOC: 9252735] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:33:54] [DOC: 9252735] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:33:54] [DOC: 9252735] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:33:54] [DOC: 9252735] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:33:54] [DOC: 9252735] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:33:54] [DOC: 9252735] ✅ Patient data written to CSV: James Wood | Sex: MALE | Age: 81 | Service: Skilled Nursing | Payer: Medicare | MRN: 6570009
[02:33:54] ✅    ✅ Document 9252735 processed and saved successfully
[02:33:54] 🔄 
🔄 Step 8: Saving API details...
[02:33:54] [DOC: 9252735] ℹ️  API push details saved for document 9252735
[02:33:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252722                         ║
================================================================================
[02:33:54] ℹ️  Agency: Dartmouth HH
[02:33:54] ℹ️  Date: 04/22/2025
[02:33:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:34:00] [DOC: 9252722] ✅ Text extracted using pdfplumber (6896 chars)
[02:34:00] ✅    ✅ Text extracted using pdfplumber (6896 chars)
[02:34:00] 🔄 
🔄 Step 2: Extracting patient data...
[02:34:03] ℹ️  AI extracted raw sex value: 'F'
[02:34:03] ℹ️  AI extracted service line: 'OT, PT, Nursing'
[02:34:03] ℹ️  AI extracted payer source: 'Fallon Navicare'
[02:34:03] ℹ️  AI extracted diagnoses:
[02:34:03] ℹ️    - Diagnosis 1: 'C50.91'
[02:34:03] ℹ️    - Diagnosis 2: 'E11.9'
[02:34:03] ℹ️    - Diagnosis 3: 'D64.9'
[02:34:03] ℹ️    - Diagnosis 4: 'F41.1'
[02:34:03] ℹ️    - Diagnosis 5: 'K21.9'
[02:34:03] ℹ️    - Diagnosis 6: 'I11.0'
[02:34:03] ℹ️  Final extracted MRN: '7544009'
[02:34:03] ℹ️  Final extracted Sex: 'FEMALE'
[02:34:03] ℹ️  Final extracted Service Line: 'OT, PT, Nursing'
[02:34:03] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[02:34:03] ✅ Patient data extraction completed successfully
[02:34:03] ✅    ✅ Patient data extracted successfully
[02:34:03] 📊 Patient Response
     └─ patientFName: Sandra
     └─ patientLName: Knickerbocker
     └─ dob: 07/22/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7544009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, PT, Nursing
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'C50.91', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'D64.9', 'fourthDiagnosis': 'F41.1', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'I11.0'}]
[02:34:03] ✅    ✅ Patient identified: Sandra Knickerbocker
[02:34:03] ✅    ✅ Patient name validation passed
[02:34:03] 🔄 
🔄 Step 3: Processing patient dates...
[02:34:03] [DOC: 9252722] ℹ️  DOB normalized: 07/22/1948
[02:34:03] [DOC: 9252722] ℹ️  Episode startOfCare normalized: 03/26/2025
[02:34:03] [DOC: 9252722] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[02:34:03] [DOC: 9252722] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[02:34:03] [DOC: 9252722] ✅ Patient date processing completed successfully
[02:34:03] ✅    ✅ Date processing completed
[02:34:03] 📊 Processed Patient Data
     └─ patientFName: Sandra
     └─ patientLName: Knickerbocker
     └─ dob: 07/22/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7544009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, PT, Nursing
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'C50.91', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'D64.9', 'fourthDiagnosis': 'F41.1', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'I11.0'}]
[02:34:03] 🔄 
🔄 Step 4: Extracting order data...
[02:34:05] ℹ️  Order extraction - MRN: '7544009'
[02:34:05] ℹ️  Order extraction - Sex: 'FEMALE'
[02:34:05] ℹ️  Order extraction - Service Line: 'OT'
[02:34:05] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[02:34:05] ✅ Order data extraction completed successfully
[02:34:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:34:05] ℹ️  Using MRN from patient data: '7544009' over '7544009'
[02:34:05] ℹ️  Combined service lines: Patient='OT, PT, Nursing' + Order='OT' = 'Nursing, OT, PT'
[02:34:05] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[02:34:05] ✅ Patient name cross-validation successful
[02:34:05] ✅    ✅ Data merged successfully
[02:34:06] ✅    ✅ Order data extracted and validated
[02:34:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:34:06] [DOC: 9252722] ✅ Patient found in local cache: Sandra Knickerbocker, ID: 72b6d189-6994-4d0a-9e48-56e329440311
[02:34:06] ✅    ✅ Existing patient found with ID: 72b6d189-6994-4d0a-9e48-56e329440311
[02:34:06] 🔄 
🔄 Step 6: Pushing order to API...
[02:34:06] [DOC: 9252722] ℹ️  Pushing order via API for patient ID: 72b6d189-6994-4d0a-9e48-56e329440311
[02:34:09] [DOC: 9252722] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:34:09] ❌    ❌ Failed to push order
[02:34:09] 🔄 
🔄 Step 7: Writing to CSV...
[02:34:09] [DOC: 9252722] ℹ️  Calculated age: 76 from DOB: 07/22/1948
[02:34:09] [DOC: 9252722] ℹ️  Service Line extracted: 'Nursing, OT, PT'
[02:34:09] [DOC: 9252722] ℹ️  Payer Source extracted: 'Fallon Navicare'
[02:34:09] [DOC: 9252722] ℹ️  Diagnosis codes being written:
[02:34:09] [DOC: 9252722] ℹ️    - Latest_Episode_Firstdiagnosis: 'C50.91'
[02:34:09] [DOC: 9252722] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[02:34:09] [DOC: 9252722] ℹ️    - Latest_Episode_Thirddiagnosis: 'D64.9'
[02:34:09] [DOC: 9252722] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F41.1'
[02:34:09] [DOC: 9252722] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K21.9'
[02:34:09] [DOC: 9252722] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I11.0'
[02:34:09] [DOC: 9252722] ✅ Patient data written to CSV: Sandra Knickerbocker | Sex: FEMALE | Age: 76 | Service: Nursing, OT, PT | Payer: Fallon Navicare | MRN: 7544009
[02:34:09] ✅    ✅ Document 9252722 processed and saved successfully
[02:34:09] 🔄 
🔄 Step 8: Saving API details...
[02:34:09] [DOC: 9252722] ℹ️  API push details saved for document 9252722
[02:34:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252720                         ║
================================================================================
[02:34:09] ℹ️  Agency: Dartmouth HH
[02:34:09] ℹ️  Date: 04/22/2025
[02:34:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:34:14] [DOC: 9252720] ✅ Text extracted using pdfplumber (14081 chars)
[02:34:14] ✅    ✅ Text extracted using pdfplumber (14081 chars)
[02:34:14] 🔄 
🔄 Step 2: Extracting patient data...
[02:34:17] ℹ️  AI extracted raw sex value: 'F'
[02:34:17] ℹ️  AI extracted service line: 'PT, OT'
[02:34:17] ℹ️  AI extracted payer source: ''
[02:34:17] ℹ️  AI extracted diagnoses:
[02:34:17] ℹ️    - Diagnosis 1: 'M54.17'
[02:34:17] ℹ️    - Diagnosis 2: 'R29.6'
[02:34:17] ℹ️    - Diagnosis 3: 'M06.9'
[02:34:17] ℹ️    - Diagnosis 4: 'M32.9'
[02:34:17] ℹ️    - Diagnosis 5: 'M35.1'
[02:34:17] ℹ️    - Diagnosis 6: 'M54.6'
[02:34:17] ℹ️  Final extracted MRN: '3537009'
[02:34:17] ℹ️  Final extracted Sex: 'FEMALE'
[02:34:17] ℹ️  Final extracted Service Line: 'PT, OT'
[02:34:17] ℹ️  Final extracted Payer Source: ''
[02:34:17] ✅ Patient data extraction completed successfully
[02:34:17] ✅    ✅ Patient data extracted successfully
[02:34:17] 📊 Patient Response
     └─ patientFName: Leonette
     └─ patientLName: Bourbeau
     └─ dob: 07/15/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3537009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 100207151257
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/14/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'M54.17', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'M06.9', 'fourthDiagnosis': 'M32.9', 'fifthDiagnosis': 'M35.1', 'sixthDiagnosis': 'M54.6'}]
[02:34:17] ✅    ✅ Patient identified: Leonette Bourbeau
[02:34:17] ✅    ✅ Patient name validation passed
[02:34:17] 🔄 
🔄 Step 3: Processing patient dates...
[02:34:17] [DOC: 9252720] ℹ️  DOB normalized: 07/15/1948
[02:34:17] [DOC: 9252720] ℹ️  Episode startOfCare normalized: 04/14/2025
[02:34:17] [DOC: 9252720] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[02:34:17] [DOC: 9252720] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[02:34:17] [DOC: 9252720] ✅ Patient date processing completed successfully
[02:34:17] ✅    ✅ Date processing completed
[02:34:17] 📊 Processed Patient Data
     └─ patientFName: Leonette
     └─ patientLName: Bourbeau
     └─ dob: 07/15/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3537009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 100207151257
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/14/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'M54.17', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'M06.9', 'fourthDiagnosis': 'M32.9', 'fifthDiagnosis': 'M35.1', 'sixthDiagnosis': 'M54.6'}]
[02:34:17] 🔄 
🔄 Step 4: Extracting order data...
[02:34:20] ℹ️  Order extraction - MRN: '3537009'
[02:34:20] ℹ️  Order extraction - Sex: 'FEMALE'
[02:34:20] ℹ️  Order extraction - Service Line: 'PT, OT'
[02:34:20] ℹ️  Order extraction - Payer Source: ''
[02:34:20] ✅ Order data extraction completed successfully
[02:34:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:34:20] ℹ️  Using MRN from patient data: '3537009' over '3537009'
[02:34:20] ℹ️  Service line consistent in both sources: 'PT, OT'
[02:34:20] ✅ Patient name cross-validation successful
[02:34:20] ✅    ✅ Data merged successfully
[02:34:21] ✅    ✅ Order data extracted and validated
[02:34:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:34:21] [DOC: 9252720] ✅ Patient found in local cache: Leonette Bourbeau, ID: 8a413ee5-d64b-44e4-93fe-9da4285ed63b
[02:34:21] ✅    ✅ Existing patient found with ID: 8a413ee5-d64b-44e4-93fe-9da4285ed63b
[02:34:21] 🔄 
🔄 Step 6: Pushing order to API...
[02:34:21] [DOC: 9252720] ℹ️  Pushing order via API for patient ID: 8a413ee5-d64b-44e4-93fe-9da4285ed63b
[02:34:22] [DOC: 9252720] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:34:22] ❌    ❌ Failed to push order
[02:34:22] 🔄 
🔄 Step 7: Writing to CSV...
[02:34:22] [DOC: 9252720] ℹ️  Calculated age: 76 from DOB: 07/15/1948
[02:34:22] [DOC: 9252720] ℹ️  Service Line extracted: 'PT, OT'
[02:34:22] [DOC: 9252720] ℹ️  Payer Source extracted: ''
[02:34:22] [DOC: 9252720] ℹ️  Diagnosis codes being written:
[02:34:22] [DOC: 9252720] ℹ️    - Latest_Episode_Firstdiagnosis: 'M54.17'
[02:34:22] [DOC: 9252720] ℹ️    - Latest_Episode_Seconddiagnosis: 'R29.6'
[02:34:22] [DOC: 9252720] ℹ️    - Latest_Episode_Thirddiagnosis: 'M06.9'
[02:34:22] [DOC: 9252720] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M32.9'
[02:34:22] [DOC: 9252720] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M35.1'
[02:34:22] [DOC: 9252720] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M54.6'
[02:34:22] [DOC: 9252720] ✅ Patient data written to CSV: Leonette Bourbeau | Sex: FEMALE | Age: 76 | Service: PT, OT | Payer:  | MRN: 3537009
[02:34:22] ✅    ✅ Document 9252720 processed and saved successfully
[02:34:22] 🔄 
🔄 Step 8: Saving API details...
[02:34:22] [DOC: 9252720] ℹ️  API push details saved for document 9252720
[02:34:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252718                         ║
================================================================================
[02:34:22] ℹ️  Agency: Dartmouth HH
[02:34:22] ℹ️  Date: 04/22/2025
[02:34:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:34:24] [DOC: 9252718] ✅ Text extracted using pdfplumber (4328 chars)
[02:34:24] ✅    ✅ Text extracted using pdfplumber (4328 chars)
[02:34:24] 🔄 
🔄 Step 2: Extracting patient data...
[02:34:27] ℹ️  AI extracted raw sex value: 'M'
[02:34:27] ℹ️  AI extracted service line: 'OT'
[02:34:27] ℹ️  AI extracted payer source: 'Fallon Health'
[02:34:27] ℹ️  AI extracted diagnoses:
[02:34:27] ℹ️    - Diagnosis 1: 'None'
[02:34:27] ℹ️    - Diagnosis 2: 'None'
[02:34:27] ℹ️    - Diagnosis 3: 'None'
[02:34:27] ℹ️    - Diagnosis 4: 'None'
[02:34:27] ℹ️    - Diagnosis 5: 'None'
[02:34:27] ℹ️    - Diagnosis 6: 'None'
[02:34:27] ℹ️  Final extracted MRN: '6057015'
[02:34:27] ℹ️  Final extracted Sex: 'MALE'
[02:34:27] ℹ️  Final extracted Service Line: 'OT'
[02:34:27] ℹ️  Final extracted Payer Source: 'Fallon Health'
[02:34:27] ✅ Patient data extraction completed successfully
[02:34:27] ✅    ✅ Patient data extracted successfully
[02:34:27] 📊 Patient Response
     └─ patientFName: Edgar
     └─ patientLName: Fonseca
     └─ dob: 02/02/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 6057015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:34:27] ✅    ✅ Patient identified: Edgar Fonseca
[02:34:27] ✅    ✅ Patient name validation passed
[02:34:27] 🔄 
🔄 Step 3: Processing patient dates...
[02:34:27] [DOC: 9252718] ℹ️  DOB normalized: 02/02/1952
[02:34:27] [DOC: 9252718] ℹ️  Episode startOfCare normalized: 03/22/2025
[02:34:27] [DOC: 9252718] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[02:34:27] [DOC: 9252718] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[02:34:27] [DOC: 9252718] ✅ Patient date processing completed successfully
[02:34:27] ✅    ✅ Date processing completed
[02:34:27] 📊 Processed Patient Data
     └─ patientFName: Edgar
     └─ patientLName: Fonseca
     └─ dob: 02/02/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 6057015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025'}]
[02:34:27] 🔄 
🔄 Step 4: Extracting order data...
[02:34:30] ℹ️  Order extraction - MRN: '6057015'
[02:34:30] ℹ️  Order extraction - Sex: 'MALE'
[02:34:30] ℹ️  Order extraction - Service Line: 'OT'
[02:34:30] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[02:34:30] ✅ Order data extraction completed successfully
[02:34:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:34:30] ℹ️  Using MRN from patient data: '6057015' over '6057015'
[02:34:30] ℹ️  Service line consistent in both sources: 'OT'
[02:34:30] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[02:34:30] ✅ Patient name cross-validation successful
[02:34:30] ✅    ✅ Data merged successfully
[02:34:31] ✅    ✅ Order data extracted and validated
[02:34:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:35:03] [DOC: 9252718] ✅ Patient exists in API: Edgar Fonseca, ID: 1f03a3f1-e861-47fe-893c-2a637ae30c56
[02:35:03] ✅    ✅ Existing patient found with ID: 1f03a3f1-e861-47fe-893c-2a637ae30c56
[02:35:03] 🔄 
🔄 Step 6: Pushing order to API...
[02:35:03] [DOC: 9252718] ℹ️  Pushing order via API for patient ID: 1f03a3f1-e861-47fe-893c-2a637ae30c56
[02:35:05] [DOC: 9252718] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:35:05] ❌    ❌ Failed to push order
[02:35:05] 🔄 
🔄 Step 7: Writing to CSV...
[02:35:05] [DOC: 9252718] ℹ️  Calculated age: 73 from DOB: 02/02/1952
[02:35:05] [DOC: 9252718] ℹ️  Service Line extracted: 'OT'
[02:35:05] [DOC: 9252718] ℹ️  Payer Source extracted: 'Fallon Health'
[02:35:05] [DOC: 9252718] ℹ️  Diagnosis codes being written:
[02:35:05] [DOC: 9252718] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:35:05] [DOC: 9252718] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:35:05] [DOC: 9252718] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:35:05] [DOC: 9252718] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:35:05] [DOC: 9252718] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:35:05] [DOC: 9252718] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:35:05] [DOC: 9252718] ✅ Patient data written to CSV: Edgar Fonseca | Sex: MALE | Age: 73 | Service: OT | Payer: Fallon Health | MRN: 6057015
[02:35:05] ✅    ✅ Document 9252718 processed and saved successfully
[02:35:05] 🔄 
🔄 Step 8: Saving API details...
[02:35:05] [DOC: 9252718] ℹ️  API push details saved for document 9252718
[02:35:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252702                         ║
================================================================================
[02:35:05] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[02:35:05] ℹ️  Date: 04/22/2025
[02:35:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:35:06] [DOC: 9252702] ✅ Text extracted using pdfplumber (1118 chars)
[02:35:06] ✅    ✅ Text extracted using pdfplumber (1118 chars)
[02:35:06] 🔄 
🔄 Step 2: Extracting patient data...
[02:35:09] ℹ️  AI extracted raw sex value: 'F'
[02:35:09] ℹ️  AI extracted service line: 'Physical Therapy'
[02:35:09] ℹ️  AI extracted payer source: ''
[02:35:09] ℹ️  AI extracted diagnoses:
[02:35:09] ℹ️    - Diagnosis 1: ''
[02:35:09] ℹ️    - Diagnosis 2: ''
[02:35:09] ℹ️    - Diagnosis 3: ''
[02:35:09] ℹ️    - Diagnosis 4: ''
[02:35:09] ℹ️    - Diagnosis 5: ''
[02:35:09] ℹ️    - Diagnosis 6: ''
[02:35:09] ℹ️  Final extracted MRN: '3046109'
[02:35:09] ℹ️  Final extracted Sex: 'FEMALE'
[02:35:09] ℹ️  Final extracted Service Line: 'Physical Therapy'
[02:35:09] ℹ️  Final extracted Payer Source: ''
[02:35:09] ✅ Patient data extraction completed successfully
[02:35:09] ✅    ✅ Patient data extracted successfully
[02:35:09] 📊 Patient Response
     └─ patientFName: Irva
     └─ patientLName: Torres
     └─ dob: 01/28/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3046109
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:35:09] ✅    ✅ Patient identified: Irva Torres
[02:35:09] ✅    ✅ Patient name validation passed
[02:35:09] 🔄 
🔄 Step 3: Processing patient dates...
[02:35:09] [DOC: 9252702] ℹ️  DOB normalized: 01/28/1929
[02:35:09] [DOC: 9252702] ✅ Patient date processing completed successfully
[02:35:09] ✅    ✅ Date processing completed
[02:35:09] 📊 Processed Patient Data
     └─ patientFName: Irva
     └─ patientLName: Torres
     └─ dob: 01/28/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3046109
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:35:09] 🔄 
🔄 Step 4: Extracting order data...
[02:35:11] ℹ️  Order extraction - MRN: '3046109'
[02:35:11] ℹ️  Order extraction - Sex: 'FEMALE'
[02:35:11] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[02:35:11] ℹ️  Order extraction - Payer Source: ''
[02:35:11] ✅ Order data extraction completed successfully
[02:35:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:35:11] ℹ️  Using MRN from patient data: '3046109' over '3046109'
[02:35:11] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[02:35:11] ✅ Patient name cross-validation successful
[02:35:11] ✅    ✅ Data merged successfully
[02:35:12] ✅    ✅ Order data extracted and validated
[02:35:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:35:50] [DOC: 9252702] ℹ️  Patient not found in cache or API: Irva Torres
[02:35:50] [DOC: 9252702] ℹ️  Patient not found, creating new patient via API...
[02:35:50] [DOC: 9252702] ℹ️  Creating patient via API: Irva Torres
[02:35:52] [DOC: 9252702] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:35:52] ❌    ❌ Failed to create patient
[02:35:52] [DOC: 9252702] ℹ️  API push details saved for document 9252702
================================================================================
║                        Processing Document ID: 9252698                         ║
================================================================================
[02:35:52] ℹ️  Agency: AccentCare Fall River
[02:35:52] ℹ️  Date: 04/22/2025
[02:35:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:35:54] [DOC: 9252698] ✅ Text extracted using pdfplumber (1153 chars)
[02:35:54] ✅    ✅ Text extracted using pdfplumber (1153 chars)
[02:35:54] 🔄 
🔄 Step 2: Extracting patient data...
[02:35:57] ℹ️  AI extracted raw sex value: ''
[02:35:57] ℹ️  AI extracted service line: ''
[02:35:57] ℹ️  AI extracted payer source: ''
[02:35:57] ℹ️  AI extracted diagnoses:
[02:35:57] ℹ️    - Diagnosis 1: ''
[02:35:57] ℹ️    - Diagnosis 2: ''
[02:35:57] ℹ️    - Diagnosis 3: ''
[02:35:57] ℹ️    - Diagnosis 4: ''
[02:35:57] ℹ️    - Diagnosis 5: ''
[02:35:57] ℹ️    - Diagnosis 6: ''
[02:35:57] ℹ️  Final extracted MRN: 'C0200225049201'
[02:35:57] ℹ️  Final extracted Sex: ''
[02:35:57] ℹ️  Final extracted Service Line: ''
[02:35:57] ℹ️  Final extracted Payer Source: ''
[02:35:57] ✅ Patient data extraction completed successfully
[02:35:57] ✅    ✅ Patient data extracted successfully
[02:35:57] 📊 Patient Response
     └─ patientFName: BRUNILDA
     └─ patientLName: JORGE
     └─ dob: 11/15/1938
     └─ patientSex: 
     └─ medicalRecordNo: C0200225049201
     └─ billingProvider: JORDAN GULAREK, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:35:57] ✅    ✅ Patient identified: BRUNILDA JORGE
[02:35:57] ✅    ✅ Patient name validation passed
[02:35:57] 🔄 
🔄 Step 3: Processing patient dates...
[02:35:57] [DOC: 9252698] ℹ️  DOB normalized: 11/15/1938
[02:35:57] [DOC: 9252698] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[02:35:57] [DOC: 9252698] ℹ️  Episode endOfEpisode normalized: 04/08/2025
[02:35:57] [DOC: 9252698] ✅ Patient date processing completed successfully
[02:35:57] ✅    ✅ Date processing completed
[02:35:57] 📊 Processed Patient Data
     └─ patientFName: BRUNILDA
     └─ patientLName: JORGE
     └─ dob: 11/15/1938
     └─ patientSex: 
     └─ medicalRecordNo: C0200225049201
     └─ billingProvider: JORDAN GULAREK, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:35:57] 🔄 
🔄 Step 4: Extracting order data...
[02:36:00] ℹ️  Order extraction - MRN: 'C0200225049201'
[02:36:00] ℹ️  Order extraction - Sex: ''
[02:36:00] ℹ️  Order extraction - Service Line: ''
[02:36:00] ℹ️  Order extraction - Payer Source: ''
[02:36:00] ✅ Order data extraction completed successfully
[02:36:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:36:00] ℹ️  Using MRN from patient data: 'C0200225049201' over 'C0200225049201'
[02:36:00] ⚠️  Could not determine sex using any available method
[02:36:00] ✅ Patient name cross-validation successful
[02:36:00] ✅    ✅ Data merged successfully
[02:36:01] ✅    ✅ Order data extracted and validated
[02:36:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:36:01] [DOC: 9252698] ✅ Patient found in local cache: BRUNILDA JORGE, ID: be097701-4784-41f4-8780-f2f69c6e2485
[02:36:01] ✅    ✅ Existing patient found with ID: be097701-4784-41f4-8780-f2f69c6e2485
[02:36:01] 🔄 
🔄 Step 6: Pushing order to API...
[02:36:01] [DOC: 9252698] ℹ️  Pushing order via API for patient ID: be097701-4784-41f4-8780-f2f69c6e2485
[02:36:02] [DOC: 9252698] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13872"}
[02:36:02] ❌    ❌ Failed to push order
[02:36:02] 🔄 
🔄 Step 7: Writing to CSV...
[02:36:02] [DOC: 9252698] ℹ️  Calculated age: 86 from DOB: 11/15/1938
[02:36:02] [DOC: 9252698] ℹ️  Service Line extracted: ''
[02:36:02] [DOC: 9252698] ℹ️  Payer Source extracted: ''
[02:36:02] [DOC: 9252698] ℹ️  Diagnosis codes being written:
[02:36:02] [DOC: 9252698] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:36:02] [DOC: 9252698] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:36:02] [DOC: 9252698] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:36:02] [DOC: 9252698] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:36:02] [DOC: 9252698] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:36:02] [DOC: 9252698] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:36:02] [DOC: 9252698] ✅ Patient data written to CSV: BRUNILDA JORGE | Sex:  | Age: 86 | Service:  | Payer:  | MRN: C0200225049201
[02:36:02] ✅    ✅ Document 9252698 processed and saved successfully
[02:36:02] 🔄 
🔄 Step 8: Saving API details...
[02:36:02] [DOC: 9252698] ℹ️  API push details saved for document 9252698
[02:36:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252697                         ║
================================================================================
[02:36:02] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[02:36:02] ℹ️  Date: 04/22/2025
[02:36:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:36:04] [DOC: 9252697] ✅ Text extracted using pdfplumber (1138 chars)
[02:36:04] ✅    ✅ Text extracted using pdfplumber (1138 chars)
[02:36:04] 🔄 
🔄 Step 2: Extracting patient data...
[02:36:07] ℹ️  AI extracted raw sex value: 'M'
[02:36:07] ℹ️  AI extracted service line: 'Home Health Aide'
[02:36:07] ℹ️  AI extracted payer source: ''
[02:36:07] ℹ️  AI extracted diagnoses:
[02:36:07] ℹ️    - Diagnosis 1: 'None'
[02:36:07] ℹ️    - Diagnosis 2: 'None'
[02:36:07] ℹ️    - Diagnosis 3: 'None'
[02:36:07] ℹ️    - Diagnosis 4: 'None'
[02:36:07] ℹ️    - Diagnosis 5: 'None'
[02:36:07] ℹ️    - Diagnosis 6: 'None'
[02:36:07] ℹ️  Final extracted MRN: '2998670'
[02:36:07] ℹ️  Final extracted Sex: 'MALE'
[02:36:07] ℹ️  Final extracted Service Line: 'Home Health Aide'
[02:36:07] ℹ️  Final extracted Payer Source: ''
[02:36:07] ✅ Patient data extraction completed successfully
[02:36:07] ✅    ✅ Patient data extracted successfully
[02:36:07] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/20/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:36:07] ✅    ✅ Patient identified: Raymond Souza
[02:36:07] ✅    ✅ Patient name validation passed
[02:36:07] 🔄 
🔄 Step 3: Processing patient dates...
[02:36:07] [DOC: 9252697] ℹ️  DOB normalized: 06/18/1927
[02:36:07] [DOC: 9252697] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[02:36:07] [DOC: 9252697] ℹ️  Episode endOfEpisode normalized: 07/12/2025
[02:36:07] [DOC: 9252697] ✅ Patient date processing completed successfully
[02:36:07] ✅    ✅ Date processing completed
[02:36:07] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '07/12/2025'}]
[02:36:07] 🔄 
🔄 Step 4: Extracting order data...
[02:36:09] ℹ️  Order extraction - MRN: '2998670'
[02:36:09] ℹ️  Order extraction - Sex: 'MALE'
[02:36:09] ℹ️  Order extraction - Service Line: 'Home Health Aide'
[02:36:09] ℹ️  Order extraction - Payer Source: ''
[02:36:09] ✅ Order data extraction completed successfully
[02:36:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:36:09] ℹ️  Using MRN from patient data: '2998670' over '2998670'
[02:36:09] ℹ️  Service line consistent in both sources: 'Home Health Aide'
[02:36:09] ✅ Patient name cross-validation successful
[02:36:09] ✅    ✅ Data merged successfully
[02:36:10] ✅    ✅ Order data extracted and validated
[02:36:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:36:10] [DOC: 9252697] ✅ Patient found in local cache: Raymond Souza, ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[02:36:10] ✅    ✅ Existing patient found with ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[02:36:10] 🔄 
🔄 Step 6: Pushing order to API...
[02:36:10] [DOC: 9252697] ℹ️  Pushing order via API for patient ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[02:36:13] [DOC: 9252697] ❌ Order push failed with status 201: {"id":"09fa5c38-eed3-4f51-92d5-707ca399282c","orderWAVId":"ORD20008","orderNo":"1083653","orderDate":"04/18/2025","startOfCare":"04/20/2025","episodeStartDate":"04/20/2025","episodeEndDate":"07/12/2025","documentID":"9252697","mrn":"2998670","patientName":"Souza,Raymond","sentToPhysicianDate":"04/22/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/23/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"da0edc07-3b5b-4691-8a9b-77caf22853f9","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[02:36:13] ❌    ❌ Failed to push order
[02:36:13] 🔄 
🔄 Step 7: Writing to CSV...
[02:36:13] [DOC: 9252697] ℹ️  Calculated age: 97 from DOB: 06/18/1927
[02:36:13] [DOC: 9252697] ℹ️  Service Line extracted: 'Home Health Aide'
[02:36:13] [DOC: 9252697] ℹ️  Payer Source extracted: ''
[02:36:13] [DOC: 9252697] ℹ️  Diagnosis codes being written:
[02:36:13] [DOC: 9252697] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:36:13] [DOC: 9252697] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:36:13] [DOC: 9252697] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:36:13] [DOC: 9252697] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:36:13] [DOC: 9252697] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:36:13] [DOC: 9252697] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:36:13] [DOC: 9252697] ✅ Patient data written to CSV: Raymond Souza | Sex: MALE | Age: 97 | Service: Home Health Aide | Payer:  | MRN: 2998670
[02:36:13] ✅    ✅ Document 9252697 processed and saved successfully
[02:36:13] 🔄 
🔄 Step 8: Saving API details...
[02:36:13] [DOC: 9252697] ℹ️  API push details saved for document 9252697
[02:36:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252693                         ║
================================================================================
[02:36:13] ℹ️  Agency: Dartmouth HH
[02:36:13] ℹ️  Date: 04/22/2025
[02:36:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:36:16] [DOC: 9252693] ✅ Text extracted using pdfplumber (1469 chars)
[02:36:16] ✅    ✅ Text extracted using pdfplumber (1469 chars)
[02:36:16] 🔄 
🔄 Step 2: Extracting patient data...
[02:36:18] ℹ️  AI extracted raw sex value: 'F'
[02:36:18] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:36:18] ℹ️  AI extracted payer source: 'Medicare'
[02:36:18] ℹ️  AI extracted diagnoses:
[02:36:18] ℹ️    - Diagnosis 1: 'None'
[02:36:18] ℹ️    - Diagnosis 2: 'None'
[02:36:18] ℹ️    - Diagnosis 3: 'None'
[02:36:18] ℹ️    - Diagnosis 4: 'None'
[02:36:18] ℹ️    - Diagnosis 5: 'None'
[02:36:18] ℹ️    - Diagnosis 6: 'None'
[02:36:18] ℹ️  Final extracted MRN: '6117015'
[02:36:18] ℹ️  Final extracted Sex: 'FEMALE'
[02:36:18] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:36:18] ℹ️  Final extracted Payer Source: 'Medicare'
[02:36:18] ✅ Patient data extraction completed successfully
[02:36:18] ✅    ✅ Patient data extracted successfully
[02:36:18] 📊 Patient Response
     └─ patientFName: Janet
     └─ patientLName: Cabral
     └─ dob: 07/26/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6117015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1959 Purchase St Apt E 209
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:36:18] ✅    ✅ Patient identified: Janet Cabral
[02:36:18] ✅    ✅ Patient name validation passed
[02:36:18] 🔄 
🔄 Step 3: Processing patient dates...
[02:36:18] [DOC: 9252693] ℹ️  DOB normalized: 07/26/1952
[02:36:18] [DOC: 9252693] ℹ️  Episode startOfCare normalized: 02/28/2025
[02:36:18] [DOC: 9252693] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[02:36:18] [DOC: 9252693] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[02:36:18] [DOC: 9252693] ✅ Patient date processing completed successfully
[02:36:18] ✅    ✅ Date processing completed
[02:36:18] 📊 Processed Patient Data
     └─ patientFName: Janet
     └─ patientLName: Cabral
     └─ dob: 07/26/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6117015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1959 Purchase St Apt E 209
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025'}]
[02:36:18] 🔄 
🔄 Step 4: Extracting order data...
[02:36:21] ℹ️  Order extraction - MRN: ''
[02:36:21] ℹ️  Order extraction - Sex: 'FEMALE'
[02:36:21] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:36:21] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:36:21] ✅ Order data extraction completed successfully
[02:36:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:36:21] ℹ️  Using MRN from patient data: '6117015'
[02:36:21] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:36:21] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:36:21] ✅ Patient name cross-validation successful
[02:36:21] ✅    ✅ Data merged successfully
[02:36:22] ✅    ✅ Order data extracted and validated
[02:36:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:36:39] [DOC: 9252693] ✅ Patient exists in API: Janet Cabral, ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[02:36:39] ✅    ✅ Existing patient found with ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[02:36:39] 🔄 
🔄 Step 6: Pushing order to API...
[02:36:39] [DOC: 9252693] ℹ️  Pushing order via API for patient ID: b0493dce-63d1-4a5a-b04f-27aedc91a5cc
[02:36:40] [DOC: 9252693] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:36:40] ❌    ❌ Failed to push order
[02:36:40] 🔄 
🔄 Step 7: Writing to CSV...
[02:36:40] [DOC: 9252693] ℹ️  Calculated age: 72 from DOB: 07/26/1952
[02:36:40] [DOC: 9252693] ℹ️  Service Line extracted: 'Skilled Nursing'
[02:36:40] [DOC: 9252693] ℹ️  Payer Source extracted: 'Medicare'
[02:36:40] [DOC: 9252693] ℹ️  Diagnosis codes being written:
[02:36:40] [DOC: 9252693] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:36:40] [DOC: 9252693] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:36:40] [DOC: 9252693] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:36:40] [DOC: 9252693] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:36:40] [DOC: 9252693] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:36:40] [DOC: 9252693] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:36:40] [DOC: 9252693] ✅ Patient data written to CSV: Janet Cabral | Sex: FEMALE | Age: 72 | Service: Skilled Nursing | Payer: Medicare | MRN: 6117015
[02:36:40] ✅    ✅ Document 9252693 processed and saved successfully
[02:36:40] 🔄 
🔄 Step 8: Saving API details...
[02:36:40] [DOC: 9252693] ℹ️  API push details saved for document 9252693
[02:36:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252691                         ║
================================================================================
[02:36:40] ℹ️  Agency: Dartmouth HH
[02:36:40] ℹ️  Date: 04/22/2025
[02:36:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:36:42] [DOC: 9252691] ✅ Text extracted using pdfplumber (1298 chars)
[02:36:42] ✅    ✅ Text extracted using pdfplumber (1298 chars)
[02:36:42] 🔄 
🔄 Step 2: Extracting patient data...
[02:36:45] ℹ️  AI extracted raw sex value: 'M'
[02:36:45] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:36:45] ℹ️  AI extracted payer source: 'Medicare'
[02:36:45] ℹ️  AI extracted diagnoses:
[02:36:45] ℹ️    - Diagnosis 1: ''
[02:36:45] ℹ️    - Diagnosis 2: ''
[02:36:45] ℹ️    - Diagnosis 3: ''
[02:36:45] ℹ️    - Diagnosis 4: ''
[02:36:45] ℹ️    - Diagnosis 5: ''
[02:36:45] ℹ️    - Diagnosis 6: ''
[02:36:45] ℹ️  Final extracted MRN: '6140015'
[02:36:45] ℹ️  Final extracted Sex: 'MALE'
[02:36:45] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:36:45] ℹ️  Final extracted Payer Source: 'Medicare'
[02:36:45] ✅ Patient data extraction completed successfully
[02:36:45] ✅    ✅ Patient data extracted successfully
[02:36:45] 📊 Patient Response
     └─ patientFName: Ernest
     └─ patientLName: Barboza
     └─ dob: 02/22/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 6140015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:36:45] ✅    ✅ Patient identified: Ernest Barboza
[02:36:45] ✅    ✅ Patient name validation passed
[02:36:45] 🔄 
🔄 Step 3: Processing patient dates...
[02:36:45] [DOC: 9252691] ℹ️  DOB normalized: 02/22/1937
[02:36:45] [DOC: 9252691] ℹ️  Episode startOfCare normalized: 03/06/2025
[02:36:45] [DOC: 9252691] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[02:36:45] [DOC: 9252691] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[02:36:45] [DOC: 9252691] ✅ Patient date processing completed successfully
[02:36:45] ✅    ✅ Date processing completed
[02:36:45] 📊 Processed Patient Data
     └─ patientFName: Ernest
     └─ patientLName: Barboza
     └─ dob: 02/22/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 6140015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:36:45] 🔄 
🔄 Step 4: Extracting order data...
[02:36:48] ℹ️  Order extraction - MRN: ''
[02:36:48] ℹ️  Order extraction - Sex: 'MALE'
[02:36:48] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:36:48] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:36:48] ✅ Order data extraction completed successfully
[02:36:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:36:48] ℹ️  Using MRN from patient data: '6140015'
[02:36:48] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:36:48] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:36:48] ✅ Patient name cross-validation successful
[02:36:48] ✅    ✅ Data merged successfully
[02:36:49] ✅    ✅ Order data extracted and validated
[02:36:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:36:55] [DOC: 9252691] ✅ Patient exists in API: Ernest Barboza, ID: adb22793-6127-48ac-9c27-184ca9af82cc
[02:36:55] ✅    ✅ Existing patient found with ID: adb22793-6127-48ac-9c27-184ca9af82cc
[02:36:55] 🔄 
🔄 Step 6: Pushing order to API...
[02:36:55] [DOC: 9252691] ℹ️  Pushing order via API for patient ID: adb22793-6127-48ac-9c27-184ca9af82cc
[02:36:59] [DOC: 9252691] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:36:59] ❌    ❌ Failed to push order
[02:36:59] 🔄 
🔄 Step 7: Writing to CSV...
[02:36:59] [DOC: 9252691] ℹ️  Calculated age: 88 from DOB: 02/22/1937
[02:36:59] [DOC: 9252691] ℹ️  Service Line extracted: 'Skilled Nursing'
[02:36:59] [DOC: 9252691] ℹ️  Payer Source extracted: 'Medicare'
[02:36:59] [DOC: 9252691] ℹ️  Diagnosis codes being written:
[02:36:59] [DOC: 9252691] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:36:59] [DOC: 9252691] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:36:59] [DOC: 9252691] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:36:59] [DOC: 9252691] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:36:59] [DOC: 9252691] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:36:59] [DOC: 9252691] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:36:59] [DOC: 9252691] ✅ Patient data written to CSV: Ernest Barboza | Sex: MALE | Age: 88 | Service: Skilled Nursing | Payer: Medicare | MRN: 6140015
[02:36:59] ✅    ✅ Document 9252691 processed and saved successfully
[02:36:59] 🔄 
🔄 Step 8: Saving API details...
[02:36:59] [DOC: 9252691] ℹ️  API push details saved for document 9252691
[02:36:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252682                         ║
================================================================================
[02:36:59] ℹ️  Agency: Dartmouth HH
[02:36:59] ℹ️  Date: 04/22/2025
[02:36:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:37:02] [DOC: 9252682] ✅ Text extracted using pdfplumber (18200 chars)
[02:37:02] ✅    ✅ Text extracted using pdfplumber (18200 chars)
[02:37:02] 🔄 
🔄 Step 2: Extracting patient data...
[02:37:05] ℹ️  AI extracted raw sex value: 'F'
[02:37:05] ℹ️  AI extracted service line: 'PT, OT'
[02:37:05] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[02:37:05] ℹ️  AI extracted diagnoses:
[02:37:05] ℹ️    - Diagnosis 1: ''
[02:37:05] ℹ️    - Diagnosis 2: ''
[02:37:05] ℹ️    - Diagnosis 3: ''
[02:37:05] ℹ️    - Diagnosis 4: ''
[02:37:05] ℹ️    - Diagnosis 5: ''
[02:37:05] ℹ️    - Diagnosis 6: ''
[02:37:05] ℹ️  Final extracted MRN: '6341015'
[02:37:05] ℹ️  Final extracted Sex: 'FEMALE'
[02:37:05] ℹ️  Final extracted Service Line: 'PT, OT'
[02:37:05] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[02:37:05] ✅ Patient data extraction completed successfully
[02:37:05] ✅    ✅ Patient data extracted successfully
[02:37:05] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Seaman
     └─ dob: 06/21/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6341015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:37:05] ✅    ✅ Patient identified: Mary Seaman
[02:37:05] ✅    ✅ Patient name validation passed
[02:37:05] 🔄 
🔄 Step 3: Processing patient dates...
[02:37:05] [DOC: 9252682] ℹ️  DOB normalized: 06/21/1944
[02:37:05] [DOC: 9252682] ℹ️  Episode startOfCare normalized: 04/07/2025
[02:37:05] [DOC: 9252682] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[02:37:05] [DOC: 9252682] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[02:37:05] [DOC: 9252682] ✅ Patient date processing completed successfully
[02:37:05] ✅    ✅ Date processing completed
[02:37:05] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Seaman
     └─ dob: 06/21/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6341015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:37:05] 🔄 
🔄 Step 4: Extracting order data...
[02:37:08] ℹ️  Order extraction - MRN: ''
[02:37:08] ℹ️  Order extraction - Sex: 'FEMALE'
[02:37:08] ℹ️  Order extraction - Service Line: 'PT, OT'
[02:37:08] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[02:37:08] ✅ Order data extraction completed successfully
[02:37:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:37:08] ℹ️  Using MRN from patient data: '6341015'
[02:37:08] ℹ️  Service line consistent in both sources: 'PT, OT'
[02:37:08] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[02:37:08] ✅ Patient name cross-validation successful
[02:37:08] ✅    ✅ Data merged successfully
[02:37:09] ✅    ✅ Order data extracted and validated
[02:37:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:37:25] [DOC: 9252682] ℹ️  Patient not found in cache or API: Mary Seaman
[02:37:25] [DOC: 9252682] ℹ️  Patient not found, creating new patient via API...
[02:37:25] [DOC: 9252682] ℹ️  Creating patient via API: Mary Seaman
[02:37:27] [DOC: 9252682] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:37:27] ❌    ❌ Failed to create patient
[02:37:27] [DOC: 9252682] ℹ️  API push details saved for document 9252682
================================================================================
║                        Processing Document ID: 9252679                         ║
================================================================================
[02:37:27] ℹ️  Agency: Dartmouth HH
[02:37:27] ℹ️  Date: 04/22/2025
[02:37:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:37:29] [DOC: 9252679] ✅ Text extracted using pdfplumber (11074 chars)
[02:37:29] ✅    ✅ Text extracted using pdfplumber (11074 chars)
[02:37:29] 🔄 
🔄 Step 2: Extracting patient data...
[02:37:33] ℹ️  AI extracted raw sex value: 'F'
[02:37:33] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT, Diet'
[02:37:33] ℹ️  AI extracted payer source: 'None'
[02:37:33] ℹ️  AI extracted diagnoses:
[02:37:33] ℹ️    - Diagnosis 1: 'G20.A1'
[02:37:33] ℹ️    - Diagnosis 2: 'E11.40'
[02:37:33] ℹ️    - Diagnosis 3: 'E11.65'
[02:37:33] ℹ️    - Diagnosis 4: 'L84'
[02:37:33] ℹ️    - Diagnosis 5: 'E78.5'
[02:37:33] ℹ️    - Diagnosis 6: 'M81.0'
[02:37:33] ℹ️  Final extracted MRN: '227027'
[02:37:33] ℹ️  Final extracted Sex: 'FEMALE'
[02:37:33] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT, Diet'
[02:37:33] ℹ️  Final extracted Payer Source: ''
[02:37:33] ✅ Patient data extraction completed successfully
[02:37:33] ✅    ✅ Patient data extracted successfully
[02:37:33] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Seaman
     └─ dob: 06/21/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, Diet
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'E11.40', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': 'L84', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'M81.0'}]
[02:37:33] ✅    ✅ Patient identified: Mary Seaman
[02:37:33] ✅    ✅ Patient name validation passed
[02:37:33] 🔄 
🔄 Step 3: Processing patient dates...
[02:37:33] [DOC: 9252679] ℹ️  DOB normalized: 06/21/1944
[02:37:33] [DOC: 9252679] ℹ️  Episode startOfCare normalized: 04/03/2025
[02:37:33] [DOC: 9252679] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[02:37:33] [DOC: 9252679] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[02:37:33] [DOC: 9252679] ✅ Patient date processing completed successfully
[02:37:33] ✅    ✅ Date processing completed
[02:37:33] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Seaman
     └─ dob: 06/21/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, Diet
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'E11.40', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': 'L84', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'M81.0'}]
[02:37:33] 🔄 
🔄 Step 4: Extracting order data...
[02:37:35] ℹ️  Order extraction - MRN: '227027'
[02:37:35] ℹ️  Order extraction - Sex: 'FEMALE'
[02:37:35] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT, Diet'
[02:37:35] ℹ️  Order extraction - Payer Source: ''
[02:37:35] ✅ Order data extraction completed successfully
[02:37:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:37:35] ℹ️  Using MRN from patient data: '227027' over '227027'
[02:37:35] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT, Diet'
[02:37:35] ✅ Patient name cross-validation successful
[02:37:35] ✅    ✅ Data merged successfully
[02:37:36] ✅    ✅ Order data extracted and validated
[02:37:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:38:16] [DOC: 9252679] ℹ️  Patient not found in cache or API: Mary Seaman
[02:38:16] [DOC: 9252679] ℹ️  Patient not found, creating new patient via API...
[02:38:16] [DOC: 9252679] ℹ️  Creating patient via API: Mary Seaman
[02:38:17] [DOC: 9252679] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:38:17] ❌    ❌ Failed to create patient
[02:38:17] [DOC: 9252679] ℹ️  API push details saved for document 9252679
================================================================================
║                        Processing Document ID: 9252678                         ║
================================================================================
[02:38:17] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[02:38:17] ℹ️  Date: 04/22/2025
[02:38:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:38:19] [DOC: 9252678] ✅ Text extracted using pdfplumber (995 chars)
[02:38:19] ✅    ✅ Text extracted using pdfplumber (995 chars)
[02:38:19] 🔄 
🔄 Step 2: Extracting patient data...
[02:38:22] ℹ️  AI extracted raw sex value: 'F'
[02:38:22] ℹ️  AI extracted service line: 'Medical Social Work'
[02:38:22] ℹ️  AI extracted payer source: ''
[02:38:22] ℹ️  AI extracted diagnoses:
[02:38:22] ℹ️    - Diagnosis 1: 'None'
[02:38:22] ℹ️    - Diagnosis 2: 'None'
[02:38:22] ℹ️    - Diagnosis 3: 'None'
[02:38:22] ℹ️    - Diagnosis 4: 'None'
[02:38:22] ℹ️    - Diagnosis 5: 'None'
[02:38:22] ℹ️    - Diagnosis 6: 'None'
[02:38:22] ℹ️  Final extracted MRN: '2736573'
[02:38:22] ℹ️  Final extracted Sex: 'FEMALE'
[02:38:22] ℹ️  Final extracted Service Line: 'Medical Social Work'
[02:38:22] ℹ️  Final extracted Payer Source: ''
[02:38:22] ✅ Patient data extraction completed successfully
[02:38:22] ✅    ✅ Patient data extracted successfully
[02:38:22] 📊 Patient Response
     └─ patientFName: Jean
     └─ patientLName: Meier
     └─ dob: 07/28/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2736573
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/17/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:38:22] ✅    ✅ Patient identified: Jean Meier
[02:38:22] ✅    ✅ Patient name validation passed
[02:38:22] 🔄 
🔄 Step 3: Processing patient dates...
[02:38:22] [DOC: 9252678] ℹ️  DOB normalized: 07/28/1933
[02:38:22] [DOC: 9252678] ℹ️  Episode startOfEpisode normalized: 04/17/2025
[02:38:22] [DOC: 9252678] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[02:38:22] [DOC: 9252678] ✅ Patient date processing completed successfully
[02:38:22] ✅    ✅ Date processing completed
[02:38:22] 📊 Processed Patient Data
     └─ patientFName: Jean
     └─ patientLName: Meier
     └─ dob: 07/28/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2736573
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/17/2025', 'endOfEpisode': '06/01/2025'}]
[02:38:22] 🔄 
🔄 Step 4: Extracting order data...
[02:38:24] ℹ️  Order extraction - MRN: '2736573'
[02:38:24] ℹ️  Order extraction - Sex: 'FEMALE'
[02:38:24] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[02:38:24] ℹ️  Order extraction - Payer Source: ''
[02:38:24] ✅ Order data extraction completed successfully
[02:38:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:38:24] ℹ️  Using MRN from patient data: '2736573' over '2736573'
[02:38:24] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[02:38:24] ✅ Patient name cross-validation successful
[02:38:24] ✅    ✅ Data merged successfully
[02:38:25] ✅    ✅ Order data extracted and validated
[02:38:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:38:34] [DOC: 9252678] ✅ Patient exists in API: Jean Meier, ID: 0c6c4395-e864-4a7c-9acd-ea611efe610a
[02:38:34] ✅    ✅ Existing patient found with ID: 0c6c4395-e864-4a7c-9acd-ea611efe610a
[02:38:34] 🔄 
🔄 Step 6: Pushing order to API...
[02:38:34] [DOC: 9252678] ℹ️  Pushing order via API for patient ID: 0c6c4395-e864-4a7c-9acd-ea611efe610a
[02:38:35] [DOC: 9252678] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13345"}
[02:38:35] ❌    ❌ Failed to push order
[02:38:35] 🔄 
🔄 Step 7: Writing to CSV...
[02:38:35] [DOC: 9252678] ℹ️  Calculated age: 91 from DOB: 07/28/1933
[02:38:35] [DOC: 9252678] ℹ️  Service Line extracted: 'Medical Social Work'
[02:38:35] [DOC: 9252678] ℹ️  Payer Source extracted: ''
[02:38:35] [DOC: 9252678] ℹ️  Diagnosis codes being written:
[02:38:35] [DOC: 9252678] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:38:35] [DOC: 9252678] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:38:35] [DOC: 9252678] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:38:35] [DOC: 9252678] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:38:35] [DOC: 9252678] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:38:35] [DOC: 9252678] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:38:35] [DOC: 9252678] ✅ Patient data written to CSV: Jean Meier | Sex: FEMALE | Age: 91 | Service: Medical Social Work | Payer:  | MRN: 2736573
[02:38:35] ✅    ✅ Document 9252678 processed and saved successfully
[02:38:35] 🔄 
🔄 Step 8: Saving API details...
[02:38:35] [DOC: 9252678] ℹ️  API push details saved for document 9252678
[02:38:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252676                         ║
================================================================================
[02:38:35] ℹ️  Agency: Dartmouth HH
[02:38:35] ℹ️  Date: 04/22/2025
[02:38:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:38:39] [DOC: 9252676] ✅ Text extracted using pdfplumber (13858 chars)
[02:38:39] ✅    ✅ Text extracted using pdfplumber (13858 chars)
[02:38:39] 🔄 
🔄 Step 2: Extracting patient data...
[02:38:43] ℹ️  AI extracted raw sex value: 'F'
[02:38:43] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:38:43] ℹ️  AI extracted payer source: 'None'
[02:38:43] ℹ️  AI extracted diagnoses:
[02:38:43] ℹ️    - Diagnosis 1: 'C79.31'
[02:38:43] ℹ️    - Diagnosis 2: 'C49.21'
[02:38:43] ℹ️    - Diagnosis 3: 'C77.2'
[02:38:43] ℹ️    - Diagnosis 4: 'G89.3'
[02:38:43] ℹ️    - Diagnosis 5: 'T45.1X5D'
[02:38:43] ℹ️    - Diagnosis 6: 'K12.31'
[02:38:43] ℹ️  Final extracted MRN: '5391015'
[02:38:43] ℹ️  Final extracted Sex: 'FEMALE'
[02:38:43] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:38:43] ℹ️  Final extracted Payer Source: ''
[02:38:43] ✅ Patient data extraction completed successfully
[02:38:43] ✅    ✅ Patient data extracted successfully
[02:38:43] 📊 Patient Response
     └─ patientFName: Maribel
     └─ patientLName: Pena
     └─ dob: 09/16/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5391015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 100042457166
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/17/2024', 'startOfEpisode': '10/17/2024', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'C79.31', 'secondDiagnosis': 'C49.21', 'thirdDiagnosis': 'C77.2', 'fourthDiagnosis': 'G89.3', 'fifthDiagnosis': 'T45.1X5D', 'sixthDiagnosis': 'K12.31'}]
[02:38:43] ✅    ✅ Patient identified: Maribel Pena
[02:38:43] ✅    ✅ Patient name validation passed
[02:38:43] 🔄 
🔄 Step 3: Processing patient dates...
[02:38:43] [DOC: 9252676] ℹ️  DOB normalized: 09/16/1994
[02:38:43] [DOC: 9252676] ℹ️  Episode startOfCare normalized: 10/17/2024
[02:38:43] [DOC: 9252676] ℹ️  Episode startOfEpisode normalized: 10/17/2024
[02:38:43] [DOC: 9252676] ℹ️  Episode endOfEpisode normalized: 06/13/2025
[02:38:43] [DOC: 9252676] ✅ Patient date processing completed successfully
[02:38:43] ✅    ✅ Date processing completed
[02:38:43] 📊 Processed Patient Data
     └─ patientFName: Maribel
     └─ patientLName: Pena
     └─ dob: 09/16/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5391015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 100042457166
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/17/2024', 'startOfEpisode': '10/17/2024', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'C79.31', 'secondDiagnosis': 'C49.21', 'thirdDiagnosis': 'C77.2', 'fourthDiagnosis': 'G89.3', 'fifthDiagnosis': 'T45.1X5D', 'sixthDiagnosis': 'K12.31'}]
[02:38:43] 🔄 
🔄 Step 4: Extracting order data...
[02:38:45] ℹ️  Order extraction - MRN: '5391015'
[02:38:45] ℹ️  Order extraction - Sex: 'FEMALE'
[02:38:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:38:45] ℹ️  Order extraction - Payer Source: ''
[02:38:45] ✅ Order data extraction completed successfully
[02:38:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:38:45] ℹ️  Using MRN from patient data: '5391015' over '5391015'
[02:38:45] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:38:45] ✅ Patient name cross-validation successful
[02:38:45] ✅    ✅ Data merged successfully
[02:38:46] ✅    ✅ Order data extracted and validated
[02:38:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:38:46] [DOC: 9252676] ✅ Patient found in local cache: Maribel Pena, ID: 21aca991-bba7-4f19-828f-34b178408fd4
[02:38:46] ✅    ✅ Existing patient found with ID: 21aca991-bba7-4f19-828f-34b178408fd4
[02:38:46] 🔄 
🔄 Step 6: Pushing order to API...
[02:38:46] [DOC: 9252676] ℹ️  Pushing order via API for patient ID: 21aca991-bba7-4f19-828f-34b178408fd4
[02:38:48] [DOC: 9252676] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:38:48] ❌    ❌ Failed to push order
[02:38:48] 🔄 
🔄 Step 7: Writing to CSV...
[02:38:48] [DOC: 9252676] ℹ️  Calculated age: 30 from DOB: 09/16/1994
[02:38:48] [DOC: 9252676] ℹ️  Service Line extracted: 'Skilled Nursing'
[02:38:48] [DOC: 9252676] ℹ️  Payer Source extracted: ''
[02:38:48] [DOC: 9252676] ℹ️  Diagnosis codes being written:
[02:38:48] [DOC: 9252676] ℹ️    - Latest_Episode_Firstdiagnosis: 'C79.31'
[02:38:48] [DOC: 9252676] ℹ️    - Latest_Episode_Seconddiagnosis: 'C49.21'
[02:38:48] [DOC: 9252676] ℹ️    - Latest_Episode_Thirddiagnosis: 'C77.2'
[02:38:48] [DOC: 9252676] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G89.3'
[02:38:48] [DOC: 9252676] ℹ️    - Latest_Episode_Fifthdiagnosis: 'T45.1X5D'
[02:38:48] [DOC: 9252676] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K12.31'
[02:38:48] [DOC: 9252676] ✅ Patient data written to CSV: Maribel Pena | Sex: FEMALE | Age: 30 | Service: Skilled Nursing | Payer:  | MRN: 5391015
[02:38:48] ✅    ✅ Document 9252676 processed and saved successfully
[02:38:48] 🔄 
🔄 Step 8: Saving API details...
[02:38:48] [DOC: 9252676] ℹ️  API push details saved for document 9252676
[02:38:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252675                         ║
================================================================================
[02:38:48] ℹ️  Agency: Dartmouth HH
[02:38:48] ℹ️  Date: 04/22/2025
[02:38:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:38:53] [DOC: 9252675] ✅ Text extracted using pdfplumber (4693 chars)
[02:38:53] ✅    ✅ Text extracted using pdfplumber (4693 chars)
[02:38:53] 🔄 
🔄 Step 2: Extracting patient data...
[02:38:56] ℹ️  AI extracted raw sex value: 'F'
[02:38:56] ℹ️  AI extracted service line: 'OT, ST'
[02:38:56] ℹ️  AI extracted payer source: 'Fallon Navicare'
[02:38:56] ℹ️  AI extracted diagnoses:
[02:38:56] ℹ️    - Diagnosis 1: 'G97.1'
[02:38:56] ℹ️    - Diagnosis 2: 'M54.5'
[02:38:56] ℹ️    - Diagnosis 3: 'M51.9'
[02:38:56] ℹ️    - Diagnosis 4: 'M19.90'
[02:38:56] ℹ️    - Diagnosis 5: 'None'
[02:38:56] ℹ️    - Diagnosis 6: 'None'
[02:38:56] ℹ️  Final extracted MRN: '6324015'
[02:38:56] ℹ️  Final extracted Sex: 'FEMALE'
[02:38:56] ℹ️  Final extracted Service Line: 'OT, ST'
[02:38:56] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[02:38:56] ✅ Patient data extraction completed successfully
[02:38:56] ✅    ✅ Patient data extracted successfully
[02:38:56] 📊 Patient Response
     └─ patientFName: Pascualina
     └─ patientLName: Costa
     └─ dob: 12/10/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6324015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, ST
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'G97.1', 'secondDiagnosis': 'M54.5', 'thirdDiagnosis': 'M51.9', 'fourthDiagnosis': 'M19.90', 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:38:56] ✅    ✅ Patient identified: Pascualina Costa
[02:38:56] ✅    ✅ Patient name validation passed
[02:38:56] 🔄 
🔄 Step 3: Processing patient dates...
[02:38:56] [DOC: 9252675] ℹ️  DOB normalized: 12/10/1935
[02:38:56] [DOC: 9252675] ℹ️  Episode startOfCare normalized: 04/04/2025
[02:38:56] [DOC: 9252675] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[02:38:56] [DOC: 9252675] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[02:38:56] [DOC: 9252675] ✅ Patient date processing completed successfully
[02:38:56] ✅    ✅ Date processing completed
[02:38:56] 📊 Processed Patient Data
     └─ patientFName: Pascualina
     └─ patientLName: Costa
     └─ dob: 12/10/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6324015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, ST
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'G97.1', 'secondDiagnosis': 'M54.5', 'thirdDiagnosis': 'M51.9', 'fourthDiagnosis': 'M19.90'}]
[02:38:56] 🔄 
🔄 Step 4: Extracting order data...
[02:38:58] ℹ️  Order extraction - MRN: '6324015'
[02:38:58] ℹ️  Order extraction - Sex: 'FEMALE'
[02:38:58] ℹ️  Order extraction - Service Line: 'OT, ST'
[02:38:58] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[02:38:58] ✅ Order data extraction completed successfully
[02:38:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:38:58] ℹ️  Using MRN from patient data: '6324015' over '6324015'
[02:38:58] ℹ️  Service line consistent in both sources: 'OT, ST'
[02:38:58] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[02:38:58] ✅ Patient name cross-validation successful
[02:38:58] ✅    ✅ Data merged successfully
[02:39:00] ✅    ✅ Order data extracted and validated
[02:39:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:39:23] [DOC: 9252675] ✅ Patient exists in API: Pascualina Costa, ID: cb0d604b-ae64-4265-b4ee-470e611dd434
[02:39:23] ✅    ✅ Existing patient found with ID: cb0d604b-ae64-4265-b4ee-470e611dd434
[02:39:23] 🔄 
🔄 Step 6: Pushing order to API...
[02:39:23] [DOC: 9252675] ℹ️  Pushing order via API for patient ID: cb0d604b-ae64-4265-b4ee-470e611dd434
[02:39:25] [DOC: 9252675] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:39:25] ❌    ❌ Failed to push order
[02:39:25] 🔄 
🔄 Step 7: Writing to CSV...
[02:39:25] [DOC: 9252675] ℹ️  Calculated age: 89 from DOB: 12/10/1935
[02:39:25] [DOC: 9252675] ℹ️  Service Line extracted: 'OT, ST'
[02:39:25] [DOC: 9252675] ℹ️  Payer Source extracted: 'Fallon Navicare'
[02:39:25] [DOC: 9252675] ℹ️  Diagnosis codes being written:
[02:39:25] [DOC: 9252675] ℹ️    - Latest_Episode_Firstdiagnosis: 'G97.1'
[02:39:25] [DOC: 9252675] ℹ️    - Latest_Episode_Seconddiagnosis: 'M54.5'
[02:39:25] [DOC: 9252675] ℹ️    - Latest_Episode_Thirddiagnosis: 'M51.9'
[02:39:25] [DOC: 9252675] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M19.90'
[02:39:25] [DOC: 9252675] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:39:25] [DOC: 9252675] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:39:25] [DOC: 9252675] ✅ Patient data written to CSV: Pascualina Costa | Sex: FEMALE | Age: 89 | Service: OT, ST | Payer: Fallon Navicare | MRN: 6324015
[02:39:25] ✅    ✅ Document 9252675 processed and saved successfully
[02:39:25] 🔄 
🔄 Step 8: Saving API details...
[02:39:25] [DOC: 9252675] ℹ️  API push details saved for document 9252675
[02:39:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252672                         ║
================================================================================
[02:39:25] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[02:39:25] ℹ️  Date: 04/22/2025
[02:39:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:39:26] [DOC: 9252672] ✅ Text extracted using pdfplumber (1364 chars)
[02:39:26] ✅    ✅ Text extracted using pdfplumber (1364 chars)
[02:39:26] 🔄 
🔄 Step 2: Extracting patient data...
[02:39:29] ℹ️  AI extracted raw sex value: 'M'
[02:39:29] ℹ️  AI extracted service line: 'Skilled Nursing, Medical Social Work'
[02:39:29] ℹ️  AI extracted payer source: ''
[02:39:29] ℹ️  AI extracted diagnoses:
[02:39:29] ℹ️    - Diagnosis 1: 'None'
[02:39:29] ℹ️    - Diagnosis 2: 'None'
[02:39:29] ℹ️    - Diagnosis 3: 'None'
[02:39:29] ℹ️    - Diagnosis 4: 'None'
[02:39:29] ℹ️    - Diagnosis 5: 'None'
[02:39:29] ℹ️    - Diagnosis 6: 'None'
[02:39:29] ℹ️  Final extracted MRN: '2679776'
[02:39:29] ℹ️  Final extracted Sex: 'MALE'
[02:39:29] ℹ️  Final extracted Service Line: 'Skilled Nursing, Medical Social Work'
[02:39:29] ℹ️  Final extracted Payer Source: ''
[02:39:29] ✅ Patient data extraction completed successfully
[02:39:29] ✅    ✅ Patient data extracted successfully
[02:39:29] 📊 Patient Response
     └─ patientFName: Milton
     └─ patientLName: MacDonald
     └─ dob: 03/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 2679776
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:39:29] ✅    ✅ Patient identified: Milton MacDonald
[02:39:29] ✅    ✅ Patient name validation passed
[02:39:29] 🔄 
🔄 Step 3: Processing patient dates...
[02:39:29] [DOC: 9252672] ℹ️  DOB normalized: 03/20/1939
[02:39:29] [DOC: 9252672] ℹ️  Episode startOfEpisode normalized: 04/19/2025
[02:39:29] [DOC: 9252672] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[02:39:29] [DOC: 9252672] ✅ Patient date processing completed successfully
[02:39:29] ✅    ✅ Date processing completed
[02:39:29] 📊 Processed Patient Data
     └─ patientFName: Milton
     └─ patientLName: MacDonald
     └─ dob: 03/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 2679776
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/19/2025', 'endOfEpisode': '04/19/2025'}]
[02:39:29] 🔄 
🔄 Step 4: Extracting order data...
[02:39:31] ℹ️  Order extraction - MRN: '2679776'
[02:39:31] ℹ️  Order extraction - Sex: 'MALE'
[02:39:31] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Medical Social Work'
[02:39:31] ℹ️  Order extraction - Payer Source: ''
[02:39:31] ✅ Order data extraction completed successfully
[02:39:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:39:31] ℹ️  Using MRN from patient data: '2679776' over '2679776'
[02:39:31] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Medical Social Work'
[02:39:31] ✅ Patient name cross-validation successful
[02:39:31] ✅    ✅ Data merged successfully
[02:39:32] ✅    ✅ Order data extracted and validated
[02:39:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:39:32] [DOC: 9252672] ✅ Patient found in local cache: Milton MacDonald, ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[02:39:32] ✅    ✅ Existing patient found with ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[02:39:32] 🔄 
🔄 Step 6: Pushing order to API...
[02:39:32] [DOC: 9252672] ℹ️  Pushing order via API for patient ID: 7aac5721-c2a3-4529-a771-b4ad8c6af027
[02:39:34] [DOC: 9252672] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13301"}
[02:39:34] ❌    ❌ Failed to push order
[02:39:34] 🔄 
🔄 Step 7: Writing to CSV...
[02:39:34] [DOC: 9252672] ℹ️  Calculated age: 86 from DOB: 03/20/1939
[02:39:34] [DOC: 9252672] ℹ️  Service Line extracted: 'Skilled Nursing, Medical Social Work'
[02:39:34] [DOC: 9252672] ℹ️  Payer Source extracted: ''
[02:39:34] [DOC: 9252672] ℹ️  Diagnosis codes being written:
[02:39:34] [DOC: 9252672] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:39:34] [DOC: 9252672] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:39:34] [DOC: 9252672] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:39:34] [DOC: 9252672] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:39:34] [DOC: 9252672] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:39:34] [DOC: 9252672] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:39:34] [DOC: 9252672] ✅ Patient data written to CSV: Milton MacDonald | Sex: MALE | Age: 86 | Service: Skilled Nursing, Medical Social Work | Payer:  | MRN: 2679776
[02:39:34] ✅    ✅ Document 9252672 processed and saved successfully
[02:39:34] 🔄 
🔄 Step 8: Saving API details...
[02:39:34] [DOC: 9252672] ℹ️  API push details saved for document 9252672
[02:39:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252670                         ║
================================================================================
[02:39:34] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[02:39:34] ℹ️  Date: 04/22/2025
[02:39:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:39:38] [DOC: 9252670] ✅ Text extracted using pdfplumber (1075 chars)
[02:39:38] ✅    ✅ Text extracted using pdfplumber (1075 chars)
[02:39:38] 🔄 
🔄 Step 2: Extracting patient data...
[02:39:41] ℹ️  AI extracted raw sex value: 'M'
[02:39:41] ℹ️  AI extracted service line: 'Occupational Therapy'
[02:39:41] ℹ️  AI extracted payer source: ''
[02:39:41] ℹ️  AI extracted diagnoses:
[02:39:41] ℹ️    - Diagnosis 1: ''
[02:39:41] ℹ️    - Diagnosis 2: ''
[02:39:41] ℹ️    - Diagnosis 3: ''
[02:39:41] ℹ️    - Diagnosis 4: ''
[02:39:41] ℹ️    - Diagnosis 5: ''
[02:39:41] ℹ️    - Diagnosis 6: ''
[02:39:41] ℹ️  Final extracted MRN: '2648815'
[02:39:41] ℹ️  Final extracted Sex: 'MALE'
[02:39:41] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[02:39:41] ℹ️  Final extracted Payer Source: ''
[02:39:41] ✅ Patient data extraction completed successfully
[02:39:41] ✅    ✅ Patient data extracted successfully
[02:39:41] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Ledoux
     └─ dob: 04/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 2648815
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:39:41] ✅    ✅ Patient identified: Robert Ledoux
[02:39:41] ✅    ✅ Patient name validation passed
[02:39:41] 🔄 
🔄 Step 3: Processing patient dates...
[02:39:41] [DOC: 9252670] ℹ️  DOB normalized: 04/07/1968
[02:39:41] [DOC: 9252670] ✅ Patient date processing completed successfully
[02:39:41] ✅    ✅ Date processing completed
[02:39:41] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Ledoux
     └─ dob: 04/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 2648815
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:39:41] 🔄 
🔄 Step 4: Extracting order data...
[02:39:43] ℹ️  Order extraction - MRN: '2648815'
[02:39:43] ℹ️  Order extraction - Sex: 'MALE'
[02:39:43] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[02:39:43] ℹ️  Order extraction - Payer Source: ''
[02:39:43] ✅ Order data extraction completed successfully
[02:39:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:39:43] ℹ️  Using MRN from patient data: '2648815' over '2648815'
[02:39:43] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[02:39:43] ✅ Patient name cross-validation successful
[02:39:43] ✅    ✅ Data merged successfully
[02:39:50] ✅    ✅ Order data extracted and validated
[02:39:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:40:37] [DOC: 9252670] ℹ️  Patient not found in cache or API: Robert Ledoux
[02:40:37] [DOC: 9252670] ℹ️  Patient not found, creating new patient via API...
[02:40:37] [DOC: 9252670] ℹ️  Creating patient via API: Robert Ledoux
[02:40:38] [DOC: 9252670] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:40:38] ❌    ❌ Failed to create patient
[02:40:38] [DOC: 9252670] ℹ️  API push details saved for document 9252670
================================================================================
║                        Processing Document ID: 9252667                         ║
================================================================================
[02:40:38] ℹ️  Agency: Dartmouth HH
[02:40:38] ℹ️  Date: 04/22/2025
[02:40:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:40:40] [DOC: 9252667] ✅ Text extracted using pdfplumber (1163 chars)
[02:40:40] ✅    ✅ Text extracted using pdfplumber (1163 chars)
[02:40:40] 🔄 
🔄 Step 2: Extracting patient data...
[02:40:43] ℹ️  AI extracted raw sex value: 'M'
[02:40:43] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:40:43] ℹ️  AI extracted payer source: 'United Health Care'
[02:40:43] ℹ️  AI extracted diagnoses:
[02:40:43] ℹ️    - Diagnosis 1: 'None'
[02:40:43] ℹ️    - Diagnosis 2: 'None'
[02:40:43] ℹ️    - Diagnosis 3: 'None'
[02:40:43] ℹ️    - Diagnosis 4: 'None'
[02:40:43] ℹ️    - Diagnosis 5: 'None'
[02:40:43] ℹ️    - Diagnosis 6: 'None'
[02:40:43] ℹ️  Final extracted MRN: '7046009'
[02:40:43] ℹ️  Final extracted Sex: 'MALE'
[02:40:43] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:40:43] ℹ️  Final extracted Payer Source: 'United Health Care'
[02:40:43] ✅ Patient data extraction completed successfully
[02:40:43] ✅    ✅ Patient data extracted successfully
[02:40:43] 📊 Patient Response
     └─ patientFName: Julio
     └─ patientLName: Demelo
     └─ dob: 02/23/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 7046009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '10/31/2024', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:40:43] ✅    ✅ Patient identified: Julio Demelo
[02:40:43] ✅    ✅ Patient name validation passed
[02:40:43] 🔄 
🔄 Step 3: Processing patient dates...
[02:40:43] [DOC: 9252667] ℹ️  DOB normalized: 02/23/1950
[02:40:43] [DOC: 9252667] ℹ️  Episode startOfCare normalized: 10/31/2024
[02:40:43] [DOC: 9252667] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[02:40:43] [DOC: 9252667] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[02:40:43] [DOC: 9252667] ✅ Patient date processing completed successfully
[02:40:43] ✅    ✅ Date processing completed
[02:40:43] 📊 Processed Patient Data
     └─ patientFName: Julio
     └─ patientLName: Demelo
     └─ dob: 02/23/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 7046009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '10/31/2024', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025'}]
[02:40:43] 🔄 
🔄 Step 4: Extracting order data...
[02:40:45] ℹ️  Order extraction - MRN: ''
[02:40:45] ℹ️  Order extraction - Sex: 'MALE'
[02:40:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:40:45] ℹ️  Order extraction - Payer Source: 'United Health Care'
[02:40:45] ✅ Order data extraction completed successfully
[02:40:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:40:45] ℹ️  Using MRN from patient data: '7046009'
[02:40:45] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:40:45] ℹ️  Payer source consistent in both sources: 'United Health Care'
[02:40:45] ✅ Patient name cross-validation successful
[02:40:45] ✅    ✅ Data merged successfully
[02:40:47] ✅    ✅ Order data extracted and validated
[02:40:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:41:14] [DOC: 9252667] ℹ️  Patient not found in cache or API: Julio Demelo
[02:41:14] [DOC: 9252667] ℹ️  Patient not found, creating new patient via API...
[02:41:14] [DOC: 9252667] ℹ️  Creating patient via API: Julio Demelo
[02:41:15] [DOC: 9252667] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:41:15] ❌    ❌ Failed to create patient
[02:41:15] [DOC: 9252667] ℹ️  API push details saved for document 9252667
================================================================================
║                        Processing Document ID: 9252664                         ║
================================================================================
[02:41:15] ℹ️  Agency: Dartmouth HH
[02:41:15] ℹ️  Date: 04/22/2025
[02:41:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:41:18] [DOC: 9252664] ✅ Text extracted using pdfplumber (1190 chars)
[02:41:18] ✅    ✅ Text extracted using pdfplumber (1190 chars)
[02:41:18] 🔄 
🔄 Step 2: Extracting patient data...
[02:41:21] ℹ️  AI extracted raw sex value: 'F'
[02:41:21] ℹ️  AI extracted service line: 'PT'
[02:41:21] ℹ️  AI extracted payer source: 'Medicare'
[02:41:21] ℹ️  AI extracted diagnoses:
[02:41:21] ℹ️    - Diagnosis 1: 'None'
[02:41:21] ℹ️    - Diagnosis 2: 'None'
[02:41:21] ℹ️    - Diagnosis 3: 'None'
[02:41:21] ℹ️    - Diagnosis 4: 'None'
[02:41:21] ℹ️    - Diagnosis 5: 'None'
[02:41:21] ℹ️    - Diagnosis 6: 'None'
[02:41:21] ℹ️  Final extracted MRN: '2502011'
[02:41:21] ℹ️  Final extracted Sex: 'FEMALE'
[02:41:21] ℹ️  Final extracted Service Line: 'PT'
[02:41:21] ℹ️  Final extracted Payer Source: 'Medicare'
[02:41:21] ✅ Patient data extraction completed successfully
[02:41:21] ✅    ✅ Patient data extracted successfully
[02:41:21] 📊 Patient Response
     └─ patientFName: Veronica
     └─ patientLName: Cusson
     └─ dob: 08/26/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2502011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/27/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:41:21] ✅    ✅ Patient identified: Veronica Cusson
[02:41:21] ✅    ✅ Patient name validation passed
[02:41:21] 🔄 
🔄 Step 3: Processing patient dates...
[02:41:21] [DOC: 9252664] ℹ️  DOB normalized: 08/26/1964
[02:41:21] [DOC: 9252664] ℹ️  Episode startOfCare normalized: 04/02/2025
[02:41:21] [DOC: 9252664] ℹ️  Episode startOfEpisode normalized: 04/27/2025
[02:41:21] [DOC: 9252664] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[02:41:21] [DOC: 9252664] ✅ Patient date processing completed successfully
[02:41:21] ✅    ✅ Date processing completed
[02:41:21] 📊 Processed Patient Data
     └─ patientFName: Veronica
     └─ patientLName: Cusson
     └─ dob: 08/26/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2502011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/27/2025', 'endOfEpisode': '05/31/2025'}]
[02:41:21] 🔄 
🔄 Step 4: Extracting order data...
[02:41:23] ℹ️  Order extraction - MRN: ''
[02:41:23] ℹ️  Order extraction - Sex: 'FEMALE'
[02:41:23] ℹ️  Order extraction - Service Line: 'PT'
[02:41:23] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:41:23] ✅ Order data extraction completed successfully
[02:41:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:41:23] ℹ️  Using MRN from patient data: '2502011'
[02:41:23] ℹ️  Service line consistent in both sources: 'PT'
[02:41:23] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:41:23] ✅ Patient name cross-validation successful
[02:41:23] ✅    ✅ Data merged successfully
[02:41:24] ✅    ✅ Order data extracted and validated
[02:41:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:41:30] [DOC: 9252664] ℹ️  Patient not found in cache or API: Veronica Cusson
[02:41:30] [DOC: 9252664] ℹ️  Patient not found, creating new patient via API...
[02:41:30] [DOC: 9252664] ℹ️  Creating patient via API: Veronica Cusson
[02:41:31] [DOC: 9252664] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:41:31] ❌    ❌ Failed to create patient
[02:41:31] [DOC: 9252664] ℹ️  API push details saved for document 9252664
================================================================================
║                        Processing Document ID: 9252661                         ║
================================================================================
[02:41:31] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[02:41:31] ℹ️  Date: 04/22/2025
[02:41:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:41:33] [DOC: 9252661] ✅ Text extracted using pdfplumber (973 chars)
[02:41:33] ✅    ✅ Text extracted using pdfplumber (973 chars)
[02:41:33] 🔄 
🔄 Step 2: Extracting patient data...
[02:41:37] ℹ️  AI extracted raw sex value: 'F'
[02:41:37] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:41:37] ℹ️  AI extracted payer source: ''
[02:41:37] ℹ️  AI extracted diagnoses:
[02:41:37] ℹ️    - Diagnosis 1: 'None'
[02:41:37] ℹ️    - Diagnosis 2: 'None'
[02:41:37] ℹ️    - Diagnosis 3: 'None'
[02:41:37] ℹ️    - Diagnosis 4: 'None'
[02:41:37] ℹ️    - Diagnosis 5: 'None'
[02:41:37] ℹ️    - Diagnosis 6: 'None'
[02:41:37] ℹ️  Final extracted MRN: '2092477'
[02:41:37] ℹ️  Final extracted Sex: 'FEMALE'
[02:41:37] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:41:37] ℹ️  Final extracted Payer Source: ''
[02:41:37] ✅ Patient data extraction completed successfully
[02:41:37] ✅    ✅ Patient data extracted successfully
[02:41:37] 📊 Patient Response
     └─ patientFName: Michelle
     └─ patientLName: Gonsalves
     └─ dob: 02/09/1972
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2092477
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:41:37] ✅    ✅ Patient identified: Michelle Gonsalves
[02:41:37] ✅    ✅ Patient name validation passed
[02:41:37] 🔄 
🔄 Step 3: Processing patient dates...
[02:41:37] [DOC: 9252661] ℹ️  DOB normalized: 02/09/1972
[02:41:37] [DOC: 9252661] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[02:41:37] [DOC: 9252661] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[02:41:37] [DOC: 9252661] ✅ Patient date processing completed successfully
[02:41:37] ✅    ✅ Date processing completed
[02:41:37] 📊 Processed Patient Data
     └─ patientFName: Michelle
     └─ patientLName: Gonsalves
     └─ dob: 02/09/1972
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2092477
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025'}]
[02:41:37] 🔄 
🔄 Step 4: Extracting order data...
[02:41:39] ℹ️  Order extraction - MRN: '2092477'
[02:41:39] ℹ️  Order extraction - Sex: 'FEMALE'
[02:41:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:41:39] ℹ️  Order extraction - Payer Source: ''
[02:41:39] ✅ Order data extraction completed successfully
[02:41:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:41:39] ℹ️  Using MRN from patient data: '2092477' over '2092477'
[02:41:39] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:41:39] ✅ Patient name cross-validation successful
[02:41:39] ✅    ✅ Data merged successfully
[02:41:40] ✅    ✅ Order data extracted and validated
[02:41:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:42:02] [DOC: 9252661] ℹ️  Patient not found in cache or API: Michelle Gonsalves
[02:42:02] [DOC: 9252661] ℹ️  Patient not found, creating new patient via API...
[02:42:02] [DOC: 9252661] ℹ️  Creating patient via API: Michelle Gonsalves
[02:42:03] [DOC: 9252661] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:42:03] ❌    ❌ Failed to create patient
[02:42:03] [DOC: 9252661] ℹ️  API push details saved for document 9252661
================================================================================
║                        Processing Document ID: 9252656                         ║
================================================================================
[02:42:03] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[02:42:03] ℹ️  Date: 04/22/2025
[02:42:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:42:05] [DOC: 9252656] ✅ Text extracted using pdfplumber (1287 chars)
[02:42:05] ✅    ✅ Text extracted using pdfplumber (1287 chars)
[02:42:05] 🔄 
🔄 Step 2: Extracting patient data...
[02:42:07] ℹ️  AI extracted raw sex value: 'F'
[02:42:07] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:42:07] ℹ️  AI extracted payer source: ''
[02:42:07] ℹ️  AI extracted diagnoses:
[02:42:07] ℹ️    - Diagnosis 1: ''
[02:42:07] ℹ️    - Diagnosis 2: ''
[02:42:07] ℹ️    - Diagnosis 3: ''
[02:42:07] ℹ️    - Diagnosis 4: ''
[02:42:07] ℹ️    - Diagnosis 5: ''
[02:42:07] ℹ️    - Diagnosis 6: ''
[02:42:07] ℹ️  Final extracted MRN: '2158031'
[02:42:07] ℹ️  Final extracted Sex: 'FEMALE'
[02:42:07] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:42:07] ℹ️  Final extracted Payer Source: ''
[02:42:07] ✅ Patient data extraction completed successfully
[02:42:07] ✅    ✅ Patient data extracted successfully
[02:42:07] 📊 Patient Response
     └─ patientFName: Norma
     └─ patientLName: Dyer
     └─ dob: 11/13/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2158031
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:42:07] ✅    ✅ Patient identified: Norma Dyer
[02:42:07] ✅    ✅ Patient name validation passed
[02:42:07] 🔄 
🔄 Step 3: Processing patient dates...
[02:42:07] [DOC: 9252656] ℹ️  DOB normalized: 11/13/1931
[02:42:07] [DOC: 9252656] ✅ Patient date processing completed successfully
[02:42:07] ✅    ✅ Date processing completed
[02:42:07] 📊 Processed Patient Data
     └─ patientFName: Norma
     └─ patientLName: Dyer
     └─ dob: 11/13/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2158031
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:42:07] 🔄 
🔄 Step 4: Extracting order data...
[02:42:10] ℹ️  Order extraction - MRN: '2158031'
[02:42:10] ℹ️  Order extraction - Sex: 'FEMALE'
[02:42:10] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:42:10] ℹ️  Order extraction - Payer Source: ''
[02:42:10] ✅ Order data extraction completed successfully
[02:42:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:42:10] ℹ️  Using MRN from patient data: '2158031' over '2158031'
[02:42:10] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:42:10] ✅ Patient name cross-validation successful
[02:42:10] ✅    ✅ Data merged successfully
[02:42:11] ✅    ✅ Order data extracted and validated
[02:42:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:42:11] [DOC: 9252656] ✅ Patient found in local cache: Norma Dyer, ID: 5ca2359c-d429-4962-bcd9-bc06407ed3cc
[02:42:11] ✅    ✅ Existing patient found with ID: 5ca2359c-d429-4962-bcd9-bc06407ed3cc
[02:42:11] 🔄 
🔄 Step 6: Pushing order to API...
[02:42:11] [DOC: 9252656] ℹ️  Pushing order via API for patient ID: 5ca2359c-d429-4962-bcd9-bc06407ed3cc
[02:42:12] [DOC: 9252656] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13708"}
[02:42:12] ❌    ❌ Failed to push order
[02:42:12] 🔄 
🔄 Step 7: Writing to CSV...
[02:42:12] [DOC: 9252656] ℹ️  Calculated age: 93 from DOB: 11/13/1931
[02:42:12] [DOC: 9252656] ℹ️  Service Line extracted: 'Skilled Nursing'
[02:42:12] [DOC: 9252656] ℹ️  Payer Source extracted: ''
[02:42:12] [DOC: 9252656] ℹ️  Diagnosis codes being written:
[02:42:12] [DOC: 9252656] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:42:12] [DOC: 9252656] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:42:12] [DOC: 9252656] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:42:12] [DOC: 9252656] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:42:12] [DOC: 9252656] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:42:12] [DOC: 9252656] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:42:12] [DOC: 9252656] ✅ Patient data written to CSV: Norma Dyer | Sex: FEMALE | Age: 93 | Service: Skilled Nursing | Payer:  | MRN: 2158031
[02:42:12] ✅    ✅ Document 9252656 processed and saved successfully
[02:42:12] 🔄 
🔄 Step 8: Saving API details...
[02:42:12] [DOC: 9252656] ℹ️  API push details saved for document 9252656
[02:42:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252655                         ║
================================================================================
[02:42:12] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[02:42:12] ℹ️  Date: 04/22/2025
[02:42:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:42:14] [DOC: 9252655] ✅ Text extracted using pdfplumber (2370 chars)
[02:42:14] ✅    ✅ Text extracted using pdfplumber (2370 chars)
[02:42:14] 🔄 
🔄 Step 2: Extracting patient data...
[02:42:16] ℹ️  AI extracted raw sex value: 'M'
[02:42:16] ℹ️  AI extracted service line: 'Physical Therapy'
[02:42:16] ℹ️  AI extracted payer source: ''
[02:42:16] ℹ️  AI extracted diagnoses:
[02:42:16] ℹ️    - Diagnosis 1: 'None'
[02:42:16] ℹ️    - Diagnosis 2: 'None'
[02:42:16] ℹ️    - Diagnosis 3: 'None'
[02:42:16] ℹ️    - Diagnosis 4: 'None'
[02:42:16] ℹ️    - Diagnosis 5: 'None'
[02:42:16] ℹ️    - Diagnosis 6: 'None'
[02:42:16] ℹ️  Final extracted MRN: '2009831'
[02:42:16] ℹ️  Final extracted Sex: 'MALE'
[02:42:16] ℹ️  Final extracted Service Line: 'Physical Therapy'
[02:42:16] ℹ️  Final extracted Payer Source: ''
[02:42:16] ✅ Patient data extraction completed successfully
[02:42:16] ✅    ✅ Patient data extracted successfully
[02:42:16] 📊 Patient Response
     └─ patientFName: Wilfred
     └─ patientLName: Demarais
     └─ dob: 04/15/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 2009831
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:42:16] ✅    ✅ Patient identified: Wilfred Demarais
[02:42:16] ✅    ✅ Patient name validation passed
[02:42:16] 🔄 
🔄 Step 3: Processing patient dates...
[02:42:16] [DOC: 9252655] ℹ️  DOB normalized: 04/15/1946
[02:42:16] [DOC: 9252655] ✅ Patient date processing completed successfully
[02:42:16] ✅    ✅ Date processing completed
[02:42:16] 📊 Processed Patient Data
     └─ patientFName: Wilfred
     └─ patientLName: Demarais
     └─ dob: 04/15/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 2009831
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[02:42:16] 🔄 
🔄 Step 4: Extracting order data...
[02:42:19] ℹ️  Order extraction - MRN: '2009831'
[02:42:19] ℹ️  Order extraction - Sex: 'MALE'
[02:42:19] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[02:42:19] ℹ️  Order extraction - Payer Source: ''
[02:42:19] ✅ Order data extraction completed successfully
[02:42:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:42:19] ℹ️  Using MRN from patient data: '2009831' over '2009831'
[02:42:19] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[02:42:19] ✅ Patient name cross-validation successful
[02:42:19] ✅    ✅ Data merged successfully
[02:42:20] ✅    ✅ Order data extracted and validated
[02:42:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:42:20] [DOC: 9252655] ✅ Patient found in local cache: Wilfred Demarais, ID: 938bd7d7-5b3f-4f5e-acd3-1aba546f8108
[02:42:20] ✅    ✅ Existing patient found with ID: 938bd7d7-5b3f-4f5e-acd3-1aba546f8108
[02:42:20] 🔄 
🔄 Step 6: Pushing order to API...
[02:42:20] [DOC: 9252655] ℹ️  Pushing order via API for patient ID: 938bd7d7-5b3f-4f5e-acd3-1aba546f8108
[02:42:22] [DOC: 9252655] ❌ Order push failed with status 201: {"id":"57dc472b-bf23-4fce-b919-49d48426b9b5","orderWAVId":"ORD20009","orderNo":"1083419","orderDate":"04/18/2025","startOfCare":"04/23/2025","episodeStartDate":"04/23/2025","episodeEndDate":"06/07/2025","documentID":"9252655","mrn":"2009831","patientName":"Demarais, Wilfred F Jr.","sentToPhysicianDate":"04/22/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"05/02/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"938bd7d7-5b3f-4f5e-acd3-1aba546f8108","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[02:42:22] ❌    ❌ Failed to push order
[02:42:22] 🔄 
🔄 Step 7: Writing to CSV...
[02:42:22] [DOC: 9252655] ℹ️  Calculated age: 79 from DOB: 04/15/1946
[02:42:22] [DOC: 9252655] ℹ️  Service Line extracted: 'Physical Therapy'
[02:42:22] [DOC: 9252655] ℹ️  Payer Source extracted: ''
[02:42:22] [DOC: 9252655] ℹ️  Diagnosis codes being written:
[02:42:22] [DOC: 9252655] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:42:22] [DOC: 9252655] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:42:22] [DOC: 9252655] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:42:22] [DOC: 9252655] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:42:22] [DOC: 9252655] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:42:22] [DOC: 9252655] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:42:22] [DOC: 9252655] ✅ Patient data written to CSV: Wilfred Demarais | Sex: MALE | Age: 79 | Service: Physical Therapy | Payer:  | MRN: 2009831
[02:42:22] ✅    ✅ Document 9252655 processed and saved successfully
[02:42:22] 🔄 
🔄 Step 8: Saving API details...
[02:42:22] [DOC: 9252655] ℹ️  API push details saved for document 9252655
[02:42:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252653                         ║
================================================================================
[02:42:22] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[02:42:22] ℹ️  Date: 04/22/2025
[02:42:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:42:24] [DOC: 9252653] ✅ Text extracted using pdfplumber (1207 chars)
[02:42:24] ✅    ✅ Text extracted using pdfplumber (1207 chars)
[02:42:24] 🔄 
🔄 Step 2: Extracting patient data...
[02:42:28] ℹ️  AI extracted raw sex value: 'M'
[02:42:28] ℹ️  AI extracted service line: 'Medical Social Work'
[02:42:28] ℹ️  AI extracted payer source: ''
[02:42:28] ℹ️  AI extracted diagnoses:
[02:42:28] ℹ️    - Diagnosis 1: 'None'
[02:42:28] ℹ️    - Diagnosis 2: 'None'
[02:42:28] ℹ️    - Diagnosis 3: 'None'
[02:42:28] ℹ️    - Diagnosis 4: 'None'
[02:42:28] ℹ️    - Diagnosis 5: 'None'
[02:42:28] ℹ️    - Diagnosis 6: 'None'
[02:42:28] ℹ️  Final extracted MRN: '2312121'
[02:42:28] ℹ️  Final extracted Sex: 'MALE'
[02:42:28] ℹ️  Final extracted Service Line: 'Medical Social Work'
[02:42:28] ℹ️  Final extracted Payer Source: ''
[02:42:28] ✅ Patient data extraction completed successfully
[02:42:28] ✅    ✅ Patient data extracted successfully
[02:42:28] 📊 Patient Response
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/21/2025', 'endOfEpisode': '06/30/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:42:28] ✅    ✅ Patient identified: Antonio Carvalho
[02:42:28] ✅    ✅ Patient name validation passed
[02:42:28] 🔄 
🔄 Step 3: Processing patient dates...
[02:42:28] [DOC: 9252653] ℹ️  DOB normalized: 07/01/1933
[02:42:28] [DOC: 9252653] ℹ️  Episode startOfEpisode normalized: 04/21/2025
[02:42:28] [DOC: 9252653] ℹ️  Episode endOfEpisode normalized: 06/30/2025
[02:42:28] [DOC: 9252653] ✅ Patient date processing completed successfully
[02:42:28] ✅    ✅ Date processing completed
[02:42:28] 📊 Processed Patient Data
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/21/2025', 'endOfEpisode': '06/30/2025'}]
[02:42:28] 🔄 
🔄 Step 4: Extracting order data...
[02:42:30] ℹ️  Order extraction - MRN: '2312121'
[02:42:30] ℹ️  Order extraction - Sex: 'MALE'
[02:42:30] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[02:42:30] ℹ️  Order extraction - Payer Source: ''
[02:42:30] ✅ Order data extraction completed successfully
[02:42:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:42:30] ℹ️  Using MRN from patient data: '2312121' over '2312121'
[02:42:30] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[02:42:30] ✅ Patient name cross-validation successful
[02:42:30] ✅    ✅ Data merged successfully
[02:42:32] ✅    ✅ Order data extracted and validated
[02:42:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:42:38] [DOC: 9252653] ℹ️  Patient not found in cache or API: Antonio Carvalho
[02:42:38] [DOC: 9252653] ℹ️  Patient not found, creating new patient via API...
[02:42:38] [DOC: 9252653] ℹ️  Creating patient via API: Antonio Carvalho
[02:42:39] [DOC: 9252653] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:42:39] ❌    ❌ Failed to create patient
[02:42:39] [DOC: 9252653] ℹ️  API push details saved for document 9252653
================================================================================
║                        Processing Document ID: 9252649                         ║
================================================================================
[02:42:39] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[02:42:39] ℹ️  Date: 04/22/2025
[02:42:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:42:40] [DOC: 9252649] ✅ Text extracted using pdfplumber (1127 chars)
[02:42:40] ✅    ✅ Text extracted using pdfplumber (1127 chars)
[02:42:40] 🔄 
🔄 Step 2: Extracting patient data...
[02:42:43] ℹ️  AI extracted raw sex value: 'F'
[02:42:43] ℹ️  AI extracted service line: 'Medical Social Work'
[02:42:43] ℹ️  AI extracted payer source: ''
[02:42:43] ℹ️  AI extracted diagnoses:
[02:42:43] ℹ️    - Diagnosis 1: ''
[02:42:43] ℹ️    - Diagnosis 2: ''
[02:42:43] ℹ️    - Diagnosis 3: ''
[02:42:43] ℹ️    - Diagnosis 4: ''
[02:42:43] ℹ️    - Diagnosis 5: ''
[02:42:43] ℹ️    - Diagnosis 6: ''
[02:42:43] ℹ️  Final extracted MRN: '2258674'
[02:42:43] ℹ️  Final extracted Sex: 'FEMALE'
[02:42:43] ℹ️  Final extracted Service Line: 'Medical Social Work'
[02:42:43] ℹ️  Final extracted Payer Source: ''
[02:42:43] ✅ Patient data extraction completed successfully
[02:42:43] ✅    ✅ Patient data extracted successfully
[02:42:43] 📊 Patient Response
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/21/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:42:43] ✅    ✅ Patient identified: Maryann Boucher
[02:42:43] ✅    ✅ Patient name validation passed
[02:42:43] 🔄 
🔄 Step 3: Processing patient dates...
[02:42:43] [DOC: 9252649] ℹ️  DOB normalized: 03/22/1946
[02:42:43] [DOC: 9252649] ℹ️  Episode startOfEpisode normalized: 04/21/2025
[02:42:43] [DOC: 9252649] ℹ️  Episode endOfEpisode normalized: 07/12/2025
[02:42:43] [DOC: 9252649] ✅ Patient date processing completed successfully
[02:42:43] ✅    ✅ Date processing completed
[02:42:43] 📊 Processed Patient Data
     └─ patientFName: Maryann
     └─ patientLName: Boucher
     └─ dob: 03/22/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2258674
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/21/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:42:43] 🔄 
🔄 Step 4: Extracting order data...
[02:42:45] ℹ️  Order extraction - MRN: '2258674'
[02:42:45] ℹ️  Order extraction - Sex: 'FEMALE'
[02:42:45] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[02:42:45] ℹ️  Order extraction - Payer Source: ''
[02:42:45] ✅ Order data extraction completed successfully
[02:42:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:42:45] ℹ️  Using MRN from patient data: '2258674' over '2258674'
[02:42:45] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[02:42:45] ✅ Patient name cross-validation successful
[02:42:45] ✅    ✅ Data merged successfully
[02:42:46] ✅    ✅ Order data extracted and validated
[02:42:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:42:57] [DOC: 9252649] ℹ️  Patient not found in cache or API: Maryann Boucher
[02:42:57] [DOC: 9252649] ℹ️  Patient not found, creating new patient via API...
[02:42:57] [DOC: 9252649] ℹ️  Creating patient via API: Maryann Boucher
[02:42:58] [DOC: 9252649] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:42:58] ❌    ❌ Failed to create patient
[02:42:58] [DOC: 9252649] ℹ️  API push details saved for document 9252649
================================================================================
║                        Processing Document ID: 9252648                         ║
================================================================================
[02:42:58] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[02:42:58] ℹ️  Date: 04/22/2025
[02:42:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:42:59] [DOC: 9252648] ✅ Text extracted using pdfplumber (1976 chars)
[02:42:59] ✅    ✅ Text extracted using pdfplumber (1976 chars)
[02:42:59] 🔄 
🔄 Step 2: Extracting patient data...
[02:43:02] ℹ️  AI extracted raw sex value: 'F'
[02:43:02] ℹ️  AI extracted service line: 'Physical Therapy'
[02:43:02] ℹ️  AI extracted payer source: ''
[02:43:02] ℹ️  AI extracted diagnoses:
[02:43:02] ℹ️    - Diagnosis 1: 'None'
[02:43:02] ℹ️    - Diagnosis 2: 'None'
[02:43:02] ℹ️    - Diagnosis 3: 'None'
[02:43:02] ℹ️    - Diagnosis 4: 'None'
[02:43:02] ℹ️    - Diagnosis 5: 'None'
[02:43:02] ℹ️    - Diagnosis 6: 'None'
[02:43:02] ℹ️  Final extracted MRN: '2188842'
[02:43:02] ℹ️  Final extracted Sex: 'FEMALE'
[02:43:02] ℹ️  Final extracted Service Line: 'Physical Therapy'
[02:43:02] ℹ️  Final extracted Payer Source: ''
[02:43:02] ✅ Patient data extraction completed successfully
[02:43:02] ✅    ✅ Patient data extracted successfully
[02:43:02] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Anderson
     └─ dob: 07/12/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2188842
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:43:02] ✅    ✅ Patient identified: Nancy Anderson
[02:43:02] ✅    ✅ Patient name validation passed
[02:43:02] 🔄 
🔄 Step 3: Processing patient dates...
[02:43:02] [DOC: 9252648] ℹ️  DOB normalized: 07/12/1954
[02:43:02] [DOC: 9252648] ✅ Patient date processing completed successfully
[02:43:02] ✅    ✅ Date processing completed
[02:43:02] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Anderson
     └─ dob: 07/12/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2188842
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[02:43:02] 🔄 
🔄 Step 4: Extracting order data...
[02:43:04] ℹ️  Order extraction - MRN: '2188842'
[02:43:04] ℹ️  Order extraction - Sex: 'FEMALE'
[02:43:04] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[02:43:04] ℹ️  Order extraction - Payer Source: ''
[02:43:04] ✅ Order data extraction completed successfully
[02:43:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:43:04] ℹ️  Using MRN from patient data: '2188842' over '2188842'
[02:43:04] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[02:43:04] ✅ Patient name cross-validation successful
[02:43:04] ✅    ✅ Data merged successfully
[02:43:06] ✅    ✅ Order data extracted and validated
[02:43:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:43:11] [DOC: 9252648] ℹ️  Patient not found in cache or API: Nancy Anderson
[02:43:11] [DOC: 9252648] ℹ️  Patient not found, creating new patient via API...
[02:43:11] [DOC: 9252648] ℹ️  Creating patient via API: Nancy Anderson
[02:43:12] [DOC: 9252648] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:43:12] ❌    ❌ Failed to create patient
[02:43:12] [DOC: 9252648] ℹ️  API push details saved for document 9252648
================================================================================
║                        Processing Document ID: 9252647                         ║
================================================================================
[02:43:12] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[02:43:12] ℹ️  Date: 04/22/2025
[02:43:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:43:14] [DOC: 9252647] ✅ Text extracted using pdfplumber (1168 chars)
[02:43:14] ✅    ✅ Text extracted using pdfplumber (1168 chars)
[02:43:14] 🔄 
🔄 Step 2: Extracting patient data...
[02:43:16] ℹ️  AI extracted raw sex value: 'F'
[02:43:16] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:43:16] ℹ️  AI extracted payer source: ''
[02:43:16] ℹ️  AI extracted diagnoses:
[02:43:16] ℹ️    - Diagnosis 1: ''
[02:43:16] ℹ️    - Diagnosis 2: ''
[02:43:16] ℹ️    - Diagnosis 3: ''
[02:43:16] ℹ️    - Diagnosis 4: ''
[02:43:16] ℹ️    - Diagnosis 5: ''
[02:43:16] ℹ️    - Diagnosis 6: ''
[02:43:16] ℹ️  Final extracted MRN: '2185063'
[02:43:16] ℹ️  Final extracted Sex: 'FEMALE'
[02:43:16] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:43:16] ℹ️  Final extracted Payer Source: ''
[02:43:16] ✅ Patient data extraction completed successfully
[02:43:16] ✅    ✅ Patient data extracted successfully
[02:43:16] 📊 Patient Response
     └─ patientFName: Kathleen
     └─ patientLName: Amaral
     └─ dob: 11/28/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2185063
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:43:16] ✅    ✅ Patient identified: Kathleen Amaral
[02:43:16] ✅    ✅ Patient name validation passed
[02:43:16] 🔄 
🔄 Step 3: Processing patient dates...
[02:43:16] [DOC: 9252647] ℹ️  DOB normalized: 11/28/1942
[02:43:16] [DOC: 9252647] ℹ️  Episode startOfCare normalized: 03/29/2025
[02:43:16] [DOC: 9252647] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[02:43:16] [DOC: 9252647] ℹ️  Episode endOfEpisode normalized: 05/03/2025
[02:43:16] [DOC: 9252647] ✅ Patient date processing completed successfully
[02:43:16] ✅    ✅ Date processing completed
[02:43:16] 📊 Processed Patient Data
     └─ patientFName: Kathleen
     └─ patientLName: Amaral
     └─ dob: 11/28/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2185063
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:43:16] 🔄 
🔄 Step 4: Extracting order data...
[02:43:19] ℹ️  Order extraction - MRN: '2185063'
[02:43:19] ℹ️  Order extraction - Sex: 'FEMALE'
[02:43:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:43:19] ℹ️  Order extraction - Payer Source: ''
[02:43:19] ✅ Order data extraction completed successfully
[02:43:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:43:19] ℹ️  Using MRN from patient data: '2185063' over '2185063'
[02:43:19] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:43:19] ✅ Patient name cross-validation successful
[02:43:19] ✅    ✅ Data merged successfully
[02:43:20] ✅    ✅ Order data extracted and validated
[02:43:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:43:40] [DOC: 9252647] ✅ Patient exists in API: Kathleen Amaral, ID: c71782d3-7550-4bcd-9db4-837db83621d1
[02:43:40] ✅    ✅ Existing patient found with ID: c71782d3-7550-4bcd-9db4-837db83621d1
[02:43:40] 🔄 
🔄 Step 6: Pushing order to API...
[02:43:40] [DOC: 9252647] ℹ️  Pushing order via API for patient ID: c71782d3-7550-4bcd-9db4-837db83621d1
[02:43:42] [DOC: 9252647] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12929"}
[02:43:42] ❌    ❌ Failed to push order
[02:43:42] 🔄 
🔄 Step 7: Writing to CSV...
[02:43:42] [DOC: 9252647] ℹ️  Calculated age: 82 from DOB: 11/28/1942
[02:43:42] [DOC: 9252647] ℹ️  Service Line extracted: 'Skilled Nursing'
[02:43:42] [DOC: 9252647] ℹ️  Payer Source extracted: ''
[02:43:42] [DOC: 9252647] ℹ️  Diagnosis codes being written:
[02:43:42] [DOC: 9252647] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:43:42] [DOC: 9252647] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:43:42] [DOC: 9252647] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:43:42] [DOC: 9252647] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:43:42] [DOC: 9252647] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:43:42] [DOC: 9252647] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:43:42] [DOC: 9252647] ✅ Patient data written to CSV: Kathleen Amaral | Sex: FEMALE | Age: 82 | Service: Skilled Nursing | Payer:  | MRN: 2185063
[02:43:42] ✅    ✅ Document 9252647 processed and saved successfully
[02:43:42] 🔄 
🔄 Step 8: Saving API details...
[02:43:42] [DOC: 9252647] ℹ️  API push details saved for document 9252647
[02:43:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251863                         ║
================================================================================
[02:43:42] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:43:42] ℹ️  Date: 04/21/2025
[02:43:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:43:44] [DOC: 9251863] ✅ Text extracted using pdfplumber (1372 chars)
[02:43:44] ✅    ✅ Text extracted using pdfplumber (1372 chars)
[02:43:44] 🔄 
🔄 Step 2: Extracting patient data...
[02:43:47] ℹ️  AI extracted raw sex value: ''
[02:43:47] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:43:47] ℹ️  AI extracted payer source: ''
[02:43:47] ℹ️  AI extracted diagnoses:
[02:43:47] ℹ️    - Diagnosis 1: 'K57.30'
[02:43:47] ℹ️    - Diagnosis 2: 'K52.9'
[02:43:47] ℹ️    - Diagnosis 3: 'R53.1'
[02:43:47] ℹ️    - Diagnosis 4: ''
[02:43:47] ℹ️    - Diagnosis 5: ''
[02:43:47] ℹ️    - Diagnosis 6: ''
[02:43:47] ℹ️  Final extracted MRN: 'MA231109053505'
[02:43:47] ℹ️  Final extracted Sex: ''
[02:43:47] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:43:47] ℹ️  Final extracted Payer Source: ''
[02:43:47] ✅ Patient data extraction completed successfully
[02:43:47] ✅    ✅ Patient data extracted successfully
[02:43:47] 📊 Patient Response
     └─ patientFName: Hilda
     └─ patientLName: Pine
     └─ dob: 05/08/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA231109053505
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'K57.30', 'secondDiagnosis': 'K52.9', 'thirdDiagnosis': 'R53.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:43:47] ✅    ✅ Patient identified: Hilda Pine
[02:43:47] ✅    ✅ Patient name validation passed
[02:43:47] 🔄 
🔄 Step 3: Processing patient dates...
[02:43:47] [DOC: 9251863] ℹ️  DOB normalized: 05/08/1935
[02:43:47] [DOC: 9251863] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[02:43:47] [DOC: 9251863] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[02:43:47] [DOC: 9251863] ✅ Patient date processing completed successfully
[02:43:47] ✅    ✅ Date processing completed
[02:43:47] 📊 Processed Patient Data
     └─ patientFName: Hilda
     └─ patientLName: Pine
     └─ dob: 05/08/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA231109053505
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'K57.30', 'secondDiagnosis': 'K52.9', 'thirdDiagnosis': 'R53.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:43:47] 🔄 
🔄 Step 4: Extracting order data...
[02:43:49] ℹ️  Order extraction - MRN: 'MA231109053505'
[02:43:49] ℹ️  Order extraction - Sex: ''
[02:43:49] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:43:49] ℹ️  Order extraction - Payer Source: ''
[02:43:49] ✅ Order data extraction completed successfully
[02:43:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:43:49] ℹ️  Using MRN from patient data: 'MA231109053505' over 'MA231109053505'
[02:43:49] ⚠️  Could not determine sex using any available method
[02:43:49] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:43:49] ✅ Patient name cross-validation successful
[02:43:49] ✅    ✅ Data merged successfully
[02:43:50] ✅    ✅ Order data extracted and validated
[02:43:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:43:50] [DOC: 9251863] ✅ Patient found in local cache: Hilda Pine, ID: 29d1eb58-1e55-4493-8449-e3a781dbc17c
[02:43:50] ✅    ✅ Existing patient found with ID: 29d1eb58-1e55-4493-8449-e3a781dbc17c
[02:43:50] 🔄 
🔄 Step 6: Pushing order to API...
[02:43:50] [DOC: 9251863] ℹ️  Pushing order via API for patient ID: 29d1eb58-1e55-4493-8449-e3a781dbc17c
[02:43:51] [DOC: 9251863] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13074"}
[02:43:51] ❌    ❌ Failed to push order
[02:43:51] 🔄 
🔄 Step 7: Writing to CSV...
[02:43:51] [DOC: 9251863] ℹ️  Calculated age: 90 from DOB: 05/08/1935
[02:43:51] [DOC: 9251863] ℹ️  Service Line extracted: 'Skilled Nursing'
[02:43:51] [DOC: 9251863] ℹ️  Payer Source extracted: ''
[02:43:51] [DOC: 9251863] ℹ️  Diagnosis codes being written:
[02:43:51] [DOC: 9251863] ℹ️    - Latest_Episode_Firstdiagnosis: 'K57.30'
[02:43:51] [DOC: 9251863] ℹ️    - Latest_Episode_Seconddiagnosis: 'K52.9'
[02:43:51] [DOC: 9251863] ℹ️    - Latest_Episode_Thirddiagnosis: 'R53.1'
[02:43:51] [DOC: 9251863] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:43:51] [DOC: 9251863] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:43:51] [DOC: 9251863] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:43:51] [DOC: 9251863] ✅ Patient data written to CSV: Hilda Pine | Sex:  | Age: 90 | Service: Skilled Nursing | Payer:  | MRN: MA231109053505
[02:43:51] ✅    ✅ Document 9251863 processed and saved successfully
[02:43:51] 🔄 
🔄 Step 8: Saving API details...
[02:43:51] [DOC: 9251863] ℹ️  API push details saved for document 9251863
[02:43:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251963                         ║
================================================================================
[02:43:51] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:43:51] ℹ️  Date: 04/21/2025
[02:43:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:43:58] [DOC: 9251963] ✅ Text extracted using pdfplumber (12607 chars)
[02:43:58] ✅    ✅ Text extracted using pdfplumber (12607 chars)
[02:43:58] 🔄 
🔄 Step 2: Extracting patient data...
[02:44:01] ℹ️  AI extracted raw sex value: 'F'
[02:44:01] ℹ️  AI extracted service line: 'OT'
[02:44:01] ℹ️  AI extracted payer source: 'None'
[02:44:01] ℹ️  AI extracted diagnoses:
[02:44:01] ℹ️    - Diagnosis 1: 'COPD Exacerbation'
[02:44:01] ℹ️    - Diagnosis 2: 'muscle weakness'
[02:44:01] ℹ️    - Diagnosis 3: 'None'
[02:44:01] ℹ️    - Diagnosis 4: 'None'
[02:44:01] ℹ️    - Diagnosis 5: 'None'
[02:44:01] ℹ️    - Diagnosis 6: 'None'
[02:44:01] ℹ️  Final extracted MRN: 'MA241122026006'
[02:44:01] ℹ️  Final extracted Sex: 'FEMALE'
[02:44:01] ℹ️  Final extracted Service Line: 'OT'
[02:44:01] ℹ️  Final extracted Payer Source: ''
[02:44:01] ✅ Patient data extraction completed successfully
[02:44:01] ✅    ✅ Patient data extracted successfully
[02:44:01] 📊 Patient Response
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/18/2025', 'endOfEpisode': None, 'firstDiagnosis': 'COPD Exacerbation', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:44:01] ✅    ✅ Patient identified: Elba Rivera
[02:44:01] ✅    ✅ Patient name validation passed
[02:44:01] 🔄 
🔄 Step 3: Processing patient dates...
[02:44:01] [DOC: 9251963] ℹ️  DOB normalized: 02/14/1960
[02:44:01] [DOC: 9251963] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[02:44:01] [DOC: 9251963] ✅ Patient date processing completed successfully
[02:44:01] ✅    ✅ Date processing completed
[02:44:01] 📊 Processed Patient Data
     └─ patientFName: Elba
     └─ patientLName: Rivera
     └─ dob: 02/14/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241122026006
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'firstDiagnosis': 'COPD Exacerbation', 'secondDiagnosis': 'muscle weakness'}]
[02:44:01] 🔄 
🔄 Step 4: Extracting order data...
[02:44:03] ℹ️  Order extraction - MRN: 'MA241122026006'
[02:44:03] ℹ️  Order extraction - Sex: 'FEMALE'
[02:44:03] ℹ️  Order extraction - Service Line: 'OT'
[02:44:03] ℹ️  Order extraction - Payer Source: ''
[02:44:03] ✅ Order data extraction completed successfully
[02:44:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:44:03] ℹ️  Using MRN from patient data: 'MA241122026006' over 'MA241122026006'
[02:44:03] ℹ️  Service line consistent in both sources: 'OT'
[02:44:03] ✅ Patient name cross-validation successful
[02:44:03] ✅    ✅ Data merged successfully
[02:44:05] ⚠️     ❌ Skipping - missing episode start date
[02:44:05] [DOC: 9251963] ℹ️  API push details saved for document 9251963
================================================================================
║                        Processing Document ID: 9251961                         ║
================================================================================
[02:44:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:44:05] ℹ️  Date: 04/21/2025
[02:44:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:44:07] [DOC: 9251961] ✅ Text extracted using pdfplumber (1332 chars)
[02:44:07] ✅    ✅ Text extracted using pdfplumber (1332 chars)
[02:44:07] 🔄 
🔄 Step 2: Extracting patient data...
[02:44:10] ℹ️  AI extracted raw sex value: ''
[02:44:10] ℹ️  AI extracted service line: 'Physical Therapy'
[02:44:10] ℹ️  AI extracted payer source: ''
[02:44:10] ℹ️  AI extracted diagnoses:
[02:44:10] ℹ️    - Diagnosis 1: 'N30.00'
[02:44:10] ℹ️    - Diagnosis 2: 'E11.9'
[02:44:10] ℹ️    - Diagnosis 3: 'F41.1'
[02:44:10] ℹ️    - Diagnosis 4: ''
[02:44:10] ℹ️    - Diagnosis 5: ''
[02:44:10] ℹ️    - Diagnosis 6: ''
[02:44:10] ℹ️  Final extracted MRN: '101002392'
[02:44:10] ℹ️  Final extracted Sex: ''
[02:44:10] ℹ️  Final extracted Service Line: 'Physical Therapy'
[02:44:10] ℹ️  Final extracted Payer Source: ''
[02:44:10] ✅ Patient data extraction completed successfully
[02:44:10] ✅    ✅ Patient data extracted successfully
[02:44:10] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:44:10] ✅    ✅ Patient identified: Virginia Brunton
[02:44:10] ✅    ✅ Patient name validation passed
[02:44:10] 🔄 
🔄 Step 3: Processing patient dates...
[02:44:10] [DOC: 9251961] ℹ️  DOB normalized: 06/05/1940
[02:44:10] [DOC: 9251961] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[02:44:10] [DOC: 9251961] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[02:44:10] [DOC: 9251961] ✅ Patient date processing completed successfully
[02:44:10] ✅    ✅ Date processing completed
[02:44:10] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:44:10] 🔄 
🔄 Step 4: Extracting order data...
[02:44:12] ℹ️  Order extraction - MRN: '101002392'
[02:44:12] ℹ️  Order extraction - Sex: ''
[02:44:12] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[02:44:12] ℹ️  Order extraction - Payer Source: ''
[02:44:12] ✅ Order data extraction completed successfully
[02:44:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:44:12] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[02:44:12] ℹ️  Inferred sex as FEMALE from name: Virginia
[02:44:12] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[02:44:12] ✅ Patient name cross-validation successful
[02:44:12] ✅    ✅ Data merged successfully
[02:44:14] ✅    ✅ Order data extracted and validated
[02:44:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:44:14] [DOC: 9251961] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[02:44:14] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[02:44:14] 🔄 
🔄 Step 6: Pushing order to API...
[02:44:14] [DOC: 9251961] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[02:44:15] [DOC: 9251961] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13405"}
[02:44:15] ❌    ❌ Failed to push order
[02:44:15] 🔄 
🔄 Step 7: Writing to CSV...
[02:44:15] [DOC: 9251961] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[02:44:15] [DOC: 9251961] ℹ️  Service Line extracted: 'Physical Therapy'
[02:44:15] [DOC: 9251961] ℹ️  Payer Source extracted: ''
[02:44:15] [DOC: 9251961] ℹ️  Diagnosis codes being written:
[02:44:15] [DOC: 9251961] ℹ️    - Latest_Episode_Firstdiagnosis: 'N30.00'
[02:44:15] [DOC: 9251961] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[02:44:15] [DOC: 9251961] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[02:44:15] [DOC: 9251961] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:44:15] [DOC: 9251961] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:44:15] [DOC: 9251961] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:44:15] [DOC: 9251961] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: Physical Therapy | Payer:  | MRN: 101002392
[02:44:15] ✅    ✅ Document 9251961 processed and saved successfully
[02:44:15] 🔄 
🔄 Step 8: Saving API details...
[02:44:15] [DOC: 9251961] ℹ️  API push details saved for document 9251961
[02:44:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251959                         ║
================================================================================
[02:44:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:44:15] ℹ️  Date: 04/21/2025
[02:44:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:44:19] [DOC: 9251959] ✅ Text extracted using pdfplumber (1199 chars)
[02:44:19] ✅    ✅ Text extracted using pdfplumber (1199 chars)
[02:44:19] 🔄 
🔄 Step 2: Extracting patient data...
[02:44:21] ℹ️  AI extracted raw sex value: ''
[02:44:21] ℹ️  AI extracted service line: 'Nursing'
[02:44:21] ℹ️  AI extracted payer source: ''
[02:44:21] ℹ️  AI extracted diagnoses:
[02:44:21] ℹ️    - Diagnosis 1: 'I69.351'
[02:44:21] ℹ️    - Diagnosis 2: 'E87.6'
[02:44:21] ℹ️    - Diagnosis 3: 'G35'
[02:44:21] ℹ️    - Diagnosis 4: 'None'
[02:44:21] ℹ️    - Diagnosis 5: 'None'
[02:44:21] ℹ️    - Diagnosis 6: 'None'
[02:44:21] ℹ️  Final extracted MRN: 'MA220701015501'
[02:44:21] ℹ️  Final extracted Sex: ''
[02:44:21] ℹ️  Final extracted Service Line: 'Nursing'
[02:44:21] ℹ️  Final extracted Payer Source: ''
[02:44:21] ✅ Patient data extraction completed successfully
[02:44:21] ✅    ✅ Patient data extracted successfully
[02:44:21] 📊 Patient Response
     └─ patientFName: Ada
     └─ patientLName: Burns
     └─ dob: 01/15/1955
     └─ patientSex: 
     └─ medicalRecordNo: MA220701015501
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'I69.351', 'secondDiagnosis': 'E87.6', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:44:21] ✅    ✅ Patient identified: Ada Burns
[02:44:21] ✅    ✅ Patient name validation passed
[02:44:21] 🔄 
🔄 Step 3: Processing patient dates...
[02:44:21] [DOC: 9251959] ℹ️  DOB normalized: 01/15/1955
[02:44:21] [DOC: 9251959] ℹ️  Episode startOfEpisode normalized: 02/20/2025
[02:44:21] [DOC: 9251959] ℹ️  Episode endOfEpisode normalized: 04/20/2025
[02:44:21] [DOC: 9251959] ✅ Patient date processing completed successfully
[02:44:21] ✅    ✅ Date processing completed
[02:44:21] 📊 Processed Patient Data
     └─ patientFName: Ada
     └─ patientLName: Burns
     └─ dob: 01/15/1955
     └─ patientSex: 
     └─ medicalRecordNo: MA220701015501
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'I69.351', 'secondDiagnosis': 'E87.6', 'thirdDiagnosis': 'G35'}]
[02:44:21] 🔄 
🔄 Step 4: Extracting order data...
[02:44:24] ℹ️  Order extraction - MRN: 'MA220701015501'
[02:44:24] ℹ️  Order extraction - Sex: ''
[02:44:24] ℹ️  Order extraction - Service Line: 'RN'
[02:44:24] ℹ️  Order extraction - Payer Source: ''
[02:44:24] ✅ Order data extraction completed successfully
[02:44:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:44:24] ℹ️  Using MRN from patient data: 'MA220701015501' over 'MA220701015501'
[02:44:24] ⚠️  Could not determine sex using any available method
[02:44:24] ℹ️  Combined service lines: Patient='Nursing' + Order='RN' = 'Nursing, RN'
[02:44:24] ✅ Patient name cross-validation successful
[02:44:24] ✅    ✅ Data merged successfully
[02:44:25] ✅    ✅ Order data extracted and validated
[02:44:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:44:25] [DOC: 9251959] ✅ Patient found in local cache: Ada Burns, ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[02:44:25] ✅    ✅ Existing patient found with ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[02:44:25] 🔄 
🔄 Step 6: Pushing order to API...
[02:44:25] [DOC: 9251959] ℹ️  Pushing order via API for patient ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[02:44:26] [DOC: 9251959] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13416"}
[02:44:26] ❌    ❌ Failed to push order
[02:44:26] 🔄 
🔄 Step 7: Writing to CSV...
[02:44:26] [DOC: 9251959] ℹ️  Calculated age: 70 from DOB: 01/15/1955
[02:44:26] [DOC: 9251959] ℹ️  Service Line extracted: 'Nursing, RN'
[02:44:26] [DOC: 9251959] ℹ️  Payer Source extracted: ''
[02:44:26] [DOC: 9251959] ℹ️  Diagnosis codes being written:
[02:44:26] [DOC: 9251959] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.351'
[02:44:26] [DOC: 9251959] ℹ️    - Latest_Episode_Seconddiagnosis: 'E87.6'
[02:44:26] [DOC: 9251959] ℹ️    - Latest_Episode_Thirddiagnosis: 'G35'
[02:44:26] [DOC: 9251959] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:44:26] [DOC: 9251959] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:44:26] [DOC: 9251959] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:44:26] [DOC: 9251959] ✅ Patient data written to CSV: Ada Burns | Sex:  | Age: 70 | Service: Nursing, RN | Payer:  | MRN: MA220701015501
[02:44:26] ✅    ✅ Document 9251959 processed and saved successfully
[02:44:26] 🔄 
🔄 Step 8: Saving API details...
[02:44:26] [DOC: 9251959] ℹ️  API push details saved for document 9251959
[02:44:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251957                         ║
================================================================================
[02:44:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:44:26] ℹ️  Date: 04/21/2025
[02:44:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:44:29] [DOC: 9251957] ✅ Text extracted using pdfplumber (1614 chars)
[02:44:29] ✅    ✅ Text extracted using pdfplumber (1614 chars)
[02:44:29] 🔄 
🔄 Step 2: Extracting patient data...
[02:44:32] ℹ️  AI extracted raw sex value: ''
[02:44:32] ℹ️  AI extracted service line: 'Occupational Therapy'
[02:44:32] ℹ️  AI extracted payer source: ''
[02:44:32] ℹ️  AI extracted diagnoses:
[02:44:32] ℹ️    - Diagnosis 1: 'N30.00'
[02:44:32] ℹ️    - Diagnosis 2: 'E11.9'
[02:44:32] ℹ️    - Diagnosis 3: 'F41.1'
[02:44:32] ℹ️    - Diagnosis 4: 'None'
[02:44:32] ℹ️    - Diagnosis 5: 'None'
[02:44:32] ℹ️    - Diagnosis 6: 'None'
[02:44:32] ℹ️  Final extracted MRN: '101002392'
[02:44:32] ℹ️  Final extracted Sex: ''
[02:44:32] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[02:44:32] ℹ️  Final extracted Payer Source: ''
[02:44:32] ✅ Patient data extraction completed successfully
[02:44:32] ✅    ✅ Patient data extracted successfully
[02:44:32] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:44:32] ✅    ✅ Patient identified: Virginia Brunton
[02:44:32] ✅    ✅ Patient name validation passed
[02:44:32] 🔄 
🔄 Step 3: Processing patient dates...
[02:44:32] [DOC: 9251957] ℹ️  DOB normalized: 06/05/1940
[02:44:32] [DOC: 9251957] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[02:44:32] [DOC: 9251957] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[02:44:32] [DOC: 9251957] ✅ Patient date processing completed successfully
[02:44:32] ✅    ✅ Date processing completed
[02:44:32] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1'}]
[02:44:32] 🔄 
🔄 Step 4: Extracting order data...
[02:44:35] ℹ️  Order extraction - MRN: '101002392'
[02:44:35] ℹ️  Order extraction - Sex: ''
[02:44:35] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[02:44:35] ℹ️  Order extraction - Payer Source: ''
[02:44:35] ✅ Order data extraction completed successfully
[02:44:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:44:35] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[02:44:35] ℹ️  Inferred sex as FEMALE from name: Virginia
[02:44:35] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[02:44:35] ✅ Patient name cross-validation successful
[02:44:35] ✅    ✅ Data merged successfully
[02:44:36] ✅    ✅ Order data extracted and validated
[02:44:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:44:36] [DOC: 9251957] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[02:44:36] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[02:44:36] 🔄 
🔄 Step 6: Pushing order to API...
[02:44:36] [DOC: 9251957] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[02:44:37] [DOC: 9251957] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13406"}
[02:44:37] ❌    ❌ Failed to push order
[02:44:37] 🔄 
🔄 Step 7: Writing to CSV...
[02:44:37] [DOC: 9251957] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[02:44:37] [DOC: 9251957] ℹ️  Service Line extracted: 'Occupational Therapy'
[02:44:37] [DOC: 9251957] ℹ️  Payer Source extracted: ''
[02:44:37] [DOC: 9251957] ℹ️  Diagnosis codes being written:
[02:44:37] [DOC: 9251957] ℹ️    - Latest_Episode_Firstdiagnosis: 'N30.00'
[02:44:37] [DOC: 9251957] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[02:44:37] [DOC: 9251957] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[02:44:37] [DOC: 9251957] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:44:37] [DOC: 9251957] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:44:37] [DOC: 9251957] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:44:37] [DOC: 9251957] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: Occupational Therapy | Payer:  | MRN: 101002392
[02:44:37] ✅    ✅ Document 9251957 processed and saved successfully
[02:44:37] 🔄 
🔄 Step 8: Saving API details...
[02:44:37] [DOC: 9251957] ℹ️  API push details saved for document 9251957
[02:44:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251947                         ║
================================================================================
[02:44:37] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:44:37] ℹ️  Date: 04/21/2025
[02:44:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:44:44] [DOC: 9251947] ✅ Text extracted using pdfplumber (12667 chars)
[02:44:44] ✅    ✅ Text extracted using pdfplumber (12667 chars)
[02:44:44] 🔄 
🔄 Step 2: Extracting patient data...
[02:44:47] ℹ️  AI extracted raw sex value: 'F'
[02:44:47] ℹ️  AI extracted service line: 'OT'
[02:44:47] ℹ️  AI extracted payer source: ''
[02:44:47] ℹ️  AI extracted diagnoses:
[02:44:47] ℹ️    - Diagnosis 1: 'vertigo'
[02:44:47] ℹ️    - Diagnosis 2: 'muscle weakness'
[02:44:47] ℹ️    - Diagnosis 3: 'cirrhosis'
[02:44:47] ℹ️    - Diagnosis 4: 'arthritis'
[02:44:47] ℹ️    - Diagnosis 5: 'anxiety'
[02:44:47] ℹ️    - Diagnosis 6: ''
[02:44:47] ℹ️  Final extracted MRN: '101002392'
[02:44:47] ℹ️  Final extracted Sex: 'FEMALE'
[02:44:47] ℹ️  Final extracted Service Line: 'OT'
[02:44:47] ℹ️  Final extracted Payer Source: ''
[02:44:47] ✅ Patient data extraction completed successfully
[02:44:47] ✅    ✅ Patient data extracted successfully
[02:44:47] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/11/2025', 'endOfEpisode': None, 'firstDiagnosis': 'vertigo', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': 'cirrhosis', 'fourthDiagnosis': 'arthritis', 'fifthDiagnosis': 'anxiety', 'sixthDiagnosis': ''}]
[02:44:47] ✅    ✅ Patient identified: Virginia Brunton
[02:44:47] ✅    ✅ Patient name validation passed
[02:44:47] 🔄 
🔄 Step 3: Processing patient dates...
[02:44:47] [DOC: 9251947] ℹ️  DOB normalized: 06/05/1940
[02:44:47] [DOC: 9251947] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[02:44:47] [DOC: 9251947] ✅ Patient date processing completed successfully
[02:44:47] ✅    ✅ Date processing completed
[02:44:47] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'firstDiagnosis': 'vertigo', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': 'cirrhosis', 'fourthDiagnosis': 'arthritis', 'fifthDiagnosis': 'anxiety', 'sixthDiagnosis': ''}]
[02:44:47] 🔄 
🔄 Step 4: Extracting order data...
[02:44:50] ℹ️  Order extraction - MRN: '101002392'
[02:44:50] ℹ️  Order extraction - Sex: 'FEMALE'
[02:44:50] ℹ️  Order extraction - Service Line: 'OT'
[02:44:50] ℹ️  Order extraction - Payer Source: ''
[02:44:50] ✅ Order data extraction completed successfully
[02:44:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:44:50] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[02:44:50] ℹ️  Service line consistent in both sources: 'OT'
[02:44:50] ✅ Patient name cross-validation successful
[02:44:50] ✅    ✅ Data merged successfully
[02:44:52] ✅    ✅ Order data extracted and validated
[02:44:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:44:52] [DOC: 9251947] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[02:44:52] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[02:44:52] 🔄 
🔄 Step 6: Pushing order to API...
[02:44:52] [DOC: 9251947] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[02:44:53] [DOC: 9251947] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:44:53] ❌    ❌ Failed to push order
[02:44:53] 🔄 
🔄 Step 7: Writing to CSV...
[02:44:53] [DOC: 9251947] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[02:44:53] [DOC: 9251947] ℹ️  Service Line extracted: 'OT'
[02:44:53] [DOC: 9251947] ℹ️  Payer Source extracted: ''
[02:44:53] [DOC: 9251947] ℹ️  Diagnosis codes being written:
[02:44:53] [DOC: 9251947] ℹ️    - Latest_Episode_Firstdiagnosis: 'vertigo'
[02:44:53] [DOC: 9251947] ℹ️    - Latest_Episode_Seconddiagnosis: 'muscle weakness'
[02:44:53] [DOC: 9251947] ℹ️    - Latest_Episode_Thirddiagnosis: 'cirrhosis'
[02:44:53] [DOC: 9251947] ℹ️    - Latest_Episode_Fourthdiagnosis: 'arthritis'
[02:44:53] [DOC: 9251947] ℹ️    - Latest_Episode_Fifthdiagnosis: 'anxiety'
[02:44:53] [DOC: 9251947] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:44:53] [DOC: 9251947] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: OT | Payer:  | MRN: 101002392
[02:44:53] ✅    ✅ Document 9251947 processed and saved successfully
[02:44:53] 🔄 
🔄 Step 8: Saving API details...
[02:44:53] [DOC: 9251947] ℹ️  API push details saved for document 9251947
[02:44:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251936                         ║
================================================================================
[02:44:53] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:44:53] ℹ️  Date: 04/21/2025
[02:44:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:44:57] [DOC: 9251936] ✅ Text extracted using pdfplumber (1469 chars)
[02:44:57] ✅    ✅ Text extracted using pdfplumber (1469 chars)
[02:44:57] 🔄 
🔄 Step 2: Extracting patient data...
[02:45:00] ℹ️  AI extracted raw sex value: ''
[02:45:00] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:45:00] ℹ️  AI extracted payer source: ''
[02:45:00] ℹ️  AI extracted diagnoses:
[02:45:00] ℹ️    - Diagnosis 1: 'N30.00'
[02:45:00] ℹ️    - Diagnosis 2: 'E11.9'
[02:45:00] ℹ️    - Diagnosis 3: 'F41.1'
[02:45:00] ℹ️    - Diagnosis 4: 'None'
[02:45:00] ℹ️    - Diagnosis 5: 'None'
[02:45:00] ℹ️    - Diagnosis 6: 'None'
[02:45:00] ℹ️  Final extracted MRN: '101002392'
[02:45:00] ℹ️  Final extracted Sex: ''
[02:45:00] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:45:00] ℹ️  Final extracted Payer Source: ''
[02:45:00] ✅ Patient data extraction completed successfully
[02:45:00] ✅    ✅ Patient data extracted successfully
[02:45:00] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:45:00] ✅    ✅ Patient identified: Virginia Brunton
[02:45:00] ✅    ✅ Patient name validation passed
[02:45:00] 🔄 
🔄 Step 3: Processing patient dates...
[02:45:00] [DOC: 9251936] ℹ️  DOB normalized: 06/05/1940
[02:45:00] [DOC: 9251936] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[02:45:00] [DOC: 9251936] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[02:45:00] [DOC: 9251936] ✅ Patient date processing completed successfully
[02:45:00] ✅    ✅ Date processing completed
[02:45:00] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1'}]
[02:45:00] 🔄 
🔄 Step 4: Extracting order data...
[02:45:02] ℹ️  Order extraction - MRN: '101002392'
[02:45:02] ℹ️  Order extraction - Sex: ''
[02:45:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:45:02] ℹ️  Order extraction - Payer Source: ''
[02:45:02] ✅ Order data extraction completed successfully
[02:45:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:45:02] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[02:45:02] ℹ️  Inferred sex as FEMALE from name: Virginia
[02:45:02] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:45:02] ✅ Patient name cross-validation successful
[02:45:02] ✅    ✅ Data merged successfully
[02:45:04] ✅    ✅ Order data extracted and validated
[02:45:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:45:04] [DOC: 9251936] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[02:45:04] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[02:45:04] 🔄 
🔄 Step 6: Pushing order to API...
[02:45:04] [DOC: 9251936] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[02:45:05] [DOC: 9251936] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13408"}
[02:45:05] ❌    ❌ Failed to push order
[02:45:05] 🔄 
🔄 Step 7: Writing to CSV...
[02:45:05] [DOC: 9251936] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[02:45:05] [DOC: 9251936] ℹ️  Service Line extracted: 'Skilled Nursing'
[02:45:05] [DOC: 9251936] ℹ️  Payer Source extracted: ''
[02:45:05] [DOC: 9251936] ℹ️  Diagnosis codes being written:
[02:45:05] [DOC: 9251936] ℹ️    - Latest_Episode_Firstdiagnosis: 'N30.00'
[02:45:05] [DOC: 9251936] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[02:45:05] [DOC: 9251936] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[02:45:05] [DOC: 9251936] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:45:05] [DOC: 9251936] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:45:05] [DOC: 9251936] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:45:05] [DOC: 9251936] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: Skilled Nursing | Payer:  | MRN: 101002392
[02:45:05] ✅    ✅ Document 9251936 processed and saved successfully
[02:45:05] 🔄 
🔄 Step 8: Saving API details...
[02:45:05] [DOC: 9251936] ℹ️  API push details saved for document 9251936
[02:45:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251931                         ║
================================================================================
[02:45:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:45:05] ℹ️  Date: 04/21/2025
[02:45:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:45:15] [DOC: 9251931] ✅ Text extracted using pdfplumber (1526 chars)
[02:45:15] ✅    ✅ Text extracted using pdfplumber (1526 chars)
[02:45:15] 🔄 
🔄 Step 2: Extracting patient data...
[02:45:18] ℹ️  AI extracted raw sex value: ''
[02:45:18] ℹ️  AI extracted service line: 'Occupational Therapy'
[02:45:18] ℹ️  AI extracted payer source: ''
[02:45:18] ℹ️  AI extracted diagnoses:
[02:45:18] ℹ️    - Diagnosis 1: 'I10'
[02:45:18] ℹ️    - Diagnosis 2: 'E05.90'
[02:45:18] ℹ️    - Diagnosis 3: 'E78.5'
[02:45:18] ℹ️    - Diagnosis 4: 'None'
[02:45:18] ℹ️    - Diagnosis 5: 'None'
[02:45:18] ℹ️    - Diagnosis 6: 'None'
[02:45:18] ℹ️  Final extracted MRN: 'MA211105042902'
[02:45:18] ℹ️  Final extracted Sex: ''
[02:45:18] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[02:45:18] ℹ️  Final extracted Payer Source: ''
[02:45:18] ✅ Patient data extraction completed successfully
[02:45:18] ✅    ✅ Patient data extracted successfully
[02:45:18] 📊 Patient Response
     └─ patientFName: Louisa
     └─ patientLName: Ramos
     └─ dob: 04/03/1929
     └─ patientSex: 
     └─ medicalRecordNo: MA211105042902
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E05.90', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:45:18] ✅    ✅ Patient identified: Louisa Ramos
[02:45:18] ✅    ✅ Patient name validation passed
[02:45:18] 🔄 
🔄 Step 3: Processing patient dates...
[02:45:18] [DOC: 9251931] ℹ️  DOB normalized: 04/03/1929
[02:45:18] [DOC: 9251931] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[02:45:18] [DOC: 9251931] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[02:45:18] [DOC: 9251931] ✅ Patient date processing completed successfully
[02:45:18] ✅    ✅ Date processing completed
[02:45:18] 📊 Processed Patient Data
     └─ patientFName: Louisa
     └─ patientLName: Ramos
     └─ dob: 04/03/1929
     └─ patientSex: 
     └─ medicalRecordNo: MA211105042902
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E05.90', 'thirdDiagnosis': 'E78.5'}]
[02:45:18] 🔄 
🔄 Step 4: Extracting order data...
[02:45:21] ℹ️  Order extraction - MRN: 'MA211105042902'
[02:45:21] ℹ️  Order extraction - Sex: ''
[02:45:21] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[02:45:21] ℹ️  Order extraction - Payer Source: ''
[02:45:21] ✅ Order data extraction completed successfully
[02:45:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:45:21] ℹ️  Using MRN from patient data: 'MA211105042902' over 'MA211105042902'
[02:45:21] ⚠️  Could not determine sex using any available method
[02:45:21] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[02:45:21] ✅ Patient name cross-validation successful
[02:45:21] ✅    ✅ Data merged successfully
[02:45:22] ✅    ✅ Order data extracted and validated
[02:45:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:45:36] [DOC: 9251931] ✅ Patient exists in API: Louisa Ramos, ID: 09ccab87-75ac-49b4-94be-64b9ffa095e7
[02:45:36] ✅    ✅ Existing patient found with ID: 09ccab87-75ac-49b4-94be-64b9ffa095e7
[02:45:36] 🔄 
🔄 Step 6: Pushing order to API...
[02:45:36] [DOC: 9251931] ℹ️  Pushing order via API for patient ID: 09ccab87-75ac-49b4-94be-64b9ffa095e7
[02:45:37] [DOC: 9251931] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13139"}
[02:45:37] ❌    ❌ Failed to push order
[02:45:37] 🔄 
🔄 Step 7: Writing to CSV...
[02:45:37] [DOC: 9251931] ℹ️  Calculated age: 96 from DOB: 04/03/1929
[02:45:37] [DOC: 9251931] ℹ️  Service Line extracted: 'Occupational Therapy'
[02:45:37] [DOC: 9251931] ℹ️  Payer Source extracted: ''
[02:45:37] [DOC: 9251931] ℹ️  Diagnosis codes being written:
[02:45:37] [DOC: 9251931] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[02:45:37] [DOC: 9251931] ℹ️    - Latest_Episode_Seconddiagnosis: 'E05.90'
[02:45:37] [DOC: 9251931] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[02:45:37] [DOC: 9251931] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:45:37] [DOC: 9251931] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:45:37] [DOC: 9251931] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:45:37] [DOC: 9251931] ✅ Patient data written to CSV: Louisa Ramos | Sex:  | Age: 96 | Service: Occupational Therapy | Payer:  | MRN: MA211105042902
[02:45:37] ✅    ✅ Document 9251931 processed and saved successfully
[02:45:37] 🔄 
🔄 Step 8: Saving API details...
[02:45:37] [DOC: 9251931] ℹ️  API push details saved for document 9251931
[02:45:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251926                         ║
================================================================================
[02:45:37] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:45:37] ℹ️  Date: 04/21/2025
[02:45:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:45:39] [DOC: 9251926] ✅ Text extracted using pdfplumber (1464 chars)
[02:45:39] ✅    ✅ Text extracted using pdfplumber (1464 chars)
[02:45:39] 🔄 
🔄 Step 2: Extracting patient data...
[02:45:42] ℹ️  AI extracted raw sex value: ''
[02:45:42] ℹ️  AI extracted service line: 'Physical Therapy'
[02:45:42] ℹ️  AI extracted payer source: ''
[02:45:42] ℹ️  AI extracted diagnoses:
[02:45:42] ℹ️    - Diagnosis 1: 'K25.9'
[02:45:42] ℹ️    - Diagnosis 2: 'D50.0'
[02:45:42] ℹ️    - Diagnosis 3: 'K50.90'
[02:45:42] ℹ️    - Diagnosis 4: ''
[02:45:42] ℹ️    - Diagnosis 5: ''
[02:45:42] ℹ️    - Diagnosis 6: ''
[02:45:42] ℹ️  Final extracted MRN: 'MA250328114901'
[02:45:42] ℹ️  Final extracted Sex: ''
[02:45:42] ℹ️  Final extracted Service Line: 'Physical Therapy'
[02:45:42] ℹ️  Final extracted Payer Source: ''
[02:45:42] ✅ Patient data extraction completed successfully
[02:45:42] ✅    ✅ Patient data extracted successfully
[02:45:42] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:45:42] ✅    ✅ Patient identified: Shirley Tavares
[02:45:42] ✅    ✅ Patient name validation passed
[02:45:42] 🔄 
🔄 Step 3: Processing patient dates...
[02:45:42] [DOC: 9251926] ℹ️  DOB normalized: 11/10/1949
[02:45:42] [DOC: 9251926] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[02:45:42] [DOC: 9251926] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[02:45:42] [DOC: 9251926] ✅ Patient date processing completed successfully
[02:45:42] ✅    ✅ Date processing completed
[02:45:42] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:45:42] 🔄 
🔄 Step 4: Extracting order data...
[02:45:45] ℹ️  Order extraction - MRN: 'MA250328114901'
[02:45:45] ℹ️  Order extraction - Sex: ''
[02:45:45] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[02:45:45] ℹ️  Order extraction - Payer Source: ''
[02:45:45] ✅ Order data extraction completed successfully
[02:45:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:45:45] ℹ️  Using MRN from patient data: 'MA250328114901' over 'MA250328114901'
[02:45:45] ⚠️  Could not determine sex using any available method
[02:45:45] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[02:45:45] ✅ Patient name cross-validation successful
[02:45:45] ✅    ✅ Data merged successfully
[02:45:46] ✅    ✅ Order data extracted and validated
[02:45:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:45:46] [DOC: 9251926] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[02:45:46] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[02:45:46] 🔄 
🔄 Step 6: Pushing order to API...
[02:45:46] [DOC: 9251926] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[02:45:47] [DOC: 9251926] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14228"}
[02:45:47] ❌    ❌ Failed to push order
[02:45:47] 🔄 
🔄 Step 7: Writing to CSV...
[02:45:47] [DOC: 9251926] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[02:45:47] [DOC: 9251926] ℹ️  Service Line extracted: 'Physical Therapy'
[02:45:47] [DOC: 9251926] ℹ️  Payer Source extracted: ''
[02:45:47] [DOC: 9251926] ℹ️  Diagnosis codes being written:
[02:45:47] [DOC: 9251926] ℹ️    - Latest_Episode_Firstdiagnosis: 'K25.9'
[02:45:47] [DOC: 9251926] ℹ️    - Latest_Episode_Seconddiagnosis: 'D50.0'
[02:45:47] [DOC: 9251926] ℹ️    - Latest_Episode_Thirddiagnosis: 'K50.90'
[02:45:47] [DOC: 9251926] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:45:47] [DOC: 9251926] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:45:47] [DOC: 9251926] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:45:47] [DOC: 9251926] ✅ Patient data written to CSV: Shirley Tavares | Sex:  | Age: 75 | Service: Physical Therapy | Payer:  | MRN: MA250328114901
[02:45:47] ✅    ✅ Document 9251926 processed and saved successfully
[02:45:47] 🔄 
🔄 Step 8: Saving API details...
[02:45:47] [DOC: 9251926] ℹ️  API push details saved for document 9251926
[02:45:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251922                         ║
================================================================================
[02:45:47] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:45:47] ℹ️  Date: 04/21/2025
[02:45:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:45:49] [DOC: 9251922] ✅ Text extracted using pdfplumber (2003 chars)
[02:45:49] ✅    ✅ Text extracted using pdfplumber (2003 chars)
[02:45:49] 🔄 
🔄 Step 2: Extracting patient data...
[02:45:52] ℹ️  AI extracted raw sex value: ''
[02:45:52] ℹ️  AI extracted service line: 'Physical Therapy'
[02:45:52] ℹ️  AI extracted payer source: ''
[02:45:52] ℹ️  AI extracted diagnoses:
[02:45:52] ℹ️    - Diagnosis 1: 'K25.9'
[02:45:52] ℹ️    - Diagnosis 2: 'D50.0'
[02:45:52] ℹ️    - Diagnosis 3: 'K50.90'
[02:45:52] ℹ️    - Diagnosis 4: 'None'
[02:45:52] ℹ️    - Diagnosis 5: 'None'
[02:45:52] ℹ️    - Diagnosis 6: 'None'
[02:45:52] ℹ️  Final extracted MRN: 'MA250328114901'
[02:45:52] ℹ️  Final extracted Sex: ''
[02:45:52] ℹ️  Final extracted Service Line: 'Physical Therapy'
[02:45:52] ℹ️  Final extracted Payer Source: ''
[02:45:52] ✅ Patient data extraction completed successfully
[02:45:52] ✅    ✅ Patient data extracted successfully
[02:45:52] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:45:52] ✅    ✅ Patient identified: Shirley Tavares
[02:45:52] ✅    ✅ Patient name validation passed
[02:45:52] 🔄 
🔄 Step 3: Processing patient dates...
[02:45:52] [DOC: 9251922] ℹ️  DOB normalized: 11/10/1949
[02:45:52] [DOC: 9251922] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[02:45:52] [DOC: 9251922] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[02:45:52] [DOC: 9251922] ✅ Patient date processing completed successfully
[02:45:52] ✅    ✅ Date processing completed
[02:45:52] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90'}]
[02:45:52] 🔄 
🔄 Step 4: Extracting order data...
[02:45:55] ℹ️  Order extraction - MRN: 'MA250328114901'
[02:45:55] ℹ️  Order extraction - Sex: ''
[02:45:55] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[02:45:55] ℹ️  Order extraction - Payer Source: ''
[02:45:55] ✅ Order data extraction completed successfully
[02:45:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:45:55] ℹ️  Using MRN from patient data: 'MA250328114901' over 'MA250328114901'
[02:45:55] ⚠️  Could not determine sex using any available method
[02:45:55] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[02:45:55] ✅ Patient name cross-validation successful
[02:45:55] ✅    ✅ Data merged successfully
[02:45:56] ✅    ✅ Order data extracted and validated
[02:45:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:45:56] [DOC: 9251922] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[02:45:56] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[02:45:56] 🔄 
🔄 Step 6: Pushing order to API...
[02:45:56] [DOC: 9251922] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[02:45:57] [DOC: 9251922] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14229"}
[02:45:57] ❌    ❌ Failed to push order
[02:45:57] 🔄 
🔄 Step 7: Writing to CSV...
[02:45:57] [DOC: 9251922] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[02:45:57] [DOC: 9251922] ℹ️  Service Line extracted: 'Physical Therapy'
[02:45:57] [DOC: 9251922] ℹ️  Payer Source extracted: ''
[02:45:57] [DOC: 9251922] ℹ️  Diagnosis codes being written:
[02:45:57] [DOC: 9251922] ℹ️    - Latest_Episode_Firstdiagnosis: 'K25.9'
[02:45:57] [DOC: 9251922] ℹ️    - Latest_Episode_Seconddiagnosis: 'D50.0'
[02:45:57] [DOC: 9251922] ℹ️    - Latest_Episode_Thirddiagnosis: 'K50.90'
[02:45:57] [DOC: 9251922] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:45:57] [DOC: 9251922] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:45:57] [DOC: 9251922] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:45:57] [DOC: 9251922] ✅ Patient data written to CSV: Shirley Tavares | Sex:  | Age: 75 | Service: Physical Therapy | Payer:  | MRN: MA250328114901
[02:45:57] ✅    ✅ Document 9251922 processed and saved successfully
[02:45:57] 🔄 
🔄 Step 8: Saving API details...
[02:45:57] [DOC: 9251922] ℹ️  API push details saved for document 9251922
[02:45:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251920                         ║
================================================================================
[02:45:57] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:45:57] ℹ️  Date: 04/21/2025
[02:45:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:46:00] [DOC: 9251920] ✅ Text extracted using pdfplumber (1260 chars)
[02:46:00] ✅    ✅ Text extracted using pdfplumber (1260 chars)
[02:46:00] 🔄 
🔄 Step 2: Extracting patient data...
[02:46:03] ℹ️  AI extracted raw sex value: ''
[02:46:03] ℹ️  AI extracted service line: 'Occupational Therapy'
[02:46:03] ℹ️  AI extracted payer source: ''
[02:46:03] ℹ️  AI extracted diagnoses:
[02:46:03] ℹ️    - Diagnosis 1: 'K25.9'
[02:46:03] ℹ️    - Diagnosis 2: 'D50.0'
[02:46:03] ℹ️    - Diagnosis 3: 'K50.90'
[02:46:03] ℹ️    - Diagnosis 4: ''
[02:46:03] ℹ️    - Diagnosis 5: ''
[02:46:03] ℹ️    - Diagnosis 6: ''
[02:46:03] ℹ️  Final extracted MRN: 'MA250328114901'
[02:46:03] ℹ️  Final extracted Sex: ''
[02:46:03] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[02:46:03] ℹ️  Final extracted Payer Source: ''
[02:46:03] ✅ Patient data extraction completed successfully
[02:46:03] ✅    ✅ Patient data extracted successfully
[02:46:03] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:46:03] ✅    ✅ Patient identified: Shirley Tavares
[02:46:03] ✅    ✅ Patient name validation passed
[02:46:03] 🔄 
🔄 Step 3: Processing patient dates...
[02:46:03] [DOC: 9251920] ℹ️  DOB normalized: 11/10/1949
[02:46:03] [DOC: 9251920] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[02:46:03] [DOC: 9251920] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[02:46:03] [DOC: 9251920] ✅ Patient date processing completed successfully
[02:46:03] ✅    ✅ Date processing completed
[02:46:03] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:46:03] 🔄 
🔄 Step 4: Extracting order data...
[02:46:06] ℹ️  Order extraction - MRN: 'MA250328114901'
[02:46:06] ℹ️  Order extraction - Sex: ''
[02:46:06] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[02:46:06] ℹ️  Order extraction - Payer Source: ''
[02:46:06] ✅ Order data extraction completed successfully
[02:46:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:46:06] ℹ️  Using MRN from patient data: 'MA250328114901' over 'MA250328114901'
[02:46:06] ⚠️  Could not determine sex using any available method
[02:46:06] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[02:46:06] ✅ Patient name cross-validation successful
[02:46:06] ✅    ✅ Data merged successfully
[02:46:07] ✅    ✅ Order data extracted and validated
[02:46:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:46:07] [DOC: 9251920] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[02:46:07] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[02:46:07] 🔄 
🔄 Step 6: Pushing order to API...
[02:46:07] [DOC: 9251920] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[02:46:08] [DOC: 9251920] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14230"}
[02:46:08] ❌    ❌ Failed to push order
[02:46:08] 🔄 
🔄 Step 7: Writing to CSV...
[02:46:08] [DOC: 9251920] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[02:46:08] [DOC: 9251920] ℹ️  Service Line extracted: 'Occupational Therapy'
[02:46:08] [DOC: 9251920] ℹ️  Payer Source extracted: ''
[02:46:08] [DOC: 9251920] ℹ️  Diagnosis codes being written:
[02:46:08] [DOC: 9251920] ℹ️    - Latest_Episode_Firstdiagnosis: 'K25.9'
[02:46:08] [DOC: 9251920] ℹ️    - Latest_Episode_Seconddiagnosis: 'D50.0'
[02:46:08] [DOC: 9251920] ℹ️    - Latest_Episode_Thirddiagnosis: 'K50.90'
[02:46:08] [DOC: 9251920] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:46:08] [DOC: 9251920] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:46:08] [DOC: 9251920] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:46:08] [DOC: 9251920] ✅ Patient data written to CSV: Shirley Tavares | Sex:  | Age: 75 | Service: Occupational Therapy | Payer:  | MRN: MA250328114901
[02:46:08] ✅    ✅ Document 9251920 processed and saved successfully
[02:46:08] 🔄 
🔄 Step 8: Saving API details...
[02:46:08] [DOC: 9251920] ℹ️  API push details saved for document 9251920
[02:46:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251915                         ║
================================================================================
[02:46:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:46:08] ℹ️  Date: 04/21/2025
[02:46:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:46:13] [DOC: 9251915] ✅ Text extracted using pdfplumber (2765 chars)
[02:46:13] ✅    ✅ Text extracted using pdfplumber (2765 chars)
[02:46:13] 🔄 
🔄 Step 2: Extracting patient data...
[02:46:16] ℹ️  AI extracted raw sex value: ''
[02:46:16] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:46:16] ℹ️  AI extracted payer source: ''
[02:46:16] ℹ️  AI extracted diagnoses:
[02:46:16] ℹ️    - Diagnosis 1: 'K25.9'
[02:46:16] ℹ️    - Diagnosis 2: 'D50.0'
[02:46:16] ℹ️    - Diagnosis 3: 'K50.90'
[02:46:16] ℹ️    - Diagnosis 4: 'None'
[02:46:16] ℹ️    - Diagnosis 5: 'None'
[02:46:16] ℹ️    - Diagnosis 6: 'None'
[02:46:16] ℹ️  Final extracted MRN: 'MA250328114901'
[02:46:16] ℹ️  Final extracted Sex: ''
[02:46:16] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:46:16] ℹ️  Final extracted Payer Source: ''
[02:46:16] ✅ Patient data extraction completed successfully
[02:46:16] ✅    ✅ Patient data extracted successfully
[02:46:16] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:46:16] ✅    ✅ Patient identified: Shirley Tavares
[02:46:16] ✅    ✅ Patient name validation passed
[02:46:16] 🔄 
🔄 Step 3: Processing patient dates...
[02:46:16] [DOC: 9251915] ℹ️  DOB normalized: 11/10/1949
[02:46:16] [DOC: 9251915] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[02:46:16] [DOC: 9251915] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[02:46:16] [DOC: 9251915] ✅ Patient date processing completed successfully
[02:46:16] ✅    ✅ Date processing completed
[02:46:16] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90'}]
[02:46:16] 🔄 
🔄 Step 4: Extracting order data...
[02:46:18] ℹ️  Order extraction - MRN: 'MA250328114901'
[02:46:18] ℹ️  Order extraction - Sex: ''
[02:46:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:46:18] ℹ️  Order extraction - Payer Source: ''
[02:46:18] ✅ Order data extraction completed successfully
[02:46:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:46:18] ℹ️  Using MRN from patient data: 'MA250328114901' over 'MA250328114901'
[02:46:18] ⚠️  Could not determine sex using any available method
[02:46:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:46:18] ✅ Patient name cross-validation successful
[02:46:18] ✅    ✅ Data merged successfully
[02:46:20] ✅    ✅ Order data extracted and validated
[02:46:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:46:20] [DOC: 9251915] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[02:46:20] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[02:46:20] 🔄 
🔄 Step 6: Pushing order to API...
[02:46:20] [DOC: 9251915] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[02:46:21] [DOC: 9251915] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14231"}
[02:46:21] ❌    ❌ Failed to push order
[02:46:21] 🔄 
🔄 Step 7: Writing to CSV...
[02:46:21] [DOC: 9251915] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[02:46:21] [DOC: 9251915] ℹ️  Service Line extracted: 'Skilled Nursing'
[02:46:21] [DOC: 9251915] ℹ️  Payer Source extracted: ''
[02:46:21] [DOC: 9251915] ℹ️  Diagnosis codes being written:
[02:46:21] [DOC: 9251915] ℹ️    - Latest_Episode_Firstdiagnosis: 'K25.9'
[02:46:21] [DOC: 9251915] ℹ️    - Latest_Episode_Seconddiagnosis: 'D50.0'
[02:46:21] [DOC: 9251915] ℹ️    - Latest_Episode_Thirddiagnosis: 'K50.90'
[02:46:21] [DOC: 9251915] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:46:21] [DOC: 9251915] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:46:21] [DOC: 9251915] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:46:21] [DOC: 9251915] ✅ Patient data written to CSV: Shirley Tavares | Sex:  | Age: 75 | Service: Skilled Nursing | Payer:  | MRN: MA250328114901
[02:46:21] ✅    ✅ Document 9251915 processed and saved successfully
[02:46:21] 🔄 
🔄 Step 8: Saving API details...
[02:46:21] [DOC: 9251915] ℹ️  API push details saved for document 9251915
[02:46:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251877                         ║
================================================================================
[02:46:21] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:46:21] ℹ️  Date: 04/21/2025
[02:46:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:46:25] [DOC: 9251877] ✅ Text extracted using pdfplumber (12825 chars)
[02:46:25] ✅    ✅ Text extracted using pdfplumber (12825 chars)
[02:46:25] 🔄 
🔄 Step 2: Extracting patient data...
[02:46:28] ℹ️  AI extracted raw sex value: 'F'
[02:46:28] ℹ️  AI extracted service line: 'OT'
[02:46:28] ℹ️  AI extracted payer source: ''
[02:46:28] ℹ️  AI extracted diagnoses:
[02:46:28] ℹ️    - Diagnosis 1: 'G31.82'
[02:46:28] ℹ️    - Diagnosis 2: 'C50.91'
[02:46:28] ℹ️    - Diagnosis 3: ''
[02:46:28] ℹ️    - Diagnosis 4: ''
[02:46:28] ℹ️    - Diagnosis 5: ''
[02:46:28] ℹ️    - Diagnosis 6: ''
[02:46:28] ℹ️  Final extracted MRN: 'MA210121015502'
[02:46:28] ℹ️  Final extracted Sex: 'FEMALE'
[02:46:28] ℹ️  Final extracted Service Line: 'OT'
[02:46:28] ℹ️  Final extracted Payer Source: ''
[02:46:28] ✅ Patient data extraction completed successfully
[02:46:28] ✅    ✅ Patient data extracted successfully
[02:46:28] 📊 Patient Response
     └─ patientFName: Louise
     └─ patientLName: Rivard
     └─ dob: 01/26/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210121015502
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/15/2024', 'endOfEpisode': '', 'firstDiagnosis': 'G31.82', 'secondDiagnosis': 'C50.91', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:46:28] ✅    ✅ Patient identified: Louise Rivard
[02:46:28] ✅    ✅ Patient name validation passed
[02:46:28] 🔄 
🔄 Step 3: Processing patient dates...
[02:46:28] [DOC: 9251877] ℹ️  DOB normalized: 01/26/1955
[02:46:28] [DOC: 9251877] ℹ️  Episode startOfEpisode normalized: 05/15/2024
[02:46:28] [DOC: 9251877] ✅ Patient date processing completed successfully
[02:46:28] ✅    ✅ Date processing completed
[02:46:28] 📊 Processed Patient Data
     └─ patientFName: Louise
     └─ patientLName: Rivard
     └─ dob: 01/26/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210121015502
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/15/2024', 'endOfEpisode': '', 'firstDiagnosis': 'G31.82', 'secondDiagnosis': 'C50.91', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:46:28] 🔄 
🔄 Step 4: Extracting order data...
[02:46:31] ℹ️  Order extraction - MRN: 'MA210121015502'
[02:46:31] ℹ️  Order extraction - Sex: 'FEMALE'
[02:46:31] ℹ️  Order extraction - Service Line: 'OT'
[02:46:31] ℹ️  Order extraction - Payer Source: ''
[02:46:31] ✅ Order data extraction completed successfully
[02:46:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:46:31] ℹ️  Using MRN from patient data: 'MA210121015502' over 'MA210121015502'
[02:46:31] ℹ️  Service line consistent in both sources: 'OT'
[02:46:31] ✅ Patient name cross-validation successful
[02:46:31] ✅    ✅ Data merged successfully
[02:46:32] ⚠️     ❌ Skipping - missing episode start date
[02:46:32] [DOC: 9251877] ℹ️  API push details saved for document 9251877
================================================================================
║                        Processing Document ID: 9251871                         ║
================================================================================
[02:46:32] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:46:32] ℹ️  Date: 04/21/2025
[02:46:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:46:35] [DOC: 9251871] ✅ Text extracted using pdfplumber (9022 chars)
[02:46:35] ✅    ✅ Text extracted using pdfplumber (9022 chars)
[02:46:35] 🔄 
🔄 Step 2: Extracting patient data...
[02:46:37] ℹ️  AI extracted raw sex value: ''
[02:46:37] ℹ️  AI extracted service line: 'ST'
[02:46:37] ℹ️  AI extracted payer source: ''
[02:46:37] ℹ️  AI extracted diagnoses:
[02:46:37] ℹ️    - Diagnosis 1: 'None'
[02:46:37] ℹ️    - Diagnosis 2: 'None'
[02:46:37] ℹ️    - Diagnosis 3: 'None'
[02:46:37] ℹ️    - Diagnosis 4: 'None'
[02:46:37] ℹ️    - Diagnosis 5: 'None'
[02:46:37] ℹ️    - Diagnosis 6: 'None'
[02:46:37] ℹ️  Final extracted MRN: 'MA210121015502'
[02:46:37] ℹ️  Final extracted Sex: ''
[02:46:37] ℹ️  Final extracted Service Line: 'ST'
[02:46:37] ℹ️  Final extracted Payer Source: ''
[02:46:37] ✅ Patient data extraction completed successfully
[02:46:37] ✅    ✅ Patient data extracted successfully
[02:46:37] 📊 Patient Response
     └─ patientFName: Louise
     └─ patientLName: Rivard
     └─ dob: 01/26/1955
     └─ patientSex: 
     └─ medicalRecordNo: MA210121015502
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:46:37] ✅    ✅ Patient identified: Louise Rivard
[02:46:37] ✅    ✅ Patient name validation passed
[02:46:37] 🔄 
🔄 Step 3: Processing patient dates...
[02:46:37] [DOC: 9251871] ℹ️  DOB normalized: 01/26/1955
[02:46:37] [DOC: 9251871] ✅ Patient date processing completed successfully
[02:46:37] ✅    ✅ Date processing completed
[02:46:37] 📊 Processed Patient Data
     └─ patientFName: Louise
     └─ patientLName: Rivard
     └─ dob: 01/26/1955
     └─ patientSex: 
     └─ medicalRecordNo: MA210121015502
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[02:46:37] 🔄 
🔄 Step 4: Extracting order data...
[02:46:40] ℹ️  Order extraction - MRN: 'MA210121015502'
[02:46:40] ℹ️  Order extraction - Sex: ''
[02:46:40] ℹ️  Order extraction - Service Line: 'ST'
[02:46:40] ℹ️  Order extraction - Payer Source: ''
[02:46:40] ✅ Order data extraction completed successfully
[02:46:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:46:40] ℹ️  Using MRN from patient data: 'MA210121015502' over 'MA210121015502'
[02:46:40] ⚠️  Could not determine sex using any available method
[02:46:40] ℹ️  Service line consistent in both sources: 'ST'
[02:46:40] ✅ Patient name cross-validation successful
[02:46:40] ✅    ✅ Data merged successfully
[02:46:41] ⚠️     ❌ Skipping - missing episode start date
[02:46:41] [DOC: 9251871] ℹ️  API push details saved for document 9251871
================================================================================
║                        Processing Document ID: 9251867                         ║
================================================================================
[02:46:41] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:46:41] ℹ️  Date: 04/21/2025
[02:46:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:46:45] [DOC: 9251867] ✅ Text extracted using pdfplumber (17807 chars)
[02:46:45] ✅    ✅ Text extracted using pdfplumber (17807 chars)
[02:46:45] 🔄 
🔄 Step 2: Extracting patient data...
[02:46:48] ℹ️  AI extracted raw sex value: 'F'
[02:46:48] ℹ️  AI extracted service line: 'PT'
[02:46:48] ℹ️  AI extracted payer source: ''
[02:46:48] ℹ️  AI extracted diagnoses:
[02:46:48] ℹ️    - Diagnosis 1: 'G31.83'
[02:46:48] ℹ️    - Diagnosis 2: 'C50.91'
[02:46:48] ℹ️    - Diagnosis 3: ''
[02:46:48] ℹ️    - Diagnosis 4: ''
[02:46:48] ℹ️    - Diagnosis 5: ''
[02:46:48] ℹ️    - Diagnosis 6: ''
[02:46:48] ℹ️  Final extracted MRN: 'MA210121015502'
[02:46:48] ℹ️  Final extracted Sex: 'FEMALE'
[02:46:48] ℹ️  Final extracted Service Line: 'PT'
[02:46:48] ℹ️  Final extracted Payer Source: ''
[02:46:48] ✅ Patient data extraction completed successfully
[02:46:48] ✅    ✅ Patient data extracted successfully
[02:46:48] 📊 Patient Response
     └─ patientFName: Louise
     └─ patientLName: Rivard
     └─ dob: 01/26/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210121015502
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '', 'firstDiagnosis': 'G31.83', 'secondDiagnosis': 'C50.91', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:46:48] ✅    ✅ Patient identified: Louise Rivard
[02:46:48] ✅    ✅ Patient name validation passed
[02:46:48] 🔄 
🔄 Step 3: Processing patient dates...
[02:46:48] [DOC: 9251867] ℹ️  DOB normalized: 01/26/1955
[02:46:48] [DOC: 9251867] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[02:46:48] [DOC: 9251867] ✅ Patient date processing completed successfully
[02:46:48] ✅    ✅ Date processing completed
[02:46:48] 📊 Processed Patient Data
     └─ patientFName: Louise
     └─ patientLName: Rivard
     └─ dob: 01/26/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210121015502
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '', 'firstDiagnosis': 'G31.83', 'secondDiagnosis': 'C50.91', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:46:48] 🔄 
🔄 Step 4: Extracting order data...
[02:46:51] ℹ️  Order extraction - MRN: 'MA210121015502'
[02:46:51] ℹ️  Order extraction - Sex: 'FEMALE'
[02:46:51] ℹ️  Order extraction - Service Line: 'PT'
[02:46:51] ℹ️  Order extraction - Payer Source: ''
[02:46:51] ✅ Order data extraction completed successfully
[02:46:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:46:51] ℹ️  Using MRN from patient data: 'MA210121015502' over 'MA210121015502'
[02:46:51] ℹ️  Service line consistent in both sources: 'PT'
[02:46:51] ✅ Patient name cross-validation successful
[02:46:51] ✅    ✅ Data merged successfully
[02:46:52] ⚠️     ❌ Skipping - missing episode start date
[02:46:52] [DOC: 9251867] ℹ️  API push details saved for document 9251867
================================================================================
║                        Processing Document ID: 9251858                         ║
================================================================================
[02:46:52] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:46:52] ℹ️  Date: 04/21/2025
[02:46:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:46:55] [DOC: 9251858] ✅ Text extracted using pdfplumber (12539 chars)
[02:46:55] ✅    ✅ Text extracted using pdfplumber (12539 chars)
[02:46:55] 🔄 
🔄 Step 2: Extracting patient data...
[02:46:58] ℹ️  AI extracted raw sex value: 'F'
[02:46:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:46:58] ℹ️  AI extracted payer source: 'Medicare'
[02:46:58] ℹ️  AI extracted diagnoses:
[02:46:58] ℹ️    - Diagnosis 1: 'F03.918'
[02:46:58] ℹ️    - Diagnosis 2: 'F33.1'
[02:46:58] ℹ️    - Diagnosis 3: 'I10'
[02:46:58] ℹ️    - Diagnosis 4: 'E11.9'
[02:46:58] ℹ️    - Diagnosis 5: 'I48.91'
[02:46:58] ℹ️    - Diagnosis 6: 'F41.9'
[02:46:58] ℹ️  Final extracted MRN: 'MA200723054001'
[02:46:58] ℹ️  Final extracted Sex: 'FEMALE'
[02:46:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:46:58] ℹ️  Final extracted Payer Source: 'Medicare'
[02:46:58] ✅ Patient data extraction completed successfully
[02:46:58] ✅    ✅ Patient data extracted successfully
[02:46:58] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Pimentel
     └─ dob: 05/19/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA200723054001
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 1881923936
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 40 Nelson St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: None
     └─ phoneNumber: (508) 961-9339
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/22/2020', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'F03.918', 'secondDiagnosis': 'F33.1', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'F41.9'}]
[02:46:58] ✅    ✅ Patient identified: Maria Pimentel
[02:46:58] ✅    ✅ Patient name validation passed
[02:46:58] 🔄 
🔄 Step 3: Processing patient dates...
[02:46:58] [DOC: 9251858] ℹ️  DOB normalized: 05/19/1940
[02:46:58] [DOC: 9251858] ℹ️  Episode startOfCare normalized: 08/22/2020
[02:46:58] [DOC: 9251858] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[02:46:58] [DOC: 9251858] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[02:46:58] [DOC: 9251858] ✅ Patient date processing completed successfully
[02:46:58] ✅    ✅ Date processing completed
[02:46:58] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Pimentel
     └─ dob: 05/19/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA200723054001
     └─ billingProvider: Dr. Afonso-Fede
     └─ npi: 1881923936
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 40 Nelson St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ phoneNumber: (508) 961-9339
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/22/2020', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'F03.918', 'secondDiagnosis': 'F33.1', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'F41.9'}]
[02:46:58] 🔄 
🔄 Step 4: Extracting order data...
[02:47:01] ℹ️  Order extraction - MRN: 'MA200723054001'
[02:47:01] ℹ️  Order extraction - Sex: 'FEMALE'
[02:47:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:47:01] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:47:01] ✅ Order data extraction completed successfully
[02:47:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:47:01] ℹ️  Using MRN from patient data: 'MA200723054001' over 'MA200723054001'
[02:47:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:47:01] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:47:01] ✅ Patient name cross-validation successful
[02:47:01] ✅    ✅ Data merged successfully
[02:47:02] ✅    ✅ Order data extracted and validated
[02:47:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:47:02] [DOC: 9251858] ✅ Patient found in local cache: Maria Pimentel, ID: ac4db870-01e5-4e22-b632-78fe9bfd6c8d
[02:47:02] ✅    ✅ Existing patient found with ID: ac4db870-01e5-4e22-b632-78fe9bfd6c8d
[02:47:02] 🔄 
🔄 Step 6: Pushing order to API...
[02:47:02] [DOC: 9251858] ℹ️  Pushing order via API for patient ID: ac4db870-01e5-4e22-b632-78fe9bfd6c8d
[02:47:03] [DOC: 9251858] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13071"}
[02:47:03] ❌    ❌ Failed to push order
[02:47:03] 🔄 
🔄 Step 7: Writing to CSV...
[02:47:03] [DOC: 9251858] ℹ️  Calculated age: 85 from DOB: 05/19/1940
[02:47:03] [DOC: 9251858] ℹ️  Service Line extracted: 'Skilled Nursing'
[02:47:03] [DOC: 9251858] ℹ️  Payer Source extracted: 'Medicare'
[02:47:03] [DOC: 9251858] ℹ️  Diagnosis codes being written:
[02:47:03] [DOC: 9251858] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.918'
[02:47:03] [DOC: 9251858] ℹ️    - Latest_Episode_Seconddiagnosis: 'F33.1'
[02:47:03] [DOC: 9251858] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[02:47:03] [DOC: 9251858] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.9'
[02:47:03] [DOC: 9251858] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I48.91'
[02:47:03] [DOC: 9251858] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[02:47:03] [DOC: 9251858] ✅ Patient data written to CSV: Maria Pimentel | Sex: FEMALE | Age: 85 | Service: Skilled Nursing | Payer: Medicare | MRN: MA200723054001
[02:47:03] ✅    ✅ Document 9251858 processed and saved successfully
[02:47:03] 🔄 
🔄 Step 8: Saving API details...
[02:47:03] [DOC: 9251858] ℹ️  API push details saved for document 9251858
[02:47:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9251851                         ║
================================================================================
[02:47:03] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:47:03] ℹ️  Date: 04/21/2025
[02:47:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:47:06] [DOC: 9251851] ✅ Text extracted using pdfplumber (1332 chars)
[02:47:06] ✅    ✅ Text extracted using pdfplumber (1332 chars)
[02:47:06] 🔄 
🔄 Step 2: Extracting patient data...
[02:47:09] ℹ️  AI extracted raw sex value: ''
[02:47:09] ℹ️  AI extracted service line: 'Speech Therapy'
[02:47:09] ℹ️  AI extracted payer source: ''
[02:47:09] ℹ️  AI extracted diagnoses:
[02:47:09] ℹ️    - Diagnosis 1: 'I95.1'
[02:47:09] ℹ️    - Diagnosis 2: 'E86.0'
[02:47:09] ℹ️    - Diagnosis 3: 'G30.1'
[02:47:09] ℹ️    - Diagnosis 4: 'None'
[02:47:09] ℹ️    - Diagnosis 5: 'None'
[02:47:09] ℹ️    - Diagnosis 6: 'None'
[02:47:09] ℹ️  Final extracted MRN: 'MA231101014802'
[02:47:09] ℹ️  Final extracted Sex: ''
[02:47:09] ℹ️  Final extracted Service Line: 'Speech Therapy'
[02:47:09] ℹ️  Final extracted Payer Source: ''
[02:47:09] ✅ Patient data extraction completed successfully
[02:47:09] ✅    ✅ Patient data extracted successfully
[02:47:09] 📊 Patient Response
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G30.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:47:09] ✅    ✅ Patient identified: Eduardo Medeiros
[02:47:09] ✅    ✅ Patient name validation passed
[02:47:09] 🔄 
🔄 Step 3: Processing patient dates...
[02:47:09] [DOC: 9251851] ℹ️  DOB normalized: 01/08/1948
[02:47:09] [DOC: 9251851] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[02:47:09] [DOC: 9251851] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[02:47:09] [DOC: 9251851] ✅ Patient date processing completed successfully
[02:47:09] ✅    ✅ Date processing completed
[02:47:09] 📊 Processed Patient Data
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G30.1'}]
[02:47:09] 🔄 
🔄 Step 4: Extracting order data...
[02:47:11] ℹ️  Order extraction - MRN: 'MA231101014802'
[02:47:11] ℹ️  Order extraction - Sex: ''
[02:47:11] ℹ️  Order extraction - Service Line: 'Speech Therapy'
[02:47:11] ℹ️  Order extraction - Payer Source: ''
[02:47:11] ✅ Order data extraction completed successfully
[02:47:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:47:11] ℹ️  Using MRN from patient data: 'MA231101014802' over 'MA231101014802'
[02:47:11] ⚠️  Could not determine sex using any available method
[02:47:11] ℹ️  Service line consistent in both sources: 'Speech Therapy'
[02:47:11] ✅ Patient name cross-validation successful
[02:47:11] ✅    ✅ Data merged successfully
[02:47:12] ✅    ✅ Order data extracted and validated
[02:47:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:47:21] [DOC: 9251851] ℹ️  Patient not found in cache or API: Eduardo Medeiros
[02:47:21] [DOC: 9251851] ℹ️  Patient not found, creating new patient via API...
[02:47:21] [DOC: 9251851] ℹ️  Creating patient via API: Eduardo Medeiros
[02:47:23] [DOC: 9251851] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:47:23] ❌    ❌ Failed to create patient
[02:47:23] [DOC: 9251851] ℹ️  API push details saved for document 9251851
================================================================================
║                        Processing Document ID: 9251847                         ║
================================================================================
[02:47:23] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:47:23] ℹ️  Date: 04/21/2025
[02:47:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:47:25] [DOC: 9251847] ✅ Text extracted using pdfplumber (1401 chars)
[02:47:25] ✅    ✅ Text extracted using pdfplumber (1401 chars)
[02:47:25] 🔄 
🔄 Step 2: Extracting patient data...
[02:47:28] ℹ️  AI extracted raw sex value: ''
[02:47:28] ℹ️  AI extracted service line: 'Occupational Therapy'
[02:47:28] ℹ️  AI extracted payer source: ''
[02:47:28] ℹ️  AI extracted diagnoses:
[02:47:28] ℹ️    - Diagnosis 1: 'I95.1'
[02:47:28] ℹ️    - Diagnosis 2: 'E86.0'
[02:47:28] ℹ️    - Diagnosis 3: 'G30.1'
[02:47:28] ℹ️    - Diagnosis 4: 'None'
[02:47:28] ℹ️    - Diagnosis 5: 'None'
[02:47:28] ℹ️    - Diagnosis 6: 'None'
[02:47:28] ℹ️  Final extracted MRN: 'MA231101014802'
[02:47:28] ℹ️  Final extracted Sex: ''
[02:47:28] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[02:47:28] ℹ️  Final extracted Payer Source: ''
[02:47:28] ✅ Patient data extraction completed successfully
[02:47:28] ✅    ✅ Patient data extracted successfully
[02:47:28] 📊 Patient Response
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G30.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:47:28] ✅    ✅ Patient identified: Eduardo Medeiros
[02:47:28] ✅    ✅ Patient name validation passed
[02:47:28] 🔄 
🔄 Step 3: Processing patient dates...
[02:47:28] [DOC: 9251847] ℹ️  DOB normalized: 01/08/1948
[02:47:28] [DOC: 9251847] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[02:47:28] [DOC: 9251847] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[02:47:28] [DOC: 9251847] ✅ Patient date processing completed successfully
[02:47:28] ✅    ✅ Date processing completed
[02:47:28] 📊 Processed Patient Data
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G30.1'}]
[02:47:28] 🔄 
🔄 Step 4: Extracting order data...
[02:47:31] ℹ️  Order extraction - MRN: 'MA231101014802'
[02:47:31] ℹ️  Order extraction - Sex: ''
[02:47:31] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[02:47:31] ℹ️  Order extraction - Payer Source: ''
[02:47:31] ✅ Order data extraction completed successfully
[02:47:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:47:31] ℹ️  Using MRN from patient data: 'MA231101014802' over 'MA231101014802'
[02:47:31] ⚠️  Could not determine sex using any available method
[02:47:31] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[02:47:31] ✅ Patient name cross-validation successful
[02:47:31] ✅    ✅ Data merged successfully
[02:47:32] ✅    ✅ Order data extracted and validated
[02:47:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:47:49] [DOC: 9251847] ℹ️  Patient not found in cache or API: Eduardo Medeiros
[02:47:49] [DOC: 9251847] ℹ️  Patient not found, creating new patient via API...
[02:47:49] [DOC: 9251847] ℹ️  Creating patient via API: Eduardo Medeiros
[02:47:51] [DOC: 9251847] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:47:51] ❌    ❌ Failed to create patient
[02:47:51] [DOC: 9251847] ℹ️  API push details saved for document 9251847
================================================================================
║                        Processing Document ID: 9251843                         ║
================================================================================
[02:47:51] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:47:51] ℹ️  Date: 04/21/2025
[02:47:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:47:53] [DOC: 9251843] ✅ Text extracted using pdfplumber (1447 chars)
[02:47:53] ✅    ✅ Text extracted using pdfplumber (1447 chars)
[02:47:53] 🔄 
🔄 Step 2: Extracting patient data...
[02:47:56] ℹ️  AI extracted raw sex value: ''
[02:47:56] ℹ️  AI extracted service line: 'Physical Therapy'
[02:47:56] ℹ️  AI extracted payer source: ''
[02:47:56] ℹ️  AI extracted diagnoses:
[02:47:56] ℹ️    - Diagnosis 1: 'I95.1'
[02:47:56] ℹ️    - Diagnosis 2: 'E86.0'
[02:47:56] ℹ️    - Diagnosis 3: 'G30.1'
[02:47:56] ℹ️    - Diagnosis 4: 'None'
[02:47:56] ℹ️    - Diagnosis 5: 'None'
[02:47:56] ℹ️    - Diagnosis 6: 'None'
[02:47:56] ℹ️  Final extracted MRN: 'MA231101014802'
[02:47:56] ℹ️  Final extracted Sex: ''
[02:47:56] ℹ️  Final extracted Service Line: 'Physical Therapy'
[02:47:56] ℹ️  Final extracted Payer Source: ''
[02:47:56] ✅ Patient data extraction completed successfully
[02:47:56] ✅    ✅ Patient data extracted successfully
[02:47:56] 📊 Patient Response
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G30.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:47:56] ✅    ✅ Patient identified: Eduardo Medeiros
[02:47:56] ✅    ✅ Patient name validation passed
[02:47:56] 🔄 
🔄 Step 3: Processing patient dates...
[02:47:56] [DOC: 9251843] ℹ️  DOB normalized: 01/08/1948
[02:47:56] [DOC: 9251843] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[02:47:56] [DOC: 9251843] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[02:47:56] [DOC: 9251843] ✅ Patient date processing completed successfully
[02:47:56] ✅    ✅ Date processing completed
[02:47:56] 📊 Processed Patient Data
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G30.1'}]
[02:47:56] 🔄 
🔄 Step 4: Extracting order data...
[02:48:01] ℹ️  Order extraction - MRN: 'MA231101014802'
[02:48:01] ℹ️  Order extraction - Sex: ''
[02:48:01] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[02:48:01] ℹ️  Order extraction - Payer Source: ''
[02:48:01] ✅ Order data extraction completed successfully
[02:48:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:48:01] ℹ️  Using MRN from patient data: 'MA231101014802' over 'MA231101014802'
[02:48:01] ⚠️  Could not determine sex using any available method
[02:48:01] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[02:48:01] ✅ Patient name cross-validation successful
[02:48:01] ✅    ✅ Data merged successfully
[02:48:02] ✅    ✅ Order data extracted and validated
[02:48:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:49:02] [DOC: 9251843] ℹ️  Patient not found in cache or API: Eduardo Medeiros
[02:49:02] [DOC: 9251843] ℹ️  Patient not found, creating new patient via API...
[02:49:02] [DOC: 9251843] ℹ️  Creating patient via API: Eduardo Medeiros
[02:49:03] [DOC: 9251843] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:49:03] ❌    ❌ Failed to create patient
[02:49:03] [DOC: 9251843] ℹ️  API push details saved for document 9251843
================================================================================
║                        Processing Document ID: 9251836                         ║
================================================================================
[02:49:03] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:49:03] ℹ️  Date: 04/21/2025
[02:49:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:49:08] [DOC: 9251836] ✅ Text extracted using pdfplumber (1000 chars)
[02:49:08] ✅    ✅ Text extracted using pdfplumber (1000 chars)
[02:49:08] 🔄 
🔄 Step 2: Extracting patient data...
[02:49:11] ℹ️  AI extracted raw sex value: ''
[02:49:11] ℹ️  AI extracted service line: 'LPN'
[02:49:11] ℹ️  AI extracted payer source: ''
[02:49:11] ℹ️  AI extracted diagnoses:
[02:49:11] ℹ️    - Diagnosis 1: 'I95.1'
[02:49:11] ℹ️    - Diagnosis 2: 'E86.0'
[02:49:11] ℹ️    - Diagnosis 3: 'G30.1'
[02:49:11] ℹ️    - Diagnosis 4: ''
[02:49:11] ℹ️    - Diagnosis 5: ''
[02:49:11] ℹ️    - Diagnosis 6: ''
[02:49:11] ℹ️  Final extracted MRN: 'MA231101014802'
[02:49:11] ℹ️  Final extracted Sex: ''
[02:49:11] ℹ️  Final extracted Service Line: 'LPN'
[02:49:11] ℹ️  Final extracted Payer Source: ''
[02:49:11] ✅ Patient data extraction completed successfully
[02:49:11] ✅    ✅ Patient data extracted successfully
[02:49:11] 📊 Patient Response
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G30.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:49:11] ✅    ✅ Patient identified: Eduardo Medeiros
[02:49:11] ✅    ✅ Patient name validation passed
[02:49:11] 🔄 
🔄 Step 3: Processing patient dates...
[02:49:11] [DOC: 9251836] ℹ️  DOB normalized: 01/08/1948
[02:49:11] [DOC: 9251836] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[02:49:11] [DOC: 9251836] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[02:49:11] [DOC: 9251836] ✅ Patient date processing completed successfully
[02:49:11] ✅    ✅ Date processing completed
[02:49:11] 📊 Processed Patient Data
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G30.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:49:11] 🔄 
🔄 Step 4: Extracting order data...
[02:49:14] ℹ️  Order extraction - MRN: 'MA231101014802'
[02:49:14] ℹ️  Order extraction - Sex: ''
[02:49:14] ℹ️  Order extraction - Service Line: 'Nursing'
[02:49:14] ℹ️  Order extraction - Payer Source: ''
[02:49:14] ✅ Order data extraction completed successfully
[02:49:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:49:14] ℹ️  Using MRN from patient data: 'MA231101014802' over 'MA231101014802'
[02:49:14] ⚠️  Could not determine sex using any available method
[02:49:14] ℹ️  Combined service lines: Patient='LPN' + Order='Nursing' = 'LPN, Nursing'
[02:49:14] ✅ Patient name cross-validation successful
[02:49:14] ✅    ✅ Data merged successfully
[02:49:15] ✅    ✅ Order data extracted and validated
[02:49:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:50:14] [DOC: 9251836] ℹ️  Patient not found in cache or API: Eduardo Medeiros
[02:50:14] [DOC: 9251836] ℹ️  Patient not found, creating new patient via API...
[02:50:14] [DOC: 9251836] ℹ️  Creating patient via API: Eduardo Medeiros
[02:50:15] [DOC: 9251836] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:50:15] ❌    ❌ Failed to create patient
[02:50:15] [DOC: 9251836] ℹ️  API push details saved for document 9251836
================================================================================
║                        Processing Document ID: 9251832                         ║
================================================================================
[02:50:15] ℹ️  Agency: Compassionate Care Hospice-Taunton
[02:50:15] ℹ️  Date: 04/21/2025
[02:50:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:50:16] [DOC: 9251832] ❌ Critical failure in get_pdf_text: Invalid response format
[02:50:16] ❌ Failed to extract text for Doc ID 9251832
[02:50:16] [DOC: 9251832] ℹ️  API push details saved for document 9251832
================================================================================
║                        Processing Document ID: 9251830                         ║
================================================================================
[02:50:16] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:50:16] ℹ️  Date: 04/21/2025
[02:50:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:50:22] [DOC: 9251830] ✅ Text extracted using pdfplumber (1535 chars)
[02:50:22] ✅    ✅ Text extracted using pdfplumber (1535 chars)
[02:50:22] 🔄 
🔄 Step 2: Extracting patient data...
[02:50:25] ℹ️  AI extracted raw sex value: ''
[02:50:25] ℹ️  AI extracted service line: 'Occupational Therapy'
[02:50:25] ℹ️  AI extracted payer source: ''
[02:50:25] ℹ️  AI extracted diagnoses:
[02:50:25] ℹ️    - Diagnosis 1: 'I95.1'
[02:50:25] ℹ️    - Diagnosis 2: 'E86.0'
[02:50:25] ℹ️    - Diagnosis 3: 'G30.1'
[02:50:25] ℹ️    - Diagnosis 4: 'None'
[02:50:25] ℹ️    - Diagnosis 5: 'None'
[02:50:25] ℹ️    - Diagnosis 6: 'None'
[02:50:25] ℹ️  Final extracted MRN: 'MA231101014802'
[02:50:25] ℹ️  Final extracted Sex: ''
[02:50:25] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[02:50:25] ℹ️  Final extracted Payer Source: ''
[02:50:25] ✅ Patient data extraction completed successfully
[02:50:25] ✅    ✅ Patient data extracted successfully
[02:50:25] 📊 Patient Response
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G30.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:50:25] ✅    ✅ Patient identified: Eduardo Medeiros
[02:50:25] ✅    ✅ Patient name validation passed
[02:50:25] 🔄 
🔄 Step 3: Processing patient dates...
[02:50:25] [DOC: 9251830] ℹ️  DOB normalized: 01/08/1948
[02:50:25] [DOC: 9251830] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[02:50:25] [DOC: 9251830] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[02:50:25] [DOC: 9251830] ✅ Patient date processing completed successfully
[02:50:25] ✅    ✅ Date processing completed
[02:50:25] 📊 Processed Patient Data
     └─ patientFName: Eduardo
     └─ patientLName: Medeiros
     └─ dob: 01/08/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA231101014802
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'E86.0', 'thirdDiagnosis': 'G30.1'}]
[02:50:25] 🔄 
🔄 Step 4: Extracting order data...
[02:50:27] ℹ️  Order extraction - MRN: 'MA231101014802'
[02:50:27] ℹ️  Order extraction - Sex: ''
[02:50:27] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[02:50:27] ℹ️  Order extraction - Payer Source: ''
[02:50:27] ✅ Order data extraction completed successfully
[02:50:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:50:27] ℹ️  Using MRN from patient data: 'MA231101014802' over 'MA231101014802'
[02:50:27] ⚠️  Could not determine sex using any available method
[02:50:27] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[02:50:27] ✅ Patient name cross-validation successful
[02:50:27] ✅    ✅ Data merged successfully
[02:50:29] ✅    ✅ Order data extracted and validated
[02:50:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:51:32] [DOC: 9251830] ℹ️  Patient not found in cache or API: Eduardo Medeiros
[02:51:32] [DOC: 9251830] ℹ️  Patient not found, creating new patient via API...
[02:51:32] [DOC: 9251830] ℹ️  Creating patient via API: Eduardo Medeiros
[02:51:33] [DOC: 9251830] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:51:33] ❌    ❌ Failed to create patient
[02:51:33] [DOC: 9251830] ℹ️  API push details saved for document 9251830
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[02:51:33] ℹ️  Total Processed: 49
[02:51:33] ℹ️  CSV Success: 29
[02:51:33] ℹ️  CSV Errors: 5
[02:51:33] ℹ️  API Success: 0
[02:51:33] ℹ️  API Errors: 44
[02:51:33] ℹ️  CSV Success Rate: 59.2%
[02:51:33] ℹ️  API Success Rate: 0.0%
[02:51:33] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250608_023249.csv
[02:51:33] ℹ️  API Details File: api_outputs/api_push_details_20250608_023249.csv
================================================================================
║          ============================================================          ║
================================================================================
