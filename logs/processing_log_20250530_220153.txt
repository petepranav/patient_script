================================================================================
║                   PATIENT DATA PIPELINE - PROCESSING STARTED                   ║
================================================================================
[22:01:55] ℹ️  Processing CSV file: orders1.csv
================================================================================
║                          PROCESSING DOCUMENT 9318974                           ║
================================================================================
[22:01:55] [DOC: 9318974] ℹ️  Facility/Agency: Dartmouth HH | Received Date: 05/30/2025
[22:01:55] [DOC: 9318974] ℹ️  Agency mapping found: Dartmouth HH -> d404757d-5027-45d2-a235-24a1fe763c9a
[22:01:55] [DOC: 9318974] 📋 [1/6] Extracting text from PDF
[22:01:58] ℹ️  Document is text-based - using pdfplumber for extraction
[22:01:58] [DOC: 9318974] ✅ Text extracted successfully using pdfplumber
[22:01:58] [DOC: 9318974] ℹ️  Text extraction completed using pdfplumber: 7607 characters
[22:01:58] [DOC: 9318974] ✅ Text extraction completed
[22:01:58] [DOC: 9318974] 📄 NON-FAXED DOCUMENT | Type: ORDER
[22:01:58] [DOC: 9318974] 📊 Document Information
     └─ Faxed: No
     └─ Fax Source: Unknown
     └─ Document Type: ORDER
     └─ Extraction Method: pdfplumber
     └─ Text Length: 7607
[22:01:58] [DOC: 9318974] 📋 [2/6] Extracting patient data using AI
[22:02:02] ✅ AI patient data extraction completed successfully
[22:02:02] [DOC: 9318974] 📊 AI-Extracted Patient Data
     └─ patientFName: Robert
     └─ patientLName: Rezendes
     └─ dob: 08/16/1940
     └─ patientSex: M
     └─ medicalRecordNo: 5680015
     └─ billingProvider: Joseph Nakda, MD
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ patientAddress: 970 Lees River Ave
     └─ patientCity: Somerset
     └─ patientState: MA
     └─ zip: 02726
     └─ episodeDiagnoses: [{'startOfCare': '05/10/2025', 'startOfEpisode': '05/10/2025', 'endOfEpisode': '07/08/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I50.43', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I25.5', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'I25.2'}]
[22:02:02] [DOC: 9318974] 📋 [3/6] Processing and validating dates
[22:02:02] [DOC: 9318974] 📊 Raw Episode Dates from Document
     └─ Start of Care: 05/10/2025
     └─ Start of Episode: 05/10/2025
     └─ End of Episode: 07/08/2025
[22:02:02] [DOC: 9318974] 📊 Parsed Episode Dates
     └─ Start of Care: 05/10/2025
     └─ Start of Episode: 05/10/2025
     └─ End of Episode: 07/08/2025
[22:02:02] [DOC: 9318974] 📊 Patient Data After Date Processing
     └─ patientFName: Robert
     └─ patientLName: Rezendes
     └─ dob: 08/16/1940
     └─ patientSex: M
     └─ medicalRecordNo: 5680015
     └─ billingProvider: Joseph Nakda, MD
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ patientAddress: 970 Lees River Ave
     └─ patientCity: Somerset
     └─ patientState: MA
     └─ zip: 02726
     └─ episodeDiagnoses: [{'startOfCare': '05/10/2025', 'startOfEpisode': '05/10/2025', 'endOfEpisode': '07/08/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I50.43', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I25.5', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'I25.2'}]
[22:02:02] [DOC: 9318974] 📋 [4/6] Creating or finding patient
[22:02:02] 📊 Patient Data for Processing
     └─ First Name: Robert
     └─ Last Name: Rezendes
     └─ DOB: 08/16/1940
     └─ MRN: 5680015
     └─ Address: 970 Lees River Ave
     └─ City: Somerset
     └─ State: MA
     └─ ZIP: 02726
[22:02:02] ✅ Patient already processed in this session: ROBERT REZENDES
[22:02:02] [DOC: 9318974] ✅ Patient processed successfully with ID: f13844a6-7d38-4f53-8af3-a94137e27a4f
[22:02:02] [DOC: 9318974] 📋 [5/6] Extracting order data
[22:02:04] ✅ AI order data extraction completed successfully
[22:02:04] [DOC: 9318974] 📊 AI-Extracted Order Data
     └─ orderNo: None
     └─ orderDate: None
     └─ startOfCare: 05/10/2025
     └─ episodeStartDate: 05/10/2025
     └─ episodeEndDate: 07/08/2025
     └─ documentID: 5680015
     └─ mrn: None
     └─ patientName: Rezendes, Robert J
     └─ sentToPhysicianDate: 05/30/2025
     └─ sentToPhysicianStatus: True
     └─ patientId: None
     └─ companyId: None
     └─ bit64Url: None
     └─ documentName: None
[22:02:04] [DOC: 9318974] 📋 [6/6] Processing order submission
[22:02:05] 📊 Retrieved Agency Info
     └─ Start of Care: Not available
     └─ Start of Episode: 05/10/2025
     └─ End of Episode: 07/08/2025
[22:02:05] [DOC: 9318974] 📊 Order Data After Date Processing
     └─ orderNo: None
     └─ orderDate: None
     └─ startOfCare: 05/10/2025
     └─ episodeStartDate: 05/10/2025
     └─ episodeEndDate: 07/08/2025
     └─ documentID: 5680015
     └─ mrn: None
     └─ patientName: Rezendes, Robert J
     └─ sentToPhysicianDate: 05/30/2025
     └─ sentToPhysicianStatus: True
     └─ patientId: None
     └─ companyId: None
     └─ bit64Url: None
     └─ documentName: None
[22:02:05] [DOC: 9318974] 📊 MRN Synchronization
     └─ Patient MRN (extracted): 5680015
     └─ Order MRN (extracted): None
     └─ Final MRN: 5680015
     └─ Source: patient_extracted
     └─ Applied to: Both patient and order
[22:02:05] [DOC: 9318974] ❌ Order processing failed: 'NoneType' object has no attribute 'strip'
[22:02:05] [DOC: 9318974] ✅ Document processing completed successfully!
================================================================================
║                          PROCESSING DOCUMENT 9318964                           ║
================================================================================
[22:02:05] [DOC: 9318964] ℹ️  Facility/Agency: AccentCare Fall River | Received Date: 05/30/2025
[22:02:05] [DOC: 9318964] ℹ️  Agency mapping found: AccentCare Fall River -> c7cc6389-e15a-468f-bfbc-bc60ac4d4e81
[22:02:05] [DOC: 9318964] 📋 [1/6] Extracting text from PDF
[22:02:24] ℹ️  Document is text-based - using pdfplumber for extraction
[22:02:24] [DOC: 9318964] ⚠️  pdfplumber extraction failed: pdfplumber extracted empty text, trying OCR...
[22:02:44] [DOC: 9318964] ⚠️  YOLO+DocTR extraction failed: 'Line' object has no attribute 'value', trying basic OCR...
[22:03:00] [DOC: 9318964] ✅ Text extracted successfully using tesseract_fallback
[22:03:00] [DOC: 9318964] ℹ️  Text extraction completed using tesseract_fallback: 26408 characters
[22:03:00] [DOC: 9318964] ✅ Text extraction completed
[22:03:00] [DOC: 9318964] 📄 NON-FAXED DOCUMENT | Type: 485RECERT
[22:03:00] [DOC: 9318964] 📊 Document Information
     └─ Faxed: No
     └─ Fax Source: Unknown
     └─ Document Type: 485RECERT
     └─ Extraction Method: tesseract_fallback
     └─ Text Length: 26408
[22:03:00] [DOC: 9318964] 📋 [2/6] Extracting patient data using AI
