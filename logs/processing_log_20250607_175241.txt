================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[17:52:41] ℹ️  CSV Data Extraction & API Push Tool
[17:52:41] ℹ️  
[17:52:41] ℹ️  Features:
[17:52:41] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[17:52:41] ℹ️  - AI-powered patient and order data extraction
[17:52:41] ℹ️  - Enhanced error handling and logging
[17:52:41] ℹ️  - Full API integration (patient creation + order pushing)
[17:52:41] ℹ️  - CSV output with comprehensive patient data
[17:52:41] ℹ️  - Detailed API tracking with remarks for every document
[17:52:41] ℹ️  - Complete audit trail of all processing attempts
[17:52:41] ℹ️  
[17:52:41] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[17:52:41] ✅ Created output CSV file: csv_outputs/extracted_patients_20250607_175241.csv
[17:52:41] ✅ Created API details CSV file: api_outputs/api_push_details_20250607_175241.csv
================================================================================
║                        Processing Document ID: 9262370                         ║
================================================================================
[17:52:41] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:52:41] ℹ️  Date: 04/25/2025
[17:52:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:52:43] [DOC: 9262370] ✅ Text extracted using pdfplumber (2347 chars)
[17:52:43] ✅    ✅ Text extracted using pdfplumber (2335 chars)
[17:52:43] 🔄 
🔄 Step 2: Extracting patient data...
[17:52:48] ℹ️  AI extracted raw sex value: ''
[17:52:48] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:52:48] ℹ️  AI extracted payer source: ''
[17:52:48] ℹ️  AI extracted diagnoses:
[17:52:48] ℹ️    - Diagnosis 1: 'M62.59'
[17:52:48] ℹ️    - Diagnosis 2: 'R27.0'
[17:52:48] ℹ️    - Diagnosis 3: 'M48.07'
[17:52:48] ℹ️    - Diagnosis 4: 'None'
[17:52:48] ℹ️    - Diagnosis 5: 'None'
[17:52:48] ℹ️    - Diagnosis 6: 'None'
[17:52:48] ℹ️  Final extracted MRN: 'MA221116116005'
[17:52:48] ℹ️  Final extracted Sex: ''
[17:52:48] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:52:48] ℹ️  Final extracted Payer Source: ''
[17:52:48] ✅ Patient data extraction completed successfully
[17:52:48] ✅    ✅ Patient data extracted successfully
[17:52:48] 📊 Patient Response
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'M62.59', 'secondDiagnosis': 'R27.0', 'thirdDiagnosis': 'M48.07', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:52:48] ✅    ✅ Patient identified: Kelly Medeiros
[17:52:48] ✅    ✅ Patient name validation passed
[17:52:48] 🔄 
🔄 Step 3: Processing patient dates...
[17:52:48] [DOC: 9262370] ℹ️  DOB normalized: 11/23/1960
[17:52:48] [DOC: 9262370] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[17:52:48] [DOC: 9262370] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[17:52:48] [DOC: 9262370] ✅ Patient date processing completed successfully
[17:52:48] ✅    ✅ Date processing completed
[17:52:48] 📊 Processed Patient Data
     └─ patientFName: Kelly
     └─ patientLName: Medeiros
     └─ dob: 11/23/1960
     └─ patientSex: 
     └─ medicalRecordNo: MA221116116005
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'M62.59', 'secondDiagnosis': 'R27.0', 'thirdDiagnosis': 'M48.07'}]
[17:52:48] 🔄 
🔄 Step 4: Extracting order data...
[17:52:50] ℹ️  Order extraction - MRN: 'MA221116116005'
[17:52:50] ℹ️  Order extraction - Sex: ''
[17:52:50] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:52:50] ℹ️  Order extraction - Payer Source: ''
[17:52:50] ✅ Order data extraction completed successfully
[17:52:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:52:50] ℹ️  Using MRN from patient data: 'MA221116116005' over 'MA221116116005'
[17:52:50] ⚠️  Could not determine sex using any available method
[17:52:50] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:52:50] ✅ Patient name cross-validation successful
[17:52:50] ✅    ✅ Data merged successfully
[17:52:52] ✅    ✅ Order data extracted and validated
[17:52:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:52:59] [DOC: 9262370] ℹ️  Patient not found in cache or API: Kelly Medeiros
[17:52:59] [DOC: 9262370] ℹ️  Patient not found, creating new patient via API...
[17:52:59] [DOC: 9262370] ℹ️  Creating patient via API: Kelly Medeiros
[17:53:01] [DOC: 9262370] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:53:01] ❌    ❌ Failed to create patient
[17:53:01] [DOC: 9262370] ℹ️  API push details saved for document 9262370
================================================================================
║                        Processing Document ID: 9262367                         ║
================================================================================
[17:53:01] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:53:01] ℹ️  Date: 04/25/2025
[17:53:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:53:03] [DOC: 9262367] ✅ Text extracted using pdfplumber (1403 chars)
[17:53:03] ✅    ✅ Text extracted using pdfplumber (1403 chars)
[17:53:03] 🔄 
🔄 Step 2: Extracting patient data...
[17:53:07] ℹ️  AI extracted raw sex value: ''
[17:53:07] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:53:07] ℹ️  AI extracted payer source: ''
[17:53:07] ℹ️  AI extracted diagnoses:
[17:53:07] ℹ️    - Diagnosis 1: 'G11.8'
[17:53:07] ℹ️    - Diagnosis 2: 'M62.81'
[17:53:07] ℹ️    - Diagnosis 3: 'M81.0'
[17:53:07] ℹ️    - Diagnosis 4: 'None'
[17:53:07] ℹ️    - Diagnosis 5: 'None'
[17:53:07] ℹ️    - Diagnosis 6: 'None'
[17:53:07] ℹ️  Final extracted MRN: 'MA221209055605'
[17:53:07] ℹ️  Final extracted Sex: ''
[17:53:07] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:53:07] ℹ️  Final extracted Payer Source: ''
[17:53:07] ✅ Patient data extraction completed successfully
[17:53:07] ✅    ✅ Patient data extracted successfully
[17:53:07] 📊 Patient Response
     └─ patientFName: Connie
     └─ patientLName: Sousa
     └─ dob: 05/23/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221209055605
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'G11.8', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'M81.0', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:53:07] ✅    ✅ Patient identified: Connie Sousa
[17:53:07] ✅    ✅ Patient name validation passed
[17:53:07] 🔄 
🔄 Step 3: Processing patient dates...
[17:53:07] [DOC: 9262367] ℹ️  DOB normalized: 05/23/1956
[17:53:07] [DOC: 9262367] ℹ️  Episode startOfEpisode normalized: 04/15/2025
[17:53:07] [DOC: 9262367] ℹ️  Episode endOfEpisode normalized: 06/13/2025
[17:53:07] [DOC: 9262367] ✅ Patient date processing completed successfully
[17:53:07] ✅    ✅ Date processing completed
[17:53:07] 📊 Processed Patient Data
     └─ patientFName: Connie
     └─ patientLName: Sousa
     └─ dob: 05/23/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221209055605
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'G11.8', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'M81.0'}]
[17:53:07] 🔄 
🔄 Step 4: Extracting order data...
[17:53:09] ℹ️  Order extraction - MRN: 'MA221209055605'
[17:53:09] ℹ️  Order extraction - Sex: ''
[17:53:09] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:53:09] ℹ️  Order extraction - Payer Source: ''
[17:53:09] ✅ Order data extraction completed successfully
[17:53:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:53:09] ℹ️  Using MRN from patient data: 'MA221209055605' over 'MA221209055605'
[17:53:09] ⚠️  Could not determine sex using any available method
[17:53:09] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:53:09] ✅ Patient name cross-validation successful
[17:53:09] ✅    ✅ Data merged successfully
[17:53:10] ✅    ✅ Order data extracted and validated
[17:53:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:53:17] [DOC: 9262367] ℹ️  Patient not found in cache or API: Connie Sousa
[17:53:17] [DOC: 9262367] ℹ️  Patient not found, creating new patient via API...
[17:53:17] [DOC: 9262367] ℹ️  Creating patient via API: Connie Sousa
[17:53:18] [DOC: 9262367] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:53:18] ❌    ❌ Failed to create patient
[17:53:18] [DOC: 9262367] ℹ️  API push details saved for document 9262367
================================================================================
║                        Processing Document ID: 9262366                         ║
================================================================================
[17:53:18] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:53:18] ℹ️  Date: 04/25/2025
[17:53:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:53:20] [DOC: 9262366] ✅ Text extracted using pdfplumber (1406 chars)
[17:53:20] ✅    ✅ Text extracted using pdfplumber (1406 chars)
[17:53:20] 🔄 
🔄 Step 2: Extracting patient data...
[17:53:23] ℹ️  AI extracted raw sex value: ''
[17:53:23] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:53:23] ℹ️  AI extracted payer source: ''
[17:53:23] ℹ️  AI extracted diagnoses:
[17:53:23] ℹ️    - Diagnosis 1: 'G11.8'
[17:53:23] ℹ️    - Diagnosis 2: 'M62.81'
[17:53:23] ℹ️    - Diagnosis 3: 'M81.0'
[17:53:23] ℹ️    - Diagnosis 4: ''
[17:53:23] ℹ️    - Diagnosis 5: ''
[17:53:23] ℹ️    - Diagnosis 6: ''
[17:53:23] ℹ️  Final extracted MRN: 'MA221209055605'
[17:53:23] ℹ️  Final extracted Sex: ''
[17:53:23] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:53:23] ℹ️  Final extracted Payer Source: ''
[17:53:23] ✅ Patient data extraction completed successfully
[17:53:23] ✅    ✅ Patient data extracted successfully
[17:53:23] 📊 Patient Response
     └─ patientFName: Connie
     └─ patientLName: Sousa
     └─ dob: 05/23/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221209055605
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'G11.8', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'M81.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:53:23] ✅    ✅ Patient identified: Connie Sousa
[17:53:23] ✅    ✅ Patient name validation passed
[17:53:23] 🔄 
🔄 Step 3: Processing patient dates...
[17:53:23] [DOC: 9262366] ℹ️  DOB normalized: 05/23/1956
[17:53:23] [DOC: 9262366] ℹ️  Episode startOfEpisode normalized: 04/15/2025
[17:53:23] [DOC: 9262366] ℹ️  Episode endOfEpisode normalized: 06/13/2025
[17:53:23] [DOC: 9262366] ✅ Patient date processing completed successfully
[17:53:23] ✅    ✅ Date processing completed
[17:53:23] 📊 Processed Patient Data
     └─ patientFName: Connie
     └─ patientLName: Sousa
     └─ dob: 05/23/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221209055605
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'G11.8', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'M81.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:53:23] 🔄 
🔄 Step 4: Extracting order data...
[17:53:26] ℹ️  Order extraction - MRN: 'MA221209055605'
[17:53:26] ℹ️  Order extraction - Sex: ''
[17:53:26] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:53:26] ℹ️  Order extraction - Payer Source: ''
[17:53:26] ✅ Order data extraction completed successfully
[17:53:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:53:26] ℹ️  Using MRN from patient data: 'MA221209055605' over 'MA221209055605'
[17:53:26] ⚠️  Could not determine sex using any available method
[17:53:26] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:53:26] ✅ Patient name cross-validation successful
[17:53:26] ✅    ✅ Data merged successfully
[17:53:27] ✅    ✅ Order data extracted and validated
[17:53:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:53:32] [DOC: 9262366] ℹ️  Patient not found in cache or API: Connie Sousa
[17:53:32] [DOC: 9262366] ℹ️  Patient not found, creating new patient via API...
[17:53:32] [DOC: 9262366] ℹ️  Creating patient via API: Connie Sousa
[17:53:33] [DOC: 9262366] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:53:33] ❌    ❌ Failed to create patient
[17:53:33] [DOC: 9262366] ℹ️  API push details saved for document 9262366
================================================================================
║                        Processing Document ID: 9262362                         ║
================================================================================
[17:53:33] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:53:33] ℹ️  Date: 04/25/2025
[17:53:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:53:36] [DOC: 9262362] ✅ Text extracted using pdfplumber (1550 chars)
[17:53:36] ✅    ✅ Text extracted using pdfplumber (1550 chars)
[17:53:36] 🔄 
🔄 Step 2: Extracting patient data...
[17:53:38] ℹ️  AI extracted raw sex value: ''
[17:53:38] ℹ️  AI extracted service line: 'Physical Therapy'
[17:53:38] ℹ️  AI extracted payer source: ''
[17:53:38] ℹ️  AI extracted diagnoses:
[17:53:38] ℹ️    - Diagnosis 1: 'G11.8'
[17:53:38] ℹ️    - Diagnosis 2: 'M62.81'
[17:53:38] ℹ️    - Diagnosis 3: 'M81.0'
[17:53:38] ℹ️    - Diagnosis 4: ''
[17:53:38] ℹ️    - Diagnosis 5: ''
[17:53:38] ℹ️    - Diagnosis 6: ''
[17:53:38] ℹ️  Final extracted MRN: 'MA221209055605'
[17:53:38] ℹ️  Final extracted Sex: ''
[17:53:38] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:53:38] ℹ️  Final extracted Payer Source: ''
[17:53:38] ✅ Patient data extraction completed successfully
[17:53:38] ✅    ✅ Patient data extracted successfully
[17:53:38] 📊 Patient Response
     └─ patientFName: Connie
     └─ patientLName: Sousa
     └─ dob: 05/23/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221209055605
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'G11.8', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'M81.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:53:38] ✅    ✅ Patient identified: Connie Sousa
[17:53:38] ✅    ✅ Patient name validation passed
[17:53:38] 🔄 
🔄 Step 3: Processing patient dates...
[17:53:38] [DOC: 9262362] ℹ️  DOB normalized: 05/23/1956
[17:53:38] [DOC: 9262362] ℹ️  Episode startOfEpisode normalized: 04/15/2025
[17:53:38] [DOC: 9262362] ℹ️  Episode endOfEpisode normalized: 06/13/2025
[17:53:38] [DOC: 9262362] ✅ Patient date processing completed successfully
[17:53:38] ✅    ✅ Date processing completed
[17:53:38] 📊 Processed Patient Data
     └─ patientFName: Connie
     └─ patientLName: Sousa
     └─ dob: 05/23/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221209055605
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'G11.8', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'M81.0', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:53:38] 🔄 
🔄 Step 4: Extracting order data...
[17:53:41] ℹ️  Order extraction - MRN: 'MA221209055605'
[17:53:41] ℹ️  Order extraction - Sex: ''
[17:53:41] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:53:41] ℹ️  Order extraction - Payer Source: ''
[17:53:41] ✅ Order data extraction completed successfully
[17:53:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:53:41] ℹ️  Using MRN from patient data: 'MA221209055605' over 'MA221209055605'
[17:53:41] ⚠️  Could not determine sex using any available method
[17:53:41] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:53:41] ✅ Patient name cross-validation successful
[17:53:41] ✅    ✅ Data merged successfully
[17:53:43] ✅    ✅ Order data extracted and validated
[17:53:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:53:51] [DOC: 9262362] ℹ️  Patient not found in cache or API: Connie Sousa
[17:53:51] [DOC: 9262362] ℹ️  Patient not found, creating new patient via API...
[17:53:51] [DOC: 9262362] ℹ️  Creating patient via API: Connie Sousa
[17:53:52] [DOC: 9262362] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:53:52] ❌    ❌ Failed to create patient
[17:53:52] [DOC: 9262362] ℹ️  API push details saved for document 9262362
================================================================================
║                        Processing Document ID: 9262235                         ║
================================================================================
[17:53:52] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:53:52] ℹ️  Date: 04/25/2025
[17:53:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:53:56] [DOC: 9262235] ✅ Text extracted using pdfplumber (20196 chars)
[17:53:56] ✅    ✅ Text extracted using pdfplumber (20196 chars)
[17:53:56] 🔄 
🔄 Step 2: Extracting patient data...
[17:53:59] ℹ️  AI extracted raw sex value: 'F'
[17:53:59] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:53:59] ℹ️  AI extracted payer source: ''
[17:53:59] ℹ️  AI extracted diagnoses:
[17:53:59] ℹ️    - Diagnosis 1: 'Z48.815'
[17:53:59] ℹ️    - Diagnosis 2: 'K59.00'
[17:53:59] ℹ️    - Diagnosis 3: 'G40.909'
[17:53:59] ℹ️    - Diagnosis 4: 'E03.9'
[17:53:59] ℹ️    - Diagnosis 5: 'F41.9'
[17:53:59] ℹ️    - Diagnosis 6: 'F32.A'
[17:53:59] ℹ️  Final extracted MRN: '3345378'
[17:53:59] ℹ️  Final extracted Sex: 'FEMALE'
[17:53:59] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:53:59] ℹ️  Final extracted Payer Source: ''
[17:53:59] ✅ Patient data extraction completed successfully
[17:53:59] ✅    ✅ Patient data extracted successfully
[17:53:59] 📊 Patient Response
     └─ patientFName: Paula
     └─ patientLName: Tetrault
     └─ dob: 06/06/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3345378
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'Z48.815', 'secondDiagnosis': 'K59.00', 'thirdDiagnosis': 'G40.909', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F32.A'}]
[17:53:59] ✅    ✅ Patient identified: Paula Tetrault
[17:53:59] ✅    ✅ Patient name validation passed
[17:53:59] 🔄 
🔄 Step 3: Processing patient dates...
[17:53:59] [DOC: 9262235] ℹ️  DOB normalized: 06/06/1946
[17:53:59] [DOC: 9262235] ℹ️  Episode startOfCare normalized: 04/12/2025
[17:53:59] [DOC: 9262235] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[17:53:59] [DOC: 9262235] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[17:53:59] [DOC: 9262235] ✅ Patient date processing completed successfully
[17:53:59] ✅    ✅ Date processing completed
[17:53:59] 📊 Processed Patient Data
     └─ patientFName: Paula
     └─ patientLName: Tetrault
     └─ dob: 06/06/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3345378
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'Z48.815', 'secondDiagnosis': 'K59.00', 'thirdDiagnosis': 'G40.909', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'F32.A'}]
[17:53:59] 🔄 
🔄 Step 4: Extracting order data...
[17:54:02] ℹ️  Order extraction - MRN: '3345378'
[17:54:02] ℹ️  Order extraction - Sex: 'FEMALE'
[17:54:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:54:02] ℹ️  Order extraction - Payer Source: ''
[17:54:02] ✅ Order data extraction completed successfully
[17:54:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:54:02] ℹ️  Using MRN from patient data: '3345378' over '3345378'
[17:54:02] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:54:02] ✅ Patient name cross-validation successful
[17:54:02] ✅    ✅ Data merged successfully
[17:54:03] ✅    ✅ Order data extracted and validated
[17:54:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:54:11] [DOC: 9262235] ✅ Patient exists in API: Paula Tetrault, ID: f41e9e4b-618e-44e2-a701-537e7d0aef2e
[17:54:11] ✅    ✅ Existing patient found with ID: f41e9e4b-618e-44e2-a701-537e7d0aef2e
[17:54:11] 🔄 
🔄 Step 6: Pushing order to API...
[17:54:11] [DOC: 9262235] ℹ️  Pushing order via API for patient ID: f41e9e4b-618e-44e2-a701-537e7d0aef2e
[17:54:12] [DOC: 9262235] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19666"}
[17:54:12] ❌    ❌ Failed to push order
[17:54:12] 🔄 
🔄 Step 7: Writing to CSV...
[17:54:12] [DOC: 9262235] ℹ️  Calculated age: 79 from DOB: 06/06/1946
[17:54:12] [DOC: 9262235] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[17:54:12] [DOC: 9262235] ℹ️  Payer Source extracted: ''
[17:54:12] [DOC: 9262235] ℹ️  Diagnosis codes being written:
[17:54:12] [DOC: 9262235] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z48.815'
[17:54:12] [DOC: 9262235] ℹ️    - Latest_Episode_Seconddiagnosis: 'K59.00'
[17:54:12] [DOC: 9262235] ℹ️    - Latest_Episode_Thirddiagnosis: 'G40.909'
[17:54:12] [DOC: 9262235] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E03.9'
[17:54:12] [DOC: 9262235] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[17:54:12] [DOC: 9262235] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F32.A'
[17:54:12] [DOC: 9262235] ✅ Patient data written to CSV: Paula Tetrault | Sex: FEMALE | Age: 79 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: 3345378
[17:54:12] ✅    ✅ Document 9262235 processed and saved successfully
[17:54:12] 🔄 
🔄 Step 8: Saving API details...
[17:54:12] [DOC: 9262235] ℹ️  API push details saved for document 9262235
[17:54:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9262226                         ║
================================================================================
[17:54:12] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:54:12] ℹ️  Date: 04/25/2025
[17:54:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:54:14] [DOC: 9262226] ✅ Text extracted using pdfplumber (3773 chars)
[17:54:14] ✅    ✅ Text extracted using pdfplumber (3773 chars)
[17:54:14] 🔄 
🔄 Step 2: Extracting patient data...
[17:54:17] ℹ️  AI extracted raw sex value: 'F'
[17:54:17] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:54:17] ℹ️  AI extracted payer source: ''
[17:54:17] ℹ️  AI extracted diagnoses:
[17:54:17] ℹ️    - Diagnosis 1: 'None'
[17:54:17] ℹ️    - Diagnosis 2: 'None'
[17:54:17] ℹ️    - Diagnosis 3: 'None'
[17:54:17] ℹ️    - Diagnosis 4: 'None'
[17:54:17] ℹ️    - Diagnosis 5: 'None'
[17:54:17] ℹ️    - Diagnosis 6: 'None'
[17:54:17] ℹ️  Final extracted MRN: '2936720'
[17:54:17] ℹ️  Final extracted Sex: 'FEMALE'
[17:54:17] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:54:17] ℹ️  Final extracted Payer Source: ''
[17:54:17] ✅ Patient data extraction completed successfully
[17:54:17] ✅    ✅ Patient data extracted successfully
[17:54:17] 📊 Patient Response
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:54:17] ✅    ✅ Patient identified: Stella Saint
[17:54:17] ✅    ✅ Patient name validation passed
[17:54:17] 🔄 
🔄 Step 3: Processing patient dates...
[17:54:17] [DOC: 9262226] ℹ️  DOB normalized: 07/02/1928
[17:54:17] [DOC: 9262226] ✅ Patient date processing completed successfully
[17:54:17] ✅    ✅ Date processing completed
[17:54:17] 📊 Processed Patient Data
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:54:17] 🔄 
🔄 Step 4: Extracting order data...
[17:54:20] ℹ️  Order extraction - MRN: '2936720'
[17:54:20] ℹ️  Order extraction - Sex: 'FEMALE'
[17:54:20] ℹ️  Order extraction - Service Line: 'RN'
[17:54:20] ℹ️  Order extraction - Payer Source: ''
[17:54:20] ✅ Order data extraction completed successfully
[17:54:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:54:20] ℹ️  Using MRN from patient data: '2936720' over '2936720'
[17:54:20] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[17:54:20] ✅ Patient name cross-validation successful
[17:54:20] ✅    ✅ Data merged successfully
[17:54:21] ⚠️     ❌ Skipping - missing episode start date
[17:54:21] [DOC: 9262226] ℹ️  API push details saved for document 9262226
================================================================================
║                        Processing Document ID: 9262203                         ║
================================================================================
[17:54:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:54:21] ℹ️  Date: 04/25/2025
[17:54:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:54:24] [DOC: 9262203] ✅ Text extracted using pdfplumber (11787 chars)
[17:54:24] ✅    ✅ Text extracted using pdfplumber (11787 chars)
[17:54:24] 🔄 
🔄 Step 2: Extracting patient data...
[17:54:27] ℹ️  AI extracted raw sex value: 'M'
[17:54:27] ℹ️  AI extracted service line: 'Physical Therapy, Skilled nursing'
[17:54:27] ℹ️  AI extracted payer source: ''
[17:54:27] ℹ️  AI extracted diagnoses:
[17:54:27] ℹ️    - Diagnosis 1: 'S22.41XD'
[17:54:27] ℹ️    - Diagnosis 2: 'S50.11XD'
[17:54:27] ℹ️    - Diagnosis 3: 'I12.9'
[17:54:27] ℹ️    - Diagnosis 4: 'E11.22'
[17:54:27] ℹ️    - Diagnosis 5: 'N18.30'
[17:54:27] ℹ️    - Diagnosis 6: 'J84.10'
[17:54:27] ℹ️  Final extracted MRN: '2681155'
[17:54:27] ℹ️  Final extracted Sex: 'MALE'
[17:54:27] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled nursing'
[17:54:27] ℹ️  Final extracted Payer Source: ''
[17:54:27] ✅ Patient data extraction completed successfully
[17:54:27] ✅    ✅ Patient data extracted successfully
[17:54:27] 📊 Patient Response
     └─ patientFName: Carlos
     └─ patientLName: Machado
     └─ dob: 09/23/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2681155
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'S22.41XD', 'secondDiagnosis': 'S50.11XD', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'J84.10'}]
[17:54:27] ✅    ✅ Patient identified: Carlos Machado
[17:54:27] ✅    ✅ Patient name validation passed
[17:54:27] 🔄 
🔄 Step 3: Processing patient dates...
[17:54:27] [DOC: 9262203] ℹ️  DOB normalized: 09/23/1934
[17:54:27] [DOC: 9262203] ℹ️  Episode startOfCare normalized: 04/12/2025
[17:54:27] [DOC: 9262203] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[17:54:27] [DOC: 9262203] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[17:54:27] [DOC: 9262203] ✅ Patient date processing completed successfully
[17:54:27] ✅    ✅ Date processing completed
[17:54:27] 📊 Processed Patient Data
     └─ patientFName: Carlos
     └─ patientLName: Machado
     └─ dob: 09/23/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2681155
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'S22.41XD', 'secondDiagnosis': 'S50.11XD', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'J84.10'}]
[17:54:27] 🔄 
🔄 Step 4: Extracting order data...
[17:54:30] ℹ️  Order extraction - MRN: '2681155'
[17:54:30] ℹ️  Order extraction - Sex: 'MALE'
[17:54:30] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:54:30] ℹ️  Order extraction - Payer Source: ''
[17:54:30] ✅ Order data extraction completed successfully
[17:54:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:54:30] ℹ️  Using MRN from patient data: '2681155' over '2681155'
[17:54:30] ℹ️  Combined service lines: Patient='Physical Therapy, Skilled nursing' + Order='Physical Therapy' = 'Physical Therapy, Skilled nursing'
[17:54:30] ✅ Patient name cross-validation successful
[17:54:30] ✅    ✅ Data merged successfully
[17:54:31] ✅    ✅ Order data extracted and validated
[17:54:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:54:38] [DOC: 9262203] ✅ Patient exists in API: Carlos Machado, ID: e79bbcfb-c238-4746-bdcf-417fd311d47f
[17:54:38] ✅    ✅ Existing patient found with ID: e79bbcfb-c238-4746-bdcf-417fd311d47f
[17:54:38] 🔄 
🔄 Step 6: Pushing order to API...
[17:54:38] [DOC: 9262203] ℹ️  Pushing order via API for patient ID: e79bbcfb-c238-4746-bdcf-417fd311d47f
[17:54:39] [DOC: 9262203] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13306"}
[17:54:39] ❌    ❌ Failed to push order
[17:54:39] 🔄 
🔄 Step 7: Writing to CSV...
[17:54:39] [DOC: 9262203] ℹ️  Calculated age: 90 from DOB: 09/23/1934
[17:54:39] [DOC: 9262203] ℹ️  Service Line extracted: 'Physical Therapy, Skilled nursing'
[17:54:39] [DOC: 9262203] ℹ️  Payer Source extracted: ''
[17:54:39] [DOC: 9262203] ℹ️  Diagnosis codes being written:
[17:54:39] [DOC: 9262203] ℹ️    - Latest_Episode_Firstdiagnosis: 'S22.41XD'
[17:54:39] [DOC: 9262203] ℹ️    - Latest_Episode_Seconddiagnosis: 'S50.11XD'
[17:54:39] [DOC: 9262203] ℹ️    - Latest_Episode_Thirddiagnosis: 'I12.9'
[17:54:39] [DOC: 9262203] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.22'
[17:54:39] [DOC: 9262203] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.30'
[17:54:39] [DOC: 9262203] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J84.10'
[17:54:39] [DOC: 9262203] ✅ Patient data written to CSV: Carlos Machado | Sex: MALE | Age: 90 | Service: Physical Therapy, Skilled nursing | Payer:  | MRN: 2681155
[17:54:39] ✅    ✅ Document 9262203 processed and saved successfully
[17:54:39] 🔄 
🔄 Step 8: Saving API details...
[17:54:39] [DOC: 9262203] ℹ️  API push details saved for document 9262203
[17:54:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9262197                         ║
================================================================================
[17:54:39] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:54:39] ℹ️  Date: 04/25/2025
[17:54:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:54:40] [DOC: 9262197] ✅ Text extracted using pdfplumber (1024 chars)
[17:54:40] ✅    ✅ Text extracted using pdfplumber (1024 chars)
[17:54:40] 🔄 
🔄 Step 2: Extracting patient data...
[17:54:43] ℹ️  AI extracted raw sex value: 'M'
[17:54:43] ℹ️  AI extracted service line: 'Nursing'
[17:54:43] ℹ️  AI extracted payer source: ''
[17:54:43] ℹ️  AI extracted diagnoses:
[17:54:43] ℹ️    - Diagnosis 1: ''
[17:54:43] ℹ️    - Diagnosis 2: ''
[17:54:43] ℹ️    - Diagnosis 3: ''
[17:54:43] ℹ️    - Diagnosis 4: ''
[17:54:43] ℹ️    - Diagnosis 5: ''
[17:54:43] ℹ️    - Diagnosis 6: ''
[17:54:43] ℹ️  Final extracted MRN: '2611249'
[17:54:43] ℹ️  Final extracted Sex: 'MALE'
[17:54:43] ℹ️  Final extracted Service Line: 'Nursing'
[17:54:43] ℹ️  Final extracted Payer Source: ''
[17:54:43] ✅ Patient data extraction completed successfully
[17:54:43] ✅    ✅ Patient data extracted successfully
[17:54:43] 📊 Patient Response
     └─ patientFName: Kelada
     └─ patientLName: Sobhy
     └─ dob: 10/02/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2611249
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:54:43] ✅    ✅ Patient identified: Kelada Sobhy
[17:54:43] ✅    ✅ Patient name validation passed
[17:54:43] 🔄 
🔄 Step 3: Processing patient dates...
[17:54:43] [DOC: 9262197] ℹ️  DOB normalized: 10/02/1947
[17:54:43] [DOC: 9262197] ✅ Patient date processing completed successfully
[17:54:43] ✅    ✅ Date processing completed
[17:54:43] 📊 Processed Patient Data
     └─ patientFName: Kelada
     └─ patientLName: Sobhy
     └─ dob: 10/02/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2611249
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:54:43] 🔄 
🔄 Step 4: Extracting order data...
[17:54:45] ℹ️  Order extraction - MRN: '2611249'
[17:54:45] ℹ️  Order extraction - Sex: 'MALE'
[17:54:45] ℹ️  Order extraction - Service Line: ''
[17:54:45] ℹ️  Order extraction - Payer Source: ''
[17:54:45] ✅ Order data extraction completed successfully
[17:54:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:54:45] ℹ️  Using MRN from patient data: '2611249' over '2611249'
[17:54:45] ℹ️  Using service line from patient data: 'Nursing'
[17:54:45] ✅ Patient name cross-validation successful
[17:54:45] ✅    ✅ Data merged successfully
[17:54:46] ⚠️     ❌ Skipping - missing episode start date
[17:54:46] [DOC: 9262197] ℹ️  API push details saved for document 9262197
================================================================================
║                        Processing Document ID: 9262191                         ║
================================================================================
[17:54:46] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:54:46] ℹ️  Date: 04/25/2025
[17:54:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:54:48] [DOC: 9262191] ✅ Text extracted using pdfplumber (933 chars)
[17:54:48] ✅    ✅ Text extracted using pdfplumber (933 chars)
[17:54:48] 🔄 
🔄 Step 2: Extracting patient data...
[17:54:50] ℹ️  AI extracted raw sex value: 'M'
[17:54:50] ℹ️  AI extracted service line: 'Physical Therapy'
[17:54:50] ℹ️  AI extracted payer source: ''
[17:54:50] ℹ️  AI extracted diagnoses:
[17:54:50] ℹ️    - Diagnosis 1: 'None'
[17:54:50] ℹ️    - Diagnosis 2: 'None'
[17:54:50] ℹ️    - Diagnosis 3: 'None'
[17:54:50] ℹ️    - Diagnosis 4: 'None'
[17:54:50] ℹ️    - Diagnosis 5: 'None'
[17:54:50] ℹ️    - Diagnosis 6: 'None'
[17:54:50] ℹ️  Final extracted MRN: '2553385'
[17:54:50] ℹ️  Final extracted Sex: 'MALE'
[17:54:50] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:54:50] ℹ️  Final extracted Payer Source: ''
[17:54:50] ✅ Patient data extraction completed successfully
[17:54:50] ✅    ✅ Patient data extracted successfully
[17:54:50] 📊 Patient Response
     └─ patientFName: Curtis
     └─ patientLName: Hardy IV
     └─ dob: 06/17/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 2553385
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:54:50] ✅    ✅ Patient identified: Curtis Hardy IV
[17:54:50] ✅    ✅ Patient name validation passed
[17:54:50] 🔄 
🔄 Step 3: Processing patient dates...
[17:54:50] [DOC: 9262191] ℹ️  DOB normalized: 06/17/1964
[17:54:50] [DOC: 9262191] ✅ Patient date processing completed successfully
[17:54:50] ✅    ✅ Date processing completed
[17:54:50] 📊 Processed Patient Data
     └─ patientFName: Curtis
     └─ patientLName: Hardy IV
     └─ dob: 06/17/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 2553385
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:54:50] 🔄 
🔄 Step 4: Extracting order data...
[17:54:53] ℹ️  Order extraction - MRN: '2553385'
[17:54:53] ℹ️  Order extraction - Sex: 'MALE'
[17:54:53] ℹ️  Order extraction - Service Line: ''
[17:54:53] ℹ️  Order extraction - Payer Source: ''
[17:54:53] ✅ Order data extraction completed successfully
[17:54:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:54:53] ℹ️  Using MRN from patient data: '2553385' over '2553385'
[17:54:53] ℹ️  Using service line from patient data: 'Physical Therapy'
[17:54:53] ✅ Patient name cross-validation successful
[17:54:53] ✅    ✅ Data merged successfully
[17:54:54] ✅    ✅ Order data extracted and validated
[17:54:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:55:03] [DOC: 9262191] ✅ Patient exists in API: Curtis Hardy IV, ID: bbd3ae67-b0d5-4ae7-929a-029f2d79d816
[17:55:03] ✅    ✅ Existing patient found with ID: bbd3ae67-b0d5-4ae7-929a-029f2d79d816
[17:55:03] 🔄 
🔄 Step 6: Pushing order to API...
[17:55:03] [DOC: 9262191] ℹ️  Pushing order via API for patient ID: bbd3ae67-b0d5-4ae7-929a-029f2d79d816
[17:55:05] [DOC: 9262191] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19667"}
[17:55:05] ❌    ❌ Failed to push order
[17:55:05] 🔄 
🔄 Step 7: Writing to CSV...
[17:55:05] [DOC: 9262191] ℹ️  Calculated age: 60 from DOB: 06/17/1964
[17:55:05] [DOC: 9262191] ℹ️  Service Line extracted: 'Physical Therapy'
[17:55:05] [DOC: 9262191] ℹ️  Payer Source extracted: ''
[17:55:05] [DOC: 9262191] ℹ️  Diagnosis codes being written:
[17:55:05] [DOC: 9262191] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:55:05] [DOC: 9262191] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:55:05] [DOC: 9262191] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:55:05] [DOC: 9262191] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:55:05] [DOC: 9262191] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:55:05] [DOC: 9262191] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:55:05] [DOC: 9262191] ✅ Patient data written to CSV: Curtis Hardy IV | Sex: MALE | Age: 60 | Service: Physical Therapy | Payer:  | MRN: 2553385
[17:55:05] ✅    ✅ Document 9262191 processed and saved successfully
[17:55:05] 🔄 
🔄 Step 8: Saving API details...
[17:55:05] [DOC: 9262191] ℹ️  API push details saved for document 9262191
[17:55:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9262190                         ║
================================================================================
[17:55:05] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:55:05] ℹ️  Date: 04/25/2025
[17:55:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:55:06] [DOC: 9262190] ✅ Text extracted using pdfplumber (1433 chars)
[17:55:06] ✅    ✅ Text extracted using pdfplumber (1433 chars)
[17:55:06] 🔄 
🔄 Step 2: Extracting patient data...
[17:55:09] ℹ️  AI extracted raw sex value: 'M'
[17:55:09] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:55:09] ℹ️  AI extracted payer source: ''
[17:55:09] ℹ️  AI extracted diagnoses:
[17:55:09] ℹ️    - Diagnosis 1: ''
[17:55:09] ℹ️    - Diagnosis 2: ''
[17:55:09] ℹ️    - Diagnosis 3: ''
[17:55:09] ℹ️    - Diagnosis 4: ''
[17:55:09] ℹ️    - Diagnosis 5: ''
[17:55:09] ℹ️    - Diagnosis 6: ''
[17:55:09] ℹ️  Final extracted MRN: '2113948'
[17:55:09] ℹ️  Final extracted Sex: 'MALE'
[17:55:09] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:55:09] ℹ️  Final extracted Payer Source: ''
[17:55:09] ✅ Patient data extraction completed successfully
[17:55:09] ✅    ✅ Patient data extracted successfully
[17:55:09] 📊 Patient Response
     └─ patientFName: Jay
     └─ patientLName: Greenspan
     └─ dob: 03/11/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2113948
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:55:09] ✅    ✅ Patient identified: Jay Greenspan
[17:55:09] ✅    ✅ Patient name validation passed
[17:55:09] 🔄 
🔄 Step 3: Processing patient dates...
[17:55:09] [DOC: 9262190] ℹ️  DOB normalized: 03/11/1942
[17:55:09] [DOC: 9262190] ✅ Patient date processing completed successfully
[17:55:09] ✅    ✅ Date processing completed
[17:55:09] 📊 Processed Patient Data
     └─ patientFName: Jay
     └─ patientLName: Greenspan
     └─ dob: 03/11/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 2113948
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:55:09] 🔄 
🔄 Step 4: Extracting order data...
[17:55:11] ℹ️  Order extraction - MRN: '2113948'
[17:55:11] ℹ️  Order extraction - Sex: 'MALE'
[17:55:11] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[17:55:11] ℹ️  Order extraction - Payer Source: ''
[17:55:11] ✅ Order data extraction completed successfully
[17:55:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:55:11] ℹ️  Using MRN from patient data: '2113948' over '2113948'
[17:55:11] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[17:55:11] ✅ Patient name cross-validation successful
[17:55:11] ✅    ✅ Data merged successfully
[17:55:12] ✅    ✅ Order data extracted and validated
[17:55:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:55:17] [DOC: 9262190] ✅ Patient exists in API: Jay Greenspan, ID: 1939a2d2-70c3-4e3e-a402-a4eccf79fb4a
[17:55:17] ✅    ✅ Existing patient found with ID: 1939a2d2-70c3-4e3e-a402-a4eccf79fb4a
[17:55:17] 🔄 
🔄 Step 6: Pushing order to API...
[17:55:17] [DOC: 9262190] ℹ️  Pushing order via API for patient ID: 1939a2d2-70c3-4e3e-a402-a4eccf79fb4a
[17:55:18] [DOC: 9262190] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13051"}
[17:55:18] ❌    ❌ Failed to push order
[17:55:18] 🔄 
🔄 Step 7: Writing to CSV...
[17:55:18] [DOC: 9262190] ℹ️  Calculated age: 83 from DOB: 03/11/1942
[17:55:18] [DOC: 9262190] ℹ️  Service Line extracted: 'Skilled Nursing'
[17:55:18] [DOC: 9262190] ℹ️  Payer Source extracted: ''
[17:55:18] [DOC: 9262190] ℹ️  Diagnosis codes being written:
[17:55:18] [DOC: 9262190] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:55:18] [DOC: 9262190] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:55:18] [DOC: 9262190] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:55:18] [DOC: 9262190] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:55:18] [DOC: 9262190] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:55:18] [DOC: 9262190] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:55:18] [DOC: 9262190] ✅ Patient data written to CSV: Jay Greenspan | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer:  | MRN: 2113948
[17:55:18] ✅    ✅ Document 9262190 processed and saved successfully
[17:55:18] 🔄 
🔄 Step 8: Saving API details...
[17:55:18] [DOC: 9262190] ℹ️  API push details saved for document 9262190
[17:55:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9262187                         ║
================================================================================
[17:55:18] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:55:18] ℹ️  Date: 04/25/2025
[17:55:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:55:20] [DOC: 9262187] ✅ Text extracted using pdfplumber (912 chars)
[17:55:20] ✅    ✅ Text extracted using pdfplumber (912 chars)
[17:55:20] 🔄 
🔄 Step 2: Extracting patient data...
[17:55:22] ℹ️  AI extracted raw sex value: 'M'
[17:55:22] ℹ️  AI extracted service line: 'OT'
[17:55:22] ℹ️  AI extracted payer source: ''
[17:55:22] ℹ️  AI extracted diagnoses:
[17:55:22] ℹ️    - Diagnosis 1: 'None'
[17:55:22] ℹ️    - Diagnosis 2: 'None'
[17:55:22] ℹ️    - Diagnosis 3: 'None'
[17:55:22] ℹ️    - Diagnosis 4: 'None'
[17:55:22] ℹ️    - Diagnosis 5: 'None'
[17:55:22] ℹ️    - Diagnosis 6: 'None'
[17:55:22] ℹ️  Final extracted MRN: '2475455'
[17:55:22] ℹ️  Final extracted Sex: 'MALE'
[17:55:22] ℹ️  Final extracted Service Line: 'OT'
[17:55:22] ℹ️  Final extracted Payer Source: ''
[17:55:22] ✅ Patient data extraction completed successfully
[17:55:22] ✅    ✅ Patient data extracted successfully
[17:55:22] 📊 Patient Response
     └─ patientFName: Jay
     └─ patientLName: Flanagan
     └─ dob: 11/01/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 2475455
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:55:22] ✅    ✅ Patient identified: Jay Flanagan
[17:55:22] ✅    ✅ Patient name validation passed
[17:55:22] 🔄 
🔄 Step 3: Processing patient dates...
[17:55:22] [DOC: 9262187] ℹ️  DOB normalized: 11/01/1951
[17:55:22] [DOC: 9262187] ✅ Patient date processing completed successfully
[17:55:22] ✅    ✅ Date processing completed
[17:55:22] 📊 Processed Patient Data
     └─ patientFName: Jay
     └─ patientLName: Flanagan
     └─ dob: 11/01/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 2475455
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:55:22] 🔄 
🔄 Step 4: Extracting order data...
[17:55:25] ℹ️  Order extraction - MRN: '2475455'
[17:55:25] ℹ️  Order extraction - Sex: 'MALE'
[17:55:25] ℹ️  Order extraction - Service Line: ''
[17:55:25] ℹ️  Order extraction - Payer Source: ''
[17:55:25] ✅ Order data extraction completed successfully
[17:55:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:55:25] ℹ️  Using MRN from patient data: '2475455' over '2475455'
[17:55:25] ℹ️  Using service line from patient data: 'OT'
[17:55:25] ✅ Patient name cross-validation successful
[17:55:25] ✅    ✅ Data merged successfully
[17:55:26] ✅    ✅ Order data extracted and validated
[17:55:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:55:35] [DOC: 9262187] ℹ️  Patient not found in cache or API: Jay Flanagan
[17:55:35] [DOC: 9262187] ℹ️  Patient not found, creating new patient via API...
[17:55:35] [DOC: 9262187] ℹ️  Creating patient via API: Jay Flanagan
[17:55:36] [DOC: 9262187] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:55:36] ❌    ❌ Failed to create patient
[17:55:36] [DOC: 9262187] ℹ️  API push details saved for document 9262187
================================================================================
║                        Processing Document ID: 9262185                         ║
================================================================================
[17:55:36] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:55:36] ℹ️  Date: 04/25/2025
[17:55:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:55:38] [DOC: 9262185] ✅ Text extracted using pdfplumber (1000 chars)
[17:55:38] ✅    ✅ Text extracted using pdfplumber (1000 chars)
[17:55:38] 🔄 
🔄 Step 2: Extracting patient data...
[17:55:40] ℹ️  AI extracted raw sex value: 'M'
[17:55:40] ℹ️  AI extracted service line: 'Skilled Nursing'
[17:55:40] ℹ️  AI extracted payer source: ''
[17:55:40] ℹ️  AI extracted diagnoses:
[17:55:40] ℹ️    - Diagnosis 1: 'None'
[17:55:40] ℹ️    - Diagnosis 2: 'None'
[17:55:40] ℹ️    - Diagnosis 3: 'None'
[17:55:40] ℹ️    - Diagnosis 4: 'None'
[17:55:40] ℹ️    - Diagnosis 5: 'None'
[17:55:40] ℹ️    - Diagnosis 6: 'None'
[17:55:40] ℹ️  Final extracted MRN: '2428686'
[17:55:40] ℹ️  Final extracted Sex: 'MALE'
[17:55:40] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[17:55:40] ℹ️  Final extracted Payer Source: ''
[17:55:40] ✅ Patient data extraction completed successfully
[17:55:40] ✅    ✅ Patient data extracted successfully
[17:55:40] 📊 Patient Response
     └─ patientFName: Jerome
     └─ patientLName: Doyon
     └─ dob: 03/02/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2428686
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:55:40] ✅    ✅ Patient identified: Jerome Doyon
[17:55:40] ✅    ✅ Patient name validation passed
[17:55:40] 🔄 
🔄 Step 3: Processing patient dates...
[17:55:40] [DOC: 9262185] ℹ️  DOB normalized: 03/02/1934
[17:55:40] [DOC: 9262185] ✅ Patient date processing completed successfully
[17:55:40] ✅    ✅ Date processing completed
[17:55:40] 📊 Processed Patient Data
     └─ patientFName: Jerome
     └─ patientLName: Doyon
     └─ dob: 03/02/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2428686
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:55:40] 🔄 
🔄 Step 4: Extracting order data...
[17:55:42] ℹ️  Order extraction - MRN: '2428686'
[17:55:42] ℹ️  Order extraction - Sex: 'MALE'
[17:55:42] ℹ️  Order extraction - Service Line: ''
[17:55:42] ℹ️  Order extraction - Payer Source: ''
[17:55:42] ✅ Order data extraction completed successfully
[17:55:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:55:42] ℹ️  Using MRN from patient data: '2428686' over '2428686'
[17:55:42] ℹ️  Using service line from patient data: 'Skilled Nursing'
[17:55:42] ✅ Patient name cross-validation successful
[17:55:42] ✅    ✅ Data merged successfully
[17:55:44] ✅    ✅ Order data extracted and validated
[17:55:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:55:51] [DOC: 9262185] ℹ️  Patient not found in cache or API: Jerome Doyon
[17:55:51] [DOC: 9262185] ℹ️  Patient not found, creating new patient via API...
[17:55:51] [DOC: 9262185] ℹ️  Creating patient via API: Jerome Doyon
[17:55:53] [DOC: 9262185] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:55:53] ❌    ❌ Failed to create patient
[17:55:53] [DOC: 9262185] ℹ️  API push details saved for document 9262185
================================================================================
║                        Processing Document ID: 9262181                         ║
================================================================================
[17:55:53] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:55:53] ℹ️  Date: 04/25/2025
[17:55:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:55:55] [DOC: 9262181] ✅ Text extracted using pdfplumber (7354 chars)
[17:55:55] ✅    ✅ Text extracted using pdfplumber (7354 chars)
[17:55:55] 🔄 
🔄 Step 2: Extracting patient data...
[17:55:58] ℹ️  AI extracted raw sex value: 'M'
[17:55:58] ℹ️  AI extracted service line: 'Hospice'
[17:55:58] ℹ️  AI extracted payer source: ''
[17:55:58] ℹ️  AI extracted diagnoses:
[17:55:58] ℹ️    - Diagnosis 1: 'I61.31'
[17:55:58] ℹ️    - Diagnosis 2: 'G31.1'
[17:55:58] ℹ️    - Diagnosis 3: ''
[17:55:58] ℹ️    - Diagnosis 4: ''
[17:55:58] ℹ️    - Diagnosis 5: ''
[17:55:58] ℹ️    - Diagnosis 6: ''
[17:55:58] ℹ️  Final extracted MRN: '2428686'
[17:55:58] ℹ️  Final extracted Sex: 'MALE'
[17:55:58] ℹ️  Final extracted Service Line: 'Hospice'
[17:55:58] ℹ️  Final extracted Payer Source: ''
[17:55:58] ✅ Patient data extraction completed successfully
[17:55:58] ✅    ✅ Patient data extracted successfully
[17:55:58] 📊 Patient Response
     └─ patientFName: Jerome
     └─ patientLName: Doyon
     └─ dob: 03/02/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2428686
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Hospice
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/24/2025', 'startOfEpisode': '04/24/2025', 'endOfEpisode': '07/22/2025', 'firstDiagnosis': 'I61.31', 'secondDiagnosis': 'G31.1', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:55:58] ✅    ✅ Patient identified: Jerome Doyon
[17:55:58] ✅    ✅ Patient name validation passed
[17:55:58] 🔄 
🔄 Step 3: Processing patient dates...
[17:55:58] [DOC: 9262181] ℹ️  DOB normalized: 03/02/1934
[17:55:58] [DOC: 9262181] ℹ️  Episode startOfCare normalized: 04/24/2025
[17:55:58] [DOC: 9262181] ℹ️  Episode startOfEpisode normalized: 04/24/2025
[17:55:58] [DOC: 9262181] ℹ️  Episode endOfEpisode normalized: 07/22/2025
[17:55:58] [DOC: 9262181] ✅ Patient date processing completed successfully
[17:55:58] ✅    ✅ Date processing completed
[17:55:58] 📊 Processed Patient Data
     └─ patientFName: Jerome
     └─ patientLName: Doyon
     └─ dob: 03/02/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2428686
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Hospice
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/24/2025', 'startOfEpisode': '04/24/2025', 'endOfEpisode': '07/22/2025', 'firstDiagnosis': 'I61.31', 'secondDiagnosis': 'G31.1', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:55:58] 🔄 
🔄 Step 4: Extracting order data...
[17:56:00] ℹ️  Order extraction - MRN: '2428686'
[17:56:00] ℹ️  Order extraction - Sex: 'MALE'
[17:56:00] ℹ️  Order extraction - Service Line: 'Hospice'
[17:56:00] ℹ️  Order extraction - Payer Source: ''
[17:56:00] ✅ Order data extraction completed successfully
[17:56:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:56:00] ℹ️  Using MRN from patient data: '2428686' over '2428686'
[17:56:00] ℹ️  Service line consistent in both sources: 'Hospice'
[17:56:00] ✅ Patient name cross-validation successful
[17:56:00] ✅    ✅ Data merged successfully
[17:56:02] ✅    ✅ Order data extracted and validated
[17:56:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:56:08] [DOC: 9262181] ℹ️  Patient not found in cache or API: Jerome Doyon
[17:56:08] [DOC: 9262181] ℹ️  Patient not found, creating new patient via API...
[17:56:08] [DOC: 9262181] ℹ️  Creating patient via API: Jerome Doyon
[17:56:09] [DOC: 9262181] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:56:09] ❌    ❌ Failed to create patient
[17:56:09] [DOC: 9262181] ℹ️  API push details saved for document 9262181
================================================================================
║                        Processing Document ID: 9262170                         ║
================================================================================
[17:56:09] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:56:09] ℹ️  Date: 04/25/2025
[17:56:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:56:10] [DOC: 9262170] ✅ Text extracted using pdfplumber (1508 chars)
[17:56:10] ✅    ✅ Text extracted using pdfplumber (1508 chars)
[17:56:10] 🔄 
🔄 Step 2: Extracting patient data...
[17:56:13] ℹ️  AI extracted raw sex value: 'F'
[17:56:13] ℹ️  AI extracted service line: 'Physical Therapy'
[17:56:13] ℹ️  AI extracted payer source: ''
[17:56:13] ℹ️  AI extracted diagnoses:
[17:56:13] ℹ️    - Diagnosis 1: 'None'
[17:56:13] ℹ️    - Diagnosis 2: 'None'
[17:56:13] ℹ️    - Diagnosis 3: 'None'
[17:56:13] ℹ️    - Diagnosis 4: 'None'
[17:56:13] ℹ️    - Diagnosis 5: 'None'
[17:56:13] ℹ️    - Diagnosis 6: 'None'
[17:56:13] ℹ️  Final extracted MRN: '2102046'
[17:56:13] ℹ️  Final extracted Sex: 'FEMALE'
[17:56:13] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:56:13] ℹ️  Final extracted Payer Source: ''
[17:56:13] ✅ Patient data extraction completed successfully
[17:56:13] ✅    ✅ Patient data extracted successfully
[17:56:13] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Cunha
     └─ dob: 06/04/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2102046
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:56:13] ✅    ✅ Patient identified: Maria Cunha
[17:56:13] ✅    ✅ Patient name validation passed
[17:56:13] 🔄 
🔄 Step 3: Processing patient dates...
[17:56:13] [DOC: 9262170] ℹ️  DOB normalized: 06/04/1930
[17:56:13] [DOC: 9262170] ✅ Patient date processing completed successfully
[17:56:13] ✅    ✅ Date processing completed
[17:56:13] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Cunha
     └─ dob: 06/04/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2102046
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[17:56:13] 🔄 
🔄 Step 4: Extracting order data...
[17:56:15] ℹ️  Order extraction - MRN: '2102046'
[17:56:15] ℹ️  Order extraction - Sex: 'FEMALE'
[17:56:15] ℹ️  Order extraction - Service Line: ''
[17:56:15] ℹ️  Order extraction - Payer Source: ''
[17:56:15] ✅ Order data extraction completed successfully
[17:56:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:56:15] ℹ️  Using MRN from patient data: '2102046' over '2102046'
[17:56:15] ℹ️  Using service line from patient data: 'Physical Therapy'
[17:56:15] ✅ Patient name cross-validation successful
[17:56:15] ✅    ✅ Data merged successfully
[17:56:16] ⚠️     ❌ Skipping - missing episode start date
[17:56:16] [DOC: 9262170] ℹ️  API push details saved for document 9262170
================================================================================
║                        Processing Document ID: 9262169                         ║
================================================================================
[17:56:16] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:56:16] ℹ️  Date: 04/25/2025
[17:56:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:56:18] [DOC: 9262169] ✅ Text extracted using pdfplumber (1540 chars)
[17:56:18] ✅    ✅ Text extracted using pdfplumber (1540 chars)
[17:56:18] 🔄 
🔄 Step 2: Extracting patient data...
[17:56:20] ℹ️  AI extracted raw sex value: 'F'
[17:56:20] ℹ️  AI extracted service line: 'RN'
[17:56:20] ℹ️  AI extracted payer source: ''
[17:56:20] ℹ️  AI extracted diagnoses:
[17:56:20] ℹ️    - Diagnosis 1: ''
[17:56:20] ℹ️    - Diagnosis 2: ''
[17:56:20] ℹ️    - Diagnosis 3: ''
[17:56:20] ℹ️    - Diagnosis 4: ''
[17:56:20] ℹ️    - Diagnosis 5: ''
[17:56:20] ℹ️    - Diagnosis 6: ''
[17:56:20] ℹ️  Final extracted MRN: '2316868'
[17:56:20] ℹ️  Final extracted Sex: 'FEMALE'
[17:56:20] ℹ️  Final extracted Service Line: 'RN'
[17:56:20] ℹ️  Final extracted Payer Source: ''
[17:56:20] ✅ Patient data extraction completed successfully
[17:56:20] ✅    ✅ Patient data extracted successfully
[17:56:20] 📊 Patient Response
     └─ patientFName: Manuela
     └─ patientLName: Castro
     └─ dob: 08/19/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2316868
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:56:20] ✅    ✅ Patient identified: Manuela Castro
[17:56:20] ✅    ✅ Patient name validation passed
[17:56:20] 🔄 
🔄 Step 3: Processing patient dates...
[17:56:20] [DOC: 9262169] ℹ️  DOB normalized: 08/19/1946
[17:56:20] [DOC: 9262169] ✅ Patient date processing completed successfully
[17:56:20] ✅    ✅ Date processing completed
[17:56:20] 📊 Processed Patient Data
     └─ patientFName: Manuela
     └─ patientLName: Castro
     └─ dob: 08/19/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2316868
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:56:20] 🔄 
🔄 Step 4: Extracting order data...
[17:56:23] ℹ️  Order extraction - MRN: '2316868'
[17:56:23] ℹ️  Order extraction - Sex: 'FEMALE'
[17:56:23] ℹ️  Order extraction - Service Line: ''
[17:56:23] ℹ️  Order extraction - Payer Source: ''
[17:56:23] ✅ Order data extraction completed successfully
[17:56:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:56:23] ℹ️  Using MRN from patient data: '2316868' over '2316868'
[17:56:23] ℹ️  Using service line from patient data: 'RN'
[17:56:23] ✅ Patient name cross-validation successful
[17:56:23] ✅    ✅ Data merged successfully
[17:56:24] ⚠️     ❌ Skipping - missing episode start date
[17:56:24] [DOC: 9262169] ℹ️  API push details saved for document 9262169
================================================================================
║                        Processing Document ID: 9262159                         ║
================================================================================
[17:56:24] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[17:56:24] ℹ️  Date: 04/25/2025
[17:56:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:56:27] [DOC: 9262159] ✅ Text extracted using pdfplumber (26622 chars)
[17:56:27] ✅    ✅ Text extracted using pdfplumber (26612 chars)
[17:56:27] 🔄 
🔄 Step 2: Extracting patient data...
[17:56:31] ℹ️  AI extracted raw sex value: 'F'
[17:56:31] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[17:56:31] ℹ️  AI extracted payer source: ''
[17:56:31] ℹ️  AI extracted diagnoses:
[17:56:31] ℹ️    - Diagnosis 1: 'J44.1'
[17:56:31] ℹ️    - Diagnosis 2: 'J44.0'
[17:56:31] ℹ️    - Diagnosis 3: 'J18.9'
[17:56:31] ℹ️    - Diagnosis 4: 'I11.0'
[17:56:31] ℹ️    - Diagnosis 5: 'I50.33'
[17:56:31] ℹ️    - Diagnosis 6: 'E11.9'
[17:56:31] ℹ️  Final extracted MRN: '2182563'
[17:56:31] ℹ️  Final extracted Sex: 'FEMALE'
[17:56:31] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[17:56:31] ℹ️  Final extracted Payer Source: ''
[17:56:31] ✅ Patient data extraction completed successfully
[17:56:31] ✅    ✅ Patient data extracted successfully
[17:56:31] 📊 Patient Response
     └─ patientFName: Lois
     └─ patientLName: Alves
     └─ dob: 05/13/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2182563
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '06/11/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J44.0', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.33', 'sixthDiagnosis': 'E11.9'}]
[17:56:31] ✅    ✅ Patient identified: Lois Alves
[17:56:31] ✅    ✅ Patient name validation passed
[17:56:31] 🔄 
🔄 Step 3: Processing patient dates...
[17:56:31] [DOC: 9262159] ℹ️  DOB normalized: 05/13/1951
[17:56:31] [DOC: 9262159] ℹ️  Episode startOfCare normalized: 04/11/2025
[17:56:31] [DOC: 9262159] ℹ️  Episode startOfEpisode normalized: 04/13/2025
[17:56:31] [DOC: 9262159] ℹ️  Episode endOfEpisode normalized: 06/11/2025
[17:56:31] [DOC: 9262159] ✅ Patient date processing completed successfully
[17:56:31] ✅    ✅ Date processing completed
[17:56:31] 📊 Processed Patient Data
     └─ patientFName: Lois
     └─ patientLName: Alves
     └─ dob: 05/13/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2182563
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '06/11/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J44.0', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.33', 'sixthDiagnosis': 'E11.9'}]
[17:56:31] 🔄 
🔄 Step 4: Extracting order data...
[17:56:34] ℹ️  Order extraction - MRN: '2182563'
[17:56:34] ℹ️  Order extraction - Sex: 'FEMALE'
[17:56:34] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[17:56:34] ℹ️  Order extraction - Payer Source: ''
[17:56:34] ✅ Order data extraction completed successfully
[17:56:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:56:34] ℹ️  Using MRN from patient data: '2182563' over '2182563'
[17:56:34] ℹ️  Service line consistent in both sources: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[17:56:34] ✅ Patient name cross-validation successful
[17:56:34] ✅    ✅ Data merged successfully
[17:56:36] ✅    ✅ Order data extracted and validated
[17:56:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:56:42] [DOC: 9262159] ✅ Patient exists in API: Lois Alves, ID: 4724f2cc-508f-4d9d-86fe-13e23e62f9c5
[17:56:42] ✅    ✅ Existing patient found with ID: 4724f2cc-508f-4d9d-86fe-13e23e62f9c5
[17:56:42] 🔄 
🔄 Step 6: Pushing order to API...
[17:56:42] [DOC: 9262159] ℹ️  Pushing order via API for patient ID: 4724f2cc-508f-4d9d-86fe-13e23e62f9c5
[17:56:43] [DOC: 9262159] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12913"}
[17:56:43] ❌    ❌ Failed to push order
[17:56:43] 🔄 
🔄 Step 7: Writing to CSV...
[17:56:43] [DOC: 9262159] ℹ️  Calculated age: 74 from DOB: 05/13/1951
[17:56:43] [DOC: 9262159] ℹ️  Service Line extracted: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[17:56:43] [DOC: 9262159] ℹ️  Payer Source extracted: ''
[17:56:43] [DOC: 9262159] ℹ️  Diagnosis codes being written:
[17:56:43] [DOC: 9262159] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[17:56:43] [DOC: 9262159] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.0'
[17:56:43] [DOC: 9262159] ℹ️    - Latest_Episode_Thirddiagnosis: 'J18.9'
[17:56:43] [DOC: 9262159] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I11.0'
[17:56:43] [DOC: 9262159] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.33'
[17:56:43] [DOC: 9262159] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E11.9'
[17:56:43] [DOC: 9262159] ✅ Patient data written to CSV: Lois Alves | Sex: FEMALE | Age: 74 | Service: Skilled Nursing,Physical Therapy,Occupational Therapy | Payer:  | MRN: 2182563
[17:56:43] ✅    ✅ Document 9262159 processed and saved successfully
[17:56:43] 🔄 
🔄 Step 8: Saving API details...
[17:56:43] [DOC: 9262159] ℹ️  API push details saved for document 9262159
[17:56:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9262119                         ║
================================================================================
[17:56:43] ℹ️  Agency: AccentCare Fall River
[17:56:43] ℹ️  Date: 04/25/2025
[17:56:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:56:46] [DOC: 9262119] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[17:56:47] [DOC: 9262119] ✅ Text extracted using tesseract_ocr (1406 chars)
[17:56:47] ✅    ✅ Text extracted using tesseract_ocr (1401 chars)
[17:56:47] 🔄 
🔄 Step 2: Extracting patient data...
[17:56:50] ℹ️  AI extracted raw sex value: ''
[17:56:50] ℹ️  AI extracted service line: 'PT'
[17:56:50] ℹ️  AI extracted payer source: ''
[17:56:50] ℹ️  AI extracted diagnoses:
[17:56:50] ℹ️    - Diagnosis 1: ''
[17:56:50] ℹ️    - Diagnosis 2: ''
[17:56:50] ℹ️    - Diagnosis 3: ''
[17:56:50] ℹ️    - Diagnosis 4: ''
[17:56:50] ℹ️    - Diagnosis 5: ''
[17:56:50] ℹ️    - Diagnosis 6: ''
[17:56:50] ℹ️  Final extracted MRN: 'C0200204515501'
[17:56:50] ℹ️  Final extracted Sex: ''
[17:56:50] ℹ️  Final extracted Service Line: 'PT'
[17:56:50] ℹ️  Final extracted Payer Source: ''
[17:56:50] ✅ Patient data extraction completed successfully
[17:56:50] ✅    ✅ Patient data extracted successfully
[17:56:50] 📊 Patient Response
     └─ patientFName: MILTON
     └─ patientLName: ACOSTA JR
     └─ dob: 10/23/1982
     └─ patientSex: 
     └─ medicalRecordNo: C0200204515501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:56:50] ✅    ✅ Patient identified: MILTON ACOSTA JR
[17:56:50] ✅    ✅ Patient name validation passed
[17:56:50] 🔄 
🔄 Step 3: Processing patient dates...
[17:56:50] [DOC: 9262119] ℹ️  DOB normalized: 10/23/1982
[17:56:50] [DOC: 9262119] ✅ Patient date processing completed successfully
[17:56:50] ✅    ✅ Date processing completed
[17:56:50] 📊 Processed Patient Data
     └─ patientFName: MILTON
     └─ patientLName: ACOSTA JR
     └─ dob: 10/23/1982
     └─ patientSex: 
     └─ medicalRecordNo: C0200204515501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:56:50] 🔄 
🔄 Step 4: Extracting order data...
[17:56:52] ℹ️  Order extraction - MRN: 'C0200204515501'
[17:56:52] ℹ️  Order extraction - Sex: ''
[17:56:52] ℹ️  Order extraction - Service Line: 'PT'
[17:56:52] ℹ️  Order extraction - Payer Source: ''
[17:56:52] ✅ Order data extraction completed successfully
[17:56:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:56:52] ℹ️  Using MRN from patient data: 'C0200204515501' over 'C0200204515501'
[17:56:52] ℹ️  Inferred sex as MALE from name: MILTON
[17:56:52] ℹ️  Service line consistent in both sources: 'PT'
[17:56:52] ✅ Patient name cross-validation successful
[17:56:52] ✅    ✅ Data merged successfully
[17:56:53] ⚠️     ❌ Skipping - missing episode start date
[17:56:53] [DOC: 9262119] ℹ️  API push details saved for document 9262119
================================================================================
║                        Processing Document ID: 9261908                         ║
================================================================================
[17:56:53] ℹ️  Agency: Nizhoni Health-Fall River
[17:56:53] ℹ️  Date: 04/25/2025
[17:56:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:56:59] [DOC: 9261908] ✅ Text extracted using pdfplumber (1015 chars)
[17:56:59] ✅    ✅ Text extracted using pdfplumber (1015 chars)
[17:56:59] 🔄 
🔄 Step 2: Extracting patient data...
[17:57:02] ℹ️  AI extracted raw sex value: 'F'
[17:57:02] ℹ️  AI extracted service line: 'HHA'
[17:57:02] ℹ️  AI extracted payer source: 'Medicaid/MA'
[17:57:02] ℹ️  AI extracted diagnoses:
[17:57:02] ℹ️    - Diagnosis 1: 'None'
[17:57:02] ℹ️    - Diagnosis 2: 'None'
[17:57:02] ℹ️    - Diagnosis 3: 'None'
[17:57:02] ℹ️    - Diagnosis 4: 'None'
[17:57:02] ℹ️    - Diagnosis 5: 'None'
[17:57:02] ℹ️    - Diagnosis 6: 'None'
[17:57:02] ℹ️  Final extracted MRN: '3761020'
[17:57:02] ℹ️  Final extracted Sex: 'FEMALE'
[17:57:02] ℹ️  Final extracted Service Line: 'HHA'
[17:57:02] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[17:57:02] ✅ Patient data extraction completed successfully
[17:57:02] ✅    ✅ Patient data extracted successfully
[17:57:02] 📊 Patient Response
     └─ patientFName: Carol
     └─ patientLName: Jimon-Ajqui
     └─ dob: 08/23/1974
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3761020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 504 South Second St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2023', 'startOfEpisode': None, 'endOfEpisode': '06/21/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:57:02] ✅    ✅ Patient identified: Carol Jimon-Ajqui
[17:57:02] ✅    ✅ Patient name validation passed
[17:57:02] 🔄 
🔄 Step 3: Processing patient dates...
[17:57:02] [DOC: 9261908] ℹ️  DOB normalized: 08/23/1974
[17:57:02] [DOC: 9261908] ℹ️  Episode startOfCare normalized: 01/04/2023
[17:57:02] [DOC: 9261908] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[17:57:02] [DOC: 9261908] ✅ Patient date processing completed successfully
[17:57:02] ✅    ✅ Date processing completed
[17:57:02] 📊 Processed Patient Data
     └─ patientFName: Carol
     └─ patientLName: Jimon-Ajqui
     └─ dob: 08/23/1974
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3761020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 504 South Second St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2023', 'endOfEpisode': '06/21/2025'}]
[17:57:02] 🔄 
🔄 Step 4: Extracting order data...
[17:57:05] ℹ️  Order extraction - MRN: '3761020'
[17:57:05] ℹ️  Order extraction - Sex: 'FEMALE'
[17:57:05] ℹ️  Order extraction - Service Line: ''
[17:57:05] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[17:57:05] ✅ Order data extraction completed successfully
[17:57:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:57:05] ℹ️  Using MRN from patient data: '3761020' over '3761020'
[17:57:05] ℹ️  Using service line from patient data: 'HHA'
[17:57:05] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[17:57:05] ✅ Patient name cross-validation successful
[17:57:05] ✅    ✅ Data merged successfully
[17:57:06] ✅    ✅ Order data extracted and validated
[17:57:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:57:24] [DOC: 9261908] ℹ️  Patient not found in cache or API: Carol Jimon-Ajqui
[17:57:24] [DOC: 9261908] ℹ️  Patient not found, creating new patient via API...
[17:57:24] [DOC: 9261908] ℹ️  Creating patient via API: Carol Jimon-Ajqui
[17:57:25] [DOC: 9261908] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:57:25] ❌    ❌ Failed to create patient
[17:57:25] [DOC: 9261908] ℹ️  API push details saved for document 9261908
================================================================================
║                        Processing Document ID: 9261100                         ║
================================================================================
[17:57:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:57:25] ℹ️  Date: 04/25/2025
[17:57:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:57:28] [DOC: 9261100] ✅ Text extracted using pdfplumber (1431 chars)
[17:57:28] ✅    ✅ Text extracted using pdfplumber (1431 chars)
[17:57:28] 🔄 
🔄 Step 2: Extracting patient data...
[17:57:31] ℹ️  AI extracted raw sex value: ''
[17:57:31] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:57:31] ℹ️  AI extracted payer source: ''
[17:57:31] ℹ️  AI extracted diagnoses:
[17:57:31] ℹ️    - Diagnosis 1: 'J44.1'
[17:57:31] ℹ️    - Diagnosis 2: 'I11.0'
[17:57:31] ℹ️    - Diagnosis 3: 'I50.42'
[17:57:31] ℹ️    - Diagnosis 4: 'None'
[17:57:31] ℹ️    - Diagnosis 5: 'None'
[17:57:31] ℹ️    - Diagnosis 6: 'None'
[17:57:31] ℹ️  Final extracted MRN: 'MA200528053701'
[17:57:31] ℹ️  Final extracted Sex: ''
[17:57:31] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:57:31] ℹ️  Final extracted Payer Source: ''
[17:57:31] ✅ Patient data extraction completed successfully
[17:57:31] ✅    ✅ Patient data extracted successfully
[17:57:31] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.42', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:57:31] ✅    ✅ Patient identified: Roderick Lopez
[17:57:31] ✅    ✅ Patient name validation passed
[17:57:31] 🔄 
🔄 Step 3: Processing patient dates...
[17:57:31] [DOC: 9261100] ℹ️  DOB normalized: 05/21/1937
[17:57:31] [DOC: 9261100] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[17:57:31] [DOC: 9261100] ℹ️  Episode endOfEpisode normalized: 06/18/2025
[17:57:31] [DOC: 9261100] ✅ Patient date processing completed successfully
[17:57:31] ✅    ✅ Date processing completed
[17:57:31] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.42'}]
[17:57:31] 🔄 
🔄 Step 4: Extracting order data...
[17:57:33] ℹ️  Order extraction - MRN: 'MA200528053701'
[17:57:33] ℹ️  Order extraction - Sex: ''
[17:57:33] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:57:33] ℹ️  Order extraction - Payer Source: ''
[17:57:33] ✅ Order data extraction completed successfully
[17:57:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:57:33] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[17:57:33] ℹ️  Inferred sex as MALE from name: Roderick
[17:57:33] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:57:33] ✅ Patient name cross-validation successful
[17:57:33] ✅    ✅ Data merged successfully
[17:57:34] ✅    ✅ Order data extracted and validated
[17:57:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:57:48] [DOC: 9261100] ℹ️  Patient not found in cache or API: Roderick Lopez
[17:57:48] [DOC: 9261100] ℹ️  Patient not found, creating new patient via API...
[17:57:48] [DOC: 9261100] ℹ️  Creating patient via API: Roderick Lopez
[17:57:50] [DOC: 9261100] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[17:57:50] ❌    ❌ Failed to create patient
[17:57:50] [DOC: 9261100] ℹ️  API push details saved for document 9261100
================================================================================
║                        Processing Document ID: 9261091                         ║
================================================================================
[17:57:50] ℹ️  Agency: AccentCare Fall River
[17:57:50] ℹ️  Date: 04/25/2025
[17:57:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:57:53] [DOC: 9261091] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[17:57:54] [DOC: 9261091] ✅ Text extracted using tesseract_ocr (1412 chars)
[17:57:54] ✅    ✅ Text extracted using tesseract_ocr (1407 chars)
[17:57:54] 🔄 
🔄 Step 2: Extracting patient data...
[17:57:59] ℹ️  AI extracted raw sex value: ''
[17:57:59] ℹ️  AI extracted service line: 'Nursing'
[17:57:59] ℹ️  AI extracted payer source: ''
[17:57:59] ℹ️  AI extracted diagnoses:
[17:57:59] ℹ️    - Diagnosis 1: 'None'
[17:57:59] ℹ️    - Diagnosis 2: 'None'
[17:57:59] ℹ️    - Diagnosis 3: 'None'
[17:57:59] ℹ️    - Diagnosis 4: 'None'
[17:57:59] ℹ️    - Diagnosis 5: 'None'
[17:57:59] ℹ️    - Diagnosis 6: 'None'
[17:57:59] ℹ️  Final extracted MRN: 'C0200204515501'
[17:57:59] ℹ️  Final extracted Sex: ''
[17:57:59] ℹ️  Final extracted Service Line: 'Nursing'
[17:57:59] ℹ️  Final extracted Payer Source: ''
[17:57:59] ✅ Patient data extraction completed successfully
[17:57:59] ✅    ✅ Patient data extracted successfully
[17:57:59] 📊 Patient Response
     └─ patientFName: MILTON
     └─ patientLName: ACOSTA JR
     └─ dob: 10/23/1982
     └─ patientSex: 
     └─ medicalRecordNo: C0200204515501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '09/14/2024', 'endOfEpisode': '09/16/2024', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}, {'startOfCare': None, 'startOfEpisode': '09/16/2024', 'endOfEpisode': '09/18/2024', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}, {'startOfCare': None, 'startOfEpisode': '01/03/2025', 'endOfEpisode': '01/05/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}, {'startOfCare': None, 'startOfEpisode': '03/13/2025', 'endOfEpisode': '03/16/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:57:59] ✅    ✅ Patient identified: MILTON ACOSTA JR
[17:57:59] ✅    ✅ Patient name validation passed
[17:57:59] 🔄 
🔄 Step 3: Processing patient dates...
[17:57:59] [DOC: 9261091] ℹ️  DOB normalized: 10/23/1982
[17:57:59] [DOC: 9261091] ℹ️  Episode startOfEpisode normalized: 09/14/2024
[17:57:59] [DOC: 9261091] ℹ️  Episode endOfEpisode normalized: 09/16/2024
[17:57:59] [DOC: 9261091] ✅ Patient date processing completed successfully
[17:57:59] ✅    ✅ Date processing completed
[17:57:59] 📊 Processed Patient Data
     └─ patientFName: MILTON
     └─ patientLName: ACOSTA JR
     └─ dob: 10/23/1982
     └─ patientSex: 
     └─ medicalRecordNo: C0200204515501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '09/14/2024', 'endOfEpisode': '09/16/2024'}, {'startOfCare': '', 'startOfEpisode': '09/16/2024', 'endOfEpisode': '09/18/2024'}, {'startOfCare': '', 'startOfEpisode': '01/03/2025', 'endOfEpisode': '01/05/2025'}, {'startOfCare': '', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '03/16/2025'}]
[17:57:59] 🔄 
🔄 Step 4: Extracting order data...
[17:58:02] ℹ️  Order extraction - MRN: 'C0200204515501'
[17:58:02] ℹ️  Order extraction - Sex: ''
[17:58:02] ℹ️  Order extraction - Service Line: 'Nursing'
[17:58:02] ℹ️  Order extraction - Payer Source: ''
[17:58:02] ✅ Order data extraction completed successfully
[17:58:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:58:02] ℹ️  Using MRN from patient data: 'C0200204515501' over 'C0200204515501'
[17:58:02] ℹ️  Inferred sex as MALE from name: MILTON
[17:58:02] ℹ️  Service line consistent in both sources: 'Nursing'
[17:58:02] ✅ Patient name cross-validation successful
[17:58:02] ✅    ✅ Data merged successfully
[17:58:03] ⚠️     ❌ Skipping - missing episode start date
[17:58:03] [DOC: 9261091] ℹ️  API push details saved for document 9261091
================================================================================
║                        Processing Document ID: 9261092                         ║
================================================================================
[17:58:03] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:58:03] ℹ️  Date: 04/25/2025
[17:58:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:58:05] [DOC: 9261092] ✅ Text extracted using pdfplumber (1331 chars)
[17:58:05] ✅    ✅ Text extracted using pdfplumber (1331 chars)
[17:58:05] 🔄 
🔄 Step 2: Extracting patient data...
[17:58:08] ℹ️  AI extracted raw sex value: ''
[17:58:08] ℹ️  AI extracted service line: 'Physical Therapy'
[17:58:08] ℹ️  AI extracted payer source: ''
[17:58:08] ℹ️  AI extracted diagnoses:
[17:58:08] ℹ️    - Diagnosis 1: 'N30.00'
[17:58:08] ℹ️    - Diagnosis 2: 'E11.9'
[17:58:08] ℹ️    - Diagnosis 3: 'F41.1'
[17:58:08] ℹ️    - Diagnosis 4: ''
[17:58:08] ℹ️    - Diagnosis 5: ''
[17:58:08] ℹ️    - Diagnosis 6: ''
[17:58:08] ℹ️  Final extracted MRN: '101002392'
[17:58:08] ℹ️  Final extracted Sex: ''
[17:58:08] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:58:08] ℹ️  Final extracted Payer Source: ''
[17:58:08] ✅ Patient data extraction completed successfully
[17:58:08] ✅    ✅ Patient data extracted successfully
[17:58:08] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:58:08] ✅    ✅ Patient identified: Virginia Brunton
[17:58:08] ✅    ✅ Patient name validation passed
[17:58:08] 🔄 
🔄 Step 3: Processing patient dates...
[17:58:08] [DOC: 9261092] ℹ️  DOB normalized: 06/05/1940
[17:58:08] [DOC: 9261092] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[17:58:08] [DOC: 9261092] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[17:58:08] [DOC: 9261092] ✅ Patient date processing completed successfully
[17:58:08] ✅    ✅ Date processing completed
[17:58:08] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: 
     └─ medicalRecordNo: 101002392
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N30.00', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:58:08] 🔄 
🔄 Step 4: Extracting order data...
[17:58:11] ℹ️  Order extraction - MRN: '101002392'
[17:58:11] ℹ️  Order extraction - Sex: ''
[17:58:11] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:58:11] ℹ️  Order extraction - Payer Source: ''
[17:58:11] ✅ Order data extraction completed successfully
[17:58:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:58:11] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[17:58:11] ℹ️  Inferred sex as FEMALE from name: Virginia
[17:58:11] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:58:11] ✅ Patient name cross-validation successful
[17:58:11] ✅    ✅ Data merged successfully
[17:58:12] ✅    ✅ Order data extracted and validated
[17:58:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:58:12] [DOC: 9261092] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[17:58:12] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[17:58:12] 🔄 
🔄 Step 6: Pushing order to API...
[17:58:12] [DOC: 9261092] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[17:58:13] [DOC: 9261092] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13404"}
[17:58:13] ❌    ❌ Failed to push order
[17:58:13] 🔄 
🔄 Step 7: Writing to CSV...
[17:58:13] [DOC: 9261092] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[17:58:13] [DOC: 9261092] ℹ️  Service Line extracted: 'Physical Therapy'
[17:58:13] [DOC: 9261092] ℹ️  Payer Source extracted: ''
[17:58:13] [DOC: 9261092] ℹ️  Diagnosis codes being written:
[17:58:13] [DOC: 9261092] ℹ️    - Latest_Episode_Firstdiagnosis: 'N30.00'
[17:58:13] [DOC: 9261092] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[17:58:13] [DOC: 9261092] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[17:58:13] [DOC: 9261092] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:58:13] [DOC: 9261092] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:58:13] [DOC: 9261092] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:58:13] [DOC: 9261092] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: Physical Therapy | Payer:  | MRN: 101002392
[17:58:13] ✅    ✅ Document 9261092 processed and saved successfully
[17:58:13] 🔄 
🔄 Step 8: Saving API details...
[17:58:13] [DOC: 9261092] ℹ️  API push details saved for document 9261092
[17:58:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9261089                         ║
================================================================================
[17:58:13] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:58:13] ℹ️  Date: 04/25/2025
[17:58:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:58:16] [DOC: 9261089] ✅ Text extracted using pdfplumber (17224 chars)
[17:58:16] ✅    ✅ Text extracted using pdfplumber (17224 chars)
[17:58:16] 🔄 
🔄 Step 2: Extracting patient data...
[17:58:20] ℹ️  AI extracted raw sex value: 'F'
[17:58:20] ℹ️  AI extracted service line: 'PT'
[17:58:20] ℹ️  AI extracted payer source: 'None'
[17:58:20] ℹ️  AI extracted diagnoses:
[17:58:20] ℹ️    - Diagnosis 1: 'UTI'
[17:58:20] ℹ️    - Diagnosis 2: 'Vertigo'
[17:58:20] ℹ️    - Diagnosis 3: 'None'
[17:58:20] ℹ️    - Diagnosis 4: 'None'
[17:58:20] ℹ️    - Diagnosis 5: 'None'
[17:58:20] ℹ️    - Diagnosis 6: 'None'
[17:58:20] ℹ️  Final extracted MRN: '101002392'
[17:58:20] ℹ️  Final extracted Sex: 'FEMALE'
[17:58:20] ℹ️  Final extracted Service Line: 'PT'
[17:58:20] ℹ️  Final extracted Payer Source: ''
[17:58:20] ✅ Patient data extraction completed successfully
[17:58:20] ✅    ✅ Patient data extracted successfully
[17:58:20] 📊 Patient Response
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/17/2025', 'endOfEpisode': None, 'firstDiagnosis': 'UTI', 'secondDiagnosis': 'Vertigo', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:58:20] ✅    ✅ Patient identified: Virginia Brunton
[17:58:20] ✅    ✅ Patient name validation passed
[17:58:20] 🔄 
🔄 Step 3: Processing patient dates...
[17:58:20] [DOC: 9261089] ℹ️  DOB normalized: 06/05/1940
[17:58:20] [DOC: 9261089] ℹ️  Episode startOfEpisode normalized: 04/17/2025
[17:58:20] [DOC: 9261089] ✅ Patient date processing completed successfully
[17:58:20] ✅    ✅ Date processing completed
[17:58:20] 📊 Processed Patient Data
     └─ patientFName: Virginia
     └─ patientLName: Brunton
     └─ dob: 06/05/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 101002392
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/17/2025', 'firstDiagnosis': 'UTI', 'secondDiagnosis': 'Vertigo'}]
[17:58:20] 🔄 
🔄 Step 4: Extracting order data...
[17:58:23] ℹ️  Order extraction - MRN: '101002392'
[17:58:23] ℹ️  Order extraction - Sex: 'FEMALE'
[17:58:23] ℹ️  Order extraction - Service Line: 'PT'
[17:58:23] ℹ️  Order extraction - Payer Source: ''
[17:58:23] ✅ Order data extraction completed successfully
[17:58:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:58:23] ℹ️  Using MRN from patient data: '101002392' over '101002392'
[17:58:23] ℹ️  Service line consistent in both sources: 'PT'
[17:58:23] ✅ Patient name cross-validation successful
[17:58:23] ✅    ✅ Data merged successfully
[17:58:24] ✅    ✅ Order data extracted and validated
[17:58:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:58:24] [DOC: 9261089] ✅ Patient found in local cache: Virginia Brunton, ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[17:58:24] ✅    ✅ Existing patient found with ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[17:58:24] 🔄 
🔄 Step 6: Pushing order to API...
[17:58:24] [DOC: 9261089] ℹ️  Pushing order via API for patient ID: 1dfe1667-8fe2-4a04-bd64-0b58b891f126
[17:58:25] [DOC: 9261089] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:58:25] ❌    ❌ Failed to push order
[17:58:25] 🔄 
🔄 Step 7: Writing to CSV...
[17:58:25] [DOC: 9261089] ℹ️  Calculated age: 85 from DOB: 06/05/1940
[17:58:25] [DOC: 9261089] ℹ️  Service Line extracted: 'PT'
[17:58:25] [DOC: 9261089] ℹ️  Payer Source extracted: ''
[17:58:25] [DOC: 9261089] ℹ️  Diagnosis codes being written:
[17:58:25] [DOC: 9261089] ℹ️    - Latest_Episode_Firstdiagnosis: 'UTI'
[17:58:25] [DOC: 9261089] ℹ️    - Latest_Episode_Seconddiagnosis: 'Vertigo'
[17:58:25] [DOC: 9261089] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:58:25] [DOC: 9261089] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:58:25] [DOC: 9261089] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:58:25] [DOC: 9261089] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:58:25] [DOC: 9261089] ✅ Patient data written to CSV: Virginia Brunton | Sex: FEMALE | Age: 85 | Service: PT | Payer:  | MRN: 101002392
[17:58:25] ✅    ✅ Document 9261089 processed and saved successfully
[17:58:25] 🔄 
🔄 Step 8: Saving API details...
[17:58:25] [DOC: 9261089] ℹ️  API push details saved for document 9261089
[17:58:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9261080                         ║
================================================================================
[17:58:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:58:25] ℹ️  Date: 04/25/2025
[17:58:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:58:28] [DOC: 9261080] ✅ Text extracted using pdfplumber (1475 chars)
[17:58:28] ✅    ✅ Text extracted using pdfplumber (1475 chars)
[17:58:28] 🔄 
🔄 Step 2: Extracting patient data...
[17:58:31] ℹ️  AI extracted raw sex value: ''
[17:58:31] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:58:31] ℹ️  AI extracted payer source: ''
[17:58:31] ℹ️  AI extracted diagnoses:
[17:58:31] ℹ️    - Diagnosis 1: 'F03.90'
[17:58:31] ℹ️    - Diagnosis 2: 'R60.9'
[17:58:31] ℹ️    - Diagnosis 3: 'G47.9'
[17:58:31] ℹ️    - Diagnosis 4: 'None'
[17:58:31] ℹ️    - Diagnosis 5: 'None'
[17:58:31] ℹ️    - Diagnosis 6: 'None'
[17:58:31] ℹ️  Final extracted MRN: 'MA221012023702'
[17:58:31] ℹ️  Final extracted Sex: ''
[17:58:31] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:58:31] ℹ️  Final extracted Payer Source: ''
[17:58:31] ✅ Patient data extraction completed successfully
[17:58:31] ✅    ✅ Patient data extracted successfully
[17:58:31] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:58:31] ✅    ✅ Patient identified: Mary Pedra
[17:58:31] ✅    ✅ Patient name validation passed
[17:58:31] 🔄 
🔄 Step 3: Processing patient dates...
[17:58:31] [DOC: 9261080] ℹ️  DOB normalized: 02/27/1937
[17:58:31] [DOC: 9261080] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[17:58:31] [DOC: 9261080] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[17:58:31] [DOC: 9261080] ✅ Patient date processing completed successfully
[17:58:31] ✅    ✅ Date processing completed
[17:58:31] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9'}]
[17:58:31] 🔄 
🔄 Step 4: Extracting order data...
[17:58:34] ℹ️  Order extraction - MRN: 'MA221012023702'
[17:58:34] ℹ️  Order extraction - Sex: ''
[17:58:34] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:58:34] ℹ️  Order extraction - Payer Source: ''
[17:58:34] ✅ Order data extraction completed successfully
[17:58:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:58:34] ℹ️  Using MRN from patient data: 'MA221012023702' over 'MA221012023702'
[17:58:34] ℹ️  Inferred sex as FEMALE from name: Mary
[17:58:34] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:58:34] ✅ Patient name cross-validation successful
[17:58:34] ✅    ✅ Data merged successfully
[17:58:35] ✅    ✅ Order data extracted and validated
[17:58:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:58:41] [DOC: 9261080] ✅ Patient exists in API: Mary Pedra, ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[17:58:41] ✅    ✅ Existing patient found with ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[17:58:41] 🔄 
🔄 Step 6: Pushing order to API...
[17:58:41] [DOC: 9261080] ℹ️  Pushing order via API for patient ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[17:58:42] [DOC: 9261080] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12991"}
[17:58:42] ❌    ❌ Failed to push order
[17:58:42] 🔄 
🔄 Step 7: Writing to CSV...
[17:58:42] [DOC: 9261080] ℹ️  Calculated age: 88 from DOB: 02/27/1937
[17:58:42] [DOC: 9261080] ℹ️  Service Line extracted: 'Occupational Therapy'
[17:58:42] [DOC: 9261080] ℹ️  Payer Source extracted: ''
[17:58:42] [DOC: 9261080] ℹ️  Diagnosis codes being written:
[17:58:42] [DOC: 9261080] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[17:58:42] [DOC: 9261080] ℹ️    - Latest_Episode_Seconddiagnosis: 'R60.9'
[17:58:42] [DOC: 9261080] ℹ️    - Latest_Episode_Thirddiagnosis: 'G47.9'
[17:58:42] [DOC: 9261080] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:58:42] [DOC: 9261080] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:58:42] [DOC: 9261080] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:58:42] [DOC: 9261080] ✅ Patient data written to CSV: Mary Pedra | Sex: FEMALE | Age: 88 | Service: Occupational Therapy | Payer:  | MRN: MA221012023702
[17:58:42] ✅    ✅ Document 9261080 processed and saved successfully
[17:58:42] 🔄 
🔄 Step 8: Saving API details...
[17:58:42] [DOC: 9261080] ℹ️  API push details saved for document 9261080
[17:58:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9261076                         ║
================================================================================
[17:58:42] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:58:42] ℹ️  Date: 04/25/2025
[17:58:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:58:44] [DOC: 9261076] ✅ Text extracted using pdfplumber (1471 chars)
[17:58:44] ✅    ✅ Text extracted using pdfplumber (1471 chars)
[17:58:44] 🔄 
🔄 Step 2: Extracting patient data...
[17:58:47] ℹ️  AI extracted raw sex value: ''
[17:58:47] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:58:47] ℹ️  AI extracted payer source: ''
[17:58:47] ℹ️  AI extracted diagnoses:
[17:58:47] ℹ️    - Diagnosis 1: 'F03.90'
[17:58:47] ℹ️    - Diagnosis 2: 'R60.9'
[17:58:47] ℹ️    - Diagnosis 3: 'G47.9'
[17:58:47] ℹ️    - Diagnosis 4: ''
[17:58:47] ℹ️    - Diagnosis 5: ''
[17:58:47] ℹ️    - Diagnosis 6: ''
[17:58:47] ℹ️  Final extracted MRN: 'MA221012023702'
[17:58:47] ℹ️  Final extracted Sex: ''
[17:58:47] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:58:47] ℹ️  Final extracted Payer Source: ''
[17:58:47] ✅ Patient data extraction completed successfully
[17:58:47] ✅    ✅ Patient data extracted successfully
[17:58:47] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:58:47] ✅    ✅ Patient identified: Mary Pedra
[17:58:47] ✅    ✅ Patient name validation passed
[17:58:47] 🔄 
🔄 Step 3: Processing patient dates...
[17:58:47] [DOC: 9261076] ℹ️  DOB normalized: 02/27/1937
[17:58:47] [DOC: 9261076] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[17:58:47] [DOC: 9261076] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[17:58:47] [DOC: 9261076] ✅ Patient date processing completed successfully
[17:58:47] ✅    ✅ Date processing completed
[17:58:47] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:58:47] 🔄 
🔄 Step 4: Extracting order data...
[17:58:50] ℹ️  Order extraction - MRN: 'MA221012023702'
[17:58:50] ℹ️  Order extraction - Sex: ''
[17:58:50] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:58:50] ℹ️  Order extraction - Payer Source: ''
[17:58:50] ✅ Order data extraction completed successfully
[17:58:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:58:50] ℹ️  Using MRN from patient data: 'MA221012023702' over 'MA221012023702'
[17:58:50] ℹ️  Inferred sex as FEMALE from name: Mary
[17:58:50] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:58:50] ✅ Patient name cross-validation successful
[17:58:50] ✅    ✅ Data merged successfully
[17:58:51] ✅    ✅ Order data extracted and validated
[17:58:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:58:51] [DOC: 9261076] ✅ Patient found in local cache: Mary Pedra, ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[17:58:51] ✅    ✅ Existing patient found with ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[17:58:51] 🔄 
🔄 Step 6: Pushing order to API...
[17:58:51] [DOC: 9261076] ℹ️  Pushing order via API for patient ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[17:58:52] [DOC: 9261076] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12992"}
[17:58:52] ❌    ❌ Failed to push order
[17:58:52] 🔄 
🔄 Step 7: Writing to CSV...
[17:58:52] [DOC: 9261076] ℹ️  Calculated age: 88 from DOB: 02/27/1937
[17:58:52] [DOC: 9261076] ℹ️  Service Line extracted: 'Occupational Therapy'
[17:58:52] [DOC: 9261076] ℹ️  Payer Source extracted: ''
[17:58:52] [DOC: 9261076] ℹ️  Diagnosis codes being written:
[17:58:52] [DOC: 9261076] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[17:58:52] [DOC: 9261076] ℹ️    - Latest_Episode_Seconddiagnosis: 'R60.9'
[17:58:52] [DOC: 9261076] ℹ️    - Latest_Episode_Thirddiagnosis: 'G47.9'
[17:58:52] [DOC: 9261076] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:58:52] [DOC: 9261076] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:58:52] [DOC: 9261076] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:58:52] [DOC: 9261076] ✅ Patient data written to CSV: Mary Pedra | Sex: FEMALE | Age: 88 | Service: Occupational Therapy | Payer:  | MRN: MA221012023702
[17:58:52] ✅    ✅ Document 9261076 processed and saved successfully
[17:58:52] 🔄 
🔄 Step 8: Saving API details...
[17:58:52] [DOC: 9261076] ℹ️  API push details saved for document 9261076
[17:58:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9261073                         ║
================================================================================
[17:58:52] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:58:52] ℹ️  Date: 04/25/2025
[17:58:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:58:55] [DOC: 9261073] ✅ Text extracted using pdfplumber (1491 chars)
[17:58:55] ✅    ✅ Text extracted using pdfplumber (1491 chars)
[17:58:55] 🔄 
🔄 Step 2: Extracting patient data...
[17:58:58] ℹ️  AI extracted raw sex value: ''
[17:58:58] ℹ️  AI extracted service line: 'Physical Therapy'
[17:58:58] ℹ️  AI extracted payer source: ''
[17:58:58] ℹ️  AI extracted diagnoses:
[17:58:58] ℹ️    - Diagnosis 1: 'F03.90'
[17:58:58] ℹ️    - Diagnosis 2: 'R60.9'
[17:58:58] ℹ️    - Diagnosis 3: 'G47.9'
[17:58:58] ℹ️    - Diagnosis 4: ''
[17:58:58] ℹ️    - Diagnosis 5: ''
[17:58:58] ℹ️    - Diagnosis 6: ''
[17:58:58] ℹ️  Final extracted MRN: 'MA221012023702'
[17:58:58] ℹ️  Final extracted Sex: ''
[17:58:58] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:58:58] ℹ️  Final extracted Payer Source: ''
[17:58:58] ✅ Patient data extraction completed successfully
[17:58:58] ✅    ✅ Patient data extracted successfully
[17:58:58] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:58:58] ✅    ✅ Patient identified: Mary Pedra
[17:58:58] ✅    ✅ Patient name validation passed
[17:58:58] 🔄 
🔄 Step 3: Processing patient dates...
[17:58:58] [DOC: 9261073] ℹ️  DOB normalized: 02/27/1937
[17:58:58] [DOC: 9261073] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[17:58:58] [DOC: 9261073] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[17:58:58] [DOC: 9261073] ✅ Patient date processing completed successfully
[17:58:58] ✅    ✅ Date processing completed
[17:58:58] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:58:58] 🔄 
🔄 Step 4: Extracting order data...
[17:59:01] ℹ️  Order extraction - MRN: 'MA221012023702'
[17:59:01] ℹ️  Order extraction - Sex: ''
[17:59:01] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:59:01] ℹ️  Order extraction - Payer Source: ''
[17:59:01] ✅ Order data extraction completed successfully
[17:59:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:59:01] ℹ️  Using MRN from patient data: 'MA221012023702' over 'MA221012023702'
[17:59:01] ℹ️  Inferred sex as FEMALE from name: Mary
[17:59:01] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:59:01] ✅ Patient name cross-validation successful
[17:59:01] ✅    ✅ Data merged successfully
[17:59:02] ✅    ✅ Order data extracted and validated
[17:59:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:59:02] [DOC: 9261073] ✅ Patient found in local cache: Mary Pedra, ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[17:59:02] ✅    ✅ Existing patient found with ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[17:59:02] 🔄 
🔄 Step 6: Pushing order to API...
[17:59:02] [DOC: 9261073] ℹ️  Pushing order via API for patient ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[17:59:03] [DOC: 9261073] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12993"}
[17:59:03] ❌    ❌ Failed to push order
[17:59:03] 🔄 
🔄 Step 7: Writing to CSV...
[17:59:03] [DOC: 9261073] ℹ️  Calculated age: 88 from DOB: 02/27/1937
[17:59:03] [DOC: 9261073] ℹ️  Service Line extracted: 'Physical Therapy'
[17:59:03] [DOC: 9261073] ℹ️  Payer Source extracted: ''
[17:59:03] [DOC: 9261073] ℹ️  Diagnosis codes being written:
[17:59:03] [DOC: 9261073] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[17:59:03] [DOC: 9261073] ℹ️    - Latest_Episode_Seconddiagnosis: 'R60.9'
[17:59:03] [DOC: 9261073] ℹ️    - Latest_Episode_Thirddiagnosis: 'G47.9'
[17:59:03] [DOC: 9261073] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:59:03] [DOC: 9261073] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:59:03] [DOC: 9261073] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:59:03] [DOC: 9261073] ✅ Patient data written to CSV: Mary Pedra | Sex: FEMALE | Age: 88 | Service: Physical Therapy | Payer:  | MRN: MA221012023702
[17:59:03] ✅    ✅ Document 9261073 processed and saved successfully
[17:59:03] 🔄 
🔄 Step 8: Saving API details...
[17:59:03] [DOC: 9261073] ℹ️  API push details saved for document 9261073
[17:59:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9261054                         ║
================================================================================
[17:59:03] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:59:03] ℹ️  Date: 04/25/2025
[17:59:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:59:06] [DOC: 9261054] ✅ Text extracted using pdfplumber (1485 chars)
[17:59:06] ✅    ✅ Text extracted using pdfplumber (1485 chars)
[17:59:06] 🔄 
🔄 Step 2: Extracting patient data...
[17:59:09] ℹ️  AI extracted raw sex value: ''
[17:59:09] ℹ️  AI extracted service line: 'Physical Therapy'
[17:59:09] ℹ️  AI extracted payer source: ''
[17:59:09] ℹ️  AI extracted diagnoses:
[17:59:09] ℹ️    - Diagnosis 1: 'None'
[17:59:09] ℹ️    - Diagnosis 2: 'None'
[17:59:09] ℹ️    - Diagnosis 3: 'None'
[17:59:09] ℹ️    - Diagnosis 4: 'None'
[17:59:09] ℹ️    - Diagnosis 5: 'None'
[17:59:09] ℹ️    - Diagnosis 6: 'None'
[17:59:09] ℹ️  Final extracted MRN: 'MA250210123603'
[17:59:09] ℹ️  Final extracted Sex: ''
[17:59:09] ℹ️  Final extracted Service Line: 'Physical Therapy'
[17:59:09] ℹ️  Final extracted Payer Source: ''
[17:59:09] ✅ Patient data extraction completed successfully
[17:59:09] ✅    ✅ Patient data extracted successfully
[17:59:09] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:59:09] ✅    ✅ Patient identified: David Boswell
[17:59:09] ✅    ✅ Patient name validation passed
[17:59:09] 🔄 
🔄 Step 3: Processing patient dates...
[17:59:09] [DOC: 9261054] ℹ️  DOB normalized: 12/29/1936
[17:59:09] [DOC: 9261054] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[17:59:09] [DOC: 9261054] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[17:59:09] [DOC: 9261054] ✅ Patient date processing completed successfully
[17:59:09] ✅    ✅ Date processing completed
[17:59:09] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Boswell
     └─ dob: 12/29/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250210123603
     └─ billingProvider: JAHN POTHIER MD
     └─ npi: 1962478966
     └─ physicianNPI: 1962478966
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025'}]
[17:59:09] 🔄 
🔄 Step 4: Extracting order data...
[17:59:12] ℹ️  Order extraction - MRN: 'MA250210123603'
[17:59:12] ℹ️  Order extraction - Sex: ''
[17:59:12] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[17:59:12] ℹ️  Order extraction - Payer Source: ''
[17:59:12] ✅ Order data extraction completed successfully
[17:59:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:59:12] ℹ️  Using MRN from patient data: 'MA250210123603' over 'MA250210123603'
[17:59:12] ℹ️  Inferred sex as MALE from name: David
[17:59:12] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[17:59:12] ✅ Patient name cross-validation successful
[17:59:12] ✅    ✅ Data merged successfully
[17:59:13] ✅    ✅ Order data extracted and validated
[17:59:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:59:13] [DOC: 9261054] ✅ Patient found in local cache: David Boswell, ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[17:59:13] ✅    ✅ Existing patient found with ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[17:59:13] 🔄 
🔄 Step 6: Pushing order to API...
[17:59:13] [DOC: 9261054] ℹ️  Pushing order via API for patient ID: 5c59d69e-bf8e-4c44-afb8-44014551f641
[17:59:14] [DOC: 9261054] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13204"}
[17:59:14] ❌    ❌ Failed to push order
[17:59:14] 🔄 
🔄 Step 7: Writing to CSV...
[17:59:14] [DOC: 9261054] ℹ️  Calculated age: 88 from DOB: 12/29/1936
[17:59:14] [DOC: 9261054] ℹ️  Service Line extracted: 'Physical Therapy'
[17:59:14] [DOC: 9261054] ℹ️  Payer Source extracted: ''
[17:59:14] [DOC: 9261054] ℹ️  Diagnosis codes being written:
[17:59:14] [DOC: 9261054] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[17:59:14] [DOC: 9261054] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:59:14] [DOC: 9261054] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:59:14] [DOC: 9261054] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:59:14] [DOC: 9261054] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:59:14] [DOC: 9261054] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:59:14] [DOC: 9261054] ✅ Patient data written to CSV: David Boswell | Sex: MALE | Age: 88 | Service: Physical Therapy | Payer:  | MRN: MA250210123603
[17:59:14] ✅    ✅ Document 9261054 processed and saved successfully
[17:59:14] 🔄 
🔄 Step 8: Saving API details...
[17:59:14] [DOC: 9261054] ℹ️  API push details saved for document 9261054
[17:59:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9260826                         ║
================================================================================
[17:59:14] ℹ️  Agency: AccentCare Fall River
[17:59:14] ℹ️  Date: 04/25/2025
[17:59:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:59:18] [DOC: 9260826] ✅ Text extracted using pdfplumber (8083 chars)
[17:59:18] ✅    ✅ Text extracted using pdfplumber (8083 chars)
[17:59:18] 🔄 
🔄 Step 2: Extracting patient data...
[17:59:21] ℹ️  AI extracted raw sex value: ''
[17:59:21] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:59:21] ℹ️  AI extracted payer source: ''
[17:59:21] ℹ️  AI extracted diagnoses:
[17:59:21] ℹ️    - Diagnosis 1: 'C15.9'
[17:59:21] ℹ️    - Diagnosis 2: 'None'
[17:59:21] ℹ️    - Diagnosis 3: 'None'
[17:59:21] ℹ️    - Diagnosis 4: 'None'
[17:59:21] ℹ️    - Diagnosis 5: 'None'
[17:59:21] ℹ️    - Diagnosis 6: 'None'
[17:59:21] ℹ️  Final extracted MRN: 'C0200237232301'
[17:59:21] ℹ️  Final extracted Sex: ''
[17:59:21] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:59:21] ℹ️  Final extracted Payer Source: ''
[17:59:21] ✅ Patient data extraction completed successfully
[17:59:21] ✅    ✅ Patient data extracted successfully
[17:59:21] 📊 Patient Response
     └─ patientFName: MILO
     └─ patientLName: WEBSTER
     └─ dob: 07/21/1959
     └─ patientSex: 
     └─ medicalRecordNo: C0200237232301
     └─ billingProvider: JORDAN GULAREK, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/14/2025', 'endOfEpisode': None, 'firstDiagnosis': 'C15.9', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:59:21] ✅    ✅ Patient identified: MILO WEBSTER
[17:59:21] ✅    ✅ Patient name validation passed
[17:59:21] 🔄 
🔄 Step 3: Processing patient dates...
[17:59:21] [DOC: 9260826] ℹ️  DOB normalized: 07/21/1959
[17:59:21] [DOC: 9260826] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[17:59:21] [DOC: 9260826] ✅ Patient date processing completed successfully
[17:59:21] ✅    ✅ Date processing completed
[17:59:21] 📊 Processed Patient Data
     └─ patientFName: MILO
     └─ patientLName: WEBSTER
     └─ dob: 07/21/1959
     └─ patientSex: 
     └─ medicalRecordNo: C0200237232301
     └─ billingProvider: JORDAN GULAREK, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/14/2025', 'firstDiagnosis': 'C15.9'}]
[17:59:21] 🔄 
🔄 Step 4: Extracting order data...
[17:59:24] ℹ️  Order extraction - MRN: 'C0200237232301'
[17:59:24] ℹ️  Order extraction - Sex: ''
[17:59:24] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:59:24] ℹ️  Order extraction - Payer Source: ''
[17:59:24] ✅ Order data extraction completed successfully
[17:59:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:59:24] ℹ️  Using MRN from patient data: 'C0200237232301' over 'C0200237232301'
[17:59:24] ⚠️  Could not determine sex using any available method
[17:59:24] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:59:24] ✅ Patient name cross-validation successful
[17:59:24] ✅    ✅ Data merged successfully
[17:59:25] ✅    ✅ Order data extracted and validated
[17:59:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:59:25] [DOC: 9260826] ✅ Patient found in local cache: MILO WEBSTER, ID: 695c5703-e477-4b11-a055-202369179483
[17:59:25] ✅    ✅ Existing patient found with ID: 695c5703-e477-4b11-a055-202369179483
[17:59:25] 🔄 
🔄 Step 6: Pushing order to API...
[17:59:25] [DOC: 9260826] ℹ️  Pushing order via API for patient ID: 695c5703-e477-4b11-a055-202369179483
[17:59:26] [DOC: 9260826] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14418"}
[17:59:26] ❌    ❌ Failed to push order
[17:59:26] 🔄 
🔄 Step 7: Writing to CSV...
[17:59:26] [DOC: 9260826] ℹ️  Calculated age: 65 from DOB: 07/21/1959
[17:59:26] [DOC: 9260826] ℹ️  Service Line extracted: 'Occupational Therapy'
[17:59:26] [DOC: 9260826] ℹ️  Payer Source extracted: ''
[17:59:26] [DOC: 9260826] ℹ️  Diagnosis codes being written:
[17:59:26] [DOC: 9260826] ℹ️    - Latest_Episode_Firstdiagnosis: 'C15.9'
[17:59:26] [DOC: 9260826] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[17:59:26] [DOC: 9260826] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:59:26] [DOC: 9260826] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:59:26] [DOC: 9260826] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:59:26] [DOC: 9260826] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:59:26] [DOC: 9260826] ✅ Patient data written to CSV: MILO WEBSTER | Sex:  | Age: 65 | Service: Occupational Therapy | Payer:  | MRN: C0200237232301
[17:59:26] ✅    ✅ Document 9260826 processed and saved successfully
[17:59:26] 🔄 
🔄 Step 8: Saving API details...
[17:59:26] [DOC: 9260826] ℹ️  API push details saved for document 9260826
[17:59:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9260732                         ║
================================================================================
[17:59:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:59:26] ℹ️  Date: 04/25/2025
[17:59:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:59:29] [DOC: 9260732] ✅ Text extracted using pdfplumber (13753 chars)
[17:59:29] ✅    ✅ Text extracted using pdfplumber (13753 chars)
[17:59:29] 🔄 
🔄 Step 2: Extracting patient data...
[17:59:33] ℹ️  AI extracted raw sex value: 'M'
[17:59:33] ℹ️  AI extracted service line: 'OT'
[17:59:33] ℹ️  AI extracted payer source: ''
[17:59:33] ℹ️  AI extracted diagnoses:
[17:59:33] ℹ️    - Diagnosis 1: 'Bilateral shoulder tendonitis'
[17:59:33] ℹ️    - Diagnosis 2: 'muscle weakness'
[17:59:33] ℹ️    - Diagnosis 3: ''
[17:59:33] ℹ️    - Diagnosis 4: ''
[17:59:33] ℹ️    - Diagnosis 5: ''
[17:59:33] ℹ️    - Diagnosis 6: ''
[17:59:33] ℹ️  Final extracted MRN: 'MA230420103801'
[17:59:33] ℹ️  Final extracted Sex: 'MALE'
[17:59:33] ℹ️  Final extracted Service Line: 'OT'
[17:59:33] ℹ️  Final extracted Payer Source: ''
[17:59:33] ✅ Patient data extraction completed successfully
[17:59:33] ✅    ✅ Patient data extracted successfully
[17:59:33] 📊 Patient Response
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Bilateral shoulder tendonitis', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:59:33] ✅    ✅ Patient identified: Alfredo Santos
[17:59:33] ✅    ✅ Patient name validation passed
[17:59:33] 🔄 
🔄 Step 3: Processing patient dates...
[17:59:33] [DOC: 9260732] ℹ️  DOB normalized: 10/24/1938
[17:59:33] [DOC: 9260732] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[17:59:33] [DOC: 9260732] ✅ Patient date processing completed successfully
[17:59:33] ✅    ✅ Date processing completed
[17:59:33] 📊 Processed Patient Data
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Bilateral shoulder tendonitis', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:59:33] 🔄 
🔄 Step 4: Extracting order data...
[17:59:35] ℹ️  Order extraction - MRN: 'MA230420103801'
[17:59:35] ℹ️  Order extraction - Sex: 'MALE'
[17:59:35] ℹ️  Order extraction - Service Line: 'OT'
[17:59:35] ℹ️  Order extraction - Payer Source: ''
[17:59:35] ✅ Order data extraction completed successfully
[17:59:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:59:35] ℹ️  Using MRN from patient data: 'MA230420103801' over 'MA230420103801'
[17:59:35] ℹ️  Service line consistent in both sources: 'OT'
[17:59:35] ✅ Patient name cross-validation successful
[17:59:35] ✅    ✅ Data merged successfully
[17:59:37] ✅    ✅ Order data extracted and validated
[17:59:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:59:37] [DOC: 9260732] ✅ Patient found in local cache: Alfredo Santos, ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[17:59:37] ✅    ✅ Existing patient found with ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[17:59:37] 🔄 
🔄 Step 6: Pushing order to API...
[17:59:37] [DOC: 9260732] ℹ️  Pushing order via API for patient ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[17:59:38] [DOC: 9260732] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:59:38] ❌    ❌ Failed to push order
[17:59:38] 🔄 
🔄 Step 7: Writing to CSV...
[17:59:38] [DOC: 9260732] ℹ️  Calculated age: 86 from DOB: 10/24/1938
[17:59:38] [DOC: 9260732] ℹ️  Service Line extracted: 'OT'
[17:59:38] [DOC: 9260732] ℹ️  Payer Source extracted: ''
[17:59:38] [DOC: 9260732] ℹ️  Diagnosis codes being written:
[17:59:38] [DOC: 9260732] ℹ️    - Latest_Episode_Firstdiagnosis: 'Bilateral shoulder tendonitis'
[17:59:38] [DOC: 9260732] ℹ️    - Latest_Episode_Seconddiagnosis: 'muscle weakness'
[17:59:38] [DOC: 9260732] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[17:59:38] [DOC: 9260732] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:59:38] [DOC: 9260732] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:59:38] [DOC: 9260732] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:59:38] [DOC: 9260732] ✅ Patient data written to CSV: Alfredo Santos | Sex: MALE | Age: 86 | Service: OT | Payer:  | MRN: MA230420103801
[17:59:38] ✅    ✅ Document 9260732 processed and saved successfully
[17:59:38] 🔄 
🔄 Step 8: Saving API details...
[17:59:38] [DOC: 9260732] ℹ️  API push details saved for document 9260732
[17:59:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9260718                         ║
================================================================================
[17:59:38] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[17:59:38] ℹ️  Date: 04/25/2025
[17:59:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:59:40] [DOC: 9260718] ✅ Text extracted using pdfplumber (1455 chars)
[17:59:40] ✅    ✅ Text extracted using pdfplumber (1443 chars)
[17:59:40] 🔄 
🔄 Step 2: Extracting patient data...
[17:59:43] ℹ️  AI extracted raw sex value: ''
[17:59:43] ℹ️  AI extracted service line: 'Occupational Therapy'
[17:59:43] ℹ️  AI extracted payer source: ''
[17:59:43] ℹ️  AI extracted diagnoses:
[17:59:43] ℹ️    - Diagnosis 1: 'A04.72'
[17:59:43] ℹ️    - Diagnosis 2: 'E11.9'
[17:59:43] ℹ️    - Diagnosis 3: 'E87.1'
[17:59:43] ℹ️    - Diagnosis 4: ''
[17:59:43] ℹ️    - Diagnosis 5: ''
[17:59:43] ℹ️    - Diagnosis 6: ''
[17:59:43] ℹ️  Final extracted MRN: 'MA250414053302'
[17:59:43] ℹ️  Final extracted Sex: ''
[17:59:43] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[17:59:43] ℹ️  Final extracted Payer Source: ''
[17:59:43] ✅ Patient data extraction completed successfully
[17:59:43] ✅    ✅ Patient data extracted successfully
[17:59:43] 📊 Patient Response
     └─ patientFName: Serafim
     └─ patientLName: Mimoso
     └─ dob: 05/08/1933
     └─ patientSex: 
     └─ medicalRecordNo: MA250414053302
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E87.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:59:43] ✅    ✅ Patient identified: Serafim Mimoso
[17:59:43] ✅    ✅ Patient name validation passed
[17:59:43] 🔄 
🔄 Step 3: Processing patient dates...
[17:59:43] [DOC: 9260718] ℹ️  DOB normalized: 05/08/1933
[17:59:43] [DOC: 9260718] ℹ️  Episode startOfEpisode normalized: 04/18/2025
[17:59:43] [DOC: 9260718] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[17:59:43] [DOC: 9260718] ✅ Patient date processing completed successfully
[17:59:43] ✅    ✅ Date processing completed
[17:59:43] 📊 Processed Patient Data
     └─ patientFName: Serafim
     └─ patientLName: Mimoso
     └─ dob: 05/08/1933
     └─ patientSex: 
     └─ medicalRecordNo: MA250414053302
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E87.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:59:43] 🔄 
🔄 Step 4: Extracting order data...
[17:59:46] ℹ️  Order extraction - MRN: 'MA250414053302'
[17:59:46] ℹ️  Order extraction - Sex: ''
[17:59:46] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[17:59:46] ℹ️  Order extraction - Payer Source: ''
[17:59:46] ✅ Order data extraction completed successfully
[17:59:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:59:46] ℹ️  Using MRN from patient data: 'MA250414053302' over 'MA250414053302'
[17:59:46] ⚠️  Could not determine sex using any available method
[17:59:46] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[17:59:46] ✅ Patient name cross-validation successful
[17:59:46] ✅    ✅ Data merged successfully
[17:59:47] ✅    ✅ Order data extracted and validated
[17:59:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[17:59:47] [DOC: 9260718] ✅ Patient found in local cache: Serafim Mimoso, ID: 0849f00a-166d-4c7d-969a-5567b25056c1
[17:59:47] ✅    ✅ Existing patient found with ID: 0849f00a-166d-4c7d-969a-5567b25056c1
[17:59:47] 🔄 
🔄 Step 6: Pushing order to API...
[17:59:47] [DOC: 9260718] ℹ️  Pushing order via API for patient ID: 0849f00a-166d-4c7d-969a-5567b25056c1
[17:59:48] [DOC: 9260718] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14108"}
[17:59:48] ❌    ❌ Failed to push order
[17:59:48] 🔄 
🔄 Step 7: Writing to CSV...
[17:59:48] [DOC: 9260718] ℹ️  Calculated age: 92 from DOB: 05/08/1933
[17:59:48] [DOC: 9260718] ℹ️  Service Line extracted: 'Occupational Therapy'
[17:59:48] [DOC: 9260718] ℹ️  Payer Source extracted: ''
[17:59:48] [DOC: 9260718] ℹ️  Diagnosis codes being written:
[17:59:48] [DOC: 9260718] ℹ️    - Latest_Episode_Firstdiagnosis: 'A04.72'
[17:59:48] [DOC: 9260718] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[17:59:48] [DOC: 9260718] ℹ️    - Latest_Episode_Thirddiagnosis: 'E87.1'
[17:59:48] [DOC: 9260718] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[17:59:48] [DOC: 9260718] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[17:59:48] [DOC: 9260718] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[17:59:48] [DOC: 9260718] ✅ Patient data written to CSV: Serafim Mimoso | Sex:  | Age: 92 | Service: Occupational Therapy | Payer:  | MRN: MA250414053302
[17:59:48] ✅    ✅ Document 9260718 processed and saved successfully
[17:59:48] 🔄 
🔄 Step 8: Saving API details...
[17:59:48] [DOC: 9260718] ℹ️  API push details saved for document 9260718
[17:59:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9260670                         ║
================================================================================
[17:59:48] ℹ️  Agency: Nizhoni Health-Fall River
[17:59:48] ℹ️  Date: 04/25/2025
[17:59:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[17:59:52] [DOC: 9260670] ✅ Text extracted using pdfplumber (1607 chars)
[17:59:52] ✅    ✅ Text extracted using pdfplumber (1607 chars)
[17:59:52] 🔄 
🔄 Step 2: Extracting patient data...
[17:59:54] ℹ️  AI extracted raw sex value: 'F'
[17:59:54] ℹ️  AI extracted service line: 'None'
[17:59:54] ℹ️  AI extracted payer source: 'Commonwealth Care Alliance One Care'
[17:59:54] ℹ️  AI extracted diagnoses:
[17:59:54] ℹ️    - Diagnosis 1: 'None'
[17:59:54] ℹ️    - Diagnosis 2: 'None'
[17:59:54] ℹ️    - Diagnosis 3: 'None'
[17:59:54] ℹ️    - Diagnosis 4: 'None'
[17:59:54] ℹ️    - Diagnosis 5: 'None'
[17:59:54] ℹ️    - Diagnosis 6: 'None'
[17:59:54] ℹ️  Final extracted MRN: '6413'
[17:59:54] ℹ️  Final extracted Sex: 'FEMALE'
[17:59:54] ℹ️  Final extracted Service Line: ''
[17:59:54] ℹ️  Final extracted Payer Source: 'Commonwealth Care Alliance One Care'
[17:59:54] ✅ Patient data extraction completed successfully
[17:59:54] ✅    ✅ Patient data extracted successfully
[17:59:54] 📊 Patient Response
     └─ patientFName: Robin
     └─ patientLName: Eaton
     └─ dob: 01/30/1961
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6413
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 126 Nash Road Apt 3
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: 
     └─ payorSource: Commonwealth Care Alliance One Care
     └─ episodeDiagnoses: [{'startOfCare': '09/03/2012', 'startOfEpisode': None, 'endOfEpisode': '04/27/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:59:54] ✅    ✅ Patient identified: Robin Eaton
[17:59:54] ✅    ✅ Patient name validation passed
[17:59:54] 🔄 
🔄 Step 3: Processing patient dates...
[17:59:54] [DOC: 9260670] ℹ️  DOB normalized: 01/30/1961
[17:59:54] [DOC: 9260670] ℹ️  Episode startOfCare normalized: 09/03/2012
[17:59:54] [DOC: 9260670] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[17:59:54] [DOC: 9260670] ✅ Patient date processing completed successfully
[17:59:54] ✅    ✅ Date processing completed
[17:59:54] 📊 Processed Patient Data
     └─ patientFName: Robin
     └─ patientLName: Eaton
     └─ dob: 01/30/1961
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6413
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 126 Nash Road Apt 3
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: 
     └─ payorSource: Commonwealth Care Alliance One Care
     └─ episodeDiagnoses: [{'startOfCare': '09/03/2012', 'endOfEpisode': '04/27/2025'}]
[17:59:54] 🔄 
🔄 Step 4: Extracting order data...
[17:59:57] ℹ️  Order extraction - MRN: '6413'
[17:59:57] ℹ️  Order extraction - Sex: 'FEMALE'
[17:59:57] ℹ️  Order extraction - Service Line: ''
[17:59:57] ℹ️  Order extraction - Payer Source: 'Commonwealth Care Alliance One Care'
[17:59:57] ✅ Order data extraction completed successfully
[17:59:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[17:59:57] ℹ️  Using MRN from patient data: '6413' over '6413'
[17:59:57] ℹ️  Payer source consistent in both sources: 'Commonwealth Care Alliance One Care'
[17:59:57] ✅ Patient name cross-validation successful
[17:59:57] ✅    ✅ Data merged successfully
[17:59:58] ✅    ✅ Order data extracted and validated
[17:59:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:00:06] [DOC: 9260670] ✅ Patient exists in API: Robin Eaton, ID: f0ba5a18-2021-4450-8c56-07eabe178fb0
[18:00:06] ✅    ✅ Existing patient found with ID: f0ba5a18-2021-4450-8c56-07eabe178fb0
[18:00:06] 🔄 
🔄 Step 6: Pushing order to API...
[18:00:06] [DOC: 9260670] ℹ️  Pushing order via API for patient ID: f0ba5a18-2021-4450-8c56-07eabe178fb0
[18:00:07] [DOC: 9260670] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[18:00:07] ❌    ❌ Failed to push order
[18:00:07] 🔄 
🔄 Step 7: Writing to CSV...
[18:00:07] [DOC: 9260670] ℹ️  Calculated age: 64 from DOB: 01/30/1961
[18:00:07] [DOC: 9260670] ℹ️  Service Line extracted: ''
[18:00:07] [DOC: 9260670] ℹ️  Payer Source extracted: 'Commonwealth Care Alliance One Care'
[18:00:07] [DOC: 9260670] ℹ️  Diagnosis codes being written:
[18:00:07] [DOC: 9260670] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:00:07] [DOC: 9260670] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:00:07] [DOC: 9260670] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:00:07] [DOC: 9260670] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:00:07] [DOC: 9260670] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:00:07] [DOC: 9260670] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:00:07] [DOC: 9260670] ✅ Patient data written to CSV: Robin Eaton | Sex: FEMALE | Age: 64 | Service:  | Payer: Commonwealth Care Alliance One Care | MRN: 6413
[18:00:07] ✅    ✅ Document 9260670 processed and saved successfully
[18:00:07] 🔄 
🔄 Step 8: Saving API details...
[18:00:07] [DOC: 9260670] ℹ️  API push details saved for document 9260670
[18:00:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9260534                         ║
================================================================================
[18:00:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:00:07] ℹ️  Date: 04/25/2025
[18:00:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:00:09] [DOC: 9260534] ✅ Text extracted using pdfplumber (1430 chars)
[18:00:09] ✅    ✅ Text extracted using pdfplumber (1430 chars)
[18:00:09] 🔄 
🔄 Step 2: Extracting patient data...
[18:00:12] ℹ️  AI extracted raw sex value: ''
[18:00:12] ℹ️  AI extracted service line: 'Physical Therapy'
[18:00:12] ℹ️  AI extracted payer source: ''
[18:00:12] ℹ️  AI extracted diagnoses:
[18:00:12] ℹ️    - Diagnosis 1: 'J44.1'
[18:00:12] ℹ️    - Diagnosis 2: 'I10'
[18:00:12] ℹ️    - Diagnosis 3: 'E11.65'
[18:00:12] ℹ️    - Diagnosis 4: ''
[18:00:12] ℹ️    - Diagnosis 5: ''
[18:00:12] ℹ️    - Diagnosis 6: ''
[18:00:12] ℹ️  Final extracted MRN: '100990744'
[18:00:12] ℹ️  Final extracted Sex: ''
[18:00:12] ℹ️  Final extracted Service Line: 'Physical Therapy'
[18:00:12] ℹ️  Final extracted Payer Source: ''
[18:00:12] ✅ Patient data extraction completed successfully
[18:00:12] ✅    ✅ Patient data extracted successfully
[18:00:12] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Grace
     └─ dob: 10/21/1948
     └─ patientSex: 
     └─ medicalRecordNo: 100990744
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/24/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:00:12] ✅    ✅ Patient identified: Barbara Grace
[18:00:12] ✅    ✅ Patient name validation passed
[18:00:12] 🔄 
🔄 Step 3: Processing patient dates...
[18:00:12] [DOC: 9260534] ℹ️  DOB normalized: 10/21/1948
[18:00:12] [DOC: 9260534] ℹ️  Episode startOfEpisode normalized: 02/24/2025
[18:00:12] [DOC: 9260534] ℹ️  Episode endOfEpisode normalized: 04/24/2025
[18:00:12] [DOC: 9260534] ✅ Patient date processing completed successfully
[18:00:12] ✅    ✅ Date processing completed
[18:00:12] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Grace
     └─ dob: 10/21/1948
     └─ patientSex: 
     └─ medicalRecordNo: 100990744
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/24/2025', 'endOfEpisode': '04/24/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:00:12] 🔄 
🔄 Step 4: Extracting order data...
[18:00:15] ℹ️  Order extraction - MRN: '100990744'
[18:00:15] ℹ️  Order extraction - Sex: ''
[18:00:15] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[18:00:15] ℹ️  Order extraction - Payer Source: ''
[18:00:15] ✅ Order data extraction completed successfully
[18:00:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:00:15] ℹ️  Using MRN from patient data: '100990744' over '100990744'
[18:00:15] ℹ️  Inferred sex as FEMALE from name: Barbara
[18:00:15] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[18:00:15] ✅ Patient name cross-validation successful
[18:00:15] ✅    ✅ Data merged successfully
[18:00:16] ✅    ✅ Order data extracted and validated
[18:00:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:00:16] [DOC: 9260534] ✅ Patient found in local cache: Barbara Grace, ID: 579e1f1c-438b-4928-9793-bad56e38e647
[18:00:16] ✅    ✅ Existing patient found with ID: 579e1f1c-438b-4928-9793-bad56e38e647
[18:00:16] 🔄 
🔄 Step 6: Pushing order to API...
[18:00:16] [DOC: 9260534] ℹ️  Pushing order via API for patient ID: 579e1f1c-438b-4928-9793-bad56e38e647
[18:00:17] [DOC: 9260534] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13820"}
[18:00:17] ❌    ❌ Failed to push order
[18:00:17] 🔄 
🔄 Step 7: Writing to CSV...
[18:00:17] [DOC: 9260534] ℹ️  Calculated age: 76 from DOB: 10/21/1948
[18:00:17] [DOC: 9260534] ℹ️  Service Line extracted: 'Physical Therapy'
[18:00:17] [DOC: 9260534] ℹ️  Payer Source extracted: ''
[18:00:17] [DOC: 9260534] ℹ️  Diagnosis codes being written:
[18:00:17] [DOC: 9260534] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[18:00:17] [DOC: 9260534] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[18:00:17] [DOC: 9260534] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.65'
[18:00:17] [DOC: 9260534] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:00:17] [DOC: 9260534] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:00:17] [DOC: 9260534] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:00:17] [DOC: 9260534] ✅ Patient data written to CSV: Barbara Grace | Sex: FEMALE | Age: 76 | Service: Physical Therapy | Payer:  | MRN: 100990744
[18:00:17] ✅    ✅ Document 9260534 processed and saved successfully
[18:00:17] 🔄 
🔄 Step 8: Saving API details...
[18:00:17] [DOC: 9260534] ℹ️  API push details saved for document 9260534
[18:00:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9260397                         ║
================================================================================
[18:00:17] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:00:17] ℹ️  Date: 04/25/2025
[18:00:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:00:20] [DOC: 9260397] ✅ Text extracted using pdfplumber (1411 chars)
[18:00:20] ✅    ✅ Text extracted using pdfplumber (1399 chars)
[18:00:20] 🔄 
🔄 Step 2: Extracting patient data...
[18:00:23] ℹ️  AI extracted raw sex value: ''
[18:00:23] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:00:23] ℹ️  AI extracted payer source: ''
[18:00:23] ℹ️  AI extracted diagnoses:
[18:00:23] ℹ️    - Diagnosis 1: 'I65.29'
[18:00:23] ℹ️    - Diagnosis 2: 'R26.81'
[18:00:23] ℹ️    - Diagnosis 3: 'F03.93'
[18:00:23] ℹ️    - Diagnosis 4: 'None'
[18:00:23] ℹ️    - Diagnosis 5: 'None'
[18:00:23] ℹ️    - Diagnosis 6: 'None'
[18:00:23] ℹ️  Final extracted MRN: 'MA250408034202'
[18:00:23] ℹ️  Final extracted Sex: ''
[18:00:23] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:00:23] ℹ️  Final extracted Payer Source: ''
[18:00:23] ✅ Patient data extraction completed successfully
[18:00:23] ✅    ✅ Patient data extracted successfully
[18:00:23] 📊 Patient Response
     └─ patientFName: Pamela
     └─ patientLName: Newell
     └─ dob: 03/15/1942
     └─ patientSex: 
     └─ medicalRecordNo: MA250408034202
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/16/2025', 'endOfEpisode': '06/14/2025', 'firstDiagnosis': 'I65.29', 'secondDiagnosis': 'R26.81', 'thirdDiagnosis': 'F03.93', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:00:23] ✅    ✅ Patient identified: Pamela Newell
[18:00:23] ✅    ✅ Patient name validation passed
[18:00:23] 🔄 
🔄 Step 3: Processing patient dates...
[18:00:23] [DOC: 9260397] ℹ️  DOB normalized: 03/15/1942
[18:00:23] [DOC: 9260397] ℹ️  Episode startOfEpisode normalized: 04/16/2025
[18:00:23] [DOC: 9260397] ℹ️  Episode endOfEpisode normalized: 06/14/2025
[18:00:23] [DOC: 9260397] ✅ Patient date processing completed successfully
[18:00:23] ✅    ✅ Date processing completed
[18:00:23] 📊 Processed Patient Data
     └─ patientFName: Pamela
     └─ patientLName: Newell
     └─ dob: 03/15/1942
     └─ patientSex: 
     └─ medicalRecordNo: MA250408034202
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '06/14/2025', 'firstDiagnosis': 'I65.29', 'secondDiagnosis': 'R26.81', 'thirdDiagnosis': 'F03.93'}]
[18:00:23] 🔄 
🔄 Step 4: Extracting order data...
[18:00:25] ℹ️  Order extraction - MRN: 'MA250408034202'
[18:00:25] ℹ️  Order extraction - Sex: ''
[18:00:25] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:00:25] ℹ️  Order extraction - Payer Source: ''
[18:00:25] ✅ Order data extraction completed successfully
[18:00:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:00:25] ℹ️  Using MRN from patient data: 'MA250408034202' over 'MA250408034202'
[18:00:25] ⚠️  Could not determine sex using any available method
[18:00:25] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:00:25] ✅ Patient name cross-validation successful
[18:00:25] ✅    ✅ Data merged successfully
[18:00:26] ✅    ✅ Order data extracted and validated
[18:00:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:00:26] [DOC: 9260397] ✅ Patient found in local cache: Pamela Newell, ID: 916ed949-8061-47b2-9022-7ec91bcc9d65
[18:00:26] ✅    ✅ Existing patient found with ID: 916ed949-8061-47b2-9022-7ec91bcc9d65
[18:00:26] 🔄 
🔄 Step 6: Pushing order to API...
[18:00:26] [DOC: 9260397] ℹ️  Pushing order via API for patient ID: 916ed949-8061-47b2-9022-7ec91bcc9d65
[18:00:28] [DOC: 9260397] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14178"}
[18:00:28] ❌    ❌ Failed to push order
[18:00:28] 🔄 
🔄 Step 7: Writing to CSV...
[18:00:28] [DOC: 9260397] ℹ️  Calculated age: 83 from DOB: 03/15/1942
[18:00:28] [DOC: 9260397] ℹ️  Service Line extracted: 'Occupational Therapy'
[18:00:28] [DOC: 9260397] ℹ️  Payer Source extracted: ''
[18:00:28] [DOC: 9260397] ℹ️  Diagnosis codes being written:
[18:00:28] [DOC: 9260397] ℹ️    - Latest_Episode_Firstdiagnosis: 'I65.29'
[18:00:28] [DOC: 9260397] ℹ️    - Latest_Episode_Seconddiagnosis: 'R26.81'
[18:00:28] [DOC: 9260397] ℹ️    - Latest_Episode_Thirddiagnosis: 'F03.93'
[18:00:28] [DOC: 9260397] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:00:28] [DOC: 9260397] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:00:28] [DOC: 9260397] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:00:28] [DOC: 9260397] ✅ Patient data written to CSV: Pamela Newell | Sex:  | Age: 83 | Service: Occupational Therapy | Payer:  | MRN: MA250408034202
[18:00:28] ✅    ✅ Document 9260397 processed and saved successfully
[18:00:28] 🔄 
🔄 Step 8: Saving API details...
[18:00:28] [DOC: 9260397] ℹ️  API push details saved for document 9260397
[18:00:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9260396                         ║
================================================================================
[18:00:28] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:00:28] ℹ️  Date: 04/25/2025
[18:00:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:00:30] [DOC: 9260396] ✅ Text extracted using pdfplumber (1390 chars)
[18:00:30] ✅    ✅ Text extracted using pdfplumber (1378 chars)
[18:00:30] 🔄 
🔄 Step 2: Extracting patient data...
[18:00:33] ℹ️  AI extracted raw sex value: ''
[18:00:33] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:00:33] ℹ️  AI extracted payer source: ''
[18:00:33] ℹ️  AI extracted diagnoses:
[18:00:33] ℹ️    - Diagnosis 1: 'I65.29'
[18:00:33] ℹ️    - Diagnosis 2: 'R26.81'
[18:00:33] ℹ️    - Diagnosis 3: 'F03.93'
[18:00:33] ℹ️    - Diagnosis 4: ''
[18:00:33] ℹ️    - Diagnosis 5: ''
[18:00:33] ℹ️    - Diagnosis 6: ''
[18:00:33] ℹ️  Final extracted MRN: 'MA250408034202'
[18:00:33] ℹ️  Final extracted Sex: ''
[18:00:33] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:00:33] ℹ️  Final extracted Payer Source: ''
[18:00:33] ✅ Patient data extraction completed successfully
[18:00:33] ✅    ✅ Patient data extracted successfully
[18:00:33] 📊 Patient Response
     └─ patientFName: Pamela
     └─ patientLName: Newell
     └─ dob: 03/15/1942
     └─ patientSex: 
     └─ medicalRecordNo: MA250408034202
     └─ billingProvider: ROBERT CALDAS
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '06/14/2025', 'firstDiagnosis': 'I65.29', 'secondDiagnosis': 'R26.81', 'thirdDiagnosis': 'F03.93', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:00:33] ✅    ✅ Patient identified: Pamela Newell
[18:00:33] ✅    ✅ Patient name validation passed
[18:00:33] 🔄 
🔄 Step 3: Processing patient dates...
[18:00:33] [DOC: 9260396] ℹ️  DOB normalized: 03/15/1942
[18:00:33] [DOC: 9260396] ℹ️  Episode startOfEpisode normalized: 04/16/2025
[18:00:33] [DOC: 9260396] ℹ️  Episode endOfEpisode normalized: 06/14/2025
[18:00:33] [DOC: 9260396] ✅ Patient date processing completed successfully
[18:00:33] ✅    ✅ Date processing completed
[18:00:33] 📊 Processed Patient Data
     └─ patientFName: Pamela
     └─ patientLName: Newell
     └─ dob: 03/15/1942
     └─ patientSex: 
     └─ medicalRecordNo: MA250408034202
     └─ billingProvider: ROBERT CALDAS
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '06/14/2025', 'firstDiagnosis': 'I65.29', 'secondDiagnosis': 'R26.81', 'thirdDiagnosis': 'F03.93', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:00:33] 🔄 
🔄 Step 4: Extracting order data...
[18:00:36] ℹ️  Order extraction - MRN: 'MA250408034202'
[18:00:36] ℹ️  Order extraction - Sex: ''
[18:00:36] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:00:36] ℹ️  Order extraction - Payer Source: ''
[18:00:36] ✅ Order data extraction completed successfully
[18:00:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:00:36] ℹ️  Using MRN from patient data: 'MA250408034202' over 'MA250408034202'
[18:00:36] ⚠️  Could not determine sex using any available method
[18:00:36] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:00:36] ✅ Patient name cross-validation successful
[18:00:36] ✅    ✅ Data merged successfully
[18:00:37] ✅    ✅ Order data extracted and validated
[18:00:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:00:37] [DOC: 9260396] ✅ Patient found in local cache: Pamela Newell, ID: 916ed949-8061-47b2-9022-7ec91bcc9d65
[18:00:37] ✅    ✅ Existing patient found with ID: 916ed949-8061-47b2-9022-7ec91bcc9d65
[18:00:37] 🔄 
🔄 Step 6: Pushing order to API...
[18:00:37] [DOC: 9260396] ℹ️  Pushing order via API for patient ID: 916ed949-8061-47b2-9022-7ec91bcc9d65
[18:00:38] [DOC: 9260396] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14179"}
[18:00:38] ❌    ❌ Failed to push order
[18:00:38] 🔄 
🔄 Step 7: Writing to CSV...
[18:00:38] [DOC: 9260396] ℹ️  Calculated age: 83 from DOB: 03/15/1942
[18:00:38] [DOC: 9260396] ℹ️  Service Line extracted: 'Occupational Therapy'
[18:00:38] [DOC: 9260396] ℹ️  Payer Source extracted: ''
[18:00:38] [DOC: 9260396] ℹ️  Diagnosis codes being written:
[18:00:38] [DOC: 9260396] ℹ️    - Latest_Episode_Firstdiagnosis: 'I65.29'
[18:00:38] [DOC: 9260396] ℹ️    - Latest_Episode_Seconddiagnosis: 'R26.81'
[18:00:38] [DOC: 9260396] ℹ️    - Latest_Episode_Thirddiagnosis: 'F03.93'
[18:00:38] [DOC: 9260396] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:00:38] [DOC: 9260396] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:00:38] [DOC: 9260396] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:00:38] [DOC: 9260396] ✅ Patient data written to CSV: Pamela Newell | Sex:  | Age: 83 | Service: Occupational Therapy | Payer:  | MRN: MA250408034202
[18:00:38] ✅    ✅ Document 9260396 processed and saved successfully
[18:00:38] 🔄 
🔄 Step 8: Saving API details...
[18:00:38] [DOC: 9260396] ℹ️  API push details saved for document 9260396
[18:00:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9260393                         ║
================================================================================
[18:00:38] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:00:38] ℹ️  Date: 04/25/2025
[18:00:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:00:40] [DOC: 9260393] ✅ Text extracted using pdfplumber (1218 chars)
[18:00:40] ✅    ✅ Text extracted using pdfplumber (1218 chars)
[18:00:40] 🔄 
🔄 Step 2: Extracting patient data...
[18:00:43] ℹ️  AI extracted raw sex value: ''
[18:00:43] ℹ️  AI extracted service line: 'LVN/LPN'
[18:00:43] ℹ️  AI extracted payer source: ''
[18:00:43] ℹ️  AI extracted diagnoses:
[18:00:43] ℹ️    - Diagnosis 1: 'G89.4'
[18:00:43] ℹ️    - Diagnosis 2: 'R29.6'
[18:00:43] ℹ️    - Diagnosis 3: 'G57.00'
[18:00:43] ℹ️    - Diagnosis 4: ''
[18:00:43] ℹ️    - Diagnosis 5: ''
[18:00:43] ℹ️    - Diagnosis 6: ''
[18:00:43] ℹ️  Final extracted MRN: 'MA240113114401'
[18:00:43] ℹ️  Final extracted Sex: ''
[18:00:43] ℹ️  Final extracted Service Line: 'LVN/LPN'
[18:00:43] ℹ️  Final extracted Payer Source: ''
[18:00:43] ✅ Patient data extraction completed successfully
[18:00:43] ✅    ✅ Patient data extracted successfully
[18:00:43] 📊 Patient Response
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LVN/LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'G57.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:00:43] ✅    ✅ Patient identified: Benjamin Tavares
[18:00:43] ✅    ✅ Patient name validation passed
[18:00:43] 🔄 
🔄 Step 3: Processing patient dates...
[18:00:43] [DOC: 9260393] ℹ️  DOB normalized: 11/30/1944
[18:00:43] [DOC: 9260393] ℹ️  Episode startOfEpisode normalized: 03/07/2025
[18:00:43] [DOC: 9260393] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[18:00:43] [DOC: 9260393] ✅ Patient date processing completed successfully
[18:00:43] ✅    ✅ Date processing completed
[18:00:43] 📊 Processed Patient Data
     └─ patientFName: Benjamin
     └─ patientLName: Tavares
     └─ dob: 11/30/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA240113114401
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LVN/LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/07/2025', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'G89.4', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'G57.00', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:00:43] 🔄 
🔄 Step 4: Extracting order data...
[18:00:46] ℹ️  Order extraction - MRN: 'MA240113114401'
[18:00:46] ℹ️  Order extraction - Sex: ''
[18:00:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:00:46] ℹ️  Order extraction - Payer Source: ''
[18:00:46] ✅ Order data extraction completed successfully
[18:00:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:00:46] ℹ️  Using MRN from patient data: 'MA240113114401' over 'MA240113114401'
[18:00:46] ℹ️  Inferred sex as MALE from name: Benjamin
[18:00:46] ℹ️  Combined service lines: Patient='LVN/LPN' + Order='Skilled Nursing' = 'LVN/LPN, Skilled Nursing'
[18:00:46] ✅ Patient name cross-validation successful
[18:00:46] ✅    ✅ Data merged successfully
[18:00:47] ✅    ✅ Order data extracted and validated
[18:00:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:00:53] [DOC: 9260393] ✅ Patient exists in API: Benjamin Tavares, ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[18:00:53] ✅    ✅ Existing patient found with ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[18:00:53] 🔄 
🔄 Step 6: Pushing order to API...
[18:00:53] [DOC: 9260393] ℹ️  Pushing order via API for patient ID: 3cb86ce6-3466-45a3-8b10-d3c113aa5828
[18:00:55] [DOC: 9260393] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14486"}
[18:00:55] ❌    ❌ Failed to push order
[18:00:55] 🔄 
🔄 Step 7: Writing to CSV...
[18:00:55] [DOC: 9260393] ℹ️  Calculated age: 80 from DOB: 11/30/1944
[18:00:55] [DOC: 9260393] ℹ️  Service Line extracted: 'LVN/LPN, Skilled Nursing'
[18:00:55] [DOC: 9260393] ℹ️  Payer Source extracted: ''
[18:00:55] [DOC: 9260393] ℹ️  Diagnosis codes being written:
[18:00:55] [DOC: 9260393] ℹ️    - Latest_Episode_Firstdiagnosis: 'G89.4'
[18:00:55] [DOC: 9260393] ℹ️    - Latest_Episode_Seconddiagnosis: 'R29.6'
[18:00:55] [DOC: 9260393] ℹ️    - Latest_Episode_Thirddiagnosis: 'G57.00'
[18:00:55] [DOC: 9260393] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:00:55] [DOC: 9260393] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:00:55] [DOC: 9260393] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:00:55] [DOC: 9260393] ✅ Patient data written to CSV: Benjamin Tavares | Sex: MALE | Age: 80 | Service: LVN/LPN, Skilled Nursing | Payer:  | MRN: MA240113114401
[18:00:55] ✅    ✅ Document 9260393 processed and saved successfully
[18:00:55] 🔄 
🔄 Step 8: Saving API details...
[18:00:55] [DOC: 9260393] ℹ️  API push details saved for document 9260393
[18:00:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9260381                         ║
================================================================================
[18:00:55] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:00:55] ℹ️  Date: 04/25/2025
[18:00:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:00:57] [DOC: 9260381] ✅ Text extracted using pdfplumber (1480 chars)
[18:00:57] ✅    ✅ Text extracted using pdfplumber (1480 chars)
[18:00:57] 🔄 
🔄 Step 2: Extracting patient data...
[18:01:00] ℹ️  AI extracted raw sex value: ''
[18:01:00] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:01:00] ℹ️  AI extracted payer source: ''
[18:01:00] ℹ️  AI extracted diagnoses:
[18:01:00] ℹ️    - Diagnosis 1: 'I13.0'
[18:01:00] ℹ️    - Diagnosis 2: 'I50.33'
[18:01:00] ℹ️    - Diagnosis 3: 'E11.22'
[18:01:00] ℹ️    - Diagnosis 4: 'None'
[18:01:00] ℹ️    - Diagnosis 5: 'None'
[18:01:00] ℹ️    - Diagnosis 6: 'None'
[18:01:00] ℹ️  Final extracted MRN: '100994258'
[18:01:00] ℹ️  Final extracted Sex: ''
[18:01:00] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:01:00] ℹ️  Final extracted Payer Source: ''
[18:01:00] ✅ Patient data extraction completed successfully
[18:01:00] ✅    ✅ Patient data extracted successfully
[18:01:00] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Diaz
     └─ dob: 04/09/1951
     └─ patientSex: 
     └─ medicalRecordNo: 100994258
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:01:00] ✅    ✅ Patient identified: Gloria Diaz
[18:01:00] ✅    ✅ Patient name validation passed
[18:01:00] 🔄 
🔄 Step 3: Processing patient dates...
[18:01:00] [DOC: 9260381] ℹ️  DOB normalized: 04/09/1951
[18:01:00] [DOC: 9260381] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[18:01:00] [DOC: 9260381] ℹ️  Episode endOfEpisode normalized: 06/18/2025
[18:01:00] [DOC: 9260381] ✅ Patient date processing completed successfully
[18:01:00] ✅    ✅ Date processing completed
[18:01:00] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Diaz
     └─ dob: 04/09/1951
     └─ patientSex: 
     └─ medicalRecordNo: 100994258
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'E11.22'}]
[18:01:00] 🔄 
🔄 Step 4: Extracting order data...
[18:01:03] ℹ️  Order extraction - MRN: '100994258'
[18:01:03] ℹ️  Order extraction - Sex: ''
[18:01:03] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:01:03] ℹ️  Order extraction - Payer Source: ''
[18:01:03] ✅ Order data extraction completed successfully
[18:01:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:01:03] ℹ️  Using MRN from patient data: '100994258' over '100994258'
[18:01:03] ⚠️  Could not determine sex using any available method
[18:01:03] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:01:03] ✅ Patient name cross-validation successful
[18:01:03] ✅    ✅ Data merged successfully
[18:01:04] ✅    ✅ Order data extracted and validated
[18:01:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:01:12] [DOC: 9260381] ℹ️  Patient not found in cache or API: Gloria Diaz
[18:01:12] [DOC: 9260381] ℹ️  Patient not found, creating new patient via API...
[18:01:12] [DOC: 9260381] ℹ️  Creating patient via API: Gloria Diaz
[18:01:13] [DOC: 9260381] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:01:13] ❌    ❌ Failed to create patient
[18:01:13] [DOC: 9260381] ℹ️  API push details saved for document 9260381
================================================================================
║                        Processing Document ID: 9260373                         ║
================================================================================
[18:01:13] ℹ️  Agency: AccentCare Fall River
[18:01:13] ℹ️  Date: 04/25/2025
[18:01:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:01:18] [DOC: 9260373] ✅ Text extracted using pdfplumber (38973 chars)
[18:01:18] ✅    ✅ Text extracted using pdfplumber (38853 chars)
[18:01:18] 🔄 
🔄 Step 2: Extracting patient data...
[18:01:21] ℹ️  AI extracted raw sex value: 'M'
[18:01:21] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:01:21] ℹ️  AI extracted payer source: 'Medicare'
[18:01:21] ℹ️  AI extracted diagnoses:
[18:01:21] ℹ️    - Diagnosis 1: 'C15.9'
[18:01:21] ℹ️    - Diagnosis 2: 'I13.0'
[18:01:21] ℹ️    - Diagnosis 3: 'I50.9'
[18:01:21] ℹ️    - Diagnosis 4: 'E11.22'
[18:01:21] ℹ️    - Diagnosis 5: 'N18.30'
[18:01:21] ℹ️    - Diagnosis 6: 'D23.9'
[18:01:21] ℹ️  Final extracted MRN: 'C0200237232301'
[18:01:21] ℹ️  Final extracted Sex: 'MALE'
[18:01:21] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:01:21] ℹ️  Final extracted Payer Source: 'Medicare'
[18:01:21] ✅ Patient data extraction completed successfully
[18:01:21] ✅    ✅ Patient data extracted successfully
[18:01:21] 📊 Patient Response
     └─ patientFName: MILO
     └─ patientLName: WEBSTER
     └─ dob: 07/21/1959
     └─ patientSex: MALE
     └─ medicalRecordNo: C0200237232301
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/14/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'C15.9', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.9', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'D23.9'}]
[18:01:21] ✅    ✅ Patient identified: MILO WEBSTER
[18:01:21] ✅    ✅ Patient name validation passed
[18:01:21] 🔄 
🔄 Step 3: Processing patient dates...
[18:01:21] [DOC: 9260373] ℹ️  DOB normalized: 07/21/1959
[18:01:21] [DOC: 9260373] ℹ️  Episode startOfCare normalized: 04/14/2025
[18:01:21] [DOC: 9260373] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[18:01:21] [DOC: 9260373] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[18:01:21] [DOC: 9260373] ✅ Patient date processing completed successfully
[18:01:21] ✅    ✅ Date processing completed
[18:01:21] 📊 Processed Patient Data
     └─ patientFName: MILO
     └─ patientLName: WEBSTER
     └─ dob: 07/21/1959
     └─ patientSex: MALE
     └─ medicalRecordNo: C0200237232301
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/14/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'C15.9', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.9', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'D23.9'}]
[18:01:21] 🔄 
🔄 Step 4: Extracting order data...
[18:01:25] ℹ️  Order extraction - MRN: '227203'
[18:01:25] ℹ️  Order extraction - Sex: 'MALE'
[18:01:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:01:25] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:01:25] ✅ Order data extraction completed successfully
[18:01:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:01:25] ℹ️  Using MRN from patient data: 'C0200237232301' over '227203'
[18:01:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:01:25] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:01:25] ✅ Patient name cross-validation successful
[18:01:25] ✅    ✅ Data merged successfully
[18:01:26] ✅    ✅ Order data extracted and validated
[18:01:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:01:26] [DOC: 9260373] ✅ Patient found in local cache: MILO WEBSTER, ID: 695c5703-e477-4b11-a055-202369179483
[18:01:26] ✅    ✅ Existing patient found with ID: 695c5703-e477-4b11-a055-202369179483
[18:01:26] 🔄 
🔄 Step 6: Pushing order to API...
[18:01:26] [DOC: 9260373] ℹ️  Pushing order via API for patient ID: 695c5703-e477-4b11-a055-202369179483
[18:01:27] [DOC: 9260373] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14419"}
[18:01:27] ❌    ❌ Failed to push order
[18:01:27] 🔄 
🔄 Step 7: Writing to CSV...
[18:01:27] [DOC: 9260373] ℹ️  Calculated age: 65 from DOB: 07/21/1959
[18:01:27] [DOC: 9260373] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[18:01:27] [DOC: 9260373] ℹ️  Payer Source extracted: 'Medicare'
[18:01:27] [DOC: 9260373] ℹ️  Diagnosis codes being written:
[18:01:27] [DOC: 9260373] ℹ️    - Latest_Episode_Firstdiagnosis: 'C15.9'
[18:01:27] [DOC: 9260373] ℹ️    - Latest_Episode_Seconddiagnosis: 'I13.0'
[18:01:27] [DOC: 9260373] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.9'
[18:01:27] [DOC: 9260373] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.22'
[18:01:27] [DOC: 9260373] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.30'
[18:01:27] [DOC: 9260373] ℹ️    - Latest_Episode_Sixthdiagnosis: 'D23.9'
[18:01:27] [DOC: 9260373] ✅ Patient data written to CSV: MILO WEBSTER | Sex: MALE | Age: 65 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: C0200237232301
[18:01:27] ✅    ✅ Document 9260373 processed and saved successfully
[18:01:27] 🔄 
🔄 Step 8: Saving API details...
[18:01:27] [DOC: 9260373] ℹ️  API push details saved for document 9260373
[18:01:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9260378                         ║
================================================================================
[18:01:27] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:01:27] ℹ️  Date: 04/25/2025
[18:01:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:01:31] [DOC: 9260378] ✅ Text extracted using pdfplumber (2207 chars)
[18:01:31] ✅    ✅ Text extracted using pdfplumber (2207 chars)
[18:01:31] 🔄 
🔄 Step 2: Extracting patient data...
[18:01:34] ℹ️  AI extracted raw sex value: ''
[18:01:34] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:01:34] ℹ️  AI extracted payer source: ''
[18:01:34] ℹ️  AI extracted diagnoses:
[18:01:34] ℹ️    - Diagnosis 1: 'K25.9'
[18:01:34] ℹ️    - Diagnosis 2: 'D50.0'
[18:01:34] ℹ️    - Diagnosis 3: 'K50.90'
[18:01:34] ℹ️    - Diagnosis 4: 'None'
[18:01:34] ℹ️    - Diagnosis 5: 'None'
[18:01:34] ℹ️    - Diagnosis 6: 'None'
[18:01:34] ℹ️  Final extracted MRN: 'MA250328114901'
[18:01:34] ℹ️  Final extracted Sex: ''
[18:01:34] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:01:34] ℹ️  Final extracted Payer Source: ''
[18:01:34] ✅ Patient data extraction completed successfully
[18:01:34] ✅    ✅ Patient data extracted successfully
[18:01:34] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:01:34] ✅    ✅ Patient identified: Shirley Tavares
[18:01:34] ✅    ✅ Patient name validation passed
[18:01:34] 🔄 
🔄 Step 3: Processing patient dates...
[18:01:34] [DOC: 9260378] ℹ️  DOB normalized: 11/10/1949
[18:01:34] [DOC: 9260378] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[18:01:34] [DOC: 9260378] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[18:01:34] [DOC: 9260378] ✅ Patient date processing completed successfully
[18:01:34] ✅    ✅ Date processing completed
[18:01:34] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90'}]
[18:01:34] 🔄 
🔄 Step 4: Extracting order data...
[18:01:36] ℹ️  Order extraction - MRN: 'MA250328114901'
[18:01:36] ℹ️  Order extraction - Sex: ''
[18:01:36] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:01:36] ℹ️  Order extraction - Payer Source: ''
[18:01:36] ✅ Order data extraction completed successfully
[18:01:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:01:36] ℹ️  Using MRN from patient data: 'MA250328114901' over 'MA250328114901'
[18:01:36] ⚠️  Could not determine sex using any available method
[18:01:36] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:01:36] ✅ Patient name cross-validation successful
[18:01:36] ✅    ✅ Data merged successfully
[18:01:38] ✅    ✅ Order data extracted and validated
[18:01:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:01:53] [DOC: 9260378] ✅ Patient exists in API: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[18:01:53] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[18:01:53] 🔄 
🔄 Step 6: Pushing order to API...
[18:01:53] [DOC: 9260378] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[18:01:55] [DOC: 9260378] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14225"}
[18:01:55] ❌    ❌ Failed to push order
[18:01:55] 🔄 
🔄 Step 7: Writing to CSV...
[18:01:55] [DOC: 9260378] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[18:01:55] [DOC: 9260378] ℹ️  Service Line extracted: 'Occupational Therapy'
[18:01:55] [DOC: 9260378] ℹ️  Payer Source extracted: ''
[18:01:55] [DOC: 9260378] ℹ️  Diagnosis codes being written:
[18:01:55] [DOC: 9260378] ℹ️    - Latest_Episode_Firstdiagnosis: 'K25.9'
[18:01:55] [DOC: 9260378] ℹ️    - Latest_Episode_Seconddiagnosis: 'D50.0'
[18:01:55] [DOC: 9260378] ℹ️    - Latest_Episode_Thirddiagnosis: 'K50.90'
[18:01:55] [DOC: 9260378] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:01:55] [DOC: 9260378] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:01:55] [DOC: 9260378] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:01:55] [DOC: 9260378] ✅ Patient data written to CSV: Shirley Tavares | Sex:  | Age: 75 | Service: Occupational Therapy | Payer:  | MRN: MA250328114901
[18:01:55] ✅    ✅ Document 9260378 processed and saved successfully
[18:01:55] 🔄 
🔄 Step 8: Saving API details...
[18:01:55] [DOC: 9260378] ℹ️  API push details saved for document 9260378
[18:01:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9260375                         ║
================================================================================
[18:01:55] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:01:55] ℹ️  Date: 04/25/2025
[18:01:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:01:57] [DOC: 9260375] ✅ Text extracted using pdfplumber (1564 chars)
[18:01:57] ✅    ✅ Text extracted using pdfplumber (1564 chars)
[18:01:57] 🔄 
🔄 Step 2: Extracting patient data...
[18:02:00] ℹ️  AI extracted raw sex value: ''
[18:02:00] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:02:00] ℹ️  AI extracted payer source: ''
[18:02:00] ℹ️  AI extracted diagnoses:
[18:02:00] ℹ️    - Diagnosis 1: 'K25.9'
[18:02:00] ℹ️    - Diagnosis 2: 'D50.0'
[18:02:00] ℹ️    - Diagnosis 3: 'K50.90'
[18:02:00] ℹ️    - Diagnosis 4: 'None'
[18:02:00] ℹ️    - Diagnosis 5: 'None'
[18:02:00] ℹ️    - Diagnosis 6: 'None'
[18:02:00] ℹ️  Final extracted MRN: 'MA250328114901'
[18:02:00] ℹ️  Final extracted Sex: ''
[18:02:00] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:02:00] ℹ️  Final extracted Payer Source: ''
[18:02:00] ✅ Patient data extraction completed successfully
[18:02:00] ✅    ✅ Patient data extracted successfully
[18:02:00] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:02:00] ✅    ✅ Patient identified: Shirley Tavares
[18:02:00] ✅    ✅ Patient name validation passed
[18:02:00] 🔄 
🔄 Step 3: Processing patient dates...
[18:02:00] [DOC: 9260375] ℹ️  DOB normalized: 11/10/1949
[18:02:00] [DOC: 9260375] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[18:02:00] [DOC: 9260375] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[18:02:00] [DOC: 9260375] ✅ Patient date processing completed successfully
[18:02:00] ✅    ✅ Date processing completed
[18:02:00] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90'}]
[18:02:00] 🔄 
🔄 Step 4: Extracting order data...
[18:02:03] ℹ️  Order extraction - MRN: 'MA250328114901'
[18:02:03] ℹ️  Order extraction - Sex: ''
[18:02:03] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:02:03] ℹ️  Order extraction - Payer Source: ''
[18:02:03] ✅ Order data extraction completed successfully
[18:02:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:02:03] ℹ️  Using MRN from patient data: 'MA250328114901' over 'MA250328114901'
[18:02:03] ⚠️  Could not determine sex using any available method
[18:02:03] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:02:03] ✅ Patient name cross-validation successful
[18:02:03] ✅    ✅ Data merged successfully
[18:02:05] ✅    ✅ Order data extracted and validated
[18:02:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:02:05] [DOC: 9260375] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[18:02:05] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[18:02:05] 🔄 
🔄 Step 6: Pushing order to API...
[18:02:05] [DOC: 9260375] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[18:02:06] [DOC: 9260375] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14226"}
[18:02:06] ❌    ❌ Failed to push order
[18:02:06] 🔄 
🔄 Step 7: Writing to CSV...
[18:02:06] [DOC: 9260375] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[18:02:06] [DOC: 9260375] ℹ️  Service Line extracted: 'Occupational Therapy'
[18:02:06] [DOC: 9260375] ℹ️  Payer Source extracted: ''
[18:02:06] [DOC: 9260375] ℹ️  Diagnosis codes being written:
[18:02:06] [DOC: 9260375] ℹ️    - Latest_Episode_Firstdiagnosis: 'K25.9'
[18:02:06] [DOC: 9260375] ℹ️    - Latest_Episode_Seconddiagnosis: 'D50.0'
[18:02:06] [DOC: 9260375] ℹ️    - Latest_Episode_Thirddiagnosis: 'K50.90'
[18:02:06] [DOC: 9260375] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:02:06] [DOC: 9260375] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:02:06] [DOC: 9260375] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:02:06] [DOC: 9260375] ✅ Patient data written to CSV: Shirley Tavares | Sex:  | Age: 75 | Service: Occupational Therapy | Payer:  | MRN: MA250328114901
[18:02:06] ✅    ✅ Document 9260375 processed and saved successfully
[18:02:06] 🔄 
🔄 Step 8: Saving API details...
[18:02:06] [DOC: 9260375] ℹ️  API push details saved for document 9260375
[18:02:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9260335                         ║
================================================================================
[18:02:06] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[18:02:06] ℹ️  Date: 04/25/2025
[18:02:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:02:08] [DOC: 9260335] ✅ Text extracted using pdfplumber (1509 chars)
[18:02:08] ✅    ✅ Text extracted using pdfplumber (1509 chars)
[18:02:08] 🔄 
🔄 Step 2: Extracting patient data...
[18:02:11] ℹ️  AI extracted raw sex value: ''
[18:02:11] ℹ️  AI extracted service line: 'Occupational Therapy'
[18:02:11] ℹ️  AI extracted payer source: ''
[18:02:11] ℹ️  AI extracted diagnoses:
[18:02:11] ℹ️    - Diagnosis 1: 'M47.816'
[18:02:11] ℹ️    - Diagnosis 2: 'M75.41'
[18:02:11] ℹ️    - Diagnosis 3: 'M17.0'
[18:02:11] ℹ️    - Diagnosis 4: 'None'
[18:02:11] ℹ️    - Diagnosis 5: 'None'
[18:02:11] ℹ️    - Diagnosis 6: 'None'
[18:02:11] ℹ️  Final extracted MRN: 'MA241216044603'
[18:02:11] ℹ️  Final extracted Sex: ''
[18:02:11] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[18:02:11] ℹ️  Final extracted Payer Source: ''
[18:02:11] ✅ Patient data extraction completed successfully
[18:02:11] ✅    ✅ Patient data extracted successfully
[18:02:11] 📊 Patient Response
     └─ patientFName: Leonor
     └─ patientLName: Gomes
     └─ dob: 04/15/1946
     └─ patientSex: 
     └─ medicalRecordNo: MA241216044603
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/22/2025', 'endOfEpisode': '06/20/2025', 'firstDiagnosis': 'M47.816', 'secondDiagnosis': 'M75.41', 'thirdDiagnosis': 'M17.0', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:02:11] ✅    ✅ Patient identified: Leonor Gomes
[18:02:11] ✅    ✅ Patient name validation passed
[18:02:11] 🔄 
🔄 Step 3: Processing patient dates...
[18:02:11] [DOC: 9260335] ℹ️  DOB normalized: 04/15/1946
[18:02:11] [DOC: 9260335] ℹ️  Episode startOfEpisode normalized: 04/22/2025
[18:02:11] [DOC: 9260335] ℹ️  Episode endOfEpisode normalized: 06/20/2025
[18:02:11] [DOC: 9260335] ✅ Patient date processing completed successfully
[18:02:11] ✅    ✅ Date processing completed
[18:02:11] 📊 Processed Patient Data
     └─ patientFName: Leonor
     └─ patientLName: Gomes
     └─ dob: 04/15/1946
     └─ patientSex: 
     └─ medicalRecordNo: MA241216044603
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/22/2025', 'endOfEpisode': '06/20/2025', 'firstDiagnosis': 'M47.816', 'secondDiagnosis': 'M75.41', 'thirdDiagnosis': 'M17.0'}]
[18:02:11] 🔄 
🔄 Step 4: Extracting order data...
[18:02:14] ℹ️  Order extraction - MRN: 'MA241216044603'
[18:02:14] ℹ️  Order extraction - Sex: ''
[18:02:14] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[18:02:14] ℹ️  Order extraction - Payer Source: ''
[18:02:14] ✅ Order data extraction completed successfully
[18:02:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:02:14] ℹ️  Using MRN from patient data: 'MA241216044603' over 'MA241216044603'
[18:02:14] ⚠️  Could not determine sex using any available method
[18:02:14] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[18:02:14] ✅ Patient name cross-validation successful
[18:02:14] ✅    ✅ Data merged successfully
[18:02:15] ✅    ✅ Order data extracted and validated
[18:02:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:02:15] [DOC: 9260335] ✅ Patient found in local cache: Leonor Gomes, ID: 2f7fe652-20e0-42a4-9884-7cd4ba8861fa
[18:02:15] ✅    ✅ Existing patient found with ID: 2f7fe652-20e0-42a4-9884-7cd4ba8861fa
[18:02:15] 🔄 
🔄 Step 6: Pushing order to API...
[18:02:15] [DOC: 9260335] ℹ️  Pushing order via API for patient ID: 2f7fe652-20e0-42a4-9884-7cd4ba8861fa
[18:02:17] [DOC: 9260335] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13802"}
[18:02:17] ❌    ❌ Failed to push order
[18:02:17] 🔄 
🔄 Step 7: Writing to CSV...
[18:02:17] [DOC: 9260335] ℹ️  Calculated age: 79 from DOB: 04/15/1946
[18:02:17] [DOC: 9260335] ℹ️  Service Line extracted: 'Occupational Therapy'
[18:02:17] [DOC: 9260335] ℹ️  Payer Source extracted: ''
[18:02:17] [DOC: 9260335] ℹ️  Diagnosis codes being written:
[18:02:17] [DOC: 9260335] ℹ️    - Latest_Episode_Firstdiagnosis: 'M47.816'
[18:02:17] [DOC: 9260335] ℹ️    - Latest_Episode_Seconddiagnosis: 'M75.41'
[18:02:17] [DOC: 9260335] ℹ️    - Latest_Episode_Thirddiagnosis: 'M17.0'
[18:02:17] [DOC: 9260335] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:02:17] [DOC: 9260335] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:02:17] [DOC: 9260335] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:02:17] [DOC: 9260335] ✅ Patient data written to CSV: Leonor Gomes | Sex:  | Age: 79 | Service: Occupational Therapy | Payer:  | MRN: MA241216044603
[18:02:17] ✅    ✅ Document 9260335 processed and saved successfully
[18:02:17] 🔄 
🔄 Step 8: Saving API details...
[18:02:17] [DOC: 9260335] ℹ️  API push details saved for document 9260335
[18:02:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9260226                         ║
================================================================================
[18:02:17] ℹ️  Agency: Brockton Home Health Care
[18:02:17] ℹ️  Date: 04/24/2025
[18:02:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:02:20] [DOC: 9260226] ✅ Text extracted using pdfplumber (13584 chars)
[18:02:20] ✅    ✅ Text extracted using pdfplumber (13584 chars)
[18:02:20] 🔄 
🔄 Step 2: Extracting patient data...
[18:02:23] ℹ️  AI extracted raw sex value: 'M'
[18:02:23] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:02:23] ℹ️  AI extracted payer source: 'None'
[18:02:23] ℹ️  AI extracted diagnoses:
[18:02:23] ℹ️    - Diagnosis 1: 'F25.0'
[18:02:23] ℹ️    - Diagnosis 2: 'F32.A'
[18:02:23] ℹ️    - Diagnosis 3: 'G47.9'
[18:02:23] ℹ️    - Diagnosis 4: 'Z91.51'
[18:02:23] ℹ️    - Diagnosis 5: 'K21.9'
[18:02:23] ℹ️    - Diagnosis 6: 'J45.909'
[18:02:23] ℹ️  Final extracted MRN: 'BHHA1887764'
[18:02:23] ℹ️  Final extracted Sex: 'MALE'
[18:02:23] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:02:23] ℹ️  Final extracted Payer Source: ''
[18:02:23] ✅ Patient data extraction completed successfully
[18:02:23] ✅    ✅ Patient data extracted successfully
[18:02:23] 📊 Patient Response
     └─ patientFName: Earl
     └─ patientLName: Thompson
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: None
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY SUITE 20
     └─ city: BROCKTON
     └─ state: MA
     └─ zip: 02301-7225
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/29/2024', 'startOfEpisode': '04/24/2025', 'endOfEpisode': '06/22/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'F32.A', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': 'Z91.51', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'J45.909'}]
[18:02:23] ✅    ✅ Patient identified: Earl Thompson
[18:02:23] ✅    ✅ Patient name validation passed
[18:02:23] 🔄 
🔄 Step 3: Processing patient dates...
[18:02:23] [DOC: 9260226] ℹ️  DOB normalized: 05/31/2002
[18:02:23] [DOC: 9260226] ℹ️  Episode startOfCare normalized: 04/29/2024
[18:02:23] [DOC: 9260226] ℹ️  Episode startOfEpisode normalized: 04/24/2025
[18:02:23] [DOC: 9260226] ℹ️  Episode endOfEpisode normalized: 06/22/2025
[18:02:23] [DOC: 9260226] ✅ Patient date processing completed successfully
[18:02:23] ✅    ✅ Date processing completed
[18:02:23] 📊 Processed Patient Data
     └─ patientFName: Earl
     └─ patientLName: Thompson
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY SUITE 20
     └─ city: BROCKTON
     └─ state: MA
     └─ zip: 02301-7225
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/29/2024', 'startOfEpisode': '04/24/2025', 'endOfEpisode': '06/22/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'F32.A', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': 'Z91.51', 'fifthDiagnosis': 'K21.9', 'sixthDiagnosis': 'J45.909'}]
[18:02:23] 🔄 
🔄 Step 4: Extracting order data...
[18:02:26] ℹ️  Order extraction - MRN: 'BHHA1887764'
[18:02:26] ℹ️  Order extraction - Sex: 'MALE'
[18:02:26] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:02:26] ℹ️  Order extraction - Payer Source: ''
[18:02:26] ✅ Order data extraction completed successfully
[18:02:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:02:26] ℹ️  Using MRN from patient data: 'BHHA1887764' over 'BHHA1887764'
[18:02:26] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:02:26] ✅ Patient name cross-validation successful
[18:02:26] ✅    ✅ Data merged successfully
[18:02:27] ⚠️     ❌ Skipping - missing company ID for agency: Brockton Home Health Care
[18:02:27] [DOC: 9260226] ℹ️  API push details saved for document 9260226
================================================================================
║                        Processing Document ID: 9260225                         ║
================================================================================
[18:02:27] ℹ️  Agency: Brockton Home Health Care
[18:02:27] ℹ️  Date: 04/24/2025
[18:02:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:02:30] [DOC: 9260225] ✅ Text extracted using pdfplumber (7830 chars)
[18:02:30] ✅    ✅ Text extracted using pdfplumber (7830 chars)
[18:02:30] 🔄 
🔄 Step 2: Extracting patient data...
[18:02:33] ℹ️  AI extracted raw sex value: 'M'
[18:02:33] ℹ️  AI extracted service line: ''
[18:02:33] ℹ️  AI extracted payer source: ''
[18:02:33] ℹ️  AI extracted diagnoses:
[18:02:33] ℹ️    - Diagnosis 1: ''
[18:02:33] ℹ️    - Diagnosis 2: ''
[18:02:33] ℹ️    - Diagnosis 3: ''
[18:02:33] ℹ️    - Diagnosis 4: ''
[18:02:33] ℹ️    - Diagnosis 5: ''
[18:02:33] ℹ️    - Diagnosis 6: ''
[18:02:33] ℹ️  Final extracted MRN: 'BHHA1887764'
[18:02:33] ℹ️  Final extracted Sex: 'MALE'
[18:02:33] ℹ️  Final extracted Service Line: ''
[18:02:33] ℹ️  Final extracted Payer Source: ''
[18:02:33] ✅ Patient data extraction completed successfully
[18:02:33] ✅    ✅ Patient data extracted successfully
[18:02:33] 📊 Patient Response
     └─ patientFName: Earl
     └─ patientLName: Thompson
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: Maalouf-kaleshian, Karine M.D.
     └─ npi: 100033309145
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY, SUITE 20
     └─ city: Brockton
     └─ state: MA
     └─ zip: 02301-7225
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:02:33] ✅    ✅ Patient identified: Earl Thompson
[18:02:33] ✅    ✅ Patient name validation passed
[18:02:33] 🔄 
🔄 Step 3: Processing patient dates...
[18:02:33] [DOC: 9260225] ℹ️  DOB normalized: 05/31/2002
[18:02:33] [DOC: 9260225] ℹ️  Episode startOfEpisode normalized: 02/23/2025
[18:02:33] [DOC: 9260225] ℹ️  Episode endOfEpisode normalized: 04/23/2025
[18:02:33] [DOC: 9260225] ✅ Patient date processing completed successfully
[18:02:33] ✅    ✅ Date processing completed
[18:02:33] 📊 Processed Patient Data
     └─ patientFName: Earl
     └─ patientLName: Thompson
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: Maalouf-kaleshian, Karine M.D.
     └─ npi: 100033309145
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY, SUITE 20
     └─ city: Brockton
     └─ state: MA
     └─ zip: 02301-7225
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:02:33] 🔄 
🔄 Step 4: Extracting order data...
[18:02:36] ℹ️  Order extraction - MRN: 'BHHA1887764'
[18:02:36] ℹ️  Order extraction - Sex: 'MALE'
[18:02:36] ℹ️  Order extraction - Service Line: ''
[18:02:36] ℹ️  Order extraction - Payer Source: ''
[18:02:36] ✅ Order data extraction completed successfully
[18:02:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:02:36] ℹ️  Using MRN from patient data: 'BHHA1887764' over 'BHHA1887764'
[18:02:36] ✅ Patient name cross-validation successful
[18:02:36] ✅    ✅ Data merged successfully
[18:02:37] ⚠️     ❌ Skipping - missing company ID for agency: Brockton Home Health Care
[18:02:37] [DOC: 9260225] ℹ️  API push details saved for document 9260225
================================================================================
║                        Processing Document ID: 9260224                         ║
================================================================================
[18:02:37] ℹ️  Agency: Brockton Home Health Care
[18:02:37] ℹ️  Date: 04/24/2025
[18:02:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:02:39] [DOC: 9260224] ✅ Text extracted using pdfplumber (1362 chars)
[18:02:39] ✅    ✅ Text extracted using pdfplumber (1362 chars)
[18:02:39] 🔄 
🔄 Step 2: Extracting patient data...
[18:02:42] ℹ️  AI extracted raw sex value: 'M'
[18:02:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:02:42] ℹ️  AI extracted payer source: ''
[18:02:42] ℹ️  AI extracted diagnoses:
[18:02:42] ℹ️    - Diagnosis 1: 'None'
[18:02:42] ℹ️    - Diagnosis 2: 'None'
[18:02:42] ℹ️    - Diagnosis 3: 'None'
[18:02:42] ℹ️    - Diagnosis 4: 'None'
[18:02:42] ℹ️    - Diagnosis 5: 'None'
[18:02:42] ℹ️    - Diagnosis 6: 'None'
[18:02:42] ℹ️  Final extracted MRN: 'BHHA1887764'
[18:02:42] ℹ️  Final extracted Sex: 'MALE'
[18:02:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:02:42] ℹ️  Final extracted Payer Source: ''
[18:02:42] ✅ Patient data extraction completed successfully
[18:02:42] ✅    ✅ Patient data extracted successfully
[18:02:42] 📊 Patient Response
     └─ patientFName: Earl
     └─ patientLName: Thompson
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: Maalouf-kaleshian, Karine M.D.
     └─ npi: 100033309145
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY, SUITE 20
     └─ city: Brockton
     └─ state: MA
     └─ zip: 02301-7225
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:02:42] ✅    ✅ Patient identified: Earl Thompson
[18:02:42] ✅    ✅ Patient name validation passed
[18:02:42] 🔄 
🔄 Step 3: Processing patient dates...
[18:02:42] [DOC: 9260224] ℹ️  DOB normalized: 05/31/2002
[18:02:42] [DOC: 9260224] ℹ️  Episode startOfEpisode normalized: 02/23/2025
[18:02:42] [DOC: 9260224] ℹ️  Episode endOfEpisode normalized: 04/23/2025
[18:02:42] [DOC: 9260224] ✅ Patient date processing completed successfully
[18:02:42] ✅    ✅ Date processing completed
[18:02:42] 📊 Processed Patient Data
     └─ patientFName: Earl
     └─ patientLName: Thompson
     └─ dob: 05/31/2002
     └─ patientSex: MALE
     └─ medicalRecordNo: BHHA1887764
     └─ billingProvider: Maalouf-kaleshian, Karine M.D.
     └─ npi: 100033309145
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: BROCKTON HOME HEALTH CARE AGENCY
     └─ address: 71 LEGION PKWY, SUITE 20
     └─ city: Brockton
     └─ state: MA
     └─ zip: 02301-7225
     └─ email: 
     └─ phoneNumber: (508) 219-0101
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025'}]
[18:02:42] 🔄 
🔄 Step 4: Extracting order data...
[18:02:45] ℹ️  Order extraction - MRN: 'BHHA1887764'
[18:02:45] ℹ️  Order extraction - Sex: 'MALE'
[18:02:45] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:02:45] ℹ️  Order extraction - Payer Source: ''
[18:02:45] ✅ Order data extraction completed successfully
[18:02:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:02:45] ℹ️  Using MRN from patient data: 'BHHA1887764' over 'BHHA1887764'
[18:02:45] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:02:45] ✅ Patient name cross-validation successful
[18:02:45] ✅    ✅ Data merged successfully
[18:02:46] ⚠️     ❌ Skipping - missing company ID for agency: Brockton Home Health Care
[18:02:46] [DOC: 9260224] ℹ️  API push details saved for document 9260224
================================================================================
║                        Processing Document ID: 9260212                         ║
================================================================================
[18:02:46] ℹ️  Agency: Bayada Home Health Care Inc-Plymouth
[18:02:46] ℹ️  Date: 04/24/2025
[18:02:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:02:51] [DOC: 9260212] ✅ Text extracted using pdfplumber (1401 chars)
[18:02:51] ✅    ✅ Text extracted using pdfplumber (1401 chars)
[18:02:51] 🔄 
🔄 Step 2: Extracting patient data...
[18:02:54] ℹ️  AI extracted raw sex value: ''
[18:02:54] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:02:54] ℹ️  AI extracted payer source: 'Medicare'
[18:02:54] ℹ️  AI extracted diagnoses:
[18:02:54] ℹ️    - Diagnosis 1: ''
[18:02:54] ℹ️    - Diagnosis 2: ''
[18:02:54] ℹ️    - Diagnosis 3: ''
[18:02:54] ℹ️    - Diagnosis 4: ''
[18:02:54] ℹ️    - Diagnosis 5: ''
[18:02:54] ℹ️    - Diagnosis 6: ''
[18:02:54] ℹ️  Final extracted MRN: '13900210495401'
[18:02:54] ℹ️  Final extracted Sex: ''
[18:02:54] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:02:54] ℹ️  Final extracted Payer Source: 'Medicare'
[18:02:54] ✅ Patient data extraction completed successfully
[18:02:54] ✅    ✅ Patient data extracted successfully
[18:02:54] 📊 Patient Response
     └─ patientFName: JOSEPH
     └─ patientLName: SULLIVAN
     └─ dob: 10/08/1955
     └─ patientSex: 
     └─ medicalRecordNo: 13900210495401
     └─ billingProvider: ELAINE WU, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUNCE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:02:54] ✅    ✅ Patient identified: JOSEPH SULLIVAN
[18:02:54] ✅    ✅ Patient name validation passed
[18:02:54] 🔄 
🔄 Step 3: Processing patient dates...
[18:02:54] [DOC: 9260212] ℹ️  DOB normalized: 10/08/1955
[18:02:54] [DOC: 9260212] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[18:02:54] [DOC: 9260212] ℹ️  Episode endOfEpisode normalized: 03/26/2025
[18:02:54] [DOC: 9260212] ✅ Patient date processing completed successfully
[18:02:54] ✅    ✅ Date processing completed
[18:02:54] 📊 Processed Patient Data
     └─ patientFName: JOSEPH
     └─ patientLName: SULLIVAN
     └─ dob: 10/08/1955
     └─ patientSex: 
     └─ medicalRecordNo: 13900210495401
     └─ billingProvider: ELAINE WU, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUNCE CORNER RD
     └─ city: NORTH DARTMOUTH
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:02:54] 🔄 
🔄 Step 4: Extracting order data...
[18:02:56] ℹ️  Order extraction - MRN: '13900210495401'
[18:02:56] ℹ️  Order extraction - Sex: ''
[18:02:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:02:56] ℹ️  Order extraction - Payer Source: 'Medicare'
[18:02:56] ✅ Order data extraction completed successfully
[18:02:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:02:56] ℹ️  Using MRN from patient data: '13900210495401' over '13900210495401'
[18:02:56] ℹ️  Inferred sex as MALE from name: JOSEPH
[18:02:56] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:02:56] ℹ️  Payer source consistent in both sources: 'Medicare'
[18:02:56] ✅ Patient name cross-validation successful
[18:02:56] ✅    ✅ Data merged successfully
[18:02:57] ✅    ✅ Order data extracted and validated
[18:02:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:03:06] [DOC: 9260212] ℹ️  Patient not found in cache or API: JOSEPH SULLIVAN
[18:03:06] [DOC: 9260212] ℹ️  Patient not found, creating new patient via API...
[18:03:06] [DOC: 9260212] ℹ️  Creating patient via API: JOSEPH SULLIVAN
[18:03:07] [DOC: 9260212] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:03:07] ❌    ❌ Failed to create patient
[18:03:07] [DOC: 9260212] ℹ️  API push details saved for document 9260212
================================================================================
║                        Processing Document ID: 9259630                         ║
================================================================================
[18:03:07] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:03:07] ℹ️  Date: 04/24/2025
[18:03:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:03:08] [DOC: 9259630] ✅ Text extracted using pdfplumber (1270 chars)
[18:03:08] ✅    ✅ Text extracted using pdfplumber (1270 chars)
[18:03:08] 🔄 
🔄 Step 2: Extracting patient data...
[18:03:11] ℹ️  AI extracted raw sex value: 'F'
[18:03:11] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:03:11] ℹ️  AI extracted payer source: ''
[18:03:11] ℹ️  AI extracted diagnoses:
[18:03:11] ℹ️    - Diagnosis 1: 'None'
[18:03:11] ℹ️    - Diagnosis 2: 'None'
[18:03:11] ℹ️    - Diagnosis 3: 'None'
[18:03:11] ℹ️    - Diagnosis 4: 'None'
[18:03:11] ℹ️    - Diagnosis 5: 'None'
[18:03:11] ℹ️    - Diagnosis 6: 'None'
[18:03:11] ℹ️  Final extracted MRN: '3052261'
[18:03:11] ℹ️  Final extracted Sex: 'FEMALE'
[18:03:11] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:03:11] ℹ️  Final extracted Payer Source: ''
[18:03:11] ✅ Patient data extraction completed successfully
[18:03:11] ✅    ✅ Patient data extracted successfully
[18:03:11] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Trott
     └─ dob: 04/22/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3052261
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/23/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:03:11] ✅    ✅ Patient identified: Donna Trott
[18:03:11] ✅    ✅ Patient name validation passed
[18:03:11] 🔄 
🔄 Step 3: Processing patient dates...
[18:03:11] [DOC: 9259630] ℹ️  DOB normalized: 04/22/1943
[18:03:11] [DOC: 9259630] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[18:03:11] [DOC: 9259630] ✅ Patient date processing completed successfully
[18:03:11] ✅    ✅ Date processing completed
[18:03:11] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Trott
     └─ dob: 04/22/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3052261
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/23/2025'}]
[18:03:11] 🔄 
🔄 Step 4: Extracting order data...
[18:03:13] ℹ️  Order extraction - MRN: '3052261'
[18:03:13] ℹ️  Order extraction - Sex: 'FEMALE'
[18:03:13] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:03:13] ℹ️  Order extraction - Payer Source: ''
[18:03:13] ✅ Order data extraction completed successfully
[18:03:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:03:13] ℹ️  Using MRN from patient data: '3052261' over '3052261'
[18:03:13] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:03:13] ✅ Patient name cross-validation successful
[18:03:13] ✅    ✅ Data merged successfully
[18:03:15] ✅    ✅ Order data extracted and validated
[18:03:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:03:15] [DOC: 9259630] ✅ Patient found in local cache: Donna Trott, ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[18:03:15] ✅    ✅ Existing patient found with ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[18:03:15] 🔄 
🔄 Step 6: Pushing order to API...
[18:03:15] [DOC: 9259630] ℹ️  Pushing order via API for patient ID: 35c8b502-60ae-4cbb-b57d-d65de599a3da
[18:03:16] [DOC: 9259630] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19682"}
[18:03:16] ❌    ❌ Failed to push order
[18:03:16] 🔄 
🔄 Step 7: Writing to CSV...
[18:03:16] [DOC: 9259630] ℹ️  Calculated age: 82 from DOB: 04/22/1943
[18:03:16] [DOC: 9259630] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:03:16] [DOC: 9259630] ℹ️  Payer Source extracted: ''
[18:03:16] [DOC: 9259630] ℹ️  Diagnosis codes being written:
[18:03:16] [DOC: 9259630] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:03:16] [DOC: 9259630] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:03:16] [DOC: 9259630] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:03:16] [DOC: 9259630] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:03:16] [DOC: 9259630] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:03:16] [DOC: 9259630] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:03:16] [DOC: 9259630] ✅ Patient data written to CSV: Donna Trott | Sex: FEMALE | Age: 82 | Service: Skilled Nursing | Payer:  | MRN: 3052261
[18:03:16] ✅    ✅ Document 9259630 processed and saved successfully
[18:03:16] 🔄 
🔄 Step 8: Saving API details...
[18:03:16] [DOC: 9259630] ℹ️  API push details saved for document 9259630
[18:03:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9259629                         ║
================================================================================
[18:03:16] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:03:16] ℹ️  Date: 04/24/2025
[18:03:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:03:18] [DOC: 9259629] ✅ Text extracted using pdfplumber (1577 chars)
[18:03:18] ✅    ✅ Text extracted using pdfplumber (1577 chars)
[18:03:18] 🔄 
🔄 Step 2: Extracting patient data...
[18:03:21] ℹ️  AI extracted raw sex value: 'M'
[18:03:21] ℹ️  AI extracted service line: 'RN'
[18:03:21] ℹ️  AI extracted payer source: ''
[18:03:21] ℹ️  AI extracted diagnoses:
[18:03:21] ℹ️    - Diagnosis 1: 'None'
[18:03:21] ℹ️    - Diagnosis 2: 'None'
[18:03:21] ℹ️    - Diagnosis 3: 'None'
[18:03:21] ℹ️    - Diagnosis 4: 'None'
[18:03:21] ℹ️    - Diagnosis 5: 'None'
[18:03:21] ℹ️    - Diagnosis 6: 'None'
[18:03:21] ℹ️  Final extracted MRN: '2998670'
[18:03:21] ℹ️  Final extracted Sex: 'MALE'
[18:03:21] ℹ️  Final extracted Service Line: 'RN'
[18:03:21] ℹ️  Final extracted Payer Source: ''
[18:03:21] ✅ Patient data extraction completed successfully
[18:03:21] ✅    ✅ Patient data extracted successfully
[18:03:21] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:03:21] ✅    ✅ Patient identified: Raymond Souza
[18:03:21] ✅    ✅ Patient name validation passed
[18:03:21] 🔄 
🔄 Step 3: Processing patient dates...
[18:03:21] [DOC: 9259629] ℹ️  DOB normalized: 06/18/1927
[18:03:21] [DOC: 9259629] ✅ Patient date processing completed successfully
[18:03:21] ✅    ✅ Date processing completed
[18:03:21] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[18:03:21] 🔄 
🔄 Step 4: Extracting order data...
[18:03:23] ℹ️  Order extraction - MRN: '2998670'
[18:03:23] ℹ️  Order extraction - Sex: 'MALE'
[18:03:23] ℹ️  Order extraction - Service Line: ''
[18:03:23] ℹ️  Order extraction - Payer Source: ''
[18:03:23] ✅ Order data extraction completed successfully
[18:03:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:03:23] ℹ️  Using MRN from patient data: '2998670' over '2998670'
[18:03:23] ℹ️  Using service line from patient data: 'RN'
[18:03:23] ✅ Patient name cross-validation successful
[18:03:23] ✅    ✅ Data merged successfully
[18:03:25] ✅    ✅ Order data extracted and validated
[18:03:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:03:25] [DOC: 9259629] ✅ Patient found in local cache: Raymond Souza, ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[18:03:25] ✅    ✅ Existing patient found with ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[18:03:25] 🔄 
🔄 Step 6: Pushing order to API...
[18:03:25] [DOC: 9259629] ℹ️  Pushing order via API for patient ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[18:03:26] [DOC: 9259629] ❌ Order push failed with status 201: {"id":"9d9cbcbe-bcbc-44b5-ac77-7b74afed9778","orderWAVId":"ORD19977","orderNo":"1084421, 1084764, 1084765","orderDate":"04/22/2025","startOfCare":"04/15/2025","episodeStartDate":"04/15/2025","episodeEndDate":"04/22/2025","documentID":"9259629","mrn":"2998670","patientName":"Souza,Raymond","sentToPhysicianDate":"04/24/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/28/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"da0edc07-3b5b-4691-8a9b-77caf22853f9","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[18:03:26] ❌    ❌ Failed to push order
[18:03:26] 🔄 
🔄 Step 7: Writing to CSV...
[18:03:26] [DOC: 9259629] ℹ️  Calculated age: 97 from DOB: 06/18/1927
[18:03:26] [DOC: 9259629] ℹ️  Service Line extracted: 'RN'
[18:03:26] [DOC: 9259629] ℹ️  Payer Source extracted: ''
[18:03:26] [DOC: 9259629] ℹ️  Diagnosis codes being written:
[18:03:26] [DOC: 9259629] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:03:26] [DOC: 9259629] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:03:26] [DOC: 9259629] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:03:26] [DOC: 9259629] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:03:26] [DOC: 9259629] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:03:26] [DOC: 9259629] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:03:26] [DOC: 9259629] ✅ Patient data written to CSV: Raymond Souza | Sex: MALE | Age: 97 | Service: RN | Payer:  | MRN: 2998670
[18:03:26] ✅    ✅ Document 9259629 processed and saved successfully
[18:03:26] 🔄 
🔄 Step 8: Saving API details...
[18:03:26] [DOC: 9259629] ℹ️  API push details saved for document 9259629
[18:03:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9259604                         ║
================================================================================
[18:03:26] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:03:26] ℹ️  Date: 04/24/2025
[18:03:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:03:28] [DOC: 9259604] ✅ Text extracted using pdfplumber (1695 chars)
[18:03:28] ✅    ✅ Text extracted using pdfplumber (1695 chars)
[18:03:28] 🔄 
🔄 Step 2: Extracting patient data...
[18:03:30] ℹ️  AI extracted raw sex value: 'M'
[18:03:30] ℹ️  AI extracted service line: 'RN'
[18:03:30] ℹ️  AI extracted payer source: ''
[18:03:30] ℹ️  AI extracted diagnoses:
[18:03:30] ℹ️    - Diagnosis 1: ''
[18:03:30] ℹ️    - Diagnosis 2: ''
[18:03:30] ℹ️    - Diagnosis 3: ''
[18:03:30] ℹ️    - Diagnosis 4: ''
[18:03:30] ℹ️    - Diagnosis 5: ''
[18:03:30] ℹ️    - Diagnosis 6: ''
[18:03:30] ℹ️  Final extracted MRN: '2944175'
[18:03:30] ℹ️  Final extracted Sex: 'MALE'
[18:03:30] ℹ️  Final extracted Service Line: 'RN'
[18:03:30] ℹ️  Final extracted Payer Source: ''
[18:03:30] ✅ Patient data extraction completed successfully
[18:03:30] ✅    ✅ Patient data extracted successfully
[18:03:30] 📊 Patient Response
     └─ patientFName: Ernest
     └─ patientLName: Santos
     └─ dob: 08/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2944175
     └─ billingProvider: Eric R. Levine, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:03:30] ✅    ✅ Patient identified: Ernest Santos
[18:03:30] ✅    ✅ Patient name validation passed
[18:03:30] 🔄 
🔄 Step 3: Processing patient dates...
[18:03:30] [DOC: 9259604] ℹ️  DOB normalized: 08/29/1944
[18:03:30] [DOC: 9259604] ✅ Patient date processing completed successfully
[18:03:30] ✅    ✅ Date processing completed
[18:03:30] 📊 Processed Patient Data
     └─ patientFName: Ernest
     └─ patientLName: Santos
     └─ dob: 08/29/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2944175
     └─ billingProvider: Eric R. Levine, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[18:03:30] 🔄 
🔄 Step 4: Extracting order data...
[18:03:33] ℹ️  Order extraction - MRN: '2944175'
[18:03:33] ℹ️  Order extraction - Sex: 'MALE'
[18:03:33] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:03:33] ℹ️  Order extraction - Payer Source: ''
[18:03:33] ✅ Order data extraction completed successfully
[18:03:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:03:33] ℹ️  Using MRN from patient data: '2944175' over '2944175'
[18:03:33] ℹ️  Combined service lines: Patient='RN' + Order='Skilled Nursing' = 'RN, Skilled Nursing'
[18:03:33] ✅ Patient name cross-validation successful
[18:03:33] ✅    ✅ Data merged successfully
[18:03:34] ✅    ✅ Order data extracted and validated
[18:03:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:03:43] [DOC: 9259604] ℹ️  Patient not found in cache or API: Ernest Santos
[18:03:43] [DOC: 9259604] ℹ️  Patient not found, creating new patient via API...
[18:03:43] [DOC: 9259604] ℹ️  Creating patient via API: Ernest Santos
[18:03:44] [DOC: 9259604] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:03:44] ❌    ❌ Failed to create patient
[18:03:44] [DOC: 9259604] ℹ️  API push details saved for document 9259604
================================================================================
║                        Processing Document ID: 9259600                         ║
================================================================================
[18:03:44] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:03:44] ℹ️  Date: 04/24/2025
[18:03:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:03:47] [DOC: 9259600] ✅ Text extracted using pdfplumber (12618 chars)
[18:03:47] ✅    ✅ Text extracted using pdfplumber (12618 chars)
[18:03:47] 🔄 
🔄 Step 2: Extracting patient data...
[18:03:50] ℹ️  AI extracted raw sex value: 'M'
[18:03:50] ℹ️  AI extracted service line: 'Skilled Nursing, Home Health Aide'
[18:03:50] ℹ️  AI extracted payer source: 'None'
[18:03:50] ℹ️  AI extracted diagnoses:
[18:03:50] ℹ️    - Diagnosis 1: 'N31.9'
[18:03:50] ℹ️    - Diagnosis 2: 'N40.1'
[18:03:50] ℹ️    - Diagnosis 3: 'R33.8'
[18:03:50] ℹ️    - Diagnosis 4: 'Z46.6'
[18:03:50] ℹ️    - Diagnosis 5: 'G35'
[18:03:50] ℹ️    - Diagnosis 6: 'I12.9'
[18:03:50] ℹ️  Final extracted MRN: '2063363'
[18:03:50] ℹ️  Final extracted Sex: 'MALE'
[18:03:50] ℹ️  Final extracted Service Line: 'Skilled Nursing, Home Health Aide'
[18:03:50] ℹ️  Final extracted Payer Source: ''
[18:03:50] ✅ Patient data extraction completed successfully
[18:03:50] ✅    ✅ Patient data extracted successfully
[18:03:50] 📊 Patient Response
     └─ patientFName: Rolando
     └─ patientLName: Rodriguez
     └─ dob: 07/06/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 2063363
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: None
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/29/2022', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '06/14/2025', 'firstDiagnosis': 'N31.9', 'secondDiagnosis': 'N40.1', 'thirdDiagnosis': 'R33.8', 'fourthDiagnosis': 'Z46.6', 'fifthDiagnosis': 'G35', 'sixthDiagnosis': 'I12.9'}]
[18:03:50] ✅    ✅ Patient identified: Rolando Rodriguez
[18:03:50] ✅    ✅ Patient name validation passed
[18:03:50] 🔄 
🔄 Step 3: Processing patient dates...
[18:03:50] [DOC: 9259600] ℹ️  DOB normalized: 07/06/1949
[18:03:50] [DOC: 9259600] ℹ️  Episode startOfCare normalized: 10/29/2022
[18:03:50] [DOC: 9259600] ℹ️  Episode startOfEpisode normalized: 04/16/2025
[18:03:50] [DOC: 9259600] ℹ️  Episode endOfEpisode normalized: 06/14/2025
[18:03:50] [DOC: 9259600] ✅ Patient date processing completed successfully
[18:03:50] ✅    ✅ Date processing completed
[18:03:50] 📊 Processed Patient Data
     └─ patientFName: Rolando
     └─ patientLName: Rodriguez
     └─ dob: 07/06/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 2063363
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '10/29/2022', 'startOfEpisode': '04/16/2025', 'endOfEpisode': '06/14/2025', 'firstDiagnosis': 'N31.9', 'secondDiagnosis': 'N40.1', 'thirdDiagnosis': 'R33.8', 'fourthDiagnosis': 'Z46.6', 'fifthDiagnosis': 'G35', 'sixthDiagnosis': 'I12.9'}]
[18:03:50] 🔄 
🔄 Step 4: Extracting order data...
[18:03:53] ℹ️  Order extraction - MRN: '2063363'
[18:03:53] ℹ️  Order extraction - Sex: 'MALE'
[18:03:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Home Health Aide'
[18:03:53] ℹ️  Order extraction - Payer Source: ''
[18:03:53] ✅ Order data extraction completed successfully
[18:03:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:03:53] ℹ️  Using MRN from patient data: '2063363' over '2063363'
[18:03:53] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Home Health Aide'
[18:03:53] ✅ Patient name cross-validation successful
[18:03:53] ✅    ✅ Data merged successfully
[18:03:54] ✅    ✅ Order data extracted and validated
[18:03:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:04:04] [DOC: 9259600] ℹ️  Patient not found in cache or API: Rolando Rodriguez
[18:04:04] [DOC: 9259600] ℹ️  Patient not found, creating new patient via API...
[18:04:04] [DOC: 9259600] ℹ️  Creating patient via API: Rolando Rodriguez
[18:04:05] [DOC: 9259600] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[18:04:05] ❌    ❌ Failed to create patient
[18:04:05] [DOC: 9259600] ℹ️  API push details saved for document 9259600
================================================================================
║                        Processing Document ID: 9259584                         ║
================================================================================
[18:04:05] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:04:05] ℹ️  Date: 04/24/2025
[18:04:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:04:08] [DOC: 9259584] ✅ Text extracted using pdfplumber (16577 chars)
[18:04:08] ✅    ✅ Text extracted using pdfplumber (16577 chars)
[18:04:08] 🔄 
🔄 Step 2: Extracting patient data...
[18:04:11] ℹ️  AI extracted raw sex value: 'F'
[18:04:11] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:04:11] ℹ️  AI extracted payer source: ''
[18:04:11] ℹ️  AI extracted diagnoses:
[18:04:11] ℹ️    - Diagnosis 1: 'I13.0'
[18:04:11] ℹ️    - Diagnosis 2: 'I50.31'
[18:04:11] ℹ️    - Diagnosis 3: 'I50.42'
[18:04:11] ℹ️    - Diagnosis 4: 'I48.91'
[18:04:11] ℹ️    - Diagnosis 5: 'I73.9'
[18:04:11] ℹ️    - Diagnosis 6: 'E61.1'
[18:04:11] ℹ️  Final extracted MRN: '2800368'
[18:04:11] ℹ️  Final extracted Sex: 'FEMALE'
[18:04:11] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:04:11] ℹ️  Final extracted Payer Source: ''
[18:04:11] ✅ Patient data extraction completed successfully
[18:04:11] ✅    ✅ Patient data extracted successfully
[18:04:11] 📊 Patient Response
     └─ patientFName: Roberta
     └─ patientLName: Oakley
     └─ dob: 09/26/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2800368
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '06/11/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.31', 'thirdDiagnosis': 'I50.42', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'I73.9', 'sixthDiagnosis': 'E61.1'}]
[18:04:11] ✅    ✅ Patient identified: Roberta Oakley
[18:04:11] ✅    ✅ Patient name validation passed
[18:04:11] 🔄 
🔄 Step 3: Processing patient dates...
[18:04:11] [DOC: 9259584] ℹ️  DOB normalized: 09/26/1927
[18:04:11] [DOC: 9259584] ℹ️  Episode startOfCare normalized: 04/12/2025
[18:04:11] [DOC: 9259584] ℹ️  Episode startOfEpisode normalized: 04/13/2025
[18:04:11] [DOC: 9259584] ℹ️  Episode endOfEpisode normalized: 06/11/2025
[18:04:11] [DOC: 9259584] ✅ Patient date processing completed successfully
[18:04:11] ✅    ✅ Date processing completed
[18:04:11] 📊 Processed Patient Data
     └─ patientFName: Roberta
     └─ patientLName: Oakley
     └─ dob: 09/26/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2800368
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '06/11/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.31', 'thirdDiagnosis': 'I50.42', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'I73.9', 'sixthDiagnosis': 'E61.1'}]
[18:04:11] 🔄 
🔄 Step 4: Extracting order data...
[18:04:14] ℹ️  Order extraction - MRN: '2800368'
[18:04:14] ℹ️  Order extraction - Sex: 'FEMALE'
[18:04:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[18:04:14] ℹ️  Order extraction - Payer Source: ''
[18:04:14] ✅ Order data extraction completed successfully
[18:04:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:04:14] ℹ️  Using MRN from patient data: '2800368' over '2800368'
[18:04:14] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[18:04:14] ✅ Patient name cross-validation successful
[18:04:14] ✅    ✅ Data merged successfully
[18:04:15] ✅    ✅ Order data extracted and validated
[18:04:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:04:21] [DOC: 9259584] ✅ Patient exists in API: Roberta Oakley, ID: bcf135df-3e2c-49b8-8b4f-2b67fb0f0e21
[18:04:21] ✅    ✅ Existing patient found with ID: bcf135df-3e2c-49b8-8b4f-2b67fb0f0e21
[18:04:21] 🔄 
🔄 Step 6: Pushing order to API...
[18:04:21] [DOC: 9259584] ℹ️  Pushing order via API for patient ID: bcf135df-3e2c-49b8-8b4f-2b67fb0f0e21
[18:04:22] [DOC: 9259584] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD19684"}
[18:04:22] ❌    ❌ Failed to push order
[18:04:22] 🔄 
🔄 Step 7: Writing to CSV...
[18:04:22] [DOC: 9259584] ℹ️  Calculated age: 97 from DOB: 09/26/1927
[18:04:22] [DOC: 9259584] ℹ️  Service Line extracted: 'Skilled Nursing'
[18:04:22] [DOC: 9259584] ℹ️  Payer Source extracted: ''
[18:04:22] [DOC: 9259584] ℹ️  Diagnosis codes being written:
[18:04:22] [DOC: 9259584] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[18:04:22] [DOC: 9259584] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.31'
[18:04:22] [DOC: 9259584] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.42'
[18:04:22] [DOC: 9259584] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I48.91'
[18:04:22] [DOC: 9259584] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I73.9'
[18:04:22] [DOC: 9259584] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E61.1'
[18:04:22] [DOC: 9259584] ✅ Patient data written to CSV: Roberta Oakley | Sex: FEMALE | Age: 97 | Service: Skilled Nursing | Payer:  | MRN: 2800368
[18:04:22] ✅    ✅ Document 9259584 processed and saved successfully
[18:04:22] 🔄 
🔄 Step 8: Saving API details...
[18:04:22] [DOC: 9259584] ℹ️  API push details saved for document 9259584
[18:04:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9259576                         ║
================================================================================
[18:04:22] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[18:04:22] ℹ️  Date: 04/24/2025
[18:04:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[18:04:23] [DOC: 9259576] ✅ Text extracted using pdfplumber (1117 chars)
[18:04:23] ✅    ✅ Text extracted using pdfplumber (1117 chars)
[18:04:23] 🔄 
🔄 Step 2: Extracting patient data...
[18:04:26] ℹ️  AI extracted raw sex value: 'F'
[18:04:26] ℹ️  AI extracted service line: 'Skilled Nursing'
[18:04:26] ℹ️  AI extracted payer source: ''
[18:04:26] ℹ️  AI extracted diagnoses:
[18:04:26] ℹ️    - Diagnosis 1: 'None'
[18:04:26] ℹ️    - Diagnosis 2: 'None'
[18:04:26] ℹ️    - Diagnosis 3: 'None'
[18:04:26] ℹ️    - Diagnosis 4: 'None'
[18:04:26] ℹ️    - Diagnosis 5: 'None'
[18:04:26] ℹ️    - Diagnosis 6: 'None'
[18:04:26] ℹ️  Final extracted MRN: '2790060'
[18:04:26] ℹ️  Final extracted Sex: 'FEMALE'
[18:04:26] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[18:04:26] ℹ️  Final extracted Payer Source: ''
[18:04:26] ✅ Patient data extraction completed successfully
[18:04:26] ✅    ✅ Patient data extracted successfully
[18:04:26] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Nicholson
     └─ dob: 09/21/1926
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2790060
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/22/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[18:04:26] ✅    ✅ Patient identified: Barbara Nicholson
[18:04:26] ✅    ✅ Patient name validation passed
[18:04:26] 🔄 
🔄 Step 3: Processing patient dates...
[18:04:26] [DOC: 9259576] ℹ️  DOB normalized: 09/21/1926
[18:04:26] [DOC: 9259576] ℹ️  Episode startOfEpisode normalized: 04/22/2025
[18:04:26] [DOC: 9259576] ✅ Patient date processing completed successfully
[18:04:26] ✅    ✅ Date processing completed
[18:04:26] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Nicholson
     └─ dob: 09/21/1926
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2790060
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/22/2025'}]
[18:04:26] 🔄 
🔄 Step 4: Extracting order data...
[18:04:28] ℹ️  Order extraction - MRN: '2790060'
[18:04:28] ℹ️  Order extraction - Sex: 'FEMALE'
[18:04:28] ℹ️  Order extraction - Service Line: 'SN'
[18:04:28] ℹ️  Order extraction - Payer Source: ''
[18:04:28] ✅ Order data extraction completed successfully
[18:04:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[18:04:28] ℹ️  Using MRN from patient data: '2790060' over '2790060'
[18:04:28] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[18:04:28] ✅ Patient name cross-validation successful
[18:04:28] ✅    ✅ Data merged successfully
[18:04:30] ✅    ✅ Order data extracted and validated
[18:04:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[18:04:37] [DOC: 9259576] ✅ Patient exists in API: Barbara Nicholson, ID: b5656471-cab3-4be5-a25c-bebb43a87639
[18:04:37] ✅    ✅ Existing patient found with ID: b5656471-cab3-4be5-a25c-bebb43a87639
[18:04:37] 🔄 
🔄 Step 6: Pushing order to API...
[18:04:37] [DOC: 9259576] ℹ️  Pushing order via API for patient ID: b5656471-cab3-4be5-a25c-bebb43a87639
[18:04:38] [DOC: 9259576] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13373"}
[18:04:38] ❌    ❌ Failed to push order
[18:04:38] 🔄 
🔄 Step 7: Writing to CSV...
[18:04:38] [DOC: 9259576] ℹ️  Calculated age: 98 from DOB: 09/21/1926
[18:04:38] [DOC: 9259576] ℹ️  Service Line extracted: 'SN, Skilled Nursing'
[18:04:38] [DOC: 9259576] ℹ️  Payer Source extracted: ''
[18:04:38] [DOC: 9259576] ℹ️  Diagnosis codes being written:
[18:04:38] [DOC: 9259576] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[18:04:38] [DOC: 9259576] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[18:04:38] [DOC: 9259576] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[18:04:38] [DOC: 9259576] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[18:04:38] [DOC: 9259576] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[18:04:38] [DOC: 9259576] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[18:04:38] [DOC: 9259576] ✅ Patient data written to CSV: Barbara Nicholson | Sex: FEMALE | Age: 98 | Service: SN, Skilled Nursing | Payer:  | MRN: 2790060
[18:04:38] ✅    ✅ Document 9259576 processed and saved successfully
[18:04:38] 🔄 
🔄 Step 8: Saving API details...
[18:04:38] [DOC: 9259576] ℹ️  API push details saved for document 9259576
[18:04:38] ✅    ✅ API details saved
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[18:04:38] ℹ️  Total Processed: 49
[18:04:38] ℹ️  CSV Success: 27
[18:04:38] ℹ️  CSV Errors: 9
[18:04:38] ℹ️  API Success: 0
[18:04:38] ℹ️  API Errors: 40
[18:04:38] ℹ️  CSV Success Rate: 55.1%
[18:04:38] ℹ️  API Success Rate: 0.0%
[18:04:38] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250607_175241.csv
[18:04:38] ℹ️  API Details File: api_outputs/api_push_details_20250607_175241.csv
================================================================================
║          ============================================================          ║
================================================================================
