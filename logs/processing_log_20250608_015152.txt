================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[01:51:52] ℹ️  CSV Data Extraction & API Push Tool
[01:51:52] ℹ️  
[01:51:52] ℹ️  Features:
[01:51:52] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[01:51:52] ℹ️  - AI-powered patient and order data extraction
[01:51:52] ℹ️  - Enhanced error handling and logging
[01:51:52] ℹ️  - Full API integration (patient creation + order pushing)
[01:51:52] ℹ️  - CSV output with comprehensive patient data
[01:51:52] ℹ️  - Detailed API tracking with remarks for every document
[01:51:52] ℹ️  - Complete audit trail of all processing attempts
[01:51:52] ℹ️  
[01:51:52] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[01:51:52] ✅ Created output CSV file: csv_outputs/extracted_patients_20250608_015152.csv
[01:51:52] ✅ Created API details CSV file: api_outputs/api_push_details_20250608_015152.csv
================================================================================
║                        Processing Document ID: 9254292                         ║
================================================================================
[01:51:52] ℹ️  Agency: All At Home Health Care-Allston
[01:51:52] ℹ️  Date: 04/22/2025
[01:51:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[01:51:57] [DOC: 9254292] ✅ Text extracted using pdfplumber (22746 chars)
[01:51:57] ✅    ✅ Text extracted using pdfplumber (22674 chars)
[01:51:57] 🔄 
🔄 Step 2: Extracting patient data...
[01:52:02] ℹ️  AI extracted raw sex value: 'F'
[01:52:02] ℹ️  AI extracted service line: 'RN, PT, HHA'
[01:52:02] ℹ️  AI extracted payer source: ''
[01:52:02] ℹ️  AI extracted diagnoses:
[01:52:02] ℹ️    - Diagnosis 1: 'G93.89'
[01:52:02] ℹ️    - Diagnosis 2: 'I10'
[01:52:02] ℹ️    - Diagnosis 3: 'F33.9'
[01:52:02] ℹ️    - Diagnosis 4: 'E03.9'
[01:52:02] ℹ️    - Diagnosis 5: 'H40.9'
[01:52:02] ℹ️    - Diagnosis 6: ''
[01:52:02] ℹ️  Final extracted MRN: '1823'
[01:52:02] ℹ️  Final extracted Sex: 'FEMALE'
[01:52:02] ℹ️  Final extracted Service Line: 'RN, PT, HHA'
[01:52:02] ℹ️  Final extracted Payer Source: ''
[01:52:02] ✅ Patient data extraction completed successfully
[01:52:02] ✅    ✅ Patient data extracted successfully
[01:52:02] 📊 Patient Response
     └─ patientFName: Agnes
     └─ patientLName: Loggins
     └─ dob: 02/03/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1823
     └─ billingProvider: All At Home Health Care
     └─ npi: 1720386378
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: All At Home Health Care
     └─ address: 9 Northfield Pl
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (508) 990-7675
     └─ serviceLine: RN, PT, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'G93.89', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F33.9', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': 'H40.9', 'sixthDiagnosis': ''}]
[01:52:02] ✅    ✅ Patient identified: Agnes Loggins
[01:52:02] ✅    ✅ Patient name validation passed
[01:52:02] 🔄 
🔄 Step 3: Processing patient dates...
[01:52:02] [DOC: 9254292] ℹ️  DOB normalized: 02/03/1935
[01:52:02] [DOC: 9254292] ℹ️  Episode startOfCare normalized: 04/11/2025
[01:52:02] [DOC: 9254292] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[01:52:02] [DOC: 9254292] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[01:52:02] [DOC: 9254292] ✅ Patient date processing completed successfully
[01:52:02] ✅    ✅ Date processing completed
[01:52:02] 📊 Processed Patient Data
     └─ patientFName: Agnes
     └─ patientLName: Loggins
     └─ dob: 02/03/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1823
     └─ billingProvider: All At Home Health Care
     └─ npi: 1720386378
     └─ physicianNPI: 1679560791
     └─ nameOfAgency: All At Home Health Care
     └─ address: 9 Northfield Pl
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (508) 990-7675
     └─ serviceLine: RN, PT, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'G93.89', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F33.9', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': 'H40.9', 'sixthDiagnosis': ''}]
[01:52:02] 🔄 
🔄 Step 4: Extracting order data...
[01:52:05] ℹ️  Order extraction - MRN: '1823'
[01:52:05] ℹ️  Order extraction - Sex: 'FEMALE'
[01:52:05] ℹ️  Order extraction - Service Line: 'RN, PT, HHA'
[01:52:05] ℹ️  Order extraction - Payer Source: ''
[01:52:05] ✅ Order data extraction completed successfully
[01:52:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[01:52:05] ℹ️  Using MRN from patient data: '1823' over '1823'
[01:52:05] ℹ️  Service line consistent in both sources: 'RN, PT, HHA'
[01:52:05] ✅ Patient name cross-validation successful
[01:52:05] ✅    ✅ Data merged successfully
[01:52:06] ✅    ✅ Order data extracted and validated
[01:52:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[01:53:38] [DOC: 9254292] ℹ️  Patient not found in cache or API: Agnes Loggins
[01:53:38] [DOC: 9254292] ℹ️  Patient not found, creating new patient via API...
[01:53:38] [DOC: 9254292] ℹ️  Creating patient via API: Agnes Loggins
[01:53:40] [DOC: 9254292] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[01:53:40] ❌    ❌ Failed to create patient
[01:53:40] [DOC: 9254292] ℹ️  API push details saved for document 9254292
================================================================================
║                        Processing Document ID: 9254161                         ║
================================================================================
[01:53:40] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[01:53:40] ℹ️  Date: 04/22/2025
[01:53:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[01:53:43] [DOC: 9254161] ✅ Text extracted using pdfplumber (1399 chars)
[01:53:43] ✅    ✅ Text extracted using pdfplumber (1387 chars)
[01:53:43] 🔄 
🔄 Step 2: Extracting patient data...
[01:53:46] ℹ️  AI extracted raw sex value: ''
[01:53:46] ℹ️  AI extracted service line: 'Physical Therapy'
[01:53:46] ℹ️  AI extracted payer source: ''
[01:53:46] ℹ️  AI extracted diagnoses:
[01:53:46] ℹ️    - Diagnosis 1: 'I10'
[01:53:46] ℹ️    - Diagnosis 2: 'I50.30'
[01:53:46] ℹ️    - Diagnosis 3: 'E11.22'
[01:53:46] ℹ️    - Diagnosis 4: ''
[01:53:46] ℹ️    - Diagnosis 5: ''
[01:53:46] ℹ️    - Diagnosis 6: ''
[01:53:46] ℹ️  Final extracted MRN: 'MA250328034304'
[01:53:46] ℹ️  Final extracted Sex: ''
[01:53:46] ℹ️  Final extracted Service Line: 'Physical Therapy'
[01:53:46] ℹ️  Final extracted Payer Source: ''
[01:53:46] ✅ Patient data extraction completed successfully
[01:53:46] ✅    ✅ Patient data extracted successfully
[01:53:46] 📊 Patient Response
     └─ patientFName: Frederick
     └─ patientLName: Turner
     └─ dob: 03/05/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA250328034304
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I50.30', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[01:53:46] ✅    ✅ Patient identified: Frederick Turner
[01:53:46] ✅    ✅ Patient name validation passed
[01:53:46] 🔄 
🔄 Step 3: Processing patient dates...
[01:53:46] [DOC: 9254161] ℹ️  DOB normalized: 03/05/1943
[01:53:46] [DOC: 9254161] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[01:53:46] [DOC: 9254161] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[01:53:46] [DOC: 9254161] ✅ Patient date processing completed successfully
[01:53:46] ✅    ✅ Date processing completed
[01:53:46] 📊 Processed Patient Data
     └─ patientFName: Frederick
     └─ patientLName: Turner
     └─ dob: 03/05/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA250328034304
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I50.30', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[01:53:46] 🔄 
🔄 Step 4: Extracting order data...
[01:53:48] ℹ️  Order extraction - MRN: 'MA250328034304'
[01:53:48] ℹ️  Order extraction - Sex: ''
[01:53:48] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[01:53:48] ℹ️  Order extraction - Payer Source: ''
[01:53:48] ✅ Order data extraction completed successfully
[01:53:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[01:53:48] ℹ️  Using MRN from patient data: 'MA250328034304' over 'MA250328034304'
[01:53:48] ⚠️  Could not determine sex using any available method
[01:53:48] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[01:53:48] ✅ Patient name cross-validation successful
[01:53:48] ✅    ✅ Data merged successfully
[01:53:50] ✅    ✅ Order data extracted and validated
[01:53:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[01:53:50] [DOC: 9254161] ✅ Patient found in local cache: Frederick Turner, ID: fda2b6f0-d47f-42d2-9704-28476b119573
[01:53:50] ✅    ✅ Existing patient found with ID: fda2b6f0-d47f-42d2-9704-28476b119573
[01:53:50] 🔄 
🔄 Step 6: Pushing order to API...
[01:53:50] [DOC: 9254161] ℹ️  Pushing order via API for patient ID: fda2b6f0-d47f-42d2-9704-28476b119573
[01:53:51] [DOC: 9254161] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14248"}
[01:53:51] ❌    ❌ Failed to push order
[01:53:51] 🔄 
🔄 Step 7: Writing to CSV...
[01:53:51] [DOC: 9254161] ℹ️  Calculated age: 82 from DOB: 03/05/1943
[01:53:51] [DOC: 9254161] ℹ️  Service Line extracted: 'Physical Therapy'
[01:53:51] [DOC: 9254161] ℹ️  Payer Source extracted: ''
[01:53:51] [DOC: 9254161] ℹ️  Diagnosis codes being written:
[01:53:51] [DOC: 9254161] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[01:53:51] [DOC: 9254161] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.30'
[01:53:51] [DOC: 9254161] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[01:53:51] [DOC: 9254161] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[01:53:51] [DOC: 9254161] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[01:53:51] [DOC: 9254161] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[01:53:51] [DOC: 9254161] ✅ Patient data written to CSV: Frederick Turner | Sex:  | Age: 82 | Service: Physical Therapy | Payer:  | MRN: MA250328034304
[01:53:51] ✅    ✅ Document 9254161 processed and saved successfully
[01:53:51] 🔄 
🔄 Step 8: Saving API details...
[01:53:51] [DOC: 9254161] ℹ️  API push details saved for document 9254161
[01:53:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9254156                         ║
================================================================================
[01:53:51] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[01:53:51] ℹ️  Date: 04/22/2025
[01:53:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[01:53:56] [DOC: 9254156] ✅ Text extracted using pdfplumber (1412 chars)
[01:53:56] ✅    ✅ Text extracted using pdfplumber (1412 chars)
[01:53:56] 🔄 
🔄 Step 2: Extracting patient data...
[01:54:00] ℹ️  AI extracted raw sex value: ''
[01:54:00] ℹ️  AI extracted service line: 'Physical Therapy'
[01:54:00] ℹ️  AI extracted payer source: ''
[01:54:00] ℹ️  AI extracted diagnoses:
[01:54:00] ℹ️    - Diagnosis 1: 'G11.8'
[01:54:00] ℹ️    - Diagnosis 2: 'M62.81'
[01:54:00] ℹ️    - Diagnosis 3: 'M81.0'
[01:54:00] ℹ️    - Diagnosis 4: 'None'
[01:54:00] ℹ️    - Diagnosis 5: 'None'
[01:54:00] ℹ️    - Diagnosis 6: 'None'
[01:54:00] ℹ️  Final extracted MRN: 'MA221209055605'
[01:54:00] ℹ️  Final extracted Sex: ''
[01:54:00] ℹ️  Final extracted Service Line: 'Physical Therapy'
[01:54:00] ℹ️  Final extracted Payer Source: ''
[01:54:00] ✅ Patient data extraction completed successfully
[01:54:00] ✅    ✅ Patient data extracted successfully
[01:54:00] 📊 Patient Response
     └─ patientFName: Connie
     └─ patientLName: Sousa
     └─ dob: 05/23/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221209055605
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'G11.8', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'M81.0', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[01:54:00] ✅    ✅ Patient identified: Connie Sousa
[01:54:00] ✅    ✅ Patient name validation passed
[01:54:00] 🔄 
🔄 Step 3: Processing patient dates...
[01:54:00] [DOC: 9254156] ℹ️  DOB normalized: 05/23/1956
[01:54:00] [DOC: 9254156] ℹ️  Episode startOfEpisode normalized: 04/15/2025
[01:54:00] [DOC: 9254156] ℹ️  Episode endOfEpisode normalized: 06/13/2025
[01:54:00] [DOC: 9254156] ✅ Patient date processing completed successfully
[01:54:00] ✅    ✅ Date processing completed
[01:54:00] 📊 Processed Patient Data
     └─ patientFName: Connie
     └─ patientLName: Sousa
     └─ dob: 05/23/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221209055605
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'G11.8', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'M81.0'}]
[01:54:00] 🔄 
🔄 Step 4: Extracting order data...
[01:54:02] ℹ️  Order extraction - MRN: 'MA221209055605'
[01:54:02] ℹ️  Order extraction - Sex: ''
[01:54:02] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[01:54:02] ℹ️  Order extraction - Payer Source: ''
[01:54:02] ✅ Order data extraction completed successfully
[01:54:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[01:54:02] ℹ️  Using MRN from patient data: 'MA221209055605' over 'MA221209055605'
[01:54:02] ⚠️  Could not determine sex using any available method
[01:54:02] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[01:54:02] ✅ Patient name cross-validation successful
[01:54:02] ✅    ✅ Data merged successfully
[01:54:03] ✅    ✅ Order data extracted and validated
[01:54:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[01:55:27] [DOC: 9254156] ℹ️  Patient not found in cache or API: Connie Sousa
[01:55:27] [DOC: 9254156] ℹ️  Patient not found, creating new patient via API...
[01:55:27] [DOC: 9254156] ℹ️  Creating patient via API: Connie Sousa
[01:55:29] [DOC: 9254156] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[01:55:29] ❌    ❌ Failed to create patient
[01:55:29] [DOC: 9254156] ℹ️  API push details saved for document 9254156
================================================================================
║                        Processing Document ID: 9254150                         ║
================================================================================
[01:55:29] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[01:55:29] ℹ️  Date: 04/22/2025
[01:55:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[01:55:31] [DOC: 9254150] ✅ Text extracted using pdfplumber (1407 chars)
[01:55:31] ✅    ✅ Text extracted using pdfplumber (1407 chars)
[01:55:31] 🔄 
🔄 Step 2: Extracting patient data...
[01:55:34] ℹ️  AI extracted raw sex value: ''
[01:55:34] ℹ️  AI extracted service line: 'Occupational Therapy'
[01:55:34] ℹ️  AI extracted payer source: ''
[01:55:34] ℹ️  AI extracted diagnoses:
[01:55:34] ℹ️    - Diagnosis 1: 'G11.8'
[01:55:34] ℹ️    - Diagnosis 2: 'M62.81'
[01:55:34] ℹ️    - Diagnosis 3: 'M81.0'
[01:55:34] ℹ️    - Diagnosis 4: 'None'
[01:55:34] ℹ️    - Diagnosis 5: 'None'
[01:55:34] ℹ️    - Diagnosis 6: 'None'
[01:55:34] ℹ️  Final extracted MRN: 'MA221209055605'
[01:55:34] ℹ️  Final extracted Sex: ''
[01:55:34] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[01:55:34] ℹ️  Final extracted Payer Source: ''
[01:55:34] ✅ Patient data extraction completed successfully
[01:55:34] ✅    ✅ Patient data extracted successfully
[01:55:34] 📊 Patient Response
     └─ patientFName: Connie
     └─ patientLName: Sousa
     └─ dob: 05/23/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221209055605
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'G11.8', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'M81.0', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[01:55:34] ✅    ✅ Patient identified: Connie Sousa
[01:55:34] ✅    ✅ Patient name validation passed
[01:55:34] 🔄 
🔄 Step 3: Processing patient dates...
[01:55:34] [DOC: 9254150] ℹ️  DOB normalized: 05/23/1956
[01:55:34] [DOC: 9254150] ℹ️  Episode startOfEpisode normalized: 04/15/2025
[01:55:34] [DOC: 9254150] ℹ️  Episode endOfEpisode normalized: 06/13/2025
[01:55:34] [DOC: 9254150] ✅ Patient date processing completed successfully
[01:55:34] ✅    ✅ Date processing completed
[01:55:34] 📊 Processed Patient Data
     └─ patientFName: Connie
     └─ patientLName: Sousa
     └─ dob: 05/23/1956
     └─ patientSex: 
     └─ medicalRecordNo: MA221209055605
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'G11.8', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'M81.0'}]
[01:55:34] 🔄 
🔄 Step 4: Extracting order data...
[01:55:36] ℹ️  Order extraction - MRN: 'MA221209055605'
[01:55:36] ℹ️  Order extraction - Sex: ''
[01:55:36] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[01:55:36] ℹ️  Order extraction - Payer Source: ''
[01:55:36] ✅ Order data extraction completed successfully
[01:55:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[01:55:36] ℹ️  Using MRN from patient data: 'MA221209055605' over 'MA221209055605'
[01:55:36] ⚠️  Could not determine sex using any available method
[01:55:36] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[01:55:36] ✅ Patient name cross-validation successful
[01:55:36] ✅    ✅ Data merged successfully
[01:55:37] ✅    ✅ Order data extracted and validated
[01:55:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[01:56:58] [DOC: 9254150] ℹ️  Patient not found in cache or API: Connie Sousa
[01:56:58] [DOC: 9254150] ℹ️  Patient not found, creating new patient via API...
[01:56:58] [DOC: 9254150] ℹ️  Creating patient via API: Connie Sousa
[01:57:00] [DOC: 9254150] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[01:57:00] ❌    ❌ Failed to create patient
[01:57:00] [DOC: 9254150] ℹ️  API push details saved for document 9254150
================================================================================
║                        Processing Document ID: 9254070                         ║
================================================================================
[01:57:00] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[01:57:00] ℹ️  Date: 04/22/2025
[01:57:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[01:57:01] [DOC: 9254070] ✅ Text extracted using pdfplumber (1179 chars)
[01:57:01] ✅    ✅ Text extracted using pdfplumber (1179 chars)
[01:57:01] 🔄 
🔄 Step 2: Extracting patient data...
[01:57:04] ℹ️  AI extracted raw sex value: 'F'
[01:57:04] ℹ️  AI extracted service line: 'Skilled Nursing'
[01:57:04] ℹ️  AI extracted payer source: ''
[01:57:04] ℹ️  AI extracted diagnoses:
[01:57:04] ℹ️    - Diagnosis 1: 'None'
[01:57:04] ℹ️    - Diagnosis 2: 'None'
[01:57:04] ℹ️    - Diagnosis 3: 'None'
[01:57:04] ℹ️    - Diagnosis 4: 'None'
[01:57:04] ℹ️    - Diagnosis 5: 'None'
[01:57:04] ℹ️    - Diagnosis 6: 'None'
[01:57:04] ℹ️  Final extracted MRN: '2121459'
[01:57:04] ℹ️  Final extracted Sex: 'FEMALE'
[01:57:04] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[01:57:04] ℹ️  Final extracted Payer Source: ''
[01:57:04] ✅ Patient data extraction completed successfully
[01:57:04] ✅    ✅ Patient data extracted successfully
[01:57:04] 📊 Patient Response
     └─ patientFName: Anita
     └─ patientLName: Rodrigues
     └─ dob: 09/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2121459
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/09/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[01:57:04] ✅    ✅ Patient identified: Anita Rodrigues
[01:57:04] ✅    ✅ Patient name validation passed
[01:57:04] 🔄 
🔄 Step 3: Processing patient dates...
[01:57:04] [DOC: 9254070] ℹ️  DOB normalized: 09/12/1942
[01:57:04] [DOC: 9254070] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[01:57:04] [DOC: 9254070] ✅ Patient date processing completed successfully
[01:57:04] ✅    ✅ Date processing completed
[01:57:04] 📊 Processed Patient Data
     └─ patientFName: Anita
     └─ patientLName: Rodrigues
     └─ dob: 09/12/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2121459
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/09/2025'}]
[01:57:04] 🔄 
🔄 Step 4: Extracting order data...
[01:57:06] ℹ️  Order extraction - MRN: '2121459'
[01:57:06] ℹ️  Order extraction - Sex: 'FEMALE'
[01:57:06] ℹ️  Order extraction - Service Line: 'SN'
[01:57:06] ℹ️  Order extraction - Payer Source: ''
[01:57:06] ✅ Order data extraction completed successfully
[01:57:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[01:57:06] ℹ️  Using MRN from patient data: '2121459' over '2121459'
[01:57:06] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[01:57:06] ✅ Patient name cross-validation successful
[01:57:06] ✅    ✅ Data merged successfully
[01:57:07] ✅    ✅ Order data extracted and validated
[01:57:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[01:57:36] [DOC: 9254070] ℹ️  Patient not found in cache or API: Anita Rodrigues
[01:57:36] [DOC: 9254070] ℹ️  Patient not found, creating new patient via API...
[01:57:36] [DOC: 9254070] ℹ️  Creating patient via API: Anita Rodrigues
[01:57:37] [DOC: 9254070] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[01:57:37] ❌    ❌ Failed to create patient
[01:57:37] [DOC: 9254070] ℹ️  API push details saved for document 9254070
================================================================================
║                        Processing Document ID: 9254058                         ║
================================================================================
[01:57:37] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[01:57:37] ℹ️  Date: 04/22/2025
[01:57:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[01:57:39] [DOC: 9254058] ✅ Text extracted using pdfplumber (1237 chars)
[01:57:39] ✅    ✅ Text extracted using pdfplumber (1237 chars)
[01:57:39] 🔄 
🔄 Step 2: Extracting patient data...
[01:57:42] ℹ️  AI extracted raw sex value: 'F'
[01:57:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[01:57:42] ℹ️  AI extracted payer source: ''
[01:57:42] ℹ️  AI extracted diagnoses:
[01:57:42] ℹ️    - Diagnosis 1: 'None'
[01:57:42] ℹ️    - Diagnosis 2: 'None'
[01:57:42] ℹ️    - Diagnosis 3: 'None'
[01:57:42] ℹ️    - Diagnosis 4: 'None'
[01:57:42] ℹ️    - Diagnosis 5: 'None'
[01:57:42] ℹ️    - Diagnosis 6: 'None'
[01:57:42] ℹ️  Final extracted MRN: '2687695'
[01:57:42] ℹ️  Final extracted Sex: 'FEMALE'
[01:57:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[01:57:42] ℹ️  Final extracted Payer Source: ''
[01:57:42] ✅ Patient data extraction completed successfully
[01:57:42] ✅    ✅ Patient data extracted successfully
[01:57:42] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Maiato
     └─ dob: 03/29/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2687695
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[01:57:42] ✅    ✅ Patient identified: Maria Maiato
[01:57:42] ✅    ✅ Patient name validation passed
[01:57:42] 🔄 
🔄 Step 3: Processing patient dates...
[01:57:42] [DOC: 9254058] ℹ️  DOB normalized: 03/29/1952
[01:57:42] [DOC: 9254058] ✅ Patient date processing completed successfully
[01:57:42] ✅    ✅ Date processing completed
[01:57:42] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Maiato
     └─ dob: 03/29/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2687695
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[01:57:42] 🔄 
🔄 Step 4: Extracting order data...
[01:57:44] ℹ️  Order extraction - MRN: '2687695'
[01:57:44] ℹ️  Order extraction - Sex: 'FEMALE'
[01:57:44] ℹ️  Order extraction - Service Line: 'SN'
[01:57:44] ℹ️  Order extraction - Payer Source: ''
[01:57:44] ✅ Order data extraction completed successfully
[01:57:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[01:57:44] ℹ️  Using MRN from patient data: '2687695' over '2687695'
[01:57:44] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[01:57:44] ✅ Patient name cross-validation successful
[01:57:44] ✅    ✅ Data merged successfully
[01:57:45] ✅    ✅ Order data extracted and validated
[01:57:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[01:57:45] [DOC: 9254058] ✅ Patient found in local cache: Maria Maiato, ID: a92d350b-6287-4f07-a2c9-09b4c329691a
[01:57:45] ✅    ✅ Existing patient found with ID: a92d350b-6287-4f07-a2c9-09b4c329691a
[01:57:45] 🔄 
🔄 Step 6: Pushing order to API...
[01:57:45] [DOC: 9254058] ℹ️  Pushing order via API for patient ID: a92d350b-6287-4f07-a2c9-09b4c329691a
[01:57:46] [DOC: 9254058] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13325"}
[01:57:46] ❌    ❌ Failed to push order
[01:57:46] 🔄 
🔄 Step 7: Writing to CSV...
[01:57:46] [DOC: 9254058] ℹ️  Calculated age: 73 from DOB: 03/29/1952
[01:57:46] [DOC: 9254058] ℹ️  Service Line extracted: 'SN, Skilled Nursing'
[01:57:46] [DOC: 9254058] ℹ️  Payer Source extracted: ''
[01:57:46] [DOC: 9254058] ℹ️  Diagnosis codes being written:
[01:57:46] [DOC: 9254058] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[01:57:46] [DOC: 9254058] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[01:57:46] [DOC: 9254058] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[01:57:46] [DOC: 9254058] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[01:57:46] [DOC: 9254058] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[01:57:46] [DOC: 9254058] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[01:57:46] [DOC: 9254058] ✅ Patient data written to CSV: Maria Maiato | Sex: FEMALE | Age: 73 | Service: SN, Skilled Nursing | Payer:  | MRN: 2687695
[01:57:46] ✅    ✅ Document 9254058 processed and saved successfully
[01:57:46] 🔄 
🔄 Step 8: Saving API details...
[01:57:46] [DOC: 9254058] ℹ️  API push details saved for document 9254058
[01:57:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9254056                         ║
================================================================================
[01:57:46] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[01:57:46] ℹ️  Date: 04/22/2025
[01:57:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[01:57:49] [DOC: 9254056] ✅ Text extracted using pdfplumber (965 chars)
[01:57:49] ✅    ✅ Text extracted using pdfplumber (965 chars)
[01:57:49] 🔄 
🔄 Step 2: Extracting patient data...
[01:57:51] ℹ️  AI extracted raw sex value: 'M'
[01:57:51] ℹ️  AI extracted service line: 'Nursing'
[01:57:51] ℹ️  AI extracted payer source: ''
[01:57:51] ℹ️  AI extracted diagnoses:
[01:57:51] ℹ️    - Diagnosis 1: ''
[01:57:51] ℹ️    - Diagnosis 2: ''
[01:57:51] ℹ️    - Diagnosis 3: ''
[01:57:51] ℹ️    - Diagnosis 4: ''
[01:57:51] ℹ️    - Diagnosis 5: ''
[01:57:51] ℹ️    - Diagnosis 6: ''
[01:57:51] ℹ️  Final extracted MRN: '2679776'
[01:57:51] ℹ️  Final extracted Sex: 'MALE'
[01:57:51] ℹ️  Final extracted Service Line: 'Nursing'
[01:57:51] ℹ️  Final extracted Payer Source: ''
[01:57:51] ✅ Patient data extraction completed successfully
[01:57:51] ✅    ✅ Patient data extracted successfully
[01:57:51] 📊 Patient Response
     └─ patientFName: Milton
     └─ patientLName: MacDonald
     └─ dob: 03/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 2679776
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[01:57:51] ✅    ✅ Patient identified: Milton MacDonald
[01:57:51] ✅    ✅ Patient name validation passed
[01:57:51] 🔄 
🔄 Step 3: Processing patient dates...
[01:57:51] [DOC: 9254056] ℹ️  DOB normalized: 03/20/1939
[01:57:51] [DOC: 9254056] ✅ Patient date processing completed successfully
[01:57:51] ✅    ✅ Date processing completed
[01:57:51] 📊 Processed Patient Data
     └─ patientFName: Milton
     └─ patientLName: MacDonald
     └─ dob: 03/20/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 2679776
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[01:57:51] 🔄 
🔄 Step 4: Extracting order data...
[01:57:53] ℹ️  Order extraction - MRN: '2679776'
[01:57:53] ℹ️  Order extraction - Sex: 'MALE'
[01:57:53] ℹ️  Order extraction - Service Line: ''
[01:57:53] ℹ️  Order extraction - Payer Source: ''
[01:57:53] ✅ Order data extraction completed successfully
[01:57:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[01:57:53] ℹ️  Using MRN from patient data: '2679776' over '2679776'
[01:57:53] ℹ️  Using service line from patient data: 'Nursing'
[01:57:53] ✅ Patient name cross-validation successful
[01:57:53] ✅    ✅ Data merged successfully
[01:57:54] ⚠️     ❌ Skipping - missing episode start date
[01:57:54] [DOC: 9254056] ℹ️  API push details saved for document 9254056
================================================================================
║                        Processing Document ID: 9254055                         ║
================================================================================
[01:57:54] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[01:57:54] ℹ️  Date: 04/22/2025
[01:57:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[01:57:55] [DOC: 9254055] ✅ Text extracted using pdfplumber (903 chars)
[01:57:55] ✅    ✅ Text extracted using pdfplumber (903 chars)
[01:57:55] 🔄 
🔄 Step 2: Extracting patient data...
[01:57:58] ℹ️  AI extracted raw sex value: 'F'
[01:57:58] ℹ️  AI extracted service line: 'Physical Therapy'
[01:57:58] ℹ️  AI extracted payer source: ''
[01:57:58] ℹ️  AI extracted diagnoses:
[01:57:58] ℹ️    - Diagnosis 1: ''
[01:57:58] ℹ️    - Diagnosis 2: ''
[01:57:58] ℹ️    - Diagnosis 3: ''
[01:57:58] ℹ️    - Diagnosis 4: ''
[01:57:58] ℹ️    - Diagnosis 5: ''
[01:57:58] ℹ️    - Diagnosis 6: ''
[01:57:58] ℹ️  Final extracted MRN: '2645822'
[01:57:58] ℹ️  Final extracted Sex: 'FEMALE'
[01:57:58] ℹ️  Final extracted Service Line: 'Physical Therapy'
[01:57:58] ℹ️  Final extracted Payer Source: ''
[01:57:58] ✅ Patient data extraction completed successfully
[01:57:58] ✅    ✅ Patient data extracted successfully
[01:57:58] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Leal
     └─ dob: 06/30/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2645822
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[01:57:58] ✅    ✅ Patient identified: Maria Leal
[01:57:58] ✅    ✅ Patient name validation passed
[01:57:58] 🔄 
🔄 Step 3: Processing patient dates...
[01:57:58] [DOC: 9254055] ℹ️  DOB normalized: 06/30/1940
[01:57:58] [DOC: 9254055] ✅ Patient date processing completed successfully
[01:57:58] ✅    ✅ Date processing completed
[01:57:58] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Leal
     └─ dob: 06/30/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2645822
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[01:57:58] 🔄 
🔄 Step 4: Extracting order data...
[01:58:00] ℹ️  Order extraction - MRN: '2645822'
[01:58:00] ℹ️  Order extraction - Sex: 'FEMALE'
[01:58:00] ℹ️  Order extraction - Service Line: ''
[01:58:00] ℹ️  Order extraction - Payer Source: ''
[01:58:00] ✅ Order data extraction completed successfully
[01:58:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[01:58:00] ℹ️  Using MRN from patient data: '2645822' over '2645822'
[01:58:00] ℹ️  Using service line from patient data: 'Physical Therapy'
[01:58:00] ✅ Patient name cross-validation successful
[01:58:00] ✅    ✅ Data merged successfully
[01:58:01] ⚠️     ❌ Skipping - missing episode start date
[01:58:01] [DOC: 9254055] ℹ️  API push details saved for document 9254055
================================================================================
║                        Processing Document ID: 9254049                         ║
================================================================================
[01:58:01] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[01:58:01] ℹ️  Date: 04/22/2025
[01:58:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[01:58:03] [DOC: 9254049] ✅ Text extracted using pdfplumber (1325 chars)
[01:58:03] ✅    ✅ Text extracted using pdfplumber (1325 chars)
[01:58:03] 🔄 
🔄 Step 2: Extracting patient data...
[01:58:05] ℹ️  AI extracted raw sex value: 'M'
[01:58:05] ℹ️  AI extracted service line: 'Skilled Nursing'
[01:58:05] ℹ️  AI extracted payer source: ''
[01:58:05] ℹ️  AI extracted diagnoses:
[01:58:05] ℹ️    - Diagnosis 1: 'None'
[01:58:05] ℹ️    - Diagnosis 2: 'None'
[01:58:05] ℹ️    - Diagnosis 3: 'None'
[01:58:05] ℹ️    - Diagnosis 4: 'None'
[01:58:05] ℹ️    - Diagnosis 5: 'None'
[01:58:05] ℹ️    - Diagnosis 6: 'None'
[01:58:05] ℹ️  Final extracted MRN: '2611249'
[01:58:05] ℹ️  Final extracted Sex: 'MALE'
[01:58:05] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[01:58:05] ℹ️  Final extracted Payer Source: ''
[01:58:05] ✅ Patient data extraction completed successfully
[01:58:05] ✅    ✅ Patient data extracted successfully
[01:58:05] 📊 Patient Response
     └─ patientFName: Sobhy
     └─ patientLName: Kelada
     └─ dob: 10/02/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2611249
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[01:58:05] ✅    ✅ Patient identified: Sobhy Kelada
[01:58:05] ✅    ✅ Patient name validation passed
[01:58:05] 🔄 
🔄 Step 3: Processing patient dates...
[01:58:05] [DOC: 9254049] ℹ️  DOB normalized: 10/02/1947
[01:58:05] [DOC: 9254049] ✅ Patient date processing completed successfully
[01:58:05] ✅    ✅ Date processing completed
[01:58:05] 📊 Processed Patient Data
     └─ patientFName: Sobhy
     └─ patientLName: Kelada
     └─ dob: 10/02/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2611249
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[01:58:05] 🔄 
🔄 Step 4: Extracting order data...
[01:58:08] ℹ️  Order extraction - MRN: '2611249'
[01:58:08] ℹ️  Order extraction - Sex: 'MALE'
[01:58:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[01:58:08] ℹ️  Order extraction - Payer Source: ''
[01:58:08] ✅ Order data extraction completed successfully
[01:58:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[01:58:08] ℹ️  Using MRN from patient data: '2611249' over '2611249'
[01:58:08] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[01:58:08] ✅ Patient name cross-validation successful
[01:58:08] ✅    ✅ Data merged successfully
[01:58:09] ✅    ✅ Order data extracted and validated
[01:58:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[01:59:40] [DOC: 9254049] ℹ️  Patient not found in cache or API: Sobhy Kelada
[01:59:40] [DOC: 9254049] ℹ️  Patient not found, creating new patient via API...
[01:59:40] [DOC: 9254049] ℹ️  Creating patient via API: Sobhy Kelada
[01:59:42] [DOC: 9254049] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[01:59:42] ❌    ❌ Failed to create patient
[01:59:42] [DOC: 9254049] ℹ️  API push details saved for document 9254049
================================================================================
║                        Processing Document ID: 9254044                         ║
================================================================================
[01:59:42] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[01:59:42] ℹ️  Date: 04/22/2025
[01:59:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[01:59:44] [DOC: 9254044] ✅ Text extracted using pdfplumber (14208 chars)
[01:59:44] ✅    ✅ Text extracted using pdfplumber (14208 chars)
[01:59:44] 🔄 
🔄 Step 2: Extracting patient data...
[01:59:48] ℹ️  AI extracted raw sex value: 'F'
[01:59:48] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[01:59:48] ℹ️  AI extracted payer source: ''
[01:59:48] ℹ️  AI extracted diagnoses:
[01:59:48] ℹ️    - Diagnosis 1: 'S82.842D'
[01:59:48] ℹ️    - Diagnosis 2: 'J45.50'
[01:59:48] ℹ️    - Diagnosis 3: 'E78.00'
[01:59:48] ℹ️    - Diagnosis 4: 'H04.129'
[01:59:48] ℹ️    - Diagnosis 5: 'Z79.83'
[01:59:48] ℹ️    - Diagnosis 6: 'Z79.82'
[01:59:48] ℹ️  Final extracted MRN: '2516647'
[01:59:48] ℹ️  Final extracted Sex: 'FEMALE'
[01:59:48] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[01:59:48] ℹ️  Final extracted Payer Source: ''
[01:59:48] ✅ Patient data extraction completed successfully
[01:59:48] ✅    ✅ Patient data extracted successfully
[01:59:48] 📊 Patient Response
     └─ patientFName: Linda
     └─ patientLName: Girouard
     └─ dob: 11/02/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2516647
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'S82.842D', 'secondDiagnosis': 'J45.50', 'thirdDiagnosis': 'E78.00', 'fourthDiagnosis': 'H04.129', 'fifthDiagnosis': 'Z79.83', 'sixthDiagnosis': 'Z79.82'}]
[01:59:48] ✅    ✅ Patient identified: Linda Girouard
[01:59:48] ✅    ✅ Patient name validation passed
[01:59:48] 🔄 
🔄 Step 3: Processing patient dates...
[01:59:48] [DOC: 9254044] ℹ️  DOB normalized: 11/02/1960
[01:59:48] [DOC: 9254044] ℹ️  Episode startOfCare normalized: 04/12/2025
[01:59:48] [DOC: 9254044] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[01:59:48] [DOC: 9254044] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[01:59:48] [DOC: 9254044] ✅ Patient date processing completed successfully
[01:59:48] ✅    ✅ Date processing completed
[01:59:48] 📊 Processed Patient Data
     └─ patientFName: Linda
     └─ patientLName: Girouard
     └─ dob: 11/02/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2516647
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'S82.842D', 'secondDiagnosis': 'J45.50', 'thirdDiagnosis': 'E78.00', 'fourthDiagnosis': 'H04.129', 'fifthDiagnosis': 'Z79.83', 'sixthDiagnosis': 'Z79.82'}]
[01:59:48] 🔄 
🔄 Step 4: Extracting order data...
[01:59:51] ℹ️  Order extraction - MRN: '2516647'
[01:59:51] ℹ️  Order extraction - Sex: 'FEMALE'
[01:59:51] ℹ️  Order extraction - Service Line: 'PT, OT'
[01:59:51] ℹ️  Order extraction - Payer Source: ''
[01:59:51] ✅ Order data extraction completed successfully
[01:59:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[01:59:51] ℹ️  Using MRN from patient data: '2516647' over '2516647'
[01:59:51] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy' + Order='PT, OT' = 'OT, Occupational Therapy, PT, Physical Therapy'
[01:59:51] ✅ Patient name cross-validation successful
[01:59:51] ✅    ✅ Data merged successfully
[01:59:52] ✅    ✅ Order data extracted and validated
[01:59:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:01:01] [DOC: 9254044] ℹ️  Patient not found in cache or API: Linda Girouard
[02:01:01] [DOC: 9254044] ℹ️  Patient not found, creating new patient via API...
[02:01:01] [DOC: 9254044] ℹ️  Creating patient via API: Linda Girouard
[02:01:03] [DOC: 9254044] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:01:03] ❌    ❌ Failed to create patient
[02:01:03] [DOC: 9254044] ℹ️  API push details saved for document 9254044
================================================================================
║                        Processing Document ID: 9254005                         ║
================================================================================
[02:01:03] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[02:01:03] ℹ️  Date: 04/22/2025
[02:01:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:01:06] [DOC: 9254005] ✅ Text extracted using pdfplumber (1291 chars)
[02:01:06] ✅    ✅ Text extracted using pdfplumber (1291 chars)
[02:01:06] 🔄 
🔄 Step 2: Extracting patient data...
[02:01:09] ℹ️  AI extracted raw sex value: 'F'
[02:01:09] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:01:09] ℹ️  AI extracted payer source: ''
[02:01:09] ℹ️  AI extracted diagnoses:
[02:01:09] ℹ️    - Diagnosis 1: ''
[02:01:09] ℹ️    - Diagnosis 2: ''
[02:01:09] ℹ️    - Diagnosis 3: ''
[02:01:09] ℹ️    - Diagnosis 4: ''
[02:01:09] ℹ️    - Diagnosis 5: ''
[02:01:09] ℹ️    - Diagnosis 6: ''
[02:01:09] ℹ️  Final extracted MRN: '2429372'
[02:01:09] ℹ️  Final extracted Sex: 'FEMALE'
[02:01:09] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:01:09] ℹ️  Final extracted Payer Source: ''
[02:01:09] ✅ Patient data extraction completed successfully
[02:01:09] ✅    ✅ Patient data extracted successfully
[02:01:09] 📊 Patient Response
     └─ patientFName: Beverly
     └─ patientLName: Drew
     └─ dob: 01/19/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2429372
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:01:09] ✅    ✅ Patient identified: Beverly Drew
[02:01:09] ✅    ✅ Patient name validation passed
[02:01:09] 🔄 
🔄 Step 3: Processing patient dates...
[02:01:09] [DOC: 9254005] ℹ️  DOB normalized: 01/19/1940
[02:01:09] [DOC: 9254005] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[02:01:09] [DOC: 9254005] ✅ Patient date processing completed successfully
[02:01:09] ✅    ✅ Date processing completed
[02:01:09] 📊 Processed Patient Data
     └─ patientFName: Beverly
     └─ patientLName: Drew
     └─ dob: 01/19/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2429372
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:01:09] 🔄 
🔄 Step 4: Extracting order data...
[02:01:11] ℹ️  Order extraction - MRN: '2429372'
[02:01:11] ℹ️  Order extraction - Sex: 'FEMALE'
[02:01:11] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:01:11] ℹ️  Order extraction - Payer Source: ''
[02:01:11] ✅ Order data extraction completed successfully
[02:01:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:01:11] ℹ️  Using MRN from patient data: '2429372' over '2429372'
[02:01:11] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:01:11] ✅ Patient name cross-validation successful
[02:01:11] ✅    ✅ Data merged successfully
[02:01:12] ✅    ✅ Order data extracted and validated
[02:01:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:01:46] [DOC: 9254005] ✅ Patient exists in API: Beverly Drew, ID: d1c71297-63ea-499d-837c-953f02e301eb
[02:01:46] ✅    ✅ Existing patient found with ID: d1c71297-63ea-499d-837c-953f02e301eb
[02:01:46] 🔄 
🔄 Step 6: Pushing order to API...
[02:01:46] [DOC: 9254005] ℹ️  Pushing order via API for patient ID: d1c71297-63ea-499d-837c-953f02e301eb
[02:01:48] [DOC: 9254005] ❌ Order push failed with status 201: {"id":"67e7a0ef-6a57-41a1-a376-2c97a7dc123c","orderWAVId":"ORD20006","orderNo":"1083811","orderDate":"04/05/2025","startOfCare":"04/05/2025","episodeStartDate":"04/05/2025","episodeEndDate":"06/03/2025","documentID":"9254005","mrn":"2429372","patientName":"Drew,Beverly A","sentToPhysicianDate":"04/22/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/28/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"d1c71297-63ea-499d-837c-953f02e301eb","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[02:01:48] ❌    ❌ Failed to push order
[02:01:48] 🔄 
🔄 Step 7: Writing to CSV...
[02:01:48] [DOC: 9254005] ℹ️  Calculated age: 85 from DOB: 01/19/1940
[02:01:48] [DOC: 9254005] ℹ️  Service Line extracted: 'Skilled Nursing'
[02:01:48] [DOC: 9254005] ℹ️  Payer Source extracted: ''
[02:01:48] [DOC: 9254005] ℹ️  Diagnosis codes being written:
[02:01:48] [DOC: 9254005] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:01:48] [DOC: 9254005] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:01:48] [DOC: 9254005] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:01:48] [DOC: 9254005] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:01:48] [DOC: 9254005] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:01:48] [DOC: 9254005] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:01:48] [DOC: 9254005] ✅ Patient data written to CSV: Beverly Drew | Sex: FEMALE | Age: 85 | Service: Skilled Nursing | Payer:  | MRN: 2429372
[02:01:48] ✅    ✅ Document 9254005 processed and saved successfully
[02:01:48] 🔄 
🔄 Step 8: Saving API details...
[02:01:48] [DOC: 9254005] ℹ️  API push details saved for document 9254005
[02:01:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9253990                         ║
================================================================================
[02:01:48] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[02:01:48] ℹ️  Date: 04/22/2025
[02:01:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:01:49] [DOC: 9253990] ✅ Text extracted using pdfplumber (2357 chars)
[02:01:49] ✅    ✅ Text extracted using pdfplumber (2357 chars)
[02:01:49] 🔄 
🔄 Step 2: Extracting patient data...
[02:01:52] ℹ️  AI extracted raw sex value: 'F'
[02:01:52] ℹ️  AI extracted service line: 'PT'
[02:01:52] ℹ️  AI extracted payer source: ''
[02:01:52] ℹ️  AI extracted diagnoses:
[02:01:52] ℹ️    - Diagnosis 1: ''
[02:01:52] ℹ️    - Diagnosis 2: ''
[02:01:52] ℹ️    - Diagnosis 3: ''
[02:01:52] ℹ️    - Diagnosis 4: ''
[02:01:52] ℹ️    - Diagnosis 5: ''
[02:01:52] ℹ️    - Diagnosis 6: ''
[02:01:52] ℹ️  Final extracted MRN: '2188842'
[02:01:52] ℹ️  Final extracted Sex: 'FEMALE'
[02:01:52] ℹ️  Final extracted Service Line: 'PT'
[02:01:52] ℹ️  Final extracted Payer Source: ''
[02:01:52] ✅ Patient data extraction completed successfully
[02:01:52] ✅    ✅ Patient data extracted successfully
[02:01:52] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Anderson
     └─ dob: 07/12/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2188842
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:01:52] ✅    ✅ Patient identified: Nancy Anderson
[02:01:52] ✅    ✅ Patient name validation passed
[02:01:52] 🔄 
🔄 Step 3: Processing patient dates...
[02:01:52] [DOC: 9253990] ℹ️  DOB normalized: 07/12/1954
[02:01:52] [DOC: 9253990] ✅ Patient date processing completed successfully
[02:01:52] ✅    ✅ Date processing completed
[02:01:52] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Anderson
     └─ dob: 07/12/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2188842
     └─ billingProvider: Karmina Elma P. Bautista, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:01:52] 🔄 
🔄 Step 4: Extracting order data...
[02:01:55] ℹ️  Order extraction - MRN: '2188842'
[02:01:55] ℹ️  Order extraction - Sex: 'FEMALE'
[02:01:55] ℹ️  Order extraction - Service Line: 'PT'
[02:01:55] ℹ️  Order extraction - Payer Source: ''
[02:01:55] ✅ Order data extraction completed successfully
[02:01:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:01:55] ℹ️  Using MRN from patient data: '2188842' over '2188842'
[02:01:55] ℹ️  Service line consistent in both sources: 'PT'
[02:01:55] ✅ Patient name cross-validation successful
[02:01:55] ✅    ✅ Data merged successfully
[02:01:56] ✅    ✅ Order data extracted and validated
[02:01:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:03:29] [DOC: 9253990] ℹ️  Patient not found in cache or API: Nancy Anderson
[02:03:29] [DOC: 9253990] ℹ️  Patient not found, creating new patient via API...
[02:03:29] [DOC: 9253990] ℹ️  Creating patient via API: Nancy Anderson
[02:03:30] [DOC: 9253990] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:03:30] ❌    ❌ Failed to create patient
[02:03:30] [DOC: 9253990] ℹ️  API push details saved for document 9253990
================================================================================
║                        Processing Document ID: 9253980                         ║
================================================================================
[02:03:30] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[02:03:30] ℹ️  Date: 04/22/2025
[02:03:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:03:33] [DOC: 9253980] ✅ Text extracted using pdfplumber (11659 chars)
[02:03:33] ✅    ✅ Text extracted using pdfplumber (11659 chars)
[02:03:33] 🔄 
🔄 Step 2: Extracting patient data...
[02:03:36] ℹ️  AI extracted raw sex value: 'M'
[02:03:36] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:03:36] ℹ️  AI extracted payer source: ''
[02:03:36] ℹ️  AI extracted diagnoses:
[02:03:36] ℹ️    - Diagnosis 1: 'N40.1'
[02:03:36] ℹ️    - Diagnosis 2: 'R33.8'
[02:03:36] ℹ️    - Diagnosis 3: 'Z46.6'
[02:03:36] ℹ️    - Diagnosis 4: 'I10'
[02:03:36] ℹ️    - Diagnosis 5: 'E11.9'
[02:03:36] ℹ️    - Diagnosis 6: 'M72.0'
[02:03:36] ℹ️  Final extracted MRN: '2170342'
[02:03:36] ℹ️  Final extracted Sex: 'MALE'
[02:03:36] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:03:36] ℹ️  Final extracted Payer Source: ''
[02:03:36] ✅ Patient data extraction completed successfully
[02:03:36] ✅    ✅ Patient data extracted successfully
[02:03:36] 📊 Patient Response
     └─ patientFName: Joao
     └─ patientLName: Aguiar
     └─ dob: 08/11/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 2170342
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'N40.1', 'secondDiagnosis': 'R33.8', 'thirdDiagnosis': 'Z46.6', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'M72.0'}]
[02:03:36] ✅    ✅ Patient identified: Joao Aguiar
[02:03:36] ✅    ✅ Patient name validation passed
[02:03:36] 🔄 
🔄 Step 3: Processing patient dates...
[02:03:36] [DOC: 9253980] ℹ️  DOB normalized: 08/11/1954
[02:03:36] [DOC: 9253980] ℹ️  Episode startOfCare normalized: 04/08/2025
[02:03:36] [DOC: 9253980] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[02:03:36] [DOC: 9253980] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[02:03:36] [DOC: 9253980] ✅ Patient date processing completed successfully
[02:03:36] ✅    ✅ Date processing completed
[02:03:36] 📊 Processed Patient Data
     └─ patientFName: Joao
     └─ patientLName: Aguiar
     └─ dob: 08/11/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 2170342
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'N40.1', 'secondDiagnosis': 'R33.8', 'thirdDiagnosis': 'Z46.6', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'E11.9', 'sixthDiagnosis': 'M72.0'}]
[02:03:36] 🔄 
🔄 Step 4: Extracting order data...
[02:03:39] ℹ️  Order extraction - MRN: '2170342'
[02:03:39] ℹ️  Order extraction - Sex: 'MALE'
[02:03:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:03:39] ℹ️  Order extraction - Payer Source: ''
[02:03:39] ✅ Order data extraction completed successfully
[02:03:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:03:39] ℹ️  Using MRN from patient data: '2170342' over '2170342'
[02:03:39] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:03:39] ✅ Patient name cross-validation successful
[02:03:39] ✅    ✅ Data merged successfully
[02:03:40] ✅    ✅ Order data extracted and validated
[02:03:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:03:40] [DOC: 9253980] ✅ Patient found in local cache: Joao Aguiar, ID: f41aab89-225a-480a-9b25-f9b0069dd743
[02:03:40] ✅    ✅ Existing patient found with ID: f41aab89-225a-480a-9b25-f9b0069dd743
[02:03:40] 🔄 
🔄 Step 6: Pushing order to API...
[02:03:40] [DOC: 9253980] ℹ️  Pushing order via API for patient ID: f41aab89-225a-480a-9b25-f9b0069dd743
[02:03:42] [DOC: 9253980] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13475"}
[02:03:42] ❌    ❌ Failed to push order
[02:03:42] 🔄 
🔄 Step 7: Writing to CSV...
[02:03:42] [DOC: 9253980] ℹ️  Calculated age: 70 from DOB: 08/11/1954
[02:03:42] [DOC: 9253980] ℹ️  Service Line extracted: 'Skilled Nursing'
[02:03:42] [DOC: 9253980] ℹ️  Payer Source extracted: ''
[02:03:42] [DOC: 9253980] ℹ️  Diagnosis codes being written:
[02:03:42] [DOC: 9253980] ℹ️    - Latest_Episode_Firstdiagnosis: 'N40.1'
[02:03:42] [DOC: 9253980] ℹ️    - Latest_Episode_Seconddiagnosis: 'R33.8'
[02:03:42] [DOC: 9253980] ℹ️    - Latest_Episode_Thirddiagnosis: 'Z46.6'
[02:03:42] [DOC: 9253980] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[02:03:42] [DOC: 9253980] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.9'
[02:03:42] [DOC: 9253980] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M72.0'
[02:03:42] [DOC: 9253980] ✅ Patient data written to CSV: Joao Aguiar | Sex: MALE | Age: 70 | Service: Skilled Nursing | Payer:  | MRN: 2170342
[02:03:42] ✅    ✅ Document 9253980 processed and saved successfully
[02:03:42] 🔄 
🔄 Step 8: Saving API details...
[02:03:42] [DOC: 9253980] ℹ️  API push details saved for document 9253980
[02:03:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9253213                         ║
================================================================================
[02:03:42] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:03:42] ℹ️  Date: 04/22/2025
[02:03:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:03:48] [DOC: 9253213] ✅ Text extracted using pdfplumber (1427 chars)
[02:03:48] ✅    ✅ Text extracted using pdfplumber (1427 chars)
[02:03:48] 🔄 
🔄 Step 2: Extracting patient data...
[02:03:51] ℹ️  AI extracted raw sex value: ''
[02:03:51] ℹ️  AI extracted service line: 'Nursing'
[02:03:51] ℹ️  AI extracted payer source: ''
[02:03:51] ℹ️  AI extracted diagnoses:
[02:03:51] ℹ️    - Diagnosis 1: 'E11.40'
[02:03:51] ℹ️    - Diagnosis 2: 'R55'
[02:03:51] ℹ️    - Diagnosis 3: 'M62.81'
[02:03:51] ℹ️    - Diagnosis 4: ''
[02:03:51] ℹ️    - Diagnosis 5: ''
[02:03:51] ℹ️    - Diagnosis 6: ''
[02:03:51] ℹ️  Final extracted MRN: '100991175'
[02:03:51] ℹ️  Final extracted Sex: ''
[02:03:51] ℹ️  Final extracted Service Line: 'Nursing'
[02:03:51] ℹ️  Final extracted Payer Source: ''
[02:03:51] ✅ Patient data extraction completed successfully
[02:03:51] ✅    ✅ Patient data extracted successfully
[02:03:51] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Aguiar
     └─ dob: 09/05/1946
     └─ patientSex: 
     └─ medicalRecordNo: 100991175
     └─ billingProvider: EHAB SORIAL MD
     └─ npi: 1083608442
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'E11.40', 'secondDiagnosis': 'R55', 'thirdDiagnosis': 'M62.81', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:03:51] ✅    ✅ Patient identified: Maria Aguiar
[02:03:51] ✅    ✅ Patient name validation passed
[02:03:51] 🔄 
🔄 Step 3: Processing patient dates...
[02:03:51] [DOC: 9253213] ℹ️  DOB normalized: 09/05/1946
[02:03:51] [DOC: 9253213] ℹ️  Episode startOfEpisode normalized: 02/17/2025
[02:03:51] [DOC: 9253213] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[02:03:51] [DOC: 9253213] ✅ Patient date processing completed successfully
[02:03:51] ✅    ✅ Date processing completed
[02:03:51] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Aguiar
     └─ dob: 09/05/1946
     └─ patientSex: 
     └─ medicalRecordNo: 100991175
     └─ billingProvider: EHAB SORIAL MD
     └─ npi: 1083608442
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'E11.40', 'secondDiagnosis': 'R55', 'thirdDiagnosis': 'M62.81', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:03:51] 🔄 
🔄 Step 4: Extracting order data...
[02:03:55] ℹ️  Order extraction - MRN: '100991175'
[02:03:55] ℹ️  Order extraction - Sex: ''
[02:03:55] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:03:55] ℹ️  Order extraction - Payer Source: ''
[02:03:55] ✅ Order data extraction completed successfully
[02:03:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:03:55] ℹ️  Using MRN from patient data: '100991175' over '100991175'
[02:03:55] ℹ️  Inferred sex as FEMALE from name: Maria
[02:03:55] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[02:03:55] ✅ Patient name cross-validation successful
[02:03:55] ✅    ✅ Data merged successfully
[02:03:56] ✅    ✅ Order data extracted and validated
[02:03:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:05:42] [DOC: 9253213] ✅ Patient exists in API: Maria Aguiar, ID: b9965767-0ab4-478e-ae42-6485c2df49c5
[02:05:42] ✅    ✅ Existing patient found with ID: b9965767-0ab4-478e-ae42-6485c2df49c5
[02:05:42] 🔄 
🔄 Step 6: Pushing order to API...
[02:05:42] [DOC: 9253213] ℹ️  Pushing order via API for patient ID: b9965767-0ab4-478e-ae42-6485c2df49c5
[02:05:43] [DOC: 9253213] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14082"}
[02:05:43] ❌    ❌ Failed to push order
[02:05:43] 🔄 
🔄 Step 7: Writing to CSV...
[02:05:43] [DOC: 9253213] ℹ️  Calculated age: 78 from DOB: 09/05/1946
[02:05:43] [DOC: 9253213] ℹ️  Service Line extracted: 'Nursing, Skilled Nursing'
[02:05:43] [DOC: 9253213] ℹ️  Payer Source extracted: ''
[02:05:43] [DOC: 9253213] ℹ️  Diagnosis codes being written:
[02:05:43] [DOC: 9253213] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.40'
[02:05:43] [DOC: 9253213] ℹ️    - Latest_Episode_Seconddiagnosis: 'R55'
[02:05:43] [DOC: 9253213] ℹ️    - Latest_Episode_Thirddiagnosis: 'M62.81'
[02:05:43] [DOC: 9253213] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:05:43] [DOC: 9253213] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:05:43] [DOC: 9253213] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:05:43] [DOC: 9253213] ✅ Patient data written to CSV: Maria Aguiar | Sex: FEMALE | Age: 78 | Service: Nursing, Skilled Nursing | Payer:  | MRN: 100991175
[02:05:43] ✅    ✅ Document 9253213 processed and saved successfully
[02:05:43] 🔄 
🔄 Step 8: Saving API details...
[02:05:43] [DOC: 9253213] ℹ️  API push details saved for document 9253213
[02:05:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9253210                         ║
================================================================================
[02:05:43] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:05:43] ℹ️  Date: 04/22/2025
[02:05:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:05:45] [DOC: 9253210] ✅ Text extracted using pdfplumber (1276 chars)
[02:05:45] ✅    ✅ Text extracted using pdfplumber (1264 chars)
[02:05:45] 🔄 
🔄 Step 2: Extracting patient data...
[02:05:48] ℹ️  AI extracted raw sex value: ''
[02:05:48] ℹ️  AI extracted service line: 'Nursing'
[02:05:48] ℹ️  AI extracted payer source: ''
[02:05:48] ℹ️  AI extracted diagnoses:
[02:05:48] ℹ️    - Diagnosis 1: 'J10.00'
[02:05:48] ℹ️    - Diagnosis 2: 'J10.1'
[02:05:48] ℹ️    - Diagnosis 3: 'J20.8'
[02:05:48] ℹ️    - Diagnosis 4: ''
[02:05:48] ℹ️    - Diagnosis 5: ''
[02:05:48] ℹ️    - Diagnosis 6: ''
[02:05:48] ℹ️  Final extracted MRN: 'MA210420124503'
[02:05:48] ℹ️  Final extracted Sex: ''
[02:05:48] ℹ️  Final extracted Service Line: 'Nursing'
[02:05:48] ℹ️  Final extracted Payer Source: ''
[02:05:48] ✅ Patient data extraction completed successfully
[02:05:48] ✅    ✅ Patient data extracted successfully
[02:05:48] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Saude
     └─ dob: 12/03/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA210420124503
     └─ billingProvider: DEBBY ALMEIDA MD
     └─ npi: 1134289127
     └─ physicianNPI: 1134289127
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'J10.1', 'thirdDiagnosis': 'J20.8', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:05:48] ✅    ✅ Patient identified: Maria Saude
[02:05:48] ✅    ✅ Patient name validation passed
[02:05:48] 🔄 
🔄 Step 3: Processing patient dates...
[02:05:48] [DOC: 9253210] ℹ️  DOB normalized: 12/03/1945
[02:05:48] [DOC: 9253210] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[02:05:48] [DOC: 9253210] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[02:05:48] [DOC: 9253210] ✅ Patient date processing completed successfully
[02:05:48] ✅    ✅ Date processing completed
[02:05:48] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Saude
     └─ dob: 12/03/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA210420124503
     └─ billingProvider: DEBBY ALMEIDA MD
     └─ npi: 1134289127
     └─ physicianNPI: 1134289127
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'J10.1', 'thirdDiagnosis': 'J20.8', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:05:48] 🔄 
🔄 Step 4: Extracting order data...
[02:05:51] ℹ️  Order extraction - MRN: 'MA210420124503'
[02:05:51] ℹ️  Order extraction - Sex: ''
[02:05:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:05:51] ℹ️  Order extraction - Payer Source: ''
[02:05:51] ✅ Order data extraction completed successfully
[02:05:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:05:51] ℹ️  Using MRN from patient data: 'MA210420124503' over 'MA210420124503'
[02:05:51] ℹ️  Inferred sex as FEMALE from name: Maria
[02:05:51] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[02:05:51] ✅ Patient name cross-validation successful
[02:05:51] ✅    ✅ Data merged successfully
[02:05:52] ✅    ✅ Order data extracted and validated
[02:05:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:06:18] [DOC: 9253210] ✅ Patient exists in API: Maria Saude, ID: cac5a300-1fae-4dab-aa9c-e9c386640a8d
[02:06:18] ✅    ✅ Existing patient found with ID: cac5a300-1fae-4dab-aa9c-e9c386640a8d
[02:06:18] 🔄 
🔄 Step 6: Pushing order to API...
[02:06:18] [DOC: 9253210] ℹ️  Pushing order via API for patient ID: cac5a300-1fae-4dab-aa9c-e9c386640a8d
[02:06:19] [DOC: 9253210] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14083"}
[02:06:19] ❌    ❌ Failed to push order
[02:06:19] 🔄 
🔄 Step 7: Writing to CSV...
[02:06:19] [DOC: 9253210] ℹ️  Calculated age: 79 from DOB: 12/03/1945
[02:06:19] [DOC: 9253210] ℹ️  Service Line extracted: 'Nursing, Skilled Nursing'
[02:06:19] [DOC: 9253210] ℹ️  Payer Source extracted: ''
[02:06:19] [DOC: 9253210] ℹ️  Diagnosis codes being written:
[02:06:19] [DOC: 9253210] ℹ️    - Latest_Episode_Firstdiagnosis: 'J10.00'
[02:06:19] [DOC: 9253210] ℹ️    - Latest_Episode_Seconddiagnosis: 'J10.1'
[02:06:19] [DOC: 9253210] ℹ️    - Latest_Episode_Thirddiagnosis: 'J20.8'
[02:06:19] [DOC: 9253210] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:06:19] [DOC: 9253210] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:06:19] [DOC: 9253210] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:06:19] [DOC: 9253210] ✅ Patient data written to CSV: Maria Saude | Sex: FEMALE | Age: 79 | Service: Nursing, Skilled Nursing | Payer:  | MRN: MA210420124503
[02:06:19] ✅    ✅ Document 9253210 processed and saved successfully
[02:06:19] 🔄 
🔄 Step 8: Saving API details...
[02:06:19] [DOC: 9253210] ℹ️  API push details saved for document 9253210
[02:06:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9253164                         ║
================================================================================
[02:06:19] ℹ️  Agency: Dartmouth HH
[02:06:19] ℹ️  Date: 04/22/2025
[02:06:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:06:21] [DOC: 9253164] ✅ Text extracted using pdfplumber (1041 chars)
[02:06:21] ✅    ✅ Text extracted using pdfplumber (1041 chars)
[02:06:21] 🔄 
🔄 Step 2: Extracting patient data...
[02:06:24] ℹ️  AI extracted raw sex value: 'M'
[02:06:24] ℹ️  AI extracted service line: 'Speech Therapy'
[02:06:24] ℹ️  AI extracted payer source: 'Medicare'
[02:06:24] ℹ️  AI extracted diagnoses:
[02:06:24] ℹ️    - Diagnosis 1: 'None'
[02:06:24] ℹ️    - Diagnosis 2: 'None'
[02:06:24] ℹ️    - Diagnosis 3: 'None'
[02:06:24] ℹ️    - Diagnosis 4: 'None'
[02:06:24] ℹ️    - Diagnosis 5: 'None'
[02:06:24] ℹ️    - Diagnosis 6: 'None'
[02:06:24] ℹ️  Final extracted MRN: '2194001'
[02:06:24] ℹ️  Final extracted Sex: 'MALE'
[02:06:24] ℹ️  Final extracted Service Line: 'Speech Therapy'
[02:06:24] ℹ️  Final extracted Payer Source: 'Medicare'
[02:06:24] ✅ Patient data extraction completed successfully
[02:06:24] ✅    ✅ Patient data extracted successfully
[02:06:24] 📊 Patient Response
     └─ patientFName: Dennis
     └─ patientLName: Desnoyers
     └─ dob: 06/09/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 2194001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Speech Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:06:24] ✅    ✅ Patient identified: Dennis Desnoyers
[02:06:24] ✅    ✅ Patient name validation passed
[02:06:24] 🔄 
🔄 Step 3: Processing patient dates...
[02:06:24] [DOC: 9253164] ℹ️  DOB normalized: 06/09/1950
[02:06:24] [DOC: 9253164] ℹ️  Episode startOfCare normalized: 03/06/2025
[02:06:24] [DOC: 9253164] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[02:06:24] [DOC: 9253164] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[02:06:24] [DOC: 9253164] ✅ Patient date processing completed successfully
[02:06:24] ✅    ✅ Date processing completed
[02:06:24] 📊 Processed Patient Data
     └─ patientFName: Dennis
     └─ patientLName: Desnoyers
     └─ dob: 06/09/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 2194001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Speech Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025'}]
[02:06:24] 🔄 
🔄 Step 4: Extracting order data...
[02:06:27] ℹ️  Order extraction - MRN: ''
[02:06:27] ℹ️  Order extraction - Sex: 'MALE'
[02:06:27] ℹ️  Order extraction - Service Line: 'ST'
[02:06:27] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:06:27] ✅ Order data extraction completed successfully
[02:06:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:06:27] ℹ️  Using MRN from patient data: '2194001'
[02:06:27] ℹ️  Combined service lines: Patient='Speech Therapy' + Order='ST' = 'ST, Speech Therapy'
[02:06:27] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:06:27] ✅ Patient name cross-validation successful
[02:06:27] ✅    ✅ Data merged successfully
[02:06:28] ✅    ✅ Order data extracted and validated
[02:06:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:06:54] [DOC: 9253164] ✅ Patient exists in API: Dennis Desnoyers, ID: 3106f889-98e7-49b0-b68f-2e6c8776ddb9
[02:06:54] ✅    ✅ Existing patient found with ID: 3106f889-98e7-49b0-b68f-2e6c8776ddb9
[02:06:54] 🔄 
🔄 Step 6: Pushing order to API...
[02:06:54] [DOC: 9253164] ℹ️  Pushing order via API for patient ID: 3106f889-98e7-49b0-b68f-2e6c8776ddb9
[02:06:55] [DOC: 9253164] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:06:55] ❌    ❌ Failed to push order
[02:06:55] 🔄 
🔄 Step 7: Writing to CSV...
[02:06:55] [DOC: 9253164] ℹ️  Calculated age: 74 from DOB: 06/09/1950
[02:06:55] [DOC: 9253164] ℹ️  Service Line extracted: 'ST, Speech Therapy'
[02:06:55] [DOC: 9253164] ℹ️  Payer Source extracted: 'Medicare'
[02:06:55] [DOC: 9253164] ℹ️  Diagnosis codes being written:
[02:06:55] [DOC: 9253164] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:06:55] [DOC: 9253164] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:06:55] [DOC: 9253164] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:06:55] [DOC: 9253164] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:06:55] [DOC: 9253164] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:06:55] [DOC: 9253164] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:06:55] [DOC: 9253164] ✅ Patient data written to CSV: Dennis Desnoyers | Sex: MALE | Age: 74 | Service: ST, Speech Therapy | Payer: Medicare | MRN: 2194001
[02:06:55] ✅    ✅ Document 9253164 processed and saved successfully
[02:06:55] 🔄 
🔄 Step 8: Saving API details...
[02:06:55] [DOC: 9253164] ℹ️  API push details saved for document 9253164
[02:06:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252967                         ║
================================================================================
[02:06:55] ℹ️  Agency: Dartmouth HH
[02:06:55] ℹ️  Date: 04/22/2025
[02:06:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:06:58] [DOC: 9252967] ✅ Text extracted using pdfplumber (7277 chars)
[02:06:58] ✅    ✅ Text extracted using pdfplumber (7277 chars)
[02:06:58] 🔄 
🔄 Step 2: Extracting patient data...
[02:07:01] ℹ️  AI extracted raw sex value: 'F'
[02:07:01] ℹ️  AI extracted service line: 'PT'
[02:07:01] ℹ️  AI extracted payer source: 'Fallon Health'
[02:07:01] ℹ️  AI extracted diagnoses:
[02:07:01] ℹ️    - Diagnosis 1: 'I50'
[02:07:01] ℹ️    - Diagnosis 2: 'I48'
[02:07:01] ℹ️    - Diagnosis 3: ''
[02:07:01] ℹ️    - Diagnosis 4: ''
[02:07:01] ℹ️    - Diagnosis 5: ''
[02:07:01] ℹ️    - Diagnosis 6: ''
[02:07:01] ℹ️  Final extracted MRN: '4034011'
[02:07:01] ℹ️  Final extracted Sex: 'FEMALE'
[02:07:01] ℹ️  Final extracted Service Line: 'PT'
[02:07:01] ℹ️  Final extracted Payer Source: 'Fallon Health'
[02:07:01] ✅ Patient data extraction completed successfully
[02:07:01] ✅    ✅ Patient data extracted successfully
[02:07:01] 📊 Patient Response
     └─ patientFName: Joan
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'I50', 'secondDiagnosis': 'I48', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:07:01] ✅    ✅ Patient identified: Joan Swift
[02:07:01] ✅    ✅ Patient name validation passed
[02:07:01] 🔄 
🔄 Step 3: Processing patient dates...
[02:07:01] [DOC: 9252967] ℹ️  DOB normalized: 05/05/1943
[02:07:01] [DOC: 9252967] ℹ️  Episode startOfCare normalized: 01/08/2025
[02:07:01] [DOC: 9252967] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[02:07:01] [DOC: 9252967] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[02:07:01] [DOC: 9252967] ✅ Patient date processing completed successfully
[02:07:01] ✅    ✅ Date processing completed
[02:07:01] 📊 Processed Patient Data
     └─ patientFName: Joan
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'I50', 'secondDiagnosis': 'I48', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:07:01] 🔄 
🔄 Step 4: Extracting order data...
[02:07:04] ℹ️  Order extraction - MRN: ''
[02:07:04] ℹ️  Order extraction - Sex: 'FEMALE'
[02:07:04] ℹ️  Order extraction - Service Line: 'PT'
[02:07:04] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[02:07:04] ✅ Order data extraction completed successfully
[02:07:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:07:04] ℹ️  Using MRN from patient data: '4034011'
[02:07:04] ℹ️  Service line consistent in both sources: 'PT'
[02:07:04] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[02:07:04] ✅ Patient name cross-validation successful
[02:07:04] ✅    ✅ Data merged successfully
[02:07:05] ✅    ✅ Order data extracted and validated
[02:07:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:07:11] [DOC: 9252967] ✅ Patient exists in API: Joan Swift, ID: e83d8c65-60ef-4130-a086-35a05793cc68
[02:07:11] ✅    ✅ Existing patient found with ID: e83d8c65-60ef-4130-a086-35a05793cc68
[02:07:11] 🔄 
🔄 Step 6: Pushing order to API...
[02:07:11] [DOC: 9252967] ℹ️  Pushing order via API for patient ID: e83d8c65-60ef-4130-a086-35a05793cc68
[02:07:12] [DOC: 9252967] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:07:12] ❌    ❌ Failed to push order
[02:07:12] 🔄 
🔄 Step 7: Writing to CSV...
[02:07:12] [DOC: 9252967] ℹ️  Calculated age: 82 from DOB: 05/05/1943
[02:07:12] [DOC: 9252967] ℹ️  Service Line extracted: 'PT'
[02:07:12] [DOC: 9252967] ℹ️  Payer Source extracted: 'Fallon Health'
[02:07:12] [DOC: 9252967] ℹ️  Diagnosis codes being written:
[02:07:12] [DOC: 9252967] ℹ️    - Latest_Episode_Firstdiagnosis: 'I50'
[02:07:12] [DOC: 9252967] ℹ️    - Latest_Episode_Seconddiagnosis: 'I48'
[02:07:12] [DOC: 9252967] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:07:12] [DOC: 9252967] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:07:12] [DOC: 9252967] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:07:12] [DOC: 9252967] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:07:12] [DOC: 9252967] ✅ Patient data written to CSV: Joan Swift | Sex: FEMALE | Age: 82 | Service: PT | Payer: Fallon Health | MRN: 4034011
[02:07:12] ✅    ✅ Document 9252967 processed and saved successfully
[02:07:12] 🔄 
🔄 Step 8: Saving API details...
[02:07:12] [DOC: 9252967] ℹ️  API push details saved for document 9252967
[02:07:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252966                         ║
================================================================================
[02:07:12] ℹ️  Agency: Dartmouth HH
[02:07:12] ℹ️  Date: 04/22/2025
[02:07:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:07:15] [DOC: 9252966] ✅ Text extracted using pdfplumber (1062 chars)
[02:07:15] ✅    ✅ Text extracted using pdfplumber (1062 chars)
[02:07:15] 🔄 
🔄 Step 2: Extracting patient data...
[02:07:17] ℹ️  AI extracted raw sex value: 'F'
[02:07:17] ℹ️  AI extracted service line: 'HHA'
[02:07:17] ℹ️  AI extracted payer source: 'Medicare'
[02:07:17] ℹ️  AI extracted diagnoses:
[02:07:17] ℹ️    - Diagnosis 1: ''
[02:07:17] ℹ️    - Diagnosis 2: ''
[02:07:17] ℹ️    - Diagnosis 3: ''
[02:07:17] ℹ️    - Diagnosis 4: ''
[02:07:17] ℹ️    - Diagnosis 5: ''
[02:07:17] ℹ️    - Diagnosis 6: ''
[02:07:17] ℹ️  Final extracted MRN: '2705002'
[02:07:17] ℹ️  Final extracted Sex: 'FEMALE'
[02:07:17] ℹ️  Final extracted Service Line: 'HHA'
[02:07:17] ℹ️  Final extracted Payer Source: 'Medicare'
[02:07:17] ✅ Patient data extraction completed successfully
[02:07:17] ✅    ✅ Patient data extracted successfully
[02:07:17] 📊 Patient Response
     └─ patientFName: Odelia
     └─ patientLName: Cardoza
     └─ dob: 02/27/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2705002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 39 Leboeuf Street
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/18/2025', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:07:17] ✅    ✅ Patient identified: Odelia Cardoza
[02:07:17] ✅    ✅ Patient name validation passed
[02:07:17] 🔄 
🔄 Step 3: Processing patient dates...
[02:07:17] [DOC: 9252966] ℹ️  DOB normalized: 02/27/1932
[02:07:17] [DOC: 9252966] ℹ️  Episode startOfCare normalized: 02/18/2025
[02:07:17] [DOC: 9252966] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[02:07:17] [DOC: 9252966] ℹ️  Episode endOfEpisode normalized: 04/18/2025
[02:07:17] [DOC: 9252966] ✅ Patient date processing completed successfully
[02:07:17] ✅    ✅ Date processing completed
[02:07:17] 📊 Processed Patient Data
     └─ patientFName: Odelia
     └─ patientLName: Cardoza
     └─ dob: 02/27/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2705002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 39 Leboeuf Street
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/18/2025', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '04/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:07:17] 🔄 
🔄 Step 4: Extracting order data...
[02:07:20] ℹ️  Order extraction - MRN: ''
[02:07:20] ℹ️  Order extraction - Sex: 'FEMALE'
[02:07:20] ℹ️  Order extraction - Service Line: 'HHA'
[02:07:20] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:07:20] ✅ Order data extraction completed successfully
[02:07:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:07:20] ℹ️  Using MRN from patient data: '2705002'
[02:07:20] ℹ️  Service line consistent in both sources: 'HHA'
[02:07:20] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:07:20] ✅ Patient name cross-validation successful
[02:07:20] ✅    ✅ Data merged successfully
[02:07:21] ✅    ✅ Order data extracted and validated
[02:07:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:07:51] [DOC: 9252966] ✅ Patient exists in API: Odelia Cardoza, ID: a4cd5cf4-1040-4cc4-80c6-89f130041d95
[02:07:51] ✅    ✅ Existing patient found with ID: a4cd5cf4-1040-4cc4-80c6-89f130041d95
[02:07:51] 🔄 
🔄 Step 6: Pushing order to API...
[02:07:51] [DOC: 9252966] ℹ️  Pushing order via API for patient ID: a4cd5cf4-1040-4cc4-80c6-89f130041d95
[02:07:52] [DOC: 9252966] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13443"}
[02:07:52] ❌    ❌ Failed to push order
[02:07:52] 🔄 
🔄 Step 7: Writing to CSV...
[02:07:52] [DOC: 9252966] ℹ️  Calculated age: 93 from DOB: 02/27/1932
[02:07:52] [DOC: 9252966] ℹ️  Service Line extracted: 'HHA'
[02:07:52] [DOC: 9252966] ℹ️  Payer Source extracted: 'Medicare'
[02:07:52] [DOC: 9252966] ℹ️  Diagnosis codes being written:
[02:07:52] [DOC: 9252966] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:07:52] [DOC: 9252966] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:07:52] [DOC: 9252966] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:07:52] [DOC: 9252966] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:07:52] [DOC: 9252966] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:07:52] [DOC: 9252966] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:07:52] [DOC: 9252966] ✅ Patient data written to CSV: Odelia Cardoza | Sex: FEMALE | Age: 93 | Service: HHA | Payer: Medicare | MRN: 2705002
[02:07:52] ✅    ✅ Document 9252966 processed and saved successfully
[02:07:52] 🔄 
🔄 Step 8: Saving API details...
[02:07:52] [DOC: 9252966] ℹ️  API push details saved for document 9252966
[02:07:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252945                         ║
================================================================================
[02:07:52] ℹ️  Agency: Fairhaven HH&H
[02:07:52] ℹ️  Date: 04/22/2025
[02:07:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:07:54] [DOC: 9252945] ✅ Text extracted using pdfplumber (1149 chars)
[02:07:54] ✅    ✅ Text extracted using pdfplumber (1149 chars)
[02:07:54] 🔄 
🔄 Step 2: Extracting patient data...
[02:07:57] ℹ️  AI extracted raw sex value: 'F'
[02:07:57] ℹ️  AI extracted service line: 'MSW'
[02:07:57] ℹ️  AI extracted payer source: 'Medicare'
[02:07:57] ℹ️  AI extracted diagnoses:
[02:07:57] ℹ️    - Diagnosis 1: ''
[02:07:57] ℹ️    - Diagnosis 2: ''
[02:07:57] ℹ️    - Diagnosis 3: ''
[02:07:57] ℹ️    - Diagnosis 4: ''
[02:07:57] ℹ️    - Diagnosis 5: ''
[02:07:57] ℹ️    - Diagnosis 6: ''
[02:07:57] ℹ️  Final extracted MRN: '5350011'
[02:07:57] ℹ️  Final extracted Sex: 'FEMALE'
[02:07:57] ℹ️  Final extracted Service Line: 'MSW'
[02:07:57] ℹ️  Final extracted Payer Source: 'Medicare'
[02:07:57] ✅ Patient data extraction completed successfully
[02:07:57] ✅    ✅ Patient data extracted successfully
[02:07:57] 📊 Patient Response
     └─ patientFName: Rosemary
     └─ patientLName: Crompton
     └─ dob: 08/17/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5350011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/02/2023', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:07:57] ✅    ✅ Patient identified: Rosemary Crompton
[02:07:57] ✅    ✅ Patient name validation passed
[02:07:57] 🔄 
🔄 Step 3: Processing patient dates...
[02:07:57] [DOC: 9252945] ℹ️  DOB normalized: 08/17/1944
[02:07:57] [DOC: 9252945] ℹ️  Episode startOfCare normalized: 12/02/2023
[02:07:57] [DOC: 9252945] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[02:07:57] [DOC: 9252945] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[02:07:57] [DOC: 9252945] ✅ Patient date processing completed successfully
[02:07:57] ✅    ✅ Date processing completed
[02:07:57] 📊 Processed Patient Data
     └─ patientFName: Rosemary
     └─ patientLName: Crompton
     └─ dob: 08/17/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5350011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/02/2023', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:07:57] 🔄 
🔄 Step 4: Extracting order data...
[02:07:59] ℹ️  Order extraction - MRN: '5350011'
[02:07:59] ℹ️  Order extraction - Sex: 'FEMALE'
[02:07:59] ℹ️  Order extraction - Service Line: 'MSW'
[02:07:59] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:07:59] ✅ Order data extraction completed successfully
[02:07:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:07:59] ℹ️  Using MRN from patient data: '5350011' over '5350011'
[02:07:59] ℹ️  Service line consistent in both sources: 'MSW'
[02:07:59] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:07:59] ✅ Patient name cross-validation successful
[02:07:59] ✅    ✅ Data merged successfully
[02:08:01] ✅    ✅ Order data extracted and validated
[02:08:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:08:01] [DOC: 9252945] ✅ Patient found in local cache: Rosemary Crompton, ID: 9e9a2730-2134-440b-9deb-8a3dc67fd265
[02:08:01] ✅    ✅ Existing patient found with ID: 9e9a2730-2134-440b-9deb-8a3dc67fd265
[02:08:01] 🔄 
🔄 Step 6: Pushing order to API...
[02:08:01] [DOC: 9252945] ℹ️  Pushing order via API for patient ID: 9e9a2730-2134-440b-9deb-8a3dc67fd265
[02:08:02] [DOC: 9252945] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:08:02] ❌    ❌ Failed to push order
[02:08:02] 🔄 
🔄 Step 7: Writing to CSV...
[02:08:02] [DOC: 9252945] ℹ️  Calculated age: 80 from DOB: 08/17/1944
[02:08:02] [DOC: 9252945] ℹ️  Service Line extracted: 'MSW'
[02:08:02] [DOC: 9252945] ℹ️  Payer Source extracted: 'Medicare'
[02:08:02] [DOC: 9252945] ℹ️  Diagnosis codes being written:
[02:08:02] [DOC: 9252945] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:08:02] [DOC: 9252945] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:08:02] [DOC: 9252945] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:08:02] [DOC: 9252945] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:08:02] [DOC: 9252945] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:08:02] [DOC: 9252945] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:08:02] [DOC: 9252945] ✅ Patient data written to CSV: Rosemary Crompton | Sex: FEMALE | Age: 80 | Service: MSW | Payer: Medicare | MRN: 5350011
[02:08:02] ✅    ✅ Document 9252945 processed and saved successfully
[02:08:02] 🔄 
🔄 Step 8: Saving API details...
[02:08:02] [DOC: 9252945] ℹ️  API push details saved for document 9252945
[02:08:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252878                         ║
================================================================================
[02:08:02] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:08:02] ℹ️  Date: 04/22/2025
[02:08:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:08:06] [DOC: 9252878] ✅ Text extracted using pdfplumber (17361 chars)
[02:08:06] ✅    ✅ Text extracted using pdfplumber (17361 chars)
[02:08:06] 🔄 
🔄 Step 2: Extracting patient data...
[02:08:09] ℹ️  AI extracted raw sex value: ''
[02:08:09] ℹ️  AI extracted service line: 'PT'
[02:08:09] ℹ️  AI extracted payer source: ''
[02:08:09] ℹ️  AI extracted diagnoses:
[02:08:09] ℹ️    - Diagnosis 1: 'DM'
[02:08:09] ℹ️    - Diagnosis 2: 'Difficulty gait'
[02:08:09] ℹ️    - Diagnosis 3: ''
[02:08:09] ℹ️    - Diagnosis 4: ''
[02:08:09] ℹ️    - Diagnosis 5: ''
[02:08:09] ℹ️    - Diagnosis 6: ''
[02:08:09] ℹ️  Final extracted MRN: 'MA200528053701'
[02:08:09] ℹ️  Final extracted Sex: ''
[02:08:09] ℹ️  Final extracted Service Line: 'PT'
[02:08:09] ℹ️  Final extracted Payer Source: ''
[02:08:09] ✅ Patient data extraction completed successfully
[02:08:09] ✅    ✅ Patient data extracted successfully
[02:08:09] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '', 'firstDiagnosis': 'DM', 'secondDiagnosis': 'Difficulty gait', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:08:09] ✅    ✅ Patient identified: Roderick Lopez
[02:08:09] ✅    ✅ Patient name validation passed
[02:08:09] 🔄 
🔄 Step 3: Processing patient dates...
[02:08:09] [DOC: 9252878] ℹ️  DOB normalized: 05/21/1937
[02:08:09] [DOC: 9252878] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[02:08:09] [DOC: 9252878] ✅ Patient date processing completed successfully
[02:08:09] ✅    ✅ Date processing completed
[02:08:09] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'endOfEpisode': '', 'firstDiagnosis': 'DM', 'secondDiagnosis': 'Difficulty gait', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:08:09] 🔄 
🔄 Step 4: Extracting order data...
[02:08:12] ℹ️  Order extraction - MRN: 'MA200528053701'
[02:08:12] ℹ️  Order extraction - Sex: 'MALE'
[02:08:12] ℹ️  Order extraction - Service Line: 'PT'
[02:08:12] ℹ️  Order extraction - Payer Source: ''
[02:08:12] ✅ Order data extraction completed successfully
[02:08:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:08:12] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[02:08:12] ℹ️  Service line consistent in both sources: 'PT'
[02:08:12] ✅ Patient name cross-validation successful
[02:08:12] ✅    ✅ Data merged successfully
[02:08:13] ✅    ✅ Order data extracted and validated
[02:08:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:08:48] [DOC: 9252878] ℹ️  Patient not found in cache or API: Roderick Lopez
[02:08:48] [DOC: 9252878] ℹ️  Patient not found, creating new patient via API...
[02:08:48] [DOC: 9252878] ℹ️  Creating patient via API: Roderick Lopez
[02:08:50] [DOC: 9252878] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:08:50] ❌    ❌ Failed to create patient
[02:08:50] [DOC: 9252878] ℹ️  API push details saved for document 9252878
================================================================================
║                        Processing Document ID: 9252873                         ║
================================================================================
[02:08:50] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:08:50] ℹ️  Date: 04/22/2025
[02:08:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:08:52] [DOC: 9252873] ✅ Text extracted using pdfplumber (2032 chars)
[02:08:52] ✅    ✅ Text extracted using pdfplumber (2032 chars)
[02:08:52] 🔄 
🔄 Step 2: Extracting patient data...
[02:08:55] ℹ️  AI extracted raw sex value: ''
[02:08:55] ℹ️  AI extracted service line: 'LPN'
[02:08:55] ℹ️  AI extracted payer source: ''
[02:08:55] ℹ️  AI extracted diagnoses:
[02:08:55] ℹ️    - Diagnosis 1: 'K25.9'
[02:08:55] ℹ️    - Diagnosis 2: 'D50.0'
[02:08:55] ℹ️    - Diagnosis 3: 'K50.90'
[02:08:55] ℹ️    - Diagnosis 4: ''
[02:08:55] ℹ️    - Diagnosis 5: ''
[02:08:55] ℹ️    - Diagnosis 6: ''
[02:08:55] ℹ️  Final extracted MRN: 'MA250328114901'
[02:08:55] ℹ️  Final extracted Sex: ''
[02:08:55] ℹ️  Final extracted Service Line: 'LPN'
[02:08:55] ℹ️  Final extracted Payer Source: ''
[02:08:55] ✅ Patient data extraction completed successfully
[02:08:55] ✅    ✅ Patient data extracted successfully
[02:08:55] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 1891138822
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:08:55] ✅    ✅ Patient identified: Shirley Tavares
[02:08:55] ✅    ✅ Patient name validation passed
[02:08:55] 🔄 
🔄 Step 3: Processing patient dates...
[02:08:55] [DOC: 9252873] ℹ️  DOB normalized: 11/10/1949
[02:08:55] [DOC: 9252873] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[02:08:55] [DOC: 9252873] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[02:08:55] [DOC: 9252873] ✅ Patient date processing completed successfully
[02:08:55] ✅    ✅ Date processing completed
[02:08:55] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 1891138822
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:08:55] 🔄 
🔄 Step 4: Extracting order data...
[02:08:57] ℹ️  Order extraction - MRN: 'MA250328114901'
[02:08:57] ℹ️  Order extraction - Sex: ''
[02:08:57] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:08:57] ℹ️  Order extraction - Payer Source: ''
[02:08:57] ✅ Order data extraction completed successfully
[02:08:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:08:57] ℹ️  Using MRN from patient data: 'MA250328114901' over 'MA250328114901'
[02:08:57] ⚠️  Could not determine sex using any available method
[02:08:57] ℹ️  Combined service lines: Patient='LPN' + Order='Skilled Nursing' = 'LPN, Skilled Nursing'
[02:08:57] ✅ Patient name cross-validation successful
[02:08:57] ✅    ✅ Data merged successfully
[02:08:59] ✅    ✅ Order data extracted and validated
[02:08:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:08:59] [DOC: 9252873] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[02:08:59] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[02:08:59] 🔄 
🔄 Step 6: Pushing order to API...
[02:08:59] [DOC: 9252873] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[02:09:00] [DOC: 9252873] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14227"}
[02:09:00] ❌    ❌ Failed to push order
[02:09:00] 🔄 
🔄 Step 7: Writing to CSV...
[02:09:00] [DOC: 9252873] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[02:09:00] [DOC: 9252873] ℹ️  Service Line extracted: 'LPN, Skilled Nursing'
[02:09:00] [DOC: 9252873] ℹ️  Payer Source extracted: ''
[02:09:00] [DOC: 9252873] ℹ️  Diagnosis codes being written:
[02:09:00] [DOC: 9252873] ℹ️    - Latest_Episode_Firstdiagnosis: 'K25.9'
[02:09:00] [DOC: 9252873] ℹ️    - Latest_Episode_Seconddiagnosis: 'D50.0'
[02:09:00] [DOC: 9252873] ℹ️    - Latest_Episode_Thirddiagnosis: 'K50.90'
[02:09:00] [DOC: 9252873] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:09:00] [DOC: 9252873] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:09:00] [DOC: 9252873] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:09:00] [DOC: 9252873] ✅ Patient data written to CSV: Shirley Tavares | Sex:  | Age: 75 | Service: LPN, Skilled Nursing | Payer:  | MRN: MA250328114901
[02:09:00] ✅    ✅ Document 9252873 processed and saved successfully
[02:09:00] 🔄 
🔄 Step 8: Saving API details...
[02:09:00] [DOC: 9252873] ℹ️  API push details saved for document 9252873
[02:09:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252868                         ║
================================================================================
[02:09:00] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:09:00] ℹ️  Date: 04/22/2025
[02:09:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:09:03] [DOC: 9252868] ✅ Text extracted using pdfplumber (2267 chars)
[02:09:03] ✅    ✅ Text extracted using pdfplumber (2267 chars)
[02:09:03] 🔄 
🔄 Step 2: Extracting patient data...
[02:09:06] ℹ️  AI extracted raw sex value: ''
[02:09:06] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:09:06] ℹ️  AI extracted payer source: ''
[02:09:06] ℹ️  AI extracted diagnoses:
[02:09:06] ℹ️    - Diagnosis 1: 'F03.90'
[02:09:06] ℹ️    - Diagnosis 2: 'R60.9'
[02:09:06] ℹ️    - Diagnosis 3: 'G47.9'
[02:09:06] ℹ️    - Diagnosis 4: 'None'
[02:09:06] ℹ️    - Diagnosis 5: 'None'
[02:09:06] ℹ️    - Diagnosis 6: 'None'
[02:09:06] ℹ️  Final extracted MRN: 'MA221012023702'
[02:09:06] ℹ️  Final extracted Sex: ''
[02:09:06] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:09:06] ℹ️  Final extracted Payer Source: ''
[02:09:06] ✅ Patient data extraction completed successfully
[02:09:06] ✅    ✅ Patient data extracted successfully
[02:09:06] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:09:06] ✅    ✅ Patient identified: Mary Pedra
[02:09:06] ✅    ✅ Patient name validation passed
[02:09:06] 🔄 
🔄 Step 3: Processing patient dates...
[02:09:06] [DOC: 9252868] ℹ️  DOB normalized: 02/27/1937
[02:09:06] [DOC: 9252868] ℹ️  Episode startOfEpisode normalized: 02/26/2025
[02:09:06] [DOC: 9252868] ℹ️  Episode endOfEpisode normalized: 04/26/2025
[02:09:06] [DOC: 9252868] ✅ Patient date processing completed successfully
[02:09:06] ✅    ✅ Date processing completed
[02:09:06] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Pedra
     └─ dob: 02/27/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA221012023702
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/26/2025', 'endOfEpisode': '04/26/2025', 'firstDiagnosis': 'F03.90', 'secondDiagnosis': 'R60.9', 'thirdDiagnosis': 'G47.9'}]
[02:09:06] 🔄 
🔄 Step 4: Extracting order data...
[02:09:09] ℹ️  Order extraction - MRN: 'MA221012023702'
[02:09:09] ℹ️  Order extraction - Sex: ''
[02:09:09] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:09:09] ℹ️  Order extraction - Payer Source: ''
[02:09:09] ✅ Order data extraction completed successfully
[02:09:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:09:09] ℹ️  Using MRN from patient data: 'MA221012023702' over 'MA221012023702'
[02:09:09] ℹ️  Inferred sex as FEMALE from name: Mary
[02:09:09] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:09:09] ✅ Patient name cross-validation successful
[02:09:09] ✅    ✅ Data merged successfully
[02:09:10] ✅    ✅ Order data extracted and validated
[02:09:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:09:10] [DOC: 9252868] ✅ Patient found in local cache: Mary Pedra, ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[02:09:10] ✅    ✅ Existing patient found with ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[02:09:10] 🔄 
🔄 Step 6: Pushing order to API...
[02:09:10] [DOC: 9252868] ℹ️  Pushing order via API for patient ID: 1d45782a-36cb-44a5-97c5-914cee1fa816
[02:09:11] [DOC: 9252868] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12994"}
[02:09:11] ❌    ❌ Failed to push order
[02:09:11] 🔄 
🔄 Step 7: Writing to CSV...
[02:09:11] [DOC: 9252868] ℹ️  Calculated age: 88 from DOB: 02/27/1937
[02:09:11] [DOC: 9252868] ℹ️  Service Line extracted: 'Skilled Nursing'
[02:09:11] [DOC: 9252868] ℹ️  Payer Source extracted: ''
[02:09:11] [DOC: 9252868] ℹ️  Diagnosis codes being written:
[02:09:11] [DOC: 9252868] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.90'
[02:09:11] [DOC: 9252868] ℹ️    - Latest_Episode_Seconddiagnosis: 'R60.9'
[02:09:11] [DOC: 9252868] ℹ️    - Latest_Episode_Thirddiagnosis: 'G47.9'
[02:09:11] [DOC: 9252868] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:09:11] [DOC: 9252868] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:09:11] [DOC: 9252868] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:09:11] [DOC: 9252868] ✅ Patient data written to CSV: Mary Pedra | Sex: FEMALE | Age: 88 | Service: Skilled Nursing | Payer:  | MRN: MA221012023702
[02:09:11] ✅    ✅ Document 9252868 processed and saved successfully
[02:09:11] 🔄 
🔄 Step 8: Saving API details...
[02:09:11] [DOC: 9252868] ℹ️  API push details saved for document 9252868
[02:09:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252860                         ║
================================================================================
[02:09:11] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:09:11] ℹ️  Date: 04/22/2025
[02:09:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:09:14] [DOC: 9252860] ✅ Text extracted using pdfplumber (1452 chars)
[02:09:14] ✅    ✅ Text extracted using pdfplumber (1440 chars)
[02:09:14] 🔄 
🔄 Step 2: Extracting patient data...
[02:09:17] ℹ️  AI extracted raw sex value: ''
[02:09:17] ℹ️  AI extracted service line: 'Occupational Therapy'
[02:09:17] ℹ️  AI extracted payer source: ''
[02:09:17] ℹ️  AI extracted diagnoses:
[02:09:17] ℹ️    - Diagnosis 1: 'I69.398'
[02:09:17] ℹ️    - Diagnosis 2: 'R53.1'
[02:09:17] ℹ️    - Diagnosis 3: 'I69.322'
[02:09:17] ℹ️    - Diagnosis 4: ''
[02:09:17] ℹ️    - Diagnosis 5: ''
[02:09:17] ℹ️    - Diagnosis 6: ''
[02:09:17] ℹ️  Final extracted MRN: 'MA241126016807'
[02:09:17] ℹ️  Final extracted Sex: ''
[02:09:17] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[02:09:17] ℹ️  Final extracted Payer Source: ''
[02:09:17] ✅ Patient data extraction completed successfully
[02:09:17] ✅    ✅ Patient data extracted successfully
[02:09:17] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:09:17] ✅    ✅ Patient identified: Frank Ferreira
[02:09:17] ✅    ✅ Patient name validation passed
[02:09:17] 🔄 
🔄 Step 3: Processing patient dates...
[02:09:17] [DOC: 9252860] ℹ️  DOB normalized: 01/07/1968
[02:09:17] [DOC: 9252860] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[02:09:17] [DOC: 9252860] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[02:09:17] [DOC: 9252860] ✅ Patient date processing completed successfully
[02:09:17] ✅    ✅ Date processing completed
[02:09:17] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:09:17] 🔄 
🔄 Step 4: Extracting order data...
[02:09:20] ℹ️  Order extraction - MRN: 'MA241126016807'
[02:09:20] ℹ️  Order extraction - Sex: ''
[02:09:20] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[02:09:20] ℹ️  Order extraction - Payer Source: ''
[02:09:20] ✅ Order data extraction completed successfully
[02:09:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:09:20] ℹ️  Using MRN from patient data: 'MA241126016807' over 'MA241126016807'
[02:09:20] ℹ️  Inferred sex as MALE from name: Frank
[02:09:20] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[02:09:20] ✅ Patient name cross-validation successful
[02:09:20] ✅    ✅ Data merged successfully
[02:09:21] ✅    ✅ Order data extracted and validated
[02:09:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:09:33] [DOC: 9252860] ℹ️  Patient not found in cache or API: Frank Ferreira
[02:09:33] [DOC: 9252860] ℹ️  Patient not found, creating new patient via API...
[02:09:33] [DOC: 9252860] ℹ️  Creating patient via API: Frank Ferreira
[02:09:34] [DOC: 9252860] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:09:34] ❌    ❌ Failed to create patient
[02:09:34] [DOC: 9252860] ℹ️  API push details saved for document 9252860
================================================================================
║                        Processing Document ID: 9252858                         ║
================================================================================
[02:09:34] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:09:34] ℹ️  Date: 04/22/2025
[02:09:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:09:36] [DOC: 9252858] ✅ Text extracted using pdfplumber (1452 chars)
[02:09:36] ✅    ✅ Text extracted using pdfplumber (1440 chars)
[02:09:36] 🔄 
🔄 Step 2: Extracting patient data...
[02:09:39] ℹ️  AI extracted raw sex value: ''
[02:09:39] ℹ️  AI extracted service line: 'Occupational Therapy'
[02:09:39] ℹ️  AI extracted payer source: ''
[02:09:39] ℹ️  AI extracted diagnoses:
[02:09:39] ℹ️    - Diagnosis 1: 'I69.398'
[02:09:39] ℹ️    - Diagnosis 2: 'R53.1'
[02:09:39] ℹ️    - Diagnosis 3: 'I69.322'
[02:09:39] ℹ️    - Diagnosis 4: ''
[02:09:39] ℹ️    - Diagnosis 5: ''
[02:09:39] ℹ️    - Diagnosis 6: ''
[02:09:39] ℹ️  Final extracted MRN: 'MA241126016807'
[02:09:39] ℹ️  Final extracted Sex: ''
[02:09:39] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[02:09:39] ℹ️  Final extracted Payer Source: ''
[02:09:39] ✅ Patient data extraction completed successfully
[02:09:39] ✅    ✅ Patient data extracted successfully
[02:09:39] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:09:39] ✅    ✅ Patient identified: Frank Ferreira
[02:09:39] ✅    ✅ Patient name validation passed
[02:09:39] 🔄 
🔄 Step 3: Processing patient dates...
[02:09:39] [DOC: 9252858] ℹ️  DOB normalized: 01/07/1968
[02:09:39] [DOC: 9252858] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[02:09:39] [DOC: 9252858] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[02:09:39] [DOC: 9252858] ✅ Patient date processing completed successfully
[02:09:39] ✅    ✅ Date processing completed
[02:09:39] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:09:39] 🔄 
🔄 Step 4: Extracting order data...
[02:09:42] ℹ️  Order extraction - MRN: 'MA241126016807'
[02:09:42] ℹ️  Order extraction - Sex: ''
[02:09:42] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[02:09:42] ℹ️  Order extraction - Payer Source: ''
[02:09:42] ✅ Order data extraction completed successfully
[02:09:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:09:42] ℹ️  Using MRN from patient data: 'MA241126016807' over 'MA241126016807'
[02:09:42] ℹ️  Inferred sex as MALE from name: Frank
[02:09:42] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[02:09:42] ✅ Patient name cross-validation successful
[02:09:42] ✅    ✅ Data merged successfully
[02:09:43] ✅    ✅ Order data extracted and validated
[02:09:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:10:05] [DOC: 9252858] ℹ️  Patient not found in cache or API: Frank Ferreira
[02:10:05] [DOC: 9252858] ℹ️  Patient not found, creating new patient via API...
[02:10:05] [DOC: 9252858] ℹ️  Creating patient via API: Frank Ferreira
[02:10:06] [DOC: 9252858] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:10:06] ❌    ❌ Failed to create patient
[02:10:06] [DOC: 9252858] ℹ️  API push details saved for document 9252858
================================================================================
║                        Processing Document ID: 9252855                         ║
================================================================================
[02:10:06] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:10:06] ℹ️  Date: 04/22/2025
[02:10:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:10:09] [DOC: 9252855] ✅ Text extracted using pdfplumber (1340 chars)
[02:10:09] ✅    ✅ Text extracted using pdfplumber (1328 chars)
[02:10:09] 🔄 
🔄 Step 2: Extracting patient data...
[02:10:12] ℹ️  AI extracted raw sex value: ''
[02:10:12] ℹ️  AI extracted service line: 'Occupational Therapy'
[02:10:12] ℹ️  AI extracted payer source: ''
[02:10:12] ℹ️  AI extracted diagnoses:
[02:10:12] ℹ️    - Diagnosis 1: 'I69.398'
[02:10:12] ℹ️    - Diagnosis 2: 'R53.1'
[02:10:12] ℹ️    - Diagnosis 3: 'I69.322'
[02:10:12] ℹ️    - Diagnosis 4: ''
[02:10:12] ℹ️    - Diagnosis 5: ''
[02:10:12] ℹ️    - Diagnosis 6: ''
[02:10:12] ℹ️  Final extracted MRN: 'MA241126016807'
[02:10:12] ℹ️  Final extracted Sex: ''
[02:10:12] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[02:10:12] ℹ️  Final extracted Payer Source: ''
[02:10:12] ✅ Patient data extraction completed successfully
[02:10:12] ✅    ✅ Patient data extracted successfully
[02:10:12] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:10:12] ✅    ✅ Patient identified: Frank Ferreira
[02:10:12] ✅    ✅ Patient name validation passed
[02:10:12] 🔄 
🔄 Step 3: Processing patient dates...
[02:10:12] [DOC: 9252855] ℹ️  DOB normalized: 01/07/1968
[02:10:12] [DOC: 9252855] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[02:10:12] [DOC: 9252855] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[02:10:12] [DOC: 9252855] ✅ Patient date processing completed successfully
[02:10:12] ✅    ✅ Date processing completed
[02:10:12] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:10:12] 🔄 
🔄 Step 4: Extracting order data...
[02:10:14] ℹ️  Order extraction - MRN: 'MA241126016807'
[02:10:14] ℹ️  Order extraction - Sex: ''
[02:10:14] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[02:10:14] ℹ️  Order extraction - Payer Source: ''
[02:10:14] ✅ Order data extraction completed successfully
[02:10:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:10:14] ℹ️  Using MRN from patient data: 'MA241126016807' over 'MA241126016807'
[02:10:14] ℹ️  Inferred sex as MALE from name: Frank
[02:10:14] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[02:10:14] ✅ Patient name cross-validation successful
[02:10:14] ✅    ✅ Data merged successfully
[02:10:16] ✅    ✅ Order data extracted and validated
[02:10:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:10:21] [DOC: 9252855] ℹ️  Patient not found in cache or API: Frank Ferreira
[02:10:21] [DOC: 9252855] ℹ️  Patient not found, creating new patient via API...
[02:10:21] [DOC: 9252855] ℹ️  Creating patient via API: Frank Ferreira
[02:10:23] [DOC: 9252855] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:10:23] ❌    ❌ Failed to create patient
[02:10:23] [DOC: 9252855] ℹ️  API push details saved for document 9252855
================================================================================
║                        Processing Document ID: 9252854                         ║
================================================================================
[02:10:23] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:10:23] ℹ️  Date: 04/22/2025
[02:10:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:10:25] [DOC: 9252854] ✅ Text extracted using pdfplumber (1312 chars)
[02:10:25] ✅    ✅ Text extracted using pdfplumber (1300 chars)
[02:10:25] 🔄 
🔄 Step 2: Extracting patient data...
[02:10:28] ℹ️  AI extracted raw sex value: ''
[02:10:28] ℹ️  AI extracted service line: 'Occupational Therapy'
[02:10:28] ℹ️  AI extracted payer source: ''
[02:10:28] ℹ️  AI extracted diagnoses:
[02:10:28] ℹ️    - Diagnosis 1: 'I69.398'
[02:10:28] ℹ️    - Diagnosis 2: 'R53.1'
[02:10:28] ℹ️    - Diagnosis 3: 'I69.322'
[02:10:28] ℹ️    - Diagnosis 4: ''
[02:10:28] ℹ️    - Diagnosis 5: ''
[02:10:28] ℹ️    - Diagnosis 6: ''
[02:10:28] ℹ️  Final extracted MRN: 'MA241126016807'
[02:10:28] ℹ️  Final extracted Sex: ''
[02:10:28] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[02:10:28] ℹ️  Final extracted Payer Source: ''
[02:10:28] ✅ Patient data extraction completed successfully
[02:10:28] ✅    ✅ Patient data extracted successfully
[02:10:28] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:10:28] ✅    ✅ Patient identified: Frank Ferreira
[02:10:28] ✅    ✅ Patient name validation passed
[02:10:28] 🔄 
🔄 Step 3: Processing patient dates...
[02:10:28] [DOC: 9252854] ℹ️  DOB normalized: 01/07/1968
[02:10:28] [DOC: 9252854] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[02:10:28] [DOC: 9252854] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[02:10:28] [DOC: 9252854] ✅ Patient date processing completed successfully
[02:10:28] ✅    ✅ Date processing completed
[02:10:28] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:10:28] 🔄 
🔄 Step 4: Extracting order data...
[02:10:31] ℹ️  Order extraction - MRN: 'MA241126016807'
[02:10:31] ℹ️  Order extraction - Sex: ''
[02:10:31] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[02:10:31] ℹ️  Order extraction - Payer Source: ''
[02:10:31] ✅ Order data extraction completed successfully
[02:10:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:10:31] ℹ️  Using MRN from patient data: 'MA241126016807' over 'MA241126016807'
[02:10:31] ℹ️  Inferred sex as MALE from name: Frank
[02:10:31] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[02:10:31] ✅ Patient name cross-validation successful
[02:10:31] ✅    ✅ Data merged successfully
[02:10:33] ✅    ✅ Order data extracted and validated
[02:10:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:10:38] [DOC: 9252854] ℹ️  Patient not found in cache or API: Frank Ferreira
[02:10:38] [DOC: 9252854] ℹ️  Patient not found, creating new patient via API...
[02:10:38] [DOC: 9252854] ℹ️  Creating patient via API: Frank Ferreira
[02:10:39] [DOC: 9252854] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:10:39] ❌    ❌ Failed to create patient
[02:10:39] [DOC: 9252854] ℹ️  API push details saved for document 9252854
================================================================================
║                        Processing Document ID: 9252853                         ║
================================================================================
[02:10:39] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:10:39] ℹ️  Date: 04/22/2025
[02:10:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:10:41] [DOC: 9252853] ✅ Text extracted using pdfplumber (1449 chars)
[02:10:41] ✅    ✅ Text extracted using pdfplumber (1437 chars)
[02:10:41] 🔄 
🔄 Step 2: Extracting patient data...
[02:10:44] ℹ️  AI extracted raw sex value: ''
[02:10:44] ℹ️  AI extracted service line: 'Physical Therapy'
[02:10:44] ℹ️  AI extracted payer source: ''
[02:10:44] ℹ️  AI extracted diagnoses:
[02:10:44] ℹ️    - Diagnosis 1: 'I69.398'
[02:10:44] ℹ️    - Diagnosis 2: 'R53.1'
[02:10:44] ℹ️    - Diagnosis 3: 'I69.322'
[02:10:44] ℹ️    - Diagnosis 4: ''
[02:10:44] ℹ️    - Diagnosis 5: ''
[02:10:44] ℹ️    - Diagnosis 6: ''
[02:10:44] ℹ️  Final extracted MRN: 'MA241126016807'
[02:10:44] ℹ️  Final extracted Sex: ''
[02:10:44] ℹ️  Final extracted Service Line: 'Physical Therapy'
[02:10:44] ℹ️  Final extracted Payer Source: ''
[02:10:44] ✅ Patient data extraction completed successfully
[02:10:44] ✅    ✅ Patient data extracted successfully
[02:10:44] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:10:44] ✅    ✅ Patient identified: Frank Ferreira
[02:10:44] ✅    ✅ Patient name validation passed
[02:10:44] 🔄 
🔄 Step 3: Processing patient dates...
[02:10:44] [DOC: 9252853] ℹ️  DOB normalized: 01/07/1968
[02:10:44] [DOC: 9252853] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[02:10:44] [DOC: 9252853] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[02:10:44] [DOC: 9252853] ✅ Patient date processing completed successfully
[02:10:44] ✅    ✅ Date processing completed
[02:10:44] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: 
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:10:44] 🔄 
🔄 Step 4: Extracting order data...
[02:10:47] ℹ️  Order extraction - MRN: 'MA241126016807'
[02:10:47] ℹ️  Order extraction - Sex: ''
[02:10:47] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[02:10:47] ℹ️  Order extraction - Payer Source: ''
[02:10:47] ✅ Order data extraction completed successfully
[02:10:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:10:47] ℹ️  Using MRN from patient data: 'MA241126016807' over 'MA241126016807'
[02:10:47] ℹ️  Inferred sex as MALE from name: Frank
[02:10:47] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[02:10:47] ✅ Patient name cross-validation successful
[02:10:47] ✅    ✅ Data merged successfully
[02:10:48] ✅    ✅ Order data extracted and validated
[02:10:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:10:57] [DOC: 9252853] ℹ️  Patient not found in cache or API: Frank Ferreira
[02:10:57] [DOC: 9252853] ℹ️  Patient not found, creating new patient via API...
[02:10:57] [DOC: 9252853] ℹ️  Creating patient via API: Frank Ferreira
[02:10:58] [DOC: 9252853] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:10:58] ❌    ❌ Failed to create patient
[02:10:58] [DOC: 9252853] ℹ️  API push details saved for document 9252853
================================================================================
║                        Processing Document ID: 9252852                         ║
================================================================================
[02:10:58] ℹ️  Agency: Dartmouth HH
[02:10:58] ℹ️  Date: 04/22/2025
[02:10:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:11:00] [DOC: 9252852] ✅ Text extracted using pdfplumber (4316 chars)
[02:11:00] ✅    ✅ Text extracted using pdfplumber (4316 chars)
[02:11:00] 🔄 
🔄 Step 2: Extracting patient data...
[02:11:03] ℹ️  AI extracted raw sex value: 'M'
[02:11:03] ℹ️  AI extracted service line: 'OT'
[02:11:03] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[02:11:03] ℹ️  AI extracted diagnoses:
[02:11:03] ℹ️    - Diagnosis 1: ''
[02:11:03] ℹ️    - Diagnosis 2: ''
[02:11:03] ℹ️    - Diagnosis 3: ''
[02:11:03] ℹ️    - Diagnosis 4: ''
[02:11:03] ℹ️    - Diagnosis 5: ''
[02:11:03] ℹ️    - Diagnosis 6: ''
[02:11:03] ℹ️  Final extracted MRN: '551011'
[02:11:03] ℹ️  Final extracted Sex: 'MALE'
[02:11:03] ℹ️  Final extracted Service Line: 'OT'
[02:11:03] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[02:11:03] ✅ Patient data extraction completed successfully
[02:11:03] ✅    ✅ Patient data extracted successfully
[02:11:03] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Travers
     └─ dob: 07/02/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 551011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:11:03] ✅    ✅ Patient identified: James Travers
[02:11:03] ✅    ✅ Patient name validation passed
[02:11:03] 🔄 
🔄 Step 3: Processing patient dates...
[02:11:03] [DOC: 9252852] ℹ️  DOB normalized: 07/02/1944
[02:11:03] [DOC: 9252852] ℹ️  Episode startOfCare normalized: 03/23/2025
[02:11:03] [DOC: 9252852] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[02:11:03] [DOC: 9252852] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[02:11:03] [DOC: 9252852] ✅ Patient date processing completed successfully
[02:11:03] ✅    ✅ Date processing completed
[02:11:03] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Travers
     └─ dob: 07/02/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 551011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:11:03] 🔄 
🔄 Step 4: Extracting order data...
[02:11:05] ℹ️  Order extraction - MRN: ''
[02:11:05] ℹ️  Order extraction - Sex: 'MALE'
[02:11:05] ℹ️  Order extraction - Service Line: 'OT'
[02:11:05] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[02:11:05] ✅ Order data extraction completed successfully
[02:11:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:11:05] ℹ️  Using MRN from patient data: '551011'
[02:11:05] ℹ️  Service line consistent in both sources: 'OT'
[02:11:05] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[02:11:05] ✅ Patient name cross-validation successful
[02:11:05] ✅    ✅ Data merged successfully
[02:11:06] ✅    ✅ Order data extracted and validated
[02:11:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:11:06] [DOC: 9252852] ✅ Patient found in local cache: James Travers, ID: c5103623-be0f-42b5-97de-217d9f008d54
[02:11:06] ✅    ✅ Existing patient found with ID: c5103623-be0f-42b5-97de-217d9f008d54
[02:11:06] 🔄 
🔄 Step 6: Pushing order to API...
[02:11:06] [DOC: 9252852] ℹ️  Pushing order via API for patient ID: c5103623-be0f-42b5-97de-217d9f008d54
[02:11:08] [DOC: 9252852] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:11:08] ❌    ❌ Failed to push order
[02:11:08] 🔄 
🔄 Step 7: Writing to CSV...
[02:11:08] [DOC: 9252852] ℹ️  Calculated age: 80 from DOB: 07/02/1944
[02:11:08] [DOC: 9252852] ℹ️  Service Line extracted: 'OT'
[02:11:08] [DOC: 9252852] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[02:11:08] [DOC: 9252852] ℹ️  Diagnosis codes being written:
[02:11:08] [DOC: 9252852] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:11:08] [DOC: 9252852] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:11:08] [DOC: 9252852] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:11:08] [DOC: 9252852] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:11:08] [DOC: 9252852] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:11:08] [DOC: 9252852] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:11:08] [DOC: 9252852] ✅ Patient data written to CSV: James Travers | Sex: MALE | Age: 80 | Service: OT | Payer: Blue Cross Blue Shield | MRN: 551011
[02:11:08] ✅    ✅ Document 9252852 processed and saved successfully
[02:11:08] 🔄 
🔄 Step 8: Saving API details...
[02:11:08] [DOC: 9252852] ℹ️  API push details saved for document 9252852
[02:11:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252851                         ║
================================================================================
[02:11:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:11:08] ℹ️  Date: 04/22/2025
[02:11:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:11:12] [DOC: 9252851] ✅ Text extracted using pdfplumber (17667 chars)
[02:11:12] ✅    ✅ Text extracted using pdfplumber (17667 chars)
[02:11:12] 🔄 
🔄 Step 2: Extracting patient data...
[02:11:15] ℹ️  AI extracted raw sex value: 'M'
[02:11:15] ℹ️  AI extracted service line: 'PT'
[02:11:15] ℹ️  AI extracted payer source: ''
[02:11:15] ℹ️  AI extracted diagnoses:
[02:11:15] ℹ️    - Diagnosis 1: ''
[02:11:15] ℹ️    - Diagnosis 2: ''
[02:11:15] ℹ️    - Diagnosis 3: ''
[02:11:15] ℹ️    - Diagnosis 4: ''
[02:11:15] ℹ️    - Diagnosis 5: ''
[02:11:15] ℹ️    - Diagnosis 6: ''
[02:11:15] ℹ️  Final extracted MRN: 'MA241126016807'
[02:11:15] ℹ️  Final extracted Sex: 'MALE'
[02:11:15] ℹ️  Final extracted Service Line: 'PT'
[02:11:15] ℹ️  Final extracted Payer Source: ''
[02:11:15] ✅ Patient data extraction completed successfully
[02:11:15] ✅    ✅ Patient data extracted successfully
[02:11:15] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:11:15] ✅    ✅ Patient identified: Frank Ferreira
[02:11:15] ✅    ✅ Patient name validation passed
[02:11:15] 🔄 
🔄 Step 3: Processing patient dates...
[02:11:15] [DOC: 9252851] ℹ️  DOB normalized: 01/07/1968
[02:11:15] [DOC: 9252851] ℹ️  Episode startOfEpisode normalized: 04/15/2025
[02:11:15] [DOC: 9252851] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[02:11:15] [DOC: 9252851] ✅ Patient date processing completed successfully
[02:11:15] ✅    ✅ Date processing completed
[02:11:15] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:11:15] 🔄 
🔄 Step 4: Extracting order data...
[02:11:18] ℹ️  Order extraction - MRN: 'MA241126016807'
[02:11:18] ℹ️  Order extraction - Sex: 'MALE'
[02:11:18] ℹ️  Order extraction - Service Line: 'PT'
[02:11:18] ℹ️  Order extraction - Payer Source: ''
[02:11:18] ✅ Order data extraction completed successfully
[02:11:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:11:18] ℹ️  Using MRN from patient data: 'MA241126016807' over 'MA241126016807'
[02:11:18] ℹ️  Service line consistent in both sources: 'PT'
[02:11:18] ✅ Patient name cross-validation successful
[02:11:18] ✅    ✅ Data merged successfully
[02:11:20] ✅    ✅ Order data extracted and validated
[02:11:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:11:45] [DOC: 9252851] ℹ️  Patient not found in cache or API: Frank Ferreira
[02:11:45] [DOC: 9252851] ℹ️  Patient not found, creating new patient via API...
[02:11:45] [DOC: 9252851] ℹ️  Creating patient via API: Frank Ferreira
[02:11:46] [DOC: 9252851] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:11:46] ❌    ❌ Failed to create patient
[02:11:46] [DOC: 9252851] ℹ️  API push details saved for document 9252851
================================================================================
║                        Processing Document ID: 9252849                         ║
================================================================================
[02:11:46] ℹ️  Agency: Dartmouth HH
[02:11:46] ℹ️  Date: 04/22/2025
[02:11:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:11:49] [DOC: 9252849] ✅ Text extracted using pdfplumber (1293 chars)
[02:11:49] ✅    ✅ Text extracted using pdfplumber (1293 chars)
[02:11:49] 🔄 
🔄 Step 2: Extracting patient data...
[02:11:52] ℹ️  AI extracted raw sex value: 'F'
[02:11:52] ℹ️  AI extracted service line: 'RN'
[02:11:52] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[02:11:52] ℹ️  AI extracted diagnoses:
[02:11:52] ℹ️    - Diagnosis 1: ''
[02:11:52] ℹ️    - Diagnosis 2: ''
[02:11:52] ℹ️    - Diagnosis 3: ''
[02:11:52] ℹ️    - Diagnosis 4: ''
[02:11:52] ℹ️    - Diagnosis 5: ''
[02:11:52] ℹ️    - Diagnosis 6: ''
[02:11:52] ℹ️  Final extracted MRN: '651015'
[02:11:52] ℹ️  Final extracted Sex: 'FEMALE'
[02:11:52] ℹ️  Final extracted Service Line: 'RN'
[02:11:52] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[02:11:52] ✅ Patient data extraction completed successfully
[02:11:52] ✅    ✅ Patient data extracted successfully
[02:11:52] 📊 Patient Response
     └─ patientFName: A Shirley
     └─ patientLName: Jadlowe
     └─ dob: 01/19/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 651015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '05/23/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:11:52] ✅    ✅ Patient identified: A Shirley Jadlowe
[02:11:52] ✅    ✅ Patient name validation passed
[02:11:52] 🔄 
🔄 Step 3: Processing patient dates...
[02:11:52] [DOC: 9252849] ℹ️  DOB normalized: 01/19/1935
[02:11:52] [DOC: 9252849] ℹ️  Episode startOfCare normalized: 05/23/2024
[02:11:52] [DOC: 9252849] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[02:11:52] [DOC: 9252849] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[02:11:52] [DOC: 9252849] ✅ Patient date processing completed successfully
[02:11:52] ✅    ✅ Date processing completed
[02:11:52] 📊 Processed Patient Data
     └─ patientFName: A Shirley
     └─ patientLName: Jadlowe
     └─ dob: 01/19/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 651015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '05/23/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:11:52] 🔄 
🔄 Step 4: Extracting order data...
[02:11:54] ℹ️  Order extraction - MRN: ''
[02:11:54] ℹ️  Order extraction - Sex: 'FEMALE'
[02:11:54] ℹ️  Order extraction - Service Line: 'RN'
[02:11:54] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[02:11:54] ✅ Order data extraction completed successfully
[02:11:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:11:54] ℹ️  Using MRN from patient data: '651015'
[02:11:54] ℹ️  Service line consistent in both sources: 'RN'
[02:11:54] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[02:11:54] ✅ Patient name cross-validation successful
[02:11:54] ✅    ✅ Data merged successfully
[02:11:55] ✅    ✅ Order data extracted and validated
[02:11:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:11:55] [DOC: 9252849] ✅ Patient found in local cache: A Shirley Jadlowe, ID: f434f7e2-b2e3-4187-b677-c68e57142970
[02:11:55] ✅    ✅ Existing patient found with ID: f434f7e2-b2e3-4187-b677-c68e57142970
[02:11:55] 🔄 
🔄 Step 6: Pushing order to API...
[02:11:55] [DOC: 9252849] ℹ️  Pushing order via API for patient ID: f434f7e2-b2e3-4187-b677-c68e57142970
[02:11:57] [DOC: 9252849] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13843"}
[02:11:57] ❌    ❌ Failed to push order
[02:11:57] 🔄 
🔄 Step 7: Writing to CSV...
[02:11:57] [DOC: 9252849] ℹ️  Calculated age: 90 from DOB: 01/19/1935
[02:11:57] [DOC: 9252849] ℹ️  Service Line extracted: 'RN'
[02:11:57] [DOC: 9252849] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[02:11:57] [DOC: 9252849] ℹ️  Diagnosis codes being written:
[02:11:57] [DOC: 9252849] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:11:57] [DOC: 9252849] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:11:57] [DOC: 9252849] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:11:57] [DOC: 9252849] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:11:57] [DOC: 9252849] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:11:57] [DOC: 9252849] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:11:57] [DOC: 9252849] ✅ Patient data written to CSV: A Shirley Jadlowe | Sex: FEMALE | Age: 90 | Service: RN | Payer: Blue Cross Blue Shield | MRN: 651015
[02:11:57] ✅    ✅ Document 9252849 processed and saved successfully
[02:11:57] 🔄 
🔄 Step 8: Saving API details...
[02:11:57] [DOC: 9252849] ℹ️  API push details saved for document 9252849
[02:11:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252848                         ║
================================================================================
[02:11:57] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[02:11:57] ℹ️  Date: 04/22/2025
[02:11:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:11:59] [DOC: 9252848] ✅ Text extracted using pdfplumber (12117 chars)
[02:11:59] ✅    ✅ Text extracted using pdfplumber (12105 chars)
[02:11:59] 🔄 
🔄 Step 2: Extracting patient data...
[02:12:03] ℹ️  AI extracted raw sex value: 'M'
[02:12:03] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy, Skilled Nursing'
[02:12:03] ℹ️  AI extracted payer source: 'Medicare'
[02:12:03] ℹ️  AI extracted diagnoses:
[02:12:03] ℹ️    - Diagnosis 1: 'I69.398'
[02:12:03] ℹ️    - Diagnosis 2: 'R53.1'
[02:12:03] ℹ️    - Diagnosis 3: 'I69.322'
[02:12:03] ℹ️    - Diagnosis 4: 'E11.9'
[02:12:03] ℹ️    - Diagnosis 5: 'I11.0'
[02:12:03] ℹ️    - Diagnosis 6: 'I50.9'
[02:12:03] ℹ️  Final extracted MRN: 'MA241126016807'
[02:12:03] ℹ️  Final extracted Sex: 'MALE'
[02:12:03] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy, Skilled Nursing'
[02:12:03] ℹ️  Final extracted Payer Source: 'Medicare'
[02:12:03] ✅ Patient data extraction completed successfully
[02:12:03] ✅    ✅ Patient data extracted successfully
[02:12:03] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 96 Division St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: None
     └─ phoneNumber: (508) 997-0616
     └─ serviceLine: Physical Therapy, Occupational Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'I11.0', 'sixthDiagnosis': 'I50.9'}]
[02:12:03] ✅    ✅ Patient identified: Frank Ferreira
[02:12:03] ✅    ✅ Patient name validation passed
[02:12:03] 🔄 
🔄 Step 3: Processing patient dates...
[02:12:03] [DOC: 9252848] ℹ️  DOB normalized: 01/07/1968
[02:12:03] [DOC: 9252848] ℹ️  Episode startOfCare normalized: 04/12/2025
[02:12:03] [DOC: 9252848] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[02:12:03] [DOC: 9252848] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[02:12:03] [DOC: 9252848] ✅ Patient date processing completed successfully
[02:12:03] ✅    ✅ Date processing completed
[02:12:03] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Ferreira
     └─ dob: 01/07/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: MA241126016807
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 96 Division St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ phoneNumber: (508) 997-0616
     └─ serviceLine: Physical Therapy, Occupational Therapy, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'I69.322', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'I11.0', 'sixthDiagnosis': 'I50.9'}]
[02:12:03] 🔄 
🔄 Step 4: Extracting order data...
[02:12:05] ℹ️  Order extraction - MRN: 'MA241126016807'
[02:12:05] ℹ️  Order extraction - Sex: 'MALE'
[02:12:05] ℹ️  Order extraction - Service Line: 'PT, OT, Skilled Nursing'
[02:12:05] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:12:05] ✅ Order data extraction completed successfully
[02:12:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:12:05] ℹ️  Using MRN from patient data: 'MA241126016807' over 'MA241126016807'
[02:12:05] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy, Skilled Nursing' + Order='PT, OT, Skilled Nursing' = 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[02:12:05] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:12:05] ✅ Patient name cross-validation successful
[02:12:05] ✅    ✅ Data merged successfully
[02:12:07] ✅    ✅ Order data extracted and validated
[02:12:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:12:23] [DOC: 9252848] ℹ️  Patient not found in cache or API: Frank Ferreira
[02:12:23] [DOC: 9252848] ℹ️  Patient not found, creating new patient via API...
[02:12:23] [DOC: 9252848] ℹ️  Creating patient via API: Frank Ferreira
[02:12:24] [DOC: 9252848] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:12:24] ❌    ❌ Failed to create patient
[02:12:24] [DOC: 9252848] ℹ️  API push details saved for document 9252848
================================================================================
║                        Processing Document ID: 9252847                         ║
================================================================================
[02:12:24] ℹ️  Agency: Dartmouth HH
[02:12:24] ℹ️  Date: 04/22/2025
[02:12:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:12:26] [DOC: 9252847] ✅ Text extracted using pdfplumber (1363 chars)
[02:12:26] ✅    ✅ Text extracted using pdfplumber (1363 chars)
[02:12:26] 🔄 
🔄 Step 2: Extracting patient data...
[02:12:29] ℹ️  AI extracted raw sex value: 'F'
[02:12:29] ℹ️  AI extracted service line: 'PT'
[02:12:29] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[02:12:29] ℹ️  AI extracted diagnoses:
[02:12:29] ℹ️    - Diagnosis 1: ''
[02:12:29] ℹ️    - Diagnosis 2: ''
[02:12:29] ℹ️    - Diagnosis 3: ''
[02:12:29] ℹ️    - Diagnosis 4: ''
[02:12:29] ℹ️    - Diagnosis 5: ''
[02:12:29] ℹ️    - Diagnosis 6: ''
[02:12:29] ℹ️  Final extracted MRN: '667011'
[02:12:29] ℹ️  Final extracted Sex: 'FEMALE'
[02:12:29] ℹ️  Final extracted Service Line: 'PT'
[02:12:29] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[02:12:29] ✅ Patient data extraction completed successfully
[02:12:29] ✅    ✅ Patient data extracted successfully
[02:12:29] 📊 Patient Response
     └─ patientFName: Linda
     └─ patientLName: Hotte
     └─ dob: 09/14/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 667011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '02/23/2025', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:12:29] ✅    ✅ Patient identified: Linda Hotte
[02:12:29] ✅    ✅ Patient name validation passed
[02:12:29] 🔄 
🔄 Step 3: Processing patient dates...
[02:12:29] [DOC: 9252847] ℹ️  DOB normalized: 09/14/1952
[02:12:29] [DOC: 9252847] ℹ️  Episode startOfCare normalized: 02/23/2025
[02:12:29] [DOC: 9252847] ℹ️  Episode startOfEpisode normalized: 02/23/2025
[02:12:29] [DOC: 9252847] ℹ️  Episode endOfEpisode normalized: 04/23/2025
[02:12:29] [DOC: 9252847] ✅ Patient date processing completed successfully
[02:12:29] ✅    ✅ Date processing completed
[02:12:29] 📊 Processed Patient Data
     └─ patientFName: Linda
     └─ patientLName: Hotte
     └─ dob: 09/14/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 667011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '02/23/2025', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:12:29] 🔄 
🔄 Step 4: Extracting order data...
[02:12:31] ℹ️  Order extraction - MRN: ''
[02:12:31] ℹ️  Order extraction - Sex: 'FEMALE'
[02:12:31] ℹ️  Order extraction - Service Line: 'PT'
[02:12:31] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[02:12:31] ✅ Order data extraction completed successfully
[02:12:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:12:31] ℹ️  Using MRN from patient data: '667011'
[02:12:31] ℹ️  Service line consistent in both sources: 'PT'
[02:12:31] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[02:12:31] ✅ Patient name cross-validation successful
[02:12:31] ✅    ✅ Data merged successfully
[02:12:33] ✅    ✅ Order data extracted and validated
[02:12:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:12:50] [DOC: 9252847] ℹ️  Patient not found in cache or API: Linda Hotte
[02:12:50] [DOC: 9252847] ℹ️  Patient not found, creating new patient via API...
[02:12:50] [DOC: 9252847] ℹ️  Creating patient via API: Linda Hotte
[02:12:51] [DOC: 9252847] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:12:51] ❌    ❌ Failed to create patient
[02:12:51] [DOC: 9252847] ℹ️  API push details saved for document 9252847
================================================================================
║                        Processing Document ID: 9252844                         ║
================================================================================
[02:12:51] ℹ️  Agency: Dartmouth HH
[02:12:51] ℹ️  Date: 04/22/2025
[02:12:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:12:57] [DOC: 9252844] ✅ Text extracted using pdfplumber (1664 chars)
[02:12:57] ✅    ✅ Text extracted using pdfplumber (1664 chars)
[02:12:57] 🔄 
🔄 Step 2: Extracting patient data...
[02:12:59] ℹ️  AI extracted raw sex value: 'F'
[02:12:59] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:12:59] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[02:12:59] ℹ️  AI extracted diagnoses:
[02:12:59] ℹ️    - Diagnosis 1: ''
[02:12:59] ℹ️    - Diagnosis 2: ''
[02:12:59] ℹ️    - Diagnosis 3: ''
[02:12:59] ℹ️    - Diagnosis 4: ''
[02:12:59] ℹ️    - Diagnosis 5: ''
[02:12:59] ℹ️    - Diagnosis 6: ''
[02:12:59] ℹ️  Final extracted MRN: '6201015'
[02:12:59] ℹ️  Final extracted Sex: 'FEMALE'
[02:12:59] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:12:59] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[02:12:59] ✅ Patient data extraction completed successfully
[02:12:59] ✅    ✅ Patient data extracted successfully
[02:12:59] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Laborinho
     └─ dob: 02/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6201015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 103 Fair St, Apt 2
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:12:59] ✅    ✅ Patient identified: Maria Laborinho
[02:12:59] ✅    ✅ Patient name validation passed
[02:12:59] 🔄 
🔄 Step 3: Processing patient dates...
[02:12:59] [DOC: 9252844] ℹ️  DOB normalized: 02/08/1951
[02:12:59] [DOC: 9252844] ℹ️  Episode startOfCare normalized: 03/13/2025
[02:12:59] [DOC: 9252844] ℹ️  Episode startOfEpisode normalized: 04/13/2025
[02:12:59] [DOC: 9252844] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[02:12:59] [DOC: 9252844] ✅ Patient date processing completed successfully
[02:12:59] ✅    ✅ Date processing completed
[02:12:59] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Laborinho
     └─ dob: 02/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6201015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 103 Fair St, Apt 2
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:12:59] 🔄 
🔄 Step 4: Extracting order data...
[02:13:02] ℹ️  Order extraction - MRN: ''
[02:13:02] ℹ️  Order extraction - Sex: 'FEMALE'
[02:13:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:13:02] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[02:13:02] ✅ Order data extraction completed successfully
[02:13:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:13:02] ℹ️  Using MRN from patient data: '6201015'
[02:13:02] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:13:02] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[02:13:02] ✅ Patient name cross-validation successful
[02:13:02] ✅    ✅ Data merged successfully
[02:13:03] ✅    ✅ Order data extracted and validated
[02:13:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:13:26] [DOC: 9252844] ℹ️  Patient not found in cache or API: Maria Laborinho
[02:13:26] [DOC: 9252844] ℹ️  Patient not found, creating new patient via API...
[02:13:26] [DOC: 9252844] ℹ️  Creating patient via API: Maria Laborinho
[02:13:27] [DOC: 9252844] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:13:27] ❌    ❌ Failed to create patient
[02:13:27] [DOC: 9252844] ℹ️  API push details saved for document 9252844
================================================================================
║                        Processing Document ID: 9252842                         ║
================================================================================
[02:13:27] ℹ️  Agency: Dartmouth HH
[02:13:27] ℹ️  Date: 04/22/2025
[02:13:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:13:29] [DOC: 9252842] ✅ Text extracted using pdfplumber (1098 chars)
[02:13:29] ✅    ✅ Text extracted using pdfplumber (1098 chars)
[02:13:29] 🔄 
🔄 Step 2: Extracting patient data...
[02:13:32] ℹ️  AI extracted raw sex value: 'F'
[02:13:32] ℹ️  AI extracted service line: 'PT'
[02:13:32] ℹ️  AI extracted payer source: 'Medicare'
[02:13:32] ℹ️  AI extracted diagnoses:
[02:13:32] ℹ️    - Diagnosis 1: 'None'
[02:13:32] ℹ️    - Diagnosis 2: 'None'
[02:13:32] ℹ️    - Diagnosis 3: 'None'
[02:13:32] ℹ️    - Diagnosis 4: 'None'
[02:13:32] ℹ️    - Diagnosis 5: 'None'
[02:13:32] ℹ️    - Diagnosis 6: 'None'
[02:13:32] ℹ️  Final extracted MRN: '1183008'
[02:13:32] ℹ️  Final extracted Sex: 'FEMALE'
[02:13:32] ℹ️  Final extracted Service Line: 'PT'
[02:13:32] ℹ️  Final extracted Payer Source: 'Medicare'
[02:13:32] ✅ Patient data extraction completed successfully
[02:13:32] ✅    ✅ Patient data extracted successfully
[02:13:32] 📊 Patient Response
     └─ patientFName: Jean
     └─ patientLName: Silver
     └─ dob: 02/12/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1183008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:13:32] ✅    ✅ Patient identified: Jean Silver
[02:13:32] ✅    ✅ Patient name validation passed
[02:13:32] 🔄 
🔄 Step 3: Processing patient dates...
[02:13:32] [DOC: 9252842] ℹ️  DOB normalized: 02/12/1931
[02:13:32] [DOC: 9252842] ℹ️  Episode startOfCare normalized: 03/29/2025
[02:13:32] [DOC: 9252842] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[02:13:32] [DOC: 9252842] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[02:13:32] [DOC: 9252842] ✅ Patient date processing completed successfully
[02:13:32] ✅    ✅ Date processing completed
[02:13:32] 📊 Processed Patient Data
     └─ patientFName: Jean
     └─ patientLName: Silver
     └─ dob: 02/12/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1183008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025'}]
[02:13:32] 🔄 
🔄 Step 4: Extracting order data...
[02:13:34] ℹ️  Order extraction - MRN: ''
[02:13:34] ℹ️  Order extraction - Sex: 'FEMALE'
[02:13:34] ℹ️  Order extraction - Service Line: 'PT'
[02:13:34] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:13:34] ✅ Order data extraction completed successfully
[02:13:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:13:34] ℹ️  Using MRN from patient data: '1183008'
[02:13:34] ℹ️  Service line consistent in both sources: 'PT'
[02:13:34] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:13:34] ✅ Patient name cross-validation successful
[02:13:34] ✅    ✅ Data merged successfully
[02:13:35] ✅    ✅ Order data extracted and validated
[02:13:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:14:10] [DOC: 9252842] ℹ️  Patient not found in cache or API: Jean Silver
[02:14:10] [DOC: 9252842] ℹ️  Patient not found, creating new patient via API...
[02:14:10] [DOC: 9252842] ℹ️  Creating patient via API: Jean Silver
[02:14:11] [DOC: 9252842] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:14:11] ❌    ❌ Failed to create patient
[02:14:11] [DOC: 9252842] ℹ️  API push details saved for document 9252842
================================================================================
║                        Processing Document ID: 9252837                         ║
================================================================================
[02:14:11] ℹ️  Agency: Dartmouth HH
[02:14:11] ℹ️  Date: 04/22/2025
[02:14:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:14:13] [DOC: 9252837] ✅ Text extracted using pdfplumber (1115 chars)
[02:14:13] ✅    ✅ Text extracted using pdfplumber (1115 chars)
[02:14:13] 🔄 
🔄 Step 2: Extracting patient data...
[02:14:17] ℹ️  AI extracted raw sex value: 'F'
[02:14:17] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:14:17] ℹ️  AI extracted payer source: 'Medicare'
[02:14:17] ℹ️  AI extracted diagnoses:
[02:14:17] ℹ️    - Diagnosis 1: 'None'
[02:14:17] ℹ️    - Diagnosis 2: 'None'
[02:14:17] ℹ️    - Diagnosis 3: 'None'
[02:14:17] ℹ️    - Diagnosis 4: 'None'
[02:14:17] ℹ️    - Diagnosis 5: 'None'
[02:14:17] ℹ️    - Diagnosis 6: 'None'
[02:14:17] ℹ️  Final extracted MRN: '6203015'
[02:14:17] ℹ️  Final extracted Sex: 'FEMALE'
[02:14:17] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:14:17] ℹ️  Final extracted Payer Source: 'Medicare'
[02:14:17] ✅ Patient data extraction completed successfully
[02:14:17] ✅    ✅ Patient data extracted successfully
[02:14:17] 📊 Patient Response
     └─ patientFName: Sylvia
     └─ patientLName: Lemieux
     └─ dob: 06/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6203015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '04/21/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:14:17] ✅    ✅ Patient identified: Sylvia Lemieux
[02:14:17] ✅    ✅ Patient name validation passed
[02:14:17] 🔄 
🔄 Step 3: Processing patient dates...
[02:14:17] [DOC: 9252837] ℹ️  DOB normalized: 06/08/1941
[02:14:17] [DOC: 9252837] ℹ️  Episode startOfCare normalized: 03/14/2025
[02:14:17] [DOC: 9252837] ℹ️  Episode startOfEpisode normalized: 04/21/2025
[02:14:17] [DOC: 9252837] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[02:14:17] [DOC: 9252837] ✅ Patient date processing completed successfully
[02:14:17] ✅    ✅ Date processing completed
[02:14:17] 📊 Processed Patient Data
     └─ patientFName: Sylvia
     └─ patientLName: Lemieux
     └─ dob: 06/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6203015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '04/21/2025', 'endOfEpisode': '05/12/2025'}]
[02:14:17] 🔄 
🔄 Step 4: Extracting order data...
[02:14:20] ℹ️  Order extraction - MRN: ''
[02:14:20] ℹ️  Order extraction - Sex: 'FEMALE'
[02:14:20] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:14:20] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:14:20] ✅ Order data extraction completed successfully
[02:14:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:14:20] ℹ️  Using MRN from patient data: '6203015'
[02:14:20] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:14:20] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:14:20] ✅ Patient name cross-validation successful
[02:14:20] ✅    ✅ Data merged successfully
[02:14:21] ✅    ✅ Order data extracted and validated
[02:14:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:14:43] [DOC: 9252837] ℹ️  Patient not found in cache or API: Sylvia Lemieux
[02:14:43] [DOC: 9252837] ℹ️  Patient not found, creating new patient via API...
[02:14:43] [DOC: 9252837] ℹ️  Creating patient via API: Sylvia Lemieux
[02:14:45] [DOC: 9252837] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:14:45] ❌    ❌ Failed to create patient
[02:14:45] [DOC: 9252837] ℹ️  API push details saved for document 9252837
================================================================================
║                        Processing Document ID: 9252834                         ║
================================================================================
[02:14:45] ℹ️  Agency: Dartmouth HH
[02:14:45] ℹ️  Date: 04/22/2025
[02:14:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:14:49] [DOC: 9252834] ✅ Text extracted using pdfplumber (5095 chars)
[02:14:49] ✅    ✅ Text extracted using pdfplumber (5095 chars)
[02:14:49] 🔄 
🔄 Step 2: Extracting patient data...
[02:14:52] ℹ️  AI extracted raw sex value: 'M'
[02:14:52] ℹ️  AI extracted service line: 'PT'
[02:14:52] ℹ️  AI extracted payer source: 'Medicare'
[02:14:52] ℹ️  AI extracted diagnoses:
[02:14:52] ℹ️    - Diagnosis 1: 'PAD'
[02:14:52] ℹ️    - Diagnosis 2: 'atherosclerosis of the arteries of the extremities'
[02:14:52] ℹ️    - Diagnosis 3: 'None'
[02:14:52] ℹ️    - Diagnosis 4: 'None'
[02:14:52] ℹ️    - Diagnosis 5: 'None'
[02:14:52] ℹ️    - Diagnosis 6: 'None'
[02:14:52] ℹ️  Final extracted MRN: '6208015'
[02:14:52] ℹ️  Final extracted Sex: 'MALE'
[02:14:52] ℹ️  Final extracted Service Line: 'PT'
[02:14:52] ℹ️  Final extracted Payer Source: 'Medicare'
[02:14:52] ✅ Patient data extraction completed successfully
[02:14:52] ✅    ✅ Patient data extracted successfully
[02:14:52] 📊 Patient Response
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 6208015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1013 Marlborough St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '02/21/2025', 'firstDiagnosis': 'PAD', 'secondDiagnosis': 'atherosclerosis of the arteries of the extremities', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:14:52] ✅    ✅ Patient identified: Stephen Hanna Jr,
[02:14:52] ✅    ✅ Patient name validation passed
[02:14:52] 🔄 
🔄 Step 3: Processing patient dates...
[02:14:52] [DOC: 9252834] ℹ️  DOB normalized: 03/11/1936
[02:14:52] [DOC: 9252834] ℹ️  Episode startOfCare normalized: 03/15/2025
[02:14:52] [DOC: 9252834] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[02:14:52] [DOC: 9252834] ℹ️  Episode endOfEpisode normalized: 02/21/2025
[02:14:52] [DOC: 9252834] ✅ Patient date processing completed successfully
[02:14:52] ✅    ✅ Date processing completed
[02:14:52] 📊 Processed Patient Data
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 6208015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1013 Marlborough St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '02/21/2025', 'firstDiagnosis': 'PAD', 'secondDiagnosis': 'atherosclerosis of the arteries of the extremities'}]
[02:14:52] 🔄 
🔄 Step 4: Extracting order data...
[02:14:54] ℹ️  Order extraction - MRN: ''
[02:14:54] ℹ️  Order extraction - Sex: 'MALE'
[02:14:54] ℹ️  Order extraction - Service Line: 'PT'
[02:14:54] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:14:54] ✅ Order data extraction completed successfully
[02:14:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:14:54] ℹ️  Using MRN from patient data: '6208015'
[02:14:54] ℹ️  Service line consistent in both sources: 'PT'
[02:14:54] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:14:54] ✅ Patient name cross-validation successful
[02:14:54] ✅    ✅ Data merged successfully
[02:14:55] ✅    ✅ Order data extracted and validated
[02:14:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:14:55] [DOC: 9252834] ✅ Patient found in local cache: Stephen Hanna Jr,, ID: 38583918-d125-4291-a4c2-8551b1d02929
[02:14:55] ✅    ✅ Existing patient found with ID: 38583918-d125-4291-a4c2-8551b1d02929
[02:14:55] 🔄 
🔄 Step 6: Pushing order to API...
[02:14:55] [DOC: 9252834] ℹ️  Pushing order via API for patient ID: 38583918-d125-4291-a4c2-8551b1d02929
[02:14:57] [DOC: 9252834] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:14:57] ❌    ❌ Failed to push order
[02:14:57] 🔄 
🔄 Step 7: Writing to CSV...
[02:14:57] [DOC: 9252834] ℹ️  Calculated age: 89 from DOB: 03/11/1936
[02:14:57] [DOC: 9252834] ℹ️  Service Line extracted: 'PT'
[02:14:57] [DOC: 9252834] ℹ️  Payer Source extracted: 'Medicare'
[02:14:57] [DOC: 9252834] ℹ️  Diagnosis codes being written:
[02:14:57] [DOC: 9252834] ℹ️    - Latest_Episode_Firstdiagnosis: 'PAD'
[02:14:57] [DOC: 9252834] ℹ️    - Latest_Episode_Seconddiagnosis: 'atherosclerosis of the arteries of the extremities'
[02:14:57] [DOC: 9252834] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:14:57] [DOC: 9252834] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:14:57] [DOC: 9252834] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:14:57] [DOC: 9252834] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:14:57] [DOC: 9252834] ✅ Patient data written to CSV: Stephen Hanna Jr, | Sex: MALE | Age: 89 | Service: PT | Payer: Medicare | MRN: 6208015
[02:14:57] ✅    ✅ Document 9252834 processed and saved successfully
[02:14:57] 🔄 
🔄 Step 8: Saving API details...
[02:14:57] [DOC: 9252834] ℹ️  API push details saved for document 9252834
[02:14:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252801                         ║
================================================================================
[02:14:57] ℹ️  Agency: Dartmouth HH
[02:14:57] ℹ️  Date: 04/22/2025
[02:14:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:14:59] [DOC: 9252801] ✅ Text extracted using pdfplumber (1004 chars)
[02:14:59] ✅    ✅ Text extracted using pdfplumber (1004 chars)
[02:14:59] 🔄 
🔄 Step 2: Extracting patient data...
[02:15:02] ℹ️  AI extracted raw sex value: 'F'
[02:15:02] ℹ️  AI extracted service line: 'HHA'
[02:15:02] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[02:15:02] ℹ️  AI extracted diagnoses:
[02:15:02] ℹ️    - Diagnosis 1: ''
[02:15:02] ℹ️    - Diagnosis 2: ''
[02:15:02] ℹ️    - Diagnosis 3: ''
[02:15:02] ℹ️    - Diagnosis 4: ''
[02:15:02] ℹ️    - Diagnosis 5: ''
[02:15:02] ℹ️    - Diagnosis 6: ''
[02:15:02] ℹ️  Final extracted MRN: '6133015'
[02:15:02] ℹ️  Final extracted Sex: 'FEMALE'
[02:15:02] ℹ️  Final extracted Service Line: 'HHA'
[02:15:02] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[02:15:02] ✅ Patient data extraction completed successfully
[02:15:02] ✅    ✅ Patient data extracted successfully
[02:15:02] 📊 Patient Response
     └─ patientFName: Jacqueline
     └─ patientLName: DeTerra
     └─ dob: 11/04/1976
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6133015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:15:02] ✅    ✅ Patient identified: Jacqueline DeTerra
[02:15:02] ✅    ✅ Patient name validation passed
[02:15:02] 🔄 
🔄 Step 3: Processing patient dates...
[02:15:02] [DOC: 9252801] ℹ️  DOB normalized: 11/04/1976
[02:15:02] [DOC: 9252801] ℹ️  Episode startOfCare normalized: 04/03/2025
[02:15:02] [DOC: 9252801] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[02:15:02] [DOC: 9252801] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[02:15:02] [DOC: 9252801] ✅ Patient date processing completed successfully
[02:15:02] ✅    ✅ Date processing completed
[02:15:02] 📊 Processed Patient Data
     └─ patientFName: Jacqueline
     └─ patientLName: DeTerra
     └─ dob: 11/04/1976
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6133015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:15:02] 🔄 
🔄 Step 4: Extracting order data...
[02:15:05] ℹ️  Order extraction - MRN: ''
[02:15:05] ℹ️  Order extraction - Sex: 'FEMALE'
[02:15:05] ℹ️  Order extraction - Service Line: ''
[02:15:05] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[02:15:05] ✅ Order data extraction completed successfully
[02:15:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:15:05] ℹ️  Using MRN from patient data: '6133015'
[02:15:05] ℹ️  Using service line from patient data: 'HHA'
[02:15:05] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[02:15:05] ✅ Patient name cross-validation successful
[02:15:05] ✅    ✅ Data merged successfully
[02:15:06] ✅    ✅ Order data extracted and validated
[02:15:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:15:06] [DOC: 9252801] ✅ Patient found in local cache: Jacqueline DeTerra, ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[02:15:06] ✅    ✅ Existing patient found with ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[02:15:06] 🔄 
🔄 Step 6: Pushing order to API...
[02:15:06] [DOC: 9252801] ℹ️  Pushing order via API for patient ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[02:15:07] [DOC: 9252801] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:15:07] ❌    ❌ Failed to push order
[02:15:07] 🔄 
🔄 Step 7: Writing to CSV...
[02:15:07] [DOC: 9252801] ℹ️  Calculated age: 48 from DOB: 11/04/1976
[02:15:07] [DOC: 9252801] ℹ️  Service Line extracted: 'HHA'
[02:15:07] [DOC: 9252801] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[02:15:07] [DOC: 9252801] ℹ️  Diagnosis codes being written:
[02:15:07] [DOC: 9252801] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:15:07] [DOC: 9252801] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:15:07] [DOC: 9252801] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:15:07] [DOC: 9252801] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:15:07] [DOC: 9252801] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:15:07] [DOC: 9252801] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:15:07] [DOC: 9252801] ✅ Patient data written to CSV: Jacqueline DeTerra | Sex: FEMALE | Age: 48 | Service: HHA | Payer: Blue Cross Blue Shield | MRN: 6133015
[02:15:07] ✅    ✅ Document 9252801 processed and saved successfully
[02:15:07] 🔄 
🔄 Step 8: Saving API details...
[02:15:07] [DOC: 9252801] ℹ️  API push details saved for document 9252801
[02:15:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252797                         ║
================================================================================
[02:15:07] ℹ️  Agency: Dartmouth HH
[02:15:07] ℹ️  Date: 04/22/2025
[02:15:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:15:10] [DOC: 9252797] ✅ Text extracted using pdfplumber (4800 chars)
[02:15:10] ✅    ✅ Text extracted using pdfplumber (4800 chars)
[02:15:10] 🔄 
🔄 Step 2: Extracting patient data...
[02:15:13] ℹ️  AI extracted raw sex value: 'M'
[02:15:13] ℹ️  AI extracted service line: 'Physical Therapy'
[02:15:13] ℹ️  AI extracted payer source: 'Medicare'
[02:15:13] ℹ️  AI extracted diagnoses:
[02:15:13] ℹ️    - Diagnosis 1: ''
[02:15:13] ℹ️    - Diagnosis 2: ''
[02:15:13] ℹ️    - Diagnosis 3: ''
[02:15:13] ℹ️    - Diagnosis 4: ''
[02:15:13] ℹ️    - Diagnosis 5: ''
[02:15:13] ℹ️    - Diagnosis 6: ''
[02:15:13] ℹ️  Final extracted MRN: '5642015'
[02:15:13] ℹ️  Final extracted Sex: 'MALE'
[02:15:13] ℹ️  Final extracted Service Line: 'Physical Therapy'
[02:15:13] ℹ️  Final extracted Payer Source: 'Medicare'
[02:15:13] ✅ Patient data extraction completed successfully
[02:15:13] ✅    ✅ Patient data extracted successfully
[02:15:13] 📊 Patient Response
     └─ patientFName: Paul
     └─ patientLName: Los
     └─ dob: 12/28/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5642015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2025', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:15:13] ✅    ✅ Patient identified: Paul Los
[02:15:13] ✅    ✅ Patient name validation passed
[02:15:13] 🔄 
🔄 Step 3: Processing patient dates...
[02:15:13] [DOC: 9252797] ℹ️  DOB normalized: 12/28/1944
[02:15:13] [DOC: 9252797] ℹ️  Episode startOfCare normalized: 01/04/2025
[02:15:13] [DOC: 9252797] ℹ️  Episode startOfEpisode normalized: 03/05/2025
[02:15:13] [DOC: 9252797] ℹ️  Episode endOfEpisode normalized: 05/03/2025
[02:15:13] [DOC: 9252797] ✅ Patient date processing completed successfully
[02:15:13] ✅    ✅ Date processing completed
[02:15:13] 📊 Processed Patient Data
     └─ patientFName: Paul
     └─ patientLName: Los
     └─ dob: 12/28/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5642015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2025', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:15:13] 🔄 
🔄 Step 4: Extracting order data...
[02:15:16] ℹ️  Order extraction - MRN: ''
[02:15:16] ℹ️  Order extraction - Sex: 'MALE'
[02:15:16] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[02:15:16] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:15:16] ✅ Order data extraction completed successfully
[02:15:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:15:16] ℹ️  Using MRN from patient data: '5642015'
[02:15:16] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[02:15:16] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:15:16] ✅ Patient name cross-validation successful
[02:15:16] ✅    ✅ Data merged successfully
[02:15:17] ✅    ✅ Order data extracted and validated
[02:15:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:15:54] [DOC: 9252797] ℹ️  Patient not found in cache or API: Paul Los
[02:15:54] [DOC: 9252797] ℹ️  Patient not found, creating new patient via API...
[02:15:54] [DOC: 9252797] ℹ️  Creating patient via API: Paul Los
[02:15:56] [DOC: 9252797] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:15:56] ❌    ❌ Failed to create patient
[02:15:56] [DOC: 9252797] ℹ️  API push details saved for document 9252797
================================================================================
║                        Processing Document ID: 9252793                         ║
================================================================================
[02:15:56] ℹ️  Agency: Dartmouth HH
[02:15:56] ℹ️  Date: 04/22/2025
[02:15:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:15:58] [DOC: 9252793] ✅ Text extracted using pdfplumber (2281 chars)
[02:15:58] ✅    ✅ Text extracted using pdfplumber (2281 chars)
[02:15:58] 🔄 
🔄 Step 2: Extracting patient data...
[02:16:01] ℹ️  AI extracted raw sex value: 'F'
[02:16:01] ℹ️  AI extracted service line: 'Skilled Nursing, LPN, RN'
[02:16:01] ℹ️  AI extracted payer source: 'Medicare'
[02:16:01] ℹ️  AI extracted diagnoses:
[02:16:01] ℹ️    - Diagnosis 1: ''
[02:16:01] ℹ️    - Diagnosis 2: ''
[02:16:01] ℹ️    - Diagnosis 3: ''
[02:16:01] ℹ️    - Diagnosis 4: ''
[02:16:01] ℹ️    - Diagnosis 5: ''
[02:16:01] ℹ️    - Diagnosis 6: ''
[02:16:01] ℹ️  Final extracted MRN: '2496015'
[02:16:01] ℹ️  Final extracted Sex: 'FEMALE'
[02:16:01] ℹ️  Final extracted Service Line: 'Skilled Nursing, LPN, RN'
[02:16:01] ℹ️  Final extracted Payer Source: 'Medicare'
[02:16:01] ✅ Patient data extraction completed successfully
[02:16:01] ✅    ✅ Patient data extracted successfully
[02:16:01] 📊 Patient Response
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, LPN, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:16:01] ✅    ✅ Patient identified: Dana Theodore
[02:16:01] ✅    ✅ Patient name validation passed
[02:16:01] 🔄 
🔄 Step 3: Processing patient dates...
[02:16:01] [DOC: 9252793] ℹ️  DOB normalized: 03/16/1954
[02:16:01] [DOC: 9252793] ℹ️  Episode startOfCare normalized: 03/02/2025
[02:16:01] [DOC: 9252793] ℹ️  Episode startOfEpisode normalized: 03/02/2025
[02:16:01] [DOC: 9252793] ℹ️  Episode endOfEpisode normalized: 04/30/2025
[02:16:01] [DOC: 9252793] ✅ Patient date processing completed successfully
[02:16:01] ✅    ✅ Date processing completed
[02:16:01] 📊 Processed Patient Data
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, LPN, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:16:01] 🔄 
🔄 Step 4: Extracting order data...
[02:16:03] ℹ️  Order extraction - MRN: ''
[02:16:03] ℹ️  Order extraction - Sex: 'FEMALE'
[02:16:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:16:03] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:16:03] ✅ Order data extraction completed successfully
[02:16:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:16:03] ℹ️  Using MRN from patient data: '2496015'
[02:16:03] ℹ️  Combined service lines: Patient='Skilled Nursing, LPN, RN' + Order='Skilled Nursing' = 'LPN, RN, Skilled Nursing'
[02:16:03] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:16:03] ✅ Patient name cross-validation successful
[02:16:03] ✅    ✅ Data merged successfully
[02:16:05] ✅    ✅ Order data extracted and validated
[02:16:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:16:05] [DOC: 9252793] ✅ Patient found in local cache: Dana Theodore, ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[02:16:05] ✅    ✅ Existing patient found with ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[02:16:05] 🔄 
🔄 Step 6: Pushing order to API...
[02:16:05] [DOC: 9252793] ℹ️  Pushing order via API for patient ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[02:16:06] [DOC: 9252793] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:16:06] ❌    ❌ Failed to push order
[02:16:06] 🔄 
🔄 Step 7: Writing to CSV...
[02:16:06] [DOC: 9252793] ℹ️  Calculated age: 71 from DOB: 03/16/1954
[02:16:06] [DOC: 9252793] ℹ️  Service Line extracted: 'LPN, RN, Skilled Nursing'
[02:16:06] [DOC: 9252793] ℹ️  Payer Source extracted: 'Medicare'
[02:16:06] [DOC: 9252793] ℹ️  Diagnosis codes being written:
[02:16:06] [DOC: 9252793] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:16:06] [DOC: 9252793] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:16:06] [DOC: 9252793] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:16:06] [DOC: 9252793] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:16:06] [DOC: 9252793] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:16:06] [DOC: 9252793] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:16:06] [DOC: 9252793] ✅ Patient data written to CSV: Dana Theodore | Sex: FEMALE | Age: 71 | Service: LPN, RN, Skilled Nursing | Payer: Medicare | MRN: 2496015
[02:16:06] ✅    ✅ Document 9252793 processed and saved successfully
[02:16:06] 🔄 
🔄 Step 8: Saving API details...
[02:16:06] [DOC: 9252793] ℹ️  API push details saved for document 9252793
[02:16:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252784                         ║
================================================================================
[02:16:06] ℹ️  Agency: Dartmouth HH
[02:16:06] ℹ️  Date: 04/22/2025
[02:16:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:16:08] [DOC: 9252784] ✅ Text extracted using pdfplumber (4798 chars)
[02:16:08] ✅    ✅ Text extracted using pdfplumber (4798 chars)
[02:16:08] 🔄 
🔄 Step 2: Extracting patient data...
[02:16:13] ℹ️  AI extracted raw sex value: 'F'
[02:16:13] ℹ️  AI extracted service line: 'PT'
[02:16:13] ℹ️  AI extracted payer source: 'Medicare'
[02:16:13] ℹ️  AI extracted diagnoses:
[02:16:13] ℹ️    - Diagnosis 1: 'RSV'
[02:16:13] ℹ️    - Diagnosis 2: ''
[02:16:13] ℹ️    - Diagnosis 3: ''
[02:16:13] ℹ️    - Diagnosis 4: ''
[02:16:13] ℹ️    - Diagnosis 5: ''
[02:16:13] ℹ️    - Diagnosis 6: ''
[02:16:13] ℹ️  Final extracted MRN: '5915015'
[02:16:13] ℹ️  Final extracted Sex: 'FEMALE'
[02:16:13] ℹ️  Final extracted Service Line: 'PT'
[02:16:13] ℹ️  Final extracted Payer Source: 'Medicare'
[02:16:13] ✅ Patient data extraction completed successfully
[02:16:13] ✅    ✅ Patient data extracted successfully
[02:16:13] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '01/25/2025', 'firstDiagnosis': 'RSV', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': None, 'startOfEpisode': '02/14/2025', 'endOfEpisode': '02/24/2025', 'firstDiagnosis': 'Acute on chronic diastolic HF', 'secondDiagnosis': 'afib', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': None, 'startOfEpisode': '03/10/2025', 'endOfEpisode': '03/12/2025', 'firstDiagnosis': 'hypokalemia', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:16:13] ✅    ✅ Patient identified: Suzanne Fawcett
[02:16:13] ✅    ✅ Patient name validation passed
[02:16:13] 🔄 
🔄 Step 3: Processing patient dates...
[02:16:13] [DOC: 9252784] ℹ️  DOB normalized: 12/08/1939
[02:16:13] [DOC: 9252784] ℹ️  Episode startOfCare normalized: 01/26/2025
[02:16:13] [DOC: 9252784] ℹ️  Episode startOfEpisode normalized: 01/18/2025
[02:16:13] [DOC: 9252784] ℹ️  Episode endOfEpisode normalized: 01/25/2025
[02:16:13] [DOC: 9252784] ✅ Patient date processing completed successfully
[02:16:13] ✅    ✅ Date processing completed
[02:16:13] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '01/25/2025', 'firstDiagnosis': 'RSV', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '02/24/2025', 'firstDiagnosis': 'Acute on chronic diastolic HF', 'secondDiagnosis': 'afib', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}, {'startOfCare': '', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '03/12/2025', 'firstDiagnosis': 'hypokalemia', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:16:13] 🔄 
🔄 Step 4: Extracting order data...
[02:16:15] ℹ️  Order extraction - MRN: ''
[02:16:15] ℹ️  Order extraction - Sex: 'FEMALE'
[02:16:15] ℹ️  Order extraction - Service Line: 'PT'
[02:16:15] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:16:15] ✅ Order data extraction completed successfully
[02:16:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:16:15] ℹ️  Using MRN from patient data: '5915015'
[02:16:15] ℹ️  Service line consistent in both sources: 'PT'
[02:16:15] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:16:15] ✅ Patient name cross-validation successful
[02:16:15] ✅    ✅ Data merged successfully
[02:16:17] ✅    ✅ Order data extracted and validated
[02:16:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:16:41] [DOC: 9252784] ℹ️  Patient not found in cache or API: Suzanne Fawcett
[02:16:41] [DOC: 9252784] ℹ️  Patient not found, creating new patient via API...
[02:16:41] [DOC: 9252784] ℹ️  Creating patient via API: Suzanne Fawcett
[02:16:43] [DOC: 9252784] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:16:43] ❌    ❌ Failed to create patient
[02:16:43] [DOC: 9252784] ℹ️  API push details saved for document 9252784
================================================================================
║                        Processing Document ID: 9252782                         ║
================================================================================
[02:16:43] ℹ️  Agency: Dartmouth HH
[02:16:43] ℹ️  Date: 04/22/2025
[02:16:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:16:45] [DOC: 9252782] ✅ Text extracted using pdfplumber (1545 chars)
[02:16:45] ✅    ✅ Text extracted using pdfplumber (1545 chars)
[02:16:45] 🔄 
🔄 Step 2: Extracting patient data...
[02:16:48] ℹ️  AI extracted raw sex value: 'F'
[02:16:48] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:16:48] ℹ️  AI extracted payer source: 'Senior Whole Health'
[02:16:48] ℹ️  AI extracted diagnoses:
[02:16:48] ℹ️    - Diagnosis 1: ''
[02:16:48] ℹ️    - Diagnosis 2: ''
[02:16:48] ℹ️    - Diagnosis 3: ''
[02:16:48] ℹ️    - Diagnosis 4: ''
[02:16:48] ℹ️    - Diagnosis 5: ''
[02:16:48] ℹ️    - Diagnosis 6: ''
[02:16:48] ℹ️  Final extracted MRN: '3177001'
[02:16:48] ℹ️  Final extracted Sex: 'FEMALE'
[02:16:48] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:16:48] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[02:16:48] ✅ Patient data extraction completed successfully
[02:16:48] ✅    ✅ Patient data extracted successfully
[02:16:48] 📊 Patient Response
     └─ patientFName: Dorothy
     └─ patientLName: Lynch
     └─ dob: 03/16/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3177001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 68 Chancery Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:16:48] ✅    ✅ Patient identified: Dorothy Lynch
[02:16:48] ✅    ✅ Patient name validation passed
[02:16:48] 🔄 
🔄 Step 3: Processing patient dates...
[02:16:48] [DOC: 9252782] ℹ️  DOB normalized: 03/16/1932
[02:16:48] [DOC: 9252782] ℹ️  Episode startOfCare normalized: 03/12/2025
[02:16:48] [DOC: 9252782] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[02:16:48] [DOC: 9252782] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[02:16:48] [DOC: 9252782] ✅ Patient date processing completed successfully
[02:16:48] ✅    ✅ Date processing completed
[02:16:48] 📊 Processed Patient Data
     └─ patientFName: Dorothy
     └─ patientLName: Lynch
     └─ dob: 03/16/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3177001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 68 Chancery Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:16:48] 🔄 
🔄 Step 4: Extracting order data...
[02:16:51] ℹ️  Order extraction - MRN: ''
[02:16:51] ℹ️  Order extraction - Sex: 'FEMALE'
[02:16:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:16:51] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[02:16:51] ✅ Order data extraction completed successfully
[02:16:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:16:51] ℹ️  Using MRN from patient data: '3177001'
[02:16:51] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:16:51] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[02:16:51] ✅ Patient name cross-validation successful
[02:16:51] ✅    ✅ Data merged successfully
[02:16:52] ✅    ✅ Order data extracted and validated
[02:16:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:16:52] [DOC: 9252782] ✅ Patient found in local cache: Dorothy Lynch, ID: d21b3eef-f066-47f0-b26e-3663176af82f
[02:16:52] ✅    ✅ Existing patient found with ID: d21b3eef-f066-47f0-b26e-3663176af82f
[02:16:52] 🔄 
🔄 Step 6: Pushing order to API...
[02:16:52] [DOC: 9252782] ℹ️  Pushing order via API for patient ID: d21b3eef-f066-47f0-b26e-3663176af82f
[02:16:53] [DOC: 9252782] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:16:53] ❌    ❌ Failed to push order
[02:16:53] 🔄 
🔄 Step 7: Writing to CSV...
[02:16:53] [DOC: 9252782] ℹ️  Calculated age: 93 from DOB: 03/16/1932
[02:16:53] [DOC: 9252782] ℹ️  Service Line extracted: 'Skilled Nursing'
[02:16:53] [DOC: 9252782] ℹ️  Payer Source extracted: 'Senior Whole Health'
[02:16:53] [DOC: 9252782] ℹ️  Diagnosis codes being written:
[02:16:53] [DOC: 9252782] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:16:53] [DOC: 9252782] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:16:53] [DOC: 9252782] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:16:53] [DOC: 9252782] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:16:53] [DOC: 9252782] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:16:53] [DOC: 9252782] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:16:53] [DOC: 9252782] ✅ Patient data written to CSV: Dorothy Lynch | Sex: FEMALE | Age: 93 | Service: Skilled Nursing | Payer: Senior Whole Health | MRN: 3177001
[02:16:53] ✅    ✅ Document 9252782 processed and saved successfully
[02:16:53] 🔄 
🔄 Step 8: Saving API details...
[02:16:53] [DOC: 9252782] ℹ️  API push details saved for document 9252782
[02:16:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252765                         ║
================================================================================
[02:16:53] ℹ️  Agency: Dartmouth HH
[02:16:53] ℹ️  Date: 04/22/2025
[02:16:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:16:56] [DOC: 9252765] ✅ Text extracted using pdfplumber (1084 chars)
[02:16:56] ✅    ✅ Text extracted using pdfplumber (1084 chars)
[02:16:56] 🔄 
🔄 Step 2: Extracting patient data...
[02:16:59] ℹ️  AI extracted raw sex value: 'F'
[02:16:59] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:16:59] ℹ️  AI extracted payer source: 'Medicare'
[02:16:59] ℹ️  AI extracted diagnoses:
[02:16:59] ℹ️    - Diagnosis 1: 'None'
[02:16:59] ℹ️    - Diagnosis 2: 'None'
[02:16:59] ℹ️    - Diagnosis 3: 'None'
[02:16:59] ℹ️    - Diagnosis 4: 'None'
[02:16:59] ℹ️    - Diagnosis 5: 'None'
[02:16:59] ℹ️    - Diagnosis 6: 'None'
[02:16:59] ℹ️  Final extracted MRN: '5094015'
[02:16:59] ℹ️  Final extracted Sex: 'FEMALE'
[02:16:59] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:16:59] ℹ️  Final extracted Payer Source: 'Medicare'
[02:16:59] ✅ Patient data extraction completed successfully
[02:16:59] ✅    ✅ Patient data extracted successfully
[02:16:59] 📊 Patient Response
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:16:59] ✅    ✅ Patient identified: Laura Gregoire
[02:16:59] ✅    ✅ Patient name validation passed
[02:16:59] 🔄 
🔄 Step 3: Processing patient dates...
[02:16:59] [DOC: 9252765] ℹ️  DOB normalized: 12/06/1944
[02:16:59] [DOC: 9252765] ℹ️  Episode startOfCare normalized: 08/26/2024
[02:16:59] [DOC: 9252765] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[02:16:59] [DOC: 9252765] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[02:16:59] [DOC: 9252765] ✅ Patient date processing completed successfully
[02:16:59] ✅    ✅ Date processing completed
[02:16:59] 📊 Processed Patient Data
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025'}]
[02:16:59] 🔄 
🔄 Step 4: Extracting order data...
[02:17:01] ℹ️  Order extraction - MRN: '5094015'
[02:17:01] ℹ️  Order extraction - Sex: 'FEMALE'
[02:17:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[02:17:01] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:17:01] ✅ Order data extraction completed successfully
[02:17:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:17:01] ℹ️  Using MRN from patient data: '5094015' over '5094015'
[02:17:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[02:17:01] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:17:01] ✅ Patient name cross-validation successful
[02:17:01] ✅    ✅ Data merged successfully
[02:17:03] ✅    ✅ Order data extracted and validated
[02:17:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:17:03] [DOC: 9252765] ✅ Patient found in local cache: Laura Gregoire, ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[02:17:03] ✅    ✅ Existing patient found with ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[02:17:03] 🔄 
🔄 Step 6: Pushing order to API...
[02:17:03] [DOC: 9252765] ℹ️  Pushing order via API for patient ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[02:17:04] [DOC: 9252765] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:17:04] ❌    ❌ Failed to push order
[02:17:04] 🔄 
🔄 Step 7: Writing to CSV...
[02:17:04] [DOC: 9252765] ℹ️  Calculated age: 80 from DOB: 12/06/1944
[02:17:04] [DOC: 9252765] ℹ️  Service Line extracted: 'Skilled Nursing'
[02:17:04] [DOC: 9252765] ℹ️  Payer Source extracted: 'Medicare'
[02:17:04] [DOC: 9252765] ℹ️  Diagnosis codes being written:
[02:17:04] [DOC: 9252765] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:17:04] [DOC: 9252765] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:17:04] [DOC: 9252765] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:17:04] [DOC: 9252765] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:17:04] [DOC: 9252765] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:17:04] [DOC: 9252765] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:17:04] [DOC: 9252765] ✅ Patient data written to CSV: Laura Gregoire | Sex: FEMALE | Age: 80 | Service: Skilled Nursing | Payer: Medicare | MRN: 5094015
[02:17:04] ✅    ✅ Document 9252765 processed and saved successfully
[02:17:04] 🔄 
🔄 Step 8: Saving API details...
[02:17:04] [DOC: 9252765] ℹ️  API push details saved for document 9252765
[02:17:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252763                         ║
================================================================================
[02:17:04] ℹ️  Agency: Dartmouth HH
[02:17:04] ℹ️  Date: 04/22/2025
[02:17:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:17:08] [DOC: 9252763] ✅ Text extracted using pdfplumber (5217 chars)
[02:17:08] ✅    ✅ Text extracted using pdfplumber (5217 chars)
[02:17:08] 🔄 
🔄 Step 2: Extracting patient data...
[02:17:11] ℹ️  AI extracted raw sex value: 'M'
[02:17:11] ℹ️  AI extracted service line: 'OT'
[02:17:11] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[02:17:11] ℹ️  AI extracted diagnoses:
[02:17:11] ℹ️    - Diagnosis 1: 'DM'
[02:17:11] ℹ️    - Diagnosis 2: 'CKD'
[02:17:11] ℹ️    - Diagnosis 3: 'HTN'
[02:17:11] ℹ️    - Diagnosis 4: 'coronary atherosclerosis'
[02:17:11] ℹ️    - Diagnosis 5: 'morbid obesity'
[02:17:11] ℹ️    - Diagnosis 6: 'neuropathy'
[02:17:11] ℹ️  Final extracted MRN: '5019015'
[02:17:11] ℹ️  Final extracted Sex: 'MALE'
[02:17:11] ℹ️  Final extracted Service Line: 'OT'
[02:17:11] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[02:17:11] ✅ Patient data extraction completed successfully
[02:17:11] ✅    ✅ Patient data extracted successfully
[02:17:11] 📊 Patient Response
     └─ patientFName: Phillip
     └─ patientLName: Sylvia
     └─ dob: 08/03/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5019015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'DM', 'secondDiagnosis': 'CKD', 'thirdDiagnosis': 'HTN', 'fourthDiagnosis': 'coronary atherosclerosis', 'fifthDiagnosis': 'morbid obesity', 'sixthDiagnosis': 'neuropathy'}]
[02:17:11] ✅    ✅ Patient identified: Phillip Sylvia
[02:17:11] ✅    ✅ Patient name validation passed
[02:17:11] 🔄 
🔄 Step 3: Processing patient dates...
[02:17:11] [DOC: 9252763] ℹ️  DOB normalized: 08/03/1944
[02:17:11] [DOC: 9252763] ℹ️  Episode startOfCare normalized: 04/02/2025
[02:17:11] [DOC: 9252763] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[02:17:11] [DOC: 9252763] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[02:17:11] [DOC: 9252763] ✅ Patient date processing completed successfully
[02:17:11] ✅    ✅ Date processing completed
[02:17:11] 📊 Processed Patient Data
     └─ patientFName: Phillip
     └─ patientLName: Sylvia
     └─ dob: 08/03/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5019015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'DM', 'secondDiagnosis': 'CKD', 'thirdDiagnosis': 'HTN', 'fourthDiagnosis': 'coronary atherosclerosis', 'fifthDiagnosis': 'morbid obesity', 'sixthDiagnosis': 'neuropathy'}]
[02:17:11] 🔄 
🔄 Step 4: Extracting order data...
[02:17:14] ℹ️  Order extraction - MRN: ''
[02:17:14] ℹ️  Order extraction - Sex: 'MALE'
[02:17:14] ℹ️  Order extraction - Service Line: 'OT'
[02:17:14] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[02:17:14] ✅ Order data extraction completed successfully
[02:17:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:17:14] ℹ️  Using MRN from patient data: '5019015'
[02:17:14] ℹ️  Service line consistent in both sources: 'OT'
[02:17:14] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[02:17:14] ✅ Patient name cross-validation successful
[02:17:14] ✅    ✅ Data merged successfully
[02:17:15] ✅    ✅ Order data extracted and validated
[02:17:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:17:15] [DOC: 9252763] ✅ Patient found in local cache: Phillip Sylvia, ID: da668618-8653-4ff9-a16c-8eb8ca6755a4
[02:17:15] ✅    ✅ Existing patient found with ID: da668618-8653-4ff9-a16c-8eb8ca6755a4
[02:17:15] 🔄 
🔄 Step 6: Pushing order to API...
[02:17:15] [DOC: 9252763] ℹ️  Pushing order via API for patient ID: da668618-8653-4ff9-a16c-8eb8ca6755a4
[02:17:16] [DOC: 9252763] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:17:16] ❌    ❌ Failed to push order
[02:17:16] 🔄 
🔄 Step 7: Writing to CSV...
[02:17:16] [DOC: 9252763] ℹ️  Calculated age: 80 from DOB: 08/03/1944
[02:17:16] [DOC: 9252763] ℹ️  Service Line extracted: 'OT'
[02:17:16] [DOC: 9252763] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[02:17:16] [DOC: 9252763] ℹ️  Diagnosis codes being written:
[02:17:16] [DOC: 9252763] ℹ️    - Latest_Episode_Firstdiagnosis: 'DM'
[02:17:16] [DOC: 9252763] ℹ️    - Latest_Episode_Seconddiagnosis: 'CKD'
[02:17:16] [DOC: 9252763] ℹ️    - Latest_Episode_Thirddiagnosis: 'HTN'
[02:17:16] [DOC: 9252763] ℹ️    - Latest_Episode_Fourthdiagnosis: 'coronary atherosclerosis'
[02:17:16] [DOC: 9252763] ℹ️    - Latest_Episode_Fifthdiagnosis: 'morbid obesity'
[02:17:16] [DOC: 9252763] ℹ️    - Latest_Episode_Sixthdiagnosis: 'neuropathy'
[02:17:16] [DOC: 9252763] ✅ Patient data written to CSV: Phillip Sylvia | Sex: MALE | Age: 80 | Service: OT | Payer: Aetna- Mcare | MRN: 5019015
[02:17:16] ✅    ✅ Document 9252763 processed and saved successfully
[02:17:16] 🔄 
🔄 Step 8: Saving API details...
[02:17:16] [DOC: 9252763] ℹ️  API push details saved for document 9252763
[02:17:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252762                         ║
================================================================================
[02:17:16] ℹ️  Agency: Dartmouth HH
[02:17:16] ℹ️  Date: 04/22/2025
[02:17:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:17:18] [DOC: 9252762] ✅ Text extracted using pdfplumber (1585 chars)
[02:17:18] ✅    ✅ Text extracted using pdfplumber (1585 chars)
[02:17:18] 🔄 
🔄 Step 2: Extracting patient data...
[02:17:21] ℹ️  AI extracted raw sex value: 'F'
[02:17:21] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[02:17:21] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[02:17:21] ℹ️  AI extracted diagnoses:
[02:17:21] ℹ️    - Diagnosis 1: 'None'
[02:17:21] ℹ️    - Diagnosis 2: 'None'
[02:17:21] ℹ️    - Diagnosis 3: 'None'
[02:17:21] ℹ️    - Diagnosis 4: 'None'
[02:17:21] ℹ️    - Diagnosis 5: 'None'
[02:17:21] ℹ️    - Diagnosis 6: 'None'
[02:17:21] ℹ️  Final extracted MRN: '6843'
[02:17:21] ℹ️  Final extracted Sex: 'FEMALE'
[02:17:21] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[02:17:21] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[02:17:21] ✅ Patient data extraction completed successfully
[02:17:21] ✅    ✅ Patient data extracted successfully
[02:17:21] 📊 Patient Response
     └─ patientFName: Pearl
     └─ patientLName: Moura
     └─ dob: 01/29/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6843
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2022', 'startOfEpisode': '04/21/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[02:17:21] ✅    ✅ Patient identified: Pearl Moura
[02:17:21] ✅    ✅ Patient name validation passed
[02:17:21] 🔄 
🔄 Step 3: Processing patient dates...
[02:17:21] [DOC: 9252762] ℹ️  DOB normalized: 01/29/1930
[02:17:21] [DOC: 9252762] ℹ️  Episode startOfCare normalized: 01/04/2022
[02:17:21] [DOC: 9252762] ℹ️  Episode startOfEpisode normalized: 04/21/2025
[02:17:21] [DOC: 9252762] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[02:17:21] [DOC: 9252762] ✅ Patient date processing completed successfully
[02:17:21] ✅    ✅ Date processing completed
[02:17:21] 📊 Processed Patient Data
     └─ patientFName: Pearl
     └─ patientLName: Moura
     └─ dob: 01/29/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6843
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2022', 'startOfEpisode': '04/21/2025', 'endOfEpisode': '06/16/2025'}]
[02:17:21] 🔄 
🔄 Step 4: Extracting order data...
[02:17:24] ℹ️  Order extraction - MRN: ''
[02:17:24] ℹ️  Order extraction - Sex: 'FEMALE'
[02:17:24] ℹ️  Order extraction - Service Line: 'RN, PT'
[02:17:24] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[02:17:24] ✅ Order data extraction completed successfully
[02:17:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:17:24] ℹ️  Using MRN from patient data: '6843'
[02:17:24] ℹ️  Combined service lines: Patient='Skilled Nursing, PT' + Order='RN, PT' = 'PT, RN, Skilled Nursing'
[02:17:24] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[02:17:24] ✅ Patient name cross-validation successful
[02:17:24] ✅    ✅ Data merged successfully
[02:17:25] ✅    ✅ Order data extracted and validated
[02:17:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:17:25] [DOC: 9252762] ✅ Patient found in local cache: Pearl Moura, ID: 96381f05-1d66-4bdb-b9e3-fc82afab3898
[02:17:25] ✅    ✅ Existing patient found with ID: 96381f05-1d66-4bdb-b9e3-fc82afab3898
[02:17:25] 🔄 
🔄 Step 6: Pushing order to API...
[02:17:25] [DOC: 9252762] ℹ️  Pushing order via API for patient ID: 96381f05-1d66-4bdb-b9e3-fc82afab3898
[02:17:26] [DOC: 9252762] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14163"}
[02:17:26] ❌    ❌ Failed to push order
[02:17:26] 🔄 
🔄 Step 7: Writing to CSV...
[02:17:26] [DOC: 9252762] ℹ️  Calculated age: 95 from DOB: 01/29/1930
[02:17:26] [DOC: 9252762] ℹ️  Service Line extracted: 'PT, RN, Skilled Nursing'
[02:17:26] [DOC: 9252762] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[02:17:26] [DOC: 9252762] ℹ️  Diagnosis codes being written:
[02:17:26] [DOC: 9252762] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:17:26] [DOC: 9252762] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:17:26] [DOC: 9252762] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:17:26] [DOC: 9252762] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:17:26] [DOC: 9252762] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:17:26] [DOC: 9252762] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:17:26] [DOC: 9252762] ✅ Patient data written to CSV: Pearl Moura | Sex: FEMALE | Age: 95 | Service: PT, RN, Skilled Nursing | Payer: Aetna- Mcare | MRN: 6843
[02:17:26] ✅    ✅ Document 9252762 processed and saved successfully
[02:17:26] 🔄 
🔄 Step 8: Saving API details...
[02:17:26] [DOC: 9252762] ℹ️  API push details saved for document 9252762
[02:17:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252759                         ║
================================================================================
[02:17:26] ℹ️  Agency: Dartmouth HH
[02:17:26] ℹ️  Date: 04/22/2025
[02:17:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:17:29] [DOC: 9252759] ✅ Text extracted using pdfplumber (9746 chars)
[02:17:29] ✅    ✅ Text extracted using pdfplumber (9746 chars)
[02:17:29] 🔄 
🔄 Step 2: Extracting patient data...
[02:17:32] ℹ️  AI extracted raw sex value: 'F'
[02:17:32] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:17:32] ℹ️  AI extracted payer source: 'Fallon Health'
[02:17:32] ℹ️  AI extracted diagnoses:
[02:17:32] ℹ️    - Diagnosis 1: 'I13.0'
[02:17:32] ℹ️    - Diagnosis 2: 'I50.33'
[02:17:32] ℹ️    - Diagnosis 3: 'N18.9'
[02:17:32] ℹ️    - Diagnosis 4: 'I48.91'
[02:17:32] ℹ️    - Diagnosis 5: 'I05.1'
[02:17:32] ℹ️    - Diagnosis 6: 'I07.1'
[02:17:32] ℹ️  Final extracted MRN: '4034011'
[02:17:32] ℹ️  Final extracted Sex: 'FEMALE'
[02:17:32] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:17:32] ℹ️  Final extracted Payer Source: 'Fallon Health'
[02:17:32] ✅ Patient data extraction completed successfully
[02:17:32] ✅    ✅ Patient data extracted successfully
[02:17:32] 📊 Patient Response
     └─ patientFName: Joan E
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Fallon Health
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.9', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'I05.1', 'sixthDiagnosis': 'I07.1'}]
[02:17:32] ✅    ✅ Patient identified: Joan E Swift
[02:17:32] ✅    ✅ Patient name validation passed
[02:17:32] 🔄 
🔄 Step 3: Processing patient dates...
[02:17:32] [DOC: 9252759] ℹ️  DOB normalized: 05/05/1943
[02:17:32] [DOC: 9252759] ℹ️  Episode startOfCare normalized: 01/08/2025
[02:17:32] [DOC: 9252759] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[02:17:32] [DOC: 9252759] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[02:17:32] [DOC: 9252759] ✅ Patient date processing completed successfully
[02:17:32] ✅    ✅ Date processing completed
[02:17:32] 📊 Processed Patient Data
     └─ patientFName: Joan E
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Fallon Health
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.9', 'fourthDiagnosis': 'I48.91', 'fifthDiagnosis': 'I05.1', 'sixthDiagnosis': 'I07.1'}]
[02:17:32] 🔄 
🔄 Step 4: Extracting order data...
[02:17:35] ℹ️  Order extraction - MRN: ''
[02:17:35] ℹ️  Order extraction - Sex: 'FEMALE'
[02:17:35] ℹ️  Order extraction - Service Line: 'RN'
[02:17:35] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[02:17:35] ✅ Order data extraction completed successfully
[02:17:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:17:35] ℹ️  Using MRN from patient data: '4034011'
[02:17:35] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[02:17:35] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[02:17:35] ✅ Patient name cross-validation successful
[02:17:35] ✅    ✅ Data merged successfully
[02:17:36] ✅    ✅ Order data extracted and validated
[02:17:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:17:59] [DOC: 9252759] ℹ️  Patient not found in cache or API: Joan E Swift
[02:17:59] [DOC: 9252759] ℹ️  Patient not found, creating new patient via API...
[02:17:59] [DOC: 9252759] ℹ️  Creating patient via API: Joan E Swift
[02:18:00] [DOC: 9252759] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[02:18:00] ❌    ❌ Failed to create patient
[02:18:00] [DOC: 9252759] ℹ️  API push details saved for document 9252759
================================================================================
║                        Processing Document ID: 9252757                         ║
================================================================================
[02:18:00] ℹ️  Agency: Dartmouth HH
[02:18:00] ℹ️  Date: 04/22/2025
[02:18:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:18:03] [DOC: 9252757] ✅ Text extracted using pdfplumber (10771 chars)
[02:18:03] ✅    ✅ Text extracted using pdfplumber (10759 chars)
[02:18:03] 🔄 
🔄 Step 2: Extracting patient data...
[02:18:07] ℹ️  AI extracted raw sex value: 'F'
[02:18:07] ℹ️  AI extracted service line: 'Skilled Nursing, HHA'
[02:18:07] ℹ️  AI extracted payer source: 'None'
[02:18:07] ℹ️  AI extracted diagnoses:
[02:18:07] ℹ️    - Diagnosis 1: 'D51.0'
[02:18:07] ℹ️    - Diagnosis 2: 'I11.0'
[02:18:07] ℹ️    - Diagnosis 3: 'I50.9'
[02:18:07] ℹ️    - Diagnosis 4: 'J44.9'
[02:18:07] ℹ️    - Diagnosis 5: 'G62.9'
[02:18:07] ℹ️    - Diagnosis 6: 'F41.9'
[02:18:07] ℹ️  Final extracted MRN: '6843'
[02:18:07] ℹ️  Final extracted Sex: 'FEMALE'
[02:18:07] ℹ️  Final extracted Service Line: 'Skilled Nursing, HHA'
[02:18:07] ℹ️  Final extracted Payer Source: ''
[02:18:07] ✅ Patient data extraction completed successfully
[02:18:07] ✅    ✅ Patient data extracted successfully
[02:18:07] 📊 Patient Response
     └─ patientFName: Pearl
     └─ patientLName: Moura
     └─ dob: 01/29/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6843
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2022', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'D51.0', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.9', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'G62.9', 'sixthDiagnosis': 'F41.9'}]
[02:18:07] ✅    ✅ Patient identified: Pearl Moura
[02:18:07] ✅    ✅ Patient name validation passed
[02:18:07] 🔄 
🔄 Step 3: Processing patient dates...
[02:18:07] [DOC: 9252757] ℹ️  DOB normalized: 01/29/1930
[02:18:07] [DOC: 9252757] ℹ️  Episode startOfCare normalized: 01/04/2022
[02:18:07] [DOC: 9252757] ℹ️  Episode startOfEpisode normalized: 04/18/2025
[02:18:07] [DOC: 9252757] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[02:18:07] [DOC: 9252757] ✅ Patient date processing completed successfully
[02:18:07] ✅    ✅ Date processing completed
[02:18:07] 📊 Processed Patient Data
     └─ patientFName: Pearl
     └─ patientLName: Moura
     └─ dob: 01/29/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6843
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2022', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'D51.0', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.9', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'G62.9', 'sixthDiagnosis': 'F41.9'}]
[02:18:07] 🔄 
🔄 Step 4: Extracting order data...
[02:18:09] ℹ️  Order extraction - MRN: '6843'
[02:18:09] ℹ️  Order extraction - Sex: 'FEMALE'
[02:18:09] ℹ️  Order extraction - Service Line: 'Skilled Nursing, HHA'
[02:18:09] ℹ️  Order extraction - Payer Source: ''
[02:18:09] ✅ Order data extraction completed successfully
[02:18:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:18:09] ℹ️  Using MRN from patient data: '6843' over '6843'
[02:18:09] ℹ️  Service line consistent in both sources: 'Skilled Nursing, HHA'
[02:18:09] ✅ Patient name cross-validation successful
[02:18:09] ✅    ✅ Data merged successfully
[02:18:11] ✅    ✅ Order data extracted and validated
[02:18:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:18:11] [DOC: 9252757] ✅ Patient found in local cache: Pearl Moura, ID: 96381f05-1d66-4bdb-b9e3-fc82afab3898
[02:18:11] ✅    ✅ Existing patient found with ID: 96381f05-1d66-4bdb-b9e3-fc82afab3898
[02:18:11] 🔄 
🔄 Step 6: Pushing order to API...
[02:18:11] [DOC: 9252757] ℹ️  Pushing order via API for patient ID: 96381f05-1d66-4bdb-b9e3-fc82afab3898
[02:18:12] [DOC: 9252757] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:18:12] ❌    ❌ Failed to push order
[02:18:12] 🔄 
🔄 Step 7: Writing to CSV...
[02:18:12] [DOC: 9252757] ℹ️  Calculated age: 95 from DOB: 01/29/1930
[02:18:12] [DOC: 9252757] ℹ️  Service Line extracted: 'Skilled Nursing, HHA'
[02:18:12] [DOC: 9252757] ℹ️  Payer Source extracted: ''
[02:18:12] [DOC: 9252757] ℹ️  Diagnosis codes being written:
[02:18:12] [DOC: 9252757] ℹ️    - Latest_Episode_Firstdiagnosis: 'D51.0'
[02:18:12] [DOC: 9252757] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.0'
[02:18:12] [DOC: 9252757] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.9'
[02:18:12] [DOC: 9252757] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J44.9'
[02:18:12] [DOC: 9252757] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G62.9'
[02:18:12] [DOC: 9252757] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[02:18:12] [DOC: 9252757] ✅ Patient data written to CSV: Pearl Moura | Sex: FEMALE | Age: 95 | Service: Skilled Nursing, HHA | Payer:  | MRN: 6843
[02:18:12] ✅    ✅ Document 9252757 processed and saved successfully
[02:18:12] 🔄 
🔄 Step 8: Saving API details...
[02:18:12] [DOC: 9252757] ℹ️  API push details saved for document 9252757
[02:18:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252751                         ║
================================================================================
[02:18:12] ℹ️  Agency: Dartmouth HH
[02:18:12] ℹ️  Date: 04/22/2025
[02:18:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:18:14] [DOC: 9252751] ✅ Text extracted using pdfplumber (1838 chars)
[02:18:14] ✅    ✅ Text extracted using pdfplumber (1838 chars)
[02:18:14] 🔄 
🔄 Step 2: Extracting patient data...
[02:18:17] ℹ️  AI extracted raw sex value: 'F'
[02:18:17] ℹ️  AI extracted service line: 'Skilled Nursing'
[02:18:17] ℹ️  AI extracted payer source: 'Medicare'
[02:18:17] ℹ️  AI extracted diagnoses:
[02:18:17] ℹ️    - Diagnosis 1: ''
[02:18:17] ℹ️    - Diagnosis 2: ''
[02:18:17] ℹ️    - Diagnosis 3: ''
[02:18:17] ℹ️    - Diagnosis 4: ''
[02:18:17] ℹ️    - Diagnosis 5: ''
[02:18:17] ℹ️    - Diagnosis 6: ''
[02:18:17] ℹ️  Final extracted MRN: '1872009'
[02:18:17] ℹ️  Final extracted Sex: 'FEMALE'
[02:18:17] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[02:18:17] ℹ️  Final extracted Payer Source: 'Medicare'
[02:18:17] ✅ Patient data extraction completed successfully
[02:18:17] ✅    ✅ Patient data extracted successfully
[02:18:17] 📊 Patient Response
     └─ patientFName: Corinne
     └─ patientLName: Lebeau
     └─ dob: 07/17/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1872009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 311 Conduit St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:18:17] ✅    ✅ Patient identified: Corinne Lebeau
[02:18:17] ✅    ✅ Patient name validation passed
[02:18:17] 🔄 
🔄 Step 3: Processing patient dates...
[02:18:17] [DOC: 9252751] ℹ️  DOB normalized: 07/17/1948
[02:18:17] [DOC: 9252751] ℹ️  Episode startOfCare normalized: 04/04/2025
[02:18:17] [DOC: 9252751] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[02:18:17] [DOC: 9252751] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[02:18:17] [DOC: 9252751] ✅ Patient date processing completed successfully
[02:18:17] ✅    ✅ Date processing completed
[02:18:17] 📊 Processed Patient Data
     └─ patientFName: Corinne
     └─ patientLName: Lebeau
     └─ dob: 07/17/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1872009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 311 Conduit St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[02:18:17] 🔄 
🔄 Step 4: Extracting order data...
[02:18:19] ℹ️  Order extraction - MRN: ''
[02:18:19] ℹ️  Order extraction - Sex: 'FEMALE'
[02:18:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing, RN'
[02:18:19] ℹ️  Order extraction - Payer Source: 'Medicare'
[02:18:19] ✅ Order data extraction completed successfully
[02:18:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:18:19] ℹ️  Using MRN from patient data: '1872009'
[02:18:19] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, RN' = 'RN, Skilled Nursing'
[02:18:19] ℹ️  Payer source consistent in both sources: 'Medicare'
[02:18:19] ✅ Patient name cross-validation successful
[02:18:19] ✅    ✅ Data merged successfully
[02:18:21] ✅    ✅ Order data extracted and validated
[02:18:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:18:21] [DOC: 9252751] ✅ Patient found in local cache: Corinne Lebeau, ID: 0f4ccc9d-eeca-436a-894e-726e413ff127
[02:18:21] ✅    ✅ Existing patient found with ID: 0f4ccc9d-eeca-436a-894e-726e413ff127
[02:18:21] 🔄 
🔄 Step 6: Pushing order to API...
[02:18:21] [DOC: 9252751] ℹ️  Pushing order via API for patient ID: 0f4ccc9d-eeca-436a-894e-726e413ff127
[02:18:22] [DOC: 9252751] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13910"}
[02:18:22] ❌    ❌ Failed to push order
[02:18:22] 🔄 
🔄 Step 7: Writing to CSV...
[02:18:22] [DOC: 9252751] ℹ️  Calculated age: 76 from DOB: 07/17/1948
[02:18:22] [DOC: 9252751] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[02:18:22] [DOC: 9252751] ℹ️  Payer Source extracted: 'Medicare'
[02:18:22] [DOC: 9252751] ℹ️  Diagnosis codes being written:
[02:18:22] [DOC: 9252751] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[02:18:22] [DOC: 9252751] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[02:18:22] [DOC: 9252751] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[02:18:22] [DOC: 9252751] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[02:18:22] [DOC: 9252751] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[02:18:22] [DOC: 9252751] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[02:18:22] [DOC: 9252751] ✅ Patient data written to CSV: Corinne Lebeau | Sex: FEMALE | Age: 76 | Service: RN, Skilled Nursing | Payer: Medicare | MRN: 1872009
[02:18:22] ✅    ✅ Document 9252751 processed and saved successfully
[02:18:22] 🔄 
🔄 Step 8: Saving API details...
[02:18:22] [DOC: 9252751] ℹ️  API push details saved for document 9252751
[02:18:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252747                         ║
================================================================================
[02:18:22] ℹ️  Agency: Dartmouth HH
[02:18:22] ℹ️  Date: 04/22/2025
[02:18:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:18:25] [DOC: 9252747] ✅ Text extracted using pdfplumber (23615 chars)
[02:18:25] ✅    ✅ Text extracted using pdfplumber (23603 chars)
[02:18:25] 🔄 
🔄 Step 2: Extracting patient data...
[02:18:29] ℹ️  AI extracted raw sex value: 'F'
[02:18:29] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[02:18:29] ℹ️  AI extracted payer source: ''
[02:18:29] ℹ️  AI extracted diagnoses:
[02:18:29] ℹ️    - Diagnosis 1: 'S06.5X0D'
[02:18:29] ℹ️    - Diagnosis 2: 'K52.9'
[02:18:29] ℹ️    - Diagnosis 3: 'I13.2'
[02:18:29] ℹ️    - Diagnosis 4: 'I50.33'
[02:18:29] ℹ️    - Diagnosis 5: 'E11.22'
[02:18:29] ℹ️    - Diagnosis 6: 'N18.6'
[02:18:29] ℹ️  Final extracted MRN: '1872009'
[02:18:29] ℹ️  Final extracted Sex: 'FEMALE'
[02:18:29] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[02:18:29] ℹ️  Final extracted Payer Source: ''
[02:18:29] ✅ Patient data extraction completed successfully
[02:18:29] ✅    ✅ Patient data extracted successfully
[02:18:29] 📊 Patient Response
     └─ patientFName: Corinne
     └─ patientLName: Lebeau
     └─ dob: 07/17/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1872009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'S06.5X0D', 'secondDiagnosis': 'K52.9', 'thirdDiagnosis': 'I13.2', 'fourthDiagnosis': 'I50.33', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.6'}]
[02:18:29] ✅    ✅ Patient identified: Corinne Lebeau
[02:18:29] ✅    ✅ Patient name validation passed
[02:18:29] 🔄 
🔄 Step 3: Processing patient dates...
[02:18:29] [DOC: 9252747] ℹ️  DOB normalized: 07/17/1948
[02:18:29] [DOC: 9252747] ℹ️  Episode startOfCare normalized: 04/04/2025
[02:18:29] [DOC: 9252747] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[02:18:29] [DOC: 9252747] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[02:18:29] [DOC: 9252747] ✅ Patient date processing completed successfully
[02:18:29] ✅    ✅ Date processing completed
[02:18:29] 📊 Processed Patient Data
     └─ patientFName: Corinne
     └─ patientLName: Lebeau
     └─ dob: 07/17/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1872009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'S06.5X0D', 'secondDiagnosis': 'K52.9', 'thirdDiagnosis': 'I13.2', 'fourthDiagnosis': 'I50.33', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.6'}]
[02:18:29] 🔄 
🔄 Step 4: Extracting order data...
[02:18:31] ℹ️  Order extraction - MRN: '1872009'
[02:18:31] ℹ️  Order extraction - Sex: 'FEMALE'
[02:18:31] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[02:18:31] ℹ️  Order extraction - Payer Source: ''
[02:18:31] ✅ Order data extraction completed successfully
[02:18:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:18:31] ℹ️  Using MRN from patient data: '1872009' over '1872009'
[02:18:31] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[02:18:31] ✅ Patient name cross-validation successful
[02:18:31] ✅    ✅ Data merged successfully
[02:18:33] ✅    ✅ Order data extracted and validated
[02:18:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:18:33] [DOC: 9252747] ✅ Patient found in local cache: Corinne Lebeau, ID: 0f4ccc9d-eeca-436a-894e-726e413ff127
[02:18:33] ✅    ✅ Existing patient found with ID: 0f4ccc9d-eeca-436a-894e-726e413ff127
[02:18:33] 🔄 
🔄 Step 6: Pushing order to API...
[02:18:33] [DOC: 9252747] ℹ️  Pushing order via API for patient ID: 0f4ccc9d-eeca-436a-894e-726e413ff127
[02:18:34] [DOC: 9252747] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:18:34] ❌    ❌ Failed to push order
[02:18:34] 🔄 
🔄 Step 7: Writing to CSV...
[02:18:34] [DOC: 9252747] ℹ️  Calculated age: 76 from DOB: 07/17/1948
[02:18:34] [DOC: 9252747] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT'
[02:18:34] [DOC: 9252747] ℹ️  Payer Source extracted: ''
[02:18:34] [DOC: 9252747] ℹ️  Diagnosis codes being written:
[02:18:34] [DOC: 9252747] ℹ️    - Latest_Episode_Firstdiagnosis: 'S06.5X0D'
[02:18:34] [DOC: 9252747] ℹ️    - Latest_Episode_Seconddiagnosis: 'K52.9'
[02:18:34] [DOC: 9252747] ℹ️    - Latest_Episode_Thirddiagnosis: 'I13.2'
[02:18:34] [DOC: 9252747] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.33'
[02:18:34] [DOC: 9252747] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.22'
[02:18:34] [DOC: 9252747] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N18.6'
[02:18:34] [DOC: 9252747] ✅ Patient data written to CSV: Corinne Lebeau | Sex: FEMALE | Age: 76 | Service: Skilled Nursing, PT, OT | Payer:  | MRN: 1872009
[02:18:34] ✅    ✅ Document 9252747 processed and saved successfully
[02:18:34] 🔄 
🔄 Step 8: Saving API details...
[02:18:34] [DOC: 9252747] ℹ️  API push details saved for document 9252747
[02:18:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9252745                         ║
================================================================================
[02:18:34] ℹ️  Agency: Dartmouth HH
[02:18:34] ℹ️  Date: 04/22/2025
[02:18:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[02:18:37] [DOC: 9252745] ✅ Text extracted using pdfplumber (14290 chars)
[02:18:37] ✅    ✅ Text extracted using pdfplumber (14278 chars)
[02:18:37] 🔄 
🔄 Step 2: Extracting patient data...
[02:18:41] ℹ️  AI extracted raw sex value: 'M'
[02:18:41] ℹ️  AI extracted service line: 'PT, RN'
[02:18:41] ℹ️  AI extracted payer source: ''
[02:18:41] ℹ️  AI extracted diagnoses:
[02:18:41] ℹ️    - Diagnosis 1: 'M17.12'
[02:18:41] ℹ️    - Diagnosis 2: 'M16.12'
[02:18:41] ℹ️    - Diagnosis 3: 'M25.562'
[02:18:41] ℹ️    - Diagnosis 4: 'M25.552'
[02:18:41] ℹ️    - Diagnosis 5: 'G89.29'
[02:18:41] ℹ️    - Diagnosis 6: 'E66.01'
[02:18:41] ℹ️  Final extracted MRN: '227027'
[02:18:41] ℹ️  Final extracted Sex: 'MALE'
[02:18:41] ℹ️  Final extracted Service Line: 'PT, RN'
[02:18:41] ℹ️  Final extracted Payer Source: ''
[02:18:41] ✅ Patient data extraction completed successfully
[02:18:41] ✅    ✅ Patient data extracted successfully
[02:18:41] 📊 Patient Response
     └─ patientFName: Marshall
     └─ patientLName: Carl J
     └─ dob: 11/17/1963
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/17/2025', 'startOfEpisode': '04/17/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'M17.12', 'secondDiagnosis': 'M16.12', 'thirdDiagnosis': 'M25.562', 'fourthDiagnosis': 'M25.552', 'fifthDiagnosis': 'G89.29', 'sixthDiagnosis': 'E66.01'}]
[02:18:41] ✅    ✅ Patient identified: Marshall Carl J
[02:18:41] ✅    ✅ Patient name validation passed
[02:18:41] 🔄 
🔄 Step 3: Processing patient dates...
[02:18:41] [DOC: 9252745] ℹ️  DOB normalized: 11/17/1963
[02:18:41] [DOC: 9252745] ℹ️  Episode startOfCare normalized: 04/17/2025
[02:18:41] [DOC: 9252745] ℹ️  Episode startOfEpisode normalized: 04/17/2025
[02:18:41] [DOC: 9252745] ℹ️  Episode endOfEpisode normalized: 06/15/2025
[02:18:41] [DOC: 9252745] ✅ Patient date processing completed successfully
[02:18:41] ✅    ✅ Date processing completed
[02:18:41] 📊 Processed Patient Data
     └─ patientFName: Marshall
     └─ patientLName: Carl J
     └─ dob: 11/17/1963
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/17/2025', 'startOfEpisode': '04/17/2025', 'endOfEpisode': '06/15/2025', 'firstDiagnosis': 'M17.12', 'secondDiagnosis': 'M16.12', 'thirdDiagnosis': 'M25.562', 'fourthDiagnosis': 'M25.552', 'fifthDiagnosis': 'G89.29', 'sixthDiagnosis': 'E66.01'}]
[02:18:41] 🔄 
🔄 Step 4: Extracting order data...
[02:18:43] ℹ️  Order extraction - MRN: '6356015'
[02:18:43] ℹ️  Order extraction - Sex: 'MALE'
[02:18:43] ℹ️  Order extraction - Service Line: 'PT, RN'
[02:18:43] ℹ️  Order extraction - Payer Source: ''
[02:18:43] ✅ Order data extraction completed successfully
[02:18:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[02:18:43] ℹ️  Using longer MRN from order data: '6356015' over '227027'
[02:18:43] ℹ️  Service line consistent in both sources: 'PT, RN'
[02:18:43] ✅ Patient name cross-validation successful
[02:18:43] ✅    ✅ Data merged successfully
[02:18:44] ✅    ✅ Order data extracted and validated
[02:18:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[02:19:21] [DOC: 9252745] ✅ Patient exists in API: Marshall Carl J, ID: d398e912-3d1a-456a-a376-9ca996ab5579
[02:19:21] ✅    ✅ Existing patient found with ID: d398e912-3d1a-456a-a376-9ca996ab5579
[02:19:21] 🔄 
🔄 Step 6: Pushing order to API...
[02:19:21] [DOC: 9252745] ℹ️  Pushing order via API for patient ID: d398e912-3d1a-456a-a376-9ca996ab5579
[02:19:23] [DOC: 9252745] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[02:19:23] ❌    ❌ Failed to push order
[02:19:23] 🔄 
🔄 Step 7: Writing to CSV...
[02:19:23] [DOC: 9252745] ℹ️  Calculated age: 61 from DOB: 11/17/1963
[02:19:23] [DOC: 9252745] ℹ️  Service Line extracted: 'PT, RN'
[02:19:23] [DOC: 9252745] ℹ️  Payer Source extracted: ''
[02:19:23] [DOC: 9252745] ℹ️  Diagnosis codes being written:
[02:19:23] [DOC: 9252745] ℹ️    - Latest_Episode_Firstdiagnosis: 'M17.12'
[02:19:23] [DOC: 9252745] ℹ️    - Latest_Episode_Seconddiagnosis: 'M16.12'
[02:19:23] [DOC: 9252745] ℹ️    - Latest_Episode_Thirddiagnosis: 'M25.562'
[02:19:23] [DOC: 9252745] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M25.552'
[02:19:23] [DOC: 9252745] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G89.29'
[02:19:23] [DOC: 9252745] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E66.01'
[02:19:23] [DOC: 9252745] ✅ Patient data written to CSV: Marshall Carl J | Sex: MALE | Age: 61 | Service: PT, RN | Payer:  | MRN: 6356015
[02:19:23] ✅    ✅ Document 9252745 processed and saved successfully
[02:19:23] 🔄 
🔄 Step 8: Saving API details...
[02:19:23] [DOC: 9252745] ℹ️  API push details saved for document 9252745
[02:19:23] ✅    ✅ API details saved
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[02:19:23] ℹ️  Total Processed: 49
[02:19:23] ℹ️  CSV Success: 25
[02:19:23] ℹ️  CSV Errors: 2
[02:19:23] ℹ️  API Success: 0
[02:19:23] ℹ️  API Errors: 47
[02:19:23] ℹ️  CSV Success Rate: 51.0%
[02:19:23] ℹ️  API Success Rate: 0.0%
[02:19:23] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250608_015152.csv
[02:19:23] ℹ️  API Details File: api_outputs/api_push_details_20250608_015152.csv
================================================================================
║          ============================================================          ║
================================================================================
