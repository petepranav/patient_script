================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[13:33:24] ℹ️  CSV Data Extraction & API Push Tool
[13:33:24] ℹ️  
[13:33:24] ℹ️  Features:
[13:33:24] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[13:33:24] ℹ️  - AI-powered patient and order data extraction
[13:33:24] ℹ️  - Enhanced error handling and logging
[13:33:24] ℹ️  - Full API integration (patient creation + order pushing)
[13:33:24] ℹ️  - CSV output with comprehensive patient data
[13:33:24] ℹ️  - Detailed API tracking with remarks for every document
[13:33:24] ℹ️  - Complete audit trail of all processing attempts
[13:33:24] ℹ️  
[13:33:24] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[13:33:24] ✅ Created output CSV file: csv_outputs/extracted_patients_20250607_133324.csv
[13:33:24] ✅ Created API details CSV file: api_outputs/api_push_details_20250607_133324.csv
================================================================================
║                        Processing Document ID: 9313796                         ║
================================================================================
[13:33:24] ℹ️  Agency: Dartmouth HH
[13:33:24] ℹ️  Date: 05/28/2025
[13:33:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:33:27] [DOC: 9313796] ✅ Text extracted using pdfplumber (20622 chars)
[13:33:27] ✅    ✅ Text extracted using pdfplumber (20622 chars)
[13:33:27] 🔄 
🔄 Step 2: Extracting patient data...
[13:33:30] ℹ️  AI extracted raw sex value: 'F'
[13:33:30] ℹ️  AI extracted service line: 'PT, OT'
[13:33:30] ℹ️  AI extracted payer source: ''
[13:33:30] ℹ️  AI extracted diagnoses:
[13:33:30] ℹ️    - Diagnosis 1: 'G35'
[13:33:30] ℹ️    - Diagnosis 2: 'G62.9'
[13:33:30] ℹ️    - Diagnosis 3: 'E66.3'
[13:33:30] ℹ️    - Diagnosis 4: 'Z68.32'
[13:33:30] ℹ️    - Diagnosis 5: 'M47.819'
[13:33:30] ℹ️    - Diagnosis 6: 'I73.9'
[13:33:30] ℹ️  Final extracted MRN: '2125015'
[13:33:30] ℹ️  Final extracted Sex: 'FEMALE'
[13:33:30] ℹ️  Final extracted Service Line: 'PT, OT'
[13:33:30] ℹ️  Final extracted Payer Source: ''
[13:33:30] ✅ Patient data extraction completed successfully
[13:33:30] ✅    ✅ Patient data extracted successfully
[13:33:30] 📊 Patient Response
     └─ patientFName: Doreen
     └─ patientLName: Pacheco
     └─ dob: 05/12/1977
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2125015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/19/2025', 'startOfEpisode': '05/19/2025', 'endOfEpisode': '07/17/2025', 'firstDiagnosis': 'G35', 'secondDiagnosis': 'G62.9', 'thirdDiagnosis': 'E66.3', 'fourthDiagnosis': 'Z68.32', 'fifthDiagnosis': 'M47.819', 'sixthDiagnosis': 'I73.9'}]
[13:33:30] ✅    ✅ Patient identified: Doreen Pacheco
[13:33:30] ✅    ✅ Patient name validation passed
[13:33:30] 🔄 
🔄 Step 3: Processing patient dates...
[13:33:30] [DOC: 9313796] ℹ️  DOB normalized: 05/12/1977
[13:33:30] [DOC: 9313796] ℹ️  Episode startOfCare normalized: 05/19/2025
[13:33:30] [DOC: 9313796] ℹ️  Episode startOfEpisode normalized: 05/19/2025
[13:33:30] [DOC: 9313796] ℹ️  Episode endOfEpisode normalized: 07/17/2025
[13:33:30] [DOC: 9313796] ✅ Patient date processing completed successfully
[13:33:30] ✅    ✅ Date processing completed
[13:33:30] 📊 Processed Patient Data
     └─ patientFName: Doreen
     └─ patientLName: Pacheco
     └─ dob: 05/12/1977
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2125015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/19/2025', 'startOfEpisode': '05/19/2025', 'endOfEpisode': '07/17/2025', 'firstDiagnosis': 'G35', 'secondDiagnosis': 'G62.9', 'thirdDiagnosis': 'E66.3', 'fourthDiagnosis': 'Z68.32', 'fifthDiagnosis': 'M47.819', 'sixthDiagnosis': 'I73.9'}]
[13:33:30] 🔄 
🔄 Step 4: Extracting order data...
[13:33:33] ℹ️  Order extraction - MRN: '2125015'
[13:33:33] ℹ️  Order extraction - Sex: 'FEMALE'
[13:33:33] ℹ️  Order extraction - Service Line: 'PT, OT'
[13:33:33] ℹ️  Order extraction - Payer Source: ''
[13:33:33] ✅ Order data extraction completed successfully
[13:33:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:33:33] ℹ️  Using MRN from patient data: '2125015' over '2125015'
[13:33:33] ℹ️  Service line consistent in both sources: 'PT, OT'
[13:33:33] ✅ Patient name cross-validation successful
[13:33:33] ✅    ✅ Data merged successfully
[13:33:34] ✅    ✅ Order data extracted and validated
[13:33:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:33:44] [DOC: 9313796] ✅ Patient exists in API: Doreen Pacheco, ID: 100077af-9a11-4b51-8e1b-f6644e3351a5
[13:33:44] ✅    ✅ Existing patient found with ID: 100077af-9a11-4b51-8e1b-f6644e3351a5
[13:33:44] 🔄 
🔄 Step 6: Pushing order to API...
[13:33:44] [DOC: 9313796] ℹ️  Pushing order via API for patient ID: 100077af-9a11-4b51-8e1b-f6644e3351a5
[13:33:45] [DOC: 9313796] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:33:45] ❌    ❌ Failed to push order
[13:33:45] 🔄 
🔄 Step 7: Writing to CSV...
[13:33:45] [DOC: 9313796] ℹ️  Calculated age: 48 from DOB: 05/12/1977
[13:33:45] [DOC: 9313796] ℹ️  Service Line extracted: 'PT, OT'
[13:33:45] [DOC: 9313796] ℹ️  Payer Source extracted: ''
[13:33:45] [DOC: 9313796] ℹ️  Diagnosis codes being written:
[13:33:45] [DOC: 9313796] ℹ️    - Latest_Episode_Firstdiagnosis: 'G35'
[13:33:45] [DOC: 9313796] ℹ️    - Latest_Episode_Seconddiagnosis: 'G62.9'
[13:33:45] [DOC: 9313796] ℹ️    - Latest_Episode_Thirddiagnosis: 'E66.3'
[13:33:45] [DOC: 9313796] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Z68.32'
[13:33:45] [DOC: 9313796] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M47.819'
[13:33:45] [DOC: 9313796] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I73.9'
[13:33:45] [DOC: 9313796] ✅ Patient data written to CSV: Doreen Pacheco | Sex: FEMALE | Age: 48 | Service: PT, OT | Payer:  | MRN: 2125015
[13:33:45] ✅    ✅ Document 9313796 processed and saved successfully
[13:33:45] 🔄 
🔄 Step 8: Saving API details...
[13:33:45] [DOC: 9313796] ℹ️  API push details saved for document 9313796
[13:33:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313776                         ║
================================================================================
[13:33:45] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:33:45] ℹ️  Date: 05/28/2025
[13:33:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:33:46] [DOC: 9313776] ✅ Text extracted using pdfplumber (1336 chars)
[13:33:46] ✅    ✅ Text extracted using pdfplumber (1336 chars)
[13:33:46] 🔄 
🔄 Step 2: Extracting patient data...
[13:33:48] ℹ️  AI extracted raw sex value: 'F'
[13:33:48] ℹ️  AI extracted service line: 'PT'
[13:33:48] ℹ️  AI extracted payer source: ''
[13:33:48] ℹ️  AI extracted diagnoses:
[13:33:48] ℹ️    - Diagnosis 1: ''
[13:33:48] ℹ️    - Diagnosis 2: ''
[13:33:48] ℹ️    - Diagnosis 3: ''
[13:33:48] ℹ️    - Diagnosis 4: ''
[13:33:48] ℹ️    - Diagnosis 5: ''
[13:33:48] ℹ️    - Diagnosis 6: ''
[13:33:48] ℹ️  Final extracted MRN: '2122243'
[13:33:48] ℹ️  Final extracted Sex: 'FEMALE'
[13:33:48] ℹ️  Final extracted Service Line: 'PT'
[13:33:48] ℹ️  Final extracted Payer Source: ''
[13:33:48] ✅ Patient data extraction completed successfully
[13:33:48] ✅    ✅ Patient data extracted successfully
[13:33:48] 📊 Patient Response
     └─ patientFName: Carolyn
     └─ patientLName: Miranda
     └─ dob: 08/30/1961
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2122243
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:33:48] ✅    ✅ Patient identified: Carolyn Miranda
[13:33:48] ✅    ✅ Patient name validation passed
[13:33:48] 🔄 
🔄 Step 3: Processing patient dates...
[13:33:48] [DOC: 9313776] ℹ️  DOB normalized: 08/30/1961
[13:33:48] [DOC: 9313776] ✅ Patient date processing completed successfully
[13:33:48] ✅    ✅ Date processing completed
[13:33:48] 📊 Processed Patient Data
     └─ patientFName: Carolyn
     └─ patientLName: Miranda
     └─ dob: 08/30/1961
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2122243
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:33:48] 🔄 
🔄 Step 4: Extracting order data...
[13:33:51] ℹ️  Order extraction - MRN: '2122243'
[13:33:51] ℹ️  Order extraction - Sex: 'FEMALE'
[13:33:51] ℹ️  Order extraction - Service Line: ''
[13:33:51] ℹ️  Order extraction - Payer Source: ''
[13:33:51] ✅ Order data extraction completed successfully
[13:33:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:33:51] ℹ️  Using MRN from patient data: '2122243' over '2122243'
[13:33:51] ℹ️  Using service line from patient data: 'PT'
[13:33:51] ✅ Patient name cross-validation successful
[13:33:51] ✅    ✅ Data merged successfully
[13:33:52] ⚠️     ❌ Skipping - missing episode start date
[13:33:52] [DOC: 9313776] ℹ️  API push details saved for document 9313776
================================================================================
║                        Processing Document ID: 9313773                         ║
================================================================================
[13:33:52] ℹ️  Agency: Dartmouth HH
[13:33:52] ℹ️  Date: 05/28/2025
[13:33:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:33:54] [DOC: 9313773] ✅ Text extracted using pdfplumber (1109 chars)
[13:33:54] ✅    ✅ Text extracted using pdfplumber (1109 chars)
[13:33:54] 🔄 
🔄 Step 2: Extracting patient data...
[13:33:57] ℹ️  AI extracted raw sex value: 'F'
[13:33:57] ℹ️  AI extracted service line: 'RN'
[13:33:57] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[13:33:57] ℹ️  AI extracted diagnoses:
[13:33:57] ℹ️    - Diagnosis 1: ''
[13:33:57] ℹ️    - Diagnosis 2: ''
[13:33:57] ℹ️    - Diagnosis 3: ''
[13:33:57] ℹ️    - Diagnosis 4: ''
[13:33:57] ℹ️    - Diagnosis 5: ''
[13:33:57] ℹ️    - Diagnosis 6: ''
[13:33:57] ℹ️  Final extracted MRN: '4398011'
[13:33:57] ℹ️  Final extracted Sex: 'FEMALE'
[13:33:57] ℹ️  Final extracted Service Line: 'RN'
[13:33:57] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[13:33:57] ✅ Patient data extraction completed successfully
[13:33:57] ✅    ✅ Patient data extracted successfully
[13:33:57] 📊 Patient Response
     └─ patientFName: Elaine
     └─ patientLName: Dos Santos
     └─ dob: 06/30/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4398011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '12/15/2024', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:33:57] ✅    ✅ Patient identified: Elaine Dos Santos
[13:33:57] ✅    ✅ Patient name validation passed
[13:33:57] 🔄 
🔄 Step 3: Processing patient dates...
[13:33:57] [DOC: 9313773] ℹ️  DOB normalized: 06/30/1950
[13:33:57] [DOC: 9313773] ℹ️  Episode startOfCare normalized: 12/15/2024
[13:33:57] [DOC: 9313773] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[13:33:57] [DOC: 9313773] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[13:33:57] [DOC: 9313773] ✅ Patient date processing completed successfully
[13:33:57] ✅    ✅ Date processing completed
[13:33:57] 📊 Processed Patient Data
     └─ patientFName: Elaine
     └─ patientLName: Dos Santos
     └─ dob: 06/30/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4398011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '12/15/2024', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:33:57] 🔄 
🔄 Step 4: Extracting order data...
[13:33:59] ℹ️  Order extraction - MRN: ''
[13:33:59] ℹ️  Order extraction - Sex: 'FEMALE'
[13:33:59] ℹ️  Order extraction - Service Line: 'RN'
[13:33:59] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[13:33:59] ✅ Order data extraction completed successfully
[13:33:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:33:59] ℹ️  Using MRN from patient data: '4398011'
[13:33:59] ℹ️  Service line consistent in both sources: 'RN'
[13:33:59] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[13:33:59] ✅ Patient name cross-validation successful
[13:33:59] ✅    ✅ Data merged successfully
[13:34:01] ✅    ✅ Order data extracted and validated
[13:34:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:34:07] [DOC: 9313773] ✅ Patient exists in API: Elaine Dos Santos, ID: b67987f0-df4a-470f-8698-52193755e58e
[13:34:07] ✅    ✅ Existing patient found with ID: b67987f0-df4a-470f-8698-52193755e58e
[13:34:07] 🔄 
🔄 Step 6: Pushing order to API...
[13:34:07] [DOC: 9313773] ℹ️  Pushing order via API for patient ID: b67987f0-df4a-470f-8698-52193755e58e
[13:34:09] [DOC: 9313773] ❌ Order push failed with status 201: {"id":"bcf90807-a679-4fcd-a3e8-c13ad968c4f6","orderWAVId":"ORD19941","orderNo":"4398011","orderDate":"05/22/2025","startOfCare":"12/15/2024","episodeStartDate":"04/14/2025","episodeEndDate":"06/12/2025","documentID":"9313773","mrn":"","patientName":"Dos Santos, Elaine","sentToPhysicianDate":"05/28/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":null,"signedByPhysicianStatus":false,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"INTERIM ORDERS","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"b67987f0-df4a-470f-8698-52193755e58e","companyId":"d404757d-5027-45d2-a235-24a1fe763c9a","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[13:34:09] ❌    ❌ Failed to push order
[13:34:09] 🔄 
🔄 Step 7: Writing to CSV...
[13:34:09] [DOC: 9313773] ℹ️  Calculated age: 74 from DOB: 06/30/1950
[13:34:09] [DOC: 9313773] ℹ️  Service Line extracted: 'RN'
[13:34:09] [DOC: 9313773] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[13:34:09] [DOC: 9313773] ℹ️  Diagnosis codes being written:
[13:34:09] [DOC: 9313773] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:34:09] [DOC: 9313773] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:34:09] [DOC: 9313773] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:34:09] [DOC: 9313773] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:34:09] [DOC: 9313773] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:34:09] [DOC: 9313773] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:34:09] [DOC: 9313773] ✅ Patient data written to CSV: Elaine Dos Santos | Sex: FEMALE | Age: 74 | Service: RN | Payer: Blue Cross Medicare Adv | MRN: 4398011
[13:34:09] ✅    ✅ Document 9313773 processed and saved successfully
[13:34:09] 🔄 
🔄 Step 8: Saving API details...
[13:34:09] [DOC: 9313773] ℹ️  API push details saved for document 9313773
[13:34:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313770                         ║
================================================================================
[13:34:09] ℹ️  Agency: Dartmouth HH
[13:34:09] ℹ️  Date: 05/28/2025
[13:34:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:34:12] [DOC: 9313770] ✅ Text extracted using pdfplumber (7659 chars)
[13:34:12] ✅    ✅ Text extracted using pdfplumber (7659 chars)
[13:34:12] 🔄 
🔄 Step 2: Extracting patient data...
[13:34:15] ℹ️  AI extracted raw sex value: 'F'
[13:34:15] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:34:15] ℹ️  AI extracted payer source: 'Fallon Navicare'
[13:34:15] ℹ️  AI extracted diagnoses:
[13:34:15] ℹ️    - Diagnosis 1: 'I21.4'
[13:34:15] ℹ️    - Diagnosis 2: 'K21.9'
[13:34:15] ℹ️    - Diagnosis 3: 'R13.19'
[13:34:15] ℹ️    - Diagnosis 4: 'I25.119'
[13:34:15] ℹ️    - Diagnosis 5: 'K44.9'
[13:34:15] ℹ️    - Diagnosis 6: 'I10'
[13:34:15] ℹ️  Final extracted MRN: '301015'
[13:34:15] ℹ️  Final extracted Sex: 'FEMALE'
[13:34:15] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:34:15] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[13:34:15] ✅ Patient data extraction completed successfully
[13:34:15] ✅    ✅ Patient data extracted successfully
[13:34:15] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Dacosta
     └─ dob: 10/10/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 301015
     └─ billingProvider: Robert J Caldas, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2024', 'startOfEpisode': '05/16/2024', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'I21.4', 'secondDiagnosis': 'K21.9', 'thirdDiagnosis': 'R13.19', 'fourthDiagnosis': 'I25.119', 'fifthDiagnosis': 'K44.9', 'sixthDiagnosis': 'I10'}]
[13:34:15] ✅    ✅ Patient identified: Maria Dacosta
[13:34:15] ✅    ✅ Patient name validation passed
[13:34:15] 🔄 
🔄 Step 3: Processing patient dates...
[13:34:15] [DOC: 9313770] ℹ️  DOB normalized: 10/10/1943
[13:34:15] [DOC: 9313770] ℹ️  Episode startOfCare normalized: 04/19/2024
[13:34:15] [DOC: 9313770] ℹ️  Episode startOfEpisode normalized: 05/16/2024
[13:34:15] [DOC: 9313770] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[13:34:15] [DOC: 9313770] ✅ Patient date processing completed successfully
[13:34:15] ✅    ✅ Date processing completed
[13:34:15] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Dacosta
     └─ dob: 10/10/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 301015
     └─ billingProvider: Robert J Caldas, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2024', 'startOfEpisode': '05/16/2024', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'I21.4', 'secondDiagnosis': 'K21.9', 'thirdDiagnosis': 'R13.19', 'fourthDiagnosis': 'I25.119', 'fifthDiagnosis': 'K44.9', 'sixthDiagnosis': 'I10'}]
[13:34:15] 🔄 
🔄 Step 4: Extracting order data...
[13:34:17] ℹ️  Order extraction - MRN: ''
[13:34:17] ℹ️  Order extraction - Sex: 'FEMALE'
[13:34:17] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:34:17] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[13:34:17] ✅ Order data extraction completed successfully
[13:34:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:34:17] ℹ️  Using MRN from patient data: '301015'
[13:34:17] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:34:17] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[13:34:17] ✅ Patient name cross-validation successful
[13:34:17] ✅    ✅ Data merged successfully
[13:34:19] ✅    ✅ Order data extracted and validated
[13:34:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:34:19] [DOC: 9313770] ✅ Patient found in local cache: Maria Dacosta, ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[13:34:19] ✅    ✅ Existing patient found with ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[13:34:19] 🔄 
🔄 Step 6: Pushing order to API...
[13:34:19] [DOC: 9313770] ℹ️  Pushing order via API for patient ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[13:34:20] [DOC: 9313770] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13749"}
[13:34:20] ❌    ❌ Failed to push order
[13:34:20] 🔄 
🔄 Step 7: Writing to CSV...
[13:34:20] [DOC: 9313770] ℹ️  Calculated age: 81 from DOB: 10/10/1943
[13:34:20] [DOC: 9313770] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:34:20] [DOC: 9313770] ℹ️  Payer Source extracted: 'Fallon Navicare'
[13:34:20] [DOC: 9313770] ℹ️  Diagnosis codes being written:
[13:34:20] [DOC: 9313770] ℹ️    - Latest_Episode_Firstdiagnosis: 'I21.4'
[13:34:20] [DOC: 9313770] ℹ️    - Latest_Episode_Seconddiagnosis: 'K21.9'
[13:34:20] [DOC: 9313770] ℹ️    - Latest_Episode_Thirddiagnosis: 'R13.19'
[13:34:20] [DOC: 9313770] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I25.119'
[13:34:20] [DOC: 9313770] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K44.9'
[13:34:20] [DOC: 9313770] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I10'
[13:34:20] [DOC: 9313770] ✅ Patient data written to CSV: Maria Dacosta | Sex: FEMALE | Age: 81 | Service: Skilled Nursing | Payer: Fallon Navicare | MRN: 301015
[13:34:20] ✅    ✅ Document 9313770 processed and saved successfully
[13:34:20] 🔄 
🔄 Step 8: Saving API details...
[13:34:20] [DOC: 9313770] ℹ️  API push details saved for document 9313770
[13:34:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313769                         ║
================================================================================
[13:34:20] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:34:20] ℹ️  Date: 05/28/2025
[13:34:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:34:21] [DOC: 9313769] ✅ Text extracted using pdfplumber (1090 chars)
[13:34:21] ✅    ✅ Text extracted using pdfplumber (1090 chars)
[13:34:21] 🔄 
🔄 Step 2: Extracting patient data...
[13:34:24] ℹ️  AI extracted raw sex value: 'F'
[13:34:24] ℹ️  AI extracted service line: 'Occupational Therapy'
[13:34:24] ℹ️  AI extracted payer source: ''
[13:34:24] ℹ️  AI extracted diagnoses:
[13:34:24] ℹ️    - Diagnosis 1: ''
[13:34:24] ℹ️    - Diagnosis 2: ''
[13:34:24] ℹ️    - Diagnosis 3: ''
[13:34:24] ℹ️    - Diagnosis 4: ''
[13:34:24] ℹ️    - Diagnosis 5: ''
[13:34:24] ℹ️    - Diagnosis 6: ''
[13:34:24] ℹ️  Final extracted MRN: '2476336'
[13:34:24] ℹ️  Final extracted Sex: 'FEMALE'
[13:34:24] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[13:34:24] ℹ️  Final extracted Payer Source: ''
[13:34:24] ✅ Patient data extraction completed successfully
[13:34:24] ✅    ✅ Patient data extracted successfully
[13:34:24] 📊 Patient Response
     └─ patientFName: Kathleen
     └─ patientLName: Fletcher
     └─ dob: 03/28/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2476336
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/03/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:34:24] ✅    ✅ Patient identified: Kathleen Fletcher
[13:34:24] ✅    ✅ Patient name validation passed
[13:34:24] 🔄 
🔄 Step 3: Processing patient dates...
[13:34:24] [DOC: 9313769] ℹ️  DOB normalized: 03/28/1945
[13:34:24] [DOC: 9313769] ℹ️  Episode startOfEpisode normalized: 05/03/2025
[13:34:24] [DOC: 9313769] ℹ️  Episode endOfEpisode normalized: 07/01/2025
[13:34:24] [DOC: 9313769] ✅ Patient date processing completed successfully
[13:34:24] ✅    ✅ Date processing completed
[13:34:24] 📊 Processed Patient Data
     └─ patientFName: Kathleen
     └─ patientLName: Fletcher
     └─ dob: 03/28/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2476336
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/03/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:34:24] 🔄 
🔄 Step 4: Extracting order data...
[13:34:26] ℹ️  Order extraction - MRN: '2476336'
[13:34:26] ℹ️  Order extraction - Sex: 'FEMALE'
[13:34:26] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[13:34:26] ℹ️  Order extraction - Payer Source: ''
[13:34:26] ✅ Order data extraction completed successfully
[13:34:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:34:26] ℹ️  Using MRN from patient data: '2476336' over '2476336'
[13:34:26] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[13:34:26] ✅ Patient name cross-validation successful
[13:34:26] ✅    ✅ Data merged successfully
[13:34:27] ✅    ✅ Order data extracted and validated
[13:34:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:34:31] [DOC: 9313769] ✅ Patient exists in API: Kathleen Fletcher, ID: 8d503e74-0fe5-45d3-8f98-cb96855a3cd5
[13:34:31] ✅    ✅ Existing patient found with ID: 8d503e74-0fe5-45d3-8f98-cb96855a3cd5
[13:34:31] 🔄 
🔄 Step 6: Pushing order to API...
[13:34:31] [DOC: 9313769] ℹ️  Pushing order via API for patient ID: 8d503e74-0fe5-45d3-8f98-cb96855a3cd5
[13:34:33] [DOC: 9313769] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16457"}
[13:34:33] ❌    ❌ Failed to push order
[13:34:33] 🔄 
🔄 Step 7: Writing to CSV...
[13:34:33] [DOC: 9313769] ℹ️  Calculated age: 80 from DOB: 03/28/1945
[13:34:33] [DOC: 9313769] ℹ️  Service Line extracted: 'Occupational Therapy'
[13:34:33] [DOC: 9313769] ℹ️  Payer Source extracted: ''
[13:34:33] [DOC: 9313769] ℹ️  Diagnosis codes being written:
[13:34:33] [DOC: 9313769] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:34:33] [DOC: 9313769] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:34:33] [DOC: 9313769] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:34:33] [DOC: 9313769] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:34:33] [DOC: 9313769] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:34:33] [DOC: 9313769] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:34:33] [DOC: 9313769] ✅ Patient data written to CSV: Kathleen Fletcher | Sex: FEMALE | Age: 80 | Service: Occupational Therapy | Payer:  | MRN: 2476336
[13:34:33] ✅    ✅ Document 9313769 processed and saved successfully
[13:34:33] 🔄 
🔄 Step 8: Saving API details...
[13:34:33] [DOC: 9313769] ℹ️  API push details saved for document 9313769
[13:34:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313765                         ║
================================================================================
[13:34:33] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:34:33] ℹ️  Date: 05/28/2025
[13:34:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:34:34] [DOC: 9313765] ✅ Text extracted using pdfplumber (1754 chars)
[13:34:34] ✅    ✅ Text extracted using pdfplumber (1754 chars)
[13:34:34] 🔄 
🔄 Step 2: Extracting patient data...
[13:34:37] ℹ️  AI extracted raw sex value: 'F'
[13:34:37] ℹ️  AI extracted service line: 'Occupational Therapy'
[13:34:37] ℹ️  AI extracted payer source: ''
[13:34:37] ℹ️  AI extracted diagnoses:
[13:34:37] ℹ️    - Diagnosis 1: ''
[13:34:37] ℹ️    - Diagnosis 2: ''
[13:34:37] ℹ️    - Diagnosis 3: ''
[13:34:37] ℹ️    - Diagnosis 4: ''
[13:34:37] ℹ️    - Diagnosis 5: ''
[13:34:37] ℹ️    - Diagnosis 6: ''
[13:34:37] ℹ️  Final extracted MRN: '2240353'
[13:34:37] ℹ️  Final extracted Sex: 'FEMALE'
[13:34:37] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[13:34:37] ℹ️  Final extracted Payer Source: ''
[13:34:37] ✅ Patient data extraction completed successfully
[13:34:37] ✅    ✅ Patient data extracted successfully
[13:34:37] 📊 Patient Response
     └─ patientFName: Eileen
     └─ patientLName: Bettencourt
     └─ dob: 04/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2240353
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/28/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:34:37] ✅    ✅ Patient identified: Eileen Bettencourt
[13:34:37] ✅    ✅ Patient name validation passed
[13:34:37] 🔄 
🔄 Step 3: Processing patient dates...
[13:34:37] [DOC: 9313765] ℹ️  DOB normalized: 04/20/1945
[13:34:37] [DOC: 9313765] ℹ️  Episode startOfEpisode normalized: 04/28/2025
[13:34:37] [DOC: 9313765] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[13:34:37] [DOC: 9313765] ✅ Patient date processing completed successfully
[13:34:37] ✅    ✅ Date processing completed
[13:34:37] 📊 Processed Patient Data
     └─ patientFName: Eileen
     └─ patientLName: Bettencourt
     └─ dob: 04/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2240353
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/28/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:34:37] 🔄 
🔄 Step 4: Extracting order data...
[13:34:39] ℹ️  Order extraction - MRN: '2240353'
[13:34:39] ℹ️  Order extraction - Sex: 'FEMALE'
[13:34:39] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[13:34:39] ℹ️  Order extraction - Payer Source: ''
[13:34:39] ✅ Order data extraction completed successfully
[13:34:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:34:39] ℹ️  Using MRN from patient data: '2240353' over '2240353'
[13:34:39] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[13:34:39] ✅ Patient name cross-validation successful
[13:34:39] ✅    ✅ Data merged successfully
[13:34:40] ✅    ✅ Order data extracted and validated
[13:34:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:34:48] [DOC: 9313765] ✅ Patient exists in API: Eileen Bettencourt, ID: 84661b2c-41d1-4c36-880b-755f6bfce542
[13:34:48] ✅    ✅ Existing patient found with ID: 84661b2c-41d1-4c36-880b-755f6bfce542
[13:34:48] 🔄 
🔄 Step 6: Pushing order to API...
[13:34:48] [DOC: 9313765] ℹ️  Pushing order via API for patient ID: 84661b2c-41d1-4c36-880b-755f6bfce542
[13:34:50] [DOC: 9313765] ❌ Order push failed with status 201: {"id":"e9782d2b-5cc2-4467-b3f4-2639944a3827","orderWAVId":"ORD19942","orderNo":"1095370, 1095391","orderDate":"05/27/2025","startOfCare":"04/28/2025","episodeStartDate":"04/28/2025","episodeEndDate":"06/07/2025","documentID":"9313765","mrn":"2240353","patientName":"Bettencourt,Eileen","sentToPhysicianDate":"05/28/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"06/03/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"84661b2c-41d1-4c36-880b-755f6bfce542","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[13:34:50] ❌    ❌ Failed to push order
[13:34:50] 🔄 
🔄 Step 7: Writing to CSV...
[13:34:50] [DOC: 9313765] ℹ️  Calculated age: 80 from DOB: 04/20/1945
[13:34:50] [DOC: 9313765] ℹ️  Service Line extracted: 'Occupational Therapy'
[13:34:50] [DOC: 9313765] ℹ️  Payer Source extracted: ''
[13:34:50] [DOC: 9313765] ℹ️  Diagnosis codes being written:
[13:34:50] [DOC: 9313765] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:34:50] [DOC: 9313765] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:34:50] [DOC: 9313765] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:34:50] [DOC: 9313765] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:34:50] [DOC: 9313765] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:34:50] [DOC: 9313765] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:34:50] [DOC: 9313765] ✅ Patient data written to CSV: Eileen Bettencourt | Sex: FEMALE | Age: 80 | Service: Occupational Therapy | Payer:  | MRN: 2240353
[13:34:50] ✅    ✅ Document 9313765 processed and saved successfully
[13:34:50] 🔄 
🔄 Step 8: Saving API details...
[13:34:50] [DOC: 9313765] ℹ️  API push details saved for document 9313765
[13:34:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313762                         ║
================================================================================
[13:34:50] ℹ️  Agency: Dartmouth HH
[13:34:50] ℹ️  Date: 05/28/2025
[13:34:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:34:52] [DOC: 9313762] ✅ Text extracted using pdfplumber (964 chars)
[13:34:52] ✅    ✅ Text extracted using pdfplumber (964 chars)
[13:34:52] 🔄 
🔄 Step 2: Extracting patient data...
[13:34:55] ℹ️  AI extracted raw sex value: 'M'
[13:34:55] ℹ️  AI extracted service line: 'MSW'
[13:34:55] ℹ️  AI extracted payer source: 'Medicare'
[13:34:55] ℹ️  AI extracted diagnoses:
[13:34:55] ℹ️    - Diagnosis 1: ''
[13:34:55] ℹ️    - Diagnosis 2: ''
[13:34:55] ℹ️    - Diagnosis 3: ''
[13:34:55] ℹ️    - Diagnosis 4: ''
[13:34:55] ℹ️    - Diagnosis 5: ''
[13:34:55] ℹ️    - Diagnosis 6: ''
[13:34:55] ℹ️  Final extracted MRN: '864008'
[13:34:55] ℹ️  Final extracted Sex: 'MALE'
[13:34:55] ℹ️  Final extracted Service Line: 'MSW'
[13:34:55] ℹ️  Final extracted Payer Source: 'Medicare'
[13:34:55] ✅ Patient data extraction completed successfully
[13:34:55] ✅    ✅ Patient data extracted successfully
[13:34:55] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Lawton
     └─ dob: 06/15/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 864008
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '05/17/2025', 'endOfEpisode': '07/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:34:55] ✅    ✅ Patient identified: Robert Lawton
[13:34:55] ✅    ✅ Patient name validation passed
[13:34:55] 🔄 
🔄 Step 3: Processing patient dates...
[13:34:55] [DOC: 9313762] ℹ️  DOB normalized: 06/15/1943
[13:34:55] [DOC: 9313762] ℹ️  Episode startOfCare normalized: 03/18/2025
[13:34:55] [DOC: 9313762] ℹ️  Episode startOfEpisode normalized: 05/17/2025
[13:34:55] [DOC: 9313762] ℹ️  Episode endOfEpisode normalized: 07/15/2025
[13:34:55] [DOC: 9313762] ✅ Patient date processing completed successfully
[13:34:55] ✅    ✅ Date processing completed
[13:34:55] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Lawton
     └─ dob: 06/15/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 864008
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '05/17/2025', 'endOfEpisode': '07/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:34:55] 🔄 
🔄 Step 4: Extracting order data...
[13:34:57] ℹ️  Order extraction - MRN: ''
[13:34:57] ℹ️  Order extraction - Sex: 'MALE'
[13:34:57] ℹ️  Order extraction - Service Line: 'MSW'
[13:34:57] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:34:57] ✅ Order data extraction completed successfully
[13:34:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:34:57] ℹ️  Using MRN from patient data: '864008'
[13:34:57] ℹ️  Service line consistent in both sources: 'MSW'
[13:34:57] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:34:57] ✅ Patient name cross-validation successful
[13:34:57] ✅    ✅ Data merged successfully
[13:34:59] ✅    ✅ Order data extracted and validated
[13:34:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:35:05] [DOC: 9313762] ℹ️  Patient not found in cache or API: Robert Lawton
[13:35:05] [DOC: 9313762] ℹ️  Patient not found, creating new patient via API...
[13:35:05] [DOC: 9313762] ℹ️  Creating patient via API: Robert Lawton
[13:35:06] [DOC: 9313762] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:35:06] ❌    ❌ Failed to create patient
[13:35:06] [DOC: 9313762] ℹ️  API push details saved for document 9313762
================================================================================
║                        Processing Document ID: 9313761                         ║
================================================================================
[13:35:06] ℹ️  Agency: Dartmouth HH
[13:35:06] ℹ️  Date: 05/28/2025
[13:35:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:35:08] [DOC: 9313761] ✅ Text extracted using pdfplumber (975 chars)
[13:35:08] ✅    ✅ Text extracted using pdfplumber (975 chars)
[13:35:08] 🔄 
🔄 Step 2: Extracting patient data...
[13:35:11] ℹ️  AI extracted raw sex value: 'F'
[13:35:11] ℹ️  AI extracted service line: 'OT'
[13:35:11] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[13:35:11] ℹ️  AI extracted diagnoses:
[13:35:11] ℹ️    - Diagnosis 1: 'None'
[13:35:11] ℹ️    - Diagnosis 2: 'None'
[13:35:11] ℹ️    - Diagnosis 3: 'None'
[13:35:11] ℹ️    - Diagnosis 4: 'None'
[13:35:11] ℹ️    - Diagnosis 5: 'None'
[13:35:11] ℹ️    - Diagnosis 6: 'None'
[13:35:11] ℹ️  Final extracted MRN: '6073015'
[13:35:11] ℹ️  Final extracted Sex: 'FEMALE'
[13:35:11] ℹ️  Final extracted Service Line: 'OT'
[13:35:11] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[13:35:11] ✅ Patient data extraction completed successfully
[13:35:11] ✅    ✅ Patient data extracted successfully
[13:35:11] 📊 Patient Response
     └─ patientFName: Marilyn
     └─ patientLName: Valle
     └─ dob: 12/24/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6073015
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 107 Main St. Apt 1
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:35:11] ✅    ✅ Patient identified: Marilyn Valle
[13:35:11] ✅    ✅ Patient name validation passed
[13:35:11] 🔄 
🔄 Step 3: Processing patient dates...
[13:35:11] [DOC: 9313761] ℹ️  DOB normalized: 12/24/1947
[13:35:11] [DOC: 9313761] ℹ️  Episode startOfCare normalized: 02/22/2025
[13:35:11] [DOC: 9313761] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[13:35:11] [DOC: 9313761] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[13:35:11] [DOC: 9313761] ✅ Patient date processing completed successfully
[13:35:11] ✅    ✅ Date processing completed
[13:35:11] 📊 Processed Patient Data
     └─ patientFName: Marilyn
     └─ patientLName: Valle
     └─ dob: 12/24/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6073015
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 107 Main St. Apt 1
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '02/22/2025', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025'}]
[13:35:11] 🔄 
🔄 Step 4: Extracting order data...
[13:35:13] ℹ️  Order extraction - MRN: ''
[13:35:13] ℹ️  Order extraction - Sex: 'FEMALE'
[13:35:13] ℹ️  Order extraction - Service Line: 'OT'
[13:35:13] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[13:35:13] ✅ Order data extraction completed successfully
[13:35:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:35:13] ℹ️  Using MRN from patient data: '6073015'
[13:35:13] ℹ️  Service line consistent in both sources: 'OT'
[13:35:13] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[13:35:13] ✅ Patient name cross-validation successful
[13:35:13] ✅    ✅ Data merged successfully
[13:35:14] ✅    ✅ Order data extracted and validated
[13:35:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:35:20] [DOC: 9313761] ✅ Patient exists in API: Marilyn Valle, ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[13:35:20] ✅    ✅ Existing patient found with ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[13:35:20] 🔄 
🔄 Step 6: Pushing order to API...
[13:35:20] [DOC: 9313761] ℹ️  Pushing order via API for patient ID: 7a20fbbe-2207-43b3-b935-f7936e90d176
[13:35:21] [DOC: 9313761] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:35:21] ❌    ❌ Failed to push order
[13:35:21] 🔄 
🔄 Step 7: Writing to CSV...
[13:35:21] [DOC: 9313761] ℹ️  Calculated age: 77 from DOB: 12/24/1947
[13:35:21] [DOC: 9313761] ℹ️  Service Line extracted: 'OT'
[13:35:21] [DOC: 9313761] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[13:35:21] [DOC: 9313761] ℹ️  Diagnosis codes being written:
[13:35:21] [DOC: 9313761] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:35:21] [DOC: 9313761] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:35:21] [DOC: 9313761] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:35:21] [DOC: 9313761] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:35:21] [DOC: 9313761] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:35:21] [DOC: 9313761] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:35:21] [DOC: 9313761] ✅ Patient data written to CSV: Marilyn Valle | Sex: FEMALE | Age: 77 | Service: OT | Payer: Aetna- Mcare | MRN: 6073015
[13:35:21] ✅    ✅ Document 9313761 processed and saved successfully
[13:35:21] 🔄 
🔄 Step 8: Saving API details...
[13:35:21] [DOC: 9313761] ℹ️  API push details saved for document 9313761
[13:35:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313737                         ║
================================================================================
[13:35:21] ℹ️  Agency: AccentCare Fall River
[13:35:21] ℹ️  Date: 05/28/2025
[13:35:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:35:24] [DOC: 9313737] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[13:35:25] [DOC: 9313737] ✅ Text extracted using tesseract_ocr (1114 chars)
[13:35:25] ✅    ✅ Text extracted using tesseract_ocr (1105 chars)
[13:35:25] 🔄 
🔄 Step 2: Extracting patient data...
[13:35:27] ℹ️  AI extracted raw sex value: ''
[13:35:27] ℹ️  AI extracted service line: 'PT'
[13:35:27] ℹ️  AI extracted payer source: ''
[13:35:27] ℹ️  AI extracted diagnoses:
[13:35:27] ℹ️    - Diagnosis 1: ''
[13:35:27] ℹ️    - Diagnosis 2: ''
[13:35:27] ℹ️    - Diagnosis 3: ''
[13:35:27] ℹ️    - Diagnosis 4: ''
[13:35:27] ℹ️    - Diagnosis 5: ''
[13:35:27] ℹ️    - Diagnosis 6: ''
[13:35:27] ℹ️  Final extracted MRN: 'C0200241497901'
[13:35:27] ℹ️  Final extracted Sex: ''
[13:35:27] ℹ️  Final extracted Service Line: 'PT'
[13:35:27] ℹ️  Final extracted Payer Source: ''
[13:35:27] ✅ Patient data extraction completed successfully
[13:35:27] ✅    ✅ Patient data extracted successfully
[13:35:27] 📊 Patient Response
     └─ patientFName: LEIG
     └─ patientLName: KINNEY
     └─ dob: 06/05/1975
     └─ patientSex: 
     └─ medicalRecordNo: C0200241497901
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 277 PLEASANT ST, BLDG 1 STE 101
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02721-
     └─ email: 
     └─ phoneNumber: (508)646-7645
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:35:27] ✅    ✅ Patient identified: LEIG KINNEY
[13:35:27] ✅    ✅ Patient name validation passed
[13:35:27] 🔄 
🔄 Step 3: Processing patient dates...
[13:35:27] [DOC: 9313737] ℹ️  DOB normalized: 06/05/1975
[13:35:27] [DOC: 9313737] ✅ Patient date processing completed successfully
[13:35:27] ✅    ✅ Date processing completed
[13:35:27] 📊 Processed Patient Data
     └─ patientFName: LEIG
     └─ patientLName: KINNEY
     └─ dob: 06/05/1975
     └─ patientSex: 
     └─ medicalRecordNo: C0200241497901
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 277 PLEASANT ST, BLDG 1 STE 101
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02721-
     └─ email: 
     └─ phoneNumber: (508)646-7645
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:35:27] 🔄 
🔄 Step 4: Extracting order data...
[13:35:30] ℹ️  Order extraction - MRN: 'C0200241497901'
[13:35:30] ℹ️  Order extraction - Sex: ''
[13:35:30] ℹ️  Order extraction - Service Line: 'PT'
[13:35:30] ℹ️  Order extraction - Payer Source: ''
[13:35:30] ✅ Order data extraction completed successfully
[13:35:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:35:30] ℹ️  Using MRN from patient data: 'C0200241497901' over 'C0200241497901'
[13:35:30] ⚠️  Could not determine sex using any available method
[13:35:30] ℹ️  Service line consistent in both sources: 'PT'
[13:35:30] ✅ Patient name cross-validation successful
[13:35:30] ✅    ✅ Data merged successfully
[13:35:31] ✅    ✅ Order data extracted and validated
[13:35:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:35:46] [DOC: 9313737] ✅ Patient exists in API: LEIG KINNEY, ID: 5f79bb05-12ee-4c1d-95f6-a3687e5e51a6
[13:35:46] ✅    ✅ Existing patient found with ID: 5f79bb05-12ee-4c1d-95f6-a3687e5e51a6
[13:35:46] 🔄 
🔄 Step 6: Pushing order to API...
[13:35:46] [DOC: 9313737] ℹ️  Pushing order via API for patient ID: 5f79bb05-12ee-4c1d-95f6-a3687e5e51a6
[13:35:48] [DOC: 9313737] ❌ Order push failed with status 201: {"id":"c50c31b1-53a4-4ff2-81f3-e3d9dd348878","orderWAVId":"ORD19943","orderNo":"12257426","orderDate":"05/27/2025","startOfCare":"05/25/2025","episodeStartDate":"05/25/2025","episodeEndDate":"07/23/2025","documentID":"9313737","mrn":"C0200241497901","patientName":"LEIG KINNEY, JESSICA","sentToPhysicianDate":"05/28/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"06/04/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"PHYSICIAN ORDER","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"5f79bb05-12ee-4c1d-95f6-a3687e5e51a6","companyId":"c7cc6389-e15a-468f-bfbc-bc60ac4d4e81","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[13:35:48] ❌    ❌ Failed to push order
[13:35:48] 🔄 
🔄 Step 7: Writing to CSV...
[13:35:48] [DOC: 9313737] ℹ️  Calculated age: 50 from DOB: 06/05/1975
[13:35:48] [DOC: 9313737] ℹ️  Service Line extracted: 'PT'
[13:35:48] [DOC: 9313737] ℹ️  Payer Source extracted: ''
[13:35:48] [DOC: 9313737] ℹ️  Diagnosis codes being written:
[13:35:48] [DOC: 9313737] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:35:48] [DOC: 9313737] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:35:48] [DOC: 9313737] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:35:48] [DOC: 9313737] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:35:48] [DOC: 9313737] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:35:48] [DOC: 9313737] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:35:48] [DOC: 9313737] ✅ Patient data written to CSV: LEIG KINNEY | Sex:  | Age: 50 | Service: PT | Payer:  | MRN: C0200241497901
[13:35:48] ✅    ✅ Document 9313737 processed and saved successfully
[13:35:48] 🔄 
🔄 Step 8: Saving API details...
[13:35:48] [DOC: 9313737] ℹ️  API push details saved for document 9313737
[13:35:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313736                         ║
================================================================================
[13:35:48] ℹ️  Agency: AccentCare Fall River
[13:35:48] ℹ️  Date: 05/28/2025
[13:35:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:36:03] [DOC: 9313736] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[13:36:14] [DOC: 9313736] ✅ Text extracted using tesseract_ocr (22679 chars)
[13:36:14] ✅    ✅ Text extracted using tesseract_ocr (22655 chars)
[13:36:14] 🔄 
🔄 Step 2: Extracting patient data...
[13:36:18] ℹ️  AI extracted raw sex value: 'F'
[13:36:18] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[13:36:18] ℹ️  AI extracted payer source: 'Medicare'
[13:36:18] ℹ️  AI extracted diagnoses:
[13:36:18] ℹ️    - Diagnosis 1: '2471'
[13:36:18] ℹ️    - Diagnosis 2: 'E03.9'
[13:36:18] ℹ️    - Diagnosis 3: 'F17.200'
[13:36:18] ℹ️    - Diagnosis 4: '296.642'
[13:36:18] ℹ️    - Diagnosis 5: '779.82'
[13:36:18] ℹ️    - Diagnosis 6: '79181'
[13:36:18] ℹ️  Final extracted MRN: '0200241497901'
[13:36:18] ℹ️  Final extracted Sex: 'FEMALE'
[13:36:18] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[13:36:18] ℹ️  Final extracted Payer Source: 'Medicare'
[13:36:18] ✅ Patient data extraction completed successfully
[13:36:18] ✅    ✅ Patient data extracted successfully
[13:36:18] 📊 Patient Response
     └─ patientFName: JESSICA LEIG
     └─ patientLName: KINNEY
     └─ dob: 06/05/1975
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 0200241497901
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 647 MARYS POND ROAD
     └─ city: ROCHESTER
     └─ state: MA
     └─ zip: 02770-
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/15/2025', 'startOfEpisode': '05/15/2025', 'endOfEpisode': '07/13/2025', 'firstDiagnosis': '2471', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'F17.200', 'fourthDiagnosis': '296.642', 'fifthDiagnosis': '779.82', 'sixthDiagnosis': '79181'}]
[13:36:18] ✅    ✅ Patient identified: JESSICA LEIG KINNEY
[13:36:18] ✅    ✅ Patient name validation passed
[13:36:18] 🔄 
🔄 Step 3: Processing patient dates...
[13:36:18] [DOC: 9313736] ℹ️  DOB normalized: 06/05/1975
[13:36:18] [DOC: 9313736] ℹ️  Episode startOfCare normalized: 05/15/2025
[13:36:18] [DOC: 9313736] ℹ️  Episode startOfEpisode normalized: 05/15/2025
[13:36:18] [DOC: 9313736] ℹ️  Episode endOfEpisode normalized: 07/13/2025
[13:36:18] [DOC: 9313736] ✅ Patient date processing completed successfully
[13:36:18] ✅    ✅ Date processing completed
[13:36:18] 📊 Processed Patient Data
     └─ patientFName: JESSICA LEIG
     └─ patientLName: KINNEY
     └─ dob: 06/05/1975
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 0200241497901
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 647 MARYS POND ROAD
     └─ city: ROCHESTER
     └─ state: MA
     └─ zip: 02770-
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/15/2025', 'startOfEpisode': '05/15/2025', 'endOfEpisode': '07/13/2025', 'firstDiagnosis': '2471', 'secondDiagnosis': 'E03.9', 'thirdDiagnosis': 'F17.200', 'fourthDiagnosis': '296.642', 'fifthDiagnosis': '779.82', 'sixthDiagnosis': '79181'}]
[13:36:18] 🔄 
🔄 Step 4: Extracting order data...
[13:36:21] ℹ️  Order extraction - MRN: '227203'
[13:36:21] ℹ️  Order extraction - Sex: 'FEMALE'
[13:36:21] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[13:36:21] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:36:21] ✅ Order data extraction completed successfully
[13:36:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:36:21] ℹ️  Using MRN from patient data: '0200241497901' over '227203'
[13:36:21] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[13:36:21] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:36:21] ✅ Patient name cross-validation successful
[13:36:21] ✅    ✅ Data merged successfully
[13:36:22] ✅    ✅ Order data extracted and validated
[13:36:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:36:28] [DOC: 9313736] ℹ️  Patient not found in cache or API: JESSICA LEIG KINNEY
[13:36:28] [DOC: 9313736] ℹ️  Patient not found, creating new patient via API...
[13:36:28] [DOC: 9313736] ℹ️  Creating patient via API: JESSICA LEIG KINNEY
[13:36:29] [DOC: 9313736] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:36:29] ❌    ❌ Failed to create patient
[13:36:29] [DOC: 9313736] ℹ️  API push details saved for document 9313736
================================================================================
║                        Processing Document ID: 9313731                         ║
================================================================================
[13:36:29] ℹ️  Agency: AccentCare Fall River
[13:36:29] ℹ️  Date: 05/28/2025
[13:36:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:36:43] [DOC: 9313731] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[13:36:54] [DOC: 9313731] ✅ Text extracted using tesseract_ocr (22527 chars)
[13:36:54] ✅    ✅ Text extracted using tesseract_ocr (22452 chars)
[13:36:54] 🔄 
🔄 Step 2: Extracting patient data...
[13:36:58] ℹ️  AI extracted raw sex value: 'M'
[13:36:58] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[13:36:58] ℹ️  AI extracted payer source: 'Medicare'
[13:36:58] ℹ️  AI extracted diagnoses:
[13:36:58] ℹ️    - Diagnosis 1: 'M25.511'
[13:36:58] ℹ️    - Diagnosis 2: 'I10'
[13:36:58] ℹ️    - Diagnosis 3: 'E11.9'
[13:36:58] ℹ️    - Diagnosis 4: 'E78.5'
[13:36:58] ℹ️    - Diagnosis 5: 'Z96.642'
[13:36:58] ℹ️    - Diagnosis 6: 'Z79.82'
[13:36:58] ℹ️  Final extracted MRN: 'C0200241665301'
[13:36:58] ℹ️  Final extracted Sex: 'MALE'
[13:36:58] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[13:36:58] ℹ️  Final extracted Payer Source: 'Medicare'
[13:36:58] ✅ Patient data extraction completed successfully
[13:36:58] ✅    ✅ Patient data extracted successfully
[13:36:58] 📊 Patient Response
     └─ patientFName: RUSSELL
     └─ patientLName: BOLTON
     └─ dob: 06/16/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: C0200241665301
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 45 SABLE AVE
     └─ city: FALLRIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/17/2025', 'startOfEpisode': '05/17/2025', 'endOfEpisode': '07/15/2025', 'firstDiagnosis': 'M25.511', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'Z96.642', 'sixthDiagnosis': 'Z79.82'}]
[13:36:58] ✅    ✅ Patient identified: RUSSELL BOLTON
[13:36:58] ✅    ✅ Patient name validation passed
[13:36:58] 🔄 
🔄 Step 3: Processing patient dates...
[13:36:58] [DOC: 9313731] ℹ️  DOB normalized: 06/16/1960
[13:36:58] [DOC: 9313731] ℹ️  Episode startOfCare normalized: 05/17/2025
[13:36:58] [DOC: 9313731] ℹ️  Episode startOfEpisode normalized: 05/17/2025
[13:36:58] [DOC: 9313731] ℹ️  Episode endOfEpisode normalized: 07/15/2025
[13:36:58] [DOC: 9313731] ✅ Patient date processing completed successfully
[13:36:58] ✅    ✅ Date processing completed
[13:36:58] 📊 Processed Patient Data
     └─ patientFName: RUSSELL
     └─ patientLName: BOLTON
     └─ dob: 06/16/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: C0200241665301
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 45 SABLE AVE
     └─ city: FALLRIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/17/2025', 'startOfEpisode': '05/17/2025', 'endOfEpisode': '07/15/2025', 'firstDiagnosis': 'M25.511', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'E78.5', 'fifthDiagnosis': 'Z96.642', 'sixthDiagnosis': 'Z79.82'}]
[13:36:58] 🔄 
🔄 Step 4: Extracting order data...
[13:37:01] ℹ️  Order extraction - MRN: '100201839287'
[13:37:01] ℹ️  Order extraction - Sex: 'MALE'
[13:37:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[13:37:01] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:37:01] ✅ Order data extraction completed successfully
[13:37:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:37:01] ℹ️  Using MRN from patient data: 'C0200241665301' over '100201839287'
[13:37:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[13:37:01] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:37:01] ✅ Patient name cross-validation successful
[13:37:01] ✅    ✅ Data merged successfully
[13:37:02] ✅    ✅ Order data extracted and validated
[13:37:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:37:15] [DOC: 9313731] ✅ Patient exists in API: RUSSELL BOLTON, ID: 2f3ccdd3-3b01-4cfa-9047-29bba1cdd6fe
[13:37:15] ✅    ✅ Existing patient found with ID: 2f3ccdd3-3b01-4cfa-9047-29bba1cdd6fe
[13:37:15] 🔄 
🔄 Step 6: Pushing order to API...
[13:37:15] [DOC: 9313731] ℹ️  Pushing order via API for patient ID: 2f3ccdd3-3b01-4cfa-9047-29bba1cdd6fe
[13:37:16] [DOC: 9313731] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16398"}
[13:37:16] ❌    ❌ Failed to push order
[13:37:16] 🔄 
🔄 Step 7: Writing to CSV...
[13:37:16] [DOC: 9313731] ℹ️  Calculated age: 64 from DOB: 06/16/1960
[13:37:16] [DOC: 9313731] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[13:37:16] [DOC: 9313731] ℹ️  Payer Source extracted: 'Medicare'
[13:37:16] [DOC: 9313731] ℹ️  Diagnosis codes being written:
[13:37:16] [DOC: 9313731] ℹ️    - Latest_Episode_Firstdiagnosis: 'M25.511'
[13:37:16] [DOC: 9313731] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[13:37:16] [DOC: 9313731] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.9'
[13:37:16] [DOC: 9313731] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E78.5'
[13:37:16] [DOC: 9313731] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z96.642'
[13:37:16] [DOC: 9313731] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z79.82'
[13:37:16] [DOC: 9313731] ✅ Patient data written to CSV: RUSSELL BOLTON | Sex: MALE | Age: 64 | Service: Skilled Nursing, Physical Therapy | Payer: Medicare | MRN: C0200241665301
[13:37:16] ✅    ✅ Document 9313731 processed and saved successfully
[13:37:16] 🔄 
🔄 Step 8: Saving API details...
[13:37:16] [DOC: 9313731] ℹ️  API push details saved for document 9313731
[13:37:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313695                         ║
================================================================================
[13:37:16] ℹ️  Agency: Visiting Rehab & Nursing Services
[13:37:16] ℹ️  Date: 05/28/2025
[13:37:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:37:19] [DOC: 9313695] ✅ Text extracted using pdfplumber (1389 chars)
[13:37:19] ✅    ✅ Text extracted using pdfplumber (1389 chars)
[13:37:19] 🔄 
🔄 Step 2: Extracting patient data...
[13:37:21] ℹ️  AI extracted raw sex value: ''
[13:37:21] ℹ️  AI extracted service line: 'Home healthcare'
[13:37:21] ℹ️  AI extracted payer source: 'Medicare'
[13:37:21] ℹ️  AI extracted diagnoses:
[13:37:21] ℹ️    - Diagnosis 1: ''
[13:37:21] ℹ️    - Diagnosis 2: ''
[13:37:21] ℹ️    - Diagnosis 3: ''
[13:37:21] ℹ️    - Diagnosis 4: ''
[13:37:21] ℹ️    - Diagnosis 5: ''
[13:37:21] ℹ️    - Diagnosis 6: ''
[13:37:21] ℹ️  Final extracted MRN: ''
[13:37:21] ℹ️  Final extracted Sex: ''
[13:37:21] ℹ️  Final extracted Service Line: 'Home healthcare'
[13:37:21] ℹ️  Final extracted Payer Source: 'Medicare'
[13:37:21] ✅ Patient data extraction completed successfully
[13:37:21] ✅    ✅ Patient data extracted successfully
[13:37:21] 📊 Patient Response
     └─ patientFName: Thomas
     └─ patientLName: Tomko
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Visiting Rehab and Nursing Services
     └─ address: 125 High Street, Suite 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: jmartinez@vrnshh.com
     └─ phoneNumber: (774) 581-9986
     └─ serviceLine: Home healthcare
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:37:21] ⚠️     ❌ Insufficient patient data extracted
[13:37:21] [DOC: 9313695] ℹ️  API push details saved for document 9313695
================================================================================
║                        Processing Document ID: 9313694                         ║
================================================================================
[13:37:21] ℹ️  Agency: Visiting Rehab & Nursing Services
[13:37:21] ℹ️  Date: 05/28/2025
[13:37:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:37:23] [DOC: 9313694] ✅ Text extracted using pdfplumber (5066 chars)
[13:37:23] ✅    ✅ Text extracted using pdfplumber (5066 chars)
[13:37:23] 🔄 
🔄 Step 2: Extracting patient data...
[13:37:25] ℹ️  AI extracted raw sex value: 'None'
[13:37:25] ℹ️  AI extracted service line: 'None'
[13:37:25] ℹ️  AI extracted payer source: 'None'
[13:37:25] ℹ️  AI extracted diagnoses:
[13:37:25] ℹ️    - Diagnosis 1: ''
[13:37:25] ℹ️    - Diagnosis 2: ''
[13:37:25] ℹ️    - Diagnosis 3: ''
[13:37:25] ℹ️    - Diagnosis 4: ''
[13:37:25] ℹ️    - Diagnosis 5: ''
[13:37:25] ℹ️    - Diagnosis 6: ''
[13:37:25] ℹ️  Final extracted MRN: ''
[13:37:25] ℹ️  Final extracted Sex: ''
[13:37:25] ℹ️  Final extracted Service Line: ''
[13:37:25] ℹ️  Final extracted Payer Source: ''
[13:37:25] ✅ Patient data extraction completed successfully
[13:37:25] ✅    ✅ Patient data extracted successfully
[13:37:25] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[13:37:25] ⚠️     ❌ Insufficient patient data extracted
[13:37:25] [DOC: 9313694] ℹ️  API push details saved for document 9313694
================================================================================
║                        Processing Document ID: 9313692                         ║
================================================================================
[13:37:25] ℹ️  Agency: Visiting Rehab & Nursing Services
[13:37:25] ℹ️  Date: 05/28/2025
[13:37:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:37:28] [DOC: 9313692] ✅ Text extracted using pdfplumber (1333 chars)
[13:37:28] ✅    ✅ Text extracted using pdfplumber (1333 chars)
[13:37:28] 🔄 
🔄 Step 2: Extracting patient data...
[13:37:31] ℹ️  AI extracted raw sex value: ''
[13:37:31] ℹ️  AI extracted service line: 'Home healthcare'
[13:37:31] ℹ️  AI extracted payer source: 'Medicare'
[13:37:31] ℹ️  AI extracted diagnoses:
[13:37:31] ℹ️    - Diagnosis 1: ''
[13:37:31] ℹ️    - Diagnosis 2: ''
[13:37:31] ℹ️    - Diagnosis 3: ''
[13:37:31] ℹ️    - Diagnosis 4: ''
[13:37:31] ℹ️    - Diagnosis 5: ''
[13:37:31] ℹ️    - Diagnosis 6: ''
[13:37:31] ℹ️  Final extracted MRN: ''
[13:37:31] ℹ️  Final extracted Sex: ''
[13:37:31] ℹ️  Final extracted Service Line: 'Home healthcare'
[13:37:31] ℹ️  Final extracted Payer Source: 'Medicare'
[13:37:31] ✅ Patient data extraction completed successfully
[13:37:31] ✅    ✅ Patient data extracted successfully
[13:37:31] 📊 Patient Response
     └─ patientFName: Terry
     └─ patientLName: Hill
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Visiting Rehab and Nursing Services
     └─ address: 125 High Street, Suite 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: jmartinez@vrnshh.com
     └─ phoneNumber: (774) 581-9986
     └─ serviceLine: Home healthcare
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:37:31] ⚠️     ❌ Insufficient patient data extracted
[13:37:31] [DOC: 9313692] ℹ️  API push details saved for document 9313692
================================================================================
║                        Processing Document ID: 9313691                         ║
================================================================================
[13:37:31] ℹ️  Agency: AccentCare Fall River
[13:37:31] ℹ️  Date: 05/28/2025
[13:37:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:37:49] [DOC: 9313691] ⚠️  PDFPlumber failed: PDFPlumber extracted empty text, trying OCR...
[13:38:08] [DOC: 9313691] ✅ Text extracted using tesseract_ocr (38087 chars)
[13:38:08] ✅    ✅ Text extracted using tesseract_ocr (38035 chars)
[13:38:08] 🔄 
🔄 Step 2: Extracting patient data...
[13:38:12] ℹ️  AI extracted raw sex value: 'F'
[13:38:12] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:38:12] ℹ️  AI extracted payer source: 'Medicare'
[13:38:12] ℹ️  AI extracted diagnoses:
[13:38:12] ℹ️    - Diagnosis 1: 'I13.0'
[13:38:12] ℹ️    - Diagnosis 2: 'I50.33'
[13:38:12] ℹ️    - Diagnosis 3: 'E11.22'
[13:38:12] ℹ️    - Diagnosis 4: 'N18.4'
[13:38:12] ℹ️    - Diagnosis 5: 'N17.9'
[13:38:12] ℹ️    - Diagnosis 6: 'I48.91'
[13:38:12] ℹ️  Final extracted MRN: '0200167062501'
[13:38:12] ℹ️  Final extracted Sex: 'FEMALE'
[13:38:12] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:38:12] ℹ️  Final extracted Payer Source: 'Medicare'
[13:38:12] ✅ Patient data extraction completed successfully
[13:38:12] ✅    ✅ Patient data extracted successfully
[13:38:12] 📊 Patient Response
     └─ patientFName: BARBARA
     └─ patientLName: POIRIER
     └─ dob: 05/08/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 0200167062501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 596 SUMMER ST
     └─ city: FALLRIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508)235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/19/2025', 'startOfEpisode': '05/19/2025', 'endOfEpisode': '07/17/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.4', 'fifthDiagnosis': 'N17.9', 'sixthDiagnosis': 'I48.91'}]
[13:38:12] ✅    ✅ Patient identified: BARBARA POIRIER
[13:38:12] ✅    ✅ Patient name validation passed
[13:38:12] 🔄 
🔄 Step 3: Processing patient dates...
[13:38:12] [DOC: 9313691] ℹ️  DOB normalized: 05/08/1945
[13:38:12] [DOC: 9313691] ℹ️  Episode startOfCare normalized: 05/19/2025
[13:38:12] [DOC: 9313691] ℹ️  Episode startOfEpisode normalized: 05/19/2025
[13:38:12] [DOC: 9313691] ℹ️  Episode endOfEpisode normalized: 07/17/2025
[13:38:12] [DOC: 9313691] ✅ Patient date processing completed successfully
[13:38:12] ✅    ✅ Date processing completed
[13:38:12] 📊 Processed Patient Data
     └─ patientFName: BARBARA
     └─ patientLName: POIRIER
     └─ dob: 05/08/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 0200167062501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 596 SUMMER ST
     └─ city: FALLRIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508)235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/19/2025', 'startOfEpisode': '05/19/2025', 'endOfEpisode': '07/17/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.4', 'fifthDiagnosis': 'N17.9', 'sixthDiagnosis': 'I48.91'}]
[13:38:12] 🔄 
🔄 Step 4: Extracting order data...
[13:38:15] ℹ️  Order extraction - MRN: '0200167062501'
[13:38:15] ℹ️  Order extraction - Sex: 'FEMALE'
[13:38:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:38:15] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:38:15] ✅ Order data extraction completed successfully
[13:38:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:38:15] ℹ️  Using MRN from patient data: '0200167062501' over '0200167062501'
[13:38:15] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:38:15] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:38:15] ✅ Patient name cross-validation successful
[13:38:15] ✅    ✅ Data merged successfully
[13:38:17] ✅    ✅ Order data extracted and validated
[13:38:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:38:23] [DOC: 9313691] ✅ Patient exists in API: BARBARA POIRIER, ID: 90f6935e-250f-4f4f-ae77-9a828e28bfc1
[13:38:23] ✅    ✅ Existing patient found with ID: 90f6935e-250f-4f4f-ae77-9a828e28bfc1
[13:38:23] 🔄 
🔄 Step 6: Pushing order to API...
[13:38:23] [DOC: 9313691] ℹ️  Pushing order via API for patient ID: 90f6935e-250f-4f4f-ae77-9a828e28bfc1
[13:38:24] [DOC: 9313691] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16580"}
[13:38:24] ❌    ❌ Failed to push order
[13:38:24] 🔄 
🔄 Step 7: Writing to CSV...
[13:38:24] [DOC: 9313691] ℹ️  Calculated age: 80 from DOB: 05/08/1945
[13:38:24] [DOC: 9313691] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:38:24] [DOC: 9313691] ℹ️  Payer Source extracted: 'Medicare'
[13:38:24] [DOC: 9313691] ℹ️  Diagnosis codes being written:
[13:38:24] [DOC: 9313691] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[13:38:24] [DOC: 9313691] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[13:38:24] [DOC: 9313691] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[13:38:24] [DOC: 9313691] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.4'
[13:38:24] [DOC: 9313691] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N17.9'
[13:38:24] [DOC: 9313691] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I48.91'
[13:38:24] [DOC: 9313691] ✅ Patient data written to CSV: BARBARA POIRIER | Sex: FEMALE | Age: 80 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: 0200167062501
[13:38:24] ✅    ✅ Document 9313691 processed and saved successfully
[13:38:24] 🔄 
🔄 Step 8: Saving API details...
[13:38:24] [DOC: 9313691] ℹ️  API push details saved for document 9313691
[13:38:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313690                         ║
================================================================================
[13:38:24] ℹ️  Agency: Visiting Rehab & Nursing Services
[13:38:24] ℹ️  Date: 05/28/2025
[13:38:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:38:27] [DOC: 9313690] ✅ Text extracted using pdfplumber (10012 chars)
[13:38:27] ✅    ✅ Text extracted using pdfplumber (10012 chars)
[13:38:27] 🔄 
🔄 Step 2: Extracting patient data...
[13:38:30] ℹ️  AI extracted raw sex value: 'M'
[13:38:30] ℹ️  AI extracted service line: 'ST'
[13:38:30] ℹ️  AI extracted payer source: ''
[13:38:30] ℹ️  AI extracted diagnoses:
[13:38:30] ℹ️    - Diagnosis 1: 'I69351'
[13:38:30] ℹ️    - Diagnosis 2: 'R13.12'
[13:38:30] ℹ️    - Diagnosis 3: 'None'
[13:38:30] ℹ️    - Diagnosis 4: 'None'
[13:38:30] ℹ️    - Diagnosis 5: 'None'
[13:38:30] ℹ️    - Diagnosis 6: 'None'
[13:38:30] ℹ️  Final extracted MRN: 'waplABIMC076'
[13:38:30] ℹ️  Final extracted Sex: 'MALE'
[13:38:30] ℹ️  Final extracted Service Line: 'ST'
[13:38:30] ℹ️  Final extracted Payer Source: ''
[13:38:30] ✅ Patient data extraction completed successfully
[13:38:30] ✅    ✅ Patient data extracted successfully
[13:38:30] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Gingras
     └─ dob: 01/30/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: waplABIMC076
     └─ billingProvider: Hugo Jauregui MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Visiting Rehab and Nursing
     └─ address: 125 High Street , STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: 
     └─ phoneNumber: (877) 242-8771
     └─ serviceLine: ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/13/2025', 'endOfEpisode': '07/11/2025', 'firstDiagnosis': 'I69351', 'secondDiagnosis': 'R13.12', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:38:30] ✅    ✅ Patient identified: John Gingras
[13:38:30] ✅    ✅ Patient name validation passed
[13:38:30] 🔄 
🔄 Step 3: Processing patient dates...
[13:38:30] [DOC: 9313690] ℹ️  DOB normalized: 01/30/1962
[13:38:30] [DOC: 9313690] ℹ️  Episode startOfEpisode normalized: 05/13/2025
[13:38:30] [DOC: 9313690] ℹ️  Episode endOfEpisode normalized: 07/11/2025
[13:38:30] [DOC: 9313690] ✅ Patient date processing completed successfully
[13:38:30] ✅    ✅ Date processing completed
[13:38:30] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Gingras
     └─ dob: 01/30/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: waplABIMC076
     └─ billingProvider: Hugo Jauregui MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Visiting Rehab and Nursing
     └─ address: 125 High Street , STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: 
     └─ phoneNumber: (877) 242-8771
     └─ serviceLine: ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/13/2025', 'endOfEpisode': '07/11/2025', 'firstDiagnosis': 'I69351', 'secondDiagnosis': 'R13.12'}]
[13:38:30] 🔄 
🔄 Step 4: Extracting order data...
[13:38:33] ℹ️  Order extraction - MRN: 'waplABIMC076'
[13:38:33] ℹ️  Order extraction - Sex: 'MALE'
[13:38:33] ℹ️  Order extraction - Service Line: 'ST'
[13:38:33] ℹ️  Order extraction - Payer Source: ''
[13:38:33] ✅ Order data extraction completed successfully
[13:38:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:38:33] ℹ️  Using MRN from patient data: 'waplABIMC076' over 'waplABIMC076'
[13:38:33] ℹ️  Service line consistent in both sources: 'ST'
[13:38:33] ✅ Patient name cross-validation successful
[13:38:33] ✅    ✅ Data merged successfully
[13:38:34] ✅    ✅ Order data extracted and validated
[13:38:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:38:40] [DOC: 9313690] ✅ Patient exists in API: John Gingras, ID: f3f0b3fb-a30f-4f86-99cf-515a777b25bd
[13:38:40] ✅    ✅ Existing patient found with ID: f3f0b3fb-a30f-4f86-99cf-515a777b25bd
[13:38:40] 🔄 
🔄 Step 6: Pushing order to API...
[13:38:40] [DOC: 9313690] ℹ️  Pushing order via API for patient ID: f3f0b3fb-a30f-4f86-99cf-515a777b25bd
[13:38:41] [DOC: 9313690] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:38:41] ❌    ❌ Failed to push order
[13:38:41] 🔄 
🔄 Step 7: Writing to CSV...
[13:38:41] [DOC: 9313690] ℹ️  Calculated age: 63 from DOB: 01/30/1962
[13:38:41] [DOC: 9313690] ℹ️  Service Line extracted: 'ST'
[13:38:41] [DOC: 9313690] ℹ️  Payer Source extracted: ''
[13:38:41] [DOC: 9313690] ℹ️  Diagnosis codes being written:
[13:38:41] [DOC: 9313690] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69351'
[13:38:41] [DOC: 9313690] ℹ️    - Latest_Episode_Seconddiagnosis: 'R13.12'
[13:38:41] [DOC: 9313690] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:38:41] [DOC: 9313690] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:38:41] [DOC: 9313690] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:38:41] [DOC: 9313690] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:38:41] [DOC: 9313690] ✅ Patient data written to CSV: John Gingras | Sex: MALE | Age: 63 | Service: ST | Payer:  | MRN: waplABIMC076
[13:38:41] ✅    ✅ Document 9313690 processed and saved successfully
[13:38:41] 🔄 
🔄 Step 8: Saving API details...
[13:38:41] [DOC: 9313690] ℹ️  API push details saved for document 9313690
[13:38:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313688                         ║
================================================================================
[13:38:41] ℹ️  Agency: Visiting Rehab & Nursing Services
[13:38:41] ℹ️  Date: 05/28/2025
[13:38:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:38:43] [DOC: 9313688] ✅ Text extracted using pdfplumber (1372 chars)
[13:38:43] ✅    ✅ Text extracted using pdfplumber (1360 chars)
[13:38:43] 🔄 
🔄 Step 2: Extracting patient data...
[13:38:46] ℹ️  AI extracted raw sex value: ''
[13:38:46] ℹ️  AI extracted service line: 'Home health services'
[13:38:46] ℹ️  AI extracted payer source: ''
[13:38:46] ℹ️  AI extracted diagnoses:
[13:38:46] ℹ️    - Diagnosis 1: 'I69.351'
[13:38:46] ℹ️    - Diagnosis 2: 'G89.29'
[13:38:46] ℹ️    - Diagnosis 3: 'I69.391'
[13:38:46] ℹ️    - Diagnosis 4: ''
[13:38:46] ℹ️    - Diagnosis 5: ''
[13:38:46] ℹ️    - Diagnosis 6: ''
[13:38:46] ℹ️  Final extracted MRN: 'waplABIMC076'
[13:38:46] ℹ️  Final extracted Sex: ''
[13:38:46] ℹ️  Final extracted Service Line: 'Home health services'
[13:38:46] ℹ️  Final extracted Payer Source: ''
[13:38:46] ✅ Patient data extraction completed successfully
[13:38:46] ✅    ✅ Patient data extracted successfully
[13:38:46] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Gingras
     └─ dob: 01/30/1962
     └─ patientSex: 
     └─ medicalRecordNo: waplABIMC076
     └─ billingProvider: Hugo Jauregui MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: 
     └─ address: 125 High Street STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: 
     └─ phoneNumber: (774) 678-4926
     └─ serviceLine: Home health services
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/13/2025', 'startOfEpisode': '05/13/2025', 'endOfEpisode': '07/11/2025', 'firstDiagnosis': 'I69.351', 'secondDiagnosis': 'G89.29', 'thirdDiagnosis': 'I69.391', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:38:46] ✅    ✅ Patient identified: John Gingras
[13:38:46] ✅    ✅ Patient name validation passed
[13:38:46] 🔄 
🔄 Step 3: Processing patient dates...
[13:38:46] [DOC: 9313688] ℹ️  DOB normalized: 01/30/1962
[13:38:46] [DOC: 9313688] ℹ️  Episode startOfCare normalized: 05/13/2025
[13:38:46] [DOC: 9313688] ℹ️  Episode startOfEpisode normalized: 05/13/2025
[13:38:46] [DOC: 9313688] ℹ️  Episode endOfEpisode normalized: 07/11/2025
[13:38:46] [DOC: 9313688] ✅ Patient date processing completed successfully
[13:38:46] ✅    ✅ Date processing completed
[13:38:46] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Gingras
     └─ dob: 01/30/1962
     └─ patientSex: 
     └─ medicalRecordNo: waplABIMC076
     └─ billingProvider: Hugo Jauregui MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: 
     └─ address: 125 High Street STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: 
     └─ phoneNumber: (774) 678-4926
     └─ serviceLine: Home health services
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/13/2025', 'startOfEpisode': '05/13/2025', 'endOfEpisode': '07/11/2025', 'firstDiagnosis': 'I69.351', 'secondDiagnosis': 'G89.29', 'thirdDiagnosis': 'I69.391', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:38:46] 🔄 
🔄 Step 4: Extracting order data...
[13:38:49] ℹ️  Order extraction - MRN: 'waplABIMC076'
[13:38:49] ℹ️  Order extraction - Sex: ''
[13:38:49] ℹ️  Order extraction - Service Line: 'Home health services'
[13:38:49] ℹ️  Order extraction - Payer Source: ''
[13:38:49] ✅ Order data extraction completed successfully
[13:38:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:38:49] ℹ️  Using MRN from patient data: 'waplABIMC076' over 'waplABIMC076'
[13:38:49] ℹ️  Inferred sex as MALE from name: John
[13:38:49] ℹ️  Service line consistent in both sources: 'Home health services'
[13:38:49] ✅ Patient name cross-validation successful
[13:38:49] ✅    ✅ Data merged successfully
[13:38:50] ✅    ✅ Order data extracted and validated
[13:38:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:38:50] [DOC: 9313688] ✅ Patient found in local cache: John Gingras, ID: f3f0b3fb-a30f-4f86-99cf-515a777b25bd
[13:38:50] ✅    ✅ Existing patient found with ID: f3f0b3fb-a30f-4f86-99cf-515a777b25bd
[13:38:50] 🔄 
🔄 Step 6: Pushing order to API...
[13:38:50] [DOC: 9313688] ℹ️  Pushing order via API for patient ID: f3f0b3fb-a30f-4f86-99cf-515a777b25bd
[13:38:51] [DOC: 9313688] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16477"}
[13:38:51] ❌    ❌ Failed to push order
[13:38:51] 🔄 
🔄 Step 7: Writing to CSV...
[13:38:51] [DOC: 9313688] ℹ️  Calculated age: 63 from DOB: 01/30/1962
[13:38:51] [DOC: 9313688] ℹ️  Service Line extracted: 'Home health services'
[13:38:51] [DOC: 9313688] ℹ️  Payer Source extracted: ''
[13:38:51] [DOC: 9313688] ℹ️  Diagnosis codes being written:
[13:38:51] [DOC: 9313688] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.351'
[13:38:51] [DOC: 9313688] ℹ️    - Latest_Episode_Seconddiagnosis: 'G89.29'
[13:38:51] [DOC: 9313688] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.391'
[13:38:51] [DOC: 9313688] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:38:51] [DOC: 9313688] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:38:51] [DOC: 9313688] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:38:51] [DOC: 9313688] ✅ Patient data written to CSV: John Gingras | Sex: MALE | Age: 63 | Service: Home health services | Payer:  | MRN: waplABIMC076
[13:38:51] ✅    ✅ Document 9313688 processed and saved successfully
[13:38:51] 🔄 
🔄 Step 8: Saving API details...
[13:38:51] [DOC: 9313688] ℹ️  API push details saved for document 9313688
[13:38:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313687                         ║
================================================================================
[13:38:51] ℹ️  Agency: Visiting Rehab & Nursing Services
[13:38:51] ℹ️  Date: 05/28/2025
[13:38:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:38:55] [DOC: 9313687] ✅ Text extracted using pdfplumber (13776 chars)
[13:38:55] ✅    ✅ Text extracted using pdfplumber (13776 chars)
[13:38:55] 🔄 
🔄 Step 2: Extracting patient data...
[13:38:58] ℹ️  AI extracted raw sex value: 'M'
[13:38:58] ℹ️  AI extracted service line: 'OT'
[13:38:58] ℹ️  AI extracted payer source: 'None'
[13:38:58] ℹ️  AI extracted diagnoses:
[13:38:58] ℹ️    - Diagnosis 1: 'I69.351'
[13:38:58] ℹ️    - Diagnosis 2: 'R27.8'
[13:38:58] ℹ️    - Diagnosis 3: 'None'
[13:38:58] ℹ️    - Diagnosis 4: 'None'
[13:38:58] ℹ️    - Diagnosis 5: 'None'
[13:38:58] ℹ️    - Diagnosis 6: 'None'
[13:38:58] ℹ️  Final extracted MRN: 'waplABIMC076'
[13:38:58] ℹ️  Final extracted Sex: 'MALE'
[13:38:58] ℹ️  Final extracted Service Line: 'OT'
[13:38:58] ℹ️  Final extracted Payer Source: ''
[13:38:58] ✅ Patient data extraction completed successfully
[13:38:58] ✅    ✅ Patient data extracted successfully
[13:38:58] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Gingras
     └─ dob: 01/30/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: waplABIMC076
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Visiting Rehab and Nursing
     └─ address: 125 High Street , STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: None
     └─ phoneNumber: (877) 242-8771
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/13/2025', 'endOfEpisode': '07/11/2025', 'firstDiagnosis': 'I69.351', 'secondDiagnosis': 'R27.8', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:38:58] ✅    ✅ Patient identified: John Gingras
[13:38:58] ✅    ✅ Patient name validation passed
[13:38:58] 🔄 
🔄 Step 3: Processing patient dates...
[13:38:58] [DOC: 9313687] ℹ️  DOB normalized: 01/30/1962
[13:38:58] [DOC: 9313687] ℹ️  Episode startOfEpisode normalized: 05/13/2025
[13:38:58] [DOC: 9313687] ℹ️  Episode endOfEpisode normalized: 07/11/2025
[13:38:58] [DOC: 9313687] ✅ Patient date processing completed successfully
[13:38:58] ✅    ✅ Date processing completed
[13:38:58] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Gingras
     └─ dob: 01/30/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: waplABIMC076
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Visiting Rehab and Nursing
     └─ address: 125 High Street , STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ phoneNumber: (877) 242-8771
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/13/2025', 'endOfEpisode': '07/11/2025', 'firstDiagnosis': 'I69.351', 'secondDiagnosis': 'R27.8'}]
[13:38:58] 🔄 
🔄 Step 4: Extracting order data...
[13:39:00] ℹ️  Order extraction - MRN: 'waplABIMC076'
[13:39:00] ℹ️  Order extraction - Sex: 'MALE'
[13:39:00] ℹ️  Order extraction - Service Line: 'OT'
[13:39:00] ℹ️  Order extraction - Payer Source: ''
[13:39:00] ✅ Order data extraction completed successfully
[13:39:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:39:00] ℹ️  Using MRN from patient data: 'waplABIMC076' over 'waplABIMC076'
[13:39:00] ℹ️  Service line consistent in both sources: 'OT'
[13:39:00] ✅ Patient name cross-validation successful
[13:39:00] ✅    ✅ Data merged successfully
[13:39:01] ✅    ✅ Order data extracted and validated
[13:39:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:39:01] [DOC: 9313687] ✅ Patient found in local cache: John Gingras, ID: f3f0b3fb-a30f-4f86-99cf-515a777b25bd
[13:39:01] ✅    ✅ Existing patient found with ID: f3f0b3fb-a30f-4f86-99cf-515a777b25bd
[13:39:01] 🔄 
🔄 Step 6: Pushing order to API...
[13:39:01] [DOC: 9313687] ℹ️  Pushing order via API for patient ID: f3f0b3fb-a30f-4f86-99cf-515a777b25bd
[13:39:03] [DOC: 9313687] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:39:03] ❌    ❌ Failed to push order
[13:39:03] 🔄 
🔄 Step 7: Writing to CSV...
[13:39:03] [DOC: 9313687] ℹ️  Calculated age: 63 from DOB: 01/30/1962
[13:39:03] [DOC: 9313687] ℹ️  Service Line extracted: 'OT'
[13:39:03] [DOC: 9313687] ℹ️  Payer Source extracted: ''
[13:39:03] [DOC: 9313687] ℹ️  Diagnosis codes being written:
[13:39:03] [DOC: 9313687] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.351'
[13:39:03] [DOC: 9313687] ℹ️    - Latest_Episode_Seconddiagnosis: 'R27.8'
[13:39:03] [DOC: 9313687] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:39:03] [DOC: 9313687] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:39:03] [DOC: 9313687] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:39:03] [DOC: 9313687] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:39:03] [DOC: 9313687] ✅ Patient data written to CSV: John Gingras | Sex: MALE | Age: 63 | Service: OT | Payer:  | MRN: waplABIMC076
[13:39:03] ✅    ✅ Document 9313687 processed and saved successfully
[13:39:03] 🔄 
🔄 Step 8: Saving API details...
[13:39:03] [DOC: 9313687] ℹ️  API push details saved for document 9313687
[13:39:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9315638                         ║
================================================================================
[13:39:03] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[13:39:03] ℹ️  Date: 05/28/2025
[13:39:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:39:06] [DOC: 9315638] ✅ Text extracted using pdfplumber (4977 chars)
[13:39:06] ✅    ✅ Text extracted using pdfplumber (4977 chars)
[13:39:06] 🔄 
🔄 Step 2: Extracting patient data...
[13:39:09] ℹ️  AI extracted raw sex value: 'M'
[13:39:09] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:39:09] ℹ️  AI extracted payer source: ''
[13:39:09] ℹ️  AI extracted diagnoses:
[13:39:09] ℹ️    - Diagnosis 1: 'F20.0'
[13:39:09] ℹ️    - Diagnosis 2: 'None'
[13:39:09] ℹ️    - Diagnosis 3: 'None'
[13:39:09] ℹ️    - Diagnosis 4: 'None'
[13:39:09] ℹ️    - Diagnosis 5: 'None'
[13:39:09] ℹ️    - Diagnosis 6: 'None'
[13:39:09] ℹ️  Final extracted MRN: '174003'
[13:39:09] ℹ️  Final extracted Sex: 'MALE'
[13:39:09] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:39:09] ℹ️  Final extracted Payer Source: ''
[13:39:09] ✅ Patient data extraction completed successfully
[13:39:09] ✅    ✅ Patient data extracted successfully
[13:39:09] 📊 Patient Response
     └─ patientFName: Julio
     └─ patientLName: Philogene
     └─ dob: 07/29/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 174003
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 227504
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/08/2017', 'startOfEpisode': '05/29/2025', 'endOfEpisode': '07/27/2025', 'firstDiagnosis': 'F20.0', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:39:09] ✅    ✅ Patient identified: Julio Philogene
[13:39:09] ✅    ✅ Patient name validation passed
[13:39:09] 🔄 
🔄 Step 3: Processing patient dates...
[13:39:09] [DOC: 9315638] ℹ️  DOB normalized: 07/29/1980
[13:39:09] [DOC: 9315638] ℹ️  Episode startOfCare normalized: 09/08/2017
[13:39:09] [DOC: 9315638] ℹ️  Episode startOfEpisode normalized: 05/29/2025
[13:39:09] [DOC: 9315638] ℹ️  Episode endOfEpisode normalized: 07/27/2025
[13:39:09] [DOC: 9315638] ✅ Patient date processing completed successfully
[13:39:09] ✅    ✅ Date processing completed
[13:39:09] 📊 Processed Patient Data
     └─ patientFName: Julio
     └─ patientLName: Philogene
     └─ dob: 07/29/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 174003
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 227504
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '09/08/2017', 'startOfEpisode': '05/29/2025', 'endOfEpisode': '07/27/2025', 'firstDiagnosis': 'F20.0'}]
[13:39:09] 🔄 
🔄 Step 4: Extracting order data...
[13:39:11] ℹ️  Order extraction - MRN: '174003'
[13:39:11] ℹ️  Order extraction - Sex: 'MALE'
[13:39:11] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:39:11] ℹ️  Order extraction - Payer Source: ''
[13:39:11] ✅ Order data extraction completed successfully
[13:39:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:39:11] ℹ️  Using MRN from patient data: '174003' over '174003'
[13:39:11] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:39:11] ✅ Patient name cross-validation successful
[13:39:11] ✅    ✅ Data merged successfully
[13:39:12] ✅    ✅ Order data extracted and validated
[13:39:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:39:12] [DOC: 9315638] ✅ Patient found in local cache: Julio Philogene, ID: 2a11f5dd-a46e-4892-9391-fb9412ba9ee7
[13:39:12] ✅    ✅ Existing patient found with ID: 2a11f5dd-a46e-4892-9391-fb9412ba9ee7
[13:39:12] 🔄 
🔄 Step 6: Pushing order to API...
[13:39:12] [DOC: 9315638] ℹ️  Pushing order via API for patient ID: 2a11f5dd-a46e-4892-9391-fb9412ba9ee7
[13:39:13] [DOC: 9315638] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:39:13] ❌    ❌ Failed to push order
[13:39:13] 🔄 
🔄 Step 7: Writing to CSV...
[13:39:13] [DOC: 9315638] ℹ️  Calculated age: 44 from DOB: 07/29/1980
[13:39:13] [DOC: 9315638] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:39:13] [DOC: 9315638] ℹ️  Payer Source extracted: ''
[13:39:13] [DOC: 9315638] ℹ️  Diagnosis codes being written:
[13:39:13] [DOC: 9315638] ℹ️    - Latest_Episode_Firstdiagnosis: 'F20.0'
[13:39:13] [DOC: 9315638] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:39:13] [DOC: 9315638] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:39:13] [DOC: 9315638] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:39:13] [DOC: 9315638] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:39:13] [DOC: 9315638] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:39:13] [DOC: 9315638] ✅ Patient data written to CSV: Julio Philogene | Sex: MALE | Age: 44 | Service: Skilled Nursing | Payer:  | MRN: 174003
[13:39:13] ✅    ✅ Document 9315638 processed and saved successfully
[13:39:13] 🔄 
🔄 Step 8: Saving API details...
[13:39:13] [DOC: 9315638] ℹ️  API push details saved for document 9315638
[13:39:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9315328                         ║
================================================================================
[13:39:13] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:39:13] ℹ️  Date: 05/28/2025
[13:39:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:39:16] [DOC: 9315328] ✅ Text extracted using pdfplumber (14358 chars)
[13:39:16] ✅    ✅ Text extracted using pdfplumber (14348 chars)
[13:39:16] 🔄 
🔄 Step 2: Extracting patient data...
[13:39:19] ℹ️  AI extracted raw sex value: 'F'
[13:39:19] ℹ️  AI extracted service line: 'Physical Therapy'
[13:39:19] ℹ️  AI extracted payer source: ''
[13:39:19] ℹ️  AI extracted diagnoses:
[13:39:19] ℹ️    - Diagnosis 1: 'I48.11'
[13:39:19] ℹ️    - Diagnosis 2: 'R42'
[13:39:19] ℹ️    - Diagnosis 3: 'R79.89'
[13:39:19] ℹ️    - Diagnosis 4: 'E06.3'
[13:39:19] ℹ️    - Diagnosis 5: 'E78.5'
[13:39:19] ℹ️    - Diagnosis 6: 'R29.6'
[13:39:19] ℹ️  Final extracted MRN: '2224673'
[13:39:19] ℹ️  Final extracted Sex: 'FEMALE'
[13:39:19] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:39:19] ℹ️  Final extracted Payer Source: ''
[13:39:19] ✅ Patient data extraction completed successfully
[13:39:19] ✅    ✅ Patient data extracted successfully
[13:39:19] 📊 Patient Response
     └─ patientFName: Herta
     └─ patientLName: Bauer
     └─ dob: 07/09/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2224673
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 7 Anthony St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740-3402
     └─ email: 
     └─ phoneNumber: 508-997-6142
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/06/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I48.11', 'secondDiagnosis': 'R42', 'thirdDiagnosis': 'R79.89', 'fourthDiagnosis': 'E06.3', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'R29.6'}]
[13:39:19] ✅    ✅ Patient identified: Herta Bauer
[13:39:19] ✅    ✅ Patient name validation passed
[13:39:19] 🔄 
🔄 Step 3: Processing patient dates...
[13:39:19] [DOC: 9315328] ℹ️  DOB normalized: 07/09/1938
[13:39:19] [DOC: 9315328] ℹ️  Episode startOfCare normalized: 05/06/2025
[13:39:19] [DOC: 9315328] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[13:39:19] [DOC: 9315328] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[13:39:19] [DOC: 9315328] ✅ Patient date processing completed successfully
[13:39:19] ✅    ✅ Date processing completed
[13:39:19] 📊 Processed Patient Data
     └─ patientFName: Herta
     └─ patientLName: Bauer
     └─ dob: 07/09/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2224673
     └─ billingProvider: Elaine Wu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 7 Anthony St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740-3402
     └─ email: 
     └─ phoneNumber: 508-997-6142
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/06/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I48.11', 'secondDiagnosis': 'R42', 'thirdDiagnosis': 'R79.89', 'fourthDiagnosis': 'E06.3', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'R29.6'}]
[13:39:19] 🔄 
🔄 Step 4: Extracting order data...
[13:39:22] ℹ️  Order extraction - MRN: '2224673'
[13:39:22] ℹ️  Order extraction - Sex: 'FEMALE'
[13:39:22] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[13:39:22] ℹ️  Order extraction - Payer Source: ''
[13:39:22] ✅ Order data extraction completed successfully
[13:39:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:39:22] ℹ️  Using MRN from patient data: '2224673' over '2224673'
[13:39:22] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[13:39:22] ✅ Patient name cross-validation successful
[13:39:22] ✅    ✅ Data merged successfully
[13:39:23] ✅    ✅ Order data extracted and validated
[13:39:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:39:32] [DOC: 9315328] ✅ Patient exists in API: Herta Bauer, ID: 482758a0-1c80-43c4-94e2-4df3f5d15fce
[13:39:32] ✅    ✅ Existing patient found with ID: 482758a0-1c80-43c4-94e2-4df3f5d15fce
[13:39:32] 🔄 
🔄 Step 6: Pushing order to API...
[13:39:32] [DOC: 9315328] ℹ️  Pushing order via API for patient ID: 482758a0-1c80-43c4-94e2-4df3f5d15fce
[13:39:33] [DOC: 9315328] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16127"}
[13:39:33] ❌    ❌ Failed to push order
[13:39:33] 🔄 
🔄 Step 7: Writing to CSV...
[13:39:33] [DOC: 9315328] ℹ️  Calculated age: 86 from DOB: 07/09/1938
[13:39:33] [DOC: 9315328] ℹ️  Service Line extracted: 'Physical Therapy'
[13:39:33] [DOC: 9315328] ℹ️  Payer Source extracted: ''
[13:39:33] [DOC: 9315328] ℹ️  Diagnosis codes being written:
[13:39:33] [DOC: 9315328] ℹ️    - Latest_Episode_Firstdiagnosis: 'I48.11'
[13:39:33] [DOC: 9315328] ℹ️    - Latest_Episode_Seconddiagnosis: 'R42'
[13:39:33] [DOC: 9315328] ℹ️    - Latest_Episode_Thirddiagnosis: 'R79.89'
[13:39:33] [DOC: 9315328] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E06.3'
[13:39:33] [DOC: 9315328] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E78.5'
[13:39:33] [DOC: 9315328] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R29.6'
[13:39:33] [DOC: 9315328] ✅ Patient data written to CSV: Herta Bauer | Sex: FEMALE | Age: 86 | Service: Physical Therapy | Payer:  | MRN: 2224673
[13:39:33] ✅    ✅ Document 9315328 processed and saved successfully
[13:39:33] 🔄 
🔄 Step 8: Saving API details...
[13:39:33] [DOC: 9315328] ℹ️  API push details saved for document 9315328
[13:39:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9315244                         ║
================================================================================
[13:39:33] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:39:33] ℹ️  Date: 05/28/2025
[13:39:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:39:36] [DOC: 9315244] ✅ Text extracted using pdfplumber (18837 chars)
[13:39:36] ✅    ✅ Text extracted using pdfplumber (18837 chars)
[13:39:36] 🔄 
🔄 Step 2: Extracting patient data...
[13:39:39] ℹ️  AI extracted raw sex value: 'F'
[13:39:39] ℹ️  AI extracted service line: 'PT'
[13:39:39] ℹ️  AI extracted payer source: 'None'
[13:39:39] ℹ️  AI extracted diagnoses:
[13:39:39] ℹ️    - Diagnosis 1: 'Chronic obstructive pulmonary disease w (acute) exacerbation'
[13:39:39] ℹ️    - Diagnosis 2: 'Difficulty with gait'
[13:39:39] ℹ️    - Diagnosis 3: 'GERD'
[13:39:39] ℹ️    - Diagnosis 4: 'HTN'
[13:39:39] ℹ️    - Diagnosis 5: 'Anxiety'
[13:39:39] ℹ️    - Diagnosis 6: 'Depression'
[13:39:39] ℹ️  Final extracted MRN: '100990744'
[13:39:39] ℹ️  Final extracted Sex: 'FEMALE'
[13:39:39] ℹ️  Final extracted Service Line: 'PT'
[13:39:39] ℹ️  Final extracted Payer Source: ''
[13:39:39] ✅ Patient data extraction completed successfully
[13:39:39] ✅    ✅ Patient data extracted successfully
[13:39:39] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Grace
     └─ dob: 10/21/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990744
     └─ billingProvider: Dr. Dhungana Parajuli
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/23/2025', 'endOfEpisode': None, 'firstDiagnosis': 'Chronic obstructive pulmonary disease w (acute) exacerbation', 'secondDiagnosis': 'Difficulty with gait', 'thirdDiagnosis': 'GERD', 'fourthDiagnosis': 'HTN', 'fifthDiagnosis': 'Anxiety', 'sixthDiagnosis': 'Depression'}]
[13:39:39] ✅    ✅ Patient identified: Barbara Grace
[13:39:39] ✅    ✅ Patient name validation passed
[13:39:39] 🔄 
🔄 Step 3: Processing patient dates...
[13:39:39] [DOC: 9315244] ℹ️  DOB normalized: 10/21/1948
[13:39:39] [DOC: 9315244] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[13:39:39] [DOC: 9315244] ✅ Patient date processing completed successfully
[13:39:39] ✅    ✅ Date processing completed
[13:39:39] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Grace
     └─ dob: 10/21/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990744
     └─ billingProvider: Dr. Dhungana Parajuli
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/23/2025', 'firstDiagnosis': 'Chronic obstructive pulmonary disease w (acute) exacerbation', 'secondDiagnosis': 'Difficulty with gait', 'thirdDiagnosis': 'GERD', 'fourthDiagnosis': 'HTN', 'fifthDiagnosis': 'Anxiety', 'sixthDiagnosis': 'Depression'}]
[13:39:39] 🔄 
🔄 Step 4: Extracting order data...
[13:39:42] ℹ️  Order extraction - MRN: '100990744'
[13:39:42] ℹ️  Order extraction - Sex: 'FEMALE'
[13:39:42] ℹ️  Order extraction - Service Line: 'PT'
[13:39:42] ℹ️  Order extraction - Payer Source: ''
[13:39:42] ✅ Order data extraction completed successfully
[13:39:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:39:42] ℹ️  Using MRN from patient data: '100990744' over '100990744'
[13:39:42] ℹ️  Service line consistent in both sources: 'PT'
[13:39:42] ✅ Patient name cross-validation successful
[13:39:42] ✅    ✅ Data merged successfully
[13:39:44] ✅    ✅ Order data extracted and validated
[13:39:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:39:58] [DOC: 9315244] ✅ Patient exists in API: Barbara Grace, ID: 579e1f1c-438b-4928-9793-bad56e38e647
[13:39:58] ✅    ✅ Existing patient found with ID: 579e1f1c-438b-4928-9793-bad56e38e647
[13:39:58] 🔄 
🔄 Step 6: Pushing order to API...
[13:39:58] [DOC: 9315244] ℹ️  Pushing order via API for patient ID: 579e1f1c-438b-4928-9793-bad56e38e647
[13:39:59] [DOC: 9315244] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:39:59] ❌    ❌ Failed to push order
[13:39:59] 🔄 
🔄 Step 7: Writing to CSV...
[13:39:59] [DOC: 9315244] ℹ️  Calculated age: 76 from DOB: 10/21/1948
[13:39:59] [DOC: 9315244] ℹ️  Service Line extracted: 'PT'
[13:39:59] [DOC: 9315244] ℹ️  Payer Source extracted: ''
[13:39:59] [DOC: 9315244] ℹ️  Diagnosis codes being written:
[13:39:59] [DOC: 9315244] ℹ️    - Latest_Episode_Firstdiagnosis: 'Chronic obstructive pulmonary disease w (acute) exacerbation'
[13:39:59] [DOC: 9315244] ℹ️    - Latest_Episode_Seconddiagnosis: 'Difficulty with gait'
[13:39:59] [DOC: 9315244] ℹ️    - Latest_Episode_Thirddiagnosis: 'GERD'
[13:39:59] [DOC: 9315244] ℹ️    - Latest_Episode_Fourthdiagnosis: 'HTN'
[13:39:59] [DOC: 9315244] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Anxiety'
[13:39:59] [DOC: 9315244] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Depression'
[13:39:59] [DOC: 9315244] ✅ Patient data written to CSV: Barbara Grace | Sex: FEMALE | Age: 76 | Service: PT | Payer:  | MRN: 100990744
[13:39:59] ✅    ✅ Document 9315244 processed and saved successfully
[13:39:59] 🔄 
🔄 Step 8: Saving API details...
[13:39:59] [DOC: 9315244] ℹ️  API push details saved for document 9315244
[13:39:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313888                         ║
================================================================================
[13:39:59] ℹ️  Agency: Dartmouth HH
[13:39:59] ℹ️  Date: 05/28/2025
[13:39:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:40:01] [DOC: 9313888] ✅ Text extracted using pdfplumber (9346 chars)
[13:40:01] ✅    ✅ Text extracted using pdfplumber (9334 chars)
[13:40:01] 🔄 
🔄 Step 2: Extracting patient data...
[13:40:04] ℹ️  AI extracted raw sex value: 'F'
[13:40:04] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:40:04] ℹ️  AI extracted payer source: 'None'
[13:40:04] ℹ️  AI extracted diagnoses:
[13:40:04] ℹ️    - Diagnosis 1: 'A04.72'
[13:40:04] ℹ️    - Diagnosis 2: 'K57.32'
[13:40:04] ℹ️    - Diagnosis 3: 'J44.9'
[13:40:04] ℹ️    - Diagnosis 4: 'G70.00'
[13:40:04] ℹ️    - Diagnosis 5: 'F32.A'
[13:40:04] ℹ️    - Diagnosis 6: 'G89.29'
[13:40:04] ℹ️  Final extracted MRN: '6650011'
[13:40:04] ℹ️  Final extracted Sex: 'FEMALE'
[13:40:04] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:40:04] ℹ️  Final extracted Payer Source: ''
[13:40:04] ✅ Patient data extraction completed successfully
[13:40:04] ✅    ✅ Patient data extracted successfully
[13:40:04] 📊 Patient Response
     └─ patientFName: Lorraine
     └─ patientLName: Blais
     └─ dob: 09/07/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6650011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'K57.32', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'G70.00', 'fifthDiagnosis': 'F32.A', 'sixthDiagnosis': 'G89.29'}]
[13:40:04] ✅    ✅ Patient identified: Lorraine Blais
[13:40:04] ✅    ✅ Patient name validation passed
[13:40:04] 🔄 
🔄 Step 3: Processing patient dates...
[13:40:04] [DOC: 9313888] ℹ️  DOB normalized: 09/07/1941
[13:40:04] [DOC: 9313888] ℹ️  Episode startOfEpisode normalized: 05/08/2025
[13:40:04] [DOC: 9313888] ℹ️  Episode endOfEpisode normalized: 07/06/2025
[13:40:04] [DOC: 9313888] ✅ Patient date processing completed successfully
[13:40:04] ✅    ✅ Date processing completed
[13:40:04] 📊 Processed Patient Data
     └─ patientFName: Lorraine
     └─ patientLName: Blais
     └─ dob: 09/07/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6650011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': 'A04.72', 'secondDiagnosis': 'K57.32', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'G70.00', 'fifthDiagnosis': 'F32.A', 'sixthDiagnosis': 'G89.29'}]
[13:40:04] 🔄 
🔄 Step 4: Extracting order data...
[13:40:07] ℹ️  Order extraction - MRN: '6650011'
[13:40:07] ℹ️  Order extraction - Sex: 'FEMALE'
[13:40:07] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:40:07] ℹ️  Order extraction - Payer Source: ''
[13:40:07] ✅ Order data extraction completed successfully
[13:40:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:40:07] ℹ️  Using MRN from patient data: '6650011' over '6650011'
[13:40:07] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:40:07] ✅ Patient name cross-validation successful
[13:40:07] ✅    ✅ Data merged successfully
[13:40:08] ✅    ✅ Order data extracted and validated
[13:40:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:40:08] [DOC: 9313888] ✅ Patient found in local cache: Lorraine Blais, ID: 52bacf05-b07c-491b-b93a-b81420861a03
[13:40:08] ✅    ✅ Existing patient found with ID: 52bacf05-b07c-491b-b93a-b81420861a03
[13:40:08] 🔄 
🔄 Step 6: Pushing order to API...
[13:40:08] [DOC: 9313888] ℹ️  Pushing order via API for patient ID: 52bacf05-b07c-491b-b93a-b81420861a03
[13:40:09] [DOC: 9313888] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:40:09] ❌    ❌ Failed to push order
[13:40:09] 🔄 
🔄 Step 7: Writing to CSV...
[13:40:09] [DOC: 9313888] ℹ️  Calculated age: 83 from DOB: 09/07/1941
[13:40:09] [DOC: 9313888] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:40:09] [DOC: 9313888] ℹ️  Payer Source extracted: ''
[13:40:09] [DOC: 9313888] ℹ️  Diagnosis codes being written:
[13:40:09] [DOC: 9313888] ℹ️    - Latest_Episode_Firstdiagnosis: 'A04.72'
[13:40:09] [DOC: 9313888] ℹ️    - Latest_Episode_Seconddiagnosis: 'K57.32'
[13:40:09] [DOC: 9313888] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.9'
[13:40:09] [DOC: 9313888] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G70.00'
[13:40:09] [DOC: 9313888] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F32.A'
[13:40:09] [DOC: 9313888] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G89.29'
[13:40:09] [DOC: 9313888] ✅ Patient data written to CSV: Lorraine Blais | Sex: FEMALE | Age: 83 | Service: Skilled Nursing | Payer:  | MRN: 6650011
[13:40:09] ✅    ✅ Document 9313888 processed and saved successfully
[13:40:09] 🔄 
🔄 Step 8: Saving API details...
[13:40:09] [DOC: 9313888] ℹ️  API push details saved for document 9313888
[13:40:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313791                         ║
================================================================================
[13:40:09] ℹ️  Agency: Dartmouth HH
[13:40:09] ℹ️  Date: 05/28/2025
[13:40:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:40:11] [DOC: 9313791] ✅ Text extracted using pdfplumber (2887 chars)
[13:40:11] ✅    ✅ Text extracted using pdfplumber (2887 chars)
[13:40:11] 🔄 
🔄 Step 2: Extracting patient data...
[13:40:14] ℹ️  AI extracted raw sex value: 'F'
[13:40:14] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:40:14] ℹ️  AI extracted payer source: 'Medicare'
[13:40:14] ℹ️  AI extracted diagnoses:
[13:40:14] ℹ️    - Diagnosis 1: 'None'
[13:40:14] ℹ️    - Diagnosis 2: 'None'
[13:40:14] ℹ️    - Diagnosis 3: 'None'
[13:40:14] ℹ️    - Diagnosis 4: 'None'
[13:40:14] ℹ️    - Diagnosis 5: 'None'
[13:40:14] ℹ️    - Diagnosis 6: 'None'
[13:40:14] ℹ️  Final extracted MRN: '5862015'
[13:40:14] ℹ️  Final extracted Sex: 'FEMALE'
[13:40:14] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:40:14] ℹ️  Final extracted Payer Source: 'Medicare'
[13:40:14] ✅ Patient data extraction completed successfully
[13:40:14] ✅    ✅ Patient data extracted successfully
[13:40:14] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 95 Highland Street 2nd floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:40:14] ✅    ✅ Patient identified: Janice Arruda
[13:40:14] ✅    ✅ Patient name validation passed
[13:40:14] 🔄 
🔄 Step 3: Processing patient dates...
[13:40:14] [DOC: 9313791] ℹ️  DOB normalized: 01/24/1950
[13:40:14] [DOC: 9313791] ℹ️  Episode startOfCare normalized: 02/08/2025
[13:40:14] [DOC: 9313791] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[13:40:14] [DOC: 9313791] ℹ️  Episode endOfEpisode normalized: 06/07/2025
[13:40:14] [DOC: 9313791] ✅ Patient date processing completed successfully
[13:40:14] ✅    ✅ Date processing completed
[13:40:14] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 95 Highland Street 2nd floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025'}]
[13:40:14] 🔄 
🔄 Step 4: Extracting order data...
[13:40:17] ℹ️  Order extraction - MRN: ''
[13:40:17] ℹ️  Order extraction - Sex: 'FEMALE'
[13:40:17] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:40:17] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:40:17] ✅ Order data extraction completed successfully
[13:40:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:40:17] ℹ️  Using MRN from patient data: '5862015'
[13:40:17] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:40:17] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:40:17] ✅ Patient name cross-validation successful
[13:40:17] ✅    ✅ Data merged successfully
[13:40:18] ✅    ✅ Order data extracted and validated
[13:40:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:40:23] [DOC: 9313791] ✅ Patient exists in API: Janice Arruda, ID: cc67108f-d504-4858-959a-d21d91141958
[13:40:23] ✅    ✅ Existing patient found with ID: cc67108f-d504-4858-959a-d21d91141958
[13:40:23] 🔄 
🔄 Step 6: Pushing order to API...
[13:40:23] [DOC: 9313791] ℹ️  Pushing order via API for patient ID: cc67108f-d504-4858-959a-d21d91141958
[13:40:25] [DOC: 9313791] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12954"}
[13:40:25] ❌    ❌ Failed to push order
[13:40:25] 🔄 
🔄 Step 7: Writing to CSV...
[13:40:25] [DOC: 9313791] ℹ️  Calculated age: 75 from DOB: 01/24/1950
[13:40:25] [DOC: 9313791] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:40:25] [DOC: 9313791] ℹ️  Payer Source extracted: 'Medicare'
[13:40:25] [DOC: 9313791] ℹ️  Diagnosis codes being written:
[13:40:25] [DOC: 9313791] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:40:25] [DOC: 9313791] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:40:25] [DOC: 9313791] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:40:25] [DOC: 9313791] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:40:25] [DOC: 9313791] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:40:25] [DOC: 9313791] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:40:25] [DOC: 9313791] ✅ Patient data written to CSV: Janice Arruda | Sex: FEMALE | Age: 75 | Service: Skilled Nursing | Payer: Medicare | MRN: 5862015
[13:40:25] ✅    ✅ Document 9313791 processed and saved successfully
[13:40:25] 🔄 
🔄 Step 8: Saving API details...
[13:40:25] [DOC: 9313791] ℹ️  API push details saved for document 9313791
[13:40:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313280                         ║
================================================================================
[13:40:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:40:25] ℹ️  Date: 05/27/2025
[13:40:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:40:27] [DOC: 9313280] ✅ Text extracted using pdfplumber (1298 chars)
[13:40:27] ✅    ✅ Text extracted using pdfplumber (1298 chars)
[13:40:27] 🔄 
🔄 Step 2: Extracting patient data...
[13:40:30] ℹ️  AI extracted raw sex value: ''
[13:40:30] ℹ️  AI extracted service line: 'Physical Therapy'
[13:40:30] ℹ️  AI extracted payer source: ''
[13:40:30] ℹ️  AI extracted diagnoses:
[13:40:30] ℹ️    - Diagnosis 1: 'I13.0'
[13:40:30] ℹ️    - Diagnosis 2: 'I50.42'
[13:40:30] ℹ️    - Diagnosis 3: 'E11.22'
[13:40:30] ℹ️    - Diagnosis 4: 'None'
[13:40:30] ℹ️    - Diagnosis 5: 'None'
[13:40:30] ℹ️    - Diagnosis 6: 'None'
[13:40:30] ℹ️  Final extracted MRN: 'MA250206063603'
[13:40:30] ℹ️  Final extracted Sex: ''
[13:40:30] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:40:30] ℹ️  Final extracted Payer Source: ''
[13:40:30] ✅ Patient data extraction completed successfully
[13:40:30] ✅    ✅ Patient data extracted successfully
[13:40:30] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Lopes
     └─ dob: 06/25/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250206063603
     └─ billingProvider: JONATHAN BIER MD
     └─ npi: 1306883343
     └─ physicianNPI: 1306883343
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.42', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:40:30] ✅    ✅ Patient identified: Maria Lopes
[13:40:30] ✅    ✅ Patient name validation passed
[13:40:30] 🔄 
🔄 Step 3: Processing patient dates...
[13:40:30] [DOC: 9313280] ℹ️  DOB normalized: 06/25/1936
[13:40:30] [DOC: 9313280] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[13:40:30] [DOC: 9313280] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[13:40:30] [DOC: 9313280] ✅ Patient date processing completed successfully
[13:40:30] ✅    ✅ Date processing completed
[13:40:30] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Lopes
     └─ dob: 06/25/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250206063603
     └─ billingProvider: JONATHAN BIER MD
     └─ npi: 1306883343
     └─ physicianNPI: 1306883343
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.42', 'thirdDiagnosis': 'E11.22'}]
[13:40:30] 🔄 
🔄 Step 4: Extracting order data...
[13:40:32] ℹ️  Order extraction - MRN: 'MA250206063603'
[13:40:32] ℹ️  Order extraction - Sex: ''
[13:40:32] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[13:40:32] ℹ️  Order extraction - Payer Source: ''
[13:40:32] ✅ Order data extraction completed successfully
[13:40:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:40:32] ℹ️  Using MRN from patient data: 'MA250206063603' over 'MA250206063603'
[13:40:32] ℹ️  Inferred sex as FEMALE from name: Maria
[13:40:32] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[13:40:32] ✅ Patient name cross-validation successful
[13:40:32] ✅    ✅ Data merged successfully
[13:40:34] ✅    ✅ Order data extracted and validated
[13:40:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:40:40] [DOC: 9313280] ℹ️  Patient not found in cache or API: Maria Lopes
[13:40:40] [DOC: 9313280] ℹ️  Patient not found, creating new patient via API...
[13:40:40] [DOC: 9313280] ℹ️  Creating patient via API: Maria Lopes
[13:40:41] [DOC: 9313280] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:40:41] ❌    ❌ Failed to create patient
[13:40:41] [DOC: 9313280] ℹ️  API push details saved for document 9313280
================================================================================
║                        Processing Document ID: 9313278                         ║
================================================================================
[13:40:41] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:40:41] ℹ️  Date: 05/27/2025
[13:40:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:40:43] [DOC: 9313278] ✅ Text extracted using pdfplumber (1427 chars)
[13:40:43] ✅    ✅ Text extracted using pdfplumber (1427 chars)
[13:40:43] 🔄 
🔄 Step 2: Extracting patient data...
[13:40:46] ℹ️  AI extracted raw sex value: ''
[13:40:46] ℹ️  AI extracted service line: 'Physical Therapy'
[13:40:46] ℹ️  AI extracted payer source: ''
[13:40:46] ℹ️  AI extracted diagnoses:
[13:40:46] ℹ️    - Diagnosis 1: 'I13.0'
[13:40:46] ℹ️    - Diagnosis 2: 'I50.42'
[13:40:46] ℹ️    - Diagnosis 3: 'E11.22'
[13:40:46] ℹ️    - Diagnosis 4: 'None'
[13:40:46] ℹ️    - Diagnosis 5: 'None'
[13:40:46] ℹ️    - Diagnosis 6: 'None'
[13:40:46] ℹ️  Final extracted MRN: 'MA250206063603'
[13:40:46] ℹ️  Final extracted Sex: ''
[13:40:46] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:40:46] ℹ️  Final extracted Payer Source: ''
[13:40:46] ✅ Patient data extraction completed successfully
[13:40:46] ✅    ✅ Patient data extracted successfully
[13:40:46] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Lopes
     └─ dob: 06/25/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250206063603
     └─ billingProvider: JONATHAN BIER MD
     └─ npi: 1306883343
     └─ physicianNPI: 1306883343
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.42', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:40:46] ✅    ✅ Patient identified: Maria Lopes
[13:40:46] ✅    ✅ Patient name validation passed
[13:40:46] 🔄 
🔄 Step 3: Processing patient dates...
[13:40:46] [DOC: 9313278] ℹ️  DOB normalized: 06/25/1936
[13:40:46] [DOC: 9313278] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[13:40:46] [DOC: 9313278] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[13:40:46] [DOC: 9313278] ✅ Patient date processing completed successfully
[13:40:46] ✅    ✅ Date processing completed
[13:40:46] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Lopes
     └─ dob: 06/25/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250206063603
     └─ billingProvider: JONATHAN BIER MD
     └─ npi: 1306883343
     └─ physicianNPI: 1306883343
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.42', 'thirdDiagnosis': 'E11.22'}]
[13:40:46] 🔄 
🔄 Step 4: Extracting order data...
[13:40:48] ℹ️  Order extraction - MRN: 'MA250206063603'
[13:40:48] ℹ️  Order extraction - Sex: ''
[13:40:48] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[13:40:48] ℹ️  Order extraction - Payer Source: ''
[13:40:48] ✅ Order data extraction completed successfully
[13:40:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:40:48] ℹ️  Using MRN from patient data: 'MA250206063603' over 'MA250206063603'
[13:40:48] ℹ️  Inferred sex as FEMALE from name: Maria
[13:40:48] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[13:40:48] ✅ Patient name cross-validation successful
[13:40:48] ✅    ✅ Data merged successfully
[13:40:50] ✅    ✅ Order data extracted and validated
[13:40:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:40:58] [DOC: 9313278] ℹ️  Patient not found in cache or API: Maria Lopes
[13:40:58] [DOC: 9313278] ℹ️  Patient not found, creating new patient via API...
[13:40:58] [DOC: 9313278] ℹ️  Creating patient via API: Maria Lopes
[13:40:59] [DOC: 9313278] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:40:59] ❌    ❌ Failed to create patient
[13:40:59] [DOC: 9313278] ℹ️  API push details saved for document 9313278
================================================================================
║                        Processing Document ID: 9313276                         ║
================================================================================
[13:40:59] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:40:59] ℹ️  Date: 05/27/2025
[13:40:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:41:02] [DOC: 9313276] ✅ Text extracted using pdfplumber (1426 chars)
[13:41:02] ✅    ✅ Text extracted using pdfplumber (1426 chars)
[13:41:02] 🔄 
🔄 Step 2: Extracting patient data...
[13:41:05] ℹ️  AI extracted raw sex value: ''
[13:41:05] ℹ️  AI extracted service line: 'Physical Therapy'
[13:41:05] ℹ️  AI extracted payer source: ''
[13:41:05] ℹ️  AI extracted diagnoses:
[13:41:05] ℹ️    - Diagnosis 1: 'I13.0'
[13:41:05] ℹ️    - Diagnosis 2: 'I50.42'
[13:41:05] ℹ️    - Diagnosis 3: 'E11.22'
[13:41:05] ℹ️    - Diagnosis 4: 'None'
[13:41:05] ℹ️    - Diagnosis 5: 'None'
[13:41:05] ℹ️    - Diagnosis 6: 'None'
[13:41:05] ℹ️  Final extracted MRN: 'MA250206063603'
[13:41:05] ℹ️  Final extracted Sex: ''
[13:41:05] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:41:05] ℹ️  Final extracted Payer Source: ''
[13:41:05] ✅ Patient data extraction completed successfully
[13:41:05] ✅    ✅ Patient data extracted successfully
[13:41:05] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Lopes
     └─ dob: 06/25/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250206063603
     └─ billingProvider: JONATHAN BIER MD
     └─ npi: 1306883343
     └─ physicianNPI: 1306883343
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.42', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:41:05] ✅    ✅ Patient identified: Maria Lopes
[13:41:05] ✅    ✅ Patient name validation passed
[13:41:05] 🔄 
🔄 Step 3: Processing patient dates...
[13:41:05] [DOC: 9313276] ℹ️  DOB normalized: 06/25/1936
[13:41:05] [DOC: 9313276] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[13:41:05] [DOC: 9313276] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[13:41:05] [DOC: 9313276] ✅ Patient date processing completed successfully
[13:41:05] ✅    ✅ Date processing completed
[13:41:05] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Lopes
     └─ dob: 06/25/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250206063603
     └─ billingProvider: JONATHAN BIER MD
     └─ npi: 1306883343
     └─ physicianNPI: 1306883343
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.42', 'thirdDiagnosis': 'E11.22'}]
[13:41:05] 🔄 
🔄 Step 4: Extracting order data...
[13:41:07] ℹ️  Order extraction - MRN: 'MA250206063603'
[13:41:07] ℹ️  Order extraction - Sex: ''
[13:41:07] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[13:41:07] ℹ️  Order extraction - Payer Source: ''
[13:41:07] ✅ Order data extraction completed successfully
[13:41:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:41:07] ℹ️  Using MRN from patient data: 'MA250206063603' over 'MA250206063603'
[13:41:07] ℹ️  Inferred sex as FEMALE from name: Maria
[13:41:07] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[13:41:07] ✅ Patient name cross-validation successful
[13:41:07] ✅    ✅ Data merged successfully
[13:41:08] ✅    ✅ Order data extracted and validated
[13:41:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:41:14] [DOC: 9313276] ℹ️  Patient not found in cache or API: Maria Lopes
[13:41:14] [DOC: 9313276] ℹ️  Patient not found, creating new patient via API...
[13:41:14] [DOC: 9313276] ℹ️  Creating patient via API: Maria Lopes
[13:41:15] [DOC: 9313276] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:41:15] ❌    ❌ Failed to create patient
[13:41:15] [DOC: 9313276] ℹ️  API push details saved for document 9313276
================================================================================
║                        Processing Document ID: 9313271                         ║
================================================================================
[13:41:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:41:15] ℹ️  Date: 05/27/2025
[13:41:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:41:19] [DOC: 9313271] ✅ Text extracted using pdfplumber (18519 chars)
[13:41:19] ✅    ✅ Text extracted using pdfplumber (18519 chars)
[13:41:19] 🔄 
🔄 Step 2: Extracting patient data...
[13:41:22] ℹ️  AI extracted raw sex value: ''
[13:41:22] ℹ️  AI extracted service line: 'PT'
[13:41:22] ℹ️  AI extracted payer source: ''
[13:41:22] ℹ️  AI extracted diagnoses:
[13:41:22] ℹ️    - Diagnosis 1: ''
[13:41:22] ℹ️    - Diagnosis 2: ''
[13:41:22] ℹ️    - Diagnosis 3: ''
[13:41:22] ℹ️    - Diagnosis 4: ''
[13:41:22] ℹ️    - Diagnosis 5: ''
[13:41:22] ℹ️    - Diagnosis 6: ''
[13:41:22] ℹ️  Final extracted MRN: 'MA250206063603'
[13:41:22] ℹ️  Final extracted Sex: ''
[13:41:22] ℹ️  Final extracted Service Line: 'PT'
[13:41:22] ℹ️  Final extracted Payer Source: ''
[13:41:22] ✅ Patient data extraction completed successfully
[13:41:22] ✅    ✅ Patient data extracted successfully
[13:41:22] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Lopes
     └─ dob: 06/25/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250206063603
     └─ billingProvider: JONATHAN BIER MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/05/2025', 'endOfEpisode': '07/05/25', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:41:22] ✅    ✅ Patient identified: Maria Lopes
[13:41:22] ✅    ✅ Patient name validation passed
[13:41:22] 🔄 
🔄 Step 3: Processing patient dates...
[13:41:22] [DOC: 9313271] ℹ️  DOB normalized: 06/25/1936
[13:41:22] [DOC: 9313271] ℹ️  Episode startOfEpisode normalized: 05/05/2025
[13:41:22] [DOC: 9313271] ⚠️  Invalid endOfEpisode format: 07/05/25
[13:41:22] [DOC: 9313271] ✅ Patient date processing completed successfully
[13:41:22] ✅    ✅ Date processing completed
[13:41:22] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Lopes
     └─ dob: 06/25/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250206063603
     └─ billingProvider: JONATHAN BIER MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/05/2025', 'endOfEpisode': '07/05/25', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:41:22] 🔄 
🔄 Step 4: Extracting order data...
[13:41:25] ℹ️  Order extraction - MRN: 'MA250206063603'
[13:41:25] ℹ️  Order extraction - Sex: 'FEMALE'
[13:41:25] ℹ️  Order extraction - Service Line: 'PT'
[13:41:25] ℹ️  Order extraction - Payer Source: ''
[13:41:25] ✅ Order data extraction completed successfully
[13:41:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:41:25] ℹ️  Using MRN from patient data: 'MA250206063603' over 'MA250206063603'
[13:41:25] ℹ️  Service line consistent in both sources: 'PT'
[13:41:25] ✅ Patient name cross-validation successful
[13:41:25] ✅    ✅ Data merged successfully
[13:41:26] ✅    ✅ Order data extracted and validated
[13:41:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:41:39] [DOC: 9313271] ℹ️  Patient not found in cache or API: Maria Lopes
[13:41:39] [DOC: 9313271] ℹ️  Patient not found, creating new patient via API...
[13:41:39] [DOC: 9313271] ℹ️  Creating patient via API: Maria Lopes
[13:41:40] [DOC: 9313271] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:41:40] ❌    ❌ Failed to create patient
[13:41:40] [DOC: 9313271] ℹ️  API push details saved for document 9313271
================================================================================
║                        Processing Document ID: 9312701                         ║
================================================================================
[13:41:40] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:41:40] ℹ️  Date: 05/27/2025
[13:41:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:41:43] [DOC: 9312701] ✅ Text extracted using pdfplumber (13892 chars)
[13:41:43] ✅    ✅ Text extracted using pdfplumber (13892 chars)
[13:41:43] 🔄 
🔄 Step 2: Extracting patient data...
[13:41:46] ℹ️  AI extracted raw sex value: 'M'
[13:41:46] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[13:41:46] ℹ️  AI extracted payer source: ''
[13:41:46] ℹ️  AI extracted diagnoses:
[13:41:46] ℹ️    - Diagnosis 1: 'I130'
[13:41:46] ℹ️    - Diagnosis 2: 'I5033'
[13:41:46] ℹ️    - Diagnosis 3: ''
[13:41:46] ℹ️    - Diagnosis 4: ''
[13:41:46] ℹ️    - Diagnosis 5: ''
[13:41:46] ℹ️    - Diagnosis 6: ''
[13:41:46] ℹ️  Final extracted MRN: 'MA250331114803'
[13:41:46] ℹ️  Final extracted Sex: 'MALE'
[13:41:46] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[13:41:46] ℹ️  Final extracted Payer Source: ''
[13:41:46] ✅ Patient data extraction completed successfully
[13:41:46] ✅    ✅ Patient data extracted successfully
[13:41:46] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: Dr. Alcaraz, Achilles
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I130', 'secondDiagnosis': 'I5033', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:41:46] ✅    ✅ Patient identified: David Sturgeon
[13:41:46] ✅    ✅ Patient name validation passed
[13:41:46] 🔄 
🔄 Step 3: Processing patient dates...
[13:41:46] [DOC: 9312701] ℹ️  DOB normalized: 11/14/1948
[13:41:46] [DOC: 9312701] ℹ️  Episode startOfCare normalized: 04/04/2025
[13:41:46] [DOC: 9312701] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[13:41:46] [DOC: 9312701] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[13:41:46] [DOC: 9312701] ✅ Patient date processing completed successfully
[13:41:46] ✅    ✅ Date processing completed
[13:41:46] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: Dr. Alcaraz, Achilles
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I130', 'secondDiagnosis': 'I5033', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:41:46] 🔄 
🔄 Step 4: Extracting order data...
[13:41:48] ℹ️  Order extraction - MRN: 'MA250331114803'
[13:41:48] ℹ️  Order extraction - Sex: 'MALE'
[13:41:48] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[13:41:48] ℹ️  Order extraction - Payer Source: ''
[13:41:48] ✅ Order data extraction completed successfully
[13:41:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:41:48] ℹ️  Using MRN from patient data: 'MA250331114803' over 'MA250331114803'
[13:41:48] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[13:41:48] ✅ Patient name cross-validation successful
[13:41:48] ✅    ✅ Data merged successfully
[13:41:50] ✅    ✅ Order data extracted and validated
[13:41:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:42:04] [DOC: 9312701] ✅ Patient exists in API: David Sturgeon, ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[13:42:04] ✅    ✅ Existing patient found with ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[13:42:04] 🔄 
🔄 Step 6: Pushing order to API...
[13:42:04] [DOC: 9312701] ℹ️  Pushing order via API for patient ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[13:42:05] [DOC: 9312701] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16600"}
[13:42:05] ❌    ❌ Failed to push order
[13:42:05] 🔄 
🔄 Step 7: Writing to CSV...
[13:42:05] [DOC: 9312701] ℹ️  Calculated age: 76 from DOB: 11/14/1948
[13:42:05] [DOC: 9312701] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT'
[13:42:05] [DOC: 9312701] ℹ️  Payer Source extracted: ''
[13:42:05] [DOC: 9312701] ℹ️  Diagnosis codes being written:
[13:42:05] [DOC: 9312701] ℹ️    - Latest_Episode_Firstdiagnosis: 'I130'
[13:42:05] [DOC: 9312701] ℹ️    - Latest_Episode_Seconddiagnosis: 'I5033'
[13:42:05] [DOC: 9312701] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:42:05] [DOC: 9312701] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:42:05] [DOC: 9312701] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:42:05] [DOC: 9312701] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:42:05] [DOC: 9312701] ✅ Patient data written to CSV: David Sturgeon | Sex: MALE | Age: 76 | Service: Skilled Nursing, PT, OT | Payer:  | MRN: MA250331114803
[13:42:05] ✅    ✅ Document 9312701 processed and saved successfully
[13:42:05] 🔄 
🔄 Step 8: Saving API details...
[13:42:05] [DOC: 9312701] ℹ️  API push details saved for document 9312701
[13:42:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9312670                         ║
================================================================================
[13:42:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:42:05] ℹ️  Date: 05/27/2025
[13:42:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:42:08] [DOC: 9312670] ✅ Text extracted using pdfplumber (1570 chars)
[13:42:08] ✅    ✅ Text extracted using pdfplumber (1558 chars)
[13:42:08] 🔄 
🔄 Step 2: Extracting patient data...
[13:42:11] ℹ️  AI extracted raw sex value: ''
[13:42:11] ℹ️  AI extracted service line: 'Physical Therapy, Home Health Aide'
[13:42:11] ℹ️  AI extracted payer source: ''
[13:42:11] ℹ️  AI extracted diagnoses:
[13:42:11] ℹ️    - Diagnosis 1: 'S42.201'
[13:42:11] ℹ️    - Diagnosis 2: 'M19.011'
[13:42:11] ℹ️    - Diagnosis 3: 'E03.9'
[13:42:11] ℹ️    - Diagnosis 4: ''
[13:42:11] ℹ️    - Diagnosis 5: ''
[13:42:11] ℹ️    - Diagnosis 6: ''
[13:42:11] ℹ️  Final extracted MRN: 'MA250311063603'
[13:42:11] ℹ️  Final extracted Sex: ''
[13:42:11] ℹ️  Final extracted Service Line: 'Physical Therapy, Home Health Aide'
[13:42:11] ℹ️  Final extracted Payer Source: ''
[13:42:11] ✅ Patient data extraction completed successfully
[13:42:11] ✅    ✅ Patient data extracted successfully
[13:42:11] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Demelo
     └─ dob: 06/13/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250311063603
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': 'S42.201', 'secondDiagnosis': 'M19.011', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:42:11] ✅    ✅ Patient identified: Maria Demelo
[13:42:11] ✅    ✅ Patient name validation passed
[13:42:11] 🔄 
🔄 Step 3: Processing patient dates...
[13:42:11] [DOC: 9312670] ℹ️  DOB normalized: 06/13/1936
[13:42:11] [DOC: 9312670] ℹ️  Episode startOfEpisode normalized: 05/12/2025
[13:42:11] [DOC: 9312670] ℹ️  Episode endOfEpisode normalized: 07/10/2025
[13:42:11] [DOC: 9312670] ✅ Patient date processing completed successfully
[13:42:11] ✅    ✅ Date processing completed
[13:42:11] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Demelo
     └─ dob: 06/13/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250311063603
     └─ billingProvider: Gloriane Afonso Fede MD
     └─ npi: 1376525063
     └─ physicianNPI: 1376525063
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': 'S42.201', 'secondDiagnosis': 'M19.011', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:42:11] 🔄 
🔄 Step 4: Extracting order data...
[13:42:14] ℹ️  Order extraction - MRN: 'MA250311063603'
[13:42:14] ℹ️  Order extraction - Sex: ''
[13:42:14] ℹ️  Order extraction - Service Line: 'Physical Therapy, Home Health Aide'
[13:42:14] ℹ️  Order extraction - Payer Source: ''
[13:42:14] ✅ Order data extraction completed successfully
[13:42:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:42:14] ℹ️  Using MRN from patient data: 'MA250311063603' over 'MA250311063603'
[13:42:14] ℹ️  Inferred sex as FEMALE from name: Maria
[13:42:14] ℹ️  Service line consistent in both sources: 'Physical Therapy, Home Health Aide'
[13:42:14] ✅ Patient name cross-validation successful
[13:42:14] ✅    ✅ Data merged successfully
[13:42:15] ✅    ✅ Order data extracted and validated
[13:42:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:42:37] [DOC: 9312670] ℹ️  Patient not found in cache or API: Maria Demelo
[13:42:37] [DOC: 9312670] ℹ️  Patient not found, creating new patient via API...
[13:42:37] [DOC: 9312670] ℹ️  Creating patient via API: Maria Demelo
[13:42:38] [DOC: 9312670] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:42:38] ❌    ❌ Failed to create patient
[13:42:38] [DOC: 9312670] ℹ️  API push details saved for document 9312670
================================================================================
║                        Processing Document ID: 9312608                         ║
================================================================================
[13:42:38] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:42:38] ℹ️  Date: 05/27/2025
[13:42:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:42:41] [DOC: 9312608] ✅ Text extracted using pdfplumber (16753 chars)
[13:42:41] ✅    ✅ Text extracted using pdfplumber (16753 chars)
[13:42:41] 🔄 
🔄 Step 2: Extracting patient data...
[13:42:44] ℹ️  AI extracted raw sex value: 'M'
[13:42:44] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:42:44] ℹ️  AI extracted payer source: ''
[13:42:44] ℹ️  AI extracted diagnoses:
[13:42:44] ℹ️    - Diagnosis 1: 'I10'
[13:42:44] ℹ️    - Diagnosis 2: 'R00.1'
[13:42:44] ℹ️    - Diagnosis 3: 'R42'
[13:42:44] ℹ️    - Diagnosis 4: 'R41.3'
[13:42:44] ℹ️    - Diagnosis 5: 'J44.9'
[13:42:44] ℹ️    - Diagnosis 6: 'E11.40'
[13:42:44] ℹ️  Final extracted MRN: '3030490'
[13:42:44] ℹ️  Final extracted Sex: 'MALE'
[13:42:44] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:42:44] ℹ️  Final extracted Payer Source: ''
[13:42:44] ✅ Patient data extraction completed successfully
[13:42:44] ✅    ✅ Patient data extracted successfully
[13:42:44] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Taylor
     └─ dob: 01/27/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 3030490
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'R00.1', 'thirdDiagnosis': 'R42', 'fourthDiagnosis': 'R41.3', 'fifthDiagnosis': 'J44.9', 'sixthDiagnosis': 'E11.40'}]
[13:42:44] ✅    ✅ Patient identified: James Taylor
[13:42:44] ✅    ✅ Patient name validation passed
[13:42:44] 🔄 
🔄 Step 3: Processing patient dates...
[13:42:44] [DOC: 9312608] ℹ️  DOB normalized: 01/27/1943
[13:42:44] [DOC: 9312608] ℹ️  Episode startOfCare normalized: 05/07/2025
[13:42:44] [DOC: 9312608] ℹ️  Episode startOfEpisode normalized: 05/08/2025
[13:42:44] [DOC: 9312608] ℹ️  Episode endOfEpisode normalized: 07/06/2025
[13:42:44] [DOC: 9312608] ✅ Patient date processing completed successfully
[13:42:44] ✅    ✅ Date processing completed
[13:42:44] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Taylor
     └─ dob: 01/27/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 3030490
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'R00.1', 'thirdDiagnosis': 'R42', 'fourthDiagnosis': 'R41.3', 'fifthDiagnosis': 'J44.9', 'sixthDiagnosis': 'E11.40'}]
[13:42:44] 🔄 
🔄 Step 4: Extracting order data...
[13:42:47] ℹ️  Order extraction - MRN: '3030490'
[13:42:47] ℹ️  Order extraction - Sex: 'MALE'
[13:42:47] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:42:47] ℹ️  Order extraction - Payer Source: ''
[13:42:47] ✅ Order data extraction completed successfully
[13:42:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:42:47] ℹ️  Using MRN from patient data: '3030490' over '3030490'
[13:42:47] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:42:47] ✅ Patient name cross-validation successful
[13:42:47] ✅    ✅ Data merged successfully
[13:42:48] ✅    ✅ Order data extracted and validated
[13:42:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:42:56] [DOC: 9312608] ✅ Patient exists in API: James Taylor, ID: ad9f76a8-5163-4c6f-b41a-bfb2198b9730
[13:42:56] ✅    ✅ Existing patient found with ID: ad9f76a8-5163-4c6f-b41a-bfb2198b9730
[13:42:56] 🔄 
🔄 Step 6: Pushing order to API...
[13:42:56] [DOC: 9312608] ℹ️  Pushing order via API for patient ID: ad9f76a8-5163-4c6f-b41a-bfb2198b9730
[13:42:58] [DOC: 9312608] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16601"}
[13:42:58] ❌    ❌ Failed to push order
[13:42:58] 🔄 
🔄 Step 7: Writing to CSV...
[13:42:58] [DOC: 9312608] ℹ️  Calculated age: 82 from DOB: 01/27/1943
[13:42:58] [DOC: 9312608] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:42:58] [DOC: 9312608] ℹ️  Payer Source extracted: ''
[13:42:58] [DOC: 9312608] ℹ️  Diagnosis codes being written:
[13:42:58] [DOC: 9312608] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[13:42:58] [DOC: 9312608] ℹ️    - Latest_Episode_Seconddiagnosis: 'R00.1'
[13:42:58] [DOC: 9312608] ℹ️    - Latest_Episode_Thirddiagnosis: 'R42'
[13:42:58] [DOC: 9312608] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R41.3'
[13:42:58] [DOC: 9312608] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J44.9'
[13:42:58] [DOC: 9312608] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E11.40'
[13:42:58] [DOC: 9312608] ✅ Patient data written to CSV: James Taylor | Sex: MALE | Age: 82 | Service: Skilled Nursing | Payer:  | MRN: 3030490
[13:42:58] ✅    ✅ Document 9312608 processed and saved successfully
[13:42:58] 🔄 
🔄 Step 8: Saving API details...
[13:42:58] [DOC: 9312608] ℹ️  API push details saved for document 9312608
[13:42:58] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9312598                         ║
================================================================================
[13:42:58] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:42:58] ℹ️  Date: 05/27/2025
[13:42:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:42:59] [DOC: 9312598] ✅ Text extracted using pdfplumber (1095 chars)
[13:42:59] ✅    ✅ Text extracted using pdfplumber (1095 chars)
[13:42:59] 🔄 
🔄 Step 2: Extracting patient data...
[13:43:02] ℹ️  AI extracted raw sex value: 'F'
[13:43:02] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:43:02] ℹ️  AI extracted payer source: ''
[13:43:02] ℹ️  AI extracted diagnoses:
[13:43:02] ℹ️    - Diagnosis 1: ''
[13:43:02] ℹ️    - Diagnosis 2: ''
[13:43:02] ℹ️    - Diagnosis 3: ''
[13:43:02] ℹ️    - Diagnosis 4: ''
[13:43:02] ℹ️    - Diagnosis 5: ''
[13:43:02] ℹ️    - Diagnosis 6: ''
[13:43:02] ℹ️  Final extracted MRN: '2957725'
[13:43:02] ℹ️  Final extracted Sex: 'FEMALE'
[13:43:02] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:43:02] ℹ️  Final extracted Payer Source: ''
[13:43:02] ✅ Patient data extraction completed successfully
[13:43:02] ✅    ✅ Patient data extracted successfully
[13:43:02] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Senuick
     └─ dob: 11/19/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2957725
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/15/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:43:02] ✅    ✅ Patient identified: Nancy Senuick
[13:43:02] ✅    ✅ Patient name validation passed
[13:43:02] 🔄 
🔄 Step 3: Processing patient dates...
[13:43:02] [DOC: 9312598] ℹ️  DOB normalized: 11/19/1944
[13:43:02] [DOC: 9312598] ℹ️  Episode startOfEpisode normalized: 05/15/2025
[13:43:02] [DOC: 9312598] ✅ Patient date processing completed successfully
[13:43:02] ✅    ✅ Date processing completed
[13:43:02] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Senuick
     └─ dob: 11/19/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2957725
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/15/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:43:02] 🔄 
🔄 Step 4: Extracting order data...
[13:43:04] ℹ️  Order extraction - MRN: '2957725'
[13:43:04] ℹ️  Order extraction - Sex: 'FEMALE'
[13:43:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:43:04] ℹ️  Order extraction - Payer Source: ''
[13:43:04] ✅ Order data extraction completed successfully
[13:43:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:43:04] ℹ️  Using MRN from patient data: '2957725' over '2957725'
[13:43:04] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:43:04] ✅ Patient name cross-validation successful
[13:43:04] ✅    ✅ Data merged successfully
[13:43:05] ✅    ✅ Order data extracted and validated
[13:43:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:43:12] [DOC: 9312598] ✅ Patient exists in API: Nancy Senuick, ID: d45676c2-4d8d-4fea-8a84-0a2a90a374be
[13:43:12] ✅    ✅ Existing patient found with ID: d45676c2-4d8d-4fea-8a84-0a2a90a374be
[13:43:12] 🔄 
🔄 Step 6: Pushing order to API...
[13:43:12] [DOC: 9312598] ℹ️  Pushing order via API for patient ID: d45676c2-4d8d-4fea-8a84-0a2a90a374be
[13:43:13] [DOC: 9312598] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16588"}
[13:43:13] ❌    ❌ Failed to push order
[13:43:13] 🔄 
🔄 Step 7: Writing to CSV...
[13:43:13] [DOC: 9312598] ℹ️  Calculated age: 80 from DOB: 11/19/1944
[13:43:13] [DOC: 9312598] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:43:13] [DOC: 9312598] ℹ️  Payer Source extracted: ''
[13:43:13] [DOC: 9312598] ℹ️  Diagnosis codes being written:
[13:43:13] [DOC: 9312598] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:43:13] [DOC: 9312598] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:43:13] [DOC: 9312598] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:43:13] [DOC: 9312598] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:43:13] [DOC: 9312598] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:43:13] [DOC: 9312598] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:43:13] [DOC: 9312598] ✅ Patient data written to CSV: Nancy Senuick | Sex: FEMALE | Age: 80 | Service: Skilled Nursing | Payer:  | MRN: 2957725
[13:43:13] ✅    ✅ Document 9312598 processed and saved successfully
[13:43:13] 🔄 
🔄 Step 8: Saving API details...
[13:43:13] [DOC: 9312598] ℹ️  API push details saved for document 9312598
[13:43:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9312595                         ║
================================================================================
[13:43:13] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:43:13] ℹ️  Date: 05/27/2025
[13:43:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:43:15] [DOC: 9312595] ✅ Text extracted using pdfplumber (1217 chars)
[13:43:15] ✅    ✅ Text extracted using pdfplumber (1217 chars)
[13:43:15] 🔄 
🔄 Step 2: Extracting patient data...
[13:43:17] ℹ️  AI extracted raw sex value: 'M'
[13:43:17] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:43:17] ℹ️  AI extracted payer source: ''
[13:43:17] ℹ️  AI extracted diagnoses:
[13:43:17] ℹ️    - Diagnosis 1: ''
[13:43:17] ℹ️    - Diagnosis 2: ''
[13:43:17] ℹ️    - Diagnosis 3: ''
[13:43:17] ℹ️    - Diagnosis 4: ''
[13:43:17] ℹ️    - Diagnosis 5: ''
[13:43:17] ℹ️    - Diagnosis 6: ''
[13:43:17] ℹ️  Final extracted MRN: '2741524'
[13:43:17] ℹ️  Final extracted Sex: 'MALE'
[13:43:17] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:43:17] ℹ️  Final extracted Payer Source: ''
[13:43:17] ✅ Patient data extraction completed successfully
[13:43:17] ✅    ✅ Patient data extracted successfully
[13:43:17] 📊 Patient Response
     └─ patientFName: Stephen
     └─ patientLName: Mellor
     └─ dob: 07/24/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2741524
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:43:17] ✅    ✅ Patient identified: Stephen Mellor
[13:43:17] ✅    ✅ Patient name validation passed
[13:43:17] 🔄 
🔄 Step 3: Processing patient dates...
[13:43:17] [DOC: 9312595] ℹ️  DOB normalized: 07/24/1944
[13:43:17] [DOC: 9312595] ℹ️  Episode startOfEpisode normalized: 05/21/2025
[13:43:17] [DOC: 9312595] ✅ Patient date processing completed successfully
[13:43:17] ✅    ✅ Date processing completed
[13:43:17] 📊 Processed Patient Data
     └─ patientFName: Stephen
     └─ patientLName: Mellor
     └─ dob: 07/24/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2741524
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:43:17] 🔄 
🔄 Step 4: Extracting order data...
[13:43:19] ℹ️  Order extraction - MRN: '2741524'
[13:43:19] ℹ️  Order extraction - Sex: 'MALE'
[13:43:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:43:19] ℹ️  Order extraction - Payer Source: ''
[13:43:19] ✅ Order data extraction completed successfully
[13:43:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:43:19] ℹ️  Using MRN from patient data: '2741524' over '2741524'
[13:43:19] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:43:19] ✅ Patient name cross-validation successful
[13:43:19] ✅    ✅ Data merged successfully
[13:43:20] ✅    ✅ Order data extracted and validated
[13:43:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:43:26] [DOC: 9312595] ✅ Patient exists in API: Stephen Mellor, ID: edae13d2-79b4-4662-b44c-e001a00d9a72
[13:43:26] ✅    ✅ Existing patient found with ID: edae13d2-79b4-4662-b44c-e001a00d9a72
[13:43:26] 🔄 
🔄 Step 6: Pushing order to API...
[13:43:26] [DOC: 9312595] ℹ️  Pushing order via API for patient ID: edae13d2-79b4-4662-b44c-e001a00d9a72
[13:43:27] [DOC: 9312595] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16553"}
[13:43:27] ❌    ❌ Failed to push order
[13:43:27] 🔄 
🔄 Step 7: Writing to CSV...
[13:43:27] [DOC: 9312595] ℹ️  Calculated age: 80 from DOB: 07/24/1944
[13:43:27] [DOC: 9312595] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:43:27] [DOC: 9312595] ℹ️  Payer Source extracted: ''
[13:43:27] [DOC: 9312595] ℹ️  Diagnosis codes being written:
[13:43:27] [DOC: 9312595] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:43:27] [DOC: 9312595] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:43:27] [DOC: 9312595] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:43:27] [DOC: 9312595] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:43:27] [DOC: 9312595] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:43:27] [DOC: 9312595] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:43:27] [DOC: 9312595] ✅ Patient data written to CSV: Stephen Mellor | Sex: MALE | Age: 80 | Service: Skilled Nursing | Payer:  | MRN: 2741524
[13:43:27] ✅    ✅ Document 9312595 processed and saved successfully
[13:43:27] 🔄 
🔄 Step 8: Saving API details...
[13:43:27] [DOC: 9312595] ℹ️  API push details saved for document 9312595
[13:43:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9312578                         ║
================================================================================
[13:43:27] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:43:27] ℹ️  Date: 05/27/2025
[13:43:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:43:29] [DOC: 9312578] ✅ Text extracted using pdfplumber (1275 chars)
[13:43:29] ✅    ✅ Text extracted using pdfplumber (1275 chars)
[13:43:29] 🔄 
🔄 Step 2: Extracting patient data...
[13:43:31] ℹ️  AI extracted raw sex value: 'M'
[13:43:31] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:43:31] ℹ️  AI extracted payer source: ''
[13:43:31] ℹ️  AI extracted diagnoses:
[13:43:31] ℹ️    - Diagnosis 1: 'None'
[13:43:31] ℹ️    - Diagnosis 2: 'None'
[13:43:31] ℹ️    - Diagnosis 3: 'None'
[13:43:31] ℹ️    - Diagnosis 4: 'None'
[13:43:31] ℹ️    - Diagnosis 5: 'None'
[13:43:31] ℹ️    - Diagnosis 6: 'None'
[13:43:31] ℹ️  Final extracted MRN: '2643854'
[13:43:31] ℹ️  Final extracted Sex: 'MALE'
[13:43:31] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:43:31] ℹ️  Final extracted Payer Source: ''
[13:43:31] ✅ Patient data extraction completed successfully
[13:43:31] ✅    ✅ Patient data extracted successfully
[13:43:31] 📊 Patient Response
     └─ patientFName: Anthony
     └─ patientLName: Lawrence
     └─ dob: 04/04/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2643854
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/10/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:43:31] ✅    ✅ Patient identified: Anthony Lawrence
[13:43:31] ✅    ✅ Patient name validation passed
[13:43:31] 🔄 
🔄 Step 3: Processing patient dates...
[13:43:31] [DOC: 9312578] ℹ️  DOB normalized: 04/04/1957
[13:43:31] [DOC: 9312578] ℹ️  Episode startOfEpisode normalized: 05/10/2025
[13:43:31] [DOC: 9312578] ✅ Patient date processing completed successfully
[13:43:31] ✅    ✅ Date processing completed
[13:43:31] 📊 Processed Patient Data
     └─ patientFName: Anthony
     └─ patientLName: Lawrence
     └─ dob: 04/04/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2643854
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/10/2025'}]
[13:43:31] 🔄 
🔄 Step 4: Extracting order data...
[13:43:33] ℹ️  Order extraction - MRN: '2643854'
[13:43:33] ℹ️  Order extraction - Sex: 'MALE'
[13:43:33] ℹ️  Order extraction - Service Line: 'SN'
[13:43:33] ℹ️  Order extraction - Payer Source: ''
[13:43:33] ✅ Order data extraction completed successfully
[13:43:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:43:33] ℹ️  Using MRN from patient data: '2643854' over '2643854'
[13:43:33] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[13:43:33] ✅ Patient name cross-validation successful
[13:43:33] ✅    ✅ Data merged successfully
[13:43:35] ✅    ✅ Order data extracted and validated
[13:43:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:43:35] [DOC: 9312578] ✅ Patient found in local cache: Anthony Lawrence, ID: b3ba6094-2f1c-464c-b433-335bce36fa49
[13:43:35] ✅    ✅ Existing patient found with ID: b3ba6094-2f1c-464c-b433-335bce36fa49
[13:43:35] 🔄 
🔄 Step 6: Pushing order to API...
[13:43:35] [DOC: 9312578] ℹ️  Pushing order via API for patient ID: b3ba6094-2f1c-464c-b433-335bce36fa49
[13:43:36] [DOC: 9312578] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16503"}
[13:43:36] ❌    ❌ Failed to push order
[13:43:36] 🔄 
🔄 Step 7: Writing to CSV...
[13:43:36] [DOC: 9312578] ℹ️  Calculated age: 68 from DOB: 04/04/1957
[13:43:36] [DOC: 9312578] ℹ️  Service Line extracted: 'SN, Skilled Nursing'
[13:43:36] [DOC: 9312578] ℹ️  Payer Source extracted: ''
[13:43:36] [DOC: 9312578] ℹ️  Diagnosis codes being written:
[13:43:36] [DOC: 9312578] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:43:36] [DOC: 9312578] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:43:36] [DOC: 9312578] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:43:36] [DOC: 9312578] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:43:36] [DOC: 9312578] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:43:36] [DOC: 9312578] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:43:36] [DOC: 9312578] ✅ Patient data written to CSV: Anthony Lawrence | Sex: MALE | Age: 68 | Service: SN, Skilled Nursing | Payer:  | MRN: 2643854
[13:43:36] ✅    ✅ Document 9312578 processed and saved successfully
[13:43:36] 🔄 
🔄 Step 8: Saving API details...
[13:43:36] [DOC: 9312578] ℹ️  API push details saved for document 9312578
[13:43:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9312572                         ║
================================================================================
[13:43:36] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:43:36] ℹ️  Date: 05/27/2025
[13:43:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:43:40] [DOC: 9312572] ✅ Text extracted using pdfplumber (23407 chars)
[13:43:40] ✅    ✅ Text extracted using pdfplumber (23407 chars)
[13:43:40] 🔄 
🔄 Step 2: Extracting patient data...
[13:43:43] ℹ️  AI extracted raw sex value: 'M'
[13:43:43] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:43:43] ℹ️  AI extracted payer source: ''
[13:43:43] ℹ️  AI extracted diagnoses:
[13:43:43] ℹ️    - Diagnosis 1: 'S72.141D'
[13:43:43] ℹ️    - Diagnosis 2: 'W01.0XXD'
[13:43:43] ℹ️    - Diagnosis 3: 'I10'
[13:43:43] ℹ️    - Diagnosis 4: 'I25.10'
[13:43:43] ℹ️    - Diagnosis 5: 'E78.5'
[13:43:43] ℹ️    - Diagnosis 6: 'G47.33'
[13:43:43] ℹ️  Final extracted MRN: '3451044'
[13:43:43] ℹ️  Final extracted Sex: 'MALE'
[13:43:43] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:43:43] ℹ️  Final extracted Payer Source: ''
[13:43:43] ✅ Patient data extraction completed successfully
[13:43:43] ✅    ✅ Patient data extracted successfully
[13:43:43] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Breese
     └─ dob: 10/30/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 3451044
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/05/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'S72.141D', 'secondDiagnosis': 'W01.0XXD', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I25.10', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'G47.33'}]
[13:43:43] ✅    ✅ Patient identified: David Breese
[13:43:43] ✅    ✅ Patient name validation passed
[13:43:43] 🔄 
🔄 Step 3: Processing patient dates...
[13:43:43] [DOC: 9312572] ℹ️  DOB normalized: 10/30/1947
[13:43:43] [DOC: 9312572] ℹ️  Episode startOfCare normalized: 05/05/2025
[13:43:43] [DOC: 9312572] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[13:43:43] [DOC: 9312572] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[13:43:43] [DOC: 9312572] ✅ Patient date processing completed successfully
[13:43:43] ✅    ✅ Date processing completed
[13:43:43] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Breese
     └─ dob: 10/30/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 3451044
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/05/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'S72.141D', 'secondDiagnosis': 'W01.0XXD', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'I25.10', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'G47.33'}]
[13:43:43] 🔄 
🔄 Step 4: Extracting order data...
[13:43:46] ℹ️  Order extraction - MRN: '3451044'
[13:43:46] ℹ️  Order extraction - Sex: 'MALE'
[13:43:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:43:46] ℹ️  Order extraction - Payer Source: ''
[13:43:46] ✅ Order data extraction completed successfully
[13:43:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:43:46] ℹ️  Using MRN from patient data: '3451044' over '3451044'
[13:43:46] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:43:46] ✅ Patient name cross-validation successful
[13:43:46] ✅    ✅ Data merged successfully
[13:43:47] ✅    ✅ Order data extracted and validated
[13:43:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:43:47] [DOC: 9312572] ✅ Patient found in local cache: David Breese, ID: 49bdf5d7-829c-4215-90b5-9ddd891dce52
[13:43:47] ✅    ✅ Existing patient found with ID: 49bdf5d7-829c-4215-90b5-9ddd891dce52
[13:43:47] 🔄 
🔄 Step 6: Pushing order to API...
[13:43:47] [DOC: 9312572] ℹ️  Pushing order via API for patient ID: 49bdf5d7-829c-4215-90b5-9ddd891dce52
[13:43:48] [DOC: 9312572] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16402"}
[13:43:48] ❌    ❌ Failed to push order
[13:43:48] 🔄 
🔄 Step 7: Writing to CSV...
[13:43:48] [DOC: 9312572] ℹ️  Calculated age: 77 from DOB: 10/30/1947
[13:43:48] [DOC: 9312572] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:43:48] [DOC: 9312572] ℹ️  Payer Source extracted: ''
[13:43:48] [DOC: 9312572] ℹ️  Diagnosis codes being written:
[13:43:48] [DOC: 9312572] ℹ️    - Latest_Episode_Firstdiagnosis: 'S72.141D'
[13:43:48] [DOC: 9312572] ℹ️    - Latest_Episode_Seconddiagnosis: 'W01.0XXD'
[13:43:48] [DOC: 9312572] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[13:43:48] [DOC: 9312572] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I25.10'
[13:43:48] [DOC: 9312572] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E78.5'
[13:43:48] [DOC: 9312572] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G47.33'
[13:43:48] [DOC: 9312572] ✅ Patient data written to CSV: David Breese | Sex: MALE | Age: 77 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: 3451044
[13:43:48] ✅    ✅ Document 9312572 processed and saved successfully
[13:43:48] 🔄 
🔄 Step 8: Saving API details...
[13:43:48] [DOC: 9312572] ℹ️  API push details saved for document 9312572
[13:43:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9312056                         ║
================================================================================
[13:43:48] ℹ️  Agency: AccentCare Fall River
[13:43:48] ℹ️  Date: 05/27/2025
[13:43:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:43:49] [DOC: 9312056] ❌ Critical failure in get_pdf_text: Invalid response format
[13:43:50] ❌ Failed to extract text for Doc ID 9312056
[13:43:50] [DOC: 9312056] ℹ️  API push details saved for document 9312056
================================================================================
║                        Processing Document ID: 9311341                         ║
================================================================================
[13:43:50] ℹ️  Agency: Visiting Rehab & Nursing Services
[13:43:50] ℹ️  Date: 05/27/2025
[13:43:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:43:54] [DOC: 9311341] ✅ Text extracted using pdfplumber (44498 chars)
[13:43:54] ✅    ✅ Text extracted using pdfplumber (44498 chars)
[13:43:54] 🔄 
🔄 Step 2: Extracting patient data...
[13:43:57] ℹ️  AI extracted raw sex value: 'None'
[13:43:57] ℹ️  AI extracted service line: 'None'
[13:43:57] ℹ️  AI extracted payer source: 'None'
[13:43:57] ℹ️  AI extracted diagnoses:
[13:43:57] ℹ️    - Diagnosis 1: ''
[13:43:57] ℹ️    - Diagnosis 2: ''
[13:43:57] ℹ️    - Diagnosis 3: ''
[13:43:57] ℹ️    - Diagnosis 4: ''
[13:43:57] ℹ️    - Diagnosis 5: ''
[13:43:57] ℹ️    - Diagnosis 6: ''
[13:43:57] ℹ️  Final extracted MRN: ''
[13:43:57] ℹ️  Final extracted Sex: ''
[13:43:57] ℹ️  Final extracted Service Line: ''
[13:43:57] ℹ️  Final extracted Payer Source: ''
[13:43:57] ✅ Patient data extraction completed successfully
[13:43:57] ✅    ✅ Patient data extracted successfully
[13:43:57] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[13:43:57] ⚠️     ❌ Insufficient patient data extracted
[13:43:57] [DOC: 9311341] ℹ️  API push details saved for document 9311341
================================================================================
║                        Processing Document ID: 9311333                         ║
================================================================================
[13:43:57] ℹ️  Agency: Visiting Rehab & Nursing Services
[13:43:57] ℹ️  Date: 05/27/2025
[13:43:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:44:00] [DOC: 9311333] ✅ Text extracted using pdfplumber (72370 chars)
[13:44:00] ✅    ✅ Text extracted using pdfplumber (72370 chars)
[13:44:00] 🔄 
🔄 Step 2: Extracting patient data...
[13:44:04] ℹ️  AI extracted raw sex value: ''
[13:44:04] ℹ️  AI extracted service line: ''
[13:44:04] ℹ️  AI extracted payer source: ''
[13:44:04] ℹ️  AI extracted diagnoses:
[13:44:04] ℹ️    - Diagnosis 1: ''
[13:44:04] ℹ️    - Diagnosis 2: ''
[13:44:04] ℹ️    - Diagnosis 3: ''
[13:44:04] ℹ️    - Diagnosis 4: ''
[13:44:04] ℹ️    - Diagnosis 5: ''
[13:44:04] ℹ️    - Diagnosis 6: ''
[13:44:04] ℹ️  Final extracted MRN: ''
[13:44:04] ℹ️  Final extracted Sex: ''
[13:44:04] ℹ️  Final extracted Service Line: ''
[13:44:04] ℹ️  Final extracted Payer Source: ''
[13:44:04] ✅ Patient data extraction completed successfully
[13:44:04] ✅    ✅ Patient data extracted successfully
[13:44:04] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[13:44:04] ⚠️     ❌ Insufficient patient data extracted
[13:44:04] [DOC: 9311333] ℹ️  API push details saved for document 9311333
================================================================================
║                        Processing Document ID: 9311312                         ║
================================================================================
[13:44:04] ℹ️  Agency: Visiting Rehab & Nursing Services
[13:44:04] ℹ️  Date: 05/27/2025
[13:44:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:44:08] [DOC: 9311312] ✅ Text extracted using pdfplumber (15141 chars)
[13:44:08] ✅    ✅ Text extracted using pdfplumber (15141 chars)
[13:44:08] 🔄 
🔄 Step 2: Extracting patient data...
[13:44:11] ℹ️  AI extracted raw sex value: 'M'
[13:44:11] ℹ️  AI extracted service line: 'OT'
[13:44:11] ℹ️  AI extracted payer source: ''
[13:44:11] ℹ️  AI extracted diagnoses:
[13:44:11] ℹ️    - Diagnosis 1: 'S06'
[13:44:11] ℹ️    - Diagnosis 2: 'R27.9'
[13:44:11] ℹ️    - Diagnosis 3: ''
[13:44:11] ℹ️    - Diagnosis 4: ''
[13:44:11] ℹ️    - Diagnosis 5: ''
[13:44:11] ℹ️    - Diagnosis 6: ''
[13:44:11] ℹ️  Final extracted MRN: '1281014806'
[13:44:11] ℹ️  Final extracted Sex: 'MALE'
[13:44:11] ℹ️  Final extracted Service Line: 'OT'
[13:44:11] ℹ️  Final extracted Payer Source: ''
[13:44:11] ✅ Patient data extraction completed successfully
[13:44:11] ✅    ✅ Patient data extracted successfully
[13:44:11] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Cropper
     └─ dob: 07/31/1959
     └─ patientSex: MALE
     └─ medicalRecordNo: 1281014806
     └─ billingProvider: Home Again Health Care, LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Home Again Health Care, LLC
     └─ address: 125 High Street , STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: 
     └─ phoneNumber: (877) 242-8771
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/05/2025', 'endOfEpisode': '07/03/2025', 'firstDiagnosis': 'S06', 'secondDiagnosis': 'R27.9', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:44:11] ✅    ✅ Patient identified: James Cropper
[13:44:11] ✅    ✅ Patient name validation passed
[13:44:11] 🔄 
🔄 Step 3: Processing patient dates...
[13:44:11] [DOC: 9311312] ℹ️  DOB normalized: 07/31/1959
[13:44:11] [DOC: 9311312] ℹ️  Episode startOfEpisode normalized: 05/05/2025
[13:44:11] [DOC: 9311312] ℹ️  Episode endOfEpisode normalized: 07/03/2025
[13:44:11] [DOC: 9311312] ✅ Patient date processing completed successfully
[13:44:11] ✅    ✅ Date processing completed
[13:44:11] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Cropper
     └─ dob: 07/31/1959
     └─ patientSex: MALE
     └─ medicalRecordNo: 1281014806
     └─ billingProvider: Home Again Health Care, LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Home Again Health Care, LLC
     └─ address: 125 High Street , STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: 
     └─ phoneNumber: (877) 242-8771
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/05/2025', 'endOfEpisode': '07/03/2025', 'firstDiagnosis': 'S06', 'secondDiagnosis': 'R27.9', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:44:11] 🔄 
🔄 Step 4: Extracting order data...
[13:44:14] ℹ️  Order extraction - MRN: 'opbrMC1959'
[13:44:14] ℹ️  Order extraction - Sex: 'MALE'
[13:44:14] ℹ️  Order extraction - Service Line: 'OT'
[13:44:14] ℹ️  Order extraction - Payer Source: ''
[13:44:14] ✅ Order data extraction completed successfully
[13:44:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:44:14] ℹ️  Using MRN from patient data: '1281014806' over 'opbrMC1959'
[13:44:14] ℹ️  Service line consistent in both sources: 'OT'
[13:44:14] ✅ Patient name cross-validation successful
[13:44:14] ✅    ✅ Data merged successfully
[13:44:15] ✅    ✅ Order data extracted and validated
[13:44:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:44:22] [DOC: 9311312] ✅ Patient exists in API: James Cropper, ID: 655eafac-f766-498c-a7e0-935b7c508d72
[13:44:22] ✅    ✅ Existing patient found with ID: 655eafac-f766-498c-a7e0-935b7c508d72
[13:44:22] 🔄 
🔄 Step 6: Pushing order to API...
[13:44:22] [DOC: 9311312] ℹ️  Pushing order via API for patient ID: 655eafac-f766-498c-a7e0-935b7c508d72
[13:44:23] [DOC: 9311312] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:44:23] ❌    ❌ Failed to push order
[13:44:23] 🔄 
🔄 Step 7: Writing to CSV...
[13:44:23] [DOC: 9311312] ℹ️  Calculated age: 65 from DOB: 07/31/1959
[13:44:23] [DOC: 9311312] ℹ️  Service Line extracted: 'OT'
[13:44:23] [DOC: 9311312] ℹ️  Payer Source extracted: ''
[13:44:23] [DOC: 9311312] ℹ️  Diagnosis codes being written:
[13:44:23] [DOC: 9311312] ℹ️    - Latest_Episode_Firstdiagnosis: 'S06'
[13:44:23] [DOC: 9311312] ℹ️    - Latest_Episode_Seconddiagnosis: 'R27.9'
[13:44:23] [DOC: 9311312] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:44:23] [DOC: 9311312] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:44:23] [DOC: 9311312] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:44:23] [DOC: 9311312] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:44:23] [DOC: 9311312] ✅ Patient data written to CSV: James Cropper | Sex: MALE | Age: 65 | Service: OT | Payer:  | MRN: 1281014806
[13:44:23] ✅    ✅ Document 9311312 processed and saved successfully
[13:44:23] 🔄 
🔄 Step 8: Saving API details...
[13:44:23] [DOC: 9311312] ℹ️  API push details saved for document 9311312
[13:44:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9311229                         ║
================================================================================
[13:44:23] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:44:23] ℹ️  Date: 05/27/2025
[13:44:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:44:25] [DOC: 9311229] ✅ Text extracted using pdfplumber (1250 chars)
[13:44:25] ✅    ✅ Text extracted using pdfplumber (1250 chars)
[13:44:25] 🔄 
🔄 Step 2: Extracting patient data...
[13:44:27] ℹ️  AI extracted raw sex value: 'F'
[13:44:27] ℹ️  AI extracted service line: 'Medical Social Work'
[13:44:27] ℹ️  AI extracted payer source: ''
[13:44:27] ℹ️  AI extracted diagnoses:
[13:44:27] ℹ️    - Diagnosis 1: ''
[13:44:27] ℹ️    - Diagnosis 2: ''
[13:44:27] ℹ️    - Diagnosis 3: ''
[13:44:27] ℹ️    - Diagnosis 4: ''
[13:44:27] ℹ️    - Diagnosis 5: ''
[13:44:27] ℹ️    - Diagnosis 6: ''
[13:44:27] ℹ️  Final extracted MRN: '2085476'
[13:44:27] ℹ️  Final extracted Sex: 'FEMALE'
[13:44:27] ℹ️  Final extracted Service Line: 'Medical Social Work'
[13:44:27] ℹ️  Final extracted Payer Source: ''
[13:44:27] ✅ Patient data extraction completed successfully
[13:44:27] ✅    ✅ Patient data extracted successfully
[13:44:27] 📊 Patient Response
     └─ patientFName: Joyce
     └─ patientLName: Simon
     └─ dob: 01/01/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2085476
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/15/2025', 'endOfEpisode': '08/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:44:27] ✅    ✅ Patient identified: Joyce Simon
[13:44:27] ✅    ✅ Patient name validation passed
[13:44:27] 🔄 
🔄 Step 3: Processing patient dates...
[13:44:27] [DOC: 9311229] ℹ️  DOB normalized: 01/01/1936
[13:44:27] [DOC: 9311229] ℹ️  Episode startOfEpisode normalized: 05/15/2025
[13:44:27] [DOC: 9311229] ℹ️  Episode endOfEpisode normalized: 08/12/2025
[13:44:27] [DOC: 9311229] ✅ Patient date processing completed successfully
[13:44:27] ✅    ✅ Date processing completed
[13:44:27] 📊 Processed Patient Data
     └─ patientFName: Joyce
     └─ patientLName: Simon
     └─ dob: 01/01/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2085476
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/15/2025', 'endOfEpisode': '08/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:44:27] 🔄 
🔄 Step 4: Extracting order data...
[13:44:30] ℹ️  Order extraction - MRN: '2085476'
[13:44:30] ℹ️  Order extraction - Sex: 'FEMALE'
[13:44:30] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[13:44:30] ℹ️  Order extraction - Payer Source: ''
[13:44:30] ✅ Order data extraction completed successfully
[13:44:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:44:30] ℹ️  Using MRN from patient data: '2085476' over '2085476'
[13:44:30] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[13:44:30] ✅ Patient name cross-validation successful
[13:44:30] ✅    ✅ Data merged successfully
[13:44:31] ✅    ✅ Order data extracted and validated
[13:44:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:44:37] [DOC: 9311229] ✅ Patient exists in API: Joyce Simon, ID: a5f8298d-63ea-4aab-8ad4-b4c248dd241f
[13:44:37] ✅    ✅ Existing patient found with ID: a5f8298d-63ea-4aab-8ad4-b4c248dd241f
[13:44:37] 🔄 
🔄 Step 6: Pushing order to API...
[13:44:37] [DOC: 9311229] ℹ️  Pushing order via API for patient ID: a5f8298d-63ea-4aab-8ad4-b4c248dd241f
[13:44:38] [DOC: 9311229] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16589"}
[13:44:38] ❌    ❌ Failed to push order
[13:44:38] 🔄 
🔄 Step 7: Writing to CSV...
[13:44:38] [DOC: 9311229] ℹ️  Calculated age: 89 from DOB: 01/01/1936
[13:44:38] [DOC: 9311229] ℹ️  Service Line extracted: 'Medical Social Work'
[13:44:38] [DOC: 9311229] ℹ️  Payer Source extracted: ''
[13:44:38] [DOC: 9311229] ℹ️  Diagnosis codes being written:
[13:44:38] [DOC: 9311229] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:44:38] [DOC: 9311229] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:44:38] [DOC: 9311229] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:44:38] [DOC: 9311229] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:44:38] [DOC: 9311229] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:44:38] [DOC: 9311229] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:44:38] [DOC: 9311229] ✅ Patient data written to CSV: Joyce Simon | Sex: FEMALE | Age: 89 | Service: Medical Social Work | Payer:  | MRN: 2085476
[13:44:38] ✅    ✅ Document 9311229 processed and saved successfully
[13:44:38] 🔄 
🔄 Step 8: Saving API details...
[13:44:38] [DOC: 9311229] ℹ️  API push details saved for document 9311229
[13:44:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9311226                         ║
================================================================================
[13:44:38] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:44:38] ℹ️  Date: 05/27/2025
[13:44:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:44:40] [DOC: 9311226] ✅ Text extracted using pdfplumber (2263 chars)
[13:44:40] ✅    ✅ Text extracted using pdfplumber (2263 chars)
[13:44:40] 🔄 
🔄 Step 2: Extracting patient data...
[13:44:42] ℹ️  AI extracted raw sex value: 'F'
[13:44:42] ℹ️  AI extracted service line: 'RN'
[13:44:42] ℹ️  AI extracted payer source: ''
[13:44:42] ℹ️  AI extracted diagnoses:
[13:44:42] ℹ️    - Diagnosis 1: 'None'
[13:44:42] ℹ️    - Diagnosis 2: 'None'
[13:44:42] ℹ️    - Diagnosis 3: 'None'
[13:44:42] ℹ️    - Diagnosis 4: 'None'
[13:44:42] ℹ️    - Diagnosis 5: 'None'
[13:44:42] ℹ️    - Diagnosis 6: 'None'
[13:44:42] ℹ️  Final extracted MRN: '2936720'
[13:44:42] ℹ️  Final extracted Sex: 'FEMALE'
[13:44:42] ℹ️  Final extracted Service Line: 'RN'
[13:44:42] ℹ️  Final extracted Payer Source: ''
[13:44:42] ✅ Patient data extraction completed successfully
[13:44:42] ✅    ✅ Patient data extracted successfully
[13:44:42] 📊 Patient Response
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:44:42] ✅    ✅ Patient identified: Stella Saint
[13:44:42] ✅    ✅ Patient name validation passed
[13:44:42] 🔄 
🔄 Step 3: Processing patient dates...
[13:44:42] [DOC: 9311226] ℹ️  DOB normalized: 07/02/1928
[13:44:42] [DOC: 9311226] ✅ Patient date processing completed successfully
[13:44:42] ✅    ✅ Date processing completed
[13:44:42] 📊 Processed Patient Data
     └─ patientFName: Stella
     └─ patientLName: Saint
     └─ dob: 07/02/1928
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2936720
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[13:44:42] 🔄 
🔄 Step 4: Extracting order data...
[13:44:45] ℹ️  Order extraction - MRN: '2936720'
[13:44:45] ℹ️  Order extraction - Sex: 'FEMALE'
[13:44:45] ℹ️  Order extraction - Service Line: 'Clergy'
[13:44:45] ℹ️  Order extraction - Payer Source: ''
[13:44:45] ✅ Order data extraction completed successfully
[13:44:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:44:45] ℹ️  Using MRN from patient data: '2936720' over '2936720'
[13:44:45] ℹ️  Combined service lines: Patient='RN' + Order='Clergy' = 'Clergy, RN'
[13:44:45] ✅ Patient name cross-validation successful
[13:44:45] ✅    ✅ Data merged successfully
[13:44:46] ✅    ✅ Order data extracted and validated
[13:44:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:44:52] [DOC: 9311226] ✅ Patient exists in API: Stella Saint, ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[13:44:52] ✅    ✅ Existing patient found with ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[13:44:52] 🔄 
🔄 Step 6: Pushing order to API...
[13:44:52] [DOC: 9311226] ℹ️  Pushing order via API for patient ID: 62d6f59b-a982-4649-b0d6-6a76a6bee0f6
[13:44:54] [DOC: 9311226] ❌ Order push failed with status 201: {"id":"c1df3d89-9154-4f51-b760-088b8eaa6fbc","orderWAVId":"ORD19944","orderNo":"1094937, 1094938, 1093432, 1093433","orderDate":"05/23/2025","startOfCare":"04/25/2025","episodeStartDate":"04/25/2025","episodeEndDate":"07/23/2025","documentID":"9311226","mrn":"2936720","patientName":"Saint,Stella","sentToPhysicianDate":"05/27/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"06/03/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"62d6f59b-a982-4649-b0d6-6a76a6bee0f6","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[13:44:54] ❌    ❌ Failed to push order
[13:44:54] 🔄 
🔄 Step 7: Writing to CSV...
[13:44:54] [DOC: 9311226] ℹ️  Calculated age: 96 from DOB: 07/02/1928
[13:44:54] [DOC: 9311226] ℹ️  Service Line extracted: 'Clergy, RN'
[13:44:54] [DOC: 9311226] ℹ️  Payer Source extracted: ''
[13:44:54] [DOC: 9311226] ℹ️  Diagnosis codes being written:
[13:44:54] [DOC: 9311226] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:44:54] [DOC: 9311226] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:44:54] [DOC: 9311226] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:44:54] [DOC: 9311226] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:44:54] [DOC: 9311226] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:44:54] [DOC: 9311226] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:44:54] [DOC: 9311226] ✅ Patient data written to CSV: Stella Saint | Sex: FEMALE | Age: 96 | Service: Clergy, RN | Payer:  | MRN: 2936720
[13:44:54] ✅    ✅ Document 9311226 processed and saved successfully
[13:44:54] 🔄 
🔄 Step 8: Saving API details...
[13:44:54] [DOC: 9311226] ℹ️  API push details saved for document 9311226
[13:44:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9311212                         ║
================================================================================
[13:44:54] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:44:54] ℹ️  Date: 05/27/2025
[13:44:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:44:55] [DOC: 9311212] ✅ Text extracted using pdfplumber (1586 chars)
[13:44:55] ✅    ✅ Text extracted using pdfplumber (1586 chars)
[13:44:55] 🔄 
🔄 Step 2: Extracting patient data...
[13:44:58] ℹ️  AI extracted raw sex value: 'F'
[13:44:58] ℹ️  AI extracted service line: 'RN'
[13:44:58] ℹ️  AI extracted payer source: ''
[13:44:58] ℹ️  AI extracted diagnoses:
[13:44:58] ℹ️    - Diagnosis 1: ''
[13:44:58] ℹ️    - Diagnosis 2: ''
[13:44:58] ℹ️    - Diagnosis 3: ''
[13:44:58] ℹ️    - Diagnosis 4: ''
[13:44:58] ℹ️    - Diagnosis 5: ''
[13:44:58] ℹ️    - Diagnosis 6: ''
[13:44:58] ℹ️  Final extracted MRN: '3495983'
[13:44:58] ℹ️  Final extracted Sex: 'FEMALE'
[13:44:58] ℹ️  Final extracted Service Line: 'RN'
[13:44:58] ℹ️  Final extracted Payer Source: ''
[13:44:58] ✅ Patient data extraction completed successfully
[13:44:58] ✅    ✅ Patient data extracted successfully
[13:44:58] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: McGoldrick
     └─ dob: 10/27/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3495983
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:44:58] ✅    ✅ Patient identified: Janice McGoldrick
[13:44:58] ✅    ✅ Patient name validation passed
[13:44:58] 🔄 
🔄 Step 3: Processing patient dates...
[13:44:58] [DOC: 9311212] ℹ️  DOB normalized: 10/27/1931
[13:44:58] [DOC: 9311212] ✅ Patient date processing completed successfully
[13:44:58] ✅    ✅ Date processing completed
[13:44:58] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: McGoldrick
     └─ dob: 10/27/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3495983
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:44:58] 🔄 
🔄 Step 4: Extracting order data...
[13:45:00] ℹ️  Order extraction - MRN: '3495983'
[13:45:00] ℹ️  Order extraction - Sex: 'FEMALE'
[13:45:00] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:45:00] ℹ️  Order extraction - Payer Source: ''
[13:45:00] ✅ Order data extraction completed successfully
[13:45:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:45:00] ℹ️  Using MRN from patient data: '3495983' over '3495983'
[13:45:00] ℹ️  Combined service lines: Patient='RN' + Order='Skilled Nursing' = 'RN, Skilled Nursing'
[13:45:00] ✅ Patient name cross-validation successful
[13:45:00] ✅    ✅ Data merged successfully
[13:45:01] ⚠️     ❌ Skipping - missing episode start date
[13:45:01] [DOC: 9311212] ℹ️  API push details saved for document 9311212
================================================================================
║                        Processing Document ID: 9311210                         ║
================================================================================
[13:45:01] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:45:01] ℹ️  Date: 05/27/2025
[13:45:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:45:03] [DOC: 9311210] ✅ Text extracted using pdfplumber (926 chars)
[13:45:03] ✅    ✅ Text extracted using pdfplumber (926 chars)
[13:45:03] 🔄 
🔄 Step 2: Extracting patient data...
[13:45:05] ℹ️  AI extracted raw sex value: 'M'
[13:45:05] ℹ️  AI extracted service line: 'LPN'
[13:45:05] ℹ️  AI extracted payer source: ''
[13:45:05] ℹ️  AI extracted diagnoses:
[13:45:05] ℹ️    - Diagnosis 1: ''
[13:45:05] ℹ️    - Diagnosis 2: ''
[13:45:05] ℹ️    - Diagnosis 3: ''
[13:45:05] ℹ️    - Diagnosis 4: ''
[13:45:05] ℹ️    - Diagnosis 5: ''
[13:45:05] ℹ️    - Diagnosis 6: ''
[13:45:05] ℹ️  Final extracted MRN: '2611249'
[13:45:05] ℹ️  Final extracted Sex: 'MALE'
[13:45:05] ℹ️  Final extracted Service Line: 'LPN'
[13:45:05] ℹ️  Final extracted Payer Source: ''
[13:45:05] ✅ Patient data extraction completed successfully
[13:45:05] ✅    ✅ Patient data extracted successfully
[13:45:05] 📊 Patient Response
     └─ patientFName: Kelada
     └─ patientLName: Sobhy
     └─ dob: 10/02/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2611249
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:45:05] ✅    ✅ Patient identified: Kelada Sobhy
[13:45:05] ✅    ✅ Patient name validation passed
[13:45:05] 🔄 
🔄 Step 3: Processing patient dates...
[13:45:05] [DOC: 9311210] ℹ️  DOB normalized: 10/02/1947
[13:45:05] [DOC: 9311210] ✅ Patient date processing completed successfully
[13:45:05] ✅    ✅ Date processing completed
[13:45:05] 📊 Processed Patient Data
     └─ patientFName: Kelada
     └─ patientLName: Sobhy
     └─ dob: 10/02/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 2611249
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:45:05] 🔄 
🔄 Step 4: Extracting order data...
[13:45:07] ℹ️  Order extraction - MRN: '2611249'
[13:45:07] ℹ️  Order extraction - Sex: 'MALE'
[13:45:07] ℹ️  Order extraction - Service Line: ''
[13:45:07] ℹ️  Order extraction - Payer Source: ''
[13:45:07] ✅ Order data extraction completed successfully
[13:45:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:45:07] ℹ️  Using MRN from patient data: '2611249' over '2611249'
[13:45:07] ℹ️  Using service line from patient data: 'LPN'
[13:45:07] ✅ Patient name cross-validation successful
[13:45:07] ✅    ✅ Data merged successfully
[13:45:09] ⚠️     ❌ Skipping - missing episode start date
[13:45:09] [DOC: 9311210] ℹ️  API push details saved for document 9311210
================================================================================
║                        Processing Document ID: 9311189                         ║
================================================================================
[13:45:09] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:45:09] ℹ️  Date: 05/27/2025
[13:45:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:45:10] [DOC: 9311189] ✅ Text extracted using pdfplumber (1373 chars)
[13:45:10] ✅    ✅ Text extracted using pdfplumber (1373 chars)
[13:45:10] 🔄 
🔄 Step 2: Extracting patient data...
[13:45:13] ℹ️  AI extracted raw sex value: 'F'
[13:45:13] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:45:13] ℹ️  AI extracted payer source: ''
[13:45:13] ℹ️  AI extracted diagnoses:
[13:45:13] ℹ️    - Diagnosis 1: 'None'
[13:45:13] ℹ️    - Diagnosis 2: 'None'
[13:45:13] ℹ️    - Diagnosis 3: 'None'
[13:45:13] ℹ️    - Diagnosis 4: 'None'
[13:45:13] ℹ️    - Diagnosis 5: 'None'
[13:45:13] ℹ️    - Diagnosis 6: 'None'
[13:45:13] ℹ️  Final extracted MRN: '2682827'
[13:45:13] ℹ️  Final extracted Sex: 'FEMALE'
[13:45:13] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:45:13] ℹ️  Final extracted Payer Source: ''
[13:45:13] ✅ Patient data extraction completed successfully
[13:45:13] ✅    ✅ Patient data extracted successfully
[13:45:13] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Maciel
     └─ dob: 01/06/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2682827
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:45:13] ✅    ✅ Patient identified: Patricia Maciel
[13:45:13] ✅    ✅ Patient name validation passed
[13:45:13] 🔄 
🔄 Step 3: Processing patient dates...
[13:45:13] [DOC: 9311189] ℹ️  DOB normalized: 01/06/1951
[13:45:13] [DOC: 9311189] ✅ Patient date processing completed successfully
[13:45:13] ✅    ✅ Date processing completed
[13:45:13] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Maciel
     └─ dob: 01/06/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2682827
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[13:45:13] 🔄 
🔄 Step 4: Extracting order data...
[13:45:15] ℹ️  Order extraction - MRN: '2682827'
[13:45:15] ℹ️  Order extraction - Sex: 'FEMALE'
[13:45:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:45:15] ℹ️  Order extraction - Payer Source: ''
[13:45:15] ✅ Order data extraction completed successfully
[13:45:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:45:15] ℹ️  Using MRN from patient data: '2682827' over '2682827'
[13:45:15] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:45:15] ✅ Patient name cross-validation successful
[13:45:15] ✅    ✅ Data merged successfully
[13:45:16] ✅    ✅ Order data extracted and validated
[13:45:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:45:16] [DOC: 9311189] ✅ Patient found in local cache: Patricia Maciel, ID: dee47df5-9c75-4a9c-a386-5e8749abe2e5
[13:45:16] ✅    ✅ Existing patient found with ID: dee47df5-9c75-4a9c-a386-5e8749abe2e5
[13:45:16] 🔄 
🔄 Step 6: Pushing order to API...
[13:45:16] [DOC: 9311189] ℹ️  Pushing order via API for patient ID: dee47df5-9c75-4a9c-a386-5e8749abe2e5
[13:45:17] [DOC: 9311189] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16547"}
[13:45:17] ❌    ❌ Failed to push order
[13:45:17] 🔄 
🔄 Step 7: Writing to CSV...
[13:45:17] [DOC: 9311189] ℹ️  Calculated age: 74 from DOB: 01/06/1951
[13:45:17] [DOC: 9311189] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:45:17] [DOC: 9311189] ℹ️  Payer Source extracted: ''
[13:45:17] [DOC: 9311189] ℹ️  Diagnosis codes being written:
[13:45:17] [DOC: 9311189] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:45:17] [DOC: 9311189] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:45:17] [DOC: 9311189] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:45:17] [DOC: 9311189] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:45:17] [DOC: 9311189] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:45:17] [DOC: 9311189] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:45:17] [DOC: 9311189] ✅ Patient data written to CSV: Patricia Maciel | Sex: FEMALE | Age: 74 | Service: Skilled Nursing | Payer:  | MRN: 2682827
[13:45:17] ✅    ✅ Document 9311189 processed and saved successfully
[13:45:17] 🔄 
🔄 Step 8: Saving API details...
[13:45:17] [DOC: 9311189] ℹ️  API push details saved for document 9311189
[13:45:17] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9311188                         ║
================================================================================
[13:45:17] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:45:17] ℹ️  Date: 05/27/2025
[13:45:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:45:19] [DOC: 9311188] ✅ Text extracted using pdfplumber (887 chars)
[13:45:19] ✅    ✅ Text extracted using pdfplumber (887 chars)
[13:45:19] 🔄 
🔄 Step 2: Extracting patient data...
[13:45:21] ℹ️  AI extracted raw sex value: 'M'
[13:45:21] ℹ️  AI extracted service line: 'Nursing'
[13:45:21] ℹ️  AI extracted payer source: ''
[13:45:21] ℹ️  AI extracted diagnoses:
[13:45:21] ℹ️    - Diagnosis 1: 'None'
[13:45:21] ℹ️    - Diagnosis 2: 'None'
[13:45:21] ℹ️    - Diagnosis 3: 'None'
[13:45:21] ℹ️    - Diagnosis 4: 'None'
[13:45:21] ℹ️    - Diagnosis 5: 'None'
[13:45:21] ℹ️    - Diagnosis 6: 'None'
[13:45:21] ℹ️  Final extracted MRN: '2390602'
[13:45:21] ℹ️  Final extracted Sex: 'MALE'
[13:45:21] ℹ️  Final extracted Service Line: 'Nursing'
[13:45:21] ℹ️  Final extracted Payer Source: ''
[13:45:21] ✅ Patient data extraction completed successfully
[13:45:21] ✅    ✅ Patient data extracted successfully
[13:45:21] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Davis
     └─ dob: 06/22/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2390602
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:45:21] ✅    ✅ Patient identified: Joseph Davis
[13:45:21] ✅    ✅ Patient name validation passed
[13:45:21] 🔄 
🔄 Step 3: Processing patient dates...
[13:45:21] [DOC: 9311188] ℹ️  DOB normalized: 06/22/1934
[13:45:21] [DOC: 9311188] ✅ Patient date processing completed successfully
[13:45:21] ✅    ✅ Date processing completed
[13:45:21] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Davis
     └─ dob: 06/22/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2390602
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[13:45:21] 🔄 
🔄 Step 4: Extracting order data...
[13:45:24] ℹ️  Order extraction - MRN: '2390602'
[13:45:24] ℹ️  Order extraction - Sex: 'MALE'
[13:45:24] ℹ️  Order extraction - Service Line: ''
[13:45:24] ℹ️  Order extraction - Payer Source: ''
[13:45:24] ✅ Order data extraction completed successfully
[13:45:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:45:24] ℹ️  Using MRN from patient data: '2390602' over '2390602'
[13:45:24] ℹ️  Using service line from patient data: 'Nursing'
[13:45:24] ✅ Patient name cross-validation successful
[13:45:24] ✅    ✅ Data merged successfully
[13:45:25] ⚠️     ❌ Skipping - missing episode start date
[13:45:25] [DOC: 9311188] ℹ️  API push details saved for document 9311188
================================================================================
║                        Processing Document ID: 9311060                         ║
================================================================================
[13:45:25] ℹ️  Agency: Fairhaven HH&H
[13:45:25] ℹ️  Date: 05/27/2025
[13:45:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:45:27] [DOC: 9311060] ✅ Text extracted using pdfplumber (1135 chars)
[13:45:27] ✅    ✅ Text extracted using pdfplumber (1135 chars)
[13:45:27] 🔄 
🔄 Step 2: Extracting patient data...
[13:45:29] ℹ️  AI extracted raw sex value: 'F'
[13:45:29] ℹ️  AI extracted service line: 'Hospice'
[13:45:29] ℹ️  AI extracted payer source: 'Medicare'
[13:45:29] ℹ️  AI extracted diagnoses:
[13:45:29] ℹ️    - Diagnosis 1: 'None'
[13:45:29] ℹ️    - Diagnosis 2: 'None'
[13:45:29] ℹ️    - Diagnosis 3: 'None'
[13:45:29] ℹ️    - Diagnosis 4: 'None'
[13:45:29] ℹ️    - Diagnosis 5: 'None'
[13:45:29] ℹ️    - Diagnosis 6: 'None'
[13:45:29] ℹ️  Final extracted MRN: '5782009'
[13:45:29] ℹ️  Final extracted Sex: 'FEMALE'
[13:45:29] ℹ️  Final extracted Service Line: 'Hospice'
[13:45:29] ℹ️  Final extracted Payer Source: 'Medicare'
[13:45:29] ✅ Patient data extraction completed successfully
[13:45:29] ✅    ✅ Patient data extracted successfully
[13:45:29] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Foster
     └─ dob: 06/16/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5782009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/23/2022', 'startOfEpisode': None, 'endOfEpisode': '06/09/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:45:29] ✅    ✅ Patient identified: Patricia Foster
[13:45:29] ✅    ✅ Patient name validation passed
[13:45:29] 🔄 
🔄 Step 3: Processing patient dates...
[13:45:29] [DOC: 9311060] ℹ️  DOB normalized: 06/16/1931
[13:45:29] [DOC: 9311060] ℹ️  Episode startOfCare normalized: 12/23/2022
[13:45:29] [DOC: 9311060] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[13:45:29] [DOC: 9311060] ✅ Patient date processing completed successfully
[13:45:29] ✅    ✅ Date processing completed
[13:45:29] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Foster
     └─ dob: 06/16/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5782009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/23/2022', 'endOfEpisode': '06/09/2025'}]
[13:45:29] 🔄 
🔄 Step 4: Extracting order data...
[13:45:31] ℹ️  Order extraction - MRN: '5782009'
[13:45:31] ℹ️  Order extraction - Sex: 'FEMALE'
[13:45:31] ℹ️  Order extraction - Service Line: 'HHA'
[13:45:31] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:45:31] ✅ Order data extraction completed successfully
[13:45:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:45:31] ℹ️  Using MRN from patient data: '5782009' over '5782009'
[13:45:31] ℹ️  Combined service lines: Patient='Hospice' + Order='HHA' = 'HHA, Hospice'
[13:45:31] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:45:31] ✅ Patient name cross-validation successful
[13:45:31] ✅    ✅ Data merged successfully
[13:45:33] ✅    ✅ Order data extracted and validated
[13:45:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:45:33] [DOC: 9311060] ✅ Patient found in local cache: Patricia Foster, ID: 02cfc02d-5153-4681-bdd5-391d0e7448c5
[13:45:33] ✅    ✅ Existing patient found with ID: 02cfc02d-5153-4681-bdd5-391d0e7448c5
[13:45:33] 🔄 
🔄 Step 6: Pushing order to API...
[13:45:33] [DOC: 9311060] ℹ️  Pushing order via API for patient ID: 02cfc02d-5153-4681-bdd5-391d0e7448c5
[13:45:34] [DOC: 9311060] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:45:34] ❌    ❌ Failed to push order
[13:45:34] 🔄 
🔄 Step 7: Writing to CSV...
[13:45:34] [DOC: 9311060] ℹ️  Calculated age: 93 from DOB: 06/16/1931
[13:45:34] [DOC: 9311060] ℹ️  Service Line extracted: 'HHA, Hospice'
[13:45:34] [DOC: 9311060] ℹ️  Payer Source extracted: 'Medicare'
[13:45:34] [DOC: 9311060] ℹ️  Diagnosis codes being written:
[13:45:34] [DOC: 9311060] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:45:34] [DOC: 9311060] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:45:34] [DOC: 9311060] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:45:34] [DOC: 9311060] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:45:34] [DOC: 9311060] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:45:34] [DOC: 9311060] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:45:34] [DOC: 9311060] ✅ Patient data written to CSV: Patricia Foster | Sex: FEMALE | Age: 93 | Service: HHA, Hospice | Payer: Medicare | MRN: 5782009
[13:45:34] ✅    ✅ Document 9311060 processed and saved successfully
[13:45:34] 🔄 
🔄 Step 8: Saving API details...
[13:45:34] [DOC: 9311060] ℹ️  API push details saved for document 9311060
[13:45:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9311191                         ║
================================================================================
[13:45:34] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:45:34] ℹ️  Date: 05/27/2025
[13:45:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:45:35] [DOC: 9311191] ✅ Text extracted using pdfplumber (998 chars)
[13:45:35] ✅    ✅ Text extracted using pdfplumber (998 chars)
[13:45:35] 🔄 
🔄 Step 2: Extracting patient data...
[13:45:38] ℹ️  AI extracted raw sex value: 'M'
[13:45:38] ℹ️  AI extracted service line: 'Physical Therapy'
[13:45:38] ℹ️  AI extracted payer source: ''
[13:45:38] ℹ️  AI extracted diagnoses:
[13:45:38] ℹ️    - Diagnosis 1: ''
[13:45:38] ℹ️    - Diagnosis 2: ''
[13:45:38] ℹ️    - Diagnosis 3: ''
[13:45:38] ℹ️    - Diagnosis 4: ''
[13:45:38] ℹ️    - Diagnosis 5: ''
[13:45:38] ℹ️    - Diagnosis 6: ''
[13:45:38] ℹ️  Final extracted MRN: '2135258'
[13:45:38] ℹ️  Final extracted Sex: 'MALE'
[13:45:38] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:45:38] ℹ️  Final extracted Payer Source: ''
[13:45:38] ✅ Patient data extraction completed successfully
[13:45:38] ✅    ✅ Patient data extracted successfully
[13:45:38] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: Soares
     └─ dob: 06/30/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 2135258
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:45:38] ✅    ✅ Patient identified: Richard Soares
[13:45:38] ✅    ✅ Patient name validation passed
[13:45:38] 🔄 
🔄 Step 3: Processing patient dates...
[13:45:38] [DOC: 9311191] ℹ️  DOB normalized: 06/30/1940
[13:45:38] [DOC: 9311191] ℹ️  Episode startOfEpisode normalized: 05/16/2025
[13:45:38] [DOC: 9311191] ℹ️  Episode endOfEpisode normalized: 07/14/2025
[13:45:38] [DOC: 9311191] ✅ Patient date processing completed successfully
[13:45:38] ✅    ✅ Date processing completed
[13:45:38] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: Soares
     └─ dob: 06/30/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 2135258
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:45:38] 🔄 
🔄 Step 4: Extracting order data...
[13:45:40] ℹ️  Order extraction - MRN: '2135258'
[13:45:40] ℹ️  Order extraction - Sex: 'MALE'
[13:45:40] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[13:45:40] ℹ️  Order extraction - Payer Source: ''
[13:45:40] ✅ Order data extraction completed successfully
[13:45:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:45:40] ℹ️  Using MRN from patient data: '2135258' over '2135258'
[13:45:40] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[13:45:40] ✅ Patient name cross-validation successful
[13:45:40] ✅    ✅ Data merged successfully
[13:45:41] ✅    ✅ Order data extracted and validated
[13:45:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:45:48] [DOC: 9311191] ✅ Patient exists in API: Richard Soares, ID: 2528038a-90b2-493e-a853-d3a08ed22a94
[13:45:48] ✅    ✅ Existing patient found with ID: 2528038a-90b2-493e-a853-d3a08ed22a94
[13:45:48] 🔄 
🔄 Step 6: Pushing order to API...
[13:45:48] [DOC: 9311191] ℹ️  Pushing order via API for patient ID: 2528038a-90b2-493e-a853-d3a08ed22a94
[13:45:49] [DOC: 9311191] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16591"}
[13:45:49] ❌    ❌ Failed to push order
[13:45:49] 🔄 
🔄 Step 7: Writing to CSV...
[13:45:49] [DOC: 9311191] ℹ️  Calculated age: 84 from DOB: 06/30/1940
[13:45:49] [DOC: 9311191] ℹ️  Service Line extracted: 'Physical Therapy'
[13:45:49] [DOC: 9311191] ℹ️  Payer Source extracted: ''
[13:45:49] [DOC: 9311191] ℹ️  Diagnosis codes being written:
[13:45:49] [DOC: 9311191] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:45:49] [DOC: 9311191] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:45:49] [DOC: 9311191] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:45:49] [DOC: 9311191] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:45:49] [DOC: 9311191] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:45:49] [DOC: 9311191] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:45:49] [DOC: 9311191] ✅ Patient data written to CSV: Richard Soares | Sex: MALE | Age: 84 | Service: Physical Therapy | Payer:  | MRN: 2135258
[13:45:49] ✅    ✅ Document 9311191 processed and saved successfully
[13:45:49] 🔄 
🔄 Step 8: Saving API details...
[13:45:49] [DOC: 9311191] ℹ️  API push details saved for document 9311191
[13:45:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9310981                         ║
================================================================================
[13:45:49] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[13:45:49] ℹ️  Date: 05/26/2025
[13:45:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:45:52] [DOC: 9310981] ✅ Text extracted using pdfplumber (24155 chars)
[13:45:52] ✅    ✅ Text extracted using pdfplumber (24155 chars)
[13:45:52] 🔄 
🔄 Step 2: Extracting patient data...
[13:45:55] ℹ️  AI extracted raw sex value: 'M'
[13:45:55] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:45:55] ℹ️  AI extracted payer source: 'Medicare'
[13:45:55] ℹ️  AI extracted diagnoses:
[13:45:55] ℹ️    - Diagnosis 1: 'Z47.89'
[13:45:55] ℹ️    - Diagnosis 2: 'M47.27'
[13:45:55] ℹ️    - Diagnosis 3: 'M47.26'
[13:45:55] ℹ️    - Diagnosis 4: 'E55.9'
[13:45:55] ℹ️    - Diagnosis 5: 'E66.9'
[13:45:55] ℹ️    - Diagnosis 6: 'Z68.30'
[13:45:55] ℹ️  Final extracted MRN: '28700215174001'
[13:45:55] ℹ️  Final extracted Sex: 'MALE'
[13:45:55] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:45:55] ℹ️  Final extracted Payer Source: 'Medicare'
[13:45:55] ✅ Patient data extraction completed successfully
[13:45:55] ✅    ✅ Patient data extracted successfully
[13:45:55] 📊 Patient Response
     └─ patientFName: JOHN
     └─ patientLName: CARVALHO
     └─ dob: 05/12/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700215174001
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 83 LAUREN DR
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02745-
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/13/2025', 'startOfEpisode': '05/13/2025', 'endOfEpisode': '07/11/2025', 'firstDiagnosis': 'Z47.89', 'secondDiagnosis': 'M47.27', 'thirdDiagnosis': 'M47.26', 'fourthDiagnosis': 'E55.9', 'fifthDiagnosis': 'E66.9', 'sixthDiagnosis': 'Z68.30'}]
[13:45:55] ✅    ✅ Patient identified: JOHN CARVALHO
[13:45:55] ✅    ✅ Patient name validation passed
[13:45:55] 🔄 
🔄 Step 3: Processing patient dates...
[13:45:55] [DOC: 9310981] ℹ️  DOB normalized: 05/12/1964
[13:45:55] [DOC: 9310981] ℹ️  Episode startOfCare normalized: 05/13/2025
[13:45:55] [DOC: 9310981] ℹ️  Episode startOfEpisode normalized: 05/13/2025
[13:45:55] [DOC: 9310981] ℹ️  Episode endOfEpisode normalized: 07/11/2025
[13:45:55] [DOC: 9310981] ✅ Patient date processing completed successfully
[13:45:55] ✅    ✅ Date processing completed
[13:45:55] 📊 Processed Patient Data
     └─ patientFName: JOHN
     └─ patientLName: CARVALHO
     └─ dob: 05/12/1964
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700215174001
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 83 LAUREN DR
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02745-
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/13/2025', 'startOfEpisode': '05/13/2025', 'endOfEpisode': '07/11/2025', 'firstDiagnosis': 'Z47.89', 'secondDiagnosis': 'M47.27', 'thirdDiagnosis': 'M47.26', 'fourthDiagnosis': 'E55.9', 'fifthDiagnosis': 'E66.9', 'sixthDiagnosis': 'Z68.30'}]
[13:45:55] 🔄 
🔄 Step 4: Extracting order data...
[13:45:58] ℹ️  Order extraction - MRN: '28700215174001'
[13:45:58] ℹ️  Order extraction - Sex: 'MALE'
[13:45:58] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:45:58] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:45:58] ✅ Order data extraction completed successfully
[13:45:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:45:58] ℹ️  Using MRN from patient data: '28700215174001' over '28700215174001'
[13:45:58] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:45:58] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:45:58] ✅ Patient name cross-validation successful
[13:45:58] ✅    ✅ Data merged successfully
[13:45:59] ✅    ✅ Order data extracted and validated
[13:45:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:46:06] [DOC: 9310981] ℹ️  Patient not found in cache or API: JOHN CARVALHO
[13:46:06] [DOC: 9310981] ℹ️  Patient not found, creating new patient via API...
[13:46:06] [DOC: 9310981] ℹ️  Creating patient via API: JOHN CARVALHO
[13:46:07] [DOC: 9310981] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:46:07] ❌    ❌ Failed to create patient
[13:46:07] [DOC: 9310981] ℹ️  API push details saved for document 9310981
================================================================================
║                        Processing Document ID: 9310950                         ║
================================================================================
[13:46:07] ℹ️  Agency: Bayada Home Health Care Inc-Providence
[13:46:07] ℹ️  Date: 05/26/2025
[13:46:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:46:10] [DOC: 9310950] ✅ Text extracted using pdfplumber (1265 chars)
[13:46:10] ✅    ✅ Text extracted using pdfplumber (1253 chars)
[13:46:10] 🔄 
🔄 Step 2: Extracting patient data...
[13:46:12] ℹ️  AI extracted raw sex value: ''
[13:46:12] ℹ️  AI extracted service line: 'MSW'
[13:46:12] ℹ️  AI extracted payer source: 'Medicare'
[13:46:12] ℹ️  AI extracted diagnoses:
[13:46:12] ℹ️    - Diagnosis 1: 'I26.93'
[13:46:12] ℹ️    - Diagnosis 2: 'None'
[13:46:12] ℹ️    - Diagnosis 3: 'None'
[13:46:12] ℹ️    - Diagnosis 4: 'None'
[13:46:12] ℹ️    - Diagnosis 5: 'None'
[13:46:12] ℹ️    - Diagnosis 6: 'None'
[13:46:12] ℹ️  Final extracted MRN: '04400034480901'
[13:46:12] ℹ️  Final extracted Sex: ''
[13:46:12] ℹ️  Final extracted Service Line: 'MSW'
[13:46:12] ℹ️  Final extracted Payer Source: 'Medicare'
[13:46:12] ✅ Patient data extraction completed successfully
[13:46:12] ✅    ✅ Patient data extracted successfully
[13:46:12] 📊 Patient Response
     └─ patientFName: DONNA
     └─ patientLName: MEDEIROS
     └─ dob: 05/13/1967
     └─ patientSex: 
     └─ medicalRecordNo: 04400034480901
     └─ billingProvider: NICHOLAS DEFUSCO, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUNCE CORNER RD
     └─ city: TIVERTON
     └─ state: RI
     └─ zip: 02878
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': 'I26.93', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:46:12] ✅    ✅ Patient identified: DONNA MEDEIROS
[13:46:12] ✅    ✅ Patient name validation passed
[13:46:12] 🔄 
🔄 Step 3: Processing patient dates...
[13:46:12] [DOC: 9310950] ℹ️  DOB normalized: 05/13/1967
[13:46:12] [DOC: 9310950] ✅ Patient date processing completed successfully
[13:46:12] ✅    ✅ Date processing completed
[13:46:12] 📊 Processed Patient Data
     └─ patientFName: DONNA
     └─ patientLName: MEDEIROS
     └─ dob: 05/13/1967
     └─ patientSex: 
     └─ medicalRecordNo: 04400034480901
     └─ billingProvider: NICHOLAS DEFUSCO, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 531 FAUNCE CORNER RD
     └─ city: TIVERTON
     └─ state: RI
     └─ zip: 02878
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'firstDiagnosis': 'I26.93'}]
[13:46:12] 🔄 
🔄 Step 4: Extracting order data...
[13:46:15] ℹ️  Order extraction - MRN: '04400034480901'
[13:46:15] ℹ️  Order extraction - Sex: 'FEMALE'
[13:46:15] ℹ️  Order extraction - Service Line: 'MSW'
[13:46:15] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:46:15] ✅ Order data extraction completed successfully
[13:46:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:46:15] ℹ️  Using MRN from patient data: '04400034480901' over '04400034480901'
[13:46:15] ℹ️  Service line consistent in both sources: 'MSW'
[13:46:15] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:46:15] ✅ Patient name cross-validation successful
[13:46:15] ✅    ✅ Data merged successfully
[13:46:16] ✅    ✅ Order data extracted and validated
[13:46:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:46:35] [DOC: 9310950] ✅ Patient exists in API: DONNA MEDEIROS, ID: 1a293cc9-60c5-42d8-ab0c-43aa83d836e9
[13:46:35] ✅    ✅ Existing patient found with ID: 1a293cc9-60c5-42d8-ab0c-43aa83d836e9
[13:46:35] 🔄 
🔄 Step 6: Pushing order to API...
[13:46:35] [DOC: 9310950] ℹ️  Pushing order via API for patient ID: 1a293cc9-60c5-42d8-ab0c-43aa83d836e9
[13:46:36] [DOC: 9310950] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16552"}
[13:46:36] ❌    ❌ Failed to push order
[13:46:36] 🔄 
🔄 Step 7: Writing to CSV...
[13:46:36] [DOC: 9310950] ℹ️  Calculated age: 58 from DOB: 05/13/1967
[13:46:36] [DOC: 9310950] ℹ️  Service Line extracted: 'MSW'
[13:46:36] [DOC: 9310950] ℹ️  Payer Source extracted: 'Medicare'
[13:46:36] [DOC: 9310950] ℹ️  Diagnosis codes being written:
[13:46:36] [DOC: 9310950] ℹ️    - Latest_Episode_Firstdiagnosis: 'I26.93'
[13:46:36] [DOC: 9310950] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:46:36] [DOC: 9310950] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:46:36] [DOC: 9310950] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:46:36] [DOC: 9310950] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:46:36] [DOC: 9310950] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:46:36] [DOC: 9310950] ✅ Patient data written to CSV: DONNA MEDEIROS | Sex: FEMALE | Age: 58 | Service: MSW | Payer: Medicare | MRN: 04400034480901
[13:46:36] ✅    ✅ Document 9310950 processed and saved successfully
[13:46:36] 🔄 
🔄 Step 8: Saving API details...
[13:46:36] [DOC: 9310950] ℹ️  API push details saved for document 9310950
[13:46:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9310885                         ║
================================================================================
[13:46:36] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[13:46:36] ℹ️  Date: 05/26/2025
[13:46:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:46:38] [DOC: 9310885] ✅ Text extracted using pdfplumber (1160 chars)
[13:46:38] ✅    ✅ Text extracted using pdfplumber (1148 chars)
[13:46:38] 🔄 
🔄 Step 2: Extracting patient data...
[13:46:41] ℹ️  AI extracted raw sex value: ''
[13:46:41] ℹ️  AI extracted service line: 'PT'
[13:46:41] ℹ️  AI extracted payer source: 'Medicare'
[13:46:41] ℹ️  AI extracted diagnoses:
[13:46:41] ℹ️    - Diagnosis 1: ''
[13:46:41] ℹ️    - Diagnosis 2: ''
[13:46:41] ℹ️    - Diagnosis 3: ''
[13:46:41] ℹ️    - Diagnosis 4: ''
[13:46:41] ℹ️    - Diagnosis 5: ''
[13:46:41] ℹ️    - Diagnosis 6: ''
[13:46:41] ℹ️  Final extracted MRN: '28700154820301'
[13:46:41] ℹ️  Final extracted Sex: ''
[13:46:41] ℹ️  Final extracted Service Line: 'PT'
[13:46:41] ℹ️  Final extracted Payer Source: 'Medicare'
[13:46:41] ✅ Patient data extraction completed successfully
[13:46:41] ✅    ✅ Patient data extracted successfully
[13:46:41] 📊 Patient Response
     └─ patientFName: BERNICE
     └─ patientLName: LAWSON
     └─ dob: 03/16/1942
     └─ patientSex: 
     └─ medicalRecordNo: 28700154820301
     └─ billingProvider: ROBERT CALDAS, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 7 CHRISTIAN ST
     └─ city: FAIRHAVEN
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/25/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:46:41] ✅    ✅ Patient identified: BERNICE LAWSON
[13:46:41] ✅    ✅ Patient name validation passed
[13:46:41] 🔄 
🔄 Step 3: Processing patient dates...
[13:46:41] [DOC: 9310885] ℹ️  DOB normalized: 03/16/1942
[13:46:41] [DOC: 9310885] ℹ️  Episode startOfEpisode normalized: 05/25/2025
[13:46:41] [DOC: 9310885] ✅ Patient date processing completed successfully
[13:46:41] ✅    ✅ Date processing completed
[13:46:41] 📊 Processed Patient Data
     └─ patientFName: BERNICE
     └─ patientLName: LAWSON
     └─ dob: 03/16/1942
     └─ patientSex: 
     └─ medicalRecordNo: 28700154820301
     └─ billingProvider: ROBERT CALDAS, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 7 CHRISTIAN ST
     └─ city: FAIRHAVEN
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/25/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:46:41] 🔄 
🔄 Step 4: Extracting order data...
[13:46:43] ℹ️  Order extraction - MRN: '28700154820301'
[13:46:43] ℹ️  Order extraction - Sex: ''
[13:46:43] ℹ️  Order extraction - Service Line: 'PT'
[13:46:43] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:46:43] ✅ Order data extraction completed successfully
[13:46:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:46:43] ℹ️  Using MRN from patient data: '28700154820301' over '28700154820301'
[13:46:43] ⚠️  Could not determine sex using any available method
[13:46:43] ℹ️  Service line consistent in both sources: 'PT'
[13:46:43] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:46:43] ✅ Patient name cross-validation successful
[13:46:43] ✅    ✅ Data merged successfully
[13:46:45] ✅    ✅ Order data extracted and validated
[13:46:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:46:53] [DOC: 9310885] ✅ Patient exists in API: BERNICE LAWSON, ID: d5754150-ca23-4c39-9506-3db815875026
[13:46:53] ✅    ✅ Existing patient found with ID: d5754150-ca23-4c39-9506-3db815875026
[13:46:53] 🔄 
🔄 Step 6: Pushing order to API...
[13:46:53] [DOC: 9310885] ℹ️  Pushing order via API for patient ID: d5754150-ca23-4c39-9506-3db815875026
[13:46:54] [DOC: 9310885] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16504"}
[13:46:54] ❌    ❌ Failed to push order
[13:46:54] 🔄 
🔄 Step 7: Writing to CSV...
[13:46:54] [DOC: 9310885] ℹ️  Calculated age: 83 from DOB: 03/16/1942
[13:46:54] [DOC: 9310885] ℹ️  Service Line extracted: 'PT'
[13:46:54] [DOC: 9310885] ℹ️  Payer Source extracted: 'Medicare'
[13:46:54] [DOC: 9310885] ℹ️  Diagnosis codes being written:
[13:46:54] [DOC: 9310885] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:46:54] [DOC: 9310885] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:46:54] [DOC: 9310885] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:46:54] [DOC: 9310885] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:46:54] [DOC: 9310885] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:46:54] [DOC: 9310885] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:46:54] [DOC: 9310885] ✅ Patient data written to CSV: BERNICE LAWSON | Sex:  | Age: 83 | Service: PT | Payer: Medicare | MRN: 28700154820301
[13:46:54] ✅    ✅ Document 9310885 processed and saved successfully
[13:46:54] 🔄 
🔄 Step 8: Saving API details...
[13:46:54] [DOC: 9310885] ℹ️  API push details saved for document 9310885
[13:46:54] ✅    ✅ API details saved
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[13:46:54] ℹ️  Total Processed: 49
[13:46:54] ℹ️  CSV Success: 31
[13:46:54] ℹ️  CSV Errors: 10
[13:46:54] ℹ️  API Success: 0
[13:46:54] ℹ️  API Errors: 39
[13:46:54] ℹ️  CSV Success Rate: 63.3%
[13:46:54] ℹ️  API Success Rate: 0.0%
[13:46:54] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250607_133324.csv
[13:46:54] ℹ️  API Details File: api_outputs/api_push_details_20250607_133324.csv
================================================================================
║          ============================================================          ║
================================================================================
