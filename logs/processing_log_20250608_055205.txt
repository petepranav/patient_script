================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[05:52:05] ℹ️  CSV Data Extraction & API Push Tool
[05:52:05] ℹ️  
[05:52:05] ℹ️  Features:
[05:52:05] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[05:52:05] ℹ️  - AI-powered patient and order data extraction
[05:52:05] ℹ️  - Enhanced error handling and logging
[05:52:05] ℹ️  - Full API integration (patient creation + order pushing)
[05:52:05] ℹ️  - CSV output with comprehensive patient data
[05:52:05] ℹ️  - Detailed API tracking with remarks for every document
[05:52:05] ℹ️  - Complete audit trail of all processing attempts
[05:52:05] ℹ️  
[05:52:05] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[05:52:05] ✅ Created output CSV file: csv_outputs/extracted_patients_20250608_055205.csv
[05:52:05] ✅ Created API details CSV file: api_outputs/api_push_details_20250608_055205.csv
================================================================================
║                        Processing Document ID: 2170190                         ║
================================================================================
[05:52:05] ℹ️  Agency: Visiting Rehab & Nursing Services
[05:52:05] ℹ️  Date: 04/15/2025
[05:52:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:52:27] [DOC: 2170190] ❌ Critical failure in get_pdf_text: Invalid response format
[05:52:27] ❌ Failed to extract text for Doc ID 2170190
[05:52:27] [DOC: 2170190] ℹ️  API push details saved for document 2170190
================================================================================
║                        Processing Document ID: 9242202                         ║
================================================================================
[05:52:27] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:52:27] ℹ️  Date: 04/15/2025
[05:52:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:52:32] [DOC: 9242202] ✅ Text extracted using pdfplumber (8776 chars)
[05:52:32] ✅    ✅ Text extracted using pdfplumber (8776 chars)
[05:52:32] 🔄 
🔄 Step 2: Extracting patient data...
[05:52:35] ℹ️  AI extracted raw sex value: ''
[05:52:35] ℹ️  AI extracted service line: 'ST'
[05:52:35] ℹ️  AI extracted payer source: ''
[05:52:35] ℹ️  AI extracted diagnoses:
[05:52:35] ℹ️    - Diagnosis 1: 'FLU'
[05:52:35] ℹ️    - Diagnosis 2: 'aspiration'
[05:52:35] ℹ️    - Diagnosis 3: ''
[05:52:35] ℹ️    - Diagnosis 4: ''
[05:52:35] ℹ️    - Diagnosis 5: ''
[05:52:35] ℹ️    - Diagnosis 6: ''
[05:52:35] ℹ️  Final extracted MRN: 'MA210907053505'
[05:52:35] ℹ️  Final extracted Sex: ''
[05:52:35] ℹ️  Final extracted Service Line: 'ST'
[05:52:35] ℹ️  Final extracted Payer Source: ''
[05:52:35] ✅ Patient data extraction completed successfully
[05:52:35] ✅    ✅ Patient data extracted successfully
[05:52:35] 📊 Patient Response
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: Dr. Maskey, Sachin
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'FLU', 'secondDiagnosis': 'aspiration', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:52:35] ✅    ✅ Patient identified: Rolande Morrell
[05:52:35] ✅    ✅ Patient name validation passed
[05:52:35] 🔄 
🔄 Step 3: Processing patient dates...
[05:52:35] [DOC: 9242202] ℹ️  DOB normalized: 05/15/1935
[05:52:35] [DOC: 9242202] ✅ Patient date processing completed successfully
[05:52:35] ✅    ✅ Date processing completed
[05:52:35] 📊 Processed Patient Data
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: Dr. Maskey, Sachin
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'FLU', 'secondDiagnosis': 'aspiration', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:52:35] 🔄 
🔄 Step 4: Extracting order data...
[05:52:38] ℹ️  Order extraction - MRN: 'MA210907053505'
[05:52:38] ℹ️  Order extraction - Sex: ''
[05:52:38] ℹ️  Order extraction - Service Line: 'ST'
[05:52:38] ℹ️  Order extraction - Payer Source: ''
[05:52:38] ✅ Order data extraction completed successfully
[05:52:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:52:38] ℹ️  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[05:52:38] ⚠️  Could not determine sex using any available method
[05:52:38] ℹ️  Service line consistent in both sources: 'ST'
[05:52:38] ✅ Patient name cross-validation successful
[05:52:38] ✅    ✅ Data merged successfully
[05:52:39] ✅    ✅ Order data extracted and validated
[05:52:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:52:39] [DOC: 9242202] ✅ Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[05:52:39] ✅    ✅ Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[05:52:39] 🔄 
🔄 Step 6: Pushing order to API...
[05:52:39] [DOC: 9242202] ℹ️  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[05:52:40] [DOC: 9242202] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:52:40] ❌    ❌ Failed to push order
[05:52:40] 🔄 
🔄 Step 7: Writing to CSV...
[05:52:40] [DOC: 9242202] ℹ️  Calculated age: 90 from DOB: 05/15/1935
[05:52:40] [DOC: 9242202] ℹ️  Service Line extracted: 'ST'
[05:52:40] [DOC: 9242202] ℹ️  Payer Source extracted: ''
[05:52:40] [DOC: 9242202] ℹ️  Diagnosis codes being written:
[05:52:40] [DOC: 9242202] ℹ️    - Latest_Episode_Firstdiagnosis: 'FLU'
[05:52:40] [DOC: 9242202] ℹ️    - Latest_Episode_Seconddiagnosis: 'aspiration'
[05:52:40] [DOC: 9242202] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:52:40] [DOC: 9242202] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:52:40] [DOC: 9242202] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:52:40] [DOC: 9242202] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:52:40] [DOC: 9242202] ✅ Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: ST | Payer:  | MRN: MA210907053505
[05:52:40] ✅    ✅ Document 9242202 processed and saved successfully
[05:52:40] 🔄 
🔄 Step 8: Saving API details...
[05:52:40] [DOC: 9242202] ℹ️  API push details saved for document 9242202
[05:52:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242197                         ║
================================================================================
[05:52:40] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:52:40] ℹ️  Date: 04/15/2025
[05:52:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:52:44] [DOC: 9242197] ✅ Text extracted using pdfplumber (16809 chars)
[05:52:44] ✅    ✅ Text extracted using pdfplumber (16809 chars)
[05:52:44] 🔄 
🔄 Step 2: Extracting patient data...
[05:52:47] ℹ️  AI extracted raw sex value: 'F'
[05:52:47] ℹ️  AI extracted service line: 'PT'
[05:52:47] ℹ️  AI extracted payer source: ''
[05:52:47] ℹ️  AI extracted diagnoses:
[05:52:47] ℹ️    - Diagnosis 1: 'Influenza Exacerbation'
[05:52:47] ℹ️    - Diagnosis 2: 'Diabetes'
[05:52:47] ℹ️    - Diagnosis 3: ''
[05:52:47] ℹ️    - Diagnosis 4: ''
[05:52:47] ℹ️    - Diagnosis 5: ''
[05:52:47] ℹ️    - Diagnosis 6: ''
[05:52:47] ℹ️  Final extracted MRN: 'MA210907053505'
[05:52:47] ℹ️  Final extracted Sex: 'FEMALE'
[05:52:47] ℹ️  Final extracted Service Line: 'PT'
[05:52:47] ℹ️  Final extracted Payer Source: ''
[05:52:47] ✅ Patient data extraction completed successfully
[05:52:47] ✅    ✅ Patient data extracted successfully
[05:52:47] 📊 Patient Response
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: Dr. Maskey, Sachin
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/12/25', 'firstDiagnosis': 'Influenza Exacerbation', 'secondDiagnosis': 'Diabetes', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:52:47] ✅    ✅ Patient identified: Rolande Morrell
[05:52:47] ✅    ✅ Patient name validation passed
[05:52:47] 🔄 
🔄 Step 3: Processing patient dates...
[05:52:47] [DOC: 9242197] ℹ️  DOB normalized: 05/15/1935
[05:52:47] [DOC: 9242197] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[05:52:47] [DOC: 9242197] ⚠️  Invalid endOfEpisode format: 05/12/25
[05:52:47] [DOC: 9242197] ✅ Patient date processing completed successfully
[05:52:47] ✅    ✅ Date processing completed
[05:52:47] 📊 Processed Patient Data
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: Dr. Maskey, Sachin
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/12/25', 'firstDiagnosis': 'Influenza Exacerbation', 'secondDiagnosis': 'Diabetes', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:52:47] 🔄 
🔄 Step 4: Extracting order data...
[05:52:50] ℹ️  Order extraction - MRN: 'MA210907053505'
[05:52:50] ℹ️  Order extraction - Sex: 'FEMALE'
[05:52:50] ℹ️  Order extraction - Service Line: 'PT'
[05:52:50] ℹ️  Order extraction - Payer Source: ''
[05:52:50] ✅ Order data extraction completed successfully
[05:52:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:52:50] ℹ️  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[05:52:50] ℹ️  Service line consistent in both sources: 'PT'
[05:52:50] ✅ Patient name cross-validation successful
[05:52:50] ✅    ✅ Data merged successfully
[05:52:52] ✅    ✅ Order data extracted and validated
[05:52:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:52:52] [DOC: 9242197] ✅ Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[05:52:52] ✅    ✅ Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[05:52:52] 🔄 
🔄 Step 6: Pushing order to API...
[05:52:52] [DOC: 9242197] ℹ️  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[05:52:53] [DOC: 9242197] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:52:53] ❌    ❌ Failed to push order
[05:52:53] 🔄 
🔄 Step 7: Writing to CSV...
[05:52:53] [DOC: 9242197] ℹ️  Calculated age: 90 from DOB: 05/15/1935
[05:52:53] [DOC: 9242197] ℹ️  Service Line extracted: 'PT'
[05:52:53] [DOC: 9242197] ℹ️  Payer Source extracted: ''
[05:52:53] [DOC: 9242197] ℹ️  Diagnosis codes being written:
[05:52:53] [DOC: 9242197] ℹ️    - Latest_Episode_Firstdiagnosis: 'Influenza Exacerbation'
[05:52:53] [DOC: 9242197] ℹ️    - Latest_Episode_Seconddiagnosis: 'Diabetes'
[05:52:53] [DOC: 9242197] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:52:53] [DOC: 9242197] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:52:53] [DOC: 9242197] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:52:53] [DOC: 9242197] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:52:53] [DOC: 9242197] ✅ Patient data written to CSV: Rolande Morrell | Sex: FEMALE | Age: 90 | Service: PT | Payer:  | MRN: MA210907053505
[05:52:53] ✅    ✅ Document 9242197 processed and saved successfully
[05:52:53] 🔄 
🔄 Step 8: Saving API details...
[05:52:53] [DOC: 9242197] ℹ️  API push details saved for document 9242197
[05:52:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242192                         ║
================================================================================
[05:52:53] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:52:53] ℹ️  Date: 04/15/2025
[05:52:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:52:57] [DOC: 9242192] ✅ Text extracted using pdfplumber (19519 chars)
[05:52:57] ✅    ✅ Text extracted using pdfplumber (19519 chars)
[05:52:57] 🔄 
🔄 Step 2: Extracting patient data...
[05:53:00] ℹ️  AI extracted raw sex value: 'F'
[05:53:00] ℹ️  AI extracted service line: 'PT'
[05:53:00] ℹ️  AI extracted payer source: ''
[05:53:00] ℹ️  AI extracted diagnoses:
[05:53:00] ℹ️    - Diagnosis 1: 'J44.1'
[05:53:00] ℹ️    - Diagnosis 2: 'I25.10'
[05:53:00] ℹ️    - Diagnosis 3: 'E66.9'
[05:53:00] ℹ️    - Diagnosis 4: 'G47.33'
[05:53:00] ℹ️    - Diagnosis 5: 'I11.0'
[05:53:00] ℹ️    - Diagnosis 6: 'I50.9'
[05:53:00] ℹ️  Final extracted MRN: 'MA250130025704'
[05:53:00] ℹ️  Final extracted Sex: 'FEMALE'
[05:53:00] ℹ️  Final extracted Service Line: 'PT'
[05:53:00] ℹ️  Final extracted Payer Source: ''
[05:53:00] ✅ Patient data extraction completed successfully
[05:53:00] ✅    ✅ Patient data extracted successfully
[05:53:00] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: Dr. Maskey, Sachin
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'E66.9', 'fourthDiagnosis': 'G47.33', 'fifthDiagnosis': 'I11.0', 'sixthDiagnosis': 'I50.9'}]
[05:53:00] ✅    ✅ Patient identified: Theresa Racine
[05:53:00] ✅    ✅ Patient name validation passed
[05:53:00] 🔄 
🔄 Step 3: Processing patient dates...
[05:53:00] [DOC: 9242192] ℹ️  DOB normalized: 02/10/1957
[05:53:00] [DOC: 9242192] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[05:53:00] [DOC: 9242192] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[05:53:00] [DOC: 9242192] ✅ Patient date processing completed successfully
[05:53:00] ✅    ✅ Date processing completed
[05:53:00] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: Dr. Maskey, Sachin
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'E66.9', 'fourthDiagnosis': 'G47.33', 'fifthDiagnosis': 'I11.0', 'sixthDiagnosis': 'I50.9'}]
[05:53:00] 🔄 
🔄 Step 4: Extracting order data...
[05:53:03] ℹ️  Order extraction - MRN: 'MA250130025704'
[05:53:03] ℹ️  Order extraction - Sex: 'FEMALE'
[05:53:03] ℹ️  Order extraction - Service Line: 'PT'
[05:53:03] ℹ️  Order extraction - Payer Source: ''
[05:53:03] ✅ Order data extraction completed successfully
[05:53:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:53:03] ℹ️  Using MRN from patient data: 'MA250130025704' over 'MA250130025704'
[05:53:03] ℹ️  Service line consistent in both sources: 'PT'
[05:53:03] ✅ Patient name cross-validation successful
[05:53:03] ✅    ✅ Data merged successfully
[05:53:07] ✅    ✅ Order data extracted and validated
[05:53:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:53:07] [DOC: 9242192] ✅ Patient found in local cache: Theresa Racine, ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[05:53:07] ✅    ✅ Existing patient found with ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[05:53:07] 🔄 
🔄 Step 6: Pushing order to API...
[05:53:07] [DOC: 9242192] ℹ️  Pushing order via API for patient ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[05:53:08] [DOC: 9242192] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:53:08] ❌    ❌ Failed to push order
[05:53:08] 🔄 
🔄 Step 7: Writing to CSV...
[05:53:08] [DOC: 9242192] ℹ️  Calculated age: 68 from DOB: 02/10/1957
[05:53:08] [DOC: 9242192] ℹ️  Service Line extracted: 'PT'
[05:53:08] [DOC: 9242192] ℹ️  Payer Source extracted: ''
[05:53:08] [DOC: 9242192] ℹ️  Diagnosis codes being written:
[05:53:08] [DOC: 9242192] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[05:53:08] [DOC: 9242192] ℹ️    - Latest_Episode_Seconddiagnosis: 'I25.10'
[05:53:08] [DOC: 9242192] ℹ️    - Latest_Episode_Thirddiagnosis: 'E66.9'
[05:53:08] [DOC: 9242192] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G47.33'
[05:53:08] [DOC: 9242192] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I11.0'
[05:53:08] [DOC: 9242192] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I50.9'
[05:53:08] [DOC: 9242192] ✅ Patient data written to CSV: Theresa Racine | Sex: FEMALE | Age: 68 | Service: PT | Payer:  | MRN: MA250130025704
[05:53:08] ✅    ✅ Document 9242192 processed and saved successfully
[05:53:08] 🔄 
🔄 Step 8: Saving API details...
[05:53:08] [DOC: 9242192] ℹ️  API push details saved for document 9242192
[05:53:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242190                         ║
================================================================================
[05:53:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:53:08] ℹ️  Date: 04/15/2025
[05:53:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:53:11] [DOC: 9242190] ✅ Text extracted using pdfplumber (13789 chars)
[05:53:11] ✅    ✅ Text extracted using pdfplumber (13789 chars)
[05:53:11] 🔄 
🔄 Step 2: Extracting patient data...
[05:53:14] ℹ️  AI extracted raw sex value: 'F'
[05:53:14] ℹ️  AI extracted service line: 'OT'
[05:53:14] ℹ️  AI extracted payer source: ''
[05:53:14] ℹ️  AI extracted diagnoses:
[05:53:14] ℹ️    - Diagnosis 1: 'COPD Exacerbation'
[05:53:14] ℹ️    - Diagnosis 2: 'Muscle weakness'
[05:53:14] ℹ️    - Diagnosis 3: ''
[05:53:14] ℹ️    - Diagnosis 4: ''
[05:53:14] ℹ️    - Diagnosis 5: ''
[05:53:14] ℹ️    - Diagnosis 6: ''
[05:53:14] ℹ️  Final extracted MRN: 'MA250130025704'
[05:53:14] ℹ️  Final extracted Sex: 'FEMALE'
[05:53:14] ℹ️  Final extracted Service Line: 'OT'
[05:53:14] ℹ️  Final extracted Payer Source: ''
[05:53:14] ✅ Patient data extraction completed successfully
[05:53:14] ✅    ✅ Patient data extracted successfully
[05:53:14] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: Dr. Maskey, Sachin
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '', 'firstDiagnosis': 'COPD Exacerbation', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:53:14] ✅    ✅ Patient identified: Theresa Racine
[05:53:14] ✅    ✅ Patient name validation passed
[05:53:14] 🔄 
🔄 Step 3: Processing patient dates...
[05:53:14] [DOC: 9242190] ℹ️  DOB normalized: 02/10/1957
[05:53:14] [DOC: 9242190] ℹ️  Episode startOfEpisode normalized: 03/05/2025
[05:53:14] [DOC: 9242190] ✅ Patient date processing completed successfully
[05:53:14] ✅    ✅ Date processing completed
[05:53:14] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: Dr. Maskey, Sachin
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '', 'firstDiagnosis': 'COPD Exacerbation', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:53:14] 🔄 
🔄 Step 4: Extracting order data...
[05:53:17] ℹ️  Order extraction - MRN: 'MA250130025704'
[05:53:17] ℹ️  Order extraction - Sex: 'FEMALE'
[05:53:17] ℹ️  Order extraction - Service Line: 'OT'
[05:53:17] ℹ️  Order extraction - Payer Source: ''
[05:53:17] ✅ Order data extraction completed successfully
[05:53:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:53:17] ℹ️  Using MRN from patient data: 'MA250130025704' over 'MA250130025704'
[05:53:17] ℹ️  Service line consistent in both sources: 'OT'
[05:53:17] ✅ Patient name cross-validation successful
[05:53:17] ✅    ✅ Data merged successfully
[05:53:18] ✅    ✅ Order data extracted and validated
[05:53:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:53:18] [DOC: 9242190] ✅ Patient found in local cache: Theresa Racine, ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[05:53:18] ✅    ✅ Existing patient found with ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[05:53:18] 🔄 
🔄 Step 6: Pushing order to API...
[05:53:18] [DOC: 9242190] ℹ️  Pushing order via API for patient ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[05:53:20] [DOC: 9242190] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:53:20] ❌    ❌ Failed to push order
[05:53:20] 🔄 
🔄 Step 7: Writing to CSV...
[05:53:20] [DOC: 9242190] ℹ️  Calculated age: 68 from DOB: 02/10/1957
[05:53:20] [DOC: 9242190] ℹ️  Service Line extracted: 'OT'
[05:53:20] [DOC: 9242190] ℹ️  Payer Source extracted: ''
[05:53:20] [DOC: 9242190] ℹ️  Diagnosis codes being written:
[05:53:20] [DOC: 9242190] ℹ️    - Latest_Episode_Firstdiagnosis: 'COPD Exacerbation'
[05:53:20] [DOC: 9242190] ℹ️    - Latest_Episode_Seconddiagnosis: 'Muscle weakness'
[05:53:20] [DOC: 9242190] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:53:20] [DOC: 9242190] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:53:20] [DOC: 9242190] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:53:20] [DOC: 9242190] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:53:20] [DOC: 9242190] ✅ Patient data written to CSV: Theresa Racine | Sex: FEMALE | Age: 68 | Service: OT | Payer:  | MRN: MA250130025704
[05:53:20] ✅    ✅ Document 9242190 processed and saved successfully
[05:53:20] 🔄 
🔄 Step 8: Saving API details...
[05:53:20] [DOC: 9242190] ℹ️  API push details saved for document 9242190
[05:53:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242189                         ║
================================================================================
[05:53:20] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:53:20] ℹ️  Date: 04/15/2025
[05:53:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:53:22] [DOC: 9242189] ✅ Text extracted using pdfplumber (11648 chars)
[05:53:22] ✅    ✅ Text extracted using pdfplumber (11648 chars)
[05:53:22] 🔄 
🔄 Step 2: Extracting patient data...
[05:53:25] ℹ️  AI extracted raw sex value: 'F'
[05:53:25] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:53:25] ℹ️  AI extracted payer source: 'Medicare'
[05:53:25] ℹ️  AI extracted diagnoses:
[05:53:25] ℹ️    - Diagnosis 1: 'J44.1'
[05:53:25] ℹ️    - Diagnosis 2: 'J18.9'
[05:53:25] ℹ️    - Diagnosis 3: 'J44.0'
[05:53:25] ℹ️    - Diagnosis 4: 'R19.7'
[05:53:25] ℹ️    - Diagnosis 5: 'J96.21'
[05:53:25] ℹ️    - Diagnosis 6: 'J96.22'
[05:53:25] ℹ️  Final extracted MRN: 'MA250130025704'
[05:53:25] ℹ️  Final extracted Sex: 'FEMALE'
[05:53:25] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:53:25] ℹ️  Final extracted Payer Source: 'Medicare'
[05:53:25] ✅ Patient data extraction completed successfully
[05:53:25] ✅    ✅ Patient data extracted successfully
[05:53:25] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: MASKEY, SACHIN MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 850 Pleasant St, Apt 1015
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (774) 992-2219
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'J44.0', 'fourthDiagnosis': 'R19.7', 'fifthDiagnosis': 'J96.21', 'sixthDiagnosis': 'J96.22'}]
[05:53:25] ✅    ✅ Patient identified: Theresa Racine
[05:53:25] ✅    ✅ Patient name validation passed
[05:53:25] 🔄 
🔄 Step 3: Processing patient dates...
[05:53:25] [DOC: 9242189] ℹ️  DOB normalized: 02/10/1957
[05:53:25] [DOC: 9242189] ℹ️  Episode startOfCare normalized: 02/28/2025
[05:53:25] [DOC: 9242189] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[05:53:25] [DOC: 9242189] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[05:53:25] [DOC: 9242189] ✅ Patient date processing completed successfully
[05:53:25] ✅    ✅ Date processing completed
[05:53:25] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: MASKEY, SACHIN MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 850 Pleasant St, Apt 1015
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (774) 992-2219
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'J18.9', 'thirdDiagnosis': 'J44.0', 'fourthDiagnosis': 'R19.7', 'fifthDiagnosis': 'J96.21', 'sixthDiagnosis': 'J96.22'}]
[05:53:26] 🔄 
🔄 Step 4: Extracting order data...
[05:53:28] ℹ️  Order extraction - MRN: 'MA250130025704'
[05:53:28] ℹ️  Order extraction - Sex: 'FEMALE'
[05:53:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[05:53:28] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:53:28] ✅ Order data extraction completed successfully
[05:53:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:53:28] ℹ️  Using MRN from patient data: 'MA250130025704' over 'MA250130025704'
[05:53:28] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy' + Order='Skilled Nursing, PT, OT' = 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[05:53:28] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:53:28] ✅ Patient name cross-validation successful
[05:53:28] ✅    ✅ Data merged successfully
[05:53:30] ✅    ✅ Order data extracted and validated
[05:53:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:53:30] [DOC: 9242189] ✅ Patient found in local cache: Theresa Racine, ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[05:53:30] ✅    ✅ Existing patient found with ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[05:53:30] 🔄 
🔄 Step 6: Pushing order to API...
[05:53:30] [DOC: 9242189] ℹ️  Pushing order via API for patient ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[05:53:31] [DOC: 9242189] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13124"}
[05:53:31] ❌    ❌ Failed to push order
[05:53:31] 🔄 
🔄 Step 7: Writing to CSV...
[05:53:31] [DOC: 9242189] ℹ️  Calculated age: 68 from DOB: 02/10/1957
[05:53:31] [DOC: 9242189] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[05:53:31] [DOC: 9242189] ℹ️  Payer Source extracted: 'Medicare'
[05:53:31] [DOC: 9242189] ℹ️  Diagnosis codes being written:
[05:53:31] [DOC: 9242189] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[05:53:31] [DOC: 9242189] ℹ️    - Latest_Episode_Seconddiagnosis: 'J18.9'
[05:53:31] [DOC: 9242189] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.0'
[05:53:31] [DOC: 9242189] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R19.7'
[05:53:31] [DOC: 9242189] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J96.21'
[05:53:31] [DOC: 9242189] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J96.22'
[05:53:31] [DOC: 9242189] ✅ Patient data written to CSV: Theresa Racine | Sex: FEMALE | Age: 68 | Service: OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing | Payer: Medicare | MRN: MA250130025704
[05:53:31] ✅    ✅ Document 9242189 processed and saved successfully
[05:53:31] 🔄 
🔄 Step 8: Saving API details...
[05:53:31] [DOC: 9242189] ℹ️  API push details saved for document 9242189
[05:53:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242131                         ║
================================================================================
[05:53:31] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:53:31] ℹ️  Date: 04/15/2025
[05:53:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:53:33] [DOC: 9242131] ✅ Text extracted using pdfplumber (16270 chars)
[05:53:33] ✅    ✅ Text extracted using pdfplumber (16258 chars)
[05:53:33] 🔄 
🔄 Step 2: Extracting patient data...
[05:53:37] ℹ️  AI extracted raw sex value: 'F'
[05:53:37] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:53:37] ℹ️  AI extracted payer source: 'Medicare'
[05:53:37] ℹ️  AI extracted diagnoses:
[05:53:37] ℹ️    - Diagnosis 1: 'I11.0'
[05:53:37] ℹ️    - Diagnosis 2: 'I50.9'
[05:53:37] ℹ️    - Diagnosis 3: 'E11.9'
[05:53:37] ℹ️    - Diagnosis 4: 'G89.29'
[05:53:37] ℹ️    - Diagnosis 5: 'M15.9'
[05:53:37] ℹ️    - Diagnosis 6: 'M81.0'
[05:53:37] ℹ️  Final extracted MRN: 'MA200210084304'
[05:53:37] ℹ️  Final extracted Sex: 'FEMALE'
[05:53:37] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:53:37] ℹ️  Final extracted Payer Source: 'Medicare'
[05:53:37] ✅ Patient data extraction completed successfully
[05:53:37] ✅    ✅ Patient data extracted successfully
[05:53:37] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Lima
     └─ dob: 08/18/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA200210084304
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 82d Sun and Sea Dr
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ email: None
     └─ phoneNumber: (774) 425-4988
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/04/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'G89.29', 'fifthDiagnosis': 'M15.9', 'sixthDiagnosis': 'M81.0'}]
[05:53:37] ✅    ✅ Patient identified: Mary Lima
[05:53:37] ✅    ✅ Patient name validation passed
[05:53:37] 🔄 
🔄 Step 3: Processing patient dates...
[05:53:37] [DOC: 9242131] ℹ️  DOB normalized: 08/18/1943
[05:53:37] [DOC: 9242131] ℹ️  Episode startOfCare normalized: 02/04/2025
[05:53:37] [DOC: 9242131] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[05:53:37] [DOC: 9242131] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[05:53:37] [DOC: 9242131] ✅ Patient date processing completed successfully
[05:53:37] ✅    ✅ Date processing completed
[05:53:37] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Lima
     └─ dob: 08/18/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA200210084304
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 82d Sun and Sea Dr
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ phoneNumber: (774) 425-4988
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/04/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.9', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'G89.29', 'fifthDiagnosis': 'M15.9', 'sixthDiagnosis': 'M81.0'}]
[05:53:37] 🔄 
🔄 Step 4: Extracting order data...
[05:53:40] ℹ️  Order extraction - MRN: 'MA200210084304'
[05:53:40] ℹ️  Order extraction - Sex: 'FEMALE'
[05:53:40] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:53:40] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:53:40] ✅ Order data extraction completed successfully
[05:53:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:53:40] ℹ️  Using MRN from patient data: 'MA200210084304' over 'MA200210084304'
[05:53:40] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:53:40] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:53:40] ✅ Patient name cross-validation successful
[05:53:40] ✅    ✅ Data merged successfully
[05:53:41] ✅    ✅ Order data extracted and validated
[05:53:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:53:41] [DOC: 9242131] ✅ Patient found in local cache: Mary Lima, ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[05:53:41] ✅    ✅ Existing patient found with ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[05:53:41] 🔄 
🔄 Step 6: Pushing order to API...
[05:53:41] [DOC: 9242131] ℹ️  Pushing order via API for patient ID: 631650d0-aee6-433c-b505-88bc6c518a1f
[05:53:42] [DOC: 9242131] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13940"}
[05:53:42] ❌    ❌ Failed to push order
[05:53:42] 🔄 
🔄 Step 7: Writing to CSV...
[05:53:42] [DOC: 9242131] ℹ️  Calculated age: 81 from DOB: 08/18/1943
[05:53:42] [DOC: 9242131] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:53:42] [DOC: 9242131] ℹ️  Payer Source extracted: 'Medicare'
[05:53:42] [DOC: 9242131] ℹ️  Diagnosis codes being written:
[05:53:42] [DOC: 9242131] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[05:53:42] [DOC: 9242131] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.9'
[05:53:42] [DOC: 9242131] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.9'
[05:53:42] [DOC: 9242131] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G89.29'
[05:53:42] [DOC: 9242131] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M15.9'
[05:53:42] [DOC: 9242131] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M81.0'
[05:53:42] [DOC: 9242131] ✅ Patient data written to CSV: Mary Lima | Sex: FEMALE | Age: 81 | Service: Skilled Nursing | Payer: Medicare | MRN: MA200210084304
[05:53:42] ✅    ✅ Document 9242131 processed and saved successfully
[05:53:42] 🔄 
🔄 Step 8: Saving API details...
[05:53:42] [DOC: 9242131] ℹ️  API push details saved for document 9242131
[05:53:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242127                         ║
================================================================================
[05:53:42] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:53:42] ℹ️  Date: 04/15/2025
[05:53:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:53:45] [DOC: 9242127] ✅ Text extracted using pdfplumber (13544 chars)
[05:53:45] ✅    ✅ Text extracted using pdfplumber (13544 chars)
[05:53:45] 🔄 
🔄 Step 2: Extracting patient data...
[05:53:48] ℹ️  AI extracted raw sex value: 'M'
[05:53:48] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:53:48] ℹ️  AI extracted payer source: 'Medicare'
[05:53:48] ℹ️  AI extracted diagnoses:
[05:53:48] ℹ️    - Diagnosis 1: 'I13.0'
[05:53:48] ℹ️    - Diagnosis 2: 'I50.33'
[05:53:48] ℹ️    - Diagnosis 3: 'E11.22'
[05:53:48] ℹ️    - Diagnosis 4: 'N18.32'
[05:53:48] ℹ️    - Diagnosis 5: 'D63.1'
[05:53:48] ℹ️    - Diagnosis 6: 'E11.649'
[05:53:48] ℹ️  Final extracted MRN: '100994168'
[05:53:48] ℹ️  Final extracted Sex: 'MALE'
[05:53:48] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:53:48] ℹ️  Final extracted Payer Source: 'Medicare'
[05:53:48] ✅ Patient data extraction completed successfully
[05:53:48] ✅    ✅ Patient data extracted successfully
[05:53:48] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Brilhante
     └─ dob: 03/13/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 100994168
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/28/2021', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.32', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'E11.649'}]
[05:53:48] ✅    ✅ Patient identified: John Brilhante
[05:53:48] ✅    ✅ Patient name validation passed
[05:53:48] 🔄 
🔄 Step 3: Processing patient dates...
[05:53:48] [DOC: 9242127] ℹ️  DOB normalized: 03/13/1944
[05:53:48] [DOC: 9242127] ℹ️  Episode startOfCare normalized: 04/28/2021
[05:53:48] [DOC: 9242127] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[05:53:48] [DOC: 9242127] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[05:53:48] [DOC: 9242127] ✅ Patient date processing completed successfully
[05:53:48] ✅    ✅ Date processing completed
[05:53:48] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Brilhante
     └─ dob: 03/13/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 100994168
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 1881923936
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/28/2021', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.32', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'E11.649'}]
[05:53:48] 🔄 
🔄 Step 4: Extracting order data...
[05:53:51] ℹ️  Order extraction - MRN: '100994168'
[05:53:51] ℹ️  Order extraction - Sex: 'MALE'
[05:53:51] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:53:51] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:53:51] ✅ Order data extraction completed successfully
[05:53:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:53:51] ℹ️  Using MRN from patient data: '100994168' over '100994168'
[05:53:51] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:53:51] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:53:51] ✅ Patient name cross-validation successful
[05:53:51] ✅    ✅ Data merged successfully
[05:53:53] ✅    ✅ Order data extracted and validated
[05:53:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:53:53] [DOC: 9242127] ✅ Patient found in local cache: John Brilhante, ID: 1aa07e52-8b40-468d-9ce1-62ce0acc9b61
[05:53:53] ✅    ✅ Existing patient found with ID: 1aa07e52-8b40-468d-9ce1-62ce0acc9b61
[05:53:53] 🔄 
🔄 Step 6: Pushing order to API...
[05:53:53] [DOC: 9242127] ℹ️  Pushing order via API for patient ID: 1aa07e52-8b40-468d-9ce1-62ce0acc9b61
[05:53:54] [DOC: 9242127] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13359"}
[05:53:54] ❌    ❌ Failed to push order
[05:53:54] 🔄 
🔄 Step 7: Writing to CSV...
[05:53:54] [DOC: 9242127] ℹ️  Calculated age: 81 from DOB: 03/13/1944
[05:53:54] [DOC: 9242127] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:53:54] [DOC: 9242127] ℹ️  Payer Source extracted: 'Medicare'
[05:53:54] [DOC: 9242127] ℹ️  Diagnosis codes being written:
[05:53:54] [DOC: 9242127] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[05:53:54] [DOC: 9242127] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[05:53:54] [DOC: 9242127] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[05:53:54] [DOC: 9242127] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.32'
[05:53:54] [DOC: 9242127] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D63.1'
[05:53:54] [DOC: 9242127] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E11.649'
[05:53:54] [DOC: 9242127] ✅ Patient data written to CSV: John Brilhante | Sex: MALE | Age: 81 | Service: Skilled Nursing | Payer: Medicare | MRN: 100994168
[05:53:54] ✅    ✅ Document 9242127 processed and saved successfully
[05:53:54] 🔄 
🔄 Step 8: Saving API details...
[05:53:54] [DOC: 9242127] ℹ️  API push details saved for document 9242127
[05:53:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242120                         ║
================================================================================
[05:53:54] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:53:54] ℹ️  Date: 04/15/2025
[05:53:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:53:56] [DOC: 9242120] ✅ Text extracted using pdfplumber (1362 chars)
[05:53:56] ✅    ✅ Text extracted using pdfplumber (1362 chars)
[05:53:56] 🔄 
🔄 Step 2: Extracting patient data...
[05:53:59] ℹ️  AI extracted raw sex value: ''
[05:53:59] ℹ️  AI extracted service line: 'Physical Therapy'
[05:53:59] ℹ️  AI extracted payer source: ''
[05:53:59] ℹ️  AI extracted diagnoses:
[05:53:59] ℹ️    - Diagnosis 1: 'J96.01'
[05:53:59] ℹ️    - Diagnosis 2: 'Q90.9'
[05:53:59] ℹ️    - Diagnosis 3: 'E66.01'
[05:53:59] ℹ️    - Diagnosis 4: ''
[05:53:59] ℹ️    - Diagnosis 5: ''
[05:53:59] ℹ️    - Diagnosis 6: ''
[05:53:59] ℹ️  Final extracted MRN: 'MA240808027001'
[05:53:59] ℹ️  Final extracted Sex: ''
[05:53:59] ℹ️  Final extracted Service Line: 'Physical Therapy'
[05:53:59] ℹ️  Final extracted Payer Source: ''
[05:53:59] ✅ Patient data extraction completed successfully
[05:53:59] ✅    ✅ Patient data extracted successfully
[05:53:59] 📊 Patient Response
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: 
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'J96.01', 'secondDiagnosis': 'Q90.9', 'thirdDiagnosis': 'E66.01', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:53:59] ✅    ✅ Patient identified: Rafael Talavera
[05:53:59] ✅    ✅ Patient name validation passed
[05:53:59] 🔄 
🔄 Step 3: Processing patient dates...
[05:53:59] [DOC: 9242120] ℹ️  DOB normalized: 02/10/1970
[05:53:59] [DOC: 9242120] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[05:53:59] [DOC: 9242120] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[05:53:59] [DOC: 9242120] ✅ Patient date processing completed successfully
[05:53:59] ✅    ✅ Date processing completed
[05:53:59] 📊 Processed Patient Data
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: 
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'J96.01', 'secondDiagnosis': 'Q90.9', 'thirdDiagnosis': 'E66.01', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:53:59] 🔄 
🔄 Step 4: Extracting order data...
[05:54:02] ℹ️  Order extraction - MRN: 'MA240808027001'
[05:54:02] ℹ️  Order extraction - Sex: ''
[05:54:02] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[05:54:02] ℹ️  Order extraction - Payer Source: ''
[05:54:02] ✅ Order data extraction completed successfully
[05:54:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:54:02] ℹ️  Using MRN from patient data: 'MA240808027001' over 'MA240808027001'
[05:54:02] ⚠️  Could not determine sex using any available method
[05:54:02] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[05:54:02] ✅ Patient name cross-validation successful
[05:54:02] ✅    ✅ Data merged successfully
[05:54:03] ✅    ✅ Order data extracted and validated
[05:54:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:54:03] [DOC: 9242120] ✅ Patient found in local cache: Rafael Talavera, ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[05:54:03] ✅    ✅ Existing patient found with ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[05:54:03] 🔄 
🔄 Step 6: Pushing order to API...
[05:54:03] [DOC: 9242120] ℹ️  Pushing order via API for patient ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[05:54:04] [DOC: 9242120] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14482"}
[05:54:04] ❌    ❌ Failed to push order
[05:54:04] 🔄 
🔄 Step 7: Writing to CSV...
[05:54:04] [DOC: 9242120] ℹ️  Calculated age: 55 from DOB: 02/10/1970
[05:54:04] [DOC: 9242120] ℹ️  Service Line extracted: 'Physical Therapy'
[05:54:04] [DOC: 9242120] ℹ️  Payer Source extracted: ''
[05:54:04] [DOC: 9242120] ℹ️  Diagnosis codes being written:
[05:54:04] [DOC: 9242120] ℹ️    - Latest_Episode_Firstdiagnosis: 'J96.01'
[05:54:04] [DOC: 9242120] ℹ️    - Latest_Episode_Seconddiagnosis: 'Q90.9'
[05:54:04] [DOC: 9242120] ℹ️    - Latest_Episode_Thirddiagnosis: 'E66.01'
[05:54:04] [DOC: 9242120] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:54:04] [DOC: 9242120] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:54:04] [DOC: 9242120] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:54:04] [DOC: 9242120] ✅ Patient data written to CSV: Rafael Talavera | Sex:  | Age: 55 | Service: Physical Therapy | Payer:  | MRN: MA240808027001
[05:54:04] ✅    ✅ Document 9242120 processed and saved successfully
[05:54:04] 🔄 
🔄 Step 8: Saving API details...
[05:54:04] [DOC: 9242120] ℹ️  API push details saved for document 9242120
[05:54:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242119                         ║
================================================================================
[05:54:04] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:54:04] ℹ️  Date: 04/15/2025
[05:54:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:54:07] [DOC: 9242119] ✅ Text extracted using pdfplumber (17424 chars)
[05:54:07] ✅    ✅ Text extracted using pdfplumber (17424 chars)
[05:54:07] 🔄 
🔄 Step 2: Extracting patient data...
[05:54:10] ℹ️  AI extracted raw sex value: 'M'
[05:54:10] ℹ️  AI extracted service line: 'PT'
[05:54:10] ℹ️  AI extracted payer source: ''
[05:54:10] ℹ️  AI extracted diagnoses:
[05:54:10] ℹ️    - Diagnosis 1: 'complete trisomy 21 syndrome'
[05:54:10] ℹ️    - Diagnosis 2: 'Generalized weakness'
[05:54:10] ℹ️    - Diagnosis 3: 'Asthma'
[05:54:10] ℹ️    - Diagnosis 4: 'ostium secundum type atrial septal defect'
[05:54:10] ℹ️    - Diagnosis 5: 'DM'
[05:54:10] ℹ️    - Diagnosis 6: 'hypothyroidism'
[05:54:10] ℹ️  Final extracted MRN: 'MA240808027001'
[05:54:10] ℹ️  Final extracted Sex: 'MALE'
[05:54:10] ℹ️  Final extracted Service Line: 'PT'
[05:54:10] ℹ️  Final extracted Payer Source: ''
[05:54:10] ✅ Patient data extraction completed successfully
[05:54:10] ✅    ✅ Patient data extracted successfully
[05:54:10] 📊 Patient Response
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '', 'firstDiagnosis': 'complete trisomy 21 syndrome', 'secondDiagnosis': 'Generalized weakness', 'thirdDiagnosis': 'Asthma', 'fourthDiagnosis': 'ostium secundum type atrial septal defect', 'fifthDiagnosis': 'DM', 'sixthDiagnosis': 'hypothyroidism'}]
[05:54:10] ✅    ✅ Patient identified: Rafael Talavera
[05:54:10] ✅    ✅ Patient name validation passed
[05:54:10] 🔄 
🔄 Step 3: Processing patient dates...
[05:54:10] [DOC: 9242119] ℹ️  DOB normalized: 02/10/1970
[05:54:10] [DOC: 9242119] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[05:54:10] [DOC: 9242119] ✅ Patient date processing completed successfully
[05:54:10] ✅    ✅ Date processing completed
[05:54:10] 📊 Processed Patient Data
     └─ patientFName: Rafael
     └─ patientLName: Talavera
     └─ dob: 02/10/1970
     └─ patientSex: MALE
     └─ medicalRecordNo: MA240808027001
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '', 'firstDiagnosis': 'complete trisomy 21 syndrome', 'secondDiagnosis': 'Generalized weakness', 'thirdDiagnosis': 'Asthma', 'fourthDiagnosis': 'ostium secundum type atrial septal defect', 'fifthDiagnosis': 'DM', 'sixthDiagnosis': 'hypothyroidism'}]
[05:54:10] 🔄 
🔄 Step 4: Extracting order data...
[05:54:13] ℹ️  Order extraction - MRN: 'MA240808027001'
[05:54:13] ℹ️  Order extraction - Sex: 'MALE'
[05:54:13] ℹ️  Order extraction - Service Line: 'PT'
[05:54:13] ℹ️  Order extraction - Payer Source: ''
[05:54:13] ✅ Order data extraction completed successfully
[05:54:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:54:13] ℹ️  Using MRN from patient data: 'MA240808027001' over 'MA240808027001'
[05:54:13] ℹ️  Service line consistent in both sources: 'PT'
[05:54:13] ✅ Patient name cross-validation successful
[05:54:13] ✅    ✅ Data merged successfully
[05:54:15] ✅    ✅ Order data extracted and validated
[05:54:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:54:15] [DOC: 9242119] ✅ Patient found in local cache: Rafael Talavera, ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[05:54:15] ✅    ✅ Existing patient found with ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[05:54:15] 🔄 
🔄 Step 6: Pushing order to API...
[05:54:15] [DOC: 9242119] ℹ️  Pushing order via API for patient ID: 4bd627ef-e6e0-40f1-b3bb-53ce5a43f2d3
[05:54:16] [DOC: 9242119] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:54:16] ❌    ❌ Failed to push order
[05:54:16] 🔄 
🔄 Step 7: Writing to CSV...
[05:54:16] [DOC: 9242119] ℹ️  Calculated age: 55 from DOB: 02/10/1970
[05:54:16] [DOC: 9242119] ℹ️  Service Line extracted: 'PT'
[05:54:16] [DOC: 9242119] ℹ️  Payer Source extracted: ''
[05:54:16] [DOC: 9242119] ℹ️  Diagnosis codes being written:
[05:54:16] [DOC: 9242119] ℹ️    - Latest_Episode_Firstdiagnosis: 'complete trisomy 21 syndrome'
[05:54:16] [DOC: 9242119] ℹ️    - Latest_Episode_Seconddiagnosis: 'Generalized weakness'
[05:54:16] [DOC: 9242119] ℹ️    - Latest_Episode_Thirddiagnosis: 'Asthma'
[05:54:16] [DOC: 9242119] ℹ️    - Latest_Episode_Fourthdiagnosis: 'ostium secundum type atrial septal defect'
[05:54:16] [DOC: 9242119] ℹ️    - Latest_Episode_Fifthdiagnosis: 'DM'
[05:54:16] [DOC: 9242119] ℹ️    - Latest_Episode_Sixthdiagnosis: 'hypothyroidism'
[05:54:16] [DOC: 9242119] ✅ Patient data written to CSV: Rafael Talavera | Sex: MALE | Age: 55 | Service: PT | Payer:  | MRN: MA240808027001
[05:54:16] ✅    ✅ Document 9242119 processed and saved successfully
[05:54:16] 🔄 
🔄 Step 8: Saving API details...
[05:54:16] [DOC: 9242119] ℹ️  API push details saved for document 9242119
[05:54:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242116                         ║
================================================================================
[05:54:16] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:54:16] ℹ️  Date: 04/15/2025
[05:54:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:54:18] [DOC: 9242116] ✅ Text extracted using pdfplumber (1294 chars)
[05:54:18] ✅    ✅ Text extracted using pdfplumber (1294 chars)
[05:54:18] 🔄 
🔄 Step 2: Extracting patient data...
[05:54:21] ℹ️  AI extracted raw sex value: ''
[05:54:21] ℹ️  AI extracted service line: 'PT'
[05:54:21] ℹ️  AI extracted payer source: ''
[05:54:21] ℹ️  AI extracted diagnoses:
[05:54:21] ℹ️    - Diagnosis 1: 'M67.813'
[05:54:21] ℹ️    - Diagnosis 2: 'M67.814'
[05:54:21] ℹ️    - Diagnosis 3: 'M15.9'
[05:54:21] ℹ️    - Diagnosis 4: ''
[05:54:21] ℹ️    - Diagnosis 5: ''
[05:54:21] ℹ️    - Diagnosis 6: ''
[05:54:21] ℹ️  Final extracted MRN: 'MA230420103801'
[05:54:21] ℹ️  Final extracted Sex: ''
[05:54:21] ℹ️  Final extracted Service Line: 'PT'
[05:54:21] ℹ️  Final extracted Payer Source: ''
[05:54:21] ✅ Patient data extraction completed successfully
[05:54:21] ✅    ✅ Patient data extracted successfully
[05:54:21] 📊 Patient Response
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:54:21] ✅    ✅ Patient identified: Alfredo Santos
[05:54:21] ✅    ✅ Patient name validation passed
[05:54:21] 🔄 
🔄 Step 3: Processing patient dates...
[05:54:21] [DOC: 9242116] ℹ️  DOB normalized: 10/24/1938
[05:54:21] [DOC: 9242116] ℹ️  Episode startOfCare normalized: 03/20/2025
[05:54:21] [DOC: 9242116] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[05:54:21] [DOC: 9242116] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[05:54:21] [DOC: 9242116] ✅ Patient date processing completed successfully
[05:54:21] ✅    ✅ Date processing completed
[05:54:21] 📊 Processed Patient Data
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: 
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:54:21] 🔄 
🔄 Step 4: Extracting order data...
[05:54:24] ℹ️  Order extraction - MRN: 'MA230420103801'
[05:54:24] ℹ️  Order extraction - Sex: ''
[05:54:24] ℹ️  Order extraction - Service Line: 'PT'
[05:54:24] ℹ️  Order extraction - Payer Source: ''
[05:54:24] ✅ Order data extraction completed successfully
[05:54:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:54:24] ℹ️  Using MRN from patient data: 'MA230420103801' over 'MA230420103801'
[05:54:24] ⚠️  Could not determine sex using any available method
[05:54:24] ℹ️  Service line consistent in both sources: 'PT'
[05:54:24] ✅ Patient name cross-validation successful
[05:54:24] ✅    ✅ Data merged successfully
[05:54:25] ✅    ✅ Order data extracted and validated
[05:54:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:54:25] [DOC: 9242116] ✅ Patient found in local cache: Alfredo Santos, ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[05:54:25] ✅    ✅ Existing patient found with ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[05:54:25] 🔄 
🔄 Step 6: Pushing order to API...
[05:54:25] [DOC: 9242116] ℹ️  Pushing order via API for patient ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[05:54:26] [DOC: 9242116] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14369"}
[05:54:26] ❌    ❌ Failed to push order
[05:54:26] 🔄 
🔄 Step 7: Writing to CSV...
[05:54:26] [DOC: 9242116] ℹ️  Calculated age: 86 from DOB: 10/24/1938
[05:54:26] [DOC: 9242116] ℹ️  Service Line extracted: 'PT'
[05:54:26] [DOC: 9242116] ℹ️  Payer Source extracted: ''
[05:54:26] [DOC: 9242116] ℹ️  Diagnosis codes being written:
[05:54:26] [DOC: 9242116] ℹ️    - Latest_Episode_Firstdiagnosis: 'M67.813'
[05:54:26] [DOC: 9242116] ℹ️    - Latest_Episode_Seconddiagnosis: 'M67.814'
[05:54:26] [DOC: 9242116] ℹ️    - Latest_Episode_Thirddiagnosis: 'M15.9'
[05:54:26] [DOC: 9242116] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:54:26] [DOC: 9242116] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:54:26] [DOC: 9242116] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:54:26] [DOC: 9242116] ✅ Patient data written to CSV: Alfredo Santos | Sex:  | Age: 86 | Service: PT | Payer:  | MRN: MA230420103801
[05:54:26] ✅    ✅ Document 9242116 processed and saved successfully
[05:54:26] 🔄 
🔄 Step 8: Saving API details...
[05:54:26] [DOC: 9242116] ℹ️  API push details saved for document 9242116
[05:54:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242112                         ║
================================================================================
[05:54:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:54:26] ℹ️  Date: 04/15/2025
[05:54:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:54:28] [DOC: 9242112] ✅ Text extracted using pdfplumber (11482 chars)
[05:54:28] ✅    ✅ Text extracted using pdfplumber (11482 chars)
[05:54:28] 🔄 
🔄 Step 2: Extracting patient data...
[05:54:32] ℹ️  AI extracted raw sex value: 'M'
[05:54:32] ℹ️  AI extracted service line: 'PT, OT'
[05:54:32] ℹ️  AI extracted payer source: 'Medicare'
[05:54:32] ℹ️  AI extracted diagnoses:
[05:54:32] ℹ️    - Diagnosis 1: 'M67.813'
[05:54:32] ℹ️    - Diagnosis 2: 'M67.814'
[05:54:32] ℹ️    - Diagnosis 3: 'M15.9'
[05:54:32] ℹ️    - Diagnosis 4: 'G89.4'
[05:54:32] ℹ️    - Diagnosis 5: 'M50.90'
[05:54:32] ℹ️    - Diagnosis 6: 'I10'
[05:54:32] ℹ️  Final extracted MRN: 'MA230420103801'
[05:54:32] ℹ️  Final extracted Sex: 'MALE'
[05:54:32] ℹ️  Final extracted Service Line: 'PT, OT'
[05:54:32] ℹ️  Final extracted Payer Source: 'Medicare'
[05:54:32] ✅ Patient data extraction completed successfully
[05:54:32] ✅    ✅ Patient data extracted successfully
[05:54:32] 📊 Patient Response
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 951-1896
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': 'G89.4', 'fifthDiagnosis': 'M50.90', 'sixthDiagnosis': 'I10'}]
[05:54:32] ✅    ✅ Patient identified: Alfredo Santos
[05:54:32] ✅    ✅ Patient name validation passed
[05:54:32] 🔄 
🔄 Step 3: Processing patient dates...
[05:54:32] [DOC: 9242112] ℹ️  DOB normalized: 10/24/1938
[05:54:32] [DOC: 9242112] ℹ️  Episode startOfCare normalized: 03/20/2025
[05:54:32] [DOC: 9242112] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[05:54:32] [DOC: 9242112] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[05:54:32] [DOC: 9242112] ✅ Patient date processing completed successfully
[05:54:32] ✅    ✅ Date processing completed
[05:54:32] 📊 Processed Patient Data
     └─ patientFName: Alfredo
     └─ patientLName: Santos
     └─ dob: 10/24/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230420103801
     └─ billingProvider: Dr. Martin, Daniel J.
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 951-1896
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M67.813', 'secondDiagnosis': 'M67.814', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': 'G89.4', 'fifthDiagnosis': 'M50.90', 'sixthDiagnosis': 'I10'}]
[05:54:32] 🔄 
🔄 Step 4: Extracting order data...
[05:54:35] ℹ️  Order extraction - MRN: 'MA230420103801'
[05:54:35] ℹ️  Order extraction - Sex: 'MALE'
[05:54:35] ℹ️  Order extraction - Service Line: 'PT, OT'
[05:54:35] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:54:35] ✅ Order data extraction completed successfully
[05:54:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:54:35] ℹ️  Using MRN from patient data: 'MA230420103801' over 'MA230420103801'
[05:54:35] ℹ️  Service line consistent in both sources: 'PT, OT'
[05:54:35] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:54:35] ✅ Patient name cross-validation successful
[05:54:35] ✅    ✅ Data merged successfully
[05:54:36] ✅    ✅ Order data extracted and validated
[05:54:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:54:36] [DOC: 9242112] ✅ Patient found in local cache: Alfredo Santos, ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[05:54:36] ✅    ✅ Existing patient found with ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[05:54:36] 🔄 
🔄 Step 6: Pushing order to API...
[05:54:36] [DOC: 9242112] ℹ️  Pushing order via API for patient ID: 0b9d43ac-4af1-4322-825e-62408f7fe9f0
[05:54:37] [DOC: 9242112] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14370"}
[05:54:37] ❌    ❌ Failed to push order
[05:54:37] 🔄 
🔄 Step 7: Writing to CSV...
[05:54:37] [DOC: 9242112] ℹ️  Calculated age: 86 from DOB: 10/24/1938
[05:54:37] [DOC: 9242112] ℹ️  Service Line extracted: 'PT, OT'
[05:54:37] [DOC: 9242112] ℹ️  Payer Source extracted: 'Medicare'
[05:54:37] [DOC: 9242112] ℹ️  Diagnosis codes being written:
[05:54:37] [DOC: 9242112] ℹ️    - Latest_Episode_Firstdiagnosis: 'M67.813'
[05:54:37] [DOC: 9242112] ℹ️    - Latest_Episode_Seconddiagnosis: 'M67.814'
[05:54:37] [DOC: 9242112] ℹ️    - Latest_Episode_Thirddiagnosis: 'M15.9'
[05:54:37] [DOC: 9242112] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G89.4'
[05:54:37] [DOC: 9242112] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M50.90'
[05:54:37] [DOC: 9242112] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I10'
[05:54:37] [DOC: 9242112] ✅ Patient data written to CSV: Alfredo Santos | Sex: MALE | Age: 86 | Service: PT, OT | Payer: Medicare | MRN: MA230420103801
[05:54:37] ✅    ✅ Document 9242112 processed and saved successfully
[05:54:37] 🔄 
🔄 Step 8: Saving API details...
[05:54:37] [DOC: 9242112] ℹ️  API push details saved for document 9242112
[05:54:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242034                         ║
================================================================================
[05:54:37] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:54:37] ℹ️  Date: 04/15/2025
[05:54:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:54:39] [DOC: 9242034] ✅ Text extracted using pdfplumber (1483 chars)
[05:54:39] ✅    ✅ Text extracted using pdfplumber (1483 chars)
[05:54:39] 🔄 
🔄 Step 2: Extracting patient data...
[05:54:42] ℹ️  AI extracted raw sex value: ''
[05:54:42] ℹ️  AI extracted service line: 'RN'
[05:54:42] ℹ️  AI extracted payer source: ''
[05:54:42] ℹ️  AI extracted diagnoses:
[05:54:42] ℹ️    - Diagnosis 1: 'E11.65'
[05:54:42] ℹ️    - Diagnosis 2: 'I10'
[05:54:42] ℹ️    - Diagnosis 3: 'F20.9'
[05:54:42] ℹ️    - Diagnosis 4: ''
[05:54:42] ℹ️    - Diagnosis 5: ''
[05:54:42] ℹ️    - Diagnosis 6: ''
[05:54:42] ℹ️  Final extracted MRN: 'MA230222024501'
[05:54:42] ℹ️  Final extracted Sex: ''
[05:54:42] ℹ️  Final extracted Service Line: 'RN'
[05:54:42] ℹ️  Final extracted Payer Source: ''
[05:54:42] ✅ Patient data extraction completed successfully
[05:54:42] ✅    ✅ Patient data extracted successfully
[05:54:42] 📊 Patient Response
     └─ patientFName: Pauline
     └─ patientLName: Bergeron
     └─ dob: 02/22/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA230222024501
     └─ billingProvider: STEPHEN MACKLER MD
     └─ npi: 1669442745
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F20.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:54:42] ✅    ✅ Patient identified: Pauline Bergeron
[05:54:42] ✅    ✅ Patient name validation passed
[05:54:42] 🔄 
🔄 Step 3: Processing patient dates...
[05:54:42] [DOC: 9242034] ℹ️  DOB normalized: 02/22/1945
[05:54:42] [DOC: 9242034] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[05:54:42] [DOC: 9242034] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[05:54:42] [DOC: 9242034] ✅ Patient date processing completed successfully
[05:54:42] ✅    ✅ Date processing completed
[05:54:42] 📊 Processed Patient Data
     └─ patientFName: Pauline
     └─ patientLName: Bergeron
     └─ dob: 02/22/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA230222024501
     └─ billingProvider: STEPHEN MACKLER MD
     └─ npi: 1669442745
     └─ physicianNPI: 1669442745
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'F20.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:54:42] 🔄 
🔄 Step 4: Extracting order data...
[05:54:45] ℹ️  Order extraction - MRN: 'MA230222024501'
[05:54:45] ℹ️  Order extraction - Sex: ''
[05:54:45] ℹ️  Order extraction - Service Line: 'RN'
[05:54:45] ℹ️  Order extraction - Payer Source: ''
[05:54:45] ✅ Order data extraction completed successfully
[05:54:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:54:45] ℹ️  Using MRN from patient data: 'MA230222024501' over 'MA230222024501'
[05:54:45] ⚠️  Could not determine sex using any available method
[05:54:45] ℹ️  Service line consistent in both sources: 'RN'
[05:54:45] ✅ Patient name cross-validation successful
[05:54:45] ✅    ✅ Data merged successfully
[05:54:47] ✅    ✅ Order data extracted and validated
[05:54:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:54:47] [DOC: 9242034] ✅ Patient found in local cache: Pauline Bergeron, ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[05:54:47] ✅    ✅ Existing patient found with ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[05:54:47] 🔄 
🔄 Step 6: Pushing order to API...
[05:54:47] [DOC: 9242034] ℹ️  Pushing order via API for patient ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[05:54:48] [DOC: 9242034] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13113"}
[05:54:48] ❌    ❌ Failed to push order
[05:54:48] 🔄 
🔄 Step 7: Writing to CSV...
[05:54:48] [DOC: 9242034] ℹ️  Calculated age: 80 from DOB: 02/22/1945
[05:54:48] [DOC: 9242034] ℹ️  Service Line extracted: 'RN'
[05:54:48] [DOC: 9242034] ℹ️  Payer Source extracted: ''
[05:54:48] [DOC: 9242034] ℹ️  Diagnosis codes being written:
[05:54:48] [DOC: 9242034] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[05:54:48] [DOC: 9242034] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[05:54:48] [DOC: 9242034] ℹ️    - Latest_Episode_Thirddiagnosis: 'F20.9'
[05:54:48] [DOC: 9242034] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:54:48] [DOC: 9242034] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:54:48] [DOC: 9242034] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:54:48] [DOC: 9242034] ✅ Patient data written to CSV: Pauline Bergeron | Sex:  | Age: 80 | Service: RN | Payer:  | MRN: MA230222024501
[05:54:48] ✅    ✅ Document 9242034 processed and saved successfully
[05:54:48] 🔄 
🔄 Step 8: Saving API details...
[05:54:48] [DOC: 9242034] ℹ️  API push details saved for document 9242034
[05:54:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242031                         ║
================================================================================
[05:54:48] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:54:48] ℹ️  Date: 04/15/2025
[05:54:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:54:56] [DOC: 9242031] ✅ Text extracted using pdfplumber (19642 chars)
[05:54:56] ✅    ✅ Text extracted using pdfplumber (19642 chars)
[05:54:56] 🔄 
🔄 Step 2: Extracting patient data...
[05:54:59] ℹ️  AI extracted raw sex value: 'F'
[05:54:59] ℹ️  AI extracted service line: 'PT'
[05:54:59] ℹ️  AI extracted payer source: ''
[05:54:59] ℹ️  AI extracted diagnoses:
[05:54:59] ℹ️    - Diagnosis 1: 'DM'
[05:54:59] ℹ️    - Diagnosis 2: 'Difficulty with gait'
[05:54:59] ℹ️    - Diagnosis 3: 'None'
[05:54:59] ℹ️    - Diagnosis 4: 'None'
[05:54:59] ℹ️    - Diagnosis 5: 'None'
[05:54:59] ℹ️    - Diagnosis 6: 'None'
[05:54:59] ℹ️  Final extracted MRN: 'MA230222024501'
[05:54:59] ℹ️  Final extracted Sex: 'FEMALE'
[05:54:59] ℹ️  Final extracted Service Line: 'PT'
[05:54:59] ℹ️  Final extracted Payer Source: ''
[05:54:59] ✅ Patient data extraction completed successfully
[05:54:59] ✅    ✅ Patient data extracted successfully
[05:54:59] 📊 Patient Response
     └─ patientFName: Pauline
     └─ patientLName: Bergeron
     └─ dob: 02/22/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230222024501
     └─ billingProvider: Dr. Mackler, Stephen
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '12/07/2024', 'endOfEpisode': None, 'firstDiagnosis': 'DM', 'secondDiagnosis': 'Difficulty with gait', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:54:59] ✅    ✅ Patient identified: Pauline Bergeron
[05:54:59] ✅    ✅ Patient name validation passed
[05:54:59] 🔄 
🔄 Step 3: Processing patient dates...
[05:54:59] [DOC: 9242031] ℹ️  DOB normalized: 02/22/1945
[05:54:59] [DOC: 9242031] ℹ️  Episode startOfEpisode normalized: 12/07/2024
[05:54:59] [DOC: 9242031] ✅ Patient date processing completed successfully
[05:54:59] ✅    ✅ Date processing completed
[05:54:59] 📊 Processed Patient Data
     └─ patientFName: Pauline
     └─ patientLName: Bergeron
     └─ dob: 02/22/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230222024501
     └─ billingProvider: Dr. Mackler, Stephen
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '12/07/2024', 'firstDiagnosis': 'DM', 'secondDiagnosis': 'Difficulty with gait'}]
[05:54:59] 🔄 
🔄 Step 4: Extracting order data...
[05:55:01] ℹ️  Order extraction - MRN: 'MA230222024501'
[05:55:01] ℹ️  Order extraction - Sex: 'FEMALE'
[05:55:01] ℹ️  Order extraction - Service Line: 'PT'
[05:55:01] ℹ️  Order extraction - Payer Source: ''
[05:55:01] ✅ Order data extraction completed successfully
[05:55:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:55:01] ℹ️  Using MRN from patient data: 'MA230222024501' over 'MA230222024501'
[05:55:01] ℹ️  Service line consistent in both sources: 'PT'
[05:55:01] ✅ Patient name cross-validation successful
[05:55:01] ✅    ✅ Data merged successfully
[05:55:04] ✅    ✅ Order data extracted and validated
[05:55:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:55:04] [DOC: 9242031] ✅ Patient found in local cache: Pauline Bergeron, ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[05:55:04] ✅    ✅ Existing patient found with ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[05:55:04] 🔄 
🔄 Step 6: Pushing order to API...
[05:55:04] [DOC: 9242031] ℹ️  Pushing order via API for patient ID: b363f434-a07c-425b-a8b8-cdf671a2a905
[05:55:05] [DOC: 9242031] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:55:05] ❌    ❌ Failed to push order
[05:55:05] 🔄 
🔄 Step 7: Writing to CSV...
[05:55:05] [DOC: 9242031] ℹ️  Calculated age: 80 from DOB: 02/22/1945
[05:55:05] [DOC: 9242031] ℹ️  Service Line extracted: 'PT'
[05:55:05] [DOC: 9242031] ℹ️  Payer Source extracted: ''
[05:55:05] [DOC: 9242031] ℹ️  Diagnosis codes being written:
[05:55:05] [DOC: 9242031] ℹ️    - Latest_Episode_Firstdiagnosis: 'DM'
[05:55:05] [DOC: 9242031] ℹ️    - Latest_Episode_Seconddiagnosis: 'Difficulty with gait'
[05:55:05] [DOC: 9242031] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:55:05] [DOC: 9242031] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:55:05] [DOC: 9242031] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:55:05] [DOC: 9242031] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:55:05] [DOC: 9242031] ✅ Patient data written to CSV: Pauline Bergeron | Sex: FEMALE | Age: 80 | Service: PT | Payer:  | MRN: MA230222024501
[05:55:05] ✅    ✅ Document 9242031 processed and saved successfully
[05:55:05] 🔄 
🔄 Step 8: Saving API details...
[05:55:05] [DOC: 9242031] ℹ️  API push details saved for document 9242031
[05:55:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242022                         ║
================================================================================
[05:55:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:55:05] ℹ️  Date: 04/15/2025
[05:55:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:55:09] [DOC: 9242022] ✅ Text extracted using pdfplumber (20529 chars)
[05:55:09] ✅    ✅ Text extracted using pdfplumber (20529 chars)
[05:55:09] 🔄 
🔄 Step 2: Extracting patient data...
[05:55:12] ℹ️  AI extracted raw sex value: 'F'
[05:55:12] ℹ️  AI extracted service line: 'PT'
[05:55:12] ℹ️  AI extracted payer source: ''
[05:55:12] ℹ️  AI extracted diagnoses:
[05:55:12] ℹ️    - Diagnosis 1: 'Type 2 diabetes mellitus w diabetic neuropathic arthropathy'
[05:55:12] ℹ️    - Diagnosis 2: 'Muscle weakness'
[05:55:12] ℹ️    - Diagnosis 3: 'L LE cellulitis'
[05:55:12] ℹ️    - Diagnosis 4: 'Multiple sclerosis'
[05:55:12] ℹ️    - Diagnosis 5: 'GERD'
[05:55:12] ℹ️    - Diagnosis 6: 'DM type 2 with hyperglycemia'
[05:55:12] ℹ️  Final extracted MRN: 'MA240822115704'
[05:55:12] ℹ️  Final extracted Sex: 'FEMALE'
[05:55:12] ℹ️  Final extracted Service Line: 'PT'
[05:55:12] ℹ️  Final extracted Payer Source: ''
[05:55:12] ✅ Patient data extraction completed successfully
[05:55:12] ✅    ✅ Patient data extracted successfully
[05:55:12] 📊 Patient Response
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/21/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Type 2 diabetes mellitus w diabetic neuropathic arthropathy', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': 'L LE cellulitis', 'fourthDiagnosis': 'Multiple sclerosis', 'fifthDiagnosis': 'GERD', 'sixthDiagnosis': 'DM type 2 with hyperglycemia'}]
[05:55:12] ✅    ✅ Patient identified: Charlene Couto
[05:55:12] ✅    ✅ Patient name validation passed
[05:55:12] 🔄 
🔄 Step 3: Processing patient dates...
[05:55:12] [DOC: 9242022] ℹ️  DOB normalized: 11/01/1957
[05:55:12] [DOC: 9242022] ℹ️  Episode startOfCare normalized: 02/21/2025
[05:55:12] [DOC: 9242022] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[05:55:12] [DOC: 9242022] ✅ Patient date processing completed successfully
[05:55:12] ✅    ✅ Date processing completed
[05:55:12] 📊 Processed Patient Data
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/21/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '', 'firstDiagnosis': 'Type 2 diabetes mellitus w diabetic neuropathic arthropathy', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': 'L LE cellulitis', 'fourthDiagnosis': 'Multiple sclerosis', 'fifthDiagnosis': 'GERD', 'sixthDiagnosis': 'DM type 2 with hyperglycemia'}]
[05:55:12] 🔄 
🔄 Step 4: Extracting order data...
[05:55:15] ℹ️  Order extraction - MRN: 'MA240822115704'
[05:55:15] ℹ️  Order extraction - Sex: 'FEMALE'
[05:55:15] ℹ️  Order extraction - Service Line: 'PT'
[05:55:15] ℹ️  Order extraction - Payer Source: ''
[05:55:15] ✅ Order data extraction completed successfully
[05:55:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:55:15] ℹ️  Using MRN from patient data: 'MA240822115704' over 'MA240822115704'
[05:55:15] ℹ️  Service line consistent in both sources: 'PT'
[05:55:15] ✅ Patient name cross-validation successful
[05:55:15] ✅    ✅ Data merged successfully
[05:55:17] ✅    ✅ Order data extracted and validated
[05:55:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:55:22] [DOC: 9242022] ✅ Patient exists in API: Charlene Couto, ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[05:55:22] ✅    ✅ Existing patient found with ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[05:55:22] 🔄 
🔄 Step 6: Pushing order to API...
[05:55:22] [DOC: 9242022] ℹ️  Pushing order via API for patient ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[05:55:24] [DOC: 9242022] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:55:24] ❌    ❌ Failed to push order
[05:55:24] 🔄 
🔄 Step 7: Writing to CSV...
[05:55:24] [DOC: 9242022] ℹ️  Calculated age: 67 from DOB: 11/01/1957
[05:55:24] [DOC: 9242022] ℹ️  Service Line extracted: 'PT'
[05:55:24] [DOC: 9242022] ℹ️  Payer Source extracted: ''
[05:55:24] [DOC: 9242022] ℹ️  Diagnosis codes being written:
[05:55:24] [DOC: 9242022] ℹ️    - Latest_Episode_Firstdiagnosis: 'Type 2 diabetes mellitus w diabetic neuropathic arthropathy'
[05:55:24] [DOC: 9242022] ℹ️    - Latest_Episode_Seconddiagnosis: 'Muscle weakness'
[05:55:24] [DOC: 9242022] ℹ️    - Latest_Episode_Thirddiagnosis: 'L LE cellulitis'
[05:55:24] [DOC: 9242022] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Multiple sclerosis'
[05:55:24] [DOC: 9242022] ℹ️    - Latest_Episode_Fifthdiagnosis: 'GERD'
[05:55:24] [DOC: 9242022] ℹ️    - Latest_Episode_Sixthdiagnosis: 'DM type 2 with hyperglycemia'
[05:55:24] [DOC: 9242022] ✅ Patient data written to CSV: Charlene Couto | Sex: FEMALE | Age: 67 | Service: PT | Payer:  | MRN: MA240822115704
[05:55:24] ✅    ✅ Document 9242022 processed and saved successfully
[05:55:24] 🔄 
🔄 Step 8: Saving API details...
[05:55:24] [DOC: 9242022] ℹ️  API push details saved for document 9242022
[05:55:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242016                         ║
================================================================================
[05:55:24] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:55:24] ℹ️  Date: 04/15/2025
[05:55:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:55:26] [DOC: 9242016] ✅ Text extracted using pdfplumber (1656 chars)
[05:55:26] ✅    ✅ Text extracted using pdfplumber (1644 chars)
[05:55:26] 🔄 
🔄 Step 2: Extracting patient data...
[05:55:29] ℹ️  AI extracted raw sex value: ''
[05:55:29] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:55:29] ℹ️  AI extracted payer source: ''
[05:55:29] ℹ️  AI extracted diagnoses:
[05:55:29] ℹ️    - Diagnosis 1: 'E11.610'
[05:55:29] ℹ️    - Diagnosis 2: 'L89.616'
[05:55:29] ℹ️    - Diagnosis 3: 'I89.0'
[05:55:29] ℹ️    - Diagnosis 4: 'None'
[05:55:29] ℹ️    - Diagnosis 5: 'None'
[05:55:29] ℹ️    - Diagnosis 6: 'None'
[05:55:29] ℹ️  Final extracted MRN: 'MA240822115704'
[05:55:29] ℹ️  Final extracted Sex: ''
[05:55:29] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:55:29] ℹ️  Final extracted Payer Source: ''
[05:55:29] ✅ Patient data extraction completed successfully
[05:55:29] ✅    ✅ Patient data extracted successfully
[05:55:29] 📊 Patient Response
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'E11.610', 'secondDiagnosis': 'L89.616', 'thirdDiagnosis': 'I89.0', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:55:29] ✅    ✅ Patient identified: Charlene Couto
[05:55:29] ✅    ✅ Patient name validation passed
[05:55:29] 🔄 
🔄 Step 3: Processing patient dates...
[05:55:29] [DOC: 9242016] ℹ️  DOB normalized: 11/01/1957
[05:55:29] [DOC: 9242016] ℹ️  Episode startOfEpisode normalized: 02/21/2025
[05:55:29] [DOC: 9242016] ℹ️  Episode endOfEpisode normalized: 04/21/2025
[05:55:29] [DOC: 9242016] ✅ Patient date processing completed successfully
[05:55:29] ✅    ✅ Date processing completed
[05:55:29] 📊 Processed Patient Data
     └─ patientFName: Charlene
     └─ patientLName: Couto
     └─ dob: 11/01/1957
     └─ patientSex: 
     └─ medicalRecordNo: MA240822115704
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/21/2025', 'endOfEpisode': '04/21/2025', 'firstDiagnosis': 'E11.610', 'secondDiagnosis': 'L89.616', 'thirdDiagnosis': 'I89.0'}]
[05:55:29] 🔄 
🔄 Step 4: Extracting order data...
[05:55:32] ℹ️  Order extraction - MRN: 'MA240822115704'
[05:55:32] ℹ️  Order extraction - Sex: ''
[05:55:32] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:55:32] ℹ️  Order extraction - Payer Source: ''
[05:55:32] ✅ Order data extraction completed successfully
[05:55:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:55:32] ℹ️  Using MRN from patient data: 'MA240822115704' over 'MA240822115704'
[05:55:32] ⚠️  Could not determine sex using any available method
[05:55:32] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:55:32] ✅ Patient name cross-validation successful
[05:55:32] ✅    ✅ Data merged successfully
[05:55:33] ✅    ✅ Order data extracted and validated
[05:55:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:55:33] [DOC: 9242016] ✅ Patient found in local cache: Charlene Couto, ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[05:55:33] ✅    ✅ Existing patient found with ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[05:55:33] 🔄 
🔄 Step 6: Pushing order to API...
[05:55:33] [DOC: 9242016] ℹ️  Pushing order via API for patient ID: a0ee510e-0c6d-4a62-95a3-9b484e72f2e5
[05:55:35] [DOC: 9242016] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13731"}
[05:55:35] ❌    ❌ Failed to push order
[05:55:35] 🔄 
🔄 Step 7: Writing to CSV...
[05:55:35] [DOC: 9242016] ℹ️  Calculated age: 67 from DOB: 11/01/1957
[05:55:35] [DOC: 9242016] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:55:35] [DOC: 9242016] ℹ️  Payer Source extracted: ''
[05:55:35] [DOC: 9242016] ℹ️  Diagnosis codes being written:
[05:55:35] [DOC: 9242016] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.610'
[05:55:35] [DOC: 9242016] ℹ️    - Latest_Episode_Seconddiagnosis: 'L89.616'
[05:55:35] [DOC: 9242016] ℹ️    - Latest_Episode_Thirddiagnosis: 'I89.0'
[05:55:35] [DOC: 9242016] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:55:35] [DOC: 9242016] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:55:35] [DOC: 9242016] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:55:35] [DOC: 9242016] ✅ Patient data written to CSV: Charlene Couto | Sex:  | Age: 67 | Service: Skilled Nursing | Payer:  | MRN: MA240822115704
[05:55:35] ✅    ✅ Document 9242016 processed and saved successfully
[05:55:35] 🔄 
🔄 Step 8: Saving API details...
[05:55:35] [DOC: 9242016] ℹ️  API push details saved for document 9242016
[05:55:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242003                         ║
================================================================================
[05:55:35] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:55:35] ℹ️  Date: 04/15/2025
[05:55:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:55:37] [DOC: 9242003] ✅ Text extracted using pdfplumber (1612 chars)
[05:55:37] ✅    ✅ Text extracted using pdfplumber (1600 chars)
[05:55:37] 🔄 
🔄 Step 2: Extracting patient data...
[05:55:40] ℹ️  AI extracted raw sex value: ''
[05:55:40] ℹ️  AI extracted service line: 'Physical Therapy'
[05:55:40] ℹ️  AI extracted payer source: ''
[05:55:40] ℹ️  AI extracted diagnoses:
[05:55:40] ℹ️    - Diagnosis 1: 'I11.0'
[05:55:40] ℹ️    - Diagnosis 2: 'I50.33'
[05:55:40] ℹ️    - Diagnosis 3: 'J18.9'
[05:55:40] ℹ️    - Diagnosis 4: 'None'
[05:55:40] ℹ️    - Diagnosis 5: 'None'
[05:55:40] ℹ️    - Diagnosis 6: 'None'
[05:55:40] ℹ️  Final extracted MRN: 'MA221012094404'
[05:55:40] ℹ️  Final extracted Sex: ''
[05:55:40] ℹ️  Final extracted Service Line: 'Physical Therapy'
[05:55:40] ℹ️  Final extracted Payer Source: ''
[05:55:40] ✅ Patient data extraction completed successfully
[05:55:40] ✅    ✅ Patient data extracted successfully
[05:55:40] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:55:40] ✅    ✅ Patient identified: Maria Ferreira
[05:55:40] ✅    ✅ Patient name validation passed
[05:55:40] 🔄 
🔄 Step 3: Processing patient dates...
[05:55:40] [DOC: 9242003] ℹ️  DOB normalized: 09/29/1944
[05:55:40] [DOC: 9242003] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[05:55:40] [DOC: 9242003] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[05:55:40] [DOC: 9242003] ✅ Patient date processing completed successfully
[05:55:40] ✅    ✅ Date processing completed
[05:55:40] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'J18.9'}]
[05:55:40] 🔄 
🔄 Step 4: Extracting order data...
[05:55:42] ℹ️  Order extraction - MRN: 'MA221012094404'
[05:55:42] ℹ️  Order extraction - Sex: ''
[05:55:42] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[05:55:42] ℹ️  Order extraction - Payer Source: ''
[05:55:42] ✅ Order data extraction completed successfully
[05:55:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:55:42] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[05:55:42] ℹ️  Inferred sex as FEMALE from name: Maria
[05:55:42] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[05:55:42] ✅ Patient name cross-validation successful
[05:55:42] ✅    ✅ Data merged successfully
[05:55:44] ✅    ✅ Order data extracted and validated
[05:55:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:55:44] [DOC: 9242003] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[05:55:44] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[05:55:44] 🔄 
🔄 Step 6: Pushing order to API...
[05:55:44] [DOC: 9242003] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[05:55:45] [DOC: 9242003] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13987"}
[05:55:45] ❌    ❌ Failed to push order
[05:55:45] 🔄 
🔄 Step 7: Writing to CSV...
[05:55:45] [DOC: 9242003] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[05:55:45] [DOC: 9242003] ℹ️  Service Line extracted: 'Physical Therapy'
[05:55:45] [DOC: 9242003] ℹ️  Payer Source extracted: ''
[05:55:45] [DOC: 9242003] ℹ️  Diagnosis codes being written:
[05:55:45] [DOC: 9242003] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[05:55:45] [DOC: 9242003] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[05:55:45] [DOC: 9242003] ℹ️    - Latest_Episode_Thirddiagnosis: 'J18.9'
[05:55:45] [DOC: 9242003] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:55:45] [DOC: 9242003] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:55:45] [DOC: 9242003] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:55:45] [DOC: 9242003] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Physical Therapy | Payer:  | MRN: MA221012094404
[05:55:45] ✅    ✅ Document 9242003 processed and saved successfully
[05:55:45] 🔄 
🔄 Step 8: Saving API details...
[05:55:45] [DOC: 9242003] ℹ️  API push details saved for document 9242003
[05:55:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9242000                         ║
================================================================================
[05:55:45] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:55:45] ℹ️  Date: 04/15/2025
[05:55:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:55:51] [DOC: 9242000] ✅ Text extracted using pdfplumber (18673 chars)
[05:55:51] ✅    ✅ Text extracted using pdfplumber (18673 chars)
[05:55:51] 🔄 
🔄 Step 2: Extracting patient data...
[05:55:54] ℹ️  AI extracted raw sex value: 'F'
[05:55:54] ℹ️  AI extracted service line: 'PT'
[05:55:54] ℹ️  AI extracted payer source: ''
[05:55:54] ℹ️  AI extracted diagnoses:
[05:55:54] ℹ️    - Diagnosis 1: ''
[05:55:54] ℹ️    - Diagnosis 2: ''
[05:55:54] ℹ️    - Diagnosis 3: ''
[05:55:54] ℹ️    - Diagnosis 4: ''
[05:55:54] ℹ️    - Diagnosis 5: ''
[05:55:54] ℹ️    - Diagnosis 6: ''
[05:55:54] ℹ️  Final extracted MRN: 'MA221012094404'
[05:55:54] ℹ️  Final extracted Sex: 'FEMALE'
[05:55:54] ℹ️  Final extracted Service Line: 'PT'
[05:55:54] ℹ️  Final extracted Payer Source: ''
[05:55:54] ✅ Patient data extraction completed successfully
[05:55:54] ✅    ✅ Patient data extracted successfully
[05:55:54] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:55:54] ✅    ✅ Patient identified: Maria Ferreira
[05:55:54] ✅    ✅ Patient name validation passed
[05:55:54] 🔄 
🔄 Step 3: Processing patient dates...
[05:55:54] [DOC: 9242000] ℹ️  DOB normalized: 09/29/1944
[05:55:54] [DOC: 9242000] ℹ️  Episode startOfEpisode normalized: 04/10/2025
[05:55:54] [DOC: 9242000] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[05:55:54] [DOC: 9242000] ✅ Patient date processing completed successfully
[05:55:54] ✅    ✅ Date processing completed
[05:55:54] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:55:54] 🔄 
🔄 Step 4: Extracting order data...
[05:55:57] ℹ️  Order extraction - MRN: 'MA221012094404'
[05:55:57] ℹ️  Order extraction - Sex: 'FEMALE'
[05:55:57] ℹ️  Order extraction - Service Line: 'PT'
[05:55:57] ℹ️  Order extraction - Payer Source: ''
[05:55:57] ✅ Order data extraction completed successfully
[05:55:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:55:57] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[05:55:57] ℹ️  Service line consistent in both sources: 'PT'
[05:55:57] ✅ Patient name cross-validation successful
[05:55:57] ✅    ✅ Data merged successfully
[05:55:58] ✅    ✅ Order data extracted and validated
[05:55:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:55:58] [DOC: 9242000] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[05:55:58] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[05:55:58] 🔄 
🔄 Step 6: Pushing order to API...
[05:55:58] [DOC: 9242000] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[05:55:59] [DOC: 9242000] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:55:59] ❌    ❌ Failed to push order
[05:55:59] 🔄 
🔄 Step 7: Writing to CSV...
[05:55:59] [DOC: 9242000] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[05:55:59] [DOC: 9242000] ℹ️  Service Line extracted: 'PT'
[05:55:59] [DOC: 9242000] ℹ️  Payer Source extracted: ''
[05:55:59] [DOC: 9242000] ℹ️  Diagnosis codes being written:
[05:55:59] [DOC: 9242000] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:55:59] [DOC: 9242000] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:55:59] [DOC: 9242000] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:55:59] [DOC: 9242000] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:55:59] [DOC: 9242000] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:55:59] [DOC: 9242000] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:55:59] [DOC: 9242000] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: PT | Payer:  | MRN: MA221012094404
[05:55:59] ✅    ✅ Document 9242000 processed and saved successfully
[05:55:59] 🔄 
🔄 Step 8: Saving API details...
[05:55:59] [DOC: 9242000] ℹ️  API push details saved for document 9242000
[05:55:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9241998                         ║
================================================================================
[05:55:59] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:55:59] ℹ️  Date: 04/15/2025
[05:55:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:56:03] [DOC: 9241998] ✅ Text extracted using pdfplumber (11268 chars)
[05:56:03] ✅    ✅ Text extracted using pdfplumber (11256 chars)
[05:56:03] 🔄 
🔄 Step 2: Extracting patient data...
[05:56:07] ℹ️  AI extracted raw sex value: 'F'
[05:56:07] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:56:07] ℹ️  AI extracted payer source: 'Medicare'
[05:56:07] ℹ️  AI extracted diagnoses:
[05:56:07] ℹ️    - Diagnosis 1: 'I11.0'
[05:56:07] ℹ️    - Diagnosis 2: 'I50.33'
[05:56:07] ℹ️    - Diagnosis 3: 'J18.9'
[05:56:07] ℹ️    - Diagnosis 4: 'J40.'
[05:56:07] ℹ️    - Diagnosis 5: 'G20.A1'
[05:56:07] ℹ️    - Diagnosis 6: 'D50.9'
[05:56:07] ℹ️  Final extracted MRN: 'MA221012094404'
[05:56:07] ℹ️  Final extracted Sex: 'FEMALE'
[05:56:07] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:56:07] ℹ️  Final extracted Payer Source: 'Medicare'
[05:56:07] ✅ Patient data extraction completed successfully
[05:56:07] ✅    ✅ Patient data extracted successfully
[05:56:07] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 1881923936
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 24a Sun and Sea Dr
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ email: None
     └─ phoneNumber: (508) 801-1292
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': 'J40.', 'fifthDiagnosis': 'G20.A1', 'sixthDiagnosis': 'D50.9'}]
[05:56:07] ✅    ✅ Patient identified: Maria Ferreira
[05:56:07] ✅    ✅ Patient name validation passed
[05:56:07] 🔄 
🔄 Step 3: Processing patient dates...
[05:56:07] [DOC: 9241998] ℹ️  DOB normalized: 09/29/1944
[05:56:07] [DOC: 9241998] ℹ️  Episode startOfCare normalized: 03/31/2025
[05:56:07] [DOC: 9241998] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[05:56:07] [DOC: 9241998] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[05:56:07] [DOC: 9241998] ✅ Patient date processing completed successfully
[05:56:07] ✅    ✅ Date processing completed
[05:56:07] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Ferreira
     └─ dob: 09/29/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221012094404
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 1881923936
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 24a Sun and Sea Dr
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ phoneNumber: (508) 801-1292
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': 'J40.', 'fifthDiagnosis': 'G20.A1', 'sixthDiagnosis': 'D50.9'}]
[05:56:07] 🔄 
🔄 Step 4: Extracting order data...
[05:56:10] ℹ️  Order extraction - MRN: 'MA221012094404'
[05:56:10] ℹ️  Order extraction - Sex: 'FEMALE'
[05:56:10] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:56:10] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:56:10] ✅ Order data extraction completed successfully
[05:56:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:56:10] ℹ️  Using MRN from patient data: 'MA221012094404' over 'MA221012094404'
[05:56:10] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:56:10] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:56:10] ✅ Patient name cross-validation successful
[05:56:10] ✅    ✅ Data merged successfully
[05:56:11] ✅    ✅ Order data extracted and validated
[05:56:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:56:11] [DOC: 9241998] ✅ Patient found in local cache: Maria Ferreira, ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[05:56:11] ✅    ✅ Existing patient found with ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[05:56:11] 🔄 
🔄 Step 6: Pushing order to API...
[05:56:11] [DOC: 9241998] ℹ️  Pushing order via API for patient ID: cc9fb5a8-16ca-43cc-b2da-44f3ccc8cb29
[05:56:12] [DOC: 9241998] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13989"}
[05:56:12] ❌    ❌ Failed to push order
[05:56:12] 🔄 
🔄 Step 7: Writing to CSV...
[05:56:12] [DOC: 9241998] ℹ️  Calculated age: 80 from DOB: 09/29/1944
[05:56:12] [DOC: 9241998] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:56:12] [DOC: 9241998] ℹ️  Payer Source extracted: 'Medicare'
[05:56:12] [DOC: 9241998] ℹ️  Diagnosis codes being written:
[05:56:12] [DOC: 9241998] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[05:56:12] [DOC: 9241998] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[05:56:12] [DOC: 9241998] ℹ️    - Latest_Episode_Thirddiagnosis: 'J18.9'
[05:56:12] [DOC: 9241998] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J40.'
[05:56:12] [DOC: 9241998] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G20.A1'
[05:56:12] [DOC: 9241998] ℹ️    - Latest_Episode_Sixthdiagnosis: 'D50.9'
[05:56:12] [DOC: 9241998] ✅ Patient data written to CSV: Maria Ferreira | Sex: FEMALE | Age: 80 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: MA221012094404
[05:56:12] ✅    ✅ Document 9241998 processed and saved successfully
[05:56:12] 🔄 
🔄 Step 8: Saving API details...
[05:56:12] [DOC: 9241998] ℹ️  API push details saved for document 9241998
[05:56:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9241996                         ║
================================================================================
[05:56:12] ℹ️  Agency: AccentCare Fall River
[05:56:12] ℹ️  Date: 04/15/2025
[05:56:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:56:16] [DOC: 9241996] ✅ Text extracted using pdfplumber (1528 chars)
[05:56:16] ✅    ✅ Text extracted using pdfplumber (1528 chars)
[05:56:16] 🔄 
🔄 Step 2: Extracting patient data...
[05:56:19] ℹ️  AI extracted raw sex value: ''
[05:56:19] ℹ️  AI extracted service line: 'RN, LPN'
[05:56:19] ℹ️  AI extracted payer source: ''
[05:56:19] ℹ️  AI extracted diagnoses:
[05:56:19] ℹ️    - Diagnosis 1: 'None'
[05:56:19] ℹ️    - Diagnosis 2: 'None'
[05:56:19] ℹ️    - Diagnosis 3: 'None'
[05:56:19] ℹ️    - Diagnosis 4: 'None'
[05:56:19] ℹ️    - Diagnosis 5: 'None'
[05:56:19] ℹ️    - Diagnosis 6: 'None'
[05:56:19] ℹ️  Final extracted MRN: 'C0200049410901'
[05:56:19] ℹ️  Final extracted Sex: ''
[05:56:19] ℹ️  Final extracted Service Line: 'RN, LPN'
[05:56:19] ℹ️  Final extracted Payer Source: ''
[05:56:19] ✅ Patient data extraction completed successfully
[05:56:19] ✅    ✅ Patient data extracted successfully
[05:56:19] 📊 Patient Response
     └─ patientFName: JEFFREY
     └─ patientLName: STRANGER
     └─ dob: 04/20/1955
     └─ patientSex: 
     └─ medicalRecordNo: C0200049410901
     └─ billingProvider: NICHOLAS DEFUSCO, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 305 CEDAR ST, APT 1
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: RN, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '07/25/2024', 'endOfEpisode': '07/29/2024', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}, {'startOfCare': None, 'startOfEpisode': '03/01/2025', 'endOfEpisode': '03/06/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:56:19] ✅    ✅ Patient identified: JEFFREY STRANGER
[05:56:19] ✅    ✅ Patient name validation passed
[05:56:19] 🔄 
🔄 Step 3: Processing patient dates...
[05:56:19] [DOC: 9241996] ℹ️  DOB normalized: 04/20/1955
[05:56:19] [DOC: 9241996] ℹ️  Episode startOfEpisode normalized: 07/25/2024
[05:56:19] [DOC: 9241996] ℹ️  Episode endOfEpisode normalized: 07/29/2024
[05:56:19] [DOC: 9241996] ✅ Patient date processing completed successfully
[05:56:19] ✅    ✅ Date processing completed
[05:56:19] 📊 Processed Patient Data
     └─ patientFName: JEFFREY
     └─ patientLName: STRANGER
     └─ dob: 04/20/1955
     └─ patientSex: 
     └─ medicalRecordNo: C0200049410901
     └─ billingProvider: NICHOLAS DEFUSCO, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 305 CEDAR ST, APT 1
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508)996-3991
     └─ serviceLine: RN, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '07/25/2024', 'endOfEpisode': '07/29/2024'}, {'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '03/06/2025'}]
[05:56:19] 🔄 
🔄 Step 4: Extracting order data...
[05:56:22] ℹ️  Order extraction - MRN: 'C0200049410901'
[05:56:22] ℹ️  Order extraction - Sex: ''
[05:56:22] ℹ️  Order extraction - Service Line: ''
[05:56:22] ℹ️  Order extraction - Payer Source: ''
[05:56:22] ✅ Order data extraction completed successfully
[05:56:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:56:22] ℹ️  Using MRN from patient data: 'C0200049410901' over 'C0200049410901'
[05:56:22] ℹ️  Inferred sex as MALE from name: JEFFREY
[05:56:22] ℹ️  Using service line from patient data: 'RN, LPN'
[05:56:22] ✅ Patient name cross-validation successful
[05:56:22] ✅    ✅ Data merged successfully
[05:56:23] ✅    ✅ Order data extracted and validated
[05:56:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:56:23] [DOC: 9241996] ✅ Patient found in local cache: JEFFREY STRANGER, ID: 9debf551-628d-4ec0-82c5-037b0346a9b7
[05:56:23] ✅    ✅ Existing patient found with ID: 9debf551-628d-4ec0-82c5-037b0346a9b7
[05:56:23] 🔄 
🔄 Step 6: Pushing order to API...
[05:56:23] [DOC: 9241996] ℹ️  Pushing order via API for patient ID: 9debf551-628d-4ec0-82c5-037b0346a9b7
[05:56:24] [DOC: 9241996] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14454"}
[05:56:24] ❌    ❌ Failed to push order
[05:56:24] 🔄 
🔄 Step 7: Writing to CSV...
[05:56:24] [DOC: 9241996] ℹ️  Calculated age: 70 from DOB: 04/20/1955
[05:56:24] [DOC: 9241996] ℹ️  Service Line extracted: 'RN, LPN'
[05:56:24] [DOC: 9241996] ℹ️  Payer Source extracted: ''
[05:56:24] [DOC: 9241996] ℹ️  Diagnosis codes being written:
[05:56:24] [DOC: 9241996] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:56:24] [DOC: 9241996] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:56:24] [DOC: 9241996] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:56:24] [DOC: 9241996] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:56:24] [DOC: 9241996] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:56:24] [DOC: 9241996] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:56:24] [DOC: 9241996] ✅ Patient data written to CSV: JEFFREY STRANGER | Sex: MALE | Age: 70 | Service: RN, LPN | Payer:  | MRN: C0200049410901
[05:56:24] ✅    ✅ Document 9241996 processed and saved successfully
[05:56:24] 🔄 
🔄 Step 8: Saving API details...
[05:56:24] [DOC: 9241996] ℹ️  API push details saved for document 9241996
[05:56:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9241984                         ║
================================================================================
[05:56:24] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:56:24] ℹ️  Date: 04/15/2025
[05:56:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:56:27] [DOC: 9241984] ✅ Text extracted using pdfplumber (1673 chars)
[05:56:27] ✅    ✅ Text extracted using pdfplumber (1673 chars)
[05:56:27] 🔄 
🔄 Step 2: Extracting patient data...
[05:56:30] ℹ️  AI extracted raw sex value: ''
[05:56:30] ℹ️  AI extracted service line: 'Physical Therapy'
[05:56:30] ℹ️  AI extracted payer source: ''
[05:56:30] ℹ️  AI extracted diagnoses:
[05:56:30] ℹ️    - Diagnosis 1: 'I69.351'
[05:56:30] ℹ️    - Diagnosis 2: 'E87.6'
[05:56:30] ℹ️    - Diagnosis 3: 'G35'
[05:56:30] ℹ️    - Diagnosis 4: 'None'
[05:56:30] ℹ️    - Diagnosis 5: 'None'
[05:56:30] ℹ️    - Diagnosis 6: 'None'
[05:56:30] ℹ️  Final extracted MRN: 'MA220701015501'
[05:56:30] ℹ️  Final extracted Sex: ''
[05:56:30] ℹ️  Final extracted Service Line: 'Physical Therapy'
[05:56:30] ℹ️  Final extracted Payer Source: ''
[05:56:30] ✅ Patient data extraction completed successfully
[05:56:30] ✅    ✅ Patient data extracted successfully
[05:56:30] 📊 Patient Response
     └─ patientFName: Ada
     └─ patientLName: Burns
     └─ dob: 01/15/1955
     └─ patientSex: 
     └─ medicalRecordNo: MA220701015501
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'I69.351', 'secondDiagnosis': 'E87.6', 'thirdDiagnosis': 'G35', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:56:30] ✅    ✅ Patient identified: Ada Burns
[05:56:30] ✅    ✅ Patient name validation passed
[05:56:30] 🔄 
🔄 Step 3: Processing patient dates...
[05:56:30] [DOC: 9241984] ℹ️  DOB normalized: 01/15/1955
[05:56:30] [DOC: 9241984] ℹ️  Episode startOfEpisode normalized: 02/20/2025
[05:56:30] [DOC: 9241984] ℹ️  Episode endOfEpisode normalized: 04/20/2025
[05:56:30] [DOC: 9241984] ✅ Patient date processing completed successfully
[05:56:30] ✅    ✅ Date processing completed
[05:56:30] 📊 Processed Patient Data
     └─ patientFName: Ada
     └─ patientLName: Burns
     └─ dob: 01/15/1955
     └─ patientSex: 
     └─ medicalRecordNo: MA220701015501
     └─ billingProvider: KARINE MAALOUF-KALESHIAN MD
     └─ npi: 1114903663
     └─ physicianNPI: 1114903663
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'I69.351', 'secondDiagnosis': 'E87.6', 'thirdDiagnosis': 'G35'}]
[05:56:30] 🔄 
🔄 Step 4: Extracting order data...
[05:56:33] ℹ️  Order extraction - MRN: 'MA220701015501'
[05:56:33] ℹ️  Order extraction - Sex: ''
[05:56:33] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[05:56:33] ℹ️  Order extraction - Payer Source: ''
[05:56:33] ✅ Order data extraction completed successfully
[05:56:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:56:33] ℹ️  Using MRN from patient data: 'MA220701015501' over 'MA220701015501'
[05:56:33] ⚠️  Could not determine sex using any available method
[05:56:33] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[05:56:33] ✅ Patient name cross-validation successful
[05:56:33] ✅    ✅ Data merged successfully
[05:56:34] ✅    ✅ Order data extracted and validated
[05:56:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:56:34] [DOC: 9241984] ✅ Patient found in local cache: Ada Burns, ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[05:56:34] ✅    ✅ Existing patient found with ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[05:56:34] 🔄 
🔄 Step 6: Pushing order to API...
[05:56:34] [DOC: 9241984] ℹ️  Pushing order via API for patient ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[05:56:35] [DOC: 9241984] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13417"}
[05:56:35] ❌    ❌ Failed to push order
[05:56:35] 🔄 
🔄 Step 7: Writing to CSV...
[05:56:35] [DOC: 9241984] ℹ️  Calculated age: 70 from DOB: 01/15/1955
[05:56:35] [DOC: 9241984] ℹ️  Service Line extracted: 'Physical Therapy'
[05:56:35] [DOC: 9241984] ℹ️  Payer Source extracted: ''
[05:56:35] [DOC: 9241984] ℹ️  Diagnosis codes being written:
[05:56:35] [DOC: 9241984] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69.351'
[05:56:35] [DOC: 9241984] ℹ️    - Latest_Episode_Seconddiagnosis: 'E87.6'
[05:56:35] [DOC: 9241984] ℹ️    - Latest_Episode_Thirddiagnosis: 'G35'
[05:56:35] [DOC: 9241984] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:56:35] [DOC: 9241984] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:56:35] [DOC: 9241984] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:56:35] [DOC: 9241984] ✅ Patient data written to CSV: Ada Burns | Sex:  | Age: 70 | Service: Physical Therapy | Payer:  | MRN: MA220701015501
[05:56:35] ✅    ✅ Document 9241984 processed and saved successfully
[05:56:35] 🔄 
🔄 Step 8: Saving API details...
[05:56:35] [DOC: 9241984] ℹ️  API push details saved for document 9241984
[05:56:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9241983                         ║
================================================================================
[05:56:35] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:56:35] ℹ️  Date: 04/15/2025
[05:56:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:56:40] [DOC: 9241983] ✅ Text extracted using pdfplumber (12333 chars)
[05:56:40] ✅    ✅ Text extracted using pdfplumber (12333 chars)
[05:56:40] 🔄 
🔄 Step 2: Extracting patient data...
[05:56:43] ℹ️  AI extracted raw sex value: 'F'
[05:56:43] ℹ️  AI extracted service line: 'OT'
[05:56:43] ℹ️  AI extracted payer source: 'None'
[05:56:43] ℹ️  AI extracted diagnoses:
[05:56:43] ℹ️    - Diagnosis 1: 'None'
[05:56:43] ℹ️    - Diagnosis 2: 'None'
[05:56:43] ℹ️    - Diagnosis 3: 'None'
[05:56:43] ℹ️    - Diagnosis 4: 'None'
[05:56:43] ℹ️    - Diagnosis 5: 'None'
[05:56:43] ℹ️    - Diagnosis 6: 'None'
[05:56:43] ℹ️  Final extracted MRN: 'MA220701015501'
[05:56:43] ℹ️  Final extracted Sex: 'FEMALE'
[05:56:43] ℹ️  Final extracted Service Line: 'OT'
[05:56:43] ℹ️  Final extracted Payer Source: ''
[05:56:43] ✅ Patient data extraction completed successfully
[05:56:43] ✅    ✅ Patient data extracted successfully
[05:56:43] 📊 Patient Response
     └─ patientFName: Ada
     └─ patientLName: Burns
     └─ dob: 01/15/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220701015501
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '07/12/2022', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:56:43] ✅    ✅ Patient identified: Ada Burns
[05:56:43] ✅    ✅ Patient name validation passed
[05:56:43] 🔄 
🔄 Step 3: Processing patient dates...
[05:56:43] [DOC: 9241983] ℹ️  DOB normalized: 01/15/1955
[05:56:43] [DOC: 9241983] ℹ️  Episode startOfEpisode normalized: 07/12/2022
[05:56:43] [DOC: 9241983] ✅ Patient date processing completed successfully
[05:56:43] ✅    ✅ Date processing completed
[05:56:43] 📊 Processed Patient Data
     └─ patientFName: Ada
     └─ patientLName: Burns
     └─ dob: 01/15/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220701015501
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '07/12/2022'}]
[05:56:43] 🔄 
🔄 Step 4: Extracting order data...
[05:56:46] ℹ️  Order extraction - MRN: 'MA220701015501'
[05:56:46] ℹ️  Order extraction - Sex: 'FEMALE'
[05:56:46] ℹ️  Order extraction - Service Line: 'OT'
[05:56:46] ℹ️  Order extraction - Payer Source: ''
[05:56:46] ✅ Order data extraction completed successfully
[05:56:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:56:46] ℹ️  Using MRN from patient data: 'MA220701015501' over 'MA220701015501'
[05:56:46] ℹ️  Service line consistent in both sources: 'OT'
[05:56:46] ✅ Patient name cross-validation successful
[05:56:46] ✅    ✅ Data merged successfully
[05:56:48] ✅    ✅ Order data extracted and validated
[05:56:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:56:48] [DOC: 9241983] ✅ Patient found in local cache: Ada Burns, ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[05:56:48] ✅    ✅ Existing patient found with ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[05:56:48] 🔄 
🔄 Step 6: Pushing order to API...
[05:56:48] [DOC: 9241983] ℹ️  Pushing order via API for patient ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[05:56:49] [DOC: 9241983] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:56:49] ❌    ❌ Failed to push order
[05:56:49] 🔄 
🔄 Step 7: Writing to CSV...
[05:56:49] [DOC: 9241983] ℹ️  Calculated age: 70 from DOB: 01/15/1955
[05:56:49] [DOC: 9241983] ℹ️  Service Line extracted: 'OT'
[05:56:49] [DOC: 9241983] ℹ️  Payer Source extracted: ''
[05:56:49] [DOC: 9241983] ℹ️  Diagnosis codes being written:
[05:56:49] [DOC: 9241983] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:56:49] [DOC: 9241983] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:56:49] [DOC: 9241983] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:56:49] [DOC: 9241983] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:56:49] [DOC: 9241983] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:56:49] [DOC: 9241983] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:56:49] [DOC: 9241983] ✅ Patient data written to CSV: Ada Burns | Sex: FEMALE | Age: 70 | Service: OT | Payer:  | MRN: MA220701015501
[05:56:49] ✅    ✅ Document 9241983 processed and saved successfully
[05:56:49] 🔄 
🔄 Step 8: Saving API details...
[05:56:49] [DOC: 9241983] ℹ️  API push details saved for document 9241983
[05:56:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9241982                         ║
================================================================================
[05:56:49] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:56:49] ℹ️  Date: 04/15/2025
[05:56:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:56:52] [DOC: 9241982] ✅ Text extracted using pdfplumber (15767 chars)
[05:56:52] ✅    ✅ Text extracted using pdfplumber (15767 chars)
[05:56:52] 🔄 
🔄 Step 2: Extracting patient data...
[05:56:55] ℹ️  AI extracted raw sex value: 'F'
[05:56:55] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:56:55] ℹ️  AI extracted payer source: 'None'
[05:56:55] ℹ️  AI extracted diagnoses:
[05:56:55] ℹ️    - Diagnosis 1: 'I69351'
[05:56:55] ℹ️    - Diagnosis 2: 'E876'
[05:56:55] ℹ️    - Diagnosis 3: 'None'
[05:56:55] ℹ️    - Diagnosis 4: 'None'
[05:56:55] ℹ️    - Diagnosis 5: 'None'
[05:56:55] ℹ️    - Diagnosis 6: 'None'
[05:56:55] ℹ️  Final extracted MRN: 'MA220701015501'
[05:56:55] ℹ️  Final extracted Sex: 'FEMALE'
[05:56:55] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:56:55] ℹ️  Final extracted Payer Source: ''
[05:56:55] ✅ Patient data extraction completed successfully
[05:56:55] ✅    ✅ Patient data extracted successfully
[05:56:55] 📊 Patient Response
     └─ patientFName: Ada
     └─ patientLName: Burns
     └─ dob: 01/15/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220701015501
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'I69351', 'secondDiagnosis': 'E876', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:56:55] ✅    ✅ Patient identified: Ada Burns
[05:56:55] ✅    ✅ Patient name validation passed
[05:56:55] 🔄 
🔄 Step 3: Processing patient dates...
[05:56:55] [DOC: 9241982] ℹ️  DOB normalized: 01/15/1955
[05:56:55] [DOC: 9241982] ℹ️  Episode startOfEpisode normalized: 02/20/2025
[05:56:55] [DOC: 9241982] ℹ️  Episode endOfEpisode normalized: 04/20/2025
[05:56:55] [DOC: 9241982] ✅ Patient date processing completed successfully
[05:56:55] ✅    ✅ Date processing completed
[05:56:55] 📊 Processed Patient Data
     └─ patientFName: Ada
     └─ patientLName: Burns
     └─ dob: 01/15/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA220701015501
     └─ billingProvider: Dr. Maalouf-Kaleshian
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/20/2025', 'endOfEpisode': '04/20/2025', 'firstDiagnosis': 'I69351', 'secondDiagnosis': 'E876'}]
[05:56:55] 🔄 
🔄 Step 4: Extracting order data...
[05:56:58] ℹ️  Order extraction - MRN: 'MA220701015501'
[05:56:58] ℹ️  Order extraction - Sex: 'FEMALE'
[05:56:58] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:56:58] ℹ️  Order extraction - Payer Source: ''
[05:56:58] ✅ Order data extraction completed successfully
[05:56:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:56:58] ℹ️  Using MRN from patient data: 'MA220701015501' over 'MA220701015501'
[05:56:58] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:56:58] ✅ Patient name cross-validation successful
[05:56:58] ✅    ✅ Data merged successfully
[05:56:59] ✅    ✅ Order data extracted and validated
[05:56:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:56:59] [DOC: 9241982] ✅ Patient found in local cache: Ada Burns, ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[05:56:59] ✅    ✅ Existing patient found with ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[05:56:59] 🔄 
🔄 Step 6: Pushing order to API...
[05:56:59] [DOC: 9241982] ℹ️  Pushing order via API for patient ID: 89dadd4e-d263-4f68-9cc6-10cd636def87
[05:57:00] [DOC: 9241982] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13418"}
[05:57:00] ❌    ❌ Failed to push order
[05:57:00] 🔄 
🔄 Step 7: Writing to CSV...
[05:57:00] [DOC: 9241982] ℹ️  Calculated age: 70 from DOB: 01/15/1955
[05:57:00] [DOC: 9241982] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:57:00] [DOC: 9241982] ℹ️  Payer Source extracted: ''
[05:57:00] [DOC: 9241982] ℹ️  Diagnosis codes being written:
[05:57:00] [DOC: 9241982] ℹ️    - Latest_Episode_Firstdiagnosis: 'I69351'
[05:57:00] [DOC: 9241982] ℹ️    - Latest_Episode_Seconddiagnosis: 'E876'
[05:57:00] [DOC: 9241982] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:57:00] [DOC: 9241982] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:57:00] [DOC: 9241982] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:57:00] [DOC: 9241982] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:57:00] [DOC: 9241982] ✅ Patient data written to CSV: Ada Burns | Sex: FEMALE | Age: 70 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: MA220701015501
[05:57:00] ✅    ✅ Document 9241982 processed and saved successfully
[05:57:00] 🔄 
🔄 Step 8: Saving API details...
[05:57:00] [DOC: 9241982] ℹ️  API push details saved for document 9241982
[05:57:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9241899                         ║
================================================================================
[05:57:00] ℹ️  Agency: AccentCare Fall River
[05:57:00] ℹ️  Date: 04/15/2025
[05:57:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:57:04] [DOC: 9241899] ✅ Text extracted using pdfplumber (20608 chars)
[05:57:04] ✅    ✅ Text extracted using pdfplumber (20524 chars)
[05:57:04] 🔄 
🔄 Step 2: Extracting patient data...
[05:57:07] ℹ️  AI extracted raw sex value: 'F'
[05:57:07] ℹ️  AI extracted service line: 'Physical Therapy'
[05:57:07] ℹ️  AI extracted payer source: 'Medicare'
[05:57:07] ℹ️  AI extracted diagnoses:
[05:57:07] ℹ️    - Diagnosis 1: 'I69.398'
[05:57:07] ℹ️    - Diagnosis 2: 'M62.81'
[05:57:07] ℹ️    - Diagnosis 3: 'I12.9'
[05:57:07] ℹ️    - Diagnosis 4: 'N18.2'
[05:57:07] ℹ️    - Diagnosis 5: 'F03.94'
[05:57:07] ℹ️    - Diagnosis 6: 'F03.93'
[05:57:07] ℹ️  Final extracted MRN: 'C0200178585001'
[05:57:07] ℹ️  Final extracted Sex: 'FEMALE'
[05:57:07] ℹ️  Final extracted Service Line: 'Physical Therapy'
[05:57:07] ℹ️  Final extracted Payer Source: 'Medicare'
[05:57:07] ✅ Patient data extraction completed successfully
[05:57:07] ✅    ✅ Patient data extracted successfully
[05:57:07] 📊 Patient Response
     └─ patientFName: DIANA
     └─ patientLName: DUARTE
     └─ dob: 07/31/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200178585001
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: None
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'N18.2', 'fifthDiagnosis': 'F03.94', 'sixthDiagnosis': 'F03.93'}]
[05:57:07] ✅    ✅ Patient identified: DIANA DUARTE
[05:57:07] ✅    ✅ Patient name validation passed
[05:57:07] 🔄 
🔄 Step 3: Processing patient dates...
[05:57:07] [DOC: 9241899] ℹ️  DOB normalized: 07/31/1939
[05:57:07] [DOC: 9241899] ℹ️  Episode startOfCare normalized: 04/04/2025
[05:57:07] [DOC: 9241899] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[05:57:07] [DOC: 9241899] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[05:57:07] [DOC: 9241899] ✅ Patient date processing completed successfully
[05:57:07] ✅    ✅ Date processing completed
[05:57:07] 📊 Processed Patient Data
     └─ patientFName: DIANA
     └─ patientLName: DUARTE
     └─ dob: 07/31/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: C0200178585001
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'I69.398', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'I12.9', 'fourthDiagnosis': 'N18.2', 'fifthDiagnosis': 'F03.94', 'sixthDiagnosis': 'F03.93'}]
[05:57:07] 🔄 
🔄 Step 4: Extracting order data...
[05:57:10] ℹ️  Order extraction - MRN: '227203'
[05:57:10] ℹ️  Order extraction - Sex: 'FEMALE'
[05:57:10] ℹ️  Order extraction - Service Line: 'PT'
[05:57:10] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:57:10] ✅ Order data extraction completed successfully
[05:57:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:57:10] ℹ️  Using MRN from patient data: 'C0200178585001' over '227203'
[05:57:10] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[05:57:10] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:57:10] ✅ Patient name cross-validation successful
[05:57:10] ✅    ✅ Data merged successfully
[05:57:12] ✅    ✅ Order data extracted and validated
[05:57:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:57:19] [DOC: 9241899] ℹ️  Patient not found in cache or API: DIANA DUARTE
[05:57:19] [DOC: 9241899] ℹ️  Patient not found, creating new patient via API...
[05:57:19] [DOC: 9241899] ℹ️  Creating patient via API: DIANA DUARTE
[05:57:20] [DOC: 9241899] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:57:20] ❌    ❌ Failed to create patient
[05:57:20] [DOC: 9241899] ℹ️  API push details saved for document 9241899
================================================================================
║                        Processing Document ID: 9241437                         ║
================================================================================
[05:57:20] ℹ️  Agency: Dartmouth HH
[05:57:20] ℹ️  Date: 04/15/2025
[05:57:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:57:22] [DOC: 9241437] ✅ Text extracted using pdfplumber (1506 chars)
[05:57:22] ✅    ✅ Text extracted using pdfplumber (1506 chars)
[05:57:22] 🔄 
🔄 Step 2: Extracting patient data...
[05:57:24] ℹ️  AI extracted raw sex value: 'F'
[05:57:24] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:57:24] ℹ️  AI extracted payer source: 'Medicare'
[05:57:24] ℹ️  AI extracted diagnoses:
[05:57:24] ℹ️    - Diagnosis 1: ''
[05:57:24] ℹ️    - Diagnosis 2: ''
[05:57:24] ℹ️    - Diagnosis 3: ''
[05:57:24] ℹ️    - Diagnosis 4: ''
[05:57:24] ℹ️    - Diagnosis 5: ''
[05:57:24] ℹ️    - Diagnosis 6: ''
[05:57:24] ℹ️  Final extracted MRN: '5496011'
[05:57:24] ℹ️  Final extracted Sex: 'FEMALE'
[05:57:24] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:57:24] ℹ️  Final extracted Payer Source: 'Medicare'
[05:57:24] ✅ Patient data extraction completed successfully
[05:57:24] ✅    ✅ Patient data extracted successfully
[05:57:24] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Leclair
     └─ dob: 08/17/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5496011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '03/08/2025', 'endOfEpisode': '05/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:57:24] ✅    ✅ Patient identified: Donna Leclair
[05:57:24] ✅    ✅ Patient name validation passed
[05:57:24] 🔄 
🔄 Step 3: Processing patient dates...
[05:57:24] [DOC: 9241437] ℹ️  DOB normalized: 08/17/1950
[05:57:24] [DOC: 9241437] ℹ️  Episode startOfCare normalized: 03/08/2025
[05:57:24] [DOC: 9241437] ℹ️  Episode startOfEpisode normalized: 03/08/2025
[05:57:24] [DOC: 9241437] ℹ️  Episode endOfEpisode normalized: 05/06/2025
[05:57:24] [DOC: 9241437] ✅ Patient date processing completed successfully
[05:57:24] ✅    ✅ Date processing completed
[05:57:24] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Leclair
     └─ dob: 08/17/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5496011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '03/08/2025', 'endOfEpisode': '05/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:57:24] 🔄 
🔄 Step 4: Extracting order data...
[05:57:27] ℹ️  Order extraction - MRN: '5496011'
[05:57:27] ℹ️  Order extraction - Sex: 'FEMALE'
[05:57:27] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:57:27] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:57:27] ✅ Order data extraction completed successfully
[05:57:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:57:27] ℹ️  Using MRN from patient data: '5496011' over '5496011'
[05:57:27] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:57:27] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:57:27] ✅ Patient name cross-validation successful
[05:57:27] ✅    ✅ Data merged successfully
[05:57:28] ✅    ✅ Order data extracted and validated
[05:57:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:57:28] [DOC: 9241437] ✅ Patient found in local cache: Donna Leclair, ID: fb4435a9-b3ea-490a-98e0-c6f0ea1f5826
[05:57:28] ✅    ✅ Existing patient found with ID: fb4435a9-b3ea-490a-98e0-c6f0ea1f5826
[05:57:28] 🔄 
🔄 Step 6: Pushing order to API...
[05:57:28] [DOC: 9241437] ℹ️  Pushing order via API for patient ID: fb4435a9-b3ea-490a-98e0-c6f0ea1f5826
[05:57:29] [DOC: 9241437] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:57:29] ❌    ❌ Failed to push order
[05:57:29] 🔄 
🔄 Step 7: Writing to CSV...
[05:57:29] [DOC: 9241437] ℹ️  Calculated age: 74 from DOB: 08/17/1950
[05:57:29] [DOC: 9241437] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:57:29] [DOC: 9241437] ℹ️  Payer Source extracted: 'Medicare'
[05:57:29] [DOC: 9241437] ℹ️  Diagnosis codes being written:
[05:57:29] [DOC: 9241437] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:57:29] [DOC: 9241437] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:57:29] [DOC: 9241437] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:57:29] [DOC: 9241437] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:57:29] [DOC: 9241437] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:57:29] [DOC: 9241437] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:57:29] [DOC: 9241437] ✅ Patient data written to CSV: Donna Leclair | Sex: FEMALE | Age: 74 | Service: Skilled Nursing | Payer: Medicare | MRN: 5496011
[05:57:29] ✅    ✅ Document 9241437 processed and saved successfully
[05:57:29] 🔄 
🔄 Step 8: Saving API details...
[05:57:29] [DOC: 9241437] ℹ️  API push details saved for document 9241437
[05:57:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9241430                         ║
================================================================================
[05:57:29] ℹ️  Agency: Dartmouth HH
[05:57:29] ℹ️  Date: 04/15/2025
[05:57:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:57:31] [DOC: 9241430] ✅ Text extracted using pdfplumber (1307 chars)
[05:57:31] ✅    ✅ Text extracted using pdfplumber (1307 chars)
[05:57:31] 🔄 
🔄 Step 2: Extracting patient data...
[05:57:34] ℹ️  AI extracted raw sex value: 'F'
[05:57:34] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:57:34] ℹ️  AI extracted payer source: 'Medicare'
[05:57:34] ℹ️  AI extracted diagnoses:
[05:57:34] ℹ️    - Diagnosis 1: ''
[05:57:34] ℹ️    - Diagnosis 2: ''
[05:57:34] ℹ️    - Diagnosis 3: ''
[05:57:34] ℹ️    - Diagnosis 4: ''
[05:57:34] ℹ️    - Diagnosis 5: ''
[05:57:34] ℹ️    - Diagnosis 6: ''
[05:57:34] ℹ️  Final extracted MRN: '3684011'
[05:57:34] ℹ️  Final extracted Sex: 'FEMALE'
[05:57:34] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:57:34] ℹ️  Final extracted Payer Source: 'Medicare'
[05:57:34] ✅ Patient data extraction completed successfully
[05:57:34] ✅    ✅ Patient data extracted successfully
[05:57:34] 📊 Patient Response
     └─ patientFName: Frances
     └─ patientLName: Levin
     └─ dob: 01/16/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3684011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/28/2024', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:57:34] ✅    ✅ Patient identified: Frances Levin
[05:57:34] ✅    ✅ Patient name validation passed
[05:57:34] 🔄 
🔄 Step 3: Processing patient dates...
[05:57:34] [DOC: 9241430] ℹ️  DOB normalized: 01/16/1935
[05:57:34] [DOC: 9241430] ℹ️  Episode startOfCare normalized: 06/28/2024
[05:57:34] [DOC: 9241430] ℹ️  Episode startOfEpisode normalized: 02/23/2025
[05:57:34] [DOC: 9241430] ℹ️  Episode endOfEpisode normalized: 04/23/2025
[05:57:34] [DOC: 9241430] ✅ Patient date processing completed successfully
[05:57:34] ✅    ✅ Date processing completed
[05:57:34] 📊 Processed Patient Data
     └─ patientFName: Frances
     └─ patientLName: Levin
     └─ dob: 01/16/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3684011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/28/2024', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:57:34] 🔄 
🔄 Step 4: Extracting order data...
[05:57:36] ℹ️  Order extraction - MRN: ''
[05:57:36] ℹ️  Order extraction - Sex: 'FEMALE'
[05:57:36] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:57:36] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:57:36] ✅ Order data extraction completed successfully
[05:57:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:57:36] ℹ️  Using MRN from patient data: '3684011'
[05:57:36] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:57:36] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:57:36] ✅ Patient name cross-validation successful
[05:57:36] ✅    ✅ Data merged successfully
[05:57:37] ✅    ✅ Order data extracted and validated
[05:57:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:57:42] [DOC: 9241430] ℹ️  Patient not found in cache or API: Frances Levin
[05:57:42] [DOC: 9241430] ℹ️  Patient not found, creating new patient via API...
[05:57:42] [DOC: 9241430] ℹ️  Creating patient via API: Frances Levin
[05:57:44] [DOC: 9241430] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:57:44] ❌    ❌ Failed to create patient
[05:57:44] [DOC: 9241430] ℹ️  API push details saved for document 9241430
================================================================================
║                        Processing Document ID: 9241428                         ║
================================================================================
[05:57:44] ℹ️  Agency: Dartmouth HH
[05:57:44] ℹ️  Date: 04/15/2025
[05:57:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:57:46] [DOC: 9241428] ✅ Text extracted using pdfplumber (1206 chars)
[05:57:46] ✅    ✅ Text extracted using pdfplumber (1206 chars)
[05:57:46] 🔄 
🔄 Step 2: Extracting patient data...
[05:57:48] ℹ️  AI extracted raw sex value: 'M'
[05:57:48] ℹ️  AI extracted service line: 'RN, LPN'
[05:57:48] ℹ️  AI extracted payer source: 'Medicare'
[05:57:48] ℹ️  AI extracted diagnoses:
[05:57:48] ℹ️    - Diagnosis 1: ''
[05:57:48] ℹ️    - Diagnosis 2: ''
[05:57:48] ℹ️    - Diagnosis 3: ''
[05:57:48] ℹ️    - Diagnosis 4: ''
[05:57:48] ℹ️    - Diagnosis 5: ''
[05:57:48] ℹ️    - Diagnosis 6: ''
[05:57:48] ℹ️  Final extracted MRN: '3778011'
[05:57:48] ℹ️  Final extracted Sex: 'MALE'
[05:57:48] ℹ️  Final extracted Service Line: 'RN, LPN'
[05:57:48] ℹ️  Final extracted Payer Source: 'Medicare'
[05:57:48] ✅ Patient data extraction completed successfully
[05:57:48] ✅    ✅ Patient data extracted successfully
[05:57:48] 📊 Patient Response
     └─ patientFName: Roy
     └─ patientLName: Saulnier
     └─ dob: 10/26/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 3778011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 25 Stephen Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/07/2024', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:57:48] ✅    ✅ Patient identified: Roy Saulnier
[05:57:48] ✅    ✅ Patient name validation passed
[05:57:48] 🔄 
🔄 Step 3: Processing patient dates...
[05:57:48] [DOC: 9241428] ℹ️  DOB normalized: 10/26/1936
[05:57:48] [DOC: 9241428] ℹ️  Episode startOfCare normalized: 08/07/2024
[05:57:48] [DOC: 9241428] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[05:57:48] [DOC: 9241428] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[05:57:48] [DOC: 9241428] ✅ Patient date processing completed successfully
[05:57:48] ✅    ✅ Date processing completed
[05:57:48] 📊 Processed Patient Data
     └─ patientFName: Roy
     └─ patientLName: Saulnier
     └─ dob: 10/26/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 3778011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 25 Stephen Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/07/2024', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:57:48] 🔄 
🔄 Step 4: Extracting order data...
[05:57:51] ℹ️  Order extraction - MRN: ''
[05:57:51] ℹ️  Order extraction - Sex: 'MALE'
[05:57:51] ℹ️  Order extraction - Service Line: 'RN, LPN'
[05:57:51] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:57:51] ✅ Order data extraction completed successfully
[05:57:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:57:51] ℹ️  Using MRN from patient data: '3778011'
[05:57:51] ℹ️  Service line consistent in both sources: 'RN, LPN'
[05:57:51] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:57:51] ✅ Patient name cross-validation successful
[05:57:51] ✅    ✅ Data merged successfully
[05:57:52] ✅    ✅ Order data extracted and validated
[05:57:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:58:00] [DOC: 9241428] ✅ Patient exists in API: Roy Saulnier, ID: 470463a7-b0e4-4597-a3f7-6eaf2dc13d57
[05:58:00] ✅    ✅ Existing patient found with ID: 470463a7-b0e4-4597-a3f7-6eaf2dc13d57
[05:58:00] 🔄 
🔄 Step 6: Pushing order to API...
[05:58:00] [DOC: 9241428] ℹ️  Pushing order via API for patient ID: 470463a7-b0e4-4597-a3f7-6eaf2dc13d57
[05:58:01] [DOC: 9241428] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:58:01] ❌    ❌ Failed to push order
[05:58:01] 🔄 
🔄 Step 7: Writing to CSV...
[05:58:01] [DOC: 9241428] ℹ️  Calculated age: 88 from DOB: 10/26/1936
[05:58:01] [DOC: 9241428] ℹ️  Service Line extracted: 'RN, LPN'
[05:58:01] [DOC: 9241428] ℹ️  Payer Source extracted: 'Medicare'
[05:58:01] [DOC: 9241428] ℹ️  Diagnosis codes being written:
[05:58:01] [DOC: 9241428] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:58:01] [DOC: 9241428] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:58:01] [DOC: 9241428] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:58:01] [DOC: 9241428] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:58:01] [DOC: 9241428] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:58:01] [DOC: 9241428] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:58:01] [DOC: 9241428] ✅ Patient data written to CSV: Roy Saulnier | Sex: MALE | Age: 88 | Service: RN, LPN | Payer: Medicare | MRN: 3778011
[05:58:01] ✅    ✅ Document 9241428 processed and saved successfully
[05:58:01] 🔄 
🔄 Step 8: Saving API details...
[05:58:01] [DOC: 9241428] ℹ️  API push details saved for document 9241428
[05:58:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9241423                         ║
================================================================================
[05:58:01] ℹ️  Agency: Dartmouth HH
[05:58:01] ℹ️  Date: 04/15/2025
[05:58:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:58:03] [DOC: 9241423] ✅ Text extracted using pdfplumber (1196 chars)
[05:58:03] ✅    ✅ Text extracted using pdfplumber (1196 chars)
[05:58:03] 🔄 
🔄 Step 2: Extracting patient data...
[05:58:06] ℹ️  AI extracted raw sex value: 'F'
[05:58:06] ℹ️  AI extracted service line: 'RN, LPN'
[05:58:06] ℹ️  AI extracted payer source: 'Medicare'
[05:58:06] ℹ️  AI extracted diagnoses:
[05:58:06] ℹ️    - Diagnosis 1: 'None'
[05:58:06] ℹ️    - Diagnosis 2: 'None'
[05:58:06] ℹ️    - Diagnosis 3: 'None'
[05:58:06] ℹ️    - Diagnosis 4: 'None'
[05:58:06] ℹ️    - Diagnosis 5: 'None'
[05:58:06] ℹ️    - Diagnosis 6: 'None'
[05:58:06] ℹ️  Final extracted MRN: '5915015'
[05:58:06] ℹ️  Final extracted Sex: 'FEMALE'
[05:58:06] ℹ️  Final extracted Service Line: 'RN, LPN'
[05:58:06] ℹ️  Final extracted Payer Source: 'Medicare'
[05:58:06] ✅ Patient data extraction completed successfully
[05:58:06] ✅    ✅ Patient data extracted successfully
[05:58:06] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:58:06] ✅    ✅ Patient identified: Suzanne Fawcett
[05:58:06] ✅    ✅ Patient name validation passed
[05:58:06] 🔄 
🔄 Step 3: Processing patient dates...
[05:58:06] [DOC: 9241423] ℹ️  DOB normalized: 12/08/1939
[05:58:06] [DOC: 9241423] ℹ️  Episode startOfCare normalized: 01/26/2025
[05:58:06] [DOC: 9241423] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[05:58:06] [DOC: 9241423] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[05:58:06] [DOC: 9241423] ✅ Patient date processing completed successfully
[05:58:06] ✅    ✅ Date processing completed
[05:58:06] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025'}]
[05:58:06] 🔄 
🔄 Step 4: Extracting order data...
[05:58:08] ℹ️  Order extraction - MRN: ''
[05:58:08] ℹ️  Order extraction - Sex: 'FEMALE'
[05:58:08] ℹ️  Order extraction - Service Line: 'RN, LPN'
[05:58:08] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:58:08] ✅ Order data extraction completed successfully
[05:58:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:58:08] ℹ️  Using MRN from patient data: '5915015'
[05:58:08] ℹ️  Service line consistent in both sources: 'RN, LPN'
[05:58:08] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:58:08] ✅ Patient name cross-validation successful
[05:58:08] ✅    ✅ Data merged successfully
[05:58:09] ✅    ✅ Order data extracted and validated
[05:58:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:58:14] [DOC: 9241423] ℹ️  Patient not found in cache or API: Suzanne Fawcett
[05:58:14] [DOC: 9241423] ℹ️  Patient not found, creating new patient via API...
[05:58:14] [DOC: 9241423] ℹ️  Creating patient via API: Suzanne Fawcett
[05:58:15] [DOC: 9241423] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:58:15] ❌    ❌ Failed to create patient
[05:58:15] [DOC: 9241423] ℹ️  API push details saved for document 9241423
================================================================================
║                        Processing Document ID: 9241417                         ║
================================================================================
[05:58:15] ℹ️  Agency: Dartmouth HH
[05:58:15] ℹ️  Date: 04/15/2025
[05:58:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:58:17] [DOC: 9241417] ✅ Text extracted using pdfplumber (1996 chars)
[05:58:17] ✅    ✅ Text extracted using pdfplumber (1996 chars)
[05:58:17] 🔄 
🔄 Step 2: Extracting patient data...
[05:58:20] ℹ️  AI extracted raw sex value: 'F'
[05:58:20] ℹ️  AI extracted service line: 'RN, HHA'
[05:58:20] ℹ️  AI extracted payer source: 'Medicare'
[05:58:20] ℹ️  AI extracted diagnoses:
[05:58:20] ℹ️    - Diagnosis 1: ''
[05:58:20] ℹ️    - Diagnosis 2: ''
[05:58:20] ℹ️    - Diagnosis 3: ''
[05:58:20] ℹ️    - Diagnosis 4: ''
[05:58:20] ℹ️    - Diagnosis 5: ''
[05:58:20] ℹ️    - Diagnosis 6: ''
[05:58:20] ℹ️  Final extracted MRN: '2892015'
[05:58:20] ℹ️  Final extracted Sex: 'FEMALE'
[05:58:20] ℹ️  Final extracted Service Line: 'RN, HHA'
[05:58:20] ℹ️  Final extracted Payer Source: 'Medicare'
[05:58:20] ✅ Patient data extraction completed successfully
[05:58:20] ✅    ✅ Patient data extracted successfully
[05:58:20] 📊 Patient Response
     └─ patientFName: Beverly
     └─ patientLName: Garrant
     └─ dob: 01/24/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2892015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 35 Lucy little Rd
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:58:20] ✅    ✅ Patient identified: Beverly Garrant
[05:58:20] ✅    ✅ Patient name validation passed
[05:58:20] 🔄 
🔄 Step 3: Processing patient dates...
[05:58:20] [DOC: 9241417] ℹ️  DOB normalized: 01/24/1939
[05:58:20] [DOC: 9241417] ℹ️  Episode startOfCare normalized: 02/14/2025
[05:58:20] [DOC: 9241417] ℹ️  Episode startOfEpisode normalized: 02/14/2025
[05:58:20] [DOC: 9241417] ℹ️  Episode endOfEpisode normalized: 04/14/2025
[05:58:20] [DOC: 9241417] ✅ Patient date processing completed successfully
[05:58:20] ✅    ✅ Date processing completed
[05:58:20] 📊 Processed Patient Data
     └─ patientFName: Beverly
     └─ patientLName: Garrant
     └─ dob: 01/24/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2892015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 35 Lucy little Rd
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '04/14/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:58:20] 🔄 
🔄 Step 4: Extracting order data...
[05:58:22] ℹ️  Order extraction - MRN: ''
[05:58:22] ℹ️  Order extraction - Sex: 'FEMALE'
[05:58:22] ℹ️  Order extraction - Service Line: 'RN'
[05:58:22] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:58:22] ✅ Order data extraction completed successfully
[05:58:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:58:22] ℹ️  Using MRN from patient data: '2892015'
[05:58:22] ℹ️  Combined service lines: Patient='RN, HHA' + Order='RN' = 'HHA, RN'
[05:58:22] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:58:22] ✅ Patient name cross-validation successful
[05:58:22] ✅    ✅ Data merged successfully
[05:58:23] ✅    ✅ Order data extracted and validated
[05:58:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:58:30] [DOC: 9241417] ✅ Patient exists in API: Beverly Garrant, ID: 7352cdb3-69db-486f-bc5f-5def68c8bea9
[05:58:30] ✅    ✅ Existing patient found with ID: 7352cdb3-69db-486f-bc5f-5def68c8bea9
[05:58:30] 🔄 
🔄 Step 6: Pushing order to API...
[05:58:30] [DOC: 9241417] ℹ️  Pushing order via API for patient ID: 7352cdb3-69db-486f-bc5f-5def68c8bea9
[05:58:31] [DOC: 9241417] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:58:31] ❌    ❌ Failed to push order
[05:58:31] 🔄 
🔄 Step 7: Writing to CSV...
[05:58:31] [DOC: 9241417] ℹ️  Calculated age: 86 from DOB: 01/24/1939
[05:58:31] [DOC: 9241417] ℹ️  Service Line extracted: 'HHA, RN'
[05:58:31] [DOC: 9241417] ℹ️  Payer Source extracted: 'Medicare'
[05:58:31] [DOC: 9241417] ℹ️  Diagnosis codes being written:
[05:58:31] [DOC: 9241417] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:58:31] [DOC: 9241417] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:58:31] [DOC: 9241417] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:58:31] [DOC: 9241417] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:58:31] [DOC: 9241417] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:58:31] [DOC: 9241417] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:58:31] [DOC: 9241417] ✅ Patient data written to CSV: Beverly Garrant | Sex: FEMALE | Age: 86 | Service: HHA, RN | Payer: Medicare | MRN: 2892015
[05:58:31] ✅    ✅ Document 9241417 processed and saved successfully
[05:58:31] 🔄 
🔄 Step 8: Saving API details...
[05:58:31] [DOC: 9241417] ℹ️  API push details saved for document 9241417
[05:58:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9241413                         ║
================================================================================
[05:58:31] ℹ️  Agency: Dartmouth HH
[05:58:31] ℹ️  Date: 04/15/2025
[05:58:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:58:34] [DOC: 9241413] ✅ Text extracted using pdfplumber (14139 chars)
[05:58:34] ✅    ✅ Text extracted using pdfplumber (14127 chars)
[05:58:34] 🔄 
🔄 Step 2: Extracting patient data...
[05:58:37] ℹ️  AI extracted raw sex value: 'F'
[05:58:37] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[05:58:37] ℹ️  AI extracted payer source: ''
[05:58:37] ℹ️  AI extracted diagnoses:
[05:58:37] ℹ️    - Diagnosis 1: 'I13.0'
[05:58:37] ℹ️    - Diagnosis 2: 'I50.33'
[05:58:37] ℹ️    - Diagnosis 3: 'N18.31'
[05:58:37] ℹ️    - Diagnosis 4: 'L89.152'
[05:58:37] ℹ️    - Diagnosis 5: 'E87.6'
[05:58:37] ℹ️    - Diagnosis 6: 'D62'
[05:58:37] ℹ️  Final extracted MRN: '2892015'
[05:58:37] ℹ️  Final extracted Sex: 'FEMALE'
[05:58:37] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[05:58:37] ℹ️  Final extracted Payer Source: ''
[05:58:37] ✅ Patient data extraction completed successfully
[05:58:37] ✅    ✅ Patient data extracted successfully
[05:58:37] 📊 Patient Response
     └─ patientFName: Garrant
     └─ patientLName: Beverly
     └─ dob: 01/24/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2892015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'L89.152', 'fifthDiagnosis': 'E87.6', 'sixthDiagnosis': 'D62'}]
[05:58:37] ✅    ✅ Patient identified: Garrant Beverly
[05:58:37] ✅    ✅ Patient name validation passed
[05:58:37] 🔄 
🔄 Step 3: Processing patient dates...
[05:58:37] [DOC: 9241413] ℹ️  DOB normalized: 01/24/1939
[05:58:37] [DOC: 9241413] ℹ️  Episode startOfCare normalized: 02/14/2025
[05:58:37] [DOC: 9241413] ℹ️  Episode startOfEpisode normalized: 02/14/2025
[05:58:37] [DOC: 9241413] ℹ️  Episode endOfEpisode normalized: 06/13/2025
[05:58:37] [DOC: 9241413] ✅ Patient date processing completed successfully
[05:58:37] ✅    ✅ Date processing completed
[05:58:37] 📊 Processed Patient Data
     └─ patientFName: Garrant
     └─ patientLName: Beverly
     └─ dob: 01/24/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2892015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/14/2025', 'startOfEpisode': '02/14/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'L89.152', 'fifthDiagnosis': 'E87.6', 'sixthDiagnosis': 'D62'}]
[05:58:37] 🔄 
🔄 Step 4: Extracting order data...
[05:58:39] ℹ️  Order extraction - MRN: '2892015'
[05:58:39] ℹ️  Order extraction - Sex: 'FEMALE'
[05:58:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[05:58:39] ℹ️  Order extraction - Payer Source: ''
[05:58:39] ✅ Order data extraction completed successfully
[05:58:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:58:39] ℹ️  Using MRN from patient data: '2892015' over '2892015'
[05:58:39] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT'
[05:58:39] ✅ Patient name cross-validation successful
[05:58:39] ✅    ✅ Data merged successfully
[05:58:40] ✅    ✅ Order data extracted and validated
[05:58:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:58:46] [DOC: 9241413] ℹ️  Patient not found in cache or API: Garrant Beverly
[05:58:46] [DOC: 9241413] ℹ️  Patient not found, creating new patient via API...
[05:58:46] [DOC: 9241413] ℹ️  Creating patient via API: Garrant Beverly
[05:58:47] [DOC: 9241413] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:58:47] ❌    ❌ Failed to create patient
[05:58:47] [DOC: 9241413] ℹ️  API push details saved for document 9241413
================================================================================
║                        Processing Document ID: 9241411                         ║
================================================================================
[05:58:47] ℹ️  Agency: Dartmouth HH
[05:58:47] ℹ️  Date: 04/15/2025
[05:58:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:58:49] [DOC: 9241411] ✅ Text extracted using pdfplumber (1204 chars)
[05:58:49] ✅    ✅ Text extracted using pdfplumber (1204 chars)
[05:58:49] 🔄 
🔄 Step 2: Extracting patient data...
[05:58:52] ℹ️  AI extracted raw sex value: 'F'
[05:58:52] ℹ️  AI extracted service line: 'Nursing'
[05:58:52] ℹ️  AI extracted payer source: 'Senior Whole Health'
[05:58:52] ℹ️  AI extracted diagnoses:
[05:58:52] ℹ️    - Diagnosis 1: ''
[05:58:52] ℹ️    - Diagnosis 2: ''
[05:58:52] ℹ️    - Diagnosis 3: ''
[05:58:52] ℹ️    - Diagnosis 4: ''
[05:58:52] ℹ️    - Diagnosis 5: ''
[05:58:52] ℹ️    - Diagnosis 6: ''
[05:58:52] ℹ️  Final extracted MRN: '928015'
[05:58:52] ℹ️  Final extracted Sex: 'FEMALE'
[05:58:52] ℹ️  Final extracted Service Line: 'Nursing'
[05:58:52] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[05:58:52] ✅ Patient data extraction completed successfully
[05:58:52] ✅    ✅ Patient data extracted successfully
[05:58:52] 📊 Patient Response
     └─ patientFName: Erconida
     └─ patientLName: Graciani
     └─ dob: 07/07/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 928015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 23 Austin Street Apt 1E
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '01/10/2025', 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:58:52] ✅    ✅ Patient identified: Erconida Graciani
[05:58:52] ✅    ✅ Patient name validation passed
[05:58:52] 🔄 
🔄 Step 3: Processing patient dates...
[05:58:52] [DOC: 9241411] ℹ️  DOB normalized: 07/07/1940
[05:58:52] [DOC: 9241411] ℹ️  Episode startOfCare normalized: 01/10/2025
[05:58:52] [DOC: 9241411] ℹ️  Episode startOfEpisode normalized: 03/11/2025
[05:58:52] [DOC: 9241411] ℹ️  Episode endOfEpisode normalized: 05/09/2025
[05:58:52] [DOC: 9241411] ✅ Patient date processing completed successfully
[05:58:52] ✅    ✅ Date processing completed
[05:58:52] 📊 Processed Patient Data
     └─ patientFName: Erconida
     └─ patientLName: Graciani
     └─ dob: 07/07/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 928015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 23 Austin Street Apt 1E
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '01/10/2025', 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:58:52] 🔄 
🔄 Step 4: Extracting order data...
[05:58:54] ℹ️  Order extraction - MRN: ''
[05:58:54] ℹ️  Order extraction - Sex: 'FEMALE'
[05:58:54] ℹ️  Order extraction - Service Line: 'RN, LPN'
[05:58:54] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[05:58:54] ✅ Order data extraction completed successfully
[05:58:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:58:54] ℹ️  Using MRN from patient data: '928015'
[05:58:54] ℹ️  Combined service lines: Patient='Nursing' + Order='RN, LPN' = 'LPN, Nursing, RN'
[05:58:54] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[05:58:54] ✅ Patient name cross-validation successful
[05:58:54] ✅    ✅ Data merged successfully
[05:58:56] ✅    ✅ Order data extracted and validated
[05:58:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:59:07] [DOC: 9241411] ✅ Patient exists in API: Erconida Graciani, ID: 201ad4b3-4b9b-407c-8546-32ee2138445f
[05:59:07] ✅    ✅ Existing patient found with ID: 201ad4b3-4b9b-407c-8546-32ee2138445f
[05:59:07] 🔄 
🔄 Step 6: Pushing order to API...
[05:59:07] [DOC: 9241411] ℹ️  Pushing order via API for patient ID: 201ad4b3-4b9b-407c-8546-32ee2138445f
[05:59:08] [DOC: 9241411] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13823"}
[05:59:08] ❌    ❌ Failed to push order
[05:59:08] 🔄 
🔄 Step 7: Writing to CSV...
[05:59:08] [DOC: 9241411] ℹ️  Calculated age: 84 from DOB: 07/07/1940
[05:59:08] [DOC: 9241411] ℹ️  Service Line extracted: 'LPN, Nursing, RN'
[05:59:08] [DOC: 9241411] ℹ️  Payer Source extracted: 'Senior Whole Health'
[05:59:08] [DOC: 9241411] ℹ️  Diagnosis codes being written:
[05:59:08] [DOC: 9241411] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:59:08] [DOC: 9241411] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:59:08] [DOC: 9241411] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:59:08] [DOC: 9241411] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:59:08] [DOC: 9241411] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:59:08] [DOC: 9241411] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:59:08] [DOC: 9241411] ✅ Patient data written to CSV: Erconida Graciani | Sex: FEMALE | Age: 84 | Service: LPN, Nursing, RN | Payer: Senior Whole Health | MRN: 928015
[05:59:08] ✅    ✅ Document 9241411 processed and saved successfully
[05:59:08] 🔄 
🔄 Step 8: Saving API details...
[05:59:08] [DOC: 9241411] ℹ️  API push details saved for document 9241411
[05:59:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9241385                         ║
================================================================================
[05:59:08] ℹ️  Agency: Relief Home Health Services
[05:59:08] ℹ️  Date: 04/15/2025
[05:59:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:59:11] [DOC: 9241385] ✅ Text extracted using pdfplumber (3552 chars)
[05:59:11] ✅    ✅ Text extracted using pdfplumber (3552 chars)
[05:59:11] 🔄 
🔄 Step 2: Extracting patient data...
[05:59:13] ℹ️  AI extracted raw sex value: ''
[05:59:13] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:59:13] ℹ️  AI extracted payer source: ''
[05:59:13] ℹ️  AI extracted diagnoses:
[05:59:13] ℹ️    - Diagnosis 1: 'E11.10'
[05:59:13] ℹ️    - Diagnosis 2: ''
[05:59:13] ℹ️    - Diagnosis 3: ''
[05:59:13] ℹ️    - Diagnosis 4: ''
[05:59:13] ℹ️    - Diagnosis 5: ''
[05:59:13] ℹ️    - Diagnosis 6: ''
[05:59:13] ℹ️  Final extracted MRN: ''
[05:59:13] ℹ️  Final extracted Sex: ''
[05:59:13] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:59:13] ℹ️  Final extracted Payer Source: ''
[05:59:13] ✅ Patient data extraction completed successfully
[05:59:13] ✅    ✅ Patient data extracted successfully
[05:59:13] 📊 Patient Response
     └─ patientFName: Leah
     └─ patientLName: Miranda
     └─ dob: 04/15/1947
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1326028085
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 535 Faunce Corner Road
     └─ city: N Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: inquiries@reliefhhs.com
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/28/2022', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '', 'firstDiagnosis': 'E11.10', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:59:13] ✅    ✅ Patient identified: Leah Miranda
[05:59:13] ✅    ✅ Patient name validation passed
[05:59:13] 🔄 
🔄 Step 3: Processing patient dates...
[05:59:13] [DOC: 9241385] ℹ️  DOB normalized: 04/15/1947
[05:59:13] [DOC: 9241385] ℹ️  Episode startOfCare normalized: 12/28/2022
[05:59:13] [DOC: 9241385] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[05:59:13] [DOC: 9241385] ✅ Patient date processing completed successfully
[05:59:13] ✅    ✅ Date processing completed
[05:59:13] 📊 Processed Patient Data
     └─ patientFName: Leah
     └─ patientLName: Miranda
     └─ dob: 04/15/1947
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1326028085
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 535 Faunce Corner Road
     └─ city: N Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: inquiries@reliefhhs.com
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/28/2022', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '', 'firstDiagnosis': 'E11.10', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:59:13] 🔄 
🔄 Step 4: Extracting order data...
[05:59:16] ℹ️  Order extraction - MRN: ''
[05:59:16] ℹ️  Order extraction - Sex: ''
[05:59:16] ℹ️  Order extraction - Service Line: ''
[05:59:16] ℹ️  Order extraction - Payer Source: ''
[05:59:16] ✅ Order data extraction completed successfully
[05:59:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:59:16] ⚠️  No MRN found in either patient or order data
[05:59:16] ⚠️  Could not determine sex using any available method
[05:59:16] ℹ️  Using service line from patient data: 'Skilled Nursing'
[05:59:16] ✅ Patient name cross-validation successful
[05:59:16] ✅    ✅ Data merged successfully
[05:59:17] ✅    ✅ Order data extracted and validated
[05:59:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:59:17] [DOC: 9241385] ✅ Patient found in local cache: Leah Miranda, ID: 72b643f1-c294-4fdd-afdc-323a3e0148d5
[05:59:17] ✅    ✅ Existing patient found with ID: 72b643f1-c294-4fdd-afdc-323a3e0148d5
[05:59:17] 🔄 
🔄 Step 6: Pushing order to API...
[05:59:17] [DOC: 9241385] ℹ️  Pushing order via API for patient ID: 72b643f1-c294-4fdd-afdc-323a3e0148d5
[05:59:18] [DOC: 9241385] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:59:18] ❌    ❌ Failed to push order
[05:59:18] 🔄 
🔄 Step 7: Writing to CSV...
[05:59:18] [DOC: 9241385] ℹ️  Calculated age: 78 from DOB: 04/15/1947
[05:59:18] [DOC: 9241385] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:59:18] [DOC: 9241385] ℹ️  Payer Source extracted: ''
[05:59:18] [DOC: 9241385] ℹ️  Diagnosis codes being written:
[05:59:18] [DOC: 9241385] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.10'
[05:59:18] [DOC: 9241385] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:59:18] [DOC: 9241385] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:59:18] [DOC: 9241385] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:59:18] [DOC: 9241385] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:59:18] [DOC: 9241385] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:59:18] [DOC: 9241385] ✅ Patient data written to CSV: Leah Miranda | Sex:  | Age: 78 | Service: Skilled Nursing | Payer:  | MRN: 
[05:59:18] ✅    ✅ Document 9241385 processed and saved successfully
[05:59:18] 🔄 
🔄 Step 8: Saving API details...
[05:59:18] [DOC: 9241385] ℹ️  API push details saved for document 9241385
[05:59:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9241379                         ║
================================================================================
[05:59:18] ℹ️  Agency: Dartmouth HH
[05:59:18] ℹ️  Date: 04/15/2025
[05:59:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:59:20] [DOC: 9241379] ✅ Text extracted using pdfplumber (1304 chars)
[05:59:20] ✅    ✅ Text extracted using pdfplumber (1304 chars)
[05:59:20] 🔄 
🔄 Step 2: Extracting patient data...
[05:59:23] ℹ️  AI extracted raw sex value: 'F'
[05:59:23] ℹ️  AI extracted service line: 'Nursing'
[05:59:23] ℹ️  AI extracted payer source: 'Medicare'
[05:59:23] ℹ️  AI extracted diagnoses:
[05:59:23] ℹ️    - Diagnosis 1: ''
[05:59:23] ℹ️    - Diagnosis 2: ''
[05:59:23] ℹ️    - Diagnosis 3: ''
[05:59:23] ℹ️    - Diagnosis 4: ''
[05:59:23] ℹ️    - Diagnosis 5: ''
[05:59:23] ℹ️    - Diagnosis 6: ''
[05:59:23] ℹ️  Final extracted MRN: '5862015'
[05:59:23] ℹ️  Final extracted Sex: 'FEMALE'
[05:59:23] ℹ️  Final extracted Service Line: 'Nursing'
[05:59:23] ℹ️  Final extracted Payer Source: 'Medicare'
[05:59:23] ✅ Patient data extraction completed successfully
[05:59:23] ✅    ✅ Patient data extracted successfully
[05:59:23] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 95 Highland Street 2nd floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:59:23] ✅    ✅ Patient identified: Janice Arruda
[05:59:23] ✅    ✅ Patient name validation passed
[05:59:23] 🔄 
🔄 Step 3: Processing patient dates...
[05:59:23] [DOC: 9241379] ℹ️  DOB normalized: 01/24/1950
[05:59:23] [DOC: 9241379] ℹ️  Episode startOfCare normalized: 02/08/2025
[05:59:23] [DOC: 9241379] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[05:59:23] [DOC: 9241379] ℹ️  Episode endOfEpisode normalized: 06/07/2025
[05:59:23] [DOC: 9241379] ✅ Patient date processing completed successfully
[05:59:23] ✅    ✅ Date processing completed
[05:59:23] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 95 Highland Street 2nd floor
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:59:23] 🔄 
🔄 Step 4: Extracting order data...
[05:59:25] ℹ️  Order extraction - MRN: ''
[05:59:25] ℹ️  Order extraction - Sex: 'FEMALE'
[05:59:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:59:25] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:59:25] ✅ Order data extraction completed successfully
[05:59:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:59:25] ℹ️  Using MRN from patient data: '5862015'
[05:59:25] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[05:59:25] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:59:25] ✅ Patient name cross-validation successful
[05:59:25] ✅    ✅ Data merged successfully
[05:59:26] ✅    ✅ Order data extracted and validated
[05:59:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:59:26] [DOC: 9241379] ✅ Patient found in local cache: Janice Arruda, ID: cc67108f-d504-4858-959a-d21d91141958
[05:59:26] ✅    ✅ Existing patient found with ID: cc67108f-d504-4858-959a-d21d91141958
[05:59:26] 🔄 
🔄 Step 6: Pushing order to API...
[05:59:26] [DOC: 9241379] ℹ️  Pushing order via API for patient ID: cc67108f-d504-4858-959a-d21d91141958
[05:59:28] [DOC: 9241379] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12954"}
[05:59:28] ❌    ❌ Failed to push order
[05:59:28] 🔄 
🔄 Step 7: Writing to CSV...
[05:59:28] [DOC: 9241379] ℹ️  Calculated age: 75 from DOB: 01/24/1950
[05:59:28] [DOC: 9241379] ℹ️  Service Line extracted: 'Nursing, Skilled Nursing'
[05:59:28] [DOC: 9241379] ℹ️  Payer Source extracted: 'Medicare'
[05:59:28] [DOC: 9241379] ℹ️  Diagnosis codes being written:
[05:59:28] [DOC: 9241379] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:59:28] [DOC: 9241379] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:59:28] [DOC: 9241379] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:59:28] [DOC: 9241379] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:59:28] [DOC: 9241379] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:59:28] [DOC: 9241379] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:59:28] [DOC: 9241379] ✅ Patient data written to CSV: Janice Arruda | Sex: FEMALE | Age: 75 | Service: Nursing, Skilled Nursing | Payer: Medicare | MRN: 5862015
[05:59:28] ✅    ✅ Document 9241379 processed and saved successfully
[05:59:28] 🔄 
🔄 Step 8: Saving API details...
[05:59:28] [DOC: 9241379] ℹ️  API push details saved for document 9241379
[05:59:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9241378                         ║
================================================================================
[05:59:28] ℹ️  Agency: Relief Home Health Services
[05:59:28] ℹ️  Date: 04/15/2025
[05:59:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:59:30] [DOC: 9241378] ✅ Text extracted using pdfplumber (3112 chars)
[05:59:30] ✅    ✅ Text extracted using pdfplumber (3112 chars)
[05:59:30] 🔄 
🔄 Step 2: Extracting patient data...
[05:59:33] ℹ️  AI extracted raw sex value: ''
[05:59:33] ℹ️  AI extracted service line: 'RN'
[05:59:33] ℹ️  AI extracted payer source: ''
[05:59:33] ℹ️  AI extracted diagnoses:
[05:59:33] ℹ️    - Diagnosis 1: 'E11.10'
[05:59:33] ℹ️    - Diagnosis 2: ''
[05:59:33] ℹ️    - Diagnosis 3: ''
[05:59:33] ℹ️    - Diagnosis 4: ''
[05:59:33] ℹ️    - Diagnosis 5: ''
[05:59:33] ℹ️    - Diagnosis 6: ''
[05:59:33] ℹ️  Final extracted MRN: ''
[05:59:33] ℹ️  Final extracted Sex: ''
[05:59:33] ℹ️  Final extracted Service Line: 'RN'
[05:59:33] ℹ️  Final extracted Payer Source: ''
[05:59:33] ✅ Patient data extraction completed successfully
[05:59:33] ✅    ✅ Patient data extracted successfully
[05:59:33] 📊 Patient Response
     └─ patientFName: LEAH
     └─ patientLName: MIRANDA
     └─ dob: 04/15/1947
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1326028085
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 35 Winter Street
     └─ city: Hyannis
     └─ state: MA
     └─ zip: 02601
     └─ email: inquiries@reliefhhs.com
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/28/2022', 'startOfEpisode': '10/16/2024', 'endOfEpisode': '04/15/2025', 'firstDiagnosis': 'E11.10', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:59:33] ✅    ✅ Patient identified: LEAH MIRANDA
[05:59:33] ✅    ✅ Patient name validation passed
[05:59:33] 🔄 
🔄 Step 3: Processing patient dates...
[05:59:33] [DOC: 9241378] ℹ️  DOB normalized: 04/15/1947
[05:59:33] [DOC: 9241378] ℹ️  Episode startOfCare normalized: 12/28/2022
[05:59:33] [DOC: 9241378] ℹ️  Episode startOfEpisode normalized: 10/16/2024
[05:59:33] [DOC: 9241378] ℹ️  Episode endOfEpisode normalized: 04/15/2025
[05:59:33] [DOC: 9241378] ✅ Patient date processing completed successfully
[05:59:33] ✅    ✅ Date processing completed
[05:59:33] 📊 Processed Patient Data
     └─ patientFName: LEAH
     └─ patientLName: MIRANDA
     └─ dob: 04/15/1947
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1326028085
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 35 Winter Street
     └─ city: Hyannis
     └─ state: MA
     └─ zip: 02601
     └─ email: inquiries@reliefhhs.com
     └─ phoneNumber: (508) 827-7954
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/28/2022', 'startOfEpisode': '10/16/2024', 'endOfEpisode': '04/15/2025', 'firstDiagnosis': 'E11.10', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:59:33] 🔄 
🔄 Step 4: Extracting order data...
[05:59:36] ℹ️  Order extraction - MRN: ''
[05:59:36] ℹ️  Order extraction - Sex: ''
[05:59:36] ℹ️  Order extraction - Service Line: ''
[05:59:36] ℹ️  Order extraction - Payer Source: ''
[05:59:36] ✅ Order data extraction completed successfully
[05:59:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:59:36] ⚠️  No MRN found in either patient or order data
[05:59:36] ⚠️  Could not determine sex using any available method
[05:59:36] ℹ️  Using service line from patient data: 'RN'
[05:59:36] ✅ Patient name cross-validation successful
[05:59:36] ✅    ✅ Data merged successfully
[05:59:37] ✅    ✅ Order data extracted and validated
[05:59:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:59:37] [DOC: 9241378] ✅ Patient found in local cache: LEAH MIRANDA, ID: 72b643f1-c294-4fdd-afdc-323a3e0148d5
[05:59:37] ✅    ✅ Existing patient found with ID: 72b643f1-c294-4fdd-afdc-323a3e0148d5
[05:59:37] 🔄 
🔄 Step 6: Pushing order to API...
[05:59:37] [DOC: 9241378] ℹ️  Pushing order via API for patient ID: 72b643f1-c294-4fdd-afdc-323a3e0148d5
[05:59:38] [DOC: 9241378] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:59:38] ❌    ❌ Failed to push order
[05:59:38] 🔄 
🔄 Step 7: Writing to CSV...
[05:59:38] [DOC: 9241378] ℹ️  Calculated age: 78 from DOB: 04/15/1947
[05:59:38] [DOC: 9241378] ℹ️  Service Line extracted: 'RN'
[05:59:38] [DOC: 9241378] ℹ️  Payer Source extracted: ''
[05:59:38] [DOC: 9241378] ℹ️  Diagnosis codes being written:
[05:59:38] [DOC: 9241378] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.10'
[05:59:38] [DOC: 9241378] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:59:38] [DOC: 9241378] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:59:38] [DOC: 9241378] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:59:38] [DOC: 9241378] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:59:38] [DOC: 9241378] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:59:38] [DOC: 9241378] ✅ Patient data written to CSV: LEAH MIRANDA | Sex:  | Age: 78 | Service: RN | Payer:  | MRN: 
[05:59:38] ✅    ✅ Document 9241378 processed and saved successfully
[05:59:38] 🔄 
🔄 Step 8: Saving API details...
[05:59:38] [DOC: 9241378] ℹ️  API push details saved for document 9241378
[05:59:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9241373                         ║
================================================================================
[05:59:38] ℹ️  Agency: Dartmouth HH
[05:59:38] ℹ️  Date: 04/15/2025
[05:59:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:59:41] [DOC: 9241373] ✅ Text extracted using pdfplumber (16529 chars)
[05:59:41] ✅    ✅ Text extracted using pdfplumber (16529 chars)
[05:59:41] 🔄 
🔄 Step 2: Extracting patient data...
[05:59:44] ℹ️  AI extracted raw sex value: 'F'
[05:59:44] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:59:44] ℹ️  AI extracted payer source: ''
[05:59:44] ℹ️  AI extracted diagnoses:
[05:59:44] ℹ️    - Diagnosis 1: 'I25.10'
[05:59:44] ℹ️    - Diagnosis 2: 'I10'
[05:59:44] ℹ️    - Diagnosis 3: 'M47.896'
[05:59:44] ℹ️    - Diagnosis 4: 'M54.31'
[05:59:44] ℹ️    - Diagnosis 5: 'K59.09'
[05:59:44] ℹ️    - Diagnosis 6: 'K58.9'
[05:59:44] ℹ️  Final extracted MRN: '301015'
[05:59:44] ℹ️  Final extracted Sex: 'FEMALE'
[05:59:44] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:59:44] ℹ️  Final extracted Payer Source: ''
[05:59:44] ✅ Patient data extraction completed successfully
[05:59:44] ✅    ✅ Patient data extracted successfully
[05:59:44] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Dacosta
     └─ dob: 10/10/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 301015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/18/2024', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'I25.10', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'M47.896', 'fourthDiagnosis': 'M54.31', 'fifthDiagnosis': 'K59.09', 'sixthDiagnosis': 'K58.9'}]
[05:59:44] ✅    ✅ Patient identified: Maria Dacosta
[05:59:44] ✅    ✅ Patient name validation passed
[05:59:44] 🔄 
🔄 Step 3: Processing patient dates...
[05:59:44] [DOC: 9241373] ℹ️  DOB normalized: 10/10/1943
[05:59:44] [DOC: 9241373] ℹ️  Episode startOfCare normalized: 04/18/2024
[05:59:44] [DOC: 9241373] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[05:59:44] [DOC: 9241373] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[05:59:44] [DOC: 9241373] ✅ Patient date processing completed successfully
[05:59:44] ✅    ✅ Date processing completed
[05:59:44] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Dacosta
     └─ dob: 10/10/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 301015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/18/2024', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'I25.10', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'M47.896', 'fourthDiagnosis': 'M54.31', 'fifthDiagnosis': 'K59.09', 'sixthDiagnosis': 'K58.9'}]
[05:59:44] 🔄 
🔄 Step 4: Extracting order data...
[05:59:46] ℹ️  Order extraction - MRN: '301015'
[05:59:46] ℹ️  Order extraction - Sex: 'FEMALE'
[05:59:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:59:46] ℹ️  Order extraction - Payer Source: ''
[05:59:46] ✅ Order data extraction completed successfully
[05:59:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:59:46] ℹ️  Using MRN from patient data: '301015' over '301015'
[05:59:46] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[05:59:46] ✅ Patient name cross-validation successful
[05:59:46] ✅    ✅ Data merged successfully
[05:59:48] ✅    ✅ Order data extracted and validated
[05:59:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:59:48] [DOC: 9241373] ✅ Patient found in local cache: Maria Dacosta, ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[05:59:48] ✅    ✅ Existing patient found with ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[05:59:48] 🔄 
🔄 Step 6: Pushing order to API...
[05:59:48] [DOC: 9241373] ℹ️  Pushing order via API for patient ID: 0a49b332-4e5d-4748-ab44-1f80336014df
[05:59:49] [DOC: 9241373] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:59:49] ❌    ❌ Failed to push order
[05:59:49] 🔄 
🔄 Step 7: Writing to CSV...
[05:59:49] [DOC: 9241373] ℹ️  Calculated age: 81 from DOB: 10/10/1943
[05:59:49] [DOC: 9241373] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[05:59:49] [DOC: 9241373] ℹ️  Payer Source extracted: ''
[05:59:49] [DOC: 9241373] ℹ️  Diagnosis codes being written:
[05:59:49] [DOC: 9241373] ℹ️    - Latest_Episode_Firstdiagnosis: 'I25.10'
[05:59:49] [DOC: 9241373] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[05:59:49] [DOC: 9241373] ℹ️    - Latest_Episode_Thirddiagnosis: 'M47.896'
[05:59:49] [DOC: 9241373] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M54.31'
[05:59:49] [DOC: 9241373] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K59.09'
[05:59:49] [DOC: 9241373] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K58.9'
[05:59:49] [DOC: 9241373] ✅ Patient data written to CSV: Maria Dacosta | Sex: FEMALE | Age: 81 | Service: Occupational Therapy, Physical Therapy, Skilled Nursing | Payer:  | MRN: 301015
[05:59:49] ✅    ✅ Document 9241373 processed and saved successfully
[05:59:49] 🔄 
🔄 Step 8: Saving API details...
[05:59:49] [DOC: 9241373] ℹ️  API push details saved for document 9241373
[05:59:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9241352                         ║
================================================================================
[05:59:49] ℹ️  Agency: Dartmouth HH
[05:59:49] ℹ️  Date: 04/15/2025
[05:59:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:59:52] [DOC: 9241352] ✅ Text extracted using pdfplumber (15051 chars)
[05:59:52] ✅    ✅ Text extracted using pdfplumber (15051 chars)
[05:59:52] 🔄 
🔄 Step 2: Extracting patient data...
[05:59:55] ℹ️  AI extracted raw sex value: 'F'
[05:59:55] ℹ️  AI extracted service line: 'PT'
[05:59:55] ℹ️  AI extracted payer source: 'None'
[05:59:55] ℹ️  AI extracted diagnoses:
[05:59:55] ℹ️    - Diagnosis 1: 'G20.A1'
[05:59:55] ℹ️    - Diagnosis 2: 'M17.11'
[05:59:55] ℹ️    - Diagnosis 3: 'M25.561'
[05:59:55] ℹ️    - Diagnosis 4: 'M47.816'
[05:59:55] ℹ️    - Diagnosis 5: 'M62.81'
[05:59:55] ℹ️    - Diagnosis 6: 'M54.2'
[05:59:55] ℹ️  Final extracted MRN: '227027'
[05:59:55] ℹ️  Final extracted Sex: 'FEMALE'
[05:59:55] ℹ️  Final extracted Service Line: 'PT'
[05:59:55] ℹ️  Final extracted Payer Source: ''
[05:59:55] ✅ Patient data extraction completed successfully
[05:59:55] ✅    ✅ Patient data extracted successfully
[05:59:55] 📊 Patient Response
     └─ patientFName: Cardona
     └─ patientLName: Maria
     └─ dob: 12/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'M17.11', 'thirdDiagnosis': 'M25.561', 'fourthDiagnosis': 'M47.816', 'fifthDiagnosis': 'M62.81', 'sixthDiagnosis': 'M54.2'}]
[05:59:55] ✅    ✅ Patient identified: Cardona Maria
[05:59:55] ✅    ✅ Patient name validation passed
[05:59:55] 🔄 
🔄 Step 3: Processing patient dates...
[05:59:55] [DOC: 9241352] ℹ️  DOB normalized: 12/20/1945
[05:59:55] [DOC: 9241352] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[05:59:55] [DOC: 9241352] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[05:59:55] [DOC: 9241352] ✅ Patient date processing completed successfully
[05:59:55] ✅    ✅ Date processing completed
[05:59:55] 📊 Processed Patient Data
     └─ patientFName: Cardona
     └─ patientLName: Maria
     └─ dob: 12/20/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'M17.11', 'thirdDiagnosis': 'M25.561', 'fourthDiagnosis': 'M47.816', 'fifthDiagnosis': 'M62.81', 'sixthDiagnosis': 'M54.2'}]
[05:59:55] 🔄 
🔄 Step 4: Extracting order data...
[05:59:57] ℹ️  Order extraction - MRN: '6326015'
[05:59:57] ℹ️  Order extraction - Sex: 'FEMALE'
[05:59:57] ℹ️  Order extraction - Service Line: 'PT, RN'
[05:59:57] ℹ️  Order extraction - Payer Source: ''
[05:59:57] ✅ Order data extraction completed successfully
[05:59:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:59:57] ℹ️  Using longer MRN from order data: '6326015' over '227027'
[05:59:57] ℹ️  Combined service lines: Patient='PT' + Order='PT, RN' = 'PT, RN'
[05:59:57] ✅ Patient name cross-validation successful
[05:59:57] ✅    ✅ Data merged successfully
[05:59:58] ✅    ✅ Order data extracted and validated
[05:59:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:00:20] [DOC: 9241352] ℹ️  Patient not found in cache or API: Cardona Maria
[06:00:20] [DOC: 9241352] ℹ️  Patient not found, creating new patient via API...
[06:00:20] [DOC: 9241352] ℹ️  Creating patient via API: Cardona Maria
[06:00:21] [DOC: 9241352] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:00:21] ❌    ❌ Failed to create patient
[06:00:21] [DOC: 9241352] ℹ️  API push details saved for document 9241352
================================================================================
║                        Processing Document ID: 9241343                         ║
================================================================================
[06:00:21] ℹ️  Agency: Dartmouth HH
[06:00:21] ℹ️  Date: 04/15/2025
[06:00:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:00:23] [DOC: 9241343] ✅ Text extracted using pdfplumber (1263 chars)
[06:00:23] ✅    ✅ Text extracted using pdfplumber (1263 chars)
[06:00:23] 🔄 
🔄 Step 2: Extracting patient data...
[06:00:26] ℹ️  AI extracted raw sex value: 'F'
[06:00:26] ℹ️  AI extracted service line: 'RN, LPN'
[06:00:26] ℹ️  AI extracted payer source: 'Medicare'
[06:00:26] ℹ️  AI extracted diagnoses:
[06:00:26] ℹ️    - Diagnosis 1: ''
[06:00:26] ℹ️    - Diagnosis 2: ''
[06:00:26] ℹ️    - Diagnosis 3: ''
[06:00:26] ℹ️    - Diagnosis 4: ''
[06:00:26] ℹ️    - Diagnosis 5: ''
[06:00:26] ℹ️    - Diagnosis 6: ''
[06:00:26] ℹ️  Final extracted MRN: '2502011'
[06:00:26] ℹ️  Final extracted Sex: 'FEMALE'
[06:00:26] ℹ️  Final extracted Service Line: 'RN, LPN'
[06:00:26] ℹ️  Final extracted Payer Source: 'Medicare'
[06:00:26] ✅ Patient data extraction completed successfully
[06:00:26] ✅    ✅ Patient data extracted successfully
[06:00:26] 📊 Patient Response
     └─ patientFName: Veronica
     └─ patientLName: Cusson
     └─ dob: 08/26/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2502011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:00:26] ✅    ✅ Patient identified: Veronica Cusson
[06:00:26] ✅    ✅ Patient name validation passed
[06:00:26] 🔄 
🔄 Step 3: Processing patient dates...
[06:00:26] [DOC: 9241343] ℹ️  DOB normalized: 08/26/1964
[06:00:26] [DOC: 9241343] ℹ️  Episode startOfCare normalized: 04/02/2025
[06:00:26] [DOC: 9241343] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[06:00:26] [DOC: 9241343] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[06:00:26] [DOC: 9241343] ✅ Patient date processing completed successfully
[06:00:26] ✅    ✅ Date processing completed
[06:00:26] 📊 Processed Patient Data
     └─ patientFName: Veronica
     └─ patientLName: Cusson
     └─ dob: 08/26/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2502011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:00:26] 🔄 
🔄 Step 4: Extracting order data...
[06:00:29] ℹ️  Order extraction - MRN: ''
[06:00:29] ℹ️  Order extraction - Sex: 'FEMALE'
[06:00:29] ℹ️  Order extraction - Service Line: 'RN, LPN'
[06:00:29] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:00:29] ✅ Order data extraction completed successfully
[06:00:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:00:29] ℹ️  Using MRN from patient data: '2502011'
[06:00:29] ℹ️  Service line consistent in both sources: 'RN, LPN'
[06:00:29] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:00:29] ✅ Patient name cross-validation successful
[06:00:29] ✅    ✅ Data merged successfully
[06:00:30] ✅    ✅ Order data extracted and validated
[06:00:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:01:01] [DOC: 9241343] ℹ️  Patient not found in cache or API: Veronica Cusson
[06:01:01] [DOC: 9241343] ℹ️  Patient not found, creating new patient via API...
[06:01:01] [DOC: 9241343] ℹ️  Creating patient via API: Veronica Cusson
[06:01:02] [DOC: 9241343] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:01:02] ❌    ❌ Failed to create patient
[06:01:02] [DOC: 9241343] ℹ️  API push details saved for document 9241343
================================================================================
║                        Processing Document ID: 9241336                         ║
================================================================================
[06:01:02] ℹ️  Agency: Dartmouth HH
[06:01:02] ℹ️  Date: 04/15/2025
[06:01:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:01:08] [DOC: 9241336] ✅ Text extracted using pdfplumber (16964 chars)
[06:01:08] ✅    ✅ Text extracted using pdfplumber (16964 chars)
[06:01:08] 🔄 
🔄 Step 2: Extracting patient data...
[06:01:11] ℹ️  AI extracted raw sex value: 'F'
[06:01:11] ℹ️  AI extracted service line: 'PT, OT'
[06:01:11] ℹ️  AI extracted payer source: ''
[06:01:11] ℹ️  AI extracted diagnoses:
[06:01:11] ℹ️    - Diagnosis 1: 'N20.0'
[06:01:11] ℹ️    - Diagnosis 2: 'N13.6'
[06:01:11] ℹ️    - Diagnosis 3: 'I11.0'
[06:01:11] ℹ️    - Diagnosis 4: 'I50.9'
[06:01:11] ℹ️    - Diagnosis 5: 'R53.1'
[06:01:11] ℹ️    - Diagnosis 6: 'R42'
[06:01:11] ℹ️  Final extracted MRN: '4944011'
[06:01:11] ℹ️  Final extracted Sex: 'FEMALE'
[06:01:11] ℹ️  Final extracted Service Line: 'PT, OT'
[06:01:11] ℹ️  Final extracted Payer Source: ''
[06:01:11] ✅ Patient data extraction completed successfully
[06:01:11] ✅    ✅ Patient data extracted successfully
[06:01:11] 📊 Patient Response
     └─ patientFName: Eva I
     └─ patientLName: Damm
     └─ dob: 06/26/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4944011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N20.0', 'secondDiagnosis': 'N13.6', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.9', 'fifthDiagnosis': 'R53.1', 'sixthDiagnosis': 'R42'}]
[06:01:11] ✅    ✅ Patient identified: Eva I Damm
[06:01:11] ✅    ✅ Patient name validation passed
[06:01:11] 🔄 
🔄 Step 3: Processing patient dates...
[06:01:11] [DOC: 9241336] ℹ️  DOB normalized: 06/26/1947
[06:01:11] [DOC: 9241336] ℹ️  Episode startOfCare normalized: 04/08/2025
[06:01:11] [DOC: 9241336] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[06:01:11] [DOC: 9241336] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[06:01:11] [DOC: 9241336] ✅ Patient date processing completed successfully
[06:01:11] ✅    ✅ Date processing completed
[06:01:11] 📊 Processed Patient Data
     └─ patientFName: Eva I
     └─ patientLName: Damm
     └─ dob: 06/26/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4944011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'N20.0', 'secondDiagnosis': 'N13.6', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.9', 'fifthDiagnosis': 'R53.1', 'sixthDiagnosis': 'R42'}]
[06:01:11] 🔄 
🔄 Step 4: Extracting order data...
[06:01:13] ℹ️  Order extraction - MRN: '4944011'
[06:01:13] ℹ️  Order extraction - Sex: 'FEMALE'
[06:01:13] ℹ️  Order extraction - Service Line: 'PT, OT'
[06:01:13] ℹ️  Order extraction - Payer Source: ''
[06:01:13] ✅ Order data extraction completed successfully
[06:01:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:01:13] ℹ️  Using MRN from patient data: '4944011' over '4944011'
[06:01:13] ℹ️  Service line consistent in both sources: 'PT, OT'
[06:01:13] ✅ Patient name cross-validation successful
[06:01:13] ✅    ✅ Data merged successfully
[06:01:15] ✅    ✅ Order data extracted and validated
[06:01:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:01:37] [DOC: 9241336] ✅ Patient exists in API: Eva I Damm, ID: c964ab68-1ba3-47b7-b379-d6e6240b9e18
[06:01:37] ✅    ✅ Existing patient found with ID: c964ab68-1ba3-47b7-b379-d6e6240b9e18
[06:01:37] 🔄 
🔄 Step 6: Pushing order to API...
[06:01:37] [DOC: 9241336] ℹ️  Pushing order via API for patient ID: c964ab68-1ba3-47b7-b379-d6e6240b9e18
[06:01:38] [DOC: 9241336] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:01:38] ❌    ❌ Failed to push order
[06:01:38] 🔄 
🔄 Step 7: Writing to CSV...
[06:01:38] [DOC: 9241336] ℹ️  Calculated age: 77 from DOB: 06/26/1947
[06:01:38] [DOC: 9241336] ℹ️  Service Line extracted: 'PT, OT'
[06:01:38] [DOC: 9241336] ℹ️  Payer Source extracted: ''
[06:01:38] [DOC: 9241336] ℹ️  Diagnosis codes being written:
[06:01:38] [DOC: 9241336] ℹ️    - Latest_Episode_Firstdiagnosis: 'N20.0'
[06:01:38] [DOC: 9241336] ℹ️    - Latest_Episode_Seconddiagnosis: 'N13.6'
[06:01:38] [DOC: 9241336] ℹ️    - Latest_Episode_Thirddiagnosis: 'I11.0'
[06:01:38] [DOC: 9241336] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.9'
[06:01:38] [DOC: 9241336] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R53.1'
[06:01:38] [DOC: 9241336] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R42'
[06:01:38] [DOC: 9241336] ✅ Patient data written to CSV: Eva I Damm | Sex: FEMALE | Age: 77 | Service: PT, OT | Payer:  | MRN: 4944011
[06:01:38] ✅    ✅ Document 9241336 processed and saved successfully
[06:01:38] 🔄 
🔄 Step 8: Saving API details...
[06:01:38] [DOC: 9241336] ℹ️  API push details saved for document 9241336
[06:01:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240854                         ║
================================================================================
[06:01:38] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:01:38] ℹ️  Date: 04/15/2025
[06:01:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:01:41] [DOC: 9240854] ✅ Text extracted using pdfplumber (23453 chars)
[06:01:41] ✅    ✅ Text extracted using pdfplumber (23443 chars)
[06:01:41] 🔄 
🔄 Step 2: Extracting patient data...
[06:01:44] ℹ️  AI extracted raw sex value: 'F'
[06:01:44] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Medical Social Work'
[06:01:44] ℹ️  AI extracted payer source: ''
[06:01:44] ℹ️  AI extracted diagnoses:
[06:01:44] ℹ️    - Diagnosis 1: 'C25.2'
[06:01:44] ℹ️    - Diagnosis 2: 'C78.7'
[06:01:44] ℹ️    - Diagnosis 3: 'R27.0'
[06:01:44] ℹ️    - Diagnosis 4: 'R29.6'
[06:01:44] ℹ️    - Diagnosis 5: 'I10'
[06:01:44] ℹ️    - Diagnosis 6: 'E03.9'
[06:01:44] ℹ️  Final extracted MRN: '3103225'
[06:01:44] ℹ️  Final extracted Sex: 'FEMALE'
[06:01:44] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Medical Social Work'
[06:01:44] ℹ️  Final extracted Payer Source: ''
[06:01:44] ✅ Patient data extraction completed successfully
[06:01:44] ✅    ✅ Patient data extracted successfully
[06:01:44] 📊 Patient Response
     └─ patientFName: Ronalie
     └─ patientLName: Wood
     └─ dob: 02/11/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3103225
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'C25.2', 'secondDiagnosis': 'C78.7', 'thirdDiagnosis': 'R27.0', 'fourthDiagnosis': 'R29.6', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E03.9'}]
[06:01:44] ✅    ✅ Patient identified: Ronalie Wood
[06:01:44] ✅    ✅ Patient name validation passed
[06:01:44] 🔄 
🔄 Step 3: Processing patient dates...
[06:01:44] [DOC: 9240854] ℹ️  DOB normalized: 02/11/1950
[06:01:44] [DOC: 9240854] ℹ️  Episode startOfCare normalized: 03/31/2025
[06:01:44] [DOC: 9240854] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[06:01:44] [DOC: 9240854] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[06:01:44] [DOC: 9240854] ✅ Patient date processing completed successfully
[06:01:44] ✅    ✅ Date processing completed
[06:01:44] 📊 Processed Patient Data
     └─ patientFName: Ronalie
     └─ patientLName: Wood
     └─ dob: 02/11/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3103225
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'C25.2', 'secondDiagnosis': 'C78.7', 'thirdDiagnosis': 'R27.0', 'fourthDiagnosis': 'R29.6', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E03.9'}]
[06:01:44] 🔄 
🔄 Step 4: Extracting order data...
[06:01:47] ℹ️  Order extraction - MRN: '3103225'
[06:01:47] ℹ️  Order extraction - Sex: 'FEMALE'
[06:01:47] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Medical Social Work'
[06:01:47] ℹ️  Order extraction - Payer Source: ''
[06:01:47] ✅ Order data extraction completed successfully
[06:01:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:01:47] ℹ️  Using MRN from patient data: '3103225' over '3103225'
[06:01:47] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Medical Social Work'
[06:01:47] ✅ Patient name cross-validation successful
[06:01:47] ✅    ✅ Data merged successfully
[06:01:49] ✅    ✅ Order data extracted and validated
[06:01:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:02:11] [DOC: 9240854] ℹ️  Patient not found in cache or API: Ronalie Wood
[06:02:11] [DOC: 9240854] ℹ️  Patient not found, creating new patient via API...
[06:02:11] [DOC: 9240854] ℹ️  Creating patient via API: Ronalie Wood
[06:02:12] [DOC: 9240854] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:02:12] ❌    ❌ Failed to create patient
[06:02:12] [DOC: 9240854] ℹ️  API push details saved for document 9240854
================================================================================
║                        Processing Document ID: 9240850                         ║
================================================================================
[06:02:12] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:02:12] ℹ️  Date: 04/15/2025
[06:02:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:02:17] [DOC: 9240850] ✅ Text extracted using pdfplumber (21613 chars)
[06:02:17] ✅    ✅ Text extracted using pdfplumber (21613 chars)
[06:02:17] 🔄 
🔄 Step 2: Extracting patient data...
[06:02:20] ℹ️  AI extracted raw sex value: 'F'
[06:02:20] ℹ️  AI extracted service line: 'Skilled Nursing, MSW, Spiritual Care, HHA'
[06:02:20] ℹ️  AI extracted payer source: ''
[06:02:20] ℹ️  AI extracted diagnoses:
[06:02:20] ℹ️    - Diagnosis 1: 'G30.9'
[06:02:20] ℹ️    - Diagnosis 2: 'N30.00'
[06:02:20] ℹ️    - Diagnosis 3: 'G30.9'
[06:02:20] ℹ️    - Diagnosis 4: 'G93.41'
[06:02:20] ℹ️    - Diagnosis 5: 'F41.9'
[06:02:20] ℹ️    - Diagnosis 6: 'I10'
[06:02:20] ℹ️  Final extracted MRN: '3097362'
[06:02:20] ℹ️  Final extracted Sex: 'FEMALE'
[06:02:20] ℹ️  Final extracted Service Line: 'Skilled Nursing, MSW, Spiritual Care, HHA'
[06:02:20] ℹ️  Final extracted Payer Source: ''
[06:02:20] ✅ Patient data extraction completed successfully
[06:02:20] ✅    ✅ Patient data extracted successfully
[06:02:20] 📊 Patient Response
     └─ patientFName: Olga
     └─ patientLName: Williams
     └─ dob: 03/23/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3097362
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Spiritual Care, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/10/2025', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '07/08/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'N30.00', 'thirdDiagnosis': 'G30.9', 'fourthDiagnosis': 'G93.41', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'I10'}]
[06:02:20] ✅    ✅ Patient identified: Olga Williams
[06:02:20] ✅    ✅ Patient name validation passed
[06:02:20] 🔄 
🔄 Step 3: Processing patient dates...
[06:02:20] [DOC: 9240850] ℹ️  DOB normalized: 03/23/1932
[06:02:20] [DOC: 9240850] ℹ️  Episode startOfCare normalized: 01/10/2025
[06:02:20] [DOC: 9240850] ℹ️  Episode startOfEpisode normalized: 04/10/2025
[06:02:20] [DOC: 9240850] ℹ️  Episode endOfEpisode normalized: 07/08/2025
[06:02:20] [DOC: 9240850] ✅ Patient date processing completed successfully
[06:02:20] ✅    ✅ Date processing completed
[06:02:20] 📊 Processed Patient Data
     └─ patientFName: Olga
     └─ patientLName: Williams
     └─ dob: 03/23/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3097362
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, MSW, Spiritual Care, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/10/2025', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '07/08/2025', 'firstDiagnosis': 'G30.9', 'secondDiagnosis': 'N30.00', 'thirdDiagnosis': 'G30.9', 'fourthDiagnosis': 'G93.41', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'I10'}]
[06:02:20] 🔄 
🔄 Step 4: Extracting order data...
[06:02:23] ℹ️  Order extraction - MRN: '3097362'
[06:02:23] ℹ️  Order extraction - Sex: 'FEMALE'
[06:02:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing, MSW, Clergy, HHA'
[06:02:23] ℹ️  Order extraction - Payer Source: ''
[06:02:23] ✅ Order data extraction completed successfully
[06:02:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:02:23] ℹ️  Using MRN from patient data: '3097362' over '3097362'
[06:02:23] ℹ️  Combined service lines: Patient='Skilled Nursing, MSW, Spiritual Care, HHA' + Order='Skilled Nursing, MSW, Clergy, HHA' = 'Clergy, HHA, MSW, Skilled Nursing, Spiritual Care'
[06:02:23] ✅ Patient name cross-validation successful
[06:02:23] ✅    ✅ Data merged successfully
[06:02:24] ✅    ✅ Order data extracted and validated
[06:02:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:02:39] [DOC: 9240850] ℹ️  Patient not found in cache or API: Olga Williams
[06:02:39] [DOC: 9240850] ℹ️  Patient not found, creating new patient via API...
[06:02:39] [DOC: 9240850] ℹ️  Creating patient via API: Olga Williams
[06:02:41] [DOC: 9240850] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:02:41] ❌    ❌ Failed to create patient
[06:02:41] [DOC: 9240850] ℹ️  API push details saved for document 9240850
================================================================================
║                        Processing Document ID: 9240847                         ║
================================================================================
[06:02:41] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:02:41] ℹ️  Date: 04/15/2025
[06:02:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:02:43] [DOC: 9240847] ✅ Text extracted using pdfplumber (1291 chars)
[06:02:43] ✅    ✅ Text extracted using pdfplumber (1291 chars)
[06:02:43] 🔄 
🔄 Step 2: Extracting patient data...
[06:02:45] ℹ️  AI extracted raw sex value: 'M'
[06:02:45] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:02:45] ℹ️  AI extracted payer source: ''
[06:02:45] ℹ️  AI extracted diagnoses:
[06:02:45] ℹ️    - Diagnosis 1: ''
[06:02:45] ℹ️    - Diagnosis 2: ''
[06:02:45] ℹ️    - Diagnosis 3: ''
[06:02:45] ℹ️    - Diagnosis 4: ''
[06:02:45] ℹ️    - Diagnosis 5: ''
[06:02:45] ℹ️    - Diagnosis 6: ''
[06:02:45] ℹ️  Final extracted MRN: '3091790'
[06:02:45] ℹ️  Final extracted Sex: 'MALE'
[06:02:45] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:02:45] ℹ️  Final extracted Payer Source: ''
[06:02:45] ✅ Patient data extraction completed successfully
[06:02:45] ✅    ✅ Patient data extracted successfully
[06:02:45] 📊 Patient Response
     └─ patientFName: Richard
     └─ patientLName: White
     └─ dob: 12/08/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 3091790
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:02:45] ✅    ✅ Patient identified: Richard White
[06:02:45] ✅    ✅ Patient name validation passed
[06:02:45] 🔄 
🔄 Step 3: Processing patient dates...
[06:02:45] [DOC: 9240847] ℹ️  DOB normalized: 12/08/1957
[06:02:45] [DOC: 9240847] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[06:02:45] [DOC: 9240847] ✅ Patient date processing completed successfully
[06:02:45] ✅    ✅ Date processing completed
[06:02:45] 📊 Processed Patient Data
     └─ patientFName: Richard
     └─ patientLName: White
     └─ dob: 12/08/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 3091790
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:02:45] 🔄 
🔄 Step 4: Extracting order data...
[06:02:47] ℹ️  Order extraction - MRN: '3091790'
[06:02:47] ℹ️  Order extraction - Sex: 'MALE'
[06:02:47] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:02:47] ℹ️  Order extraction - Payer Source: ''
[06:02:47] ✅ Order data extraction completed successfully
[06:02:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:02:47] ℹ️  Using MRN from patient data: '3091790' over '3091790'
[06:02:47] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:02:47] ✅ Patient name cross-validation successful
[06:02:47] ✅    ✅ Data merged successfully
[06:02:48] ✅    ✅ Order data extracted and validated
[06:02:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:02:55] [DOC: 9240847] ℹ️  Patient not found in cache or API: Richard White
[06:02:55] [DOC: 9240847] ℹ️  Patient not found, creating new patient via API...
[06:02:55] [DOC: 9240847] ℹ️  Creating patient via API: Richard White
[06:02:56] [DOC: 9240847] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:02:56] ❌    ❌ Failed to create patient
[06:02:56] [DOC: 9240847] ℹ️  API push details saved for document 9240847
================================================================================
║                        Processing Document ID: 9240841                         ║
================================================================================
[06:02:56] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:02:56] ℹ️  Date: 04/15/2025
[06:02:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:02:59] [DOC: 9240841] ✅ Text extracted using pdfplumber (14968 chars)
[06:02:59] ✅    ✅ Text extracted using pdfplumber (14968 chars)
[06:02:59] 🔄 
🔄 Step 2: Extracting patient data...
[06:03:02] ℹ️  AI extracted raw sex value: 'M'
[06:03:02] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy, Physical Therapy'
[06:03:02] ℹ️  AI extracted payer source: ''
[06:03:02] ℹ️  AI extracted diagnoses:
[06:03:02] ℹ️    - Diagnosis 1: 'K76.82'
[06:03:02] ℹ️    - Diagnosis 2: 'R56.9'
[06:03:02] ℹ️    - Diagnosis 3: 'F10.230'
[06:03:02] ℹ️    - Diagnosis 4: 'W19.XXXD'
[06:03:02] ℹ️    - Diagnosis 5: 'K70.10'
[06:03:02] ℹ️    - Diagnosis 6: 'D69.6'
[06:03:02] ℹ️  Final extracted MRN: '2108620'
[06:03:02] ℹ️  Final extracted Sex: 'MALE'
[06:03:02] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy, Physical Therapy'
[06:03:02] ℹ️  Final extracted Payer Source: ''
[06:03:02] ✅ Patient data extraction completed successfully
[06:03:02] ✅    ✅ Patient data extracted successfully
[06:03:02] 📊 Patient Response
     └─ patientFName: Marc
     └─ patientLName: Warrington
     └─ dob: 08/10/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: 2108620
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Occupational Therapy, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'K76.82', 'secondDiagnosis': 'R56.9', 'thirdDiagnosis': 'F10.230', 'fourthDiagnosis': 'W19.XXXD', 'fifthDiagnosis': 'K70.10', 'sixthDiagnosis': 'D69.6'}]
[06:03:02] ✅    ✅ Patient identified: Marc Warrington
[06:03:02] ✅    ✅ Patient name validation passed
[06:03:02] 🔄 
🔄 Step 3: Processing patient dates...
[06:03:02] [DOC: 9240841] ℹ️  DOB normalized: 08/10/1962
[06:03:02] [DOC: 9240841] ℹ️  Episode startOfCare normalized: 03/20/2025
[06:03:02] [DOC: 9240841] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[06:03:02] [DOC: 9240841] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[06:03:02] [DOC: 9240841] ✅ Patient date processing completed successfully
[06:03:02] ✅    ✅ Date processing completed
[06:03:02] 📊 Processed Patient Data
     └─ patientFName: Marc
     └─ patientLName: Warrington
     └─ dob: 08/10/1962
     └─ patientSex: MALE
     └─ medicalRecordNo: 2108620
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Occupational Therapy, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': 'K76.82', 'secondDiagnosis': 'R56.9', 'thirdDiagnosis': 'F10.230', 'fourthDiagnosis': 'W19.XXXD', 'fifthDiagnosis': 'K70.10', 'sixthDiagnosis': 'D69.6'}]
[06:03:02] 🔄 
🔄 Step 4: Extracting order data...
[06:03:05] ℹ️  Order extraction - MRN: '2108620'
[06:03:05] ℹ️  Order extraction - Sex: 'MALE'
[06:03:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[06:03:05] ℹ️  Order extraction - Payer Source: ''
[06:03:05] ✅ Order data extraction completed successfully
[06:03:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:03:05] ℹ️  Using MRN from patient data: '2108620' over '2108620'
[06:03:05] ℹ️  Combined service lines: Patient='Skilled Nursing, Occupational Therapy, Physical Therapy' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[06:03:05] ✅ Patient name cross-validation successful
[06:03:05] ✅    ✅ Data merged successfully
[06:03:06] ✅    ✅ Order data extracted and validated
[06:03:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:03:16] [DOC: 9240841] ℹ️  Patient not found in cache or API: Marc Warrington
[06:03:16] [DOC: 9240841] ℹ️  Patient not found, creating new patient via API...
[06:03:16] [DOC: 9240841] ℹ️  Creating patient via API: Marc Warrington
[06:03:17] [DOC: 9240841] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:03:17] ❌    ❌ Failed to create patient
[06:03:17] [DOC: 9240841] ℹ️  API push details saved for document 9240841
================================================================================
║                        Processing Document ID: 9240828                         ║
================================================================================
[06:03:17] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:03:17] ℹ️  Date: 04/15/2025
[06:03:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:03:19] [DOC: 9240828] ✅ Text extracted using pdfplumber (1077 chars)
[06:03:19] ✅    ✅ Text extracted using pdfplumber (1077 chars)
[06:03:19] 🔄 
🔄 Step 2: Extracting patient data...
[06:03:22] ℹ️  AI extracted raw sex value: 'F'
[06:03:22] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:03:22] ℹ️  AI extracted payer source: ''
[06:03:22] ℹ️  AI extracted diagnoses:
[06:03:22] ℹ️    - Diagnosis 1: ''
[06:03:22] ℹ️    - Diagnosis 2: ''
[06:03:22] ℹ️    - Diagnosis 3: ''
[06:03:22] ℹ️    - Diagnosis 4: ''
[06:03:22] ℹ️    - Diagnosis 5: ''
[06:03:22] ℹ️    - Diagnosis 6: ''
[06:03:22] ℹ️  Final extracted MRN: '3071654'
[06:03:22] ℹ️  Final extracted Sex: 'FEMALE'
[06:03:22] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:03:22] ℹ️  Final extracted Payer Source: ''
[06:03:22] ✅ Patient data extraction completed successfully
[06:03:22] ✅    ✅ Patient data extracted successfully
[06:03:22] 📊 Patient Response
     └─ patientFName: Tina
     └─ patientLName: Viera
     └─ dob: 08/17/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3071654
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '04/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:03:22] ✅    ✅ Patient identified: Tina Viera
[06:03:22] ✅    ✅ Patient name validation passed
[06:03:22] 🔄 
🔄 Step 3: Processing patient dates...
[06:03:22] [DOC: 9240828] ℹ️  DOB normalized: 08/17/1964
[06:03:22] [DOC: 9240828] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[06:03:22] [DOC: 9240828] ℹ️  Episode endOfEpisode normalized: 04/11/2025
[06:03:22] [DOC: 9240828] ✅ Patient date processing completed successfully
[06:03:22] ✅    ✅ Date processing completed
[06:03:22] 📊 Processed Patient Data
     └─ patientFName: Tina
     └─ patientLName: Viera
     └─ dob: 08/17/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3071654
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '04/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:03:22] 🔄 
🔄 Step 4: Extracting order data...
[06:03:24] ℹ️  Order extraction - MRN: '3071654'
[06:03:24] ℹ️  Order extraction - Sex: 'FEMALE'
[06:03:24] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:03:24] ℹ️  Order extraction - Payer Source: ''
[06:03:24] ✅ Order data extraction completed successfully
[06:03:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:03:24] ℹ️  Using MRN from patient data: '3071654' over '3071654'
[06:03:24] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:03:24] ✅ Patient name cross-validation successful
[06:03:24] ✅    ✅ Data merged successfully
[06:03:25] ✅    ✅ Order data extracted and validated
[06:03:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:03:30] [DOC: 9240828] ℹ️  Patient not found in cache or API: Tina Viera
[06:03:30] [DOC: 9240828] ℹ️  Patient not found, creating new patient via API...
[06:03:30] [DOC: 9240828] ℹ️  Creating patient via API: Tina Viera
[06:03:31] [DOC: 9240828] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:03:31] ❌    ❌ Failed to create patient
[06:03:31] [DOC: 9240828] ℹ️  API push details saved for document 9240828
================================================================================
║                        Processing Document ID: 9240827                         ║
================================================================================
[06:03:31] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:03:31] ℹ️  Date: 04/15/2025
[06:03:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:03:35] [DOC: 9240827] ✅ Text extracted using pdfplumber (27933 chars)
[06:03:35] ✅    ✅ Text extracted using pdfplumber (27933 chars)
[06:03:35] 🔄 
🔄 Step 2: Extracting patient data...
[06:03:39] ℹ️  AI extracted raw sex value: 'F'
[06:03:39] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy, Speech Language Pathology'
[06:03:39] ℹ️  AI extracted payer source: ''
[06:03:39] ℹ️  AI extracted diagnoses:
[06:03:39] ℹ️    - Diagnosis 1: 'Z47.1'
[06:03:39] ℹ️    - Diagnosis 2: 'Z96.652'
[06:03:39] ℹ️    - Diagnosis 3: 'E11.610'
[06:03:39] ℹ️    - Diagnosis 4: 'I12.9'
[06:03:39] ℹ️    - Diagnosis 5: 'E11.22'
[06:03:39] ℹ️    - Diagnosis 6: 'N18.30'
[06:03:39] ℹ️  Final extracted MRN: '2022458'
[06:03:39] ℹ️  Final extracted Sex: 'FEMALE'
[06:03:39] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy, Speech Language Pathology'
[06:03:39] ℹ️  Final extracted Payer Source: ''
[06:03:39] ✅ Patient data extraction completed successfully
[06:03:39] ✅    ✅ Patient data extracted successfully
[06:03:39] 📊 Patient Response
     └─ patientFName: Kathleen
     └─ patientLName: Tripp
     └─ dob: 11/14/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2022458
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy, Speech Language Pathology
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.652', 'thirdDiagnosis': 'E11.610', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.30'}]
[06:03:39] ✅    ✅ Patient identified: Kathleen Tripp
[06:03:39] ✅    ✅ Patient name validation passed
[06:03:39] 🔄 
🔄 Step 3: Processing patient dates...
[06:03:39] [DOC: 9240827] ℹ️  DOB normalized: 11/14/1962
[06:03:39] [DOC: 9240827] ℹ️  Episode startOfCare normalized: 03/31/2025
[06:03:39] [DOC: 9240827] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[06:03:39] [DOC: 9240827] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[06:03:39] [DOC: 9240827] ✅ Patient date processing completed successfully
[06:03:39] ✅    ✅ Date processing completed
[06:03:39] 📊 Processed Patient Data
     └─ patientFName: Kathleen
     └─ patientLName: Tripp
     └─ dob: 11/14/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2022458
     └─ billingProvider: Justin Etter, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy, Speech Language Pathology
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.652', 'thirdDiagnosis': 'E11.610', 'fourthDiagnosis': 'I12.9', 'fifthDiagnosis': 'E11.22', 'sixthDiagnosis': 'N18.30'}]
[06:03:39] 🔄 
🔄 Step 4: Extracting order data...
[06:03:41] ℹ️  Order extraction - MRN: '2022458'
[06:03:41] ℹ️  Order extraction - Sex: 'FEMALE'
[06:03:41] ℹ️  Order extraction - Service Line: 'PT, OT, SLP'
[06:03:41] ℹ️  Order extraction - Payer Source: ''
[06:03:41] ✅ Order data extraction completed successfully
[06:03:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:03:41] ℹ️  Using MRN from patient data: '2022458' over '2022458'
[06:03:41] ℹ️  Combined service lines: Patient='Physical Therapy, Occupational Therapy, Speech Language Pathology' + Order='PT, OT, SLP' = 'OT, Occupational Therapy, PT, Physical Therapy, SLP, Speech Language Pathology'
[06:03:41] ✅ Patient name cross-validation successful
[06:03:41] ✅    ✅ Data merged successfully
[06:03:43] ✅    ✅ Order data extracted and validated
[06:03:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:03:53] [DOC: 9240827] ℹ️  Patient not found in cache or API: Kathleen Tripp
[06:03:53] [DOC: 9240827] ℹ️  Patient not found, creating new patient via API...
[06:03:53] [DOC: 9240827] ℹ️  Creating patient via API: Kathleen Tripp
[06:03:55] [DOC: 9240827] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:03:55] ❌    ❌ Failed to create patient
[06:03:55] [DOC: 9240827] ℹ️  API push details saved for document 9240827
================================================================================
║                        Processing Document ID: 9240812                         ║
================================================================================
[06:03:55] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:03:55] ℹ️  Date: 04/15/2025
[06:03:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:03:56] [DOC: 9240812] ✅ Text extracted using pdfplumber (1321 chars)
[06:03:56] ✅    ✅ Text extracted using pdfplumber (1321 chars)
[06:03:56] 🔄 
🔄 Step 2: Extracting patient data...
[06:03:59] ℹ️  AI extracted raw sex value: 'F'
[06:03:59] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:03:59] ℹ️  AI extracted payer source: ''
[06:03:59] ℹ️  AI extracted diagnoses:
[06:03:59] ℹ️    - Diagnosis 1: ''
[06:03:59] ℹ️    - Diagnosis 2: ''
[06:03:59] ℹ️    - Diagnosis 3: ''
[06:03:59] ℹ️    - Diagnosis 4: ''
[06:03:59] ℹ️    - Diagnosis 5: ''
[06:03:59] ℹ️    - Diagnosis 6: ''
[06:03:59] ℹ️  Final extracted MRN: '2134803'
[06:03:59] ℹ️  Final extracted Sex: 'FEMALE'
[06:03:59] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:03:59] ℹ️  Final extracted Payer Source: ''
[06:03:59] ✅ Patient data extraction completed successfully
[06:03:59] ✅    ✅ Patient data extracted successfully
[06:03:59] 📊 Patient Response
     └─ patientFName: Sylvia
     └─ patientLName: Sandra
     └─ dob: 05/11/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2134803
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:03:59] ✅    ✅ Patient identified: Sylvia Sandra
[06:03:59] ✅    ✅ Patient name validation passed
[06:03:59] 🔄 
🔄 Step 3: Processing patient dates...
[06:03:59] [DOC: 9240812] ℹ️  DOB normalized: 05/11/1945
[06:03:59] [DOC: 9240812] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[06:03:59] [DOC: 9240812] ✅ Patient date processing completed successfully
[06:03:59] ✅    ✅ Date processing completed
[06:03:59] 📊 Processed Patient Data
     └─ patientFName: Sylvia
     └─ patientLName: Sandra
     └─ dob: 05/11/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2134803
     └─ billingProvider: Pamela L. Coury, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:03:59] 🔄 
🔄 Step 4: Extracting order data...
[06:04:01] ℹ️  Order extraction - MRN: '2134803'
[06:04:01] ℹ️  Order extraction - Sex: 'FEMALE'
[06:04:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:04:01] ℹ️  Order extraction - Payer Source: ''
[06:04:01] ✅ Order data extraction completed successfully
[06:04:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:04:01] ℹ️  Using MRN from patient data: '2134803' over '2134803'
[06:04:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:04:01] ✅ Patient name cross-validation successful
[06:04:01] ✅    ✅ Data merged successfully
[06:04:02] ✅    ✅ Order data extracted and validated
[06:04:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:04:08] [DOC: 9240812] ✅ Patient exists in API: Sylvia Sandra, ID: 77bba054-6a2f-402b-9dd7-5a10bc055330
[06:04:08] ✅    ✅ Existing patient found with ID: 77bba054-6a2f-402b-9dd7-5a10bc055330
[06:04:08] 🔄 
🔄 Step 6: Pushing order to API...
[06:04:08] [DOC: 9240812] ℹ️  Pushing order via API for patient ID: 77bba054-6a2f-402b-9dd7-5a10bc055330
[06:04:10] [DOC: 9240812] ❌ Order push failed with status 201: {"id":"0ef89a15-7edc-4c22-b5fa-786037092168","orderWAVId":"ORD20028","orderNo":"1081166","orderDate":"04/11/2025","startOfCare":"04/11/2025","episodeStartDate":"04/11/2025","episodeEndDate":"06/09/2025","documentID":"9240812","mrn":"2134803","patientName":"Sylvia,Sandra","sentToPhysicianDate":"04/15/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/28/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"77bba054-6a2f-402b-9dd7-5a10bc055330","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[06:04:10] ❌    ❌ Failed to push order
[06:04:10] 🔄 
🔄 Step 7: Writing to CSV...
[06:04:10] [DOC: 9240812] ℹ️  Calculated age: 80 from DOB: 05/11/1945
[06:04:10] [DOC: 9240812] ℹ️  Service Line extracted: 'Skilled Nursing'
[06:04:10] [DOC: 9240812] ℹ️  Payer Source extracted: ''
[06:04:10] [DOC: 9240812] ℹ️  Diagnosis codes being written:
[06:04:10] [DOC: 9240812] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:04:10] [DOC: 9240812] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:04:10] [DOC: 9240812] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:04:10] [DOC: 9240812] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:04:10] [DOC: 9240812] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:04:10] [DOC: 9240812] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:04:10] [DOC: 9240812] ✅ Patient data written to CSV: Sylvia Sandra | Sex: FEMALE | Age: 80 | Service: Skilled Nursing | Payer:  | MRN: 2134803
[06:04:10] ✅    ✅ Document 9240812 processed and saved successfully
[06:04:10] 🔄 
🔄 Step 8: Saving API details...
[06:04:10] [DOC: 9240812] ℹ️  API push details saved for document 9240812
[06:04:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240807                         ║
================================================================================
[06:04:10] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:04:10] ℹ️  Date: 04/15/2025
[06:04:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:04:11] [DOC: 9240807] ✅ Text extracted using pdfplumber (963 chars)
[06:04:11] ✅    ✅ Text extracted using pdfplumber (963 chars)
[06:04:11] 🔄 
🔄 Step 2: Extracting patient data...
[06:04:14] ℹ️  AI extracted raw sex value: 'M'
[06:04:14] ℹ️  AI extracted service line: ''
[06:04:14] ℹ️  AI extracted payer source: ''
[06:04:14] ℹ️  AI extracted diagnoses:
[06:04:14] ℹ️    - Diagnosis 1: ''
[06:04:14] ℹ️    - Diagnosis 2: ''
[06:04:14] ℹ️    - Diagnosis 3: ''
[06:04:14] ℹ️    - Diagnosis 4: ''
[06:04:14] ℹ️    - Diagnosis 5: ''
[06:04:14] ℹ️    - Diagnosis 6: ''
[06:04:14] ℹ️  Final extracted MRN: '2998670'
[06:04:14] ℹ️  Final extracted Sex: 'MALE'
[06:04:14] ℹ️  Final extracted Service Line: ''
[06:04:14] ℹ️  Final extracted Payer Source: ''
[06:04:14] ✅ Patient data extraction completed successfully
[06:04:14] ✅    ✅ Patient data extracted successfully
[06:04:14] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:04:14] ✅    ✅ Patient identified: Raymond Souza
[06:04:14] ✅    ✅ Patient name validation passed
[06:04:14] 🔄 
🔄 Step 3: Processing patient dates...
[06:04:14] [DOC: 9240807] ℹ️  DOB normalized: 06/18/1927
[06:04:14] [DOC: 9240807] ✅ Patient date processing completed successfully
[06:04:14] ✅    ✅ Date processing completed
[06:04:14] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Souza
     └─ dob: 06/18/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 2998670
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:04:14] 🔄 
🔄 Step 4: Extracting order data...
[06:04:16] ℹ️  Order extraction - MRN: '2998670'
[06:04:16] ℹ️  Order extraction - Sex: 'MALE'
[06:04:16] ℹ️  Order extraction - Service Line: ''
[06:04:16] ℹ️  Order extraction - Payer Source: ''
[06:04:16] ✅ Order data extraction completed successfully
[06:04:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:04:16] ℹ️  Using MRN from patient data: '2998670' over '2998670'
[06:04:16] ✅ Patient name cross-validation successful
[06:04:16] ✅    ✅ Data merged successfully
[06:04:17] ✅    ✅ Order data extracted and validated
[06:04:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:04:17] [DOC: 9240807] ✅ Patient found in local cache: Raymond Souza, ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[06:04:17] ✅    ✅ Existing patient found with ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[06:04:17] 🔄 
🔄 Step 6: Pushing order to API...
[06:04:17] [DOC: 9240807] ℹ️  Pushing order via API for patient ID: da0edc07-3b5b-4691-8a9b-77caf22853f9
[06:04:19] [DOC: 9240807] ❌ Order push failed with status 201: {"id":"27672eaa-ea72-42ff-887d-71f55210b0b8","orderWAVId":"ORD20029","orderNo":"1080693","orderDate":"04/10/2025","startOfCare":"04/17/2025","episodeStartDate":"04/17/2025","episodeEndDate":"06/15/2025","documentID":"9240807","mrn":"2998670","patientName":"Souza,Raymond","sentToPhysicianDate":"04/15/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/23/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"da0edc07-3b5b-4691-8a9b-77caf22853f9","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[06:04:19] ❌    ❌ Failed to push order
[06:04:19] 🔄 
🔄 Step 7: Writing to CSV...
[06:04:19] [DOC: 9240807] ℹ️  Calculated age: 97 from DOB: 06/18/1927
[06:04:19] [DOC: 9240807] ℹ️  Service Line extracted: ''
[06:04:19] [DOC: 9240807] ℹ️  Payer Source extracted: ''
[06:04:19] [DOC: 9240807] ℹ️  Diagnosis codes being written:
[06:04:19] [DOC: 9240807] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:04:19] [DOC: 9240807] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:04:19] [DOC: 9240807] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:04:19] [DOC: 9240807] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:04:19] [DOC: 9240807] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:04:19] [DOC: 9240807] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:04:19] [DOC: 9240807] ✅ Patient data written to CSV: Raymond Souza | Sex: MALE | Age: 97 | Service:  | Payer:  | MRN: 2998670
[06:04:19] ✅    ✅ Document 9240807 processed and saved successfully
[06:04:19] 🔄 
🔄 Step 8: Saving API details...
[06:04:19] [DOC: 9240807] ℹ️  API push details saved for document 9240807
[06:04:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240779                         ║
================================================================================
[06:04:19] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:04:19] ℹ️  Date: 04/15/2025
[06:04:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:04:20] [DOC: 9240779] ✅ Text extracted using pdfplumber (947 chars)
[06:04:20] ✅    ✅ Text extracted using pdfplumber (947 chars)
[06:04:20] 🔄 
🔄 Step 2: Extracting patient data...
[06:04:23] ℹ️  AI extracted raw sex value: 'F'
[06:04:23] ℹ️  AI extracted service line: ''
[06:04:23] ℹ️  AI extracted payer source: ''
[06:04:23] ℹ️  AI extracted diagnoses:
[06:04:23] ℹ️    - Diagnosis 1: ''
[06:04:23] ℹ️    - Diagnosis 2: ''
[06:04:23] ℹ️    - Diagnosis 3: ''
[06:04:23] ℹ️    - Diagnosis 4: ''
[06:04:23] ℹ️    - Diagnosis 5: ''
[06:04:23] ℹ️    - Diagnosis 6: ''
[06:04:23] ℹ️  Final extracted MRN: '2901289'
[06:04:23] ℹ️  Final extracted Sex: 'FEMALE'
[06:04:23] ℹ️  Final extracted Service Line: ''
[06:04:23] ℹ️  Final extracted Payer Source: ''
[06:04:23] ✅ Patient data extraction completed successfully
[06:04:23] ✅    ✅ Patient data extracted successfully
[06:04:23] 📊 Patient Response
     └─ patientFName: Ann
     └─ patientLName: Richmond
     └─ dob: 01/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2901289
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:04:23] ✅    ✅ Patient identified: Ann Richmond
[06:04:23] ✅    ✅ Patient name validation passed
[06:04:23] 🔄 
🔄 Step 3: Processing patient dates...
[06:04:23] [DOC: 9240779] ℹ️  DOB normalized: 01/23/1941
[06:04:23] [DOC: 9240779] ✅ Patient date processing completed successfully
[06:04:23] ✅    ✅ Date processing completed
[06:04:23] 📊 Processed Patient Data
     └─ patientFName: Ann
     └─ patientLName: Richmond
     └─ dob: 01/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2901289
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:04:23] 🔄 
🔄 Step 4: Extracting order data...
[06:04:25] ℹ️  Order extraction - MRN: '2901289'
[06:04:25] ℹ️  Order extraction - Sex: 'FEMALE'
[06:04:25] ℹ️  Order extraction - Service Line: ''
[06:04:25] ℹ️  Order extraction - Payer Source: ''
[06:04:25] ✅ Order data extraction completed successfully
[06:04:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:04:25] ℹ️  Using MRN from patient data: '2901289' over '2901289'
[06:04:25] ✅ Patient name cross-validation successful
[06:04:25] ✅    ✅ Data merged successfully
[06:04:27] ⚠️     ❌ Skipping - missing episode start date
[06:04:27] [DOC: 9240779] ℹ️  API push details saved for document 9240779
================================================================================
║                        Processing Document ID: 9240776                         ║
================================================================================
[06:04:27] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:04:27] ℹ️  Date: 04/15/2025
[06:04:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:04:28] [DOC: 9240776] ✅ Text extracted using pdfplumber (1778 chars)
[06:04:28] ✅    ✅ Text extracted using pdfplumber (1778 chars)
[06:04:28] 🔄 
🔄 Step 2: Extracting patient data...
[06:04:30] ℹ️  AI extracted raw sex value: 'F'
[06:04:30] ℹ️  AI extracted service line: 'Physical Therapy'
[06:04:30] ℹ️  AI extracted payer source: ''
[06:04:30] ℹ️  AI extracted diagnoses:
[06:04:30] ℹ️    - Diagnosis 1: ''
[06:04:30] ℹ️    - Diagnosis 2: ''
[06:04:30] ℹ️    - Diagnosis 3: ''
[06:04:30] ℹ️    - Diagnosis 4: ''
[06:04:30] ℹ️    - Diagnosis 5: ''
[06:04:30] ℹ️    - Diagnosis 6: ''
[06:04:30] ℹ️  Final extracted MRN: '2883161'
[06:04:30] ℹ️  Final extracted Sex: 'FEMALE'
[06:04:30] ℹ️  Final extracted Service Line: 'Physical Therapy'
[06:04:30] ℹ️  Final extracted Payer Source: ''
[06:04:30] ✅ Patient data extraction completed successfully
[06:04:30] ✅    ✅ Patient data extracted successfully
[06:04:30] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Raposo
     └─ dob: 03/28/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2883161
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:04:30] ✅    ✅ Patient identified: Maria Raposo
[06:04:30] ✅    ✅ Patient name validation passed
[06:04:30] 🔄 
🔄 Step 3: Processing patient dates...
[06:04:30] [DOC: 9240776] ℹ️  DOB normalized: 03/28/1955
[06:04:30] [DOC: 9240776] ✅ Patient date processing completed successfully
[06:04:30] ✅    ✅ Date processing completed
[06:04:30] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Raposo
     └─ dob: 03/28/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2883161
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:04:30] 🔄 
🔄 Step 4: Extracting order data...
[06:04:33] ℹ️  Order extraction - MRN: '2883161'
[06:04:33] ℹ️  Order extraction - Sex: 'FEMALE'
[06:04:33] ℹ️  Order extraction - Service Line: ''
[06:04:33] ℹ️  Order extraction - Payer Source: ''
[06:04:33] ✅ Order data extraction completed successfully
[06:04:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:04:33] ℹ️  Using MRN from patient data: '2883161' over '2883161'
[06:04:33] ℹ️  Using service line from patient data: 'Physical Therapy'
[06:04:33] ✅ Patient name cross-validation successful
[06:04:33] ✅    ✅ Data merged successfully
[06:04:34] ✅    ✅ Order data extracted and validated
[06:04:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:04:40] [DOC: 9240776] ℹ️  Patient not found in cache or API: Maria Raposo
[06:04:40] [DOC: 9240776] ℹ️  Patient not found, creating new patient via API...
[06:04:40] [DOC: 9240776] ℹ️  Creating patient via API: Maria Raposo
[06:04:41] [DOC: 9240776] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:04:41] ❌    ❌ Failed to create patient
[06:04:41] [DOC: 9240776] ℹ️  API push details saved for document 9240776
================================================================================
║                        Processing Document ID: 9240758                         ║
================================================================================
[06:04:41] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:04:41] ℹ️  Date: 04/15/2025
[06:04:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:04:43] [DOC: 9240758] ✅ Text extracted using pdfplumber (2731 chars)
[06:04:43] ✅    ✅ Text extracted using pdfplumber (2731 chars)
[06:04:43] 🔄 
🔄 Step 2: Extracting patient data...
[06:04:46] ℹ️  AI extracted raw sex value: 'M'
[06:04:46] ℹ️  AI extracted service line: 'RN'
[06:04:46] ℹ️  AI extracted payer source: ''
[06:04:46] ℹ️  AI extracted diagnoses:
[06:04:46] ℹ️    - Diagnosis 1: 'None'
[06:04:46] ℹ️    - Diagnosis 2: 'None'
[06:04:46] ℹ️    - Diagnosis 3: 'None'
[06:04:46] ℹ️    - Diagnosis 4: 'None'
[06:04:46] ℹ️    - Diagnosis 5: 'None'
[06:04:46] ℹ️    - Diagnosis 6: 'None'
[06:04:46] ℹ️  Final extracted MRN: '2060640'
[06:04:46] ℹ️  Final extracted Sex: 'MALE'
[06:04:46] ℹ️  Final extracted Service Line: 'RN'
[06:04:46] ℹ️  Final extracted Payer Source: ''
[06:04:46] ✅ Patient data extraction completed successfully
[06:04:46] ✅    ✅ Patient data extracted successfully
[06:04:46] 📊 Patient Response
     └─ patientFName: Elisio
     └─ patientLName: Pimental
     └─ dob: 05/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2060640
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:04:46] ✅    ✅ Patient identified: Elisio Pimental
[06:04:46] ✅    ✅ Patient name validation passed
[06:04:46] 🔄 
🔄 Step 3: Processing patient dates...
[06:04:46] [DOC: 9240758] ℹ️  DOB normalized: 05/17/1944
[06:04:46] [DOC: 9240758] ✅ Patient date processing completed successfully
[06:04:46] ✅    ✅ Date processing completed
[06:04:46] 📊 Processed Patient Data
     └─ patientFName: Elisio
     └─ patientLName: Pimental
     └─ dob: 05/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2060640
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[06:04:46] 🔄 
🔄 Step 4: Extracting order data...
[06:04:48] ℹ️  Order extraction - MRN: '2060640'
[06:04:48] ℹ️  Order extraction - Sex: 'MALE'
[06:04:48] ℹ️  Order extraction - Service Line: ''
[06:04:48] ℹ️  Order extraction - Payer Source: ''
[06:04:48] ✅ Order data extraction completed successfully
[06:04:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:04:48] ℹ️  Using MRN from patient data: '2060640' over '2060640'
[06:04:48] ℹ️  Using service line from patient data: 'RN'
[06:04:48] ✅ Patient name cross-validation successful
[06:04:48] ✅    ✅ Data merged successfully
[06:04:50] ✅    ✅ Order data extracted and validated
[06:04:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:04:54] [DOC: 9240758] ✅ Patient exists in API: Elisio Pimental, ID: 5abd79cf-ab92-43b9-8f9e-55ba862ed92b
[06:04:54] ✅    ✅ Existing patient found with ID: 5abd79cf-ab92-43b9-8f9e-55ba862ed92b
[06:04:54] 🔄 
🔄 Step 6: Pushing order to API...
[06:04:54] [DOC: 9240758] ℹ️  Pushing order via API for patient ID: 5abd79cf-ab92-43b9-8f9e-55ba862ed92b
[06:04:56] [DOC: 9240758] ❌ Order push failed with status 201: {"id":"966b924e-5f0c-4cff-9d06-219ed4610da0","orderWAVId":"ORD20030","orderNo":"1081088, 1081089, 1081090, 1081091, 1081092","orderDate":"04/11/2025","startOfCare":"03/25/2025","episodeStartDate":"03/25/2025","episodeEndDate":"05/23/2025","documentID":"9240758","mrn":"2060640","patientName":"Pimental,Elisio C","sentToPhysicianDate":"04/15/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/18/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"5abd79cf-ab92-43b9-8f9e-55ba862ed92b","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[06:04:56] ❌    ❌ Failed to push order
[06:04:56] 🔄 
🔄 Step 7: Writing to CSV...
[06:04:56] [DOC: 9240758] ℹ️  Calculated age: 81 from DOB: 05/17/1944
[06:04:56] [DOC: 9240758] ℹ️  Service Line extracted: 'RN'
[06:04:56] [DOC: 9240758] ℹ️  Payer Source extracted: ''
[06:04:56] [DOC: 9240758] ℹ️  Diagnosis codes being written:
[06:04:56] [DOC: 9240758] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:04:56] [DOC: 9240758] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:04:56] [DOC: 9240758] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:04:56] [DOC: 9240758] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:04:56] [DOC: 9240758] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:04:56] [DOC: 9240758] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:04:56] [DOC: 9240758] ✅ Patient data written to CSV: Elisio Pimental | Sex: MALE | Age: 81 | Service: RN | Payer:  | MRN: 2060640
[06:04:56] ✅    ✅ Document 9240758 processed and saved successfully
[06:04:56] 🔄 
🔄 Step 8: Saving API details...
[06:04:56] [DOC: 9240758] ℹ️  API push details saved for document 9240758
[06:04:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240754                         ║
================================================================================
[06:04:56] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:04:56] ℹ️  Date: 04/15/2025
[06:04:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:04:58] [DOC: 9240754] ✅ Text extracted using pdfplumber (1676 chars)
[06:04:58] ✅    ✅ Text extracted using pdfplumber (1676 chars)
[06:04:58] 🔄 
🔄 Step 2: Extracting patient data...
[06:05:00] ℹ️  AI extracted raw sex value: 'M'
[06:05:00] ℹ️  AI extracted service line: 'Nursing'
[06:05:00] ℹ️  AI extracted payer source: ''
[06:05:00] ℹ️  AI extracted diagnoses:
[06:05:00] ℹ️    - Diagnosis 1: 'None'
[06:05:00] ℹ️    - Diagnosis 2: 'None'
[06:05:00] ℹ️    - Diagnosis 3: 'None'
[06:05:00] ℹ️    - Diagnosis 4: 'None'
[06:05:00] ℹ️    - Diagnosis 5: 'None'
[06:05:00] ℹ️    - Diagnosis 6: 'None'
[06:05:00] ℹ️  Final extracted MRN: '2716471'
[06:05:00] ℹ️  Final extracted Sex: 'MALE'
[06:05:00] ℹ️  Final extracted Service Line: 'Nursing'
[06:05:00] ℹ️  Final extracted Payer Source: ''
[06:05:00] ✅ Patient data extraction completed successfully
[06:05:00] ✅    ✅ Patient data extracted successfully
[06:05:00] 📊 Patient Response
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:05:00] ✅    ✅ Patient identified: Thomas McCormack
[06:05:00] ✅    ✅ Patient name validation passed
[06:05:00] 🔄 
🔄 Step 3: Processing patient dates...
[06:05:00] [DOC: 9240754] ℹ️  DOB normalized: 03/17/1944
[06:05:00] [DOC: 9240754] ✅ Patient date processing completed successfully
[06:05:00] ✅    ✅ Date processing completed
[06:05:00] 📊 Processed Patient Data
     └─ patientFName: Thomas
     └─ patientLName: McCormack
     └─ dob: 03/17/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2716471
     └─ billingProvider: David J. Shih, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[06:05:00] 🔄 
🔄 Step 4: Extracting order data...
[06:05:02] ℹ️  Order extraction - MRN: '2716471'
[06:05:02] ℹ️  Order extraction - Sex: 'MALE'
[06:05:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:05:02] ℹ️  Order extraction - Payer Source: ''
[06:05:02] ✅ Order data extraction completed successfully
[06:05:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:05:02] ℹ️  Using MRN from patient data: '2716471' over '2716471'
[06:05:02] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[06:05:02] ✅ Patient name cross-validation successful
[06:05:02] ✅    ✅ Data merged successfully
[06:05:04] ✅    ✅ Order data extracted and validated
[06:05:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:05:09] [DOC: 9240754] ✅ Patient exists in API: Thomas McCormack, ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[06:05:09] ✅    ✅ Existing patient found with ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[06:05:09] 🔄 
🔄 Step 6: Pushing order to API...
[06:05:09] [DOC: 9240754] ℹ️  Pushing order via API for patient ID: 1db61e7b-1106-4e8c-a39a-d34ed54ada4a
[06:05:10] [DOC: 9240754] ❌ Order push failed with status 201: {"id":"320cc7dd-64b6-4dbd-b400-3015f9b2934e","orderWAVId":"ORD20031","orderNo":"1081193, 1081194","orderDate":"04/11/2025","startOfCare":"03/05/2025","episodeStartDate":"03/05/2025","episodeEndDate":"05/03/2025","documentID":"9240754","mrn":"2716471","patientName":"McCormack,Thomas C","sentToPhysicianDate":"04/15/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/18/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Prescriptions","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"1db61e7b-1106-4e8c-a39a-d34ed54ada4a","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[06:05:10] ❌    ❌ Failed to push order
[06:05:10] 🔄 
🔄 Step 7: Writing to CSV...
[06:05:10] [DOC: 9240754] ℹ️  Calculated age: 81 from DOB: 03/17/1944
[06:05:10] [DOC: 9240754] ℹ️  Service Line extracted: 'Nursing, Skilled Nursing'
[06:05:10] [DOC: 9240754] ℹ️  Payer Source extracted: ''
[06:05:10] [DOC: 9240754] ℹ️  Diagnosis codes being written:
[06:05:10] [DOC: 9240754] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:05:10] [DOC: 9240754] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:05:10] [DOC: 9240754] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:05:10] [DOC: 9240754] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:05:10] [DOC: 9240754] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:05:10] [DOC: 9240754] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:05:10] [DOC: 9240754] ✅ Patient data written to CSV: Thomas McCormack | Sex: MALE | Age: 81 | Service: Nursing, Skilled Nursing | Payer:  | MRN: 2716471
[06:05:10] ✅    ✅ Document 9240754 processed and saved successfully
[06:05:10] 🔄 
🔄 Step 8: Saving API details...
[06:05:10] [DOC: 9240754] ℹ️  API push details saved for document 9240754
[06:05:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240746                         ║
================================================================================
[06:05:10] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:05:10] ℹ️  Date: 04/15/2025
[06:05:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:05:12] [DOC: 9240746] ✅ Text extracted using pdfplumber (1133 chars)
[06:05:12] ✅    ✅ Text extracted using pdfplumber (1133 chars)
[06:05:12] 🔄 
🔄 Step 2: Extracting patient data...
[06:05:15] ℹ️  AI extracted raw sex value: 'F'
[06:05:15] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:05:15] ℹ️  AI extracted payer source: ''
[06:05:15] ℹ️  AI extracted diagnoses:
[06:05:15] ℹ️    - Diagnosis 1: ''
[06:05:15] ℹ️    - Diagnosis 2: ''
[06:05:15] ℹ️    - Diagnosis 3: ''
[06:05:15] ℹ️    - Diagnosis 4: ''
[06:05:15] ℹ️    - Diagnosis 5: ''
[06:05:15] ℹ️    - Diagnosis 6: ''
[06:05:15] ℹ️  Final extracted MRN: '2622983'
[06:05:15] ℹ️  Final extracted Sex: 'FEMALE'
[06:05:15] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:05:15] ℹ️  Final extracted Payer Source: ''
[06:05:15] ✅ Patient data extraction completed successfully
[06:05:15] ✅    ✅ Patient data extracted successfully
[06:05:15] 📊 Patient Response
     └─ patientFName: Mary Lou
     └─ patientLName: Kobak
     └─ dob: 02/18/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2622983
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:05:15] ✅    ✅ Patient identified: Mary Lou Kobak
[06:05:15] ✅    ✅ Patient name validation passed
[06:05:15] 🔄 
🔄 Step 3: Processing patient dates...
[06:05:15] [DOC: 9240746] ℹ️  DOB normalized: 02/18/1940
[06:05:15] [DOC: 9240746] ✅ Patient date processing completed successfully
[06:05:15] ✅    ✅ Date processing completed
[06:05:15] 📊 Processed Patient Data
     └─ patientFName: Mary Lou
     └─ patientLName: Kobak
     └─ dob: 02/18/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2622983
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:05:15] 🔄 
🔄 Step 4: Extracting order data...
[06:05:17] ℹ️  Order extraction - MRN: '2622983'
[06:05:17] ℹ️  Order extraction - Sex: 'FEMALE'
[06:05:17] ℹ️  Order extraction - Service Line: ''
[06:05:17] ℹ️  Order extraction - Payer Source: ''
[06:05:17] ✅ Order data extraction completed successfully
[06:05:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:05:17] ℹ️  Using MRN from patient data: '2622983' over '2622983'
[06:05:17] ℹ️  Using service line from patient data: 'Skilled Nursing'
[06:05:17] ✅ Patient name cross-validation successful
[06:05:17] ✅    ✅ Data merged successfully
[06:05:18] ⚠️     ❌ Skipping - missing episode start date
[06:05:18] [DOC: 9240746] ℹ️  API push details saved for document 9240746
================================================================================
║                        Processing Document ID: 9240744                         ║
================================================================================
[06:05:18] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:05:18] ℹ️  Date: 04/15/2025
[06:05:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:05:20] [DOC: 9240744] ✅ Text extracted using pdfplumber (6244 chars)
[06:05:20] ✅    ✅ Text extracted using pdfplumber (6244 chars)
[06:05:20] 🔄 
🔄 Step 2: Extracting patient data...
[06:05:23] ℹ️  AI extracted raw sex value: 'F'
[06:05:23] ℹ️  AI extracted service line: 'Nursing'
[06:05:23] ℹ️  AI extracted payer source: ''
[06:05:23] ℹ️  AI extracted diagnoses:
[06:05:23] ℹ️    - Diagnosis 1: 'G31.83'
[06:05:23] ℹ️    - Diagnosis 2: 'F02.80'
[06:05:23] ℹ️    - Diagnosis 3: ''
[06:05:23] ℹ️    - Diagnosis 4: ''
[06:05:23] ℹ️    - Diagnosis 5: ''
[06:05:23] ℹ️    - Diagnosis 6: ''
[06:05:23] ℹ️  Final extracted MRN: '2622983'
[06:05:23] ℹ️  Final extracted Sex: 'FEMALE'
[06:05:23] ℹ️  Final extracted Service Line: 'Nursing'
[06:05:23] ℹ️  Final extracted Payer Source: ''
[06:05:23] ✅ Patient data extraction completed successfully
[06:05:23] ✅    ✅ Patient data extracted successfully
[06:05:23] 📊 Patient Response
     └─ patientFName: Mary Lou
     └─ patientLName: Kobak
     └─ dob: 02/18/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2622983
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': 'G31.83', 'secondDiagnosis': 'F02.80', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:05:23] ✅    ✅ Patient identified: Mary Lou Kobak
[06:05:23] ✅    ✅ Patient name validation passed
[06:05:23] 🔄 
🔄 Step 3: Processing patient dates...
[06:05:23] [DOC: 9240744] ℹ️  DOB normalized: 02/18/1940
[06:05:23] [DOC: 9240744] ℹ️  Episode startOfCare normalized: 04/12/2025
[06:05:23] [DOC: 9240744] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[06:05:23] [DOC: 9240744] ℹ️  Episode endOfEpisode normalized: 07/10/2025
[06:05:23] [DOC: 9240744] ✅ Patient date processing completed successfully
[06:05:23] ✅    ✅ Date processing completed
[06:05:23] 📊 Processed Patient Data
     └─ patientFName: Mary Lou
     └─ patientLName: Kobak
     └─ dob: 02/18/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2622983
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': 'G31.83', 'secondDiagnosis': 'F02.80', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:05:23] 🔄 
🔄 Step 4: Extracting order data...
[06:05:25] ℹ️  Order extraction - MRN: '2622983'
[06:05:25] ℹ️  Order extraction - Sex: 'FEMALE'
[06:05:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:05:25] ℹ️  Order extraction - Payer Source: ''
[06:05:25] ✅ Order data extraction completed successfully
[06:05:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:05:25] ℹ️  Using MRN from patient data: '2622983' over '2622983'
[06:05:25] ℹ️  Combined service lines: Patient='Nursing' + Order='Skilled Nursing' = 'Nursing, Skilled Nursing'
[06:05:25] ✅ Patient name cross-validation successful
[06:05:25] ✅    ✅ Data merged successfully
[06:05:27] ✅    ✅ Order data extracted and validated
[06:05:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:05:27] [DOC: 9240744] ✅ Patient found in local cache: Mary Lou Kobak, ID: c7477e1a-450b-42e0-9fef-ef96699b4730
[06:05:27] ✅    ✅ Existing patient found with ID: c7477e1a-450b-42e0-9fef-ef96699b4730
[06:05:27] 🔄 
🔄 Step 6: Pushing order to API...
[06:05:27] [DOC: 9240744] ℹ️  Pushing order via API for patient ID: c7477e1a-450b-42e0-9fef-ef96699b4730
[06:05:28] [DOC: 9240744] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13107"}
[06:05:28] ❌    ❌ Failed to push order
[06:05:28] 🔄 
🔄 Step 7: Writing to CSV...
[06:05:28] [DOC: 9240744] ℹ️  Calculated age: 85 from DOB: 02/18/1940
[06:05:28] [DOC: 9240744] ℹ️  Service Line extracted: 'Nursing, Skilled Nursing'
[06:05:28] [DOC: 9240744] ℹ️  Payer Source extracted: ''
[06:05:28] [DOC: 9240744] ℹ️  Diagnosis codes being written:
[06:05:28] [DOC: 9240744] ℹ️    - Latest_Episode_Firstdiagnosis: 'G31.83'
[06:05:28] [DOC: 9240744] ℹ️    - Latest_Episode_Seconddiagnosis: 'F02.80'
[06:05:28] [DOC: 9240744] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:05:28] [DOC: 9240744] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:05:28] [DOC: 9240744] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:05:28] [DOC: 9240744] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:05:28] [DOC: 9240744] ✅ Patient data written to CSV: Mary Lou Kobak | Sex: FEMALE | Age: 85 | Service: Nursing, Skilled Nursing | Payer:  | MRN: 2622983
[06:05:28] ✅    ✅ Document 9240744 processed and saved successfully
[06:05:28] 🔄 
🔄 Step 8: Saving API details...
[06:05:28] [DOC: 9240744] ℹ️  API push details saved for document 9240744
[06:05:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240727                         ║
================================================================================
[06:05:28] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:05:28] ℹ️  Date: 04/15/2025
[06:05:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:05:31] [DOC: 9240727] ✅ Text extracted using pdfplumber (21618 chars)
[06:05:31] ✅    ✅ Text extracted using pdfplumber (21618 chars)
[06:05:31] 🔄 
🔄 Step 2: Extracting patient data...
[06:05:35] ℹ️  AI extracted raw sex value: 'F'
[06:05:35] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[06:05:35] ℹ️  AI extracted payer source: ''
[06:05:35] ℹ️  AI extracted diagnoses:
[06:05:35] ℹ️    - Diagnosis 1: 'N39.0'
[06:05:35] ℹ️    - Diagnosis 2: 'R31.9'
[06:05:35] ℹ️    - Diagnosis 3: 'K29.70'
[06:05:35] ℹ️    - Diagnosis 4: 'B37.81'
[06:05:35] ℹ️    - Diagnosis 5: 'E43'
[06:05:35] ℹ️    - Diagnosis 6: 'K21.00'
[06:05:35] ℹ️  Final extracted MRN: '2577119'
[06:05:35] ℹ️  Final extracted Sex: 'FEMALE'
[06:05:35] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[06:05:35] ℹ️  Final extracted Payer Source: ''
[06:05:35] ✅ Patient data extraction completed successfully
[06:05:35] ✅    ✅ Patient data extracted successfully
[06:05:35] 📊 Patient Response
     └─ patientFName: Marilyn
     └─ patientLName: Hood
     └─ dob: 10/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2577119
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'R31.9', 'thirdDiagnosis': 'K29.70', 'fourthDiagnosis': 'B37.81', 'fifthDiagnosis': 'E43', 'sixthDiagnosis': 'K21.00'}]
[06:05:35] ✅    ✅ Patient identified: Marilyn Hood
[06:05:35] ✅    ✅ Patient name validation passed
[06:05:35] 🔄 
🔄 Step 3: Processing patient dates...
[06:05:35] [DOC: 9240727] ℹ️  DOB normalized: 10/23/1941
[06:05:35] [DOC: 9240727] ℹ️  Episode startOfCare normalized: 03/27/2025
[06:05:35] [DOC: 9240727] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[06:05:35] [DOC: 9240727] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[06:05:35] [DOC: 9240727] ✅ Patient date processing completed successfully
[06:05:35] ✅    ✅ Date processing completed
[06:05:35] 📊 Processed Patient Data
     └─ patientFName: Marilyn
     └─ patientLName: Hood
     └─ dob: 10/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2577119
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'N39.0', 'secondDiagnosis': 'R31.9', 'thirdDiagnosis': 'K29.70', 'fourthDiagnosis': 'B37.81', 'fifthDiagnosis': 'E43', 'sixthDiagnosis': 'K21.00'}]
[06:05:35] 🔄 
🔄 Step 4: Extracting order data...
[06:05:38] ℹ️  Order extraction - MRN: '2577119'
[06:05:38] ℹ️  Order extraction - Sex: 'FEMALE'
[06:05:38] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[06:05:38] ℹ️  Order extraction - Payer Source: ''
[06:05:38] ✅ Order data extraction completed successfully
[06:05:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:05:38] ℹ️  Using MRN from patient data: '2577119' over '2577119'
[06:05:38] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[06:05:38] ✅ Patient name cross-validation successful
[06:05:38] ✅    ✅ Data merged successfully
[06:05:39] ✅    ✅ Order data extracted and validated
[06:05:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:05:39] [DOC: 9240727] ✅ Patient found in local cache: Marilyn Hood, ID: 6dbefab8-cca3-4e53-942e-025025b735f3
[06:05:39] ✅    ✅ Existing patient found with ID: 6dbefab8-cca3-4e53-942e-025025b735f3
[06:05:39] 🔄 
🔄 Step 6: Pushing order to API...
[06:05:39] [DOC: 9240727] ℹ️  Pushing order via API for patient ID: 6dbefab8-cca3-4e53-942e-025025b735f3
[06:05:40] [DOC: 9240727] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13070"}
[06:05:40] ❌    ❌ Failed to push order
[06:05:40] 🔄 
🔄 Step 7: Writing to CSV...
[06:05:40] [DOC: 9240727] ℹ️  Calculated age: 83 from DOB: 10/23/1941
[06:05:40] [DOC: 9240727] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[06:05:40] [DOC: 9240727] ℹ️  Payer Source extracted: ''
[06:05:40] [DOC: 9240727] ℹ️  Diagnosis codes being written:
[06:05:40] [DOC: 9240727] ℹ️    - Latest_Episode_Firstdiagnosis: 'N39.0'
[06:05:40] [DOC: 9240727] ℹ️    - Latest_Episode_Seconddiagnosis: 'R31.9'
[06:05:40] [DOC: 9240727] ℹ️    - Latest_Episode_Thirddiagnosis: 'K29.70'
[06:05:40] [DOC: 9240727] ℹ️    - Latest_Episode_Fourthdiagnosis: 'B37.81'
[06:05:40] [DOC: 9240727] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E43'
[06:05:40] [DOC: 9240727] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K21.00'
[06:05:40] [DOC: 9240727] ✅ Patient data written to CSV: Marilyn Hood | Sex: FEMALE | Age: 83 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: 2577119
[06:05:40] ✅    ✅ Document 9240727 processed and saved successfully
[06:05:40] 🔄 
🔄 Step 8: Saving API details...
[06:05:40] [DOC: 9240727] ℹ️  API push details saved for document 9240727
[06:05:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240725                         ║
================================================================================
[06:05:40] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:05:40] ℹ️  Date: 04/15/2025
[06:05:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:05:41] [DOC: 9240725] ✅ Text extracted using pdfplumber (1318 chars)
[06:05:41] ✅    ✅ Text extracted using pdfplumber (1318 chars)
[06:05:41] 🔄 
🔄 Step 2: Extracting patient data...
[06:05:44] ℹ️  AI extracted raw sex value: 'F'
[06:05:44] ℹ️  AI extracted service line: 'Physical Therapy'
[06:05:44] ℹ️  AI extracted payer source: ''
[06:05:44] ℹ️  AI extracted diagnoses:
[06:05:44] ℹ️    - Diagnosis 1: ''
[06:05:44] ℹ️    - Diagnosis 2: ''
[06:05:44] ℹ️    - Diagnosis 3: ''
[06:05:44] ℹ️    - Diagnosis 4: ''
[06:05:44] ℹ️    - Diagnosis 5: ''
[06:05:44] ℹ️    - Diagnosis 6: ''
[06:05:44] ℹ️  Final extracted MRN: '2516647'
[06:05:44] ℹ️  Final extracted Sex: 'FEMALE'
[06:05:44] ℹ️  Final extracted Service Line: 'Physical Therapy'
[06:05:44] ℹ️  Final extracted Payer Source: ''
[06:05:44] ✅ Patient data extraction completed successfully
[06:05:44] ✅    ✅ Patient data extracted successfully
[06:05:44] 📊 Patient Response
     └─ patientFName: Linda
     └─ patientLName: Girouard
     └─ dob: 11/02/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2516647
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:05:44] ✅    ✅ Patient identified: Linda Girouard
[06:05:44] ✅    ✅ Patient name validation passed
[06:05:44] 🔄 
🔄 Step 3: Processing patient dates...
[06:05:44] [DOC: 9240725] ℹ️  DOB normalized: 11/02/1960
[06:05:44] [DOC: 9240725] ✅ Patient date processing completed successfully
[06:05:44] ✅    ✅ Date processing completed
[06:05:44] 📊 Processed Patient Data
     └─ patientFName: Linda
     └─ patientLName: Girouard
     └─ dob: 11/02/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2516647
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:05:44] 🔄 
🔄 Step 4: Extracting order data...
[06:05:46] ℹ️  Order extraction - MRN: '2516647'
[06:05:46] ℹ️  Order extraction - Sex: 'FEMALE'
[06:05:46] ℹ️  Order extraction - Service Line: ''
[06:05:46] ℹ️  Order extraction - Payer Source: ''
[06:05:46] ✅ Order data extraction completed successfully
[06:05:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:05:46] ℹ️  Using MRN from patient data: '2516647' over '2516647'
[06:05:46] ℹ️  Using service line from patient data: 'Physical Therapy'
[06:05:46] ✅ Patient name cross-validation successful
[06:05:46] ✅    ✅ Data merged successfully
[06:05:47] ⚠️     ❌ Skipping - missing episode start date
[06:05:47] [DOC: 9240725] ℹ️  API push details saved for document 9240725
================================================================================
║                        Processing Document ID: 9240716                         ║
================================================================================
[06:05:47] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:05:47] ℹ️  Date: 04/15/2025
[06:05:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:05:51] [DOC: 9240716] ✅ Text extracted using pdfplumber (14223 chars)
[06:05:51] ✅    ✅ Text extracted using pdfplumber (14223 chars)
[06:05:51] 🔄 
🔄 Step 2: Extracting patient data...
[06:05:54] ℹ️  AI extracted raw sex value: 'M'
[06:05:54] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:05:54] ℹ️  AI extracted payer source: ''
[06:05:54] ℹ️  AI extracted diagnoses:
[06:05:54] ℹ️    - Diagnosis 1: 'I65.22'
[06:05:54] ℹ️    - Diagnosis 2: 'Z48.812'
[06:05:54] ℹ️    - Diagnosis 3: 'Z48.03'
[06:05:54] ℹ️    - Diagnosis 4: 'I25.5'
[06:05:54] ℹ️    - Diagnosis 5: 'I11.0'
[06:05:54] ℹ️    - Diagnosis 6: 'I50.22'
[06:05:54] ℹ️  Final extracted MRN: '2513265'
[06:05:54] ℹ️  Final extracted Sex: 'MALE'
[06:05:54] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:05:54] ℹ️  Final extracted Payer Source: ''
[06:05:54] ✅ Patient data extraction completed successfully
[06:05:54] ✅    ✅ Patient data extracted successfully
[06:05:54] 📊 Patient Response
     └─ patientFName: Gualter
     └─ patientLName: Giesta
     └─ dob: 03/29/1958
     └─ patientSex: MALE
     └─ medicalRecordNo: 2513265
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'I65.22', 'secondDiagnosis': 'Z48.812', 'thirdDiagnosis': 'Z48.03', 'fourthDiagnosis': 'I25.5', 'fifthDiagnosis': 'I11.0', 'sixthDiagnosis': 'I50.22'}]
[06:05:54] ✅    ✅ Patient identified: Gualter Giesta
[06:05:54] ✅    ✅ Patient name validation passed
[06:05:54] 🔄 
🔄 Step 3: Processing patient dates...
[06:05:54] [DOC: 9240716] ℹ️  DOB normalized: 03/29/1958
[06:05:54] [DOC: 9240716] ℹ️  Episode startOfCare normalized: 04/02/2025
[06:05:54] [DOC: 9240716] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[06:05:54] [DOC: 9240716] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[06:05:54] [DOC: 9240716] ✅ Patient date processing completed successfully
[06:05:54] ✅    ✅ Date processing completed
[06:05:54] 📊 Processed Patient Data
     └─ patientFName: Gualter
     └─ patientLName: Giesta
     └─ dob: 03/29/1958
     └─ patientSex: MALE
     └─ medicalRecordNo: 2513265
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'I65.22', 'secondDiagnosis': 'Z48.812', 'thirdDiagnosis': 'Z48.03', 'fourthDiagnosis': 'I25.5', 'fifthDiagnosis': 'I11.0', 'sixthDiagnosis': 'I50.22'}]
[06:05:54] 🔄 
🔄 Step 4: Extracting order data...
[06:05:57] ℹ️  Order extraction - MRN: '2513265'
[06:05:57] ℹ️  Order extraction - Sex: 'MALE'
[06:05:57] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:05:57] ℹ️  Order extraction - Payer Source: ''
[06:05:57] ✅ Order data extraction completed successfully
[06:05:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:05:57] ℹ️  Using MRN from patient data: '2513265' over '2513265'
[06:05:57] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:05:57] ✅ Patient name cross-validation successful
[06:05:57] ✅    ✅ Data merged successfully
[06:05:58] ✅    ✅ Order data extracted and validated
[06:05:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:06:05] [DOC: 9240716] ✅ Patient exists in API: Gualter Giesta, ID: d992256f-cca6-4720-b88d-27771d219f09
[06:06:05] ✅    ✅ Existing patient found with ID: d992256f-cca6-4720-b88d-27771d219f09
[06:06:05] 🔄 
🔄 Step 6: Pushing order to API...
[06:06:05] [DOC: 9240716] ℹ️  Pushing order via API for patient ID: d992256f-cca6-4720-b88d-27771d219f09
[06:06:06] [DOC: 9240716] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13038"}
[06:06:06] ❌    ❌ Failed to push order
[06:06:06] 🔄 
🔄 Step 7: Writing to CSV...
[06:06:06] [DOC: 9240716] ℹ️  Calculated age: 67 from DOB: 03/29/1958
[06:06:06] [DOC: 9240716] ℹ️  Service Line extracted: 'Skilled Nursing'
[06:06:06] [DOC: 9240716] ℹ️  Payer Source extracted: ''
[06:06:06] [DOC: 9240716] ℹ️  Diagnosis codes being written:
[06:06:06] [DOC: 9240716] ℹ️    - Latest_Episode_Firstdiagnosis: 'I65.22'
[06:06:06] [DOC: 9240716] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z48.812'
[06:06:06] [DOC: 9240716] ℹ️    - Latest_Episode_Thirddiagnosis: 'Z48.03'
[06:06:06] [DOC: 9240716] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I25.5'
[06:06:06] [DOC: 9240716] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I11.0'
[06:06:06] [DOC: 9240716] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I50.22'
[06:06:06] [DOC: 9240716] ✅ Patient data written to CSV: Gualter Giesta | Sex: MALE | Age: 67 | Service: Skilled Nursing | Payer:  | MRN: 2513265
[06:06:06] ✅    ✅ Document 9240716 processed and saved successfully
[06:06:06] 🔄 
🔄 Step 8: Saving API details...
[06:06:06] [DOC: 9240716] ℹ️  API push details saved for document 9240716
[06:06:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240704                         ║
================================================================================
[06:06:06] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:06:06] ℹ️  Date: 04/15/2025
[06:06:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:06:09] [DOC: 9240704] ✅ Text extracted using pdfplumber (18882 chars)
[06:06:09] ✅    ✅ Text extracted using pdfplumber (18872 chars)
[06:06:09] 🔄 
🔄 Step 2: Extracting patient data...
[06:06:12] ℹ️  AI extracted raw sex value: 'F'
[06:06:12] ℹ️  AI extracted service line: 'Physical Therapy, Skilled nursing'
[06:06:12] ℹ️  AI extracted payer source: 'None'
[06:06:12] ℹ️  AI extracted diagnoses:
[06:06:12] ℹ️    - Diagnosis 1: 'I48.0'
[06:06:12] ℹ️    - Diagnosis 2: 'I48.4'
[06:06:12] ℹ️    - Diagnosis 3: 'I11.0'
[06:06:12] ℹ️    - Diagnosis 4: 'I50.32'
[06:06:12] ℹ️    - Diagnosis 5: 'F41.9'
[06:06:12] ℹ️    - Diagnosis 6: 'J44.9'
[06:06:12] ℹ️  Final extracted MRN: '2507761'
[06:06:12] ℹ️  Final extracted Sex: 'FEMALE'
[06:06:12] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled nursing'
[06:06:12] ℹ️  Final extracted Payer Source: ''
[06:06:12] ✅ Patient data extraction completed successfully
[06:06:12] ✅    ✅ Patient data extracted successfully
[06:06:12] 📊 Patient Response
     └─ patientFName: Jacqueline
     └─ patientLName: Gautreau
     └─ dob: 02/03/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2507761
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: None
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy, Skilled nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'I48.0', 'secondDiagnosis': 'I48.4', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'J44.9'}]
[06:06:12] ✅    ✅ Patient identified: Jacqueline Gautreau
[06:06:12] ✅    ✅ Patient name validation passed
[06:06:12] 🔄 
🔄 Step 3: Processing patient dates...
[06:06:12] [DOC: 9240704] ℹ️  DOB normalized: 02/03/1949
[06:06:12] [DOC: 9240704] ℹ️  Episode startOfCare normalized: 03/26/2025
[06:06:12] [DOC: 9240704] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[06:06:12] [DOC: 9240704] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[06:06:12] [DOC: 9240704] ✅ Patient date processing completed successfully
[06:06:12] ✅    ✅ Date processing completed
[06:06:12] 📊 Processed Patient Data
     └─ patientFName: Jacqueline
     └─ patientLName: Gautreau
     └─ dob: 02/03/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2507761
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy, Skilled nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'I48.0', 'secondDiagnosis': 'I48.4', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'J44.9'}]
[06:06:12] 🔄 
🔄 Step 4: Extracting order data...
[06:06:15] ℹ️  Order extraction - MRN: '2507761'
[06:06:15] ℹ️  Order extraction - Sex: 'FEMALE'
[06:06:15] ℹ️  Order extraction - Service Line: 'Physical Therapy, Skilled Nursing'
[06:06:15] ℹ️  Order extraction - Payer Source: ''
[06:06:15] ✅ Order data extraction completed successfully
[06:06:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:06:15] ℹ️  Using MRN from patient data: '2507761' over '2507761'
[06:06:15] ℹ️  Service line consistent in both sources: 'Physical Therapy, Skilled nursing'
[06:06:15] ✅ Patient name cross-validation successful
[06:06:15] ✅    ✅ Data merged successfully
[06:06:16] ✅    ✅ Order data extracted and validated
[06:06:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:06:23] [DOC: 9240704] ℹ️  Patient not found in cache or API: Jacqueline Gautreau
[06:06:23] [DOC: 9240704] ℹ️  Patient not found, creating new patient via API...
[06:06:23] [DOC: 9240704] ℹ️  Creating patient via API: Jacqueline Gautreau
[06:06:24] [DOC: 9240704] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:06:24] ❌    ❌ Failed to create patient
[06:06:24] [DOC: 9240704] ℹ️  API push details saved for document 9240704
================================================================================
║                        Processing Document ID: 9240701                         ║
================================================================================
[06:06:24] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:06:24] ℹ️  Date: 04/15/2025
[06:06:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:06:25] [DOC: 9240701] ✅ Text extracted using pdfplumber (1140 chars)
[06:06:25] ✅    ✅ Text extracted using pdfplumber (1140 chars)
[06:06:25] 🔄 
🔄 Step 2: Extracting patient data...
[06:06:28] ℹ️  AI extracted raw sex value: 'F'
[06:06:28] ℹ️  AI extracted service line: 'Physical Therapy'
[06:06:28] ℹ️  AI extracted payer source: ''
[06:06:28] ℹ️  AI extracted diagnoses:
[06:06:28] ℹ️    - Diagnosis 1: ''
[06:06:28] ℹ️    - Diagnosis 2: ''
[06:06:28] ℹ️    - Diagnosis 3: ''
[06:06:28] ℹ️    - Diagnosis 4: ''
[06:06:28] ℹ️    - Diagnosis 5: ''
[06:06:28] ℹ️    - Diagnosis 6: ''
[06:06:28] ℹ️  Final extracted MRN: '2491526'
[06:06:28] ℹ️  Final extracted Sex: 'FEMALE'
[06:06:28] ℹ️  Final extracted Service Line: 'Physical Therapy'
[06:06:28] ℹ️  Final extracted Payer Source: ''
[06:06:28] ✅ Patient data extraction completed successfully
[06:06:28] ✅    ✅ Patient data extracted successfully
[06:06:28] 📊 Patient Response
     └─ patientFName: Alda
     └─ patientLName: Frias
     └─ dob: 10/11/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2491526
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:06:28] ✅    ✅ Patient identified: Alda Frias
[06:06:28] ✅    ✅ Patient name validation passed
[06:06:28] 🔄 
🔄 Step 3: Processing patient dates...
[06:06:28] [DOC: 9240701] ℹ️  DOB normalized: 10/11/1934
[06:06:28] [DOC: 9240701] ✅ Patient date processing completed successfully
[06:06:28] ✅    ✅ Date processing completed
[06:06:28] 📊 Processed Patient Data
     └─ patientFName: Alda
     └─ patientLName: Frias
     └─ dob: 10/11/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2491526
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:06:28] 🔄 
🔄 Step 4: Extracting order data...
[06:06:30] ℹ️  Order extraction - MRN: '2491526'
[06:06:30] ℹ️  Order extraction - Sex: 'FEMALE'
[06:06:30] ℹ️  Order extraction - Service Line: ''
[06:06:30] ℹ️  Order extraction - Payer Source: ''
[06:06:30] ✅ Order data extraction completed successfully
[06:06:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:06:30] ℹ️  Using MRN from patient data: '2491526' over '2491526'
[06:06:30] ℹ️  Using service line from patient data: 'Physical Therapy'
[06:06:30] ✅ Patient name cross-validation successful
[06:06:30] ✅    ✅ Data merged successfully
[06:06:31] ⚠️     ❌ Skipping - missing episode start date
[06:06:31] [DOC: 9240701] ℹ️  API push details saved for document 9240701
================================================================================
║                        Processing Document ID: 9240699                         ║
================================================================================
[06:06:31] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:06:31] ℹ️  Date: 04/15/2025
[06:06:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:06:34] [DOC: 9240699] ✅ Text extracted using pdfplumber (16034 chars)
[06:06:34] ✅    ✅ Text extracted using pdfplumber (16024 chars)
[06:06:34] 🔄 
🔄 Step 2: Extracting patient data...
[06:06:37] ℹ️  AI extracted raw sex value: 'F'
[06:06:37] ℹ️  AI extracted service line: 'Physical Therapy'
[06:06:37] ℹ️  AI extracted payer source: ''
[06:06:37] ℹ️  AI extracted diagnoses:
[06:06:37] ℹ️    - Diagnosis 1: 'G89.29'
[06:06:37] ℹ️    - Diagnosis 2: 'M54.50'
[06:06:37] ℹ️    - Diagnosis 3: 'I48.0'
[06:06:37] ℹ️    - Diagnosis 4: 'R30.0'
[06:06:37] ℹ️    - Diagnosis 5: 'M48.00'
[06:06:37] ℹ️    - Diagnosis 6: 'I10'
[06:06:37] ℹ️  Final extracted MRN: '2485609'
[06:06:37] ℹ️  Final extracted Sex: 'FEMALE'
[06:06:37] ℹ️  Final extracted Service Line: 'Physical Therapy'
[06:06:37] ℹ️  Final extracted Payer Source: ''
[06:06:37] ✅ Patient data extraction completed successfully
[06:06:37] ✅    ✅ Patient data extracted successfully
[06:06:37] 📊 Patient Response
     └─ patientFName: Elsie
     └─ patientLName: Fraga
     └─ dob: 02/06/1926
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2485609
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'G89.29', 'secondDiagnosis': 'M54.50', 'thirdDiagnosis': 'I48.0', 'fourthDiagnosis': 'R30.0', 'fifthDiagnosis': 'M48.00', 'sixthDiagnosis': 'I10'}]
[06:06:37] ✅    ✅ Patient identified: Elsie Fraga
[06:06:37] ✅    ✅ Patient name validation passed
[06:06:37] 🔄 
🔄 Step 3: Processing patient dates...
[06:06:37] [DOC: 9240699] ℹ️  DOB normalized: 02/06/1926
[06:06:37] [DOC: 9240699] ℹ️  Episode startOfCare normalized: 03/27/2025
[06:06:37] [DOC: 9240699] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[06:06:37] [DOC: 9240699] ℹ️  Episode endOfEpisode normalized: 05/26/2025
[06:06:37] [DOC: 9240699] ✅ Patient date processing completed successfully
[06:06:37] ✅    ✅ Date processing completed
[06:06:37] 📊 Processed Patient Data
     └─ patientFName: Elsie
     └─ patientLName: Fraga
     └─ dob: 02/06/1926
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2485609
     └─ billingProvider: Earl Potts Jr., MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'G89.29', 'secondDiagnosis': 'M54.50', 'thirdDiagnosis': 'I48.0', 'fourthDiagnosis': 'R30.0', 'fifthDiagnosis': 'M48.00', 'sixthDiagnosis': 'I10'}]
[06:06:37] 🔄 
🔄 Step 4: Extracting order data...
[06:06:40] ℹ️  Order extraction - MRN: '2485609'
[06:06:40] ℹ️  Order extraction - Sex: 'FEMALE'
[06:06:40] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[06:06:40] ℹ️  Order extraction - Payer Source: ''
[06:06:40] ✅ Order data extraction completed successfully
[06:06:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:06:40] ℹ️  Using MRN from patient data: '2485609' over '2485609'
[06:06:40] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[06:06:40] ✅ Patient name cross-validation successful
[06:06:40] ✅    ✅ Data merged successfully
[06:06:41] ✅    ✅ Order data extracted and validated
[06:06:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:07:11] [DOC: 9240699] ℹ️  Patient not found in cache or API: Elsie Fraga
[06:07:11] [DOC: 9240699] ℹ️  Patient not found, creating new patient via API...
[06:07:11] [DOC: 9240699] ℹ️  Creating patient via API: Elsie Fraga
[06:07:13] [DOC: 9240699] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:07:13] ❌    ❌ Failed to create patient
[06:07:13] [DOC: 9240699] ℹ️  API push details saved for document 9240699
================================================================================
║                        Processing Document ID: 9240691                         ║
================================================================================
[06:07:13] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:07:13] ℹ️  Date: 04/15/2025
[06:07:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:07:16] [DOC: 9240691] ✅ Text extracted using pdfplumber (959 chars)
[06:07:16] ✅    ✅ Text extracted using pdfplumber (959 chars)
[06:07:16] 🔄 
🔄 Step 2: Extracting patient data...
[06:07:18] ℹ️  AI extracted raw sex value: 'M'
[06:07:18] ℹ️  AI extracted service line: 'RN'
[06:07:18] ℹ️  AI extracted payer source: ''
[06:07:18] ℹ️  AI extracted diagnoses:
[06:07:18] ℹ️    - Diagnosis 1: ''
[06:07:18] ℹ️    - Diagnosis 2: ''
[06:07:18] ℹ️    - Diagnosis 3: ''
[06:07:18] ℹ️    - Diagnosis 4: ''
[06:07:18] ℹ️    - Diagnosis 5: ''
[06:07:18] ℹ️    - Diagnosis 6: ''
[06:07:18] ℹ️  Final extracted MRN: '2475455'
[06:07:18] ℹ️  Final extracted Sex: 'MALE'
[06:07:18] ℹ️  Final extracted Service Line: 'RN'
[06:07:18] ℹ️  Final extracted Payer Source: ''
[06:07:18] ✅ Patient data extraction completed successfully
[06:07:18] ✅    ✅ Patient data extracted successfully
[06:07:18] 📊 Patient Response
     └─ patientFName: Jay
     └─ patientLName: Flanagan
     └─ dob: 11/01/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 2475455
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:07:18] ✅    ✅ Patient identified: Jay Flanagan
[06:07:18] ✅    ✅ Patient name validation passed
[06:07:18] 🔄 
🔄 Step 3: Processing patient dates...
[06:07:18] [DOC: 9240691] ℹ️  DOB normalized: 11/01/1951
[06:07:18] [DOC: 9240691] ✅ Patient date processing completed successfully
[06:07:18] ✅    ✅ Date processing completed
[06:07:18] 📊 Processed Patient Data
     └─ patientFName: Jay
     └─ patientLName: Flanagan
     └─ dob: 11/01/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 2475455
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:07:18] 🔄 
🔄 Step 4: Extracting order data...
[06:07:20] ℹ️  Order extraction - MRN: '2475455'
[06:07:20] ℹ️  Order extraction - Sex: 'MALE'
[06:07:20] ℹ️  Order extraction - Service Line: ''
[06:07:20] ℹ️  Order extraction - Payer Source: ''
[06:07:20] ✅ Order data extraction completed successfully
[06:07:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:07:20] ℹ️  Using MRN from patient data: '2475455' over '2475455'
[06:07:20] ℹ️  Using service line from patient data: 'RN'
[06:07:20] ✅ Patient name cross-validation successful
[06:07:20] ✅    ✅ Data merged successfully
[06:07:22] ⚠️     ❌ Skipping - missing episode start date
[06:07:22] [DOC: 9240691] ℹ️  API push details saved for document 9240691
================================================================================
║                        Processing Document ID: 9240688                         ║
================================================================================
[06:07:22] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:07:22] ℹ️  Date: 04/15/2025
[06:07:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:07:25] [DOC: 9240688] ✅ Text extracted using pdfplumber (12810 chars)
[06:07:25] ✅    ✅ Text extracted using pdfplumber (12810 chars)
[06:07:25] 🔄 
🔄 Step 2: Extracting patient data...
[06:07:28] ℹ️  AI extracted raw sex value: 'F'
[06:07:28] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:07:28] ℹ️  AI extracted payer source: ''
[06:07:28] ℹ️  AI extracted diagnoses:
[06:07:28] ℹ️    - Diagnosis 1: 'I87.2'
[06:07:28] ℹ️    - Diagnosis 2: 'I70.233'
[06:07:28] ℹ️    - Diagnosis 3: 'L97.312'
[06:07:28] ℹ️    - Diagnosis 4: 'I70.235'
[06:07:28] ℹ️    - Diagnosis 5: 'I10'
[06:07:28] ℹ️    - Diagnosis 6: 'F41.9'
[06:07:28] ℹ️  Final extracted MRN: '2158031'
[06:07:28] ℹ️  Final extracted Sex: 'FEMALE'
[06:07:28] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:07:28] ℹ️  Final extracted Payer Source: ''
[06:07:28] ✅ Patient data extraction completed successfully
[06:07:28] ✅    ✅ Patient data extracted successfully
[06:07:28] 📊 Patient Response
     └─ patientFName: Norma
     └─ patientLName: Dyer
     └─ dob: 11/13/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2158031
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I87.2', 'secondDiagnosis': 'I70.233', 'thirdDiagnosis': 'L97.312', 'fourthDiagnosis': 'I70.235', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'F41.9'}]
[06:07:28] ✅    ✅ Patient identified: Norma Dyer
[06:07:28] ✅    ✅ Patient name validation passed
[06:07:28] 🔄 
🔄 Step 3: Processing patient dates...
[06:07:28] [DOC: 9240688] ℹ️  DOB normalized: 11/13/1931
[06:07:28] [DOC: 9240688] ℹ️  Episode startOfCare normalized: 04/02/2025
[06:07:28] [DOC: 9240688] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[06:07:28] [DOC: 9240688] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[06:07:28] [DOC: 9240688] ✅ Patient date processing completed successfully
[06:07:28] ✅    ✅ Date processing completed
[06:07:28] 📊 Processed Patient Data
     └─ patientFName: Norma
     └─ patientLName: Dyer
     └─ dob: 11/13/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2158031
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I87.2', 'secondDiagnosis': 'I70.233', 'thirdDiagnosis': 'L97.312', 'fourthDiagnosis': 'I70.235', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'F41.9'}]
[06:07:28] 🔄 
🔄 Step 4: Extracting order data...
[06:07:30] ℹ️  Order extraction - MRN: '2158031'
[06:07:30] ℹ️  Order extraction - Sex: 'FEMALE'
[06:07:30] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:07:30] ℹ️  Order extraction - Payer Source: ''
[06:07:30] ✅ Order data extraction completed successfully
[06:07:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:07:30] ℹ️  Using MRN from patient data: '2158031' over '2158031'
[06:07:30] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:07:30] ✅ Patient name cross-validation successful
[06:07:30] ✅    ✅ Data merged successfully
[06:07:32] ✅    ✅ Order data extracted and validated
[06:07:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:07:32] [DOC: 9240688] ✅ Patient found in local cache: Norma Dyer, ID: 5ca2359c-d429-4962-bcd9-bc06407ed3cc
[06:07:32] ✅    ✅ Existing patient found with ID: 5ca2359c-d429-4962-bcd9-bc06407ed3cc
[06:07:32] 🔄 
🔄 Step 6: Pushing order to API...
[06:07:32] [DOC: 9240688] ℹ️  Pushing order via API for patient ID: 5ca2359c-d429-4962-bcd9-bc06407ed3cc
[06:07:33] [DOC: 9240688] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13716"}
[06:07:33] ❌    ❌ Failed to push order
[06:07:33] 🔄 
🔄 Step 7: Writing to CSV...
[06:07:33] [DOC: 9240688] ℹ️  Calculated age: 93 from DOB: 11/13/1931
[06:07:33] [DOC: 9240688] ℹ️  Service Line extracted: 'Skilled Nursing'
[06:07:33] [DOC: 9240688] ℹ️  Payer Source extracted: ''
[06:07:33] [DOC: 9240688] ℹ️  Diagnosis codes being written:
[06:07:33] [DOC: 9240688] ℹ️    - Latest_Episode_Firstdiagnosis: 'I87.2'
[06:07:33] [DOC: 9240688] ℹ️    - Latest_Episode_Seconddiagnosis: 'I70.233'
[06:07:33] [DOC: 9240688] ℹ️    - Latest_Episode_Thirddiagnosis: 'L97.312'
[06:07:33] [DOC: 9240688] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I70.235'
[06:07:33] [DOC: 9240688] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[06:07:33] [DOC: 9240688] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[06:07:33] [DOC: 9240688] ✅ Patient data written to CSV: Norma Dyer | Sex: FEMALE | Age: 93 | Service: Skilled Nursing | Payer:  | MRN: 2158031
[06:07:33] ✅    ✅ Document 9240688 processed and saved successfully
[06:07:33] 🔄 
🔄 Step 8: Saving API details...
[06:07:33] [DOC: 9240688] ℹ️  API push details saved for document 9240688
[06:07:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240683                         ║
================================================================================
[06:07:33] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:07:33] ℹ️  Date: 04/15/2025
[06:07:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:07:36] [DOC: 9240683] ✅ Text extracted using pdfplumber (15847 chars)
[06:07:36] ✅    ✅ Text extracted using pdfplumber (15847 chars)
[06:07:36] 🔄 
🔄 Step 2: Extracting patient data...
[06:07:39] ℹ️  AI extracted raw sex value: 'M'
[06:07:39] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[06:07:39] ℹ️  AI extracted payer source: ''
[06:07:39] ℹ️  AI extracted diagnoses:
[06:07:39] ℹ️    - Diagnosis 1: 'I95.1'
[06:07:39] ℹ️    - Diagnosis 2: 'I25.10'
[06:07:39] ℹ️    - Diagnosis 3: 'I11.0'
[06:07:39] ℹ️    - Diagnosis 4: 'I50.32'
[06:07:39] ℹ️    - Diagnosis 5: 'I49.5'
[06:07:39] ℹ️    - Diagnosis 6: 'I48.0'
[06:07:39] ℹ️  Final extracted MRN: '2390602'
[06:07:39] ℹ️  Final extracted Sex: 'MALE'
[06:07:39] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[06:07:39] ℹ️  Final extracted Payer Source: ''
[06:07:39] ✅ Patient data extraction completed successfully
[06:07:39] ✅    ✅ Patient data extracted successfully
[06:07:39] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Davis
     └─ dob: 06/22/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2390602
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'I49.5', 'sixthDiagnosis': 'I48.0'}]
[06:07:39] ✅    ✅ Patient identified: Joseph Davis
[06:07:39] ✅    ✅ Patient name validation passed
[06:07:39] 🔄 
🔄 Step 3: Processing patient dates...
[06:07:39] [DOC: 9240683] ℹ️  DOB normalized: 06/22/1934
[06:07:39] [DOC: 9240683] ℹ️  Episode startOfCare normalized: 03/31/2025
[06:07:39] [DOC: 9240683] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[06:07:39] [DOC: 9240683] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[06:07:39] [DOC: 9240683] ✅ Patient date processing completed successfully
[06:07:39] ✅    ✅ Date processing completed
[06:07:39] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Davis
     └─ dob: 06/22/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2390602
     └─ billingProvider: Bing Liu, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'I95.1', 'secondDiagnosis': 'I25.10', 'thirdDiagnosis': 'I11.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'I49.5', 'sixthDiagnosis': 'I48.0'}]
[06:07:39] 🔄 
🔄 Step 4: Extracting order data...
[06:07:42] ℹ️  Order extraction - MRN: '2390602'
[06:07:42] ℹ️  Order extraction - Sex: 'MALE'
[06:07:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[06:07:42] ℹ️  Order extraction - Payer Source: ''
[06:07:42] ✅ Order data extraction completed successfully
[06:07:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:07:42] ℹ️  Using MRN from patient data: '2390602' over '2390602'
[06:07:42] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[06:07:42] ✅ Patient name cross-validation successful
[06:07:42] ✅    ✅ Data merged successfully
[06:07:43] ✅    ✅ Order data extracted and validated
[06:07:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:08:18] [DOC: 9240683] ✅ Patient exists in API: Joseph Davis, ID: a6da9a39-4b11-4e42-b2ba-0c01df12e86c
[06:08:18] ✅    ✅ Existing patient found with ID: a6da9a39-4b11-4e42-b2ba-0c01df12e86c
[06:08:18] 🔄 
🔄 Step 6: Pushing order to API...
[06:08:18] [DOC: 9240683] ℹ️  Pushing order via API for patient ID: a6da9a39-4b11-4e42-b2ba-0c01df12e86c
[06:08:19] [DOC: 9240683] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14630"}
[06:08:19] ❌    ❌ Failed to push order
[06:08:19] 🔄 
🔄 Step 7: Writing to CSV...
[06:08:19] [DOC: 9240683] ℹ️  Calculated age: 90 from DOB: 06/22/1934
[06:08:19] [DOC: 9240683] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[06:08:19] [DOC: 9240683] ℹ️  Payer Source extracted: ''
[06:08:19] [DOC: 9240683] ℹ️  Diagnosis codes being written:
[06:08:19] [DOC: 9240683] ℹ️    - Latest_Episode_Firstdiagnosis: 'I95.1'
[06:08:19] [DOC: 9240683] ℹ️    - Latest_Episode_Seconddiagnosis: 'I25.10'
[06:08:19] [DOC: 9240683] ℹ️    - Latest_Episode_Thirddiagnosis: 'I11.0'
[06:08:19] [DOC: 9240683] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I50.32'
[06:08:19] [DOC: 9240683] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I49.5'
[06:08:19] [DOC: 9240683] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I48.0'
[06:08:19] [DOC: 9240683] ✅ Patient data written to CSV: Joseph Davis | Sex: MALE | Age: 90 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 2390602
[06:08:19] ✅    ✅ Document 9240683 processed and saved successfully
[06:08:19] 🔄 
🔄 Step 8: Saving API details...
[06:08:19] [DOC: 9240683] ℹ️  API push details saved for document 9240683
[06:08:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240671                         ║
================================================================================
[06:08:19] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:08:19] ℹ️  Date: 04/15/2025
[06:08:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:08:22] [DOC: 9240671] ✅ Text extracted using pdfplumber (19647 chars)
[06:08:22] ✅    ✅ Text extracted using pdfplumber (19647 chars)
[06:08:22] 🔄 
🔄 Step 2: Extracting patient data...
[06:08:26] ℹ️  AI extracted raw sex value: 'F'
[06:08:26] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[06:08:26] ℹ️  AI extracted payer source: ''
[06:08:26] ℹ️  AI extracted diagnoses:
[06:08:26] ℹ️    - Diagnosis 1: 'I74.2'
[06:08:26] ℹ️    - Diagnosis 2: 'I48.21'
[06:08:26] ℹ️    - Diagnosis 3: 'I13.0'
[06:08:26] ℹ️    - Diagnosis 4: 'I50.32'
[06:08:26] ℹ️    - Diagnosis 5: 'N18.31'
[06:08:26] ℹ️    - Diagnosis 6: 'D50.9'
[06:08:26] ℹ️  Final extracted MRN: '2102046'
[06:08:26] ℹ️  Final extracted Sex: 'FEMALE'
[06:08:26] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[06:08:26] ℹ️  Final extracted Payer Source: ''
[06:08:26] ✅ Patient data extraction completed successfully
[06:08:26] ✅    ✅ Patient data extracted successfully
[06:08:26] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Cunha
     └─ dob: 06/04/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2102046
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'I74.2', 'secondDiagnosis': 'I48.21', 'thirdDiagnosis': 'I13.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'N18.31', 'sixthDiagnosis': 'D50.9'}]
[06:08:26] ✅    ✅ Patient identified: Maria Cunha
[06:08:26] ✅    ✅ Patient name validation passed
[06:08:26] 🔄 
🔄 Step 3: Processing patient dates...
[06:08:26] [DOC: 9240671] ℹ️  DOB normalized: 06/04/1930
[06:08:26] [DOC: 9240671] ℹ️  Episode startOfCare normalized: 04/02/2025
[06:08:26] [DOC: 9240671] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[06:08:26] [DOC: 9240671] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[06:08:26] [DOC: 9240671] ✅ Patient date processing completed successfully
[06:08:26] ✅    ✅ Date processing completed
[06:08:26] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Cunha
     └─ dob: 06/04/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2102046
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'I74.2', 'secondDiagnosis': 'I48.21', 'thirdDiagnosis': 'I13.0', 'fourthDiagnosis': 'I50.32', 'fifthDiagnosis': 'N18.31', 'sixthDiagnosis': 'D50.9'}]
[06:08:26] 🔄 
🔄 Step 4: Extracting order data...
[06:08:29] ℹ️  Order extraction - MRN: '2102046'
[06:08:29] ℹ️  Order extraction - Sex: 'FEMALE'
[06:08:29] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy'
[06:08:29] ℹ️  Order extraction - Payer Source: ''
[06:08:29] ✅ Order data extraction completed successfully
[06:08:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:08:29] ℹ️  Using MRN from patient data: '2102046' over '2102046'
[06:08:29] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy'
[06:08:29] ✅ Patient name cross-validation successful
[06:08:29] ✅    ✅ Data merged successfully
[06:08:30] ✅    ✅ Order data extracted and validated
[06:08:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:08:35] [DOC: 9240671] ℹ️  Patient not found in cache or API: Maria Cunha
[06:08:35] [DOC: 9240671] ℹ️  Patient not found, creating new patient via API...
[06:08:35] [DOC: 9240671] ℹ️  Creating patient via API: Maria Cunha
[06:08:37] [DOC: 9240671] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:08:37] ❌    ❌ Failed to create patient
[06:08:37] [DOC: 9240671] ℹ️  API push details saved for document 9240671
================================================================================
║                        Processing Document ID: 9240658                         ║
================================================================================
[06:08:37] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:08:37] ℹ️  Date: 04/15/2025
[06:08:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:08:38] [DOC: 9240658] ✅ Text extracted using pdfplumber (835 chars)
[06:08:38] ✅    ✅ Text extracted using pdfplumber (835 chars)
[06:08:38] 🔄 
🔄 Step 2: Extracting patient data...
[06:08:41] ℹ️  AI extracted raw sex value: 'F'
[06:08:41] ℹ️  AI extracted service line: ''
[06:08:41] ℹ️  AI extracted payer source: ''
[06:08:41] ℹ️  AI extracted diagnoses:
[06:08:41] ℹ️    - Diagnosis 1: ''
[06:08:41] ℹ️    - Diagnosis 2: ''
[06:08:41] ℹ️    - Diagnosis 3: ''
[06:08:41] ℹ️    - Diagnosis 4: ''
[06:08:41] ℹ️    - Diagnosis 5: ''
[06:08:41] ℹ️    - Diagnosis 6: ''
[06:08:41] ℹ️  Final extracted MRN: '2345824'
[06:08:41] ℹ️  Final extracted Sex: 'FEMALE'
[06:08:41] ℹ️  Final extracted Service Line: ''
[06:08:41] ℹ️  Final extracted Payer Source: ''
[06:08:41] ✅ Patient data extraction completed successfully
[06:08:41] ✅    ✅ Patient data extracted successfully
[06:08:41] 📊 Patient Response
     └─ patientFName: Bernadette
     └─ patientLName: Constantine
     └─ dob: 11/05/1924
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2345824
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:08:41] ✅    ✅ Patient identified: Bernadette Constantine
[06:08:41] ✅    ✅ Patient name validation passed
[06:08:41] 🔄 
🔄 Step 3: Processing patient dates...
[06:08:41] [DOC: 9240658] ℹ️  DOB normalized: 11/05/1924
[06:08:41] [DOC: 9240658] ✅ Patient date processing completed successfully
[06:08:41] ✅    ✅ Date processing completed
[06:08:41] 📊 Processed Patient Data
     └─ patientFName: Bernadette
     └─ patientLName: Constantine
     └─ dob: 11/05/1924
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2345824
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:08:41] 🔄 
🔄 Step 4: Extracting order data...
[06:08:43] ℹ️  Order extraction - MRN: '2345824'
[06:08:43] ℹ️  Order extraction - Sex: 'FEMALE'
[06:08:43] ℹ️  Order extraction - Service Line: ''
[06:08:43] ℹ️  Order extraction - Payer Source: ''
[06:08:43] ✅ Order data extraction completed successfully
[06:08:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:08:43] ℹ️  Using MRN from patient data: '2345824' over '2345824'
[06:08:43] ✅ Patient name cross-validation successful
[06:08:43] ✅    ✅ Data merged successfully
[06:08:44] ⚠️     ❌ Skipping - missing episode start date
[06:08:44] [DOC: 9240658] ℹ️  API push details saved for document 9240658
================================================================================
║                        Processing Document ID: 9240656                         ║
================================================================================
[06:08:44] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:08:44] ℹ️  Date: 04/15/2025
[06:08:44] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:08:47] [DOC: 9240656] ✅ Text extracted using pdfplumber (8439 chars)
[06:08:47] ✅    ✅ Text extracted using pdfplumber (8439 chars)
[06:08:47] 🔄 
🔄 Step 2: Extracting patient data...
[06:08:50] ℹ️  AI extracted raw sex value: 'F'
[06:08:50] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:08:50] ℹ️  AI extracted payer source: ''
[06:08:50] ℹ️  AI extracted diagnoses:
[06:08:50] ℹ️    - Diagnosis 1: 'G31.1'
[06:08:50] ℹ️    - Diagnosis 2: 'I10'
[06:08:50] ℹ️    - Diagnosis 3: 'E78.5'
[06:08:50] ℹ️    - Diagnosis 4: 'I25.10'
[06:08:50] ℹ️    - Diagnosis 5: 'D64.9'
[06:08:50] ℹ️    - Diagnosis 6: 'I48.91'
[06:08:50] ℹ️  Final extracted MRN: '2345824'
[06:08:50] ℹ️  Final extracted Sex: 'FEMALE'
[06:08:50] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:08:50] ℹ️  Final extracted Payer Source: ''
[06:08:50] ✅ Patient data extraction completed successfully
[06:08:50] ✅    ✅ Patient data extracted successfully
[06:08:50] 📊 Patient Response
     └─ patientFName: Bernadette
     └─ patientLName: Constantine
     └─ dob: 11/05/1924
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2345824
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/14/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': 'G31.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'I25.10', 'fifthDiagnosis': 'D64.9', 'sixthDiagnosis': 'I48.91'}]
[06:08:50] ✅    ✅ Patient identified: Bernadette Constantine
[06:08:50] ✅    ✅ Patient name validation passed
[06:08:50] 🔄 
🔄 Step 3: Processing patient dates...
[06:08:50] [DOC: 9240656] ℹ️  DOB normalized: 11/05/1924
[06:08:50] [DOC: 9240656] ℹ️  Episode startOfCare normalized: 04/14/2025
[06:08:50] [DOC: 9240656] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[06:08:50] [DOC: 9240656] ℹ️  Episode endOfEpisode normalized: 07/12/2025
[06:08:50] [DOC: 9240656] ✅ Patient date processing completed successfully
[06:08:50] ✅    ✅ Date processing completed
[06:08:50] 📊 Processed Patient Data
     └─ patientFName: Bernadette
     └─ patientLName: Constantine
     └─ dob: 11/05/1924
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2345824
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/14/2025', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '07/12/2025', 'firstDiagnosis': 'G31.1', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'I25.10', 'fifthDiagnosis': 'D64.9', 'sixthDiagnosis': 'I48.91'}]
[06:08:50] 🔄 
🔄 Step 4: Extracting order data...
[06:08:53] ℹ️  Order extraction - MRN: '2345824'
[06:08:53] ℹ️  Order extraction - Sex: 'FEMALE'
[06:08:53] ℹ️  Order extraction - Service Line: 'RN'
[06:08:53] ℹ️  Order extraction - Payer Source: ''
[06:08:53] ✅ Order data extraction completed successfully
[06:08:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:08:53] ℹ️  Using MRN from patient data: '2345824' over '2345824'
[06:08:53] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[06:08:53] ✅ Patient name cross-validation successful
[06:08:53] ✅    ✅ Data merged successfully
[06:08:54] ✅    ✅ Order data extracted and validated
[06:08:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:09:09] [DOC: 9240656] ℹ️  Patient not found in cache or API: Bernadette Constantine
[06:09:09] [DOC: 9240656] ℹ️  Patient not found, creating new patient via API...
[06:09:09] [DOC: 9240656] ℹ️  Creating patient via API: Bernadette Constantine
[06:09:10] [DOC: 9240656] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:09:10] ❌    ❌ Failed to create patient
[06:09:10] [DOC: 9240656] ℹ️  API push details saved for document 9240656
================================================================================
║                        Processing Document ID: 9240648                         ║
================================================================================
[06:09:10] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:09:10] ℹ️  Date: 04/15/2025
[06:09:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:09:13] [DOC: 9240648] ✅ Text extracted using pdfplumber (18376 chars)
[06:09:13] ✅    ✅ Text extracted using pdfplumber (18376 chars)
[06:09:13] 🔄 
🔄 Step 2: Extracting patient data...
[06:09:16] ℹ️  AI extracted raw sex value: 'M'
[06:09:16] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[06:09:16] ℹ️  AI extracted payer source: ''
[06:09:16] ℹ️  AI extracted diagnoses:
[06:09:16] ℹ️    - Diagnosis 1: 'E87.20'
[06:09:16] ℹ️    - Diagnosis 2: 'E87.3'
[06:09:16] ℹ️    - Diagnosis 3: 'J18.9'
[06:09:16] ℹ️    - Diagnosis 4: 'G20.C'
[06:09:16] ℹ️    - Diagnosis 5: 'I25.10'
[06:09:16] ℹ️    - Diagnosis 6: 'I11.0'
[06:09:16] ℹ️  Final extracted MRN: '2334940'
[06:09:16] ℹ️  Final extracted Sex: 'MALE'
[06:09:16] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[06:09:16] ℹ️  Final extracted Payer Source: ''
[06:09:16] ✅ Patient data extraction completed successfully
[06:09:16] ✅    ✅ Patient data extracted successfully
[06:09:16] 📊 Patient Response
     └─ patientFName: Dennis
     └─ patientLName: Clermont
     └─ dob: 09/27/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 2334940
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'E87.20', 'secondDiagnosis': 'E87.3', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': 'G20.C', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'I11.0'}]
[06:09:16] ✅    ✅ Patient identified: Dennis Clermont
[06:09:16] ✅    ✅ Patient name validation passed
[06:09:16] 🔄 
🔄 Step 3: Processing patient dates...
[06:09:16] [DOC: 9240648] ℹ️  DOB normalized: 09/27/1946
[06:09:16] [DOC: 9240648] ℹ️  Episode startOfCare normalized: 03/31/2025
[06:09:16] [DOC: 9240648] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[06:09:16] [DOC: 9240648] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[06:09:16] [DOC: 9240648] ✅ Patient date processing completed successfully
[06:09:16] ✅    ✅ Date processing completed
[06:09:16] 📊 Processed Patient Data
     └─ patientFName: Dennis
     └─ patientLName: Clermont
     └─ dob: 09/27/1946
     └─ patientSex: MALE
     └─ medicalRecordNo: 2334940
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2025', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': 'E87.20', 'secondDiagnosis': 'E87.3', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': 'G20.C', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'I11.0'}]
[06:09:16] 🔄 
🔄 Step 4: Extracting order data...
[06:09:19] ℹ️  Order extraction - MRN: '2334940'
[06:09:19] ℹ️  Order extraction - Sex: 'MALE'
[06:09:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[06:09:19] ℹ️  Order extraction - Payer Source: ''
[06:09:19] ✅ Order data extraction completed successfully
[06:09:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:09:19] ℹ️  Using MRN from patient data: '2334940' over '2334940'
[06:09:19] ℹ️  Service line consistent in both sources: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[06:09:19] ✅ Patient name cross-validation successful
[06:09:19] ✅    ✅ Data merged successfully
[06:09:20] ✅    ✅ Order data extracted and validated
[06:09:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:09:42] [DOC: 9240648] ✅ Patient exists in API: Dennis Clermont, ID: b6ef68e1-edb6-41b8-92f8-0f31a99c0d1f
[06:09:42] ✅    ✅ Existing patient found with ID: b6ef68e1-edb6-41b8-92f8-0f31a99c0d1f
[06:09:42] 🔄 
🔄 Step 6: Pushing order to API...
[06:09:42] [DOC: 9240648] ℹ️  Pushing order via API for patient ID: b6ef68e1-edb6-41b8-92f8-0f31a99c0d1f
[06:09:43] [DOC: 9240648] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14130"}
[06:09:43] ❌    ❌ Failed to push order
[06:09:43] 🔄 
🔄 Step 7: Writing to CSV...
[06:09:43] [DOC: 9240648] ℹ️  Calculated age: 78 from DOB: 09/27/1946
[06:09:43] [DOC: 9240648] ℹ️  Service Line extracted: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[06:09:43] [DOC: 9240648] ℹ️  Payer Source extracted: ''
[06:09:43] [DOC: 9240648] ℹ️  Diagnosis codes being written:
[06:09:43] [DOC: 9240648] ℹ️    - Latest_Episode_Firstdiagnosis: 'E87.20'
[06:09:43] [DOC: 9240648] ℹ️    - Latest_Episode_Seconddiagnosis: 'E87.3'
[06:09:43] [DOC: 9240648] ℹ️    - Latest_Episode_Thirddiagnosis: 'J18.9'
[06:09:43] [DOC: 9240648] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G20.C'
[06:09:43] [DOC: 9240648] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I25.10'
[06:09:43] [DOC: 9240648] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I11.0'
[06:09:43] [DOC: 9240648] ✅ Patient data written to CSV: Dennis Clermont | Sex: MALE | Age: 78 | Service: Skilled Nursing,Physical Therapy,Occupational Therapy | Payer:  | MRN: 2334940
[06:09:43] ✅    ✅ Document 9240648 processed and saved successfully
[06:09:43] 🔄 
🔄 Step 8: Saving API details...
[06:09:43] [DOC: 9240648] ℹ️  API push details saved for document 9240648
[06:09:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240640                         ║
================================================================================
[06:09:43] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:09:43] ℹ️  Date: 04/15/2025
[06:09:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:09:46] [DOC: 9240640] ✅ Text extracted using pdfplumber (6915 chars)
[06:09:46] ✅    ✅ Text extracted using pdfplumber (6915 chars)
[06:09:46] 🔄 
🔄 Step 2: Extracting patient data...
[06:09:48] ℹ️  AI extracted raw sex value: 'M'
[06:09:48] ℹ️  AI extracted service line: 'Nursing'
[06:09:48] ℹ️  AI extracted payer source: ''
[06:09:48] ℹ️  AI extracted diagnoses:
[06:09:48] ℹ️    - Diagnosis 1: 'I63.9'
[06:09:48] ℹ️    - Diagnosis 2: ''
[06:09:48] ℹ️    - Diagnosis 3: ''
[06:09:48] ℹ️    - Diagnosis 4: ''
[06:09:48] ℹ️    - Diagnosis 5: ''
[06:09:48] ℹ️    - Diagnosis 6: ''
[06:09:48] ℹ️  Final extracted MRN: '2312121'
[06:09:48] ℹ️  Final extracted Sex: 'MALE'
[06:09:48] ℹ️  Final extracted Service Line: 'Nursing'
[06:09:48] ℹ️  Final extracted Payer Source: ''
[06:09:48] ✅ Patient data extraction completed successfully
[06:09:48] ✅    ✅ Patient data extracted successfully
[06:09:48] 📊 Patient Response
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I63.9', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:09:48] ✅    ✅ Patient identified: Antonio Carvalho
[06:09:48] ✅    ✅ Patient name validation passed
[06:09:48] 🔄 
🔄 Step 3: Processing patient dates...
[06:09:48] [DOC: 9240640] ℹ️  DOB normalized: 07/01/1933
[06:09:48] [DOC: 9240640] ℹ️  Episode startOfCare normalized: 04/07/2025
[06:09:48] [DOC: 9240640] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[06:09:48] [DOC: 9240640] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[06:09:48] [DOC: 9240640] ✅ Patient date processing completed successfully
[06:09:48] ✅    ✅ Date processing completed
[06:09:48] 📊 Processed Patient Data
     └─ patientFName: Antonio
     └─ patientLName: Carvalho
     └─ dob: 07/01/1933
     └─ patientSex: MALE
     └─ medicalRecordNo: 2312121
     └─ billingProvider: Robert J Caldas, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': 'I63.9', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:09:48] 🔄 
🔄 Step 4: Extracting order data...
[06:09:51] ℹ️  Order extraction - MRN: '2312121'
[06:09:51] ℹ️  Order extraction - Sex: 'MALE'
[06:09:51] ℹ️  Order extraction - Service Line: 'Hospice'
[06:09:51] ℹ️  Order extraction - Payer Source: ''
[06:09:51] ✅ Order data extraction completed successfully
[06:09:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:09:51] ℹ️  Using MRN from patient data: '2312121' over '2312121'
[06:09:51] ℹ️  Combined service lines: Patient='Nursing' + Order='Hospice' = 'Hospice, Nursing'
[06:09:51] ✅ Patient name cross-validation successful
[06:09:51] ✅    ✅ Data merged successfully
[06:09:52] ✅    ✅ Order data extracted and validated
[06:09:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:10:08] [DOC: 9240640] ℹ️  Patient not found in cache or API: Antonio Carvalho
[06:10:08] [DOC: 9240640] ℹ️  Patient not found, creating new patient via API...
[06:10:08] [DOC: 9240640] ℹ️  Creating patient via API: Antonio Carvalho
[06:10:12] [DOC: 9240640] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:10:12] ❌    ❌ Failed to create patient
[06:10:12] [DOC: 9240640] ℹ️  API push details saved for document 9240640
================================================================================
║                        Processing Document ID: 9240633                         ║
================================================================================
[06:10:12] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:10:12] ℹ️  Date: 04/15/2025
[06:10:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:10:15] [DOC: 9240633] ✅ Text extracted using pdfplumber (18793 chars)
[06:10:15] ✅    ✅ Text extracted using pdfplumber (18793 chars)
[06:10:15] 🔄 
🔄 Step 2: Extracting patient data...
[06:10:19] ℹ️  AI extracted raw sex value: 'F'
[06:10:19] ℹ️  AI extracted service line: 'Physical Therapy, Skilled nursing'
[06:10:19] ℹ️  AI extracted payer source: ''
[06:10:19] ℹ️  AI extracted diagnoses:
[06:10:19] ℹ️    - Diagnosis 1: 'K92.2'
[06:10:19] ℹ️    - Diagnosis 2: 'D62'
[06:10:19] ℹ️    - Diagnosis 3: 'N17.9'
[06:10:19] ℹ️    - Diagnosis 4: 'I25.810'
[06:10:19] ℹ️    - Diagnosis 5: 'I48.0'
[06:10:19] ℹ️    - Diagnosis 6: 'I12.9'
[06:10:19] ℹ️  Final extracted MRN: '3148474'
[06:10:19] ℹ️  Final extracted Sex: 'FEMALE'
[06:10:19] ℹ️  Final extracted Service Line: 'Physical Therapy, Skilled nursing'
[06:10:19] ℹ️  Final extracted Payer Source: ''
[06:10:19] ✅ Patient data extraction completed successfully
[06:10:19] ✅    ✅ Patient data extracted successfully
[06:10:19] 📊 Patient Response
     └─ patientFName: Simone
     └─ patientLName: Benac
     └─ dob: 08/16/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3148474
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'K92.2', 'secondDiagnosis': 'D62', 'thirdDiagnosis': 'N17.9', 'fourthDiagnosis': 'I25.810', 'fifthDiagnosis': 'I48.0', 'sixthDiagnosis': 'I12.9'}]
[06:10:19] ✅    ✅ Patient identified: Simone Benac
[06:10:19] ✅    ✅ Patient name validation passed
[06:10:19] 🔄 
🔄 Step 3: Processing patient dates...
[06:10:19] [DOC: 9240633] ℹ️  DOB normalized: 08/16/1953
[06:10:19] [DOC: 9240633] ℹ️  Episode startOfCare normalized: 04/01/2025
[06:10:19] [DOC: 9240633] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[06:10:19] [DOC: 9240633] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[06:10:19] [DOC: 9240633] ✅ Patient date processing completed successfully
[06:10:19] ✅    ✅ Date processing completed
[06:10:19] 📊 Processed Patient Data
     └─ patientFName: Simone
     └─ patientLName: Benac
     └─ dob: 08/16/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3148474
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Skilled nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'K92.2', 'secondDiagnosis': 'D62', 'thirdDiagnosis': 'N17.9', 'fourthDiagnosis': 'I25.810', 'fifthDiagnosis': 'I48.0', 'sixthDiagnosis': 'I12.9'}]
[06:10:19] 🔄 
🔄 Step 4: Extracting order data...
[06:10:21] ℹ️  Order extraction - MRN: '3148474'
[06:10:21] ℹ️  Order extraction - Sex: 'FEMALE'
[06:10:21] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[06:10:21] ℹ️  Order extraction - Payer Source: ''
[06:10:21] ✅ Order data extraction completed successfully
[06:10:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:10:21] ℹ️  Using MRN from patient data: '3148474' over '3148474'
[06:10:21] ℹ️  Combined service lines: Patient='Physical Therapy, Skilled nursing' + Order='Physical Therapy' = 'Physical Therapy, Skilled nursing'
[06:10:21] ✅ Patient name cross-validation successful
[06:10:21] ✅    ✅ Data merged successfully
[06:10:23] ✅    ✅ Order data extracted and validated
[06:10:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:11:04] [DOC: 9240633] ✅ Patient exists in API: Simone Benac, ID: 6ef2ce76-2671-4a73-84f5-665624eb8e15
[06:11:04] ✅    ✅ Existing patient found with ID: 6ef2ce76-2671-4a73-84f5-665624eb8e15
[06:11:04] 🔄 
🔄 Step 6: Pushing order to API...
[06:11:04] [DOC: 9240633] ℹ️  Pushing order via API for patient ID: 6ef2ce76-2671-4a73-84f5-665624eb8e15
[06:11:05] [DOC: 9240633] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13090"}
[06:11:05] ❌    ❌ Failed to push order
[06:11:05] 🔄 
🔄 Step 7: Writing to CSV...
[06:11:05] [DOC: 9240633] ℹ️  Calculated age: 71 from DOB: 08/16/1953
[06:11:05] [DOC: 9240633] ℹ️  Service Line extracted: 'Physical Therapy, Skilled nursing'
[06:11:05] [DOC: 9240633] ℹ️  Payer Source extracted: ''
[06:11:05] [DOC: 9240633] ℹ️  Diagnosis codes being written:
[06:11:05] [DOC: 9240633] ℹ️    - Latest_Episode_Firstdiagnosis: 'K92.2'
[06:11:05] [DOC: 9240633] ℹ️    - Latest_Episode_Seconddiagnosis: 'D62'
[06:11:05] [DOC: 9240633] ℹ️    - Latest_Episode_Thirddiagnosis: 'N17.9'
[06:11:05] [DOC: 9240633] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I25.810'
[06:11:05] [DOC: 9240633] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I48.0'
[06:11:05] [DOC: 9240633] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I12.9'
[06:11:05] [DOC: 9240633] ✅ Patient data written to CSV: Simone Benac | Sex: FEMALE | Age: 71 | Service: Physical Therapy, Skilled nursing | Payer:  | MRN: 3148474
[06:11:05] ✅    ✅ Document 9240633 processed and saved successfully
[06:11:05] 🔄 
🔄 Step 8: Saving API details...
[06:11:05] [DOC: 9240633] ℹ️  API push details saved for document 9240633
[06:11:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240629                         ║
================================================================================
[06:11:05] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:11:05] ℹ️  Date: 04/15/2025
[06:11:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:11:08] [DOC: 9240629] ✅ Text extracted using pdfplumber (12267 chars)
[06:11:08] ✅    ✅ Text extracted using pdfplumber (12267 chars)
[06:11:08] 🔄 
🔄 Step 2: Extracting patient data...
[06:11:11] ℹ️  AI extracted raw sex value: 'F'
[06:11:11] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[06:11:11] ℹ️  AI extracted payer source: ''
[06:11:11] ℹ️  AI extracted diagnoses:
[06:11:11] ℹ️    - Diagnosis 1: 'S36.115A'
[06:11:11] ℹ️    - Diagnosis 2: 'V87.7XXA'
[06:11:11] ℹ️    - Diagnosis 3: 'S42.101A'
[06:11:11] ℹ️    - Diagnosis 4: 'S52.131A'
[06:11:11] ℹ️    - Diagnosis 5: ''
[06:11:11] ℹ️    - Diagnosis 6: ''
[06:11:11] ℹ️  Final extracted MRN: '2079984'
[06:11:11] ℹ️  Final extracted Sex: 'FEMALE'
[06:11:11] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[06:11:11] ℹ️  Final extracted Payer Source: ''
[06:11:11] ✅ Patient data extraction completed successfully
[06:11:11] ✅    ✅ Patient data extracted successfully
[06:11:11] 📊 Patient Response
     └─ patientFName: Kayla
     └─ patientLName: Bailey
     └─ dob: 04/27/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2079984
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/06/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'S36.115A', 'secondDiagnosis': 'V87.7XXA', 'thirdDiagnosis': 'S42.101A', 'fourthDiagnosis': 'S52.131A', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:11:11] ✅    ✅ Patient identified: Kayla Bailey
[06:11:11] ✅    ✅ Patient name validation passed
[06:11:11] 🔄 
🔄 Step 3: Processing patient dates...
[06:11:11] [DOC: 9240629] ℹ️  DOB normalized: 04/27/1994
[06:11:11] [DOC: 9240629] ℹ️  Episode startOfCare normalized: 04/06/2025
[06:11:11] [DOC: 9240629] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[06:11:11] [DOC: 9240629] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[06:11:11] [DOC: 9240629] ✅ Patient date processing completed successfully
[06:11:11] ✅    ✅ Date processing completed
[06:11:11] 📊 Processed Patient Data
     └─ patientFName: Kayla
     └─ patientLName: Bailey
     └─ dob: 04/27/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2079984
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/06/2025', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'S36.115A', 'secondDiagnosis': 'V87.7XXA', 'thirdDiagnosis': 'S42.101A', 'fourthDiagnosis': 'S52.131A', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:11:11] 🔄 
🔄 Step 4: Extracting order data...
[06:11:13] ℹ️  Order extraction - MRN: '2079984'
[06:11:13] ℹ️  Order extraction - Sex: 'FEMALE'
[06:11:13] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy'
[06:11:13] ℹ️  Order extraction - Payer Source: ''
[06:11:13] ✅ Order data extraction completed successfully
[06:11:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:11:13] ℹ️  Using MRN from patient data: '2079984' over '2079984'
[06:11:13] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy'
[06:11:13] ✅ Patient name cross-validation successful
[06:11:13] ✅    ✅ Data merged successfully
[06:11:15] ✅    ✅ Order data extracted and validated
[06:11:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:11:21] [DOC: 9240629] ✅ Patient exists in API: Kayla Bailey, ID: 11afb3fa-f877-4dab-b775-4c852921615b
[06:11:21] ✅    ✅ Existing patient found with ID: 11afb3fa-f877-4dab-b775-4c852921615b
[06:11:21] 🔄 
🔄 Step 6: Pushing order to API...
[06:11:21] [DOC: 9240629] ℹ️  Pushing order via API for patient ID: 11afb3fa-f877-4dab-b775-4c852921615b
[06:11:23] [DOC: 9240629] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12976"}
[06:11:23] ❌    ❌ Failed to push order
[06:11:23] 🔄 
🔄 Step 7: Writing to CSV...
[06:11:23] [DOC: 9240629] ℹ️  Calculated age: 31 from DOB: 04/27/1994
[06:11:23] [DOC: 9240629] ℹ️  Service Line extracted: 'Physical Therapy, Occupational Therapy'
[06:11:23] [DOC: 9240629] ℹ️  Payer Source extracted: ''
[06:11:23] [DOC: 9240629] ℹ️  Diagnosis codes being written:
[06:11:23] [DOC: 9240629] ℹ️    - Latest_Episode_Firstdiagnosis: 'S36.115A'
[06:11:23] [DOC: 9240629] ℹ️    - Latest_Episode_Seconddiagnosis: 'V87.7XXA'
[06:11:23] [DOC: 9240629] ℹ️    - Latest_Episode_Thirddiagnosis: 'S42.101A'
[06:11:23] [DOC: 9240629] ℹ️    - Latest_Episode_Fourthdiagnosis: 'S52.131A'
[06:11:23] [DOC: 9240629] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:11:23] [DOC: 9240629] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:11:23] [DOC: 9240629] ✅ Patient data written to CSV: Kayla Bailey | Sex: FEMALE | Age: 31 | Service: Physical Therapy, Occupational Therapy | Payer:  | MRN: 2079984
[06:11:23] ✅    ✅ Document 9240629 processed and saved successfully
[06:11:23] 🔄 
🔄 Step 8: Saving API details...
[06:11:23] [DOC: 9240629] ℹ️  API push details saved for document 9240629
[06:11:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240625                         ║
================================================================================
[06:11:23] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:11:23] ℹ️  Date: 04/15/2025
[06:11:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:11:30] [DOC: 9240625] ✅ Text extracted using pdfplumber (16380 chars)
[06:11:30] ✅    ✅ Text extracted using pdfplumber (16380 chars)
[06:11:30] 🔄 
🔄 Step 2: Extracting patient data...
[06:11:34] ℹ️  AI extracted raw sex value: 'F'
[06:11:34] ℹ️  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[06:11:34] ℹ️  AI extracted payer source: ''
[06:11:34] ℹ️  AI extracted diagnoses:
[06:11:34] ℹ️    - Diagnosis 1: 'C85.14'
[06:11:34] ℹ️    - Diagnosis 2: 'I10'
[06:11:34] ℹ️    - Diagnosis 3: 'E11.9'
[06:11:34] ℹ️    - Diagnosis 4: 'K21.9'
[06:11:34] ℹ️    - Diagnosis 5: 'E78.49'
[06:11:34] ℹ️    - Diagnosis 6: 'Z79.82'
[06:11:34] ℹ️  Final extracted MRN: '2185063'
[06:11:34] ℹ️  Final extracted Sex: 'FEMALE'
[06:11:34] ℹ️  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[06:11:34] ℹ️  Final extracted Payer Source: ''
[06:11:34] ✅ Patient data extraction completed successfully
[06:11:34] ✅    ✅ Patient data extracted successfully
[06:11:34] 📊 Patient Response
     └─ patientFName: Kathleen
     └─ patientLName: Amaral
     └─ dob: 11/28/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2185063
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'C85.14', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'K21.9', 'fifthDiagnosis': 'E78.49', 'sixthDiagnosis': 'Z79.82'}]
[06:11:34] ✅    ✅ Patient identified: Kathleen Amaral
[06:11:34] ✅    ✅ Patient name validation passed
[06:11:34] 🔄 
🔄 Step 3: Processing patient dates...
[06:11:34] [DOC: 9240625] ℹ️  DOB normalized: 11/28/1942
[06:11:34] [DOC: 9240625] ℹ️  Episode startOfCare normalized: 03/25/2025
[06:11:34] [DOC: 9240625] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[06:11:34] [DOC: 9240625] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[06:11:34] [DOC: 9240625] ✅ Patient date processing completed successfully
[06:11:34] ✅    ✅ Date processing completed
[06:11:34] 📊 Processed Patient Data
     └─ patientFName: Kathleen
     └─ patientLName: Amaral
     └─ dob: 11/28/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2185063
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'C85.14', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'E11.9', 'fourthDiagnosis': 'K21.9', 'fifthDiagnosis': 'E78.49', 'sixthDiagnosis': 'Z79.82'}]
[06:11:34] 🔄 
🔄 Step 4: Extracting order data...
[06:11:38] ℹ️  Order extraction - MRN: '2185063'
[06:11:38] ℹ️  Order extraction - Sex: 'FEMALE'
[06:11:38] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Occupational Therapy, Physical Therapy'
[06:11:38] ℹ️  Order extraction - Payer Source: ''
[06:11:38] ✅ Order data extraction completed successfully
[06:11:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:11:38] ℹ️  Using MRN from patient data: '2185063' over '2185063'
[06:11:38] ℹ️  Combined service lines: Patient='Skilled Nursing,Physical Therapy,Occupational Therapy' + Order='Skilled Nursing, Occupational Therapy, Physical Therapy' = 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[06:11:38] ✅ Patient name cross-validation successful
[06:11:38] ✅    ✅ Data merged successfully
[06:11:39] ✅    ✅ Order data extracted and validated
[06:11:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:11:39] [DOC: 9240625] ✅ Patient found in local cache: Kathleen Amaral, ID: c71782d3-7550-4bcd-9db4-837db83621d1
[06:11:39] ✅    ✅ Existing patient found with ID: c71782d3-7550-4bcd-9db4-837db83621d1
[06:11:39] 🔄 
🔄 Step 6: Pushing order to API...
[06:11:39] [DOC: 9240625] ℹ️  Pushing order via API for patient ID: c71782d3-7550-4bcd-9db4-837db83621d1
[06:11:40] [DOC: 9240625] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12918"}
[06:11:40] ❌    ❌ Failed to push order
[06:11:40] 🔄 
🔄 Step 7: Writing to CSV...
[06:11:40] [DOC: 9240625] ℹ️  Calculated age: 82 from DOB: 11/28/1942
[06:11:40] [DOC: 9240625] ℹ️  Service Line extracted: 'Occupational Therapy, Physical Therapy, Skilled Nursing'
[06:11:40] [DOC: 9240625] ℹ️  Payer Source extracted: ''
[06:11:40] [DOC: 9240625] ℹ️  Diagnosis codes being written:
[06:11:40] [DOC: 9240625] ℹ️    - Latest_Episode_Firstdiagnosis: 'C85.14'
[06:11:40] [DOC: 9240625] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[06:11:40] [DOC: 9240625] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.9'
[06:11:40] [DOC: 9240625] ℹ️    - Latest_Episode_Fourthdiagnosis: 'K21.9'
[06:11:40] [DOC: 9240625] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E78.49'
[06:11:40] [DOC: 9240625] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z79.82'
[06:11:40] [DOC: 9240625] ✅ Patient data written to CSV: Kathleen Amaral | Sex: FEMALE | Age: 82 | Service: Occupational Therapy, Physical Therapy, Skilled Nursing | Payer:  | MRN: 2185063
[06:11:40] ✅    ✅ Document 9240625 processed and saved successfully
[06:11:40] 🔄 
🔄 Step 8: Saving API details...
[06:11:40] [DOC: 9240625] ℹ️  API push details saved for document 9240625
[06:11:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240621                         ║
================================================================================
[06:11:40] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[06:11:40] ℹ️  Date: 04/15/2025
[06:11:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:11:42] [DOC: 9240621] ✅ Text extracted using pdfplumber (1028 chars)
[06:11:42] ✅    ✅ Text extracted using pdfplumber (1028 chars)
[06:11:42] 🔄 
🔄 Step 2: Extracting patient data...
[06:11:45] ℹ️  AI extracted raw sex value: 'F'
[06:11:45] ℹ️  AI extracted service line: 'RN'
[06:11:45] ℹ️  AI extracted payer source: ''
[06:11:45] ℹ️  AI extracted diagnoses:
[06:11:45] ℹ️    - Diagnosis 1: ''
[06:11:45] ℹ️    - Diagnosis 2: ''
[06:11:45] ℹ️    - Diagnosis 3: ''
[06:11:45] ℹ️    - Diagnosis 4: ''
[06:11:45] ℹ️    - Diagnosis 5: ''
[06:11:45] ℹ️    - Diagnosis 6: ''
[06:11:45] ℹ️  Final extracted MRN: '2182563'
[06:11:45] ℹ️  Final extracted Sex: 'FEMALE'
[06:11:45] ℹ️  Final extracted Service Line: 'RN'
[06:11:45] ℹ️  Final extracted Payer Source: ''
[06:11:45] ✅ Patient data extraction completed successfully
[06:11:45] ✅    ✅ Patient data extracted successfully
[06:11:45] 📊 Patient Response
     └─ patientFName: Lois
     └─ patientLName: Alves
     └─ dob: 05/13/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2182563
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:11:45] ✅    ✅ Patient identified: Lois Alves
[06:11:45] ✅    ✅ Patient name validation passed
[06:11:45] 🔄 
🔄 Step 3: Processing patient dates...
[06:11:45] [DOC: 9240621] ℹ️  DOB normalized: 05/13/1951
[06:11:45] [DOC: 9240621] ✅ Patient date processing completed successfully
[06:11:45] ✅    ✅ Date processing completed
[06:11:45] 📊 Processed Patient Data
     └─ patientFName: Lois
     └─ patientLName: Alves
     └─ dob: 05/13/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2182563
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:11:45] 🔄 
🔄 Step 4: Extracting order data...
[06:11:47] ℹ️  Order extraction - MRN: '2182563'
[06:11:47] ℹ️  Order extraction - Sex: 'FEMALE'
[06:11:47] ℹ️  Order extraction - Service Line: ''
[06:11:47] ℹ️  Order extraction - Payer Source: ''
[06:11:47] ✅ Order data extraction completed successfully
[06:11:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:11:47] ℹ️  Using MRN from patient data: '2182563' over '2182563'
[06:11:47] ℹ️  Using service line from patient data: 'RN'
[06:11:47] ✅ Patient name cross-validation successful
[06:11:47] ✅    ✅ Data merged successfully
[06:11:48] ✅    ✅ Order data extracted and validated
[06:11:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:11:48] [DOC: 9240621] ✅ Patient found in local cache: Lois Alves, ID: 4724f2cc-508f-4d9d-86fe-13e23e62f9c5
[06:11:48] ✅    ✅ Existing patient found with ID: 4724f2cc-508f-4d9d-86fe-13e23e62f9c5
[06:11:48] 🔄 
🔄 Step 6: Pushing order to API...
[06:11:48] [DOC: 9240621] ℹ️  Pushing order via API for patient ID: 4724f2cc-508f-4d9d-86fe-13e23e62f9c5
[06:11:50] [DOC: 9240621] ❌ Order push failed with status 201: {"id":"457a4c95-7bdd-4358-b721-b8d7dbe04390","orderWAVId":"ORD20032","orderNo":"1081702","orderDate":"04/14/2025","startOfCare":"02/10/2024","episodeStartDate":"02/10/2024","episodeEndDate":"04/09/2024","documentID":"9240621","mrn":"2182563","patientName":"Alves,Lois M","sentToPhysicianDate":"04/15/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/17/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"4724f2cc-508f-4d9d-86fe-13e23e62f9c5","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[06:11:50] ❌    ❌ Failed to push order
[06:11:50] 🔄 
🔄 Step 7: Writing to CSV...
[06:11:50] [DOC: 9240621] ℹ️  Calculated age: 74 from DOB: 05/13/1951
[06:11:50] [DOC: 9240621] ℹ️  Service Line extracted: 'RN'
[06:11:50] [DOC: 9240621] ℹ️  Payer Source extracted: ''
[06:11:50] [DOC: 9240621] ℹ️  Diagnosis codes being written:
[06:11:50] [DOC: 9240621] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:11:50] [DOC: 9240621] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:11:50] [DOC: 9240621] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:11:50] [DOC: 9240621] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:11:50] [DOC: 9240621] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:11:50] [DOC: 9240621] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:11:50] [DOC: 9240621] ✅ Patient data written to CSV: Lois Alves | Sex: FEMALE | Age: 74 | Service: RN | Payer:  | MRN: 2182563
[06:11:50] ✅    ✅ Document 9240621 processed and saved successfully
[06:11:50] 🔄 
🔄 Step 8: Saving API details...
[06:11:50] [DOC: 9240621] ℹ️  API push details saved for document 9240621
[06:11:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240485                         ║
================================================================================
[06:11:50] ℹ️  Agency: Relief Home Health Services
[06:11:50] ℹ️  Date: 04/15/2025
[06:11:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:11:53] [DOC: 9240485] ✅ Text extracted using pdfplumber (11542 chars)
[06:11:53] ✅    ✅ Text extracted using pdfplumber (11542 chars)
[06:11:53] 🔄 
🔄 Step 2: Extracting patient data...
[06:11:56] ℹ️  AI extracted raw sex value: 'M'
[06:11:56] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:11:56] ℹ️  AI extracted payer source: ''
[06:11:56] ℹ️  AI extracted diagnoses:
[06:11:56] ℹ️    - Diagnosis 1: 'E11.9'
[06:11:56] ℹ️    - Diagnosis 2: 'I10'
[06:11:56] ℹ️    - Diagnosis 3: 'R26.81'
[06:11:56] ℹ️    - Diagnosis 4: 'R29.6'
[06:11:56] ℹ️    - Diagnosis 5: 'R53.1'
[06:11:56] ℹ️    - Diagnosis 6: 'G95.89'
[06:11:56] ℹ️  Final extracted MRN: 'NB2425'
[06:11:56] ℹ️  Final extracted Sex: 'MALE'
[06:11:56] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:11:56] ℹ️  Final extracted Payer Source: ''
[06:11:56] ✅ Patient data extraction completed successfully
[06:11:56] ✅    ✅ Patient data extracted successfully
[06:11:56] 📊 Patient Response
     └─ patientFName: JOSE
     └─ patientLName: MOURAO
     └─ dob: 02/09/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: NB2425
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 12 Ruth St Apt 910
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (508) 863-2906
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/31/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'R26.81', 'fourthDiagnosis': 'R29.6', 'fifthDiagnosis': 'R53.1', 'sixthDiagnosis': 'G95.89'}]
[06:11:56] ✅    ✅ Patient identified: JOSE MOURAO
[06:11:56] ✅    ✅ Patient name validation passed
[06:11:56] 🔄 
🔄 Step 3: Processing patient dates...
[06:11:56] [DOC: 9240485] ℹ️  DOB normalized: 02/09/1952
[06:11:56] [DOC: 9240485] ℹ️  Episode startOfCare normalized: 01/31/2025
[06:11:56] [DOC: 9240485] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[06:11:56] [DOC: 9240485] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[06:11:56] [DOC: 9240485] ✅ Patient date processing completed successfully
[06:11:56] ✅    ✅ Date processing completed
[06:11:56] 📊 Processed Patient Data
     └─ patientFName: JOSE
     └─ patientLName: MOURAO
     └─ dob: 02/09/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: NB2425
     └─ billingProvider: Relief Home Health Services, Inc
     └─ npi: 1871748210
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: Relief Home Health Services, Inc
     └─ address: 12 Ruth St Apt 910
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (508) 863-2906
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/31/2025', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': 'E11.9', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'R26.81', 'fourthDiagnosis': 'R29.6', 'fifthDiagnosis': 'R53.1', 'sixthDiagnosis': 'G95.89'}]
[06:11:56] 🔄 
🔄 Step 4: Extracting order data...
[06:11:59] ℹ️  Order extraction - MRN: 'NB2425'
[06:11:59] ℹ️  Order extraction - Sex: 'MALE'
[06:11:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:11:59] ℹ️  Order extraction - Payer Source: ''
[06:11:59] ✅ Order data extraction completed successfully
[06:11:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:11:59] ℹ️  Using MRN from patient data: 'NB2425' over 'NB2425'
[06:11:59] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:11:59] ✅ Patient name cross-validation successful
[06:11:59] ✅    ✅ Data merged successfully
[06:12:00] ✅    ✅ Order data extracted and validated
[06:12:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:12:40] [DOC: 9240485] ℹ️  Patient not found in cache or API: JOSE MOURAO
[06:12:40] [DOC: 9240485] ℹ️  Patient not found, creating new patient via API...
[06:12:40] [DOC: 9240485] ℹ️  Creating patient via API: JOSE MOURAO
[06:12:41] [DOC: 9240485] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:12:41] ❌    ❌ Failed to create patient
[06:12:41] [DOC: 9240485] ℹ️  API push details saved for document 9240485
================================================================================
║                        Processing Document ID: 9240336                         ║
================================================================================
[06:12:41] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:12:41] ℹ️  Date: 04/15/2025
[06:12:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:12:47] [DOC: 9240336] ✅ Text extracted using pdfplumber (10705 chars)
[06:12:47] ✅    ✅ Text extracted using pdfplumber (10705 chars)
[06:12:47] 🔄 
🔄 Step 2: Extracting patient data...
[06:12:50] ℹ️  AI extracted raw sex value: 'F'
[06:12:50] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:12:50] ℹ️  AI extracted payer source: 'Medicare'
[06:12:50] ℹ️  AI extracted diagnoses:
[06:12:50] ℹ️    - Diagnosis 1: 'I11.9'
[06:12:50] ℹ️    - Diagnosis 2: 'M13.861'
[06:12:50] ℹ️    - Diagnosis 3: 'E78.5'
[06:12:50] ℹ️    - Diagnosis 4: 'G89.4'
[06:12:50] ℹ️    - Diagnosis 5: 'Z79.51'
[06:12:50] ℹ️    - Diagnosis 6: 'Z87.440'
[06:12:50] ℹ️  Final extracted MRN: 'MA230405053003'
[06:12:50] ℹ️  Final extracted Sex: 'FEMALE'
[06:12:50] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:12:50] ℹ️  Final extracted Payer Source: 'Medicare'
[06:12:50] ✅ Patient data extraction completed successfully
[06:12:50] ✅    ✅ Patient data extracted successfully
[06:12:50] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Santos
     └─ dob: 05/01/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230405053003
     └─ billingProvider: JONCAS, CHRISTOPHER MD
     └─ npi: 1336136456
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/09/2023', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'I11.9', 'secondDiagnosis': 'M13.861', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'G89.4', 'fifthDiagnosis': 'Z79.51', 'sixthDiagnosis': 'Z87.440'}]
[06:12:50] ✅    ✅ Patient identified: Maria Santos
[06:12:50] ✅    ✅ Patient name validation passed
[06:12:50] 🔄 
🔄 Step 3: Processing patient dates...
[06:12:50] [DOC: 9240336] ℹ️  DOB normalized: 05/01/1930
[06:12:50] [DOC: 9240336] ℹ️  Episode startOfCare normalized: 04/09/2023
[06:12:50] [DOC: 9240336] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[06:12:50] [DOC: 9240336] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[06:12:50] [DOC: 9240336] ✅ Patient date processing completed successfully
[06:12:50] ✅    ✅ Date processing completed
[06:12:50] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Santos
     └─ dob: 05/01/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA230405053003
     └─ billingProvider: JONCAS, CHRISTOPHER MD
     └─ npi: 1336136456
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780-3561
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/09/2023', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'I11.9', 'secondDiagnosis': 'M13.861', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': 'G89.4', 'fifthDiagnosis': 'Z79.51', 'sixthDiagnosis': 'Z87.440'}]
[06:12:50] 🔄 
🔄 Step 4: Extracting order data...
[06:12:52] ℹ️  Order extraction - MRN: 'MA230405053003'
[06:12:52] ℹ️  Order extraction - Sex: 'FEMALE'
[06:12:52] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:12:52] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:12:52] ✅ Order data extraction completed successfully
[06:12:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:12:52] ℹ️  Using MRN from patient data: 'MA230405053003' over 'MA230405053003'
[06:12:52] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:12:52] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:12:52] ✅ Patient name cross-validation successful
[06:12:52] ✅    ✅ Data merged successfully
[06:12:54] ✅    ✅ Order data extracted and validated
[06:12:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:13:24] [DOC: 9240336] ✅ Patient exists in API: Maria Santos, ID: 7eccab12-fbe5-4ad4-869c-e0763de0840a
[06:13:24] ✅    ✅ Existing patient found with ID: 7eccab12-fbe5-4ad4-869c-e0763de0840a
[06:13:24] 🔄 
🔄 Step 6: Pushing order to API...
[06:13:24] [DOC: 9240336] ℹ️  Pushing order via API for patient ID: 7eccab12-fbe5-4ad4-869c-e0763de0840a
[06:13:25] [DOC: 9240336] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14379"}
[06:13:25] ❌    ❌ Failed to push order
[06:13:25] 🔄 
🔄 Step 7: Writing to CSV...
[06:13:25] [DOC: 9240336] ℹ️  Calculated age: 95 from DOB: 05/01/1930
[06:13:25] [DOC: 9240336] ℹ️  Service Line extracted: 'Skilled Nursing'
[06:13:25] [DOC: 9240336] ℹ️  Payer Source extracted: 'Medicare'
[06:13:25] [DOC: 9240336] ℹ️  Diagnosis codes being written:
[06:13:25] [DOC: 9240336] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.9'
[06:13:25] [DOC: 9240336] ℹ️    - Latest_Episode_Seconddiagnosis: 'M13.861'
[06:13:25] [DOC: 9240336] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[06:13:25] [DOC: 9240336] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G89.4'
[06:13:25] [DOC: 9240336] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z79.51'
[06:13:25] [DOC: 9240336] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z87.440'
[06:13:25] [DOC: 9240336] ✅ Patient data written to CSV: Maria Santos | Sex: FEMALE | Age: 95 | Service: Skilled Nursing | Payer: Medicare | MRN: MA230405053003
[06:13:25] ✅    ✅ Document 9240336 processed and saved successfully
[06:13:25] 🔄 
🔄 Step 8: Saving API details...
[06:13:25] [DOC: 9240336] ℹ️  API push details saved for document 9240336
[06:13:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240325                         ║
================================================================================
[06:13:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:13:25] ℹ️  Date: 04/15/2025
[06:13:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:13:29] [DOC: 9240325] ✅ Text extracted using pdfplumber (26565 chars)
[06:13:29] ✅    ✅ Text extracted using pdfplumber (26565 chars)
[06:13:29] 🔄 
🔄 Step 2: Extracting patient data...
[06:13:32] ℹ️  AI extracted raw sex value: 'M'
[06:13:32] ℹ️  AI extracted service line: 'PT'
[06:13:32] ℹ️  AI extracted payer source: ''
[06:13:32] ℹ️  AI extracted diagnoses:
[06:13:32] ℹ️    - Diagnosis 1: 'Ventricular tachycardia, unspecified'
[06:13:32] ℹ️    - Diagnosis 2: 'Muscle weakness'
[06:13:32] ℹ️    - Diagnosis 3: 'Alzheimer's disease'
[06:13:32] ℹ️    - Diagnosis 4: 'HTN'
[06:13:32] ℹ️    - Diagnosis 5: 'Hyperlipidemia'
[06:13:32] ℹ️    - Diagnosis 6: 'GERD'
[06:13:32] ℹ️  Final extracted MRN: 'MA230606093702'
[06:13:32] ℹ️  Final extracted Sex: 'MALE'
[06:13:32] ℹ️  Final extracted Service Line: 'PT'
[06:13:32] ℹ️  Final extracted Payer Source: ''
[06:13:32] ✅ Patient data extraction completed successfully
[06:13:32] ✅    ✅ Patient data extracted successfully
[06:13:32] 📊 Patient Response
     └─ patientFName: Ilidio
     └─ patientLName: Pacheco
     └─ dob: 09/10/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230606093702
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '11/14/2024', 'endOfEpisode': None, 'firstDiagnosis': 'Ventricular tachycardia, unspecified', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': "Alzheimer's disease", 'fourthDiagnosis': 'HTN', 'fifthDiagnosis': 'Hyperlipidemia', 'sixthDiagnosis': 'GERD'}]
[06:13:32] ✅    ✅ Patient identified: Ilidio Pacheco
[06:13:32] ✅    ✅ Patient name validation passed
[06:13:32] 🔄 
🔄 Step 3: Processing patient dates...
[06:13:32] [DOC: 9240325] ℹ️  DOB normalized: 09/10/1937
[06:13:32] [DOC: 9240325] ℹ️  Episode startOfEpisode normalized: 11/14/2024
[06:13:32] [DOC: 9240325] ✅ Patient date processing completed successfully
[06:13:32] ✅    ✅ Date processing completed
[06:13:32] 📊 Processed Patient Data
     └─ patientFName: Ilidio
     └─ patientLName: Pacheco
     └─ dob: 09/10/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: MA230606093702
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '11/14/2024', 'firstDiagnosis': 'Ventricular tachycardia, unspecified', 'secondDiagnosis': 'Muscle weakness', 'thirdDiagnosis': "Alzheimer's disease", 'fourthDiagnosis': 'HTN', 'fifthDiagnosis': 'Hyperlipidemia', 'sixthDiagnosis': 'GERD'}]
[06:13:32] 🔄 
🔄 Step 4: Extracting order data...
[06:13:35] ℹ️  Order extraction - MRN: 'MA230606093702'
[06:13:35] ℹ️  Order extraction - Sex: 'MALE'
[06:13:35] ℹ️  Order extraction - Service Line: 'PT'
[06:13:35] ℹ️  Order extraction - Payer Source: ''
[06:13:35] ✅ Order data extraction completed successfully
[06:13:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:13:35] ℹ️  Using MRN from patient data: 'MA230606093702' over 'MA230606093702'
[06:13:35] ℹ️  Service line consistent in both sources: 'PT'
[06:13:35] ✅ Patient name cross-validation successful
[06:13:35] ✅    ✅ Data merged successfully
[06:13:36] ⚠️     ❌ Skipping - missing episode start date
[06:13:36] [DOC: 9240325] ℹ️  API push details saved for document 9240325
================================================================================
║                        Processing Document ID: 9240223                         ║
================================================================================
[06:13:36] ℹ️  Agency: Compassionate Care Hospice-Taunton
[06:13:36] ℹ️  Date: 04/15/2025
[06:13:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:13:38] [DOC: 9240223] ✅ Text extracted using pdfplumber (1286 chars)
[06:13:38] ✅    ✅ Text extracted using pdfplumber (1274 chars)
[06:13:38] 🔄 
🔄 Step 2: Extracting patient data...
[06:13:41] ℹ️  AI extracted raw sex value: ''
[06:13:41] ℹ️  AI extracted service line: 'Hospice'
[06:13:41] ℹ️  AI extracted payer source: 'Medicare'
[06:13:41] ℹ️  AI extracted diagnoses:
[06:13:41] ℹ️    - Diagnosis 1: 'None'
[06:13:41] ℹ️    - Diagnosis 2: 'None'
[06:13:41] ℹ️    - Diagnosis 3: 'None'
[06:13:41] ℹ️    - Diagnosis 4: 'None'
[06:13:41] ℹ️    - Diagnosis 5: 'None'
[06:13:41] ℹ️    - Diagnosis 6: 'None'
[06:13:41] ℹ️  Final extracted MRN: 'B3700296223202'
[06:13:41] ℹ️  Final extracted Sex: ''
[06:13:41] ℹ️  Final extracted Service Line: 'Hospice'
[06:13:41] ℹ️  Final extracted Payer Source: 'Medicare'
[06:13:41] ✅ Patient data extraction completed successfully
[06:13:41] ✅    ✅ Patient data extracted successfully
[06:13:41] 📊 Patient Response
     └─ patientFName: MARIA
     └─ patientLName: JARDIM
     └─ dob: 05/20/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700296223202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/13/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:13:41] ✅    ✅ Patient identified: MARIA JARDIM
[06:13:41] ✅    ✅ Patient name validation passed
[06:13:41] 🔄 
🔄 Step 3: Processing patient dates...
[06:13:41] [DOC: 9240223] ℹ️  DOB normalized: 05/20/1931
[06:13:41] [DOC: 9240223] ℹ️  Episode startOfEpisode normalized: 04/13/2025
[06:13:41] [DOC: 9240223] ✅ Patient date processing completed successfully
[06:13:41] ✅    ✅ Date processing completed
[06:13:41] 📊 Processed Patient Data
     └─ patientFName: MARIA
     └─ patientLName: JARDIM
     └─ dob: 05/20/1931
     └─ patientSex: 
     └─ medicalRecordNo: B3700296223202
     └─ billingProvider: COMPASSIONATE CARE HOSPICE
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: COMPASSIONATE CARE HOSPICE
     └─ address: 4475 2 LAKESHORE CENTER SUITE 110
     └─ city: BRIDGEWATER
     └─ state: MA
     └─ zip: 02324-1077
     └─ email: 
     └─ phoneNumber: (508) 399-5900
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/13/2025'}]
[06:13:41] 🔄 
🔄 Step 4: Extracting order data...
[06:13:44] ℹ️  Order extraction - MRN: 'B3700296223202'
[06:13:44] ℹ️  Order extraction - Sex: ''
[06:13:44] ℹ️  Order extraction - Service Line: 'Hospice'
[06:13:44] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:13:44] ✅ Order data extraction completed successfully
[06:13:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:13:44] ℹ️  Using MRN from patient data: 'B3700296223202' over 'B3700296223202'
[06:13:44] ℹ️  Inferred sex as FEMALE from name: MARIA
[06:13:44] ℹ️  Service line consistent in both sources: 'Hospice'
[06:13:44] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:13:44] ✅ Patient name cross-validation successful
[06:13:44] ✅    ✅ Data merged successfully
[06:13:45] ✅    ✅ Order data extracted and validated
[06:13:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:13:45] [DOC: 9240223] ✅ Patient found in local cache: MARIA JARDIM, ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[06:13:45] ✅    ✅ Existing patient found with ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[06:13:45] 🔄 
🔄 Step 6: Pushing order to API...
[06:13:45] [DOC: 9240223] ℹ️  Pushing order via API for patient ID: b4164e43-2407-47e7-a001-5a62bcf633fe
[06:13:46] [DOC: 9240223] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13849"}
[06:13:46] ❌    ❌ Failed to push order
[06:13:46] 🔄 
🔄 Step 7: Writing to CSV...
[06:13:46] [DOC: 9240223] ℹ️  Calculated age: 94 from DOB: 05/20/1931
[06:13:46] [DOC: 9240223] ℹ️  Service Line extracted: 'Hospice'
[06:13:46] [DOC: 9240223] ℹ️  Payer Source extracted: 'Medicare'
[06:13:46] [DOC: 9240223] ℹ️  Diagnosis codes being written:
[06:13:46] [DOC: 9240223] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:13:46] [DOC: 9240223] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:13:46] [DOC: 9240223] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:13:46] [DOC: 9240223] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:13:46] [DOC: 9240223] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:13:46] [DOC: 9240223] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:13:46] [DOC: 9240223] ✅ Patient data written to CSV: MARIA JARDIM | Sex: FEMALE | Age: 94 | Service: Hospice | Payer: Medicare | MRN: B3700296223202
[06:13:46] ✅    ✅ Document 9240223 processed and saved successfully
[06:13:46] 🔄 
🔄 Step 8: Saving API details...
[06:13:46] [DOC: 9240223] ℹ️  API push details saved for document 9240223
[06:13:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240215                         ║
================================================================================
[06:13:46] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:13:46] ℹ️  Date: 04/15/2025
[06:13:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:13:49] [DOC: 9240215] ✅ Text extracted using pdfplumber (10728 chars)
[06:13:49] ✅    ✅ Text extracted using pdfplumber (10728 chars)
[06:13:49] 🔄 
🔄 Step 2: Extracting patient data...
[06:13:53] ℹ️  AI extracted raw sex value: 'F'
[06:13:53] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:13:53] ℹ️  AI extracted payer source: 'Medicare'
[06:13:53] ℹ️  AI extracted diagnoses:
[06:13:53] ℹ️    - Diagnosis 1: 'I48.91'
[06:13:53] ℹ️    - Diagnosis 2: 'M47.9'
[06:13:53] ℹ️    - Diagnosis 3: 'J45.909'
[06:13:53] ℹ️    - Diagnosis 4: 'I10'
[06:13:53] ℹ️    - Diagnosis 5: 'C90.00'
[06:13:53] ℹ️    - Diagnosis 6: 'D63.0'
[06:13:53] ℹ️  Final extracted MRN: '100990978'
[06:13:53] ℹ️  Final extracted Sex: 'FEMALE'
[06:13:53] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:13:53] ℹ️  Final extracted Payer Source: 'Medicare'
[06:13:53] ✅ Patient data extraction completed successfully
[06:13:53] ✅    ✅ Patient data extracted successfully
[06:13:53] 📊 Patient Response
     └─ patientFName: Zelia
     └─ patientLName: Correia
     └─ dob: 12/15/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990978
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 1881923936
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 12 Ruth St, APT 621
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: None
     └─ phoneNumber: (508) 993-0478
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/30/2015', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'I48.91', 'secondDiagnosis': 'M47.9', 'thirdDiagnosis': 'J45.909', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'C90.00', 'sixthDiagnosis': 'D63.0'}]
[06:13:53] ✅    ✅ Patient identified: Zelia Correia
[06:13:53] ✅    ✅ Patient name validation passed
[06:13:53] 🔄 
🔄 Step 3: Processing patient dates...
[06:13:53] [DOC: 9240215] ℹ️  DOB normalized: 12/15/1940
[06:13:53] [DOC: 9240215] ℹ️  Episode startOfCare normalized: 05/30/2015
[06:13:53] [DOC: 9240215] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[06:13:53] [DOC: 9240215] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[06:13:53] [DOC: 9240215] ✅ Patient date processing completed successfully
[06:13:53] ✅    ✅ Date processing completed
[06:13:53] 📊 Processed Patient Data
     └─ patientFName: Zelia
     └─ patientLName: Correia
     └─ dob: 12/15/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990978
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 1881923936
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 12 Ruth St, APT 621
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ phoneNumber: (508) 993-0478
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/30/2015', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'I48.91', 'secondDiagnosis': 'M47.9', 'thirdDiagnosis': 'J45.909', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'C90.00', 'sixthDiagnosis': 'D63.0'}]
[06:13:53] 🔄 
🔄 Step 4: Extracting order data...
[06:13:56] ℹ️  Order extraction - MRN: '100990978'
[06:13:56] ℹ️  Order extraction - Sex: 'FEMALE'
[06:13:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:13:56] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:13:56] ✅ Order data extraction completed successfully
[06:13:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:13:56] ℹ️  Using MRN from patient data: '100990978' over '100990978'
[06:13:56] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:13:56] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:13:56] ✅ Patient name cross-validation successful
[06:13:56] ✅    ✅ Data merged successfully
[06:13:57] ✅    ✅ Order data extracted and validated
[06:13:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:14:10] [DOC: 9240215] ✅ Patient exists in API: Zelia Correia, ID: 7999ca12-4950-4bba-adfe-ce558c18086c
[06:14:10] ✅    ✅ Existing patient found with ID: 7999ca12-4950-4bba-adfe-ce558c18086c
[06:14:10] 🔄 
🔄 Step 6: Pushing order to API...
[06:14:10] [DOC: 9240215] ℹ️  Pushing order via API for patient ID: 7999ca12-4950-4bba-adfe-ce558c18086c
[06:14:11] [DOC: 9240215] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12865"}
[06:14:11] ❌    ❌ Failed to push order
[06:14:11] 🔄 
🔄 Step 7: Writing to CSV...
[06:14:11] [DOC: 9240215] ℹ️  Calculated age: 84 from DOB: 12/15/1940
[06:14:11] [DOC: 9240215] ℹ️  Service Line extracted: 'Skilled Nursing'
[06:14:11] [DOC: 9240215] ℹ️  Payer Source extracted: 'Medicare'
[06:14:11] [DOC: 9240215] ℹ️  Diagnosis codes being written:
[06:14:11] [DOC: 9240215] ℹ️    - Latest_Episode_Firstdiagnosis: 'I48.91'
[06:14:11] [DOC: 9240215] ℹ️    - Latest_Episode_Seconddiagnosis: 'M47.9'
[06:14:11] [DOC: 9240215] ℹ️    - Latest_Episode_Thirddiagnosis: 'J45.909'
[06:14:11] [DOC: 9240215] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[06:14:11] [DOC: 9240215] ℹ️    - Latest_Episode_Fifthdiagnosis: 'C90.00'
[06:14:11] [DOC: 9240215] ℹ️    - Latest_Episode_Sixthdiagnosis: 'D63.0'
[06:14:11] [DOC: 9240215] ✅ Patient data written to CSV: Zelia Correia | Sex: FEMALE | Age: 84 | Service: Skilled Nursing | Payer: Medicare | MRN: 100990978
[06:14:11] ✅    ✅ Document 9240215 processed and saved successfully
[06:14:11] 🔄 
🔄 Step 8: Saving API details...
[06:14:11] [DOC: 9240215] ℹ️  API push details saved for document 9240215
[06:14:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240199                         ║
================================================================================
[06:14:11] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:14:11] ℹ️  Date: 04/15/2025
[06:14:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:14:14] [DOC: 9240199] ✅ Text extracted using pdfplumber (10728 chars)
[06:14:14] ✅    ✅ Text extracted using pdfplumber (10728 chars)
[06:14:14] 🔄 
🔄 Step 2: Extracting patient data...
[06:14:17] ℹ️  AI extracted raw sex value: 'F'
[06:14:17] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:14:17] ℹ️  AI extracted payer source: 'Medicare'
[06:14:17] ℹ️  AI extracted diagnoses:
[06:14:17] ℹ️    - Diagnosis 1: 'I48.91'
[06:14:17] ℹ️    - Diagnosis 2: 'M47.9'
[06:14:17] ℹ️    - Diagnosis 3: 'J45.909'
[06:14:17] ℹ️    - Diagnosis 4: 'I10'
[06:14:17] ℹ️    - Diagnosis 5: 'C90.00'
[06:14:17] ℹ️    - Diagnosis 6: 'D63.0'
[06:14:17] ℹ️  Final extracted MRN: '100990978'
[06:14:17] ℹ️  Final extracted Sex: 'FEMALE'
[06:14:17] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:14:17] ℹ️  Final extracted Payer Source: 'Medicare'
[06:14:17] ✅ Patient data extraction completed successfully
[06:14:17] ✅    ✅ Patient data extracted successfully
[06:14:17] 📊 Patient Response
     └─ patientFName: Zelia
     └─ patientLName: Correia
     └─ dob: 12/15/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990978
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 1881923936
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 12 Ruth St, APT 621
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: None
     └─ phoneNumber: (508) 993-0478
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/30/2015', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'I48.91', 'secondDiagnosis': 'M47.9', 'thirdDiagnosis': 'J45.909', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'C90.00', 'sixthDiagnosis': 'D63.0'}]
[06:14:17] ✅    ✅ Patient identified: Zelia Correia
[06:14:17] ✅    ✅ Patient name validation passed
[06:14:17] 🔄 
🔄 Step 3: Processing patient dates...
[06:14:17] [DOC: 9240199] ℹ️  DOB normalized: 12/15/1940
[06:14:17] [DOC: 9240199] ℹ️  Episode startOfCare normalized: 05/30/2015
[06:14:17] [DOC: 9240199] ℹ️  Episode startOfEpisode normalized: 04/07/2025
[06:14:17] [DOC: 9240199] ℹ️  Episode endOfEpisode normalized: 06/05/2025
[06:14:17] [DOC: 9240199] ✅ Patient date processing completed successfully
[06:14:17] ✅    ✅ Date processing completed
[06:14:17] 📊 Processed Patient Data
     └─ patientFName: Zelia
     └─ patientLName: Correia
     └─ dob: 12/15/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990978
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 1881923936
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 12 Ruth St, APT 621
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ phoneNumber: (508) 993-0478
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/30/2015', 'startOfEpisode': '04/07/2025', 'endOfEpisode': '06/05/2025', 'firstDiagnosis': 'I48.91', 'secondDiagnosis': 'M47.9', 'thirdDiagnosis': 'J45.909', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'C90.00', 'sixthDiagnosis': 'D63.0'}]
[06:14:17] 🔄 
🔄 Step 4: Extracting order data...
[06:14:20] ℹ️  Order extraction - MRN: '100990978'
[06:14:20] ℹ️  Order extraction - Sex: 'FEMALE'
[06:14:20] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:14:20] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:14:20] ✅ Order data extraction completed successfully
[06:14:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:14:20] ℹ️  Using MRN from patient data: '100990978' over '100990978'
[06:14:20] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:14:20] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:14:20] ✅ Patient name cross-validation successful
[06:14:20] ✅    ✅ Data merged successfully
[06:14:21] ✅    ✅ Order data extracted and validated
[06:14:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:14:21] [DOC: 9240199] ✅ Patient found in local cache: Zelia Correia, ID: 7999ca12-4950-4bba-adfe-ce558c18086c
[06:14:21] ✅    ✅ Existing patient found with ID: 7999ca12-4950-4bba-adfe-ce558c18086c
[06:14:21] 🔄 
🔄 Step 6: Pushing order to API...
[06:14:21] [DOC: 9240199] ℹ️  Pushing order via API for patient ID: 7999ca12-4950-4bba-adfe-ce558c18086c
[06:14:22] [DOC: 9240199] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12865"}
[06:14:22] ❌    ❌ Failed to push order
[06:14:22] 🔄 
🔄 Step 7: Writing to CSV...
[06:14:22] [DOC: 9240199] ℹ️  Calculated age: 84 from DOB: 12/15/1940
[06:14:22] [DOC: 9240199] ℹ️  Service Line extracted: 'Skilled Nursing'
[06:14:22] [DOC: 9240199] ℹ️  Payer Source extracted: 'Medicare'
[06:14:22] [DOC: 9240199] ℹ️  Diagnosis codes being written:
[06:14:22] [DOC: 9240199] ℹ️    - Latest_Episode_Firstdiagnosis: 'I48.91'
[06:14:22] [DOC: 9240199] ℹ️    - Latest_Episode_Seconddiagnosis: 'M47.9'
[06:14:22] [DOC: 9240199] ℹ️    - Latest_Episode_Thirddiagnosis: 'J45.909'
[06:14:22] [DOC: 9240199] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[06:14:22] [DOC: 9240199] ℹ️    - Latest_Episode_Fifthdiagnosis: 'C90.00'
[06:14:22] [DOC: 9240199] ℹ️    - Latest_Episode_Sixthdiagnosis: 'D63.0'
[06:14:22] [DOC: 9240199] ✅ Patient data written to CSV: Zelia Correia | Sex: FEMALE | Age: 84 | Service: Skilled Nursing | Payer: Medicare | MRN: 100990978
[06:14:22] ✅    ✅ Document 9240199 processed and saved successfully
[06:14:22] 🔄 
🔄 Step 8: Saving API details...
[06:14:22] [DOC: 9240199] ℹ️  API push details saved for document 9240199
[06:14:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240193                         ║
================================================================================
[06:14:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:14:22] ℹ️  Date: 04/15/2025
[06:14:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:14:25] [DOC: 9240193] ✅ Text extracted using pdfplumber (1289 chars)
[06:14:25] ✅    ✅ Text extracted using pdfplumber (1289 chars)
[06:14:25] 🔄 
🔄 Step 2: Extracting patient data...
[06:14:28] ℹ️  AI extracted raw sex value: ''
[06:14:28] ℹ️  AI extracted service line: 'LPN'
[06:14:28] ℹ️  AI extracted payer source: ''
[06:14:28] ℹ️  AI extracted diagnoses:
[06:14:28] ℹ️    - Diagnosis 1: 'J44.1'
[06:14:28] ℹ️    - Diagnosis 2: 'R78.81'
[06:14:28] ℹ️    - Diagnosis 3: 'B95.61'
[06:14:28] ℹ️    - Diagnosis 4: ''
[06:14:28] ℹ️    - Diagnosis 5: ''
[06:14:28] ℹ️    - Diagnosis 6: ''
[06:14:28] ℹ️  Final extracted MRN: 'MA230518053704'
[06:14:28] ℹ️  Final extracted Sex: ''
[06:14:28] ℹ️  Final extracted Service Line: 'LPN'
[06:14:28] ℹ️  Final extracted Payer Source: ''
[06:14:28] ✅ Patient data extraction completed successfully
[06:14:28] ✅    ✅ Patient data extracted successfully
[06:14:28] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Garcia
     └─ dob: 05/06/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230518053704
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'R78.81', 'thirdDiagnosis': 'B95.61', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:14:28] ✅    ✅ Patient identified: Maria Garcia
[06:14:28] ✅    ✅ Patient name validation passed
[06:14:28] 🔄 
🔄 Step 3: Processing patient dates...
[06:14:28] [DOC: 9240193] ℹ️  DOB normalized: 05/06/1937
[06:14:28] [DOC: 9240193] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[06:14:28] [DOC: 9240193] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[06:14:28] [DOC: 9240193] ✅ Patient date processing completed successfully
[06:14:28] ✅    ✅ Date processing completed
[06:14:28] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Garcia
     └─ dob: 05/06/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230518053704
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'R78.81', 'thirdDiagnosis': 'B95.61', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:14:28] 🔄 
🔄 Step 4: Extracting order data...
[06:14:31] ℹ️  Order extraction - MRN: 'MA230518053704'
[06:14:31] ℹ️  Order extraction - Sex: ''
[06:14:31] ℹ️  Order extraction - Service Line: 'Nursing'
[06:14:31] ℹ️  Order extraction - Payer Source: ''
[06:14:31] ✅ Order data extraction completed successfully
[06:14:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:14:31] ℹ️  Using MRN from patient data: 'MA230518053704' over 'MA230518053704'
[06:14:31] ℹ️  Inferred sex as FEMALE from name: Maria
[06:14:31] ℹ️  Combined service lines: Patient='LPN' + Order='Nursing' = 'LPN, Nursing'
[06:14:31] ✅ Patient name cross-validation successful
[06:14:31] ✅    ✅ Data merged successfully
[06:14:32] ✅    ✅ Order data extracted and validated
[06:14:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:14:38] [DOC: 9240193] ✅ Patient exists in API: Maria Garcia, ID: 07175c81-f777-4ef0-aadb-6b2ffc732b95
[06:14:38] ✅    ✅ Existing patient found with ID: 07175c81-f777-4ef0-aadb-6b2ffc732b95
[06:14:38] 🔄 
🔄 Step 6: Pushing order to API...
[06:14:38] [DOC: 9240193] ℹ️  Pushing order via API for patient ID: 07175c81-f777-4ef0-aadb-6b2ffc732b95
[06:14:40] [DOC: 9240193] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13766"}
[06:14:40] ❌    ❌ Failed to push order
[06:14:40] 🔄 
🔄 Step 7: Writing to CSV...
[06:14:40] [DOC: 9240193] ℹ️  Calculated age: 88 from DOB: 05/06/1937
[06:14:40] [DOC: 9240193] ℹ️  Service Line extracted: 'LPN, Nursing'
[06:14:40] [DOC: 9240193] ℹ️  Payer Source extracted: ''
[06:14:40] [DOC: 9240193] ℹ️  Diagnosis codes being written:
[06:14:40] [DOC: 9240193] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[06:14:40] [DOC: 9240193] ℹ️    - Latest_Episode_Seconddiagnosis: 'R78.81'
[06:14:40] [DOC: 9240193] ℹ️    - Latest_Episode_Thirddiagnosis: 'B95.61'
[06:14:40] [DOC: 9240193] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:14:40] [DOC: 9240193] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:14:40] [DOC: 9240193] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:14:40] [DOC: 9240193] ✅ Patient data written to CSV: Maria Garcia | Sex: FEMALE | Age: 88 | Service: LPN, Nursing | Payer:  | MRN: MA230518053704
[06:14:40] ✅    ✅ Document 9240193 processed and saved successfully
[06:14:40] 🔄 
🔄 Step 8: Saving API details...
[06:14:40] [DOC: 9240193] ℹ️  API push details saved for document 9240193
[06:14:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240190                         ║
================================================================================
[06:14:40] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:14:40] ℹ️  Date: 04/15/2025
[06:14:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:14:42] [DOC: 9240190] ✅ Text extracted using pdfplumber (1284 chars)
[06:14:42] ✅    ✅ Text extracted using pdfplumber (1284 chars)
[06:14:42] 🔄 
🔄 Step 2: Extracting patient data...
[06:14:45] ℹ️  AI extracted raw sex value: ''
[06:14:45] ℹ️  AI extracted service line: 'Skilled Nursing, LPN'
[06:14:45] ℹ️  AI extracted payer source: ''
[06:14:45] ℹ️  AI extracted diagnoses:
[06:14:45] ℹ️    - Diagnosis 1: 'J44.1'
[06:14:45] ℹ️    - Diagnosis 2: 'R78.81'
[06:14:45] ℹ️    - Diagnosis 3: 'B95.61'
[06:14:45] ℹ️    - Diagnosis 4: ''
[06:14:45] ℹ️    - Diagnosis 5: ''
[06:14:45] ℹ️    - Diagnosis 6: ''
[06:14:45] ℹ️  Final extracted MRN: 'MA230518053704'
[06:14:45] ℹ️  Final extracted Sex: ''
[06:14:45] ℹ️  Final extracted Service Line: 'Skilled Nursing, LPN'
[06:14:45] ℹ️  Final extracted Payer Source: ''
[06:14:45] ✅ Patient data extraction completed successfully
[06:14:45] ✅    ✅ Patient data extracted successfully
[06:14:45] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Garcia
     └─ dob: 05/06/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230518053704
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'R78.81', 'thirdDiagnosis': 'B95.61', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:14:45] ✅    ✅ Patient identified: Maria Garcia
[06:14:45] ✅    ✅ Patient name validation passed
[06:14:45] 🔄 
🔄 Step 3: Processing patient dates...
[06:14:45] [DOC: 9240190] ℹ️  DOB normalized: 05/06/1937
[06:14:45] [DOC: 9240190] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[06:14:45] [DOC: 9240190] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[06:14:45] [DOC: 9240190] ✅ Patient date processing completed successfully
[06:14:45] ✅    ✅ Date processing completed
[06:14:45] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Garcia
     └─ dob: 05/06/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA230518053704
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'R78.81', 'thirdDiagnosis': 'B95.61', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:14:45] 🔄 
🔄 Step 4: Extracting order data...
[06:14:47] ℹ️  Order extraction - MRN: 'MA230518053704'
[06:14:47] ℹ️  Order extraction - Sex: ''
[06:14:47] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:14:47] ℹ️  Order extraction - Payer Source: ''
[06:14:47] ✅ Order data extraction completed successfully
[06:14:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:14:47] ℹ️  Using MRN from patient data: 'MA230518053704' over 'MA230518053704'
[06:14:47] ℹ️  Inferred sex as FEMALE from name: Maria
[06:14:47] ℹ️  Combined service lines: Patient='Skilled Nursing, LPN' + Order='Skilled Nursing' = 'LPN, Skilled Nursing'
[06:14:47] ✅ Patient name cross-validation successful
[06:14:47] ✅    ✅ Data merged successfully
[06:14:49] ✅    ✅ Order data extracted and validated
[06:14:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:14:49] [DOC: 9240190] ✅ Patient found in local cache: Maria Garcia, ID: 07175c81-f777-4ef0-aadb-6b2ffc732b95
[06:14:49] ✅    ✅ Existing patient found with ID: 07175c81-f777-4ef0-aadb-6b2ffc732b95
[06:14:49] 🔄 
🔄 Step 6: Pushing order to API...
[06:14:49] [DOC: 9240190] ℹ️  Pushing order via API for patient ID: 07175c81-f777-4ef0-aadb-6b2ffc732b95
[06:14:50] [DOC: 9240190] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13767"}
[06:14:50] ❌    ❌ Failed to push order
[06:14:50] 🔄 
🔄 Step 7: Writing to CSV...
[06:14:50] [DOC: 9240190] ℹ️  Calculated age: 88 from DOB: 05/06/1937
[06:14:50] [DOC: 9240190] ℹ️  Service Line extracted: 'LPN, Skilled Nursing'
[06:14:50] [DOC: 9240190] ℹ️  Payer Source extracted: ''
[06:14:50] [DOC: 9240190] ℹ️  Diagnosis codes being written:
[06:14:50] [DOC: 9240190] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[06:14:50] [DOC: 9240190] ℹ️    - Latest_Episode_Seconddiagnosis: 'R78.81'
[06:14:50] [DOC: 9240190] ℹ️    - Latest_Episode_Thirddiagnosis: 'B95.61'
[06:14:50] [DOC: 9240190] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:14:50] [DOC: 9240190] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:14:50] [DOC: 9240190] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:14:50] [DOC: 9240190] ✅ Patient data written to CSV: Maria Garcia | Sex: FEMALE | Age: 88 | Service: LPN, Skilled Nursing | Payer:  | MRN: MA230518053704
[06:14:50] ✅    ✅ Document 9240190 processed and saved successfully
[06:14:50] 🔄 
🔄 Step 8: Saving API details...
[06:14:50] [DOC: 9240190] ℹ️  API push details saved for document 9240190
[06:14:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240179                         ║
================================================================================
[06:14:50] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:14:50] ℹ️  Date: 04/15/2025
[06:14:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:14:52] [DOC: 9240179] ✅ Text extracted using pdfplumber (1705 chars)
[06:14:52] ✅    ✅ Text extracted using pdfplumber (1705 chars)
[06:14:52] 🔄 
🔄 Step 2: Extracting patient data...
[06:14:55] ℹ️  AI extracted raw sex value: ''
[06:14:55] ℹ️  AI extracted service line: 'Physical Therapy'
[06:14:55] ℹ️  AI extracted payer source: ''
[06:14:55] ℹ️  AI extracted diagnoses:
[06:14:55] ℹ️    - Diagnosis 1: 'J10.00'
[06:14:55] ℹ️    - Diagnosis 2: 'J44.0'
[06:14:55] ℹ️    - Diagnosis 3: 'J44.1'
[06:14:55] ℹ️    - Diagnosis 4: ''
[06:14:55] ℹ️    - Diagnosis 5: ''
[06:14:55] ℹ️    - Diagnosis 6: ''
[06:14:55] ℹ️  Final extracted MRN: '100999559'
[06:14:55] ℹ️  Final extracted Sex: ''
[06:14:55] ℹ️  Final extracted Service Line: 'Physical Therapy'
[06:14:55] ℹ️  Final extracted Payer Source: ''
[06:14:55] ✅ Patient data extraction completed successfully
[06:14:55] ✅    ✅ Patient data extracted successfully
[06:14:55] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Rodgers
     └─ dob: 05/10/1942
     └─ patientSex: 
     └─ medicalRecordNo: 100999559
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'J44.0', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:14:55] ✅    ✅ Patient identified: Joseph Rodgers
[06:14:55] ✅    ✅ Patient name validation passed
[06:14:55] 🔄 
🔄 Step 3: Processing patient dates...
[06:14:55] [DOC: 9240179] ℹ️  DOB normalized: 05/10/1942
[06:14:55] [DOC: 9240179] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[06:14:55] [DOC: 9240179] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[06:14:55] [DOC: 9240179] ✅ Patient date processing completed successfully
[06:14:55] ✅    ✅ Date processing completed
[06:14:55] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Rodgers
     └─ dob: 05/10/1942
     └─ patientSex: 
     └─ medicalRecordNo: 100999559
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'J44.0', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:14:55] 🔄 
🔄 Step 4: Extracting order data...
[06:14:58] ℹ️  Order extraction - MRN: '100999559'
[06:14:58] ℹ️  Order extraction - Sex: ''
[06:14:58] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[06:14:58] ℹ️  Order extraction - Payer Source: ''
[06:14:58] ✅ Order data extraction completed successfully
[06:14:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:14:58] ℹ️  Using MRN from patient data: '100999559' over '100999559'
[06:14:58] ℹ️  Inferred sex as MALE from name: Joseph
[06:14:58] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[06:14:58] ✅ Patient name cross-validation successful
[06:14:58] ✅    ✅ Data merged successfully
[06:14:59] ✅    ✅ Order data extracted and validated
[06:14:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:14:59] [DOC: 9240179] ✅ Patient found in local cache: Joseph Rodgers, ID: 87b0a0db-64d7-4566-948a-610acf84958a
[06:14:59] ✅    ✅ Existing patient found with ID: 87b0a0db-64d7-4566-948a-610acf84958a
[06:14:59] 🔄 
🔄 Step 6: Pushing order to API...
[06:14:59] [DOC: 9240179] ℹ️  Pushing order via API for patient ID: 87b0a0db-64d7-4566-948a-610acf84958a
[06:15:00] [DOC: 9240179] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14272"}
[06:15:00] ❌    ❌ Failed to push order
[06:15:00] 🔄 
🔄 Step 7: Writing to CSV...
[06:15:00] [DOC: 9240179] ℹ️  Calculated age: 83 from DOB: 05/10/1942
[06:15:00] [DOC: 9240179] ℹ️  Service Line extracted: 'Physical Therapy'
[06:15:00] [DOC: 9240179] ℹ️  Payer Source extracted: ''
[06:15:00] [DOC: 9240179] ℹ️  Diagnosis codes being written:
[06:15:00] [DOC: 9240179] ℹ️    - Latest_Episode_Firstdiagnosis: 'J10.00'
[06:15:00] [DOC: 9240179] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.0'
[06:15:00] [DOC: 9240179] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.1'
[06:15:00] [DOC: 9240179] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:15:00] [DOC: 9240179] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:15:00] [DOC: 9240179] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:15:00] [DOC: 9240179] ✅ Patient data written to CSV: Joseph Rodgers | Sex: MALE | Age: 83 | Service: Physical Therapy | Payer:  | MRN: 100999559
[06:15:00] ✅    ✅ Document 9240179 processed and saved successfully
[06:15:00] 🔄 
🔄 Step 8: Saving API details...
[06:15:00] [DOC: 9240179] ℹ️  API push details saved for document 9240179
[06:15:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240176                         ║
================================================================================
[06:15:00] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:15:00] ℹ️  Date: 04/15/2025
[06:15:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:15:13] [DOC: 9240176] ✅ Text extracted using pdfplumber (14356 chars)
[06:15:13] ✅    ✅ Text extracted using pdfplumber (14356 chars)
[06:15:13] 🔄 
🔄 Step 2: Extracting patient data...
[06:15:16] ℹ️  AI extracted raw sex value: ''
[06:15:16] ℹ️  AI extracted service line: 'PT'
[06:15:16] ℹ️  AI extracted payer source: ''
[06:15:16] ℹ️  AI extracted diagnoses:
[06:15:16] ℹ️    - Diagnosis 1: 'Flu due to oth ident flu virus w unsp type of pneumonia'
[06:15:16] ℹ️    - Diagnosis 2: 'Unsteadiness on feet'
[06:15:16] ℹ️    - Diagnosis 3: 'Chronic obstructive pulmonary disease w (acute) exacerbation'
[06:15:16] ℹ️    - Diagnosis 4: 'Legal blindness'
[06:15:16] ℹ️    - Diagnosis 5: 'Unspecified atrial fibrillation'
[06:15:16] ℹ️    - Diagnosis 6: 'Cerebral infarction, unspecified'
[06:15:16] ℹ️  Final extracted MRN: '100999559'
[06:15:16] ℹ️  Final extracted Sex: ''
[06:15:16] ℹ️  Final extracted Service Line: 'PT'
[06:15:16] ℹ️  Final extracted Payer Source: ''
[06:15:16] ✅ Patient data extraction completed successfully
[06:15:16] ✅    ✅ Patient data extracted successfully
[06:15:16] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Rodgers
     └─ dob: 05/10/1942
     └─ patientSex: 
     └─ medicalRecordNo: 100999559
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/02/2025', 'endOfEpisode': None, 'firstDiagnosis': 'Flu due to oth ident flu virus w unsp type of pneumonia', 'secondDiagnosis': 'Unsteadiness on feet', 'thirdDiagnosis': 'Chronic obstructive pulmonary disease w (acute) exacerbation', 'fourthDiagnosis': 'Legal blindness', 'fifthDiagnosis': 'Unspecified atrial fibrillation', 'sixthDiagnosis': 'Cerebral infarction, unspecified'}]
[06:15:16] ✅    ✅ Patient identified: Joseph Rodgers
[06:15:16] ✅    ✅ Patient name validation passed
[06:15:16] 🔄 
🔄 Step 3: Processing patient dates...
[06:15:16] [DOC: 9240176] ℹ️  DOB normalized: 05/10/1942
[06:15:16] [DOC: 9240176] ℹ️  Episode startOfEpisode normalized: 02/02/2025
[06:15:16] [DOC: 9240176] ✅ Patient date processing completed successfully
[06:15:16] ✅    ✅ Date processing completed
[06:15:16] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Rodgers
     └─ dob: 05/10/1942
     └─ patientSex: 
     └─ medicalRecordNo: 100999559
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/02/2025', 'firstDiagnosis': 'Flu due to oth ident flu virus w unsp type of pneumonia', 'secondDiagnosis': 'Unsteadiness on feet', 'thirdDiagnosis': 'Chronic obstructive pulmonary disease w (acute) exacerbation', 'fourthDiagnosis': 'Legal blindness', 'fifthDiagnosis': 'Unspecified atrial fibrillation', 'sixthDiagnosis': 'Cerebral infarction, unspecified'}]
[06:15:16] 🔄 
🔄 Step 4: Extracting order data...
[06:15:19] ℹ️  Order extraction - MRN: '100999559'
[06:15:19] ℹ️  Order extraction - Sex: 'MALE'
[06:15:19] ℹ️  Order extraction - Service Line: 'PT'
[06:15:19] ℹ️  Order extraction - Payer Source: ''
[06:15:19] ✅ Order data extraction completed successfully
[06:15:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:15:19] ℹ️  Using MRN from patient data: '100999559' over '100999559'
[06:15:19] ℹ️  Service line consistent in both sources: 'PT'
[06:15:19] ✅ Patient name cross-validation successful
[06:15:19] ✅    ✅ Data merged successfully
[06:15:20] ✅    ✅ Order data extracted and validated
[06:15:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:15:20] [DOC: 9240176] ✅ Patient found in local cache: Joseph Rodgers, ID: 87b0a0db-64d7-4566-948a-610acf84958a
[06:15:20] ✅    ✅ Existing patient found with ID: 87b0a0db-64d7-4566-948a-610acf84958a
[06:15:20] 🔄 
🔄 Step 6: Pushing order to API...
[06:15:20] [DOC: 9240176] ℹ️  Pushing order via API for patient ID: 87b0a0db-64d7-4566-948a-610acf84958a
[06:15:21] [DOC: 9240176] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:15:21] ❌    ❌ Failed to push order
[06:15:21] 🔄 
🔄 Step 7: Writing to CSV...
[06:15:21] [DOC: 9240176] ℹ️  Calculated age: 83 from DOB: 05/10/1942
[06:15:21] [DOC: 9240176] ℹ️  Service Line extracted: 'PT'
[06:15:21] [DOC: 9240176] ℹ️  Payer Source extracted: ''
[06:15:21] [DOC: 9240176] ℹ️  Diagnosis codes being written:
[06:15:21] [DOC: 9240176] ℹ️    - Latest_Episode_Firstdiagnosis: 'Flu due to oth ident flu virus w unsp type of pneumonia'
[06:15:21] [DOC: 9240176] ℹ️    - Latest_Episode_Seconddiagnosis: 'Unsteadiness on feet'
[06:15:21] [DOC: 9240176] ℹ️    - Latest_Episode_Thirddiagnosis: 'Chronic obstructive pulmonary disease w (acute) exacerbation'
[06:15:21] [DOC: 9240176] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Legal blindness'
[06:15:21] [DOC: 9240176] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Unspecified atrial fibrillation'
[06:15:21] [DOC: 9240176] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Cerebral infarction, unspecified'
[06:15:21] [DOC: 9240176] ✅ Patient data written to CSV: Joseph Rodgers | Sex: MALE | Age: 83 | Service: PT | Payer:  | MRN: 100999559
[06:15:21] ✅    ✅ Document 9240176 processed and saved successfully
[06:15:21] 🔄 
🔄 Step 8: Saving API details...
[06:15:21] [DOC: 9240176] ℹ️  API push details saved for document 9240176
[06:15:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240175                         ║
================================================================================
[06:15:21] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:15:21] ℹ️  Date: 04/15/2025
[06:15:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:15:25] [DOC: 9240175] ✅ Text extracted using pdfplumber (1622 chars)
[06:15:25] ✅    ✅ Text extracted using pdfplumber (1622 chars)
[06:15:25] 🔄 
🔄 Step 2: Extracting patient data...
[06:15:28] ℹ️  AI extracted raw sex value: ''
[06:15:28] ℹ️  AI extracted service line: 'Physical Therapy'
[06:15:28] ℹ️  AI extracted payer source: ''
[06:15:28] ℹ️  AI extracted diagnoses:
[06:15:28] ℹ️    - Diagnosis 1: 'J10.00'
[06:15:28] ℹ️    - Diagnosis 2: 'J44.0'
[06:15:28] ℹ️    - Diagnosis 3: 'J44.1'
[06:15:28] ℹ️    - Diagnosis 4: 'None'
[06:15:28] ℹ️    - Diagnosis 5: 'None'
[06:15:28] ℹ️    - Diagnosis 6: 'None'
[06:15:28] ℹ️  Final extracted MRN: '100999559'
[06:15:28] ℹ️  Final extracted Sex: ''
[06:15:28] ℹ️  Final extracted Service Line: 'Physical Therapy'
[06:15:28] ℹ️  Final extracted Payer Source: ''
[06:15:28] ✅ Patient data extraction completed successfully
[06:15:28] ✅    ✅ Patient data extracted successfully
[06:15:28] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Rodgers
     └─ dob: 05/10/1942
     └─ patientSex: 
     └─ medicalRecordNo: 100999559
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'J44.0', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:15:28] ✅    ✅ Patient identified: Joseph Rodgers
[06:15:28] ✅    ✅ Patient name validation passed
[06:15:28] 🔄 
🔄 Step 3: Processing patient dates...
[06:15:28] [DOC: 9240175] ℹ️  DOB normalized: 05/10/1942
[06:15:28] [DOC: 9240175] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[06:15:28] [DOC: 9240175] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[06:15:28] [DOC: 9240175] ✅ Patient date processing completed successfully
[06:15:28] ✅    ✅ Date processing completed
[06:15:28] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Rodgers
     └─ dob: 05/10/1942
     └─ patientSex: 
     └─ medicalRecordNo: 100999559
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'J44.0', 'thirdDiagnosis': 'J44.1'}]
[06:15:28] 🔄 
🔄 Step 4: Extracting order data...
[06:15:31] ℹ️  Order extraction - MRN: '100999559'
[06:15:31] ℹ️  Order extraction - Sex: ''
[06:15:31] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[06:15:31] ℹ️  Order extraction - Payer Source: ''
[06:15:31] ✅ Order data extraction completed successfully
[06:15:31] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:15:31] ℹ️  Using MRN from patient data: '100999559' over '100999559'
[06:15:31] ℹ️  Inferred sex as MALE from name: Joseph
[06:15:31] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[06:15:31] ✅ Patient name cross-validation successful
[06:15:31] ✅    ✅ Data merged successfully
[06:15:32] ✅    ✅ Order data extracted and validated
[06:15:32] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:15:32] [DOC: 9240175] ✅ Patient found in local cache: Joseph Rodgers, ID: 87b0a0db-64d7-4566-948a-610acf84958a
[06:15:32] ✅    ✅ Existing patient found with ID: 87b0a0db-64d7-4566-948a-610acf84958a
[06:15:32] 🔄 
🔄 Step 6: Pushing order to API...
[06:15:32] [DOC: 9240175] ℹ️  Pushing order via API for patient ID: 87b0a0db-64d7-4566-948a-610acf84958a
[06:15:33] [DOC: 9240175] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14273"}
[06:15:33] ❌    ❌ Failed to push order
[06:15:33] 🔄 
🔄 Step 7: Writing to CSV...
[06:15:33] [DOC: 9240175] ℹ️  Calculated age: 83 from DOB: 05/10/1942
[06:15:33] [DOC: 9240175] ℹ️  Service Line extracted: 'Physical Therapy'
[06:15:33] [DOC: 9240175] ℹ️  Payer Source extracted: ''
[06:15:33] [DOC: 9240175] ℹ️  Diagnosis codes being written:
[06:15:33] [DOC: 9240175] ℹ️    - Latest_Episode_Firstdiagnosis: 'J10.00'
[06:15:33] [DOC: 9240175] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.0'
[06:15:33] [DOC: 9240175] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.1'
[06:15:33] [DOC: 9240175] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:15:33] [DOC: 9240175] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:15:33] [DOC: 9240175] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:15:33] [DOC: 9240175] ✅ Patient data written to CSV: Joseph Rodgers | Sex: MALE | Age: 83 | Service: Physical Therapy | Payer:  | MRN: 100999559
[06:15:33] ✅    ✅ Document 9240175 processed and saved successfully
[06:15:33] 🔄 
🔄 Step 8: Saving API details...
[06:15:33] [DOC: 9240175] ℹ️  API push details saved for document 9240175
[06:15:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240172                         ║
================================================================================
[06:15:33] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:15:33] ℹ️  Date: 04/15/2025
[06:15:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:15:36] [DOC: 9240172] ✅ Text extracted using pdfplumber (16575 chars)
[06:15:36] ✅    ✅ Text extracted using pdfplumber (16575 chars)
[06:15:36] 🔄 
🔄 Step 2: Extracting patient data...
[06:15:40] ℹ️  AI extracted raw sex value: 'M'
[06:15:40] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[06:15:40] ℹ️  AI extracted payer source: 'Medicare'
[06:15:40] ℹ️  AI extracted diagnoses:
[06:15:40] ℹ️    - Diagnosis 1: 'J10.00'
[06:15:40] ℹ️    - Diagnosis 2: 'J44.0'
[06:15:40] ℹ️    - Diagnosis 3: 'J44.1'
[06:15:40] ℹ️    - Diagnosis 4: 'J96.21'
[06:15:40] ℹ️    - Diagnosis 5: 'C34.10'
[06:15:40] ℹ️    - Diagnosis 6: 'I25.5'
[06:15:40] ℹ️  Final extracted MRN: '100999559'
[06:15:40] ℹ️  Final extracted Sex: 'MALE'
[06:15:40] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[06:15:40] ℹ️  Final extracted Payer Source: 'Medicare'
[06:15:40] ✅ Patient data extraction completed successfully
[06:15:40] ✅    ✅ Patient data extracted successfully
[06:15:40] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Rodgers
     └─ dob: 05/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 100999559
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 1881923936
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 1040 Cove Rd, APT 4
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: None
     └─ phoneNumber: (774) 206-6316
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/21/2023', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'J44.0', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': 'J96.21', 'fifthDiagnosis': 'C34.10', 'sixthDiagnosis': 'I25.5'}]
[06:15:40] ✅    ✅ Patient identified: Joseph Rodgers
[06:15:40] ✅    ✅ Patient name validation passed
[06:15:40] 🔄 
🔄 Step 3: Processing patient dates...
[06:15:40] [DOC: 9240172] ℹ️  DOB normalized: 05/10/1942
[06:15:40] [DOC: 9240172] ℹ️  Episode startOfCare normalized: 06/21/2023
[06:15:40] [DOC: 9240172] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[06:15:40] [DOC: 9240172] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[06:15:40] [DOC: 9240172] ✅ Patient date processing completed successfully
[06:15:40] ✅    ✅ Date processing completed
[06:15:40] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Rodgers
     └─ dob: 05/10/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 100999559
     └─ billingProvider: Dr. Jauregui, Hugo G.
     └─ npi: 1881923936
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 1040 Cove Rd, APT 4
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ phoneNumber: (774) 206-6316
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/21/2023', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'J44.0', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': 'J96.21', 'fifthDiagnosis': 'C34.10', 'sixthDiagnosis': 'I25.5'}]
[06:15:40] 🔄 
🔄 Step 4: Extracting order data...
[06:15:42] ℹ️  Order extraction - MRN: '100999559'
[06:15:42] ℹ️  Order extraction - Sex: 'MALE'
[06:15:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[06:15:42] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:15:42] ✅ Order data extraction completed successfully
[06:15:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:15:42] ℹ️  Using MRN from patient data: '100999559' over '100999559'
[06:15:42] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[06:15:42] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:15:42] ✅ Patient name cross-validation successful
[06:15:42] ✅    ✅ Data merged successfully
[06:15:44] ✅    ✅ Order data extracted and validated
[06:15:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:15:44] [DOC: 9240172] ✅ Patient found in local cache: Joseph Rodgers, ID: 87b0a0db-64d7-4566-948a-610acf84958a
[06:15:44] ✅    ✅ Existing patient found with ID: 87b0a0db-64d7-4566-948a-610acf84958a
[06:15:44] 🔄 
🔄 Step 6: Pushing order to API...
[06:15:44] [DOC: 9240172] ℹ️  Pushing order via API for patient ID: 87b0a0db-64d7-4566-948a-610acf84958a
[06:15:45] [DOC: 9240172] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14274"}
[06:15:45] ❌    ❌ Failed to push order
[06:15:45] 🔄 
🔄 Step 7: Writing to CSV...
[06:15:45] [DOC: 9240172] ℹ️  Calculated age: 83 from DOB: 05/10/1942
[06:15:45] [DOC: 9240172] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[06:15:45] [DOC: 9240172] ℹ️  Payer Source extracted: 'Medicare'
[06:15:45] [DOC: 9240172] ℹ️  Diagnosis codes being written:
[06:15:45] [DOC: 9240172] ℹ️    - Latest_Episode_Firstdiagnosis: 'J10.00'
[06:15:45] [DOC: 9240172] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.0'
[06:15:45] [DOC: 9240172] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.1'
[06:15:45] [DOC: 9240172] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J96.21'
[06:15:45] [DOC: 9240172] ℹ️    - Latest_Episode_Fifthdiagnosis: 'C34.10'
[06:15:45] [DOC: 9240172] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I25.5'
[06:15:45] [DOC: 9240172] ✅ Patient data written to CSV: Joseph Rodgers | Sex: MALE | Age: 83 | Service: Skilled Nursing, Physical Therapy | Payer: Medicare | MRN: 100999559
[06:15:45] ✅    ✅ Document 9240172 processed and saved successfully
[06:15:45] 🔄 
🔄 Step 8: Saving API details...
[06:15:45] [DOC: 9240172] ℹ️  API push details saved for document 9240172
[06:15:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240168                         ║
================================================================================
[06:15:45] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:15:45] ℹ️  Date: 04/15/2025
[06:15:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:15:49] [DOC: 9240168] ✅ Text extracted using pdfplumber (2556 chars)
[06:15:49] ✅    ✅ Text extracted using pdfplumber (2556 chars)
[06:15:49] 🔄 
🔄 Step 2: Extracting patient data...
[06:15:52] ℹ️  AI extracted raw sex value: ''
[06:15:52] ℹ️  AI extracted service line: 'Physical Therapy'
[06:15:52] ℹ️  AI extracted payer source: ''
[06:15:52] ℹ️  AI extracted diagnoses:
[06:15:52] ℹ️    - Diagnosis 1: 'J10.00'
[06:15:52] ℹ️    - Diagnosis 2: 'J44.0'
[06:15:52] ℹ️    - Diagnosis 3: 'J44.1'
[06:15:52] ℹ️    - Diagnosis 4: 'None'
[06:15:52] ℹ️    - Diagnosis 5: 'None'
[06:15:52] ℹ️    - Diagnosis 6: 'None'
[06:15:52] ℹ️  Final extracted MRN: '100999559'
[06:15:52] ℹ️  Final extracted Sex: ''
[06:15:52] ℹ️  Final extracted Service Line: 'Physical Therapy'
[06:15:52] ℹ️  Final extracted Payer Source: ''
[06:15:52] ✅ Patient data extraction completed successfully
[06:15:52] ✅    ✅ Patient data extracted successfully
[06:15:52] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Rodgers
     └─ dob: 05/10/1942
     └─ patientSex: 
     └─ medicalRecordNo: 100999559
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/10/2025', 'endOfEpisode': '04/10/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'J44.0', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:15:52] ✅    ✅ Patient identified: Joseph Rodgers
[06:15:52] ✅    ✅ Patient name validation passed
[06:15:52] 🔄 
🔄 Step 3: Processing patient dates...
[06:15:52] [DOC: 9240168] ℹ️  DOB normalized: 05/10/1942
[06:15:52] [DOC: 9240168] ℹ️  Episode startOfEpisode normalized: 02/10/2025
[06:15:52] [DOC: 9240168] ℹ️  Episode endOfEpisode normalized: 04/10/2025
[06:15:52] [DOC: 9240168] ✅ Patient date processing completed successfully
[06:15:52] ✅    ✅ Date processing completed
[06:15:52] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Rodgers
     └─ dob: 05/10/1942
     └─ patientSex: 
     └─ medicalRecordNo: 100999559
     └─ billingProvider: HUGO JAUREGUI MD
     └─ npi: 1124084611
     └─ physicianNPI: 1124084611
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/10/2025', 'endOfEpisode': '04/10/2025', 'firstDiagnosis': 'J10.00', 'secondDiagnosis': 'J44.0', 'thirdDiagnosis': 'J44.1'}]
[06:15:52] 🔄 
🔄 Step 4: Extracting order data...
[06:15:54] ℹ️  Order extraction - MRN: '100999559'
[06:15:54] ℹ️  Order extraction - Sex: ''
[06:15:54] ℹ️  Order extraction - Service Line: 'PT'
[06:15:54] ℹ️  Order extraction - Payer Source: ''
[06:15:54] ✅ Order data extraction completed successfully
[06:15:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:15:54] ℹ️  Using MRN from patient data: '100999559' over '100999559'
[06:15:54] ℹ️  Inferred sex as MALE from name: Joseph
[06:15:54] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[06:15:54] ✅ Patient name cross-validation successful
[06:15:54] ✅    ✅ Data merged successfully
[06:15:55] ✅    ✅ Order data extracted and validated
[06:15:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:15:55] [DOC: 9240168] ✅ Patient found in local cache: Joseph Rodgers, ID: 87b0a0db-64d7-4566-948a-610acf84958a
[06:15:55] ✅    ✅ Existing patient found with ID: 87b0a0db-64d7-4566-948a-610acf84958a
[06:15:55] 🔄 
🔄 Step 6: Pushing order to API...
[06:15:55] [DOC: 9240168] ℹ️  Pushing order via API for patient ID: 87b0a0db-64d7-4566-948a-610acf84958a
[06:15:57] [DOC: 9240168] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14275"}
[06:15:57] ❌    ❌ Failed to push order
[06:15:57] 🔄 
🔄 Step 7: Writing to CSV...
[06:15:57] [DOC: 9240168] ℹ️  Calculated age: 83 from DOB: 05/10/1942
[06:15:57] [DOC: 9240168] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[06:15:57] [DOC: 9240168] ℹ️  Payer Source extracted: ''
[06:15:57] [DOC: 9240168] ℹ️  Diagnosis codes being written:
[06:15:57] [DOC: 9240168] ℹ️    - Latest_Episode_Firstdiagnosis: 'J10.00'
[06:15:57] [DOC: 9240168] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.0'
[06:15:57] [DOC: 9240168] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.1'
[06:15:57] [DOC: 9240168] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:15:57] [DOC: 9240168] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:15:57] [DOC: 9240168] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:15:57] [DOC: 9240168] ✅ Patient data written to CSV: Joseph Rodgers | Sex: MALE | Age: 83 | Service: PT, Physical Therapy | Payer:  | MRN: 100999559
[06:15:57] ✅    ✅ Document 9240168 processed and saved successfully
[06:15:57] 🔄 
🔄 Step 8: Saving API details...
[06:15:57] [DOC: 9240168] ℹ️  API push details saved for document 9240168
[06:15:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240142                         ║
================================================================================
[06:15:57] ℹ️  Agency: Nizhoni Health-Fall River
[06:15:57] ℹ️  Date: 04/15/2025
[06:15:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:16:05] [DOC: 9240142] ✅ Text extracted using pdfplumber (1610 chars)
[06:16:05] ✅    ✅ Text extracted using pdfplumber (1610 chars)
[06:16:05] 🔄 
🔄 Step 2: Extracting patient data...
[06:16:08] ℹ️  AI extracted raw sex value: 'F'
[06:16:08] ℹ️  AI extracted service line: 'HHA'
[06:16:08] ℹ️  AI extracted payer source: 'Medicaid/MA'
[06:16:08] ℹ️  AI extracted diagnoses:
[06:16:08] ℹ️    - Diagnosis 1: 'None'
[06:16:08] ℹ️    - Diagnosis 2: 'None'
[06:16:08] ℹ️    - Diagnosis 3: 'None'
[06:16:08] ℹ️    - Diagnosis 4: 'None'
[06:16:08] ℹ️    - Diagnosis 5: 'None'
[06:16:08] ℹ️    - Diagnosis 6: 'None'
[06:16:08] ℹ️  Final extracted MRN: '1376012'
[06:16:08] ℹ️  Final extracted Sex: 'FEMALE'
[06:16:08] ℹ️  Final extracted Service Line: 'HHA'
[06:16:08] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[06:16:08] ✅ Patient data extraction completed successfully
[06:16:08] ✅    ✅ Patient data extracted successfully
[06:16:08] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Sanders
     └─ dob: 09/16/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1376012
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 850 Pleasant St Apt 1006
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/25/2021', 'startOfEpisode': None, 'endOfEpisode': '05/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:16:08] ✅    ✅ Patient identified: Patricia Sanders
[06:16:08] ✅    ✅ Patient name validation passed
[06:16:08] 🔄 
🔄 Step 3: Processing patient dates...
[06:16:08] [DOC: 9240142] ℹ️  DOB normalized: 09/16/1960
[06:16:08] [DOC: 9240142] ℹ️  Episode startOfCare normalized: 11/25/2021
[06:16:08] [DOC: 9240142] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[06:16:08] [DOC: 9240142] ✅ Patient date processing completed successfully
[06:16:08] ✅    ✅ Date processing completed
[06:16:08] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Sanders
     └─ dob: 09/16/1960
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1376012
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 850 Pleasant St Apt 1006
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/25/2021', 'endOfEpisode': '05/07/2025'}]
[06:16:08] 🔄 
🔄 Step 4: Extracting order data...
[06:16:10] ℹ️  Order extraction - MRN: '1376012'
[06:16:10] ℹ️  Order extraction - Sex: 'FEMALE'
[06:16:10] ℹ️  Order extraction - Service Line: ''
[06:16:10] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[06:16:10] ✅ Order data extraction completed successfully
[06:16:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:16:10] ℹ️  Using MRN from patient data: '1376012' over '1376012'
[06:16:10] ℹ️  Using service line from patient data: 'HHA'
[06:16:10] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[06:16:10] ✅ Patient name cross-validation successful
[06:16:10] ✅    ✅ Data merged successfully
[06:16:11] ✅    ✅ Order data extracted and validated
[06:16:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:16:19] [DOC: 9240142] ✅ Patient exists in API: Patricia Sanders, ID: b8c2206a-4b0e-48e7-bdf1-2f28933bba0a
[06:16:19] ✅    ✅ Existing patient found with ID: b8c2206a-4b0e-48e7-bdf1-2f28933bba0a
[06:16:19] 🔄 
🔄 Step 6: Pushing order to API...
[06:16:19] [DOC: 9240142] ℹ️  Pushing order via API for patient ID: b8c2206a-4b0e-48e7-bdf1-2f28933bba0a
[06:16:20] [DOC: 9240142] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:16:20] ❌    ❌ Failed to push order
[06:16:20] 🔄 
🔄 Step 7: Writing to CSV...
[06:16:20] [DOC: 9240142] ℹ️  Calculated age: 64 from DOB: 09/16/1960
[06:16:20] [DOC: 9240142] ℹ️  Service Line extracted: 'HHA'
[06:16:20] [DOC: 9240142] ℹ️  Payer Source extracted: 'Medicaid/MA'
[06:16:20] [DOC: 9240142] ℹ️  Diagnosis codes being written:
[06:16:20] [DOC: 9240142] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:16:20] [DOC: 9240142] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:16:20] [DOC: 9240142] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:16:20] [DOC: 9240142] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:16:20] [DOC: 9240142] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:16:20] [DOC: 9240142] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:16:20] [DOC: 9240142] ✅ Patient data written to CSV: Patricia Sanders | Sex: FEMALE | Age: 64 | Service: HHA | Payer: Medicaid/MA | MRN: 1376012
[06:16:20] ✅    ✅ Document 9240142 processed and saved successfully
[06:16:20] 🔄 
🔄 Step 8: Saving API details...
[06:16:20] [DOC: 9240142] ℹ️  API push details saved for document 9240142
[06:16:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240137                         ║
================================================================================
[06:16:20] ℹ️  Agency: Nizhoni Health-Fall River
[06:16:20] ℹ️  Date: 04/15/2025
[06:16:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:16:23] [DOC: 9240137] ✅ Text extracted using pdfplumber (1040 chars)
[06:16:23] ✅    ✅ Text extracted using pdfplumber (1040 chars)
[06:16:23] 🔄 
🔄 Step 2: Extracting patient data...
[06:16:26] ℹ️  AI extracted raw sex value: 'F'
[06:16:26] ℹ️  AI extracted service line: 'HHA'
[06:16:26] ℹ️  AI extracted payer source: 'Medicaid/MA'
[06:16:26] ℹ️  AI extracted diagnoses:
[06:16:26] ℹ️    - Diagnosis 1: ''
[06:16:26] ℹ️    - Diagnosis 2: ''
[06:16:26] ℹ️    - Diagnosis 3: ''
[06:16:26] ℹ️    - Diagnosis 4: ''
[06:16:26] ℹ️    - Diagnosis 5: ''
[06:16:26] ℹ️    - Diagnosis 6: ''
[06:16:26] ℹ️  Final extracted MRN: '14458020'
[06:16:26] ℹ️  Final extracted Sex: 'FEMALE'
[06:16:26] ℹ️  Final extracted Service Line: 'HHA'
[06:16:26] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[06:16:26] ✅ Patient data extraction completed successfully
[06:16:26] ✅    ✅ Patient data extracted successfully
[06:16:26] 📊 Patient Response
     └─ patientFName: Gina
     └─ patientLName: Reich
     └─ dob: 12/30/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 14458020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 28 Harrison Street
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '10/22/2024', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:16:26] ✅    ✅ Patient identified: Gina Reich
[06:16:26] ✅    ✅ Patient name validation passed
[06:16:26] 🔄 
🔄 Step 3: Processing patient dates...
[06:16:26] [DOC: 9240137] ℹ️  DOB normalized: 12/30/1962
[06:16:26] [DOC: 9240137] ℹ️  Episode startOfCare normalized: 10/22/2024
[06:16:26] [DOC: 9240137] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[06:16:26] [DOC: 9240137] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[06:16:26] [DOC: 9240137] ✅ Patient date processing completed successfully
[06:16:26] ✅    ✅ Date processing completed
[06:16:26] 📊 Processed Patient Data
     └─ patientFName: Gina
     └─ patientLName: Reich
     └─ dob: 12/30/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 14458020
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 28 Harrison Street
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '10/22/2024', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:16:26] 🔄 
🔄 Step 4: Extracting order data...
[06:16:28] ℹ️  Order extraction - MRN: '14458020'
[06:16:28] ℹ️  Order extraction - Sex: 'FEMALE'
[06:16:28] ℹ️  Order extraction - Service Line: ''
[06:16:28] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[06:16:28] ✅ Order data extraction completed successfully
[06:16:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:16:28] ℹ️  Using MRN from patient data: '14458020' over '14458020'
[06:16:28] ℹ️  Using service line from patient data: 'HHA'
[06:16:28] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[06:16:28] ✅ Patient name cross-validation successful
[06:16:28] ✅    ✅ Data merged successfully
[06:16:29] ✅    ✅ Order data extracted and validated
[06:16:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:16:29] [DOC: 9240137] ✅ Patient found in local cache: Gina Reich, ID: d58989e3-7402-4034-9b32-9290658d7724
[06:16:29] ✅    ✅ Existing patient found with ID: d58989e3-7402-4034-9b32-9290658d7724
[06:16:29] 🔄 
🔄 Step 6: Pushing order to API...
[06:16:29] [DOC: 9240137] ℹ️  Pushing order via API for patient ID: d58989e3-7402-4034-9b32-9290658d7724
[06:16:30] [DOC: 9240137] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:16:30] ❌    ❌ Failed to push order
[06:16:30] 🔄 
🔄 Step 7: Writing to CSV...
[06:16:30] [DOC: 9240137] ℹ️  Calculated age: 62 from DOB: 12/30/1962
[06:16:30] [DOC: 9240137] ℹ️  Service Line extracted: 'HHA'
[06:16:30] [DOC: 9240137] ℹ️  Payer Source extracted: 'Medicaid/MA'
[06:16:30] [DOC: 9240137] ℹ️  Diagnosis codes being written:
[06:16:30] [DOC: 9240137] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:16:30] [DOC: 9240137] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:16:30] [DOC: 9240137] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:16:30] [DOC: 9240137] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:16:30] [DOC: 9240137] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:16:30] [DOC: 9240137] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:16:30] [DOC: 9240137] ✅ Patient data written to CSV: Gina Reich | Sex: FEMALE | Age: 62 | Service: HHA | Payer: Medicaid/MA | MRN: 14458020
[06:16:30] ✅    ✅ Document 9240137 processed and saved successfully
[06:16:30] 🔄 
🔄 Step 8: Saving API details...
[06:16:30] [DOC: 9240137] ℹ️  API push details saved for document 9240137
[06:16:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240096                         ║
================================================================================
[06:16:30] ℹ️  Agency: Nizhoni Health-Fall River
[06:16:30] ℹ️  Date: 04/15/2025
[06:16:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:16:34] [DOC: 9240096] ✅ Text extracted using pdfplumber (14241 chars)
[06:16:34] ✅    ✅ Text extracted using pdfplumber (14241 chars)
[06:16:34] 🔄 
🔄 Step 2: Extracting patient data...
[06:16:37] ℹ️  AI extracted raw sex value: 'F'
[06:16:37] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:16:37] ℹ️  AI extracted payer source: 'None'
[06:16:37] ℹ️  AI extracted diagnoses:
[06:16:37] ℹ️    - Diagnosis 1: 'F33.3'
[06:16:37] ℹ️    - Diagnosis 2: 'F41.1'
[06:16:37] ℹ️    - Diagnosis 3: 'K51.90'
[06:16:37] ℹ️    - Diagnosis 4: 'M54.50'
[06:16:37] ℹ️    - Diagnosis 5: 'N18.30'
[06:16:37] ℹ️    - Diagnosis 6: 'F01.518'
[06:16:37] ℹ️  Final extracted MRN: '24037'
[06:16:37] ℹ️  Final extracted Sex: 'FEMALE'
[06:16:37] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:16:37] ℹ️  Final extracted Payer Source: ''
[06:16:37] ✅ Patient data extraction completed successfully
[06:16:37] ✅    ✅ Patient data extracted successfully
[06:16:37] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Gibson
     └─ dob: 07/27/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 24037
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: None
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '11/13/2018', 'startOfEpisode': '11/13/2018', 'endOfEpisode': '06/08/2025', 'firstDiagnosis': 'F33.3', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'K51.90', 'fourthDiagnosis': 'M54.50', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'F01.518'}]
[06:16:37] ✅    ✅ Patient identified: Patricia Gibson
[06:16:37] ✅    ✅ Patient name validation passed
[06:16:37] 🔄 
🔄 Step 3: Processing patient dates...
[06:16:37] [DOC: 9240096] ℹ️  DOB normalized: 07/27/1952
[06:16:37] [DOC: 9240096] ℹ️  Episode startOfCare normalized: 11/13/2018
[06:16:37] [DOC: 9240096] ℹ️  Episode startOfEpisode normalized: 11/13/2018
[06:16:37] [DOC: 9240096] ℹ️  Episode endOfEpisode normalized: 06/08/2025
[06:16:37] [DOC: 9240096] ✅ Patient date processing completed successfully
[06:16:37] ✅    ✅ Date processing completed
[06:16:37] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Gibson
     └─ dob: 07/27/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 24037
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '11/13/2018', 'startOfEpisode': '11/13/2018', 'endOfEpisode': '06/08/2025', 'firstDiagnosis': 'F33.3', 'secondDiagnosis': 'F41.1', 'thirdDiagnosis': 'K51.90', 'fourthDiagnosis': 'M54.50', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': 'F01.518'}]
[06:16:37] 🔄 
🔄 Step 4: Extracting order data...
[06:16:39] ℹ️  Order extraction - MRN: '24037'
[06:16:39] ℹ️  Order extraction - Sex: 'FEMALE'
[06:16:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:16:39] ℹ️  Order extraction - Payer Source: ''
[06:16:39] ✅ Order data extraction completed successfully
[06:16:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:16:39] ℹ️  Using MRN from patient data: '24037' over '24037'
[06:16:39] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:16:39] ✅ Patient name cross-validation successful
[06:16:39] ✅    ✅ Data merged successfully
[06:16:41] ✅    ✅ Order data extracted and validated
[06:16:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:16:59] [DOC: 9240096] ✅ Patient exists in API: Patricia Gibson, ID: 2c91dedd-1ffa-4206-8264-75d2aff31fbb
[06:16:59] ✅    ✅ Existing patient found with ID: 2c91dedd-1ffa-4206-8264-75d2aff31fbb
[06:16:59] 🔄 
🔄 Step 6: Pushing order to API...
[06:16:59] [DOC: 9240096] ℹ️  Pushing order via API for patient ID: 2c91dedd-1ffa-4206-8264-75d2aff31fbb
[06:17:01] [DOC: 9240096] ❌ Order push failed with status 201: {"id":"78e776d2-3d86-4472-93f9-ef2263e9e9e0","orderWAVId":"ORD20033","orderNo":"24037","orderDate":"04/10/2025","startOfCare":"11/13/2018","episodeStartDate":"04/10/2025","episodeEndDate":"06/08/2025","documentID":"9240096","mrn":"24037","patientName":"Gibson, Patricia A","sentToPhysicianDate":"04/15/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/17/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"2c91dedd-1ffa-4206-8264-75d2aff31fbb","companyId":"d598757a-87c6-4192-bcde-ff8d6e0b91ad","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[06:17:01] ❌    ❌ Failed to push order
[06:17:01] 🔄 
🔄 Step 7: Writing to CSV...
[06:17:01] [DOC: 9240096] ℹ️  Calculated age: 72 from DOB: 07/27/1952
[06:17:01] [DOC: 9240096] ℹ️  Service Line extracted: 'Skilled Nursing'
[06:17:01] [DOC: 9240096] ℹ️  Payer Source extracted: ''
[06:17:01] [DOC: 9240096] ℹ️  Diagnosis codes being written:
[06:17:01] [DOC: 9240096] ℹ️    - Latest_Episode_Firstdiagnosis: 'F33.3'
[06:17:01] [DOC: 9240096] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.1'
[06:17:01] [DOC: 9240096] ℹ️    - Latest_Episode_Thirddiagnosis: 'K51.90'
[06:17:01] [DOC: 9240096] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M54.50'
[06:17:01] [DOC: 9240096] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.30'
[06:17:01] [DOC: 9240096] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F01.518'
[06:17:01] [DOC: 9240096] ✅ Patient data written to CSV: Patricia Gibson | Sex: FEMALE | Age: 72 | Service: Skilled Nursing | Payer:  | MRN: 24037
[06:17:01] ✅    ✅ Document 9240096 processed and saved successfully
[06:17:01] 🔄 
🔄 Step 8: Saving API details...
[06:17:01] [DOC: 9240096] ℹ️  API push details saved for document 9240096
[06:17:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240098                         ║
================================================================================
[06:17:01] ℹ️  Agency: Dartmouth HH
[06:17:01] ℹ️  Date: 04/15/2025
[06:17:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:17:03] [DOC: 9240098] ✅ Text extracted using pdfplumber (5942 chars)
[06:17:03] ✅    ✅ Text extracted using pdfplumber (5942 chars)
[06:17:03] 🔄 
🔄 Step 2: Extracting patient data...
[06:17:06] ℹ️  AI extracted raw sex value: 'F'
[06:17:06] ℹ️  AI extracted service line: 'OT, Skilled Nursing'
[06:17:06] ℹ️  AI extracted payer source: 'Medicare'
[06:17:06] ℹ️  AI extracted diagnoses:
[06:17:06] ℹ️    - Diagnosis 1: 'None'
[06:17:06] ℹ️    - Diagnosis 2: 'None'
[06:17:06] ℹ️    - Diagnosis 3: 'None'
[06:17:06] ℹ️    - Diagnosis 4: 'None'
[06:17:06] ℹ️    - Diagnosis 5: 'None'
[06:17:06] ℹ️    - Diagnosis 6: 'None'
[06:17:06] ℹ️  Final extracted MRN: '672008'
[06:17:06] ℹ️  Final extracted Sex: 'FEMALE'
[06:17:06] ℹ️  Final extracted Service Line: 'OT, Skilled Nursing'
[06:17:06] ℹ️  Final extracted Payer Source: 'Medicare'
[06:17:06] ✅ Patient data extraction completed successfully
[06:17:06] ✅    ✅ Patient data extracted successfully
[06:17:06] 📊 Patient Response
     └─ patientFName: Jane
     └─ patientLName: Lonsdale
     └─ dob: 02/20/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 672008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:17:06] ✅    ✅ Patient identified: Jane Lonsdale
[06:17:06] ✅    ✅ Patient name validation passed
[06:17:06] 🔄 
🔄 Step 3: Processing patient dates...
[06:17:06] [DOC: 9240098] ℹ️  DOB normalized: 02/20/1930
[06:17:06] [DOC: 9240098] ℹ️  Episode startOfCare normalized: 03/09/2025
[06:17:06] [DOC: 9240098] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[06:17:06] [DOC: 9240098] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[06:17:06] [DOC: 9240098] ✅ Patient date processing completed successfully
[06:17:06] ✅    ✅ Date processing completed
[06:17:06] 📊 Processed Patient Data
     └─ patientFName: Jane
     └─ patientLName: Lonsdale
     └─ dob: 02/20/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 672008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025'}]
[06:17:06] 🔄 
🔄 Step 4: Extracting order data...
[06:17:08] ℹ️  Order extraction - MRN: ''
[06:17:08] ℹ️  Order extraction - Sex: 'FEMALE'
[06:17:08] ℹ️  Order extraction - Service Line: 'OT, RN'
[06:17:08] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:17:08] ✅ Order data extraction completed successfully
[06:17:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:17:08] ℹ️  Using MRN from patient data: '672008'
[06:17:08] ℹ️  Combined service lines: Patient='OT, Skilled Nursing' + Order='OT, RN' = 'OT, RN, Skilled Nursing'
[06:17:08] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:17:08] ✅ Patient name cross-validation successful
[06:17:08] ✅    ✅ Data merged successfully
[06:17:10] ✅    ✅ Order data extracted and validated
[06:17:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:17:15] [DOC: 9240098] ℹ️  Patient not found in cache or API: Jane Lonsdale
[06:17:15] [DOC: 9240098] ℹ️  Patient not found, creating new patient via API...
[06:17:15] [DOC: 9240098] ℹ️  Creating patient via API: Jane Lonsdale
[06:17:16] [DOC: 9240098] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:17:16] ❌    ❌ Failed to create patient
[06:17:16] [DOC: 9240098] ℹ️  API push details saved for document 9240098
================================================================================
║                        Processing Document ID: 9240095                         ║
================================================================================
[06:17:16] ℹ️  Agency: Dartmouth HH
[06:17:16] ℹ️  Date: 04/15/2025
[06:17:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:17:19] [DOC: 9240095] ✅ Text extracted using pdfplumber (6167 chars)
[06:17:19] ✅    ✅ Text extracted using pdfplumber (6167 chars)
[06:17:19] 🔄 
🔄 Step 2: Extracting patient data...
[06:17:22] ℹ️  AI extracted raw sex value: 'F'
[06:17:22] ℹ️  AI extracted service line: 'OT'
[06:17:22] ℹ️  AI extracted payer source: 'Medicare'
[06:17:22] ℹ️  AI extracted diagnoses:
[06:17:22] ℹ️    - Diagnosis 1: ''
[06:17:22] ℹ️    - Diagnosis 2: ''
[06:17:22] ℹ️    - Diagnosis 3: ''
[06:17:22] ℹ️    - Diagnosis 4: ''
[06:17:22] ℹ️    - Diagnosis 5: ''
[06:17:22] ℹ️    - Diagnosis 6: ''
[06:17:22] ℹ️  Final extracted MRN: '1183008'
[06:17:22] ℹ️  Final extracted Sex: 'FEMALE'
[06:17:22] ℹ️  Final extracted Service Line: 'OT'
[06:17:22] ℹ️  Final extracted Payer Source: 'Medicare'
[06:17:22] ✅ Patient data extraction completed successfully
[06:17:22] ✅    ✅ Patient data extracted successfully
[06:17:22] 📊 Patient Response
     └─ patientFName: Jean
     └─ patientLName: Silver
     └─ dob: 02/12/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1183008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:17:22] ✅    ✅ Patient identified: Jean Silver
[06:17:22] ✅    ✅ Patient name validation passed
[06:17:22] 🔄 
🔄 Step 3: Processing patient dates...
[06:17:22] [DOC: 9240095] ℹ️  DOB normalized: 02/12/1931
[06:17:22] [DOC: 9240095] ℹ️  Episode startOfCare normalized: 03/29/2025
[06:17:22] [DOC: 9240095] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[06:17:22] [DOC: 9240095] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[06:17:22] [DOC: 9240095] ✅ Patient date processing completed successfully
[06:17:22] ✅    ✅ Date processing completed
[06:17:22] 📊 Processed Patient Data
     └─ patientFName: Jean
     └─ patientLName: Silver
     └─ dob: 02/12/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1183008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:17:22] 🔄 
🔄 Step 4: Extracting order data...
[06:17:24] ℹ️  Order extraction - MRN: ''
[06:17:24] ℹ️  Order extraction - Sex: 'FEMALE'
[06:17:24] ℹ️  Order extraction - Service Line: 'OT'
[06:17:24] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:17:24] ✅ Order data extraction completed successfully
[06:17:24] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:17:24] ℹ️  Using MRN from patient data: '1183008'
[06:17:24] ℹ️  Service line consistent in both sources: 'OT'
[06:17:24] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:17:24] ✅ Patient name cross-validation successful
[06:17:24] ✅    ✅ Data merged successfully
[06:17:26] ✅    ✅ Order data extracted and validated
[06:17:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:17:31] [DOC: 9240095] ℹ️  Patient not found in cache or API: Jean Silver
[06:17:31] [DOC: 9240095] ℹ️  Patient not found, creating new patient via API...
[06:17:31] [DOC: 9240095] ℹ️  Creating patient via API: Jean Silver
[06:17:32] [DOC: 9240095] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:17:32] ❌    ❌ Failed to create patient
[06:17:32] [DOC: 9240095] ℹ️  API push details saved for document 9240095
================================================================================
║                        Processing Document ID: 9240094                         ║
================================================================================
[06:17:32] ℹ️  Agency: Dartmouth HH
[06:17:32] ℹ️  Date: 04/15/2025
[06:17:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:17:34] [DOC: 9240094] ✅ Text extracted using pdfplumber (4817 chars)
[06:17:34] ✅    ✅ Text extracted using pdfplumber (4817 chars)
[06:17:34] 🔄 
🔄 Step 2: Extracting patient data...
[06:17:37] ℹ️  AI extracted raw sex value: 'F'
[06:17:37] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[06:17:37] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[06:17:37] ℹ️  AI extracted diagnoses:
[06:17:37] ℹ️    - Diagnosis 1: ''
[06:17:37] ℹ️    - Diagnosis 2: ''
[06:17:37] ℹ️    - Diagnosis 3: ''
[06:17:37] ℹ️    - Diagnosis 4: ''
[06:17:37] ℹ️    - Diagnosis 5: ''
[06:17:37] ℹ️    - Diagnosis 6: ''
[06:17:37] ℹ️  Final extracted MRN: '6201015'
[06:17:37] ℹ️  Final extracted Sex: 'FEMALE'
[06:17:37] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[06:17:37] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[06:17:37] ✅ Patient data extraction completed successfully
[06:17:37] ✅    ✅ Patient data extracted successfully
[06:17:37] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Laborinho
     └─ dob: 02/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6201015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:17:37] ✅    ✅ Patient identified: Maria Laborinho
[06:17:37] ✅    ✅ Patient name validation passed
[06:17:37] 🔄 
🔄 Step 3: Processing patient dates...
[06:17:37] [DOC: 9240094] ℹ️  DOB normalized: 02/08/1951
[06:17:37] [DOC: 9240094] ℹ️  Episode startOfCare normalized: 03/13/2025
[06:17:37] [DOC: 9240094] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[06:17:37] [DOC: 9240094] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[06:17:37] [DOC: 9240094] ✅ Patient date processing completed successfully
[06:17:37] ✅    ✅ Date processing completed
[06:17:37] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Laborinho
     └─ dob: 02/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6201015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:17:37] 🔄 
🔄 Step 4: Extracting order data...
[06:17:40] ℹ️  Order extraction - MRN: ''
[06:17:40] ℹ️  Order extraction - Sex: 'FEMALE'
[06:17:40] ℹ️  Order extraction - Service Line: 'RN, PT'
[06:17:40] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[06:17:40] ✅ Order data extraction completed successfully
[06:17:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:17:40] ℹ️  Using MRN from patient data: '6201015'
[06:17:40] ℹ️  Combined service lines: Patient='Skilled Nursing, PT' + Order='RN, PT' = 'PT, RN, Skilled Nursing'
[06:17:40] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[06:17:40] ✅ Patient name cross-validation successful
[06:17:40] ✅    ✅ Data merged successfully
[06:17:41] ✅    ✅ Order data extracted and validated
[06:17:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:17:47] [DOC: 9240094] ℹ️  Patient not found in cache or API: Maria Laborinho
[06:17:47] [DOC: 9240094] ℹ️  Patient not found, creating new patient via API...
[06:17:47] [DOC: 9240094] ℹ️  Creating patient via API: Maria Laborinho
[06:17:48] [DOC: 9240094] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:17:48] ❌    ❌ Failed to create patient
[06:17:48] [DOC: 9240094] ℹ️  API push details saved for document 9240094
================================================================================
║                        Processing Document ID: 9240089                         ║
================================================================================
[06:17:48] ℹ️  Agency: Dartmouth HH
[06:17:48] ℹ️  Date: 04/15/2025
[06:17:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:17:50] [DOC: 9240089] ✅ Text extracted using pdfplumber (4576 chars)
[06:17:50] ✅    ✅ Text extracted using pdfplumber (4576 chars)
[06:17:50] 🔄 
🔄 Step 2: Extracting patient data...
[06:17:53] ℹ️  AI extracted raw sex value: 'M'
[06:17:53] ℹ️  AI extracted service line: 'PT'
[06:17:53] ℹ️  AI extracted payer source: 'Medicare'
[06:17:53] ℹ️  AI extracted diagnoses:
[06:17:53] ℹ️    - Diagnosis 1: ''
[06:17:53] ℹ️    - Diagnosis 2: ''
[06:17:53] ℹ️    - Diagnosis 3: ''
[06:17:53] ℹ️    - Diagnosis 4: ''
[06:17:53] ℹ️    - Diagnosis 5: ''
[06:17:53] ℹ️    - Diagnosis 6: ''
[06:17:53] ℹ️  Final extracted MRN: '6039015'
[06:17:53] ℹ️  Final extracted Sex: 'MALE'
[06:17:53] ℹ️  Final extracted Service Line: 'PT'
[06:17:53] ℹ️  Final extracted Payer Source: 'Medicare'
[06:17:53] ✅ Patient data extraction completed successfully
[06:17:53] ✅    ✅ Patient data extracted successfully
[06:17:53] 📊 Patient Response
     └─ patientFName: Philip
     └─ patientLName: Mello
     └─ dob: 03/04/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 6039015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:17:53] ✅    ✅ Patient identified: Philip Mello
[06:17:53] ✅    ✅ Patient name validation passed
[06:17:53] 🔄 
🔄 Step 3: Processing patient dates...
[06:17:53] [DOC: 9240089] ℹ️  DOB normalized: 03/04/1953
[06:17:53] [DOC: 9240089] ℹ️  Episode startOfCare normalized: 03/15/2025
[06:17:53] [DOC: 9240089] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[06:17:53] [DOC: 9240089] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[06:17:53] [DOC: 9240089] ✅ Patient date processing completed successfully
[06:17:53] ✅    ✅ Date processing completed
[06:17:53] 📊 Processed Patient Data
     └─ patientFName: Philip
     └─ patientLName: Mello
     └─ dob: 03/04/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 6039015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:17:53] 🔄 
🔄 Step 4: Extracting order data...
[06:17:56] ℹ️  Order extraction - MRN: '6039015'
[06:17:56] ℹ️  Order extraction - Sex: 'MALE'
[06:17:56] ℹ️  Order extraction - Service Line: 'PT'
[06:17:56] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:17:56] ✅ Order data extraction completed successfully
[06:17:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:17:56] ℹ️  Using MRN from patient data: '6039015' over '6039015'
[06:17:56] ℹ️  Service line consistent in both sources: 'PT'
[06:17:56] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:17:56] ✅ Patient name cross-validation successful
[06:17:56] ✅    ✅ Data merged successfully
[06:17:57] ✅    ✅ Order data extracted and validated
[06:17:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:18:03] [DOC: 9240089] ℹ️  Patient not found in cache or API: Philip Mello
[06:18:03] [DOC: 9240089] ℹ️  Patient not found, creating new patient via API...
[06:18:03] [DOC: 9240089] ℹ️  Creating patient via API: Philip Mello
[06:18:04] [DOC: 9240089] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:18:04] ❌    ❌ Failed to create patient
[06:18:04] [DOC: 9240089] ℹ️  API push details saved for document 9240089
================================================================================
║                        Processing Document ID: 9240085                         ║
================================================================================
[06:18:04] ℹ️  Agency: Dartmouth HH
[06:18:04] ℹ️  Date: 04/15/2025
[06:18:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:18:07] [DOC: 9240085] ✅ Text extracted using pdfplumber (994 chars)
[06:18:07] ✅    ✅ Text extracted using pdfplumber (994 chars)
[06:18:07] 🔄 
🔄 Step 2: Extracting patient data...
[06:18:09] ℹ️  AI extracted raw sex value: 'F'
[06:18:09] ℹ️  AI extracted service line: 'HHA'
[06:18:09] ℹ️  AI extracted payer source: 'Medicare'
[06:18:09] ℹ️  AI extracted diagnoses:
[06:18:09] ℹ️    - Diagnosis 1: ''
[06:18:09] ℹ️    - Diagnosis 2: ''
[06:18:09] ℹ️    - Diagnosis 3: ''
[06:18:09] ℹ️    - Diagnosis 4: ''
[06:18:09] ℹ️    - Diagnosis 5: ''
[06:18:09] ℹ️    - Diagnosis 6: ''
[06:18:09] ℹ️  Final extracted MRN: '5915015'
[06:18:09] ℹ️  Final extracted Sex: 'FEMALE'
[06:18:09] ℹ️  Final extracted Service Line: 'HHA'
[06:18:09] ℹ️  Final extracted Payer Source: 'Medicare'
[06:18:09] ✅ Patient data extraction completed successfully
[06:18:09] ✅    ✅ Patient data extracted successfully
[06:18:09] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/26/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:18:09] ✅    ✅ Patient identified: Suzanne Fawcett
[06:18:09] ✅    ✅ Patient name validation passed
[06:18:09] 🔄 
🔄 Step 3: Processing patient dates...
[06:18:09] [DOC: 9240085] ℹ️  DOB normalized: 12/08/1939
[06:18:09] [DOC: 9240085] ℹ️  Episode startOfCare normalized: 01/26/2025
[06:18:09] [DOC: 9240085] ℹ️  Episode startOfEpisode normalized: 01/26/2025
[06:18:09] [DOC: 9240085] ℹ️  Episode endOfEpisode normalized: 03/26/2025
[06:18:09] [DOC: 9240085] ✅ Patient date processing completed successfully
[06:18:09] ✅    ✅ Date processing completed
[06:18:09] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/26/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:18:09] 🔄 
🔄 Step 4: Extracting order data...
[06:18:12] ℹ️  Order extraction - MRN: ''
[06:18:12] ℹ️  Order extraction - Sex: 'FEMALE'
[06:18:12] ℹ️  Order extraction - Service Line: 'HHA'
[06:18:12] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:18:12] ✅ Order data extraction completed successfully
[06:18:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:18:12] ℹ️  Using MRN from patient data: '5915015'
[06:18:12] ℹ️  Service line consistent in both sources: 'HHA'
[06:18:12] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:18:12] ✅ Patient name cross-validation successful
[06:18:12] ✅    ✅ Data merged successfully
[06:18:13] ✅    ✅ Order data extracted and validated
[06:18:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:18:30] [DOC: 9240085] ℹ️  Patient not found in cache or API: Suzanne Fawcett
[06:18:30] [DOC: 9240085] ℹ️  Patient not found, creating new patient via API...
[06:18:30] [DOC: 9240085] ℹ️  Creating patient via API: Suzanne Fawcett
[06:18:31] [DOC: 9240085] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:18:31] ❌    ❌ Failed to create patient
[06:18:31] [DOC: 9240085] ℹ️  API push details saved for document 9240085
================================================================================
║                        Processing Document ID: 9240084                         ║
================================================================================
[06:18:31] ℹ️  Agency: Dartmouth HH
[06:18:31] ℹ️  Date: 04/15/2025
[06:18:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:18:33] [DOC: 9240084] ✅ Text extracted using pdfplumber (1644 chars)
[06:18:33] ✅    ✅ Text extracted using pdfplumber (1644 chars)
[06:18:33] 🔄 
🔄 Step 2: Extracting patient data...
[06:18:36] ℹ️  AI extracted raw sex value: 'F'
[06:18:36] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:18:36] ℹ️  AI extracted payer source: 'Medicare'
[06:18:36] ℹ️  AI extracted diagnoses:
[06:18:36] ℹ️    - Diagnosis 1: ''
[06:18:36] ℹ️    - Diagnosis 2: ''
[06:18:36] ℹ️    - Diagnosis 3: ''
[06:18:36] ℹ️    - Diagnosis 4: ''
[06:18:36] ℹ️    - Diagnosis 5: ''
[06:18:36] ℹ️    - Diagnosis 6: ''
[06:18:36] ℹ️  Final extracted MRN: '5915015'
[06:18:36] ℹ️  Final extracted Sex: 'FEMALE'
[06:18:36] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:18:36] ℹ️  Final extracted Payer Source: 'Medicare'
[06:18:36] ✅ Patient data extraction completed successfully
[06:18:36] ✅    ✅ Patient data extracted successfully
[06:18:36] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:18:36] ✅    ✅ Patient identified: Suzanne Fawcett
[06:18:36] ✅    ✅ Patient name validation passed
[06:18:36] 🔄 
🔄 Step 3: Processing patient dates...
[06:18:36] [DOC: 9240084] ℹ️  DOB normalized: 12/08/1939
[06:18:36] [DOC: 9240084] ℹ️  Episode startOfCare normalized: 01/26/2025
[06:18:36] [DOC: 9240084] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[06:18:36] [DOC: 9240084] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[06:18:36] [DOC: 9240084] ✅ Patient date processing completed successfully
[06:18:36] ✅    ✅ Date processing completed
[06:18:36] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:18:36] 🔄 
🔄 Step 4: Extracting order data...
[06:18:38] ℹ️  Order extraction - MRN: ''
[06:18:38] ℹ️  Order extraction - Sex: 'FEMALE'
[06:18:38] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:18:38] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:18:38] ✅ Order data extraction completed successfully
[06:18:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:18:38] ℹ️  Using MRN from patient data: '5915015'
[06:18:38] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:18:38] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:18:38] ✅ Patient name cross-validation successful
[06:18:38] ✅    ✅ Data merged successfully
[06:18:39] ✅    ✅ Order data extracted and validated
[06:18:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:18:45] [DOC: 9240084] ℹ️  Patient not found in cache or API: Suzanne Fawcett
[06:18:45] [DOC: 9240084] ℹ️  Patient not found, creating new patient via API...
[06:18:45] [DOC: 9240084] ℹ️  Creating patient via API: Suzanne Fawcett
[06:18:46] [DOC: 9240084] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:18:46] ❌    ❌ Failed to create patient
[06:18:46] [DOC: 9240084] ℹ️  API push details saved for document 9240084
================================================================================
║                        Processing Document ID: 9240083                         ║
================================================================================
[06:18:46] ℹ️  Agency: Dartmouth HH
[06:18:46] ℹ️  Date: 04/15/2025
[06:18:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:18:48] [DOC: 9240083] ✅ Text extracted using pdfplumber (3236 chars)
[06:18:48] ✅    ✅ Text extracted using pdfplumber (3236 chars)
[06:18:48] 🔄 
🔄 Step 2: Extracting patient data...
[06:18:51] ℹ️  AI extracted raw sex value: 'M'
[06:18:51] ℹ️  AI extracted service line: 'Physical Therapy'
[06:18:51] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[06:18:51] ℹ️  AI extracted diagnoses:
[06:18:51] ℹ️    - Diagnosis 1: ''
[06:18:51] ℹ️    - Diagnosis 2: ''
[06:18:51] ℹ️    - Diagnosis 3: ''
[06:18:51] ℹ️    - Diagnosis 4: ''
[06:18:51] ℹ️    - Diagnosis 5: ''
[06:18:51] ℹ️    - Diagnosis 6: ''
[06:18:51] ℹ️  Final extracted MRN: '2804015'
[06:18:51] ℹ️  Final extracted Sex: 'MALE'
[06:18:51] ℹ️  Final extracted Service Line: 'Physical Therapy'
[06:18:51] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[06:18:51] ✅ Patient data extraction completed successfully
[06:18:51] ✅    ✅ Patient data extracted successfully
[06:18:51] 📊 Patient Response
     └─ patientFName: Jonathan
     └─ patientLName: Sterns
     └─ dob: 11/03/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2804015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:18:51] ✅    ✅ Patient identified: Jonathan Sterns
[06:18:51] ✅    ✅ Patient name validation passed
[06:18:51] 🔄 
🔄 Step 3: Processing patient dates...
[06:18:51] [DOC: 9240083] ℹ️  DOB normalized: 11/03/1957
[06:18:51] [DOC: 9240083] ℹ️  Episode startOfCare normalized: 02/28/2025
[06:18:51] [DOC: 9240083] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[06:18:51] [DOC: 9240083] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[06:18:51] [DOC: 9240083] ✅ Patient date processing completed successfully
[06:18:51] ✅    ✅ Date processing completed
[06:18:51] 📊 Processed Patient Data
     └─ patientFName: Jonathan
     └─ patientLName: Sterns
     └─ dob: 11/03/1957
     └─ patientSex: MALE
     └─ medicalRecordNo: 2804015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:18:51] 🔄 
🔄 Step 4: Extracting order data...
[06:18:53] ℹ️  Order extraction - MRN: ''
[06:18:53] ℹ️  Order extraction - Sex: 'MALE'
[06:18:53] ℹ️  Order extraction - Service Line: 'PT'
[06:18:53] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[06:18:53] ✅ Order data extraction completed successfully
[06:18:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:18:53] ℹ️  Using MRN from patient data: '2804015'
[06:18:53] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[06:18:53] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[06:18:53] ✅ Patient name cross-validation successful
[06:18:53] ✅    ✅ Data merged successfully
[06:18:54] ✅    ✅ Order data extracted and validated
[06:18:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:19:00] [DOC: 9240083] ✅ Patient exists in API: Jonathan Sterns, ID: 3091bab5-713d-40c1-a4a4-e374fcc1ce53
[06:19:01] ✅    ✅ Existing patient found with ID: 3091bab5-713d-40c1-a4a4-e374fcc1ce53
[06:19:01] 🔄 
🔄 Step 6: Pushing order to API...
[06:19:01] [DOC: 9240083] ℹ️  Pushing order via API for patient ID: 3091bab5-713d-40c1-a4a4-e374fcc1ce53
[06:19:02] [DOC: 9240083] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:19:02] ❌    ❌ Failed to push order
[06:19:02] 🔄 
🔄 Step 7: Writing to CSV...
[06:19:02] [DOC: 9240083] ℹ️  Calculated age: 67 from DOB: 11/03/1957
[06:19:02] [DOC: 9240083] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[06:19:02] [DOC: 9240083] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[06:19:02] [DOC: 9240083] ℹ️  Diagnosis codes being written:
[06:19:02] [DOC: 9240083] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:19:02] [DOC: 9240083] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:19:02] [DOC: 9240083] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:19:02] [DOC: 9240083] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:19:02] [DOC: 9240083] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:19:02] [DOC: 9240083] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:19:02] [DOC: 9240083] ✅ Patient data written to CSV: Jonathan Sterns | Sex: MALE | Age: 67 | Service: PT, Physical Therapy | Payer: Tufts Health Plan Medicare Preferred | MRN: 2804015
[06:19:02] ✅    ✅ Document 9240083 processed and saved successfully
[06:19:02] 🔄 
🔄 Step 8: Saving API details...
[06:19:02] [DOC: 9240083] ℹ️  API push details saved for document 9240083
[06:19:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240077                         ║
================================================================================
[06:19:02] ℹ️  Agency: Dartmouth HH
[06:19:02] ℹ️  Date: 04/15/2025
[06:19:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:19:05] [DOC: 9240077] ✅ Text extracted using pdfplumber (18176 chars)
[06:19:05] ✅    ✅ Text extracted using pdfplumber (18176 chars)
[06:19:05] 🔄 
🔄 Step 2: Extracting patient data...
[06:19:08] ℹ️  AI extracted raw sex value: 'M'
[06:19:08] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[06:19:08] ℹ️  AI extracted payer source: 'None'
[06:19:08] ℹ️  AI extracted diagnoses:
[06:19:08] ℹ️    - Diagnosis 1: 'I12.9'
[06:19:08] ℹ️    - Diagnosis 2: 'E11.22'
[06:19:08] ℹ️    - Diagnosis 3: 'N18.32'
[06:19:08] ℹ️    - Diagnosis 4: 'R26.9'
[06:19:08] ℹ️    - Diagnosis 5: 'R25.1'
[06:19:08] ℹ️    - Diagnosis 6: 'F41.9'
[06:19:08] ℹ️  Final extracted MRN: '5019015'
[06:19:08] ℹ️  Final extracted Sex: 'MALE'
[06:19:08] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[06:19:08] ℹ️  Final extracted Payer Source: ''
[06:19:08] ✅ Patient data extraction completed successfully
[06:19:08] ✅    ✅ Patient data extracted successfully
[06:19:08] 📊 Patient Response
     └─ patientFName: Phillip
     └─ patientLName: Sylvia
     └─ dob: 08/03/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5019015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'E11.22', 'thirdDiagnosis': 'N18.32', 'fourthDiagnosis': 'R26.9', 'fifthDiagnosis': 'R25.1', 'sixthDiagnosis': 'F41.9'}]
[06:19:08] ✅    ✅ Patient identified: Phillip Sylvia
[06:19:08] ✅    ✅ Patient name validation passed
[06:19:08] 🔄 
🔄 Step 3: Processing patient dates...
[06:19:08] [DOC: 9240077] ℹ️  DOB normalized: 08/03/1944
[06:19:08] [DOC: 9240077] ℹ️  Episode startOfCare normalized: 03/25/2025
[06:19:08] [DOC: 9240077] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[06:19:08] [DOC: 9240077] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[06:19:08] [DOC: 9240077] ✅ Patient date processing completed successfully
[06:19:08] ✅    ✅ Date processing completed
[06:19:08] 📊 Processed Patient Data
     └─ patientFName: Phillip
     └─ patientLName: Sylvia
     └─ dob: 08/03/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5019015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': 'I12.9', 'secondDiagnosis': 'E11.22', 'thirdDiagnosis': 'N18.32', 'fourthDiagnosis': 'R26.9', 'fifthDiagnosis': 'R25.1', 'sixthDiagnosis': 'F41.9'}]
[06:19:08] 🔄 
🔄 Step 4: Extracting order data...
[06:19:10] ℹ️  Order extraction - MRN: '5019015'
[06:19:10] ℹ️  Order extraction - Sex: 'MALE'
[06:19:10] ℹ️  Order extraction - Service Line: 'PT, OT, RN'
[06:19:10] ℹ️  Order extraction - Payer Source: ''
[06:19:10] ✅ Order data extraction completed successfully
[06:19:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:19:10] ℹ️  Using MRN from patient data: '5019015' over '5019015'
[06:19:10] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT' + Order='PT, OT, RN' = 'OT, PT, RN, Skilled Nursing'
[06:19:10] ✅ Patient name cross-validation successful
[06:19:10] ✅    ✅ Data merged successfully
[06:19:11] ✅    ✅ Order data extracted and validated
[06:19:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:19:11] [DOC: 9240077] ✅ Patient found in local cache: Phillip Sylvia, ID: da668618-8653-4ff9-a16c-8eb8ca6755a4
[06:19:11] ✅    ✅ Existing patient found with ID: da668618-8653-4ff9-a16c-8eb8ca6755a4
[06:19:11] 🔄 
🔄 Step 6: Pushing order to API...
[06:19:11] [DOC: 9240077] ℹ️  Pushing order via API for patient ID: da668618-8653-4ff9-a16c-8eb8ca6755a4
[06:19:12] [DOC: 9240077] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:19:12] ❌    ❌ Failed to push order
[06:19:12] 🔄 
🔄 Step 7: Writing to CSV...
[06:19:12] [DOC: 9240077] ℹ️  Calculated age: 80 from DOB: 08/03/1944
[06:19:12] [DOC: 9240077] ℹ️  Service Line extracted: 'OT, PT, RN, Skilled Nursing'
[06:19:12] [DOC: 9240077] ℹ️  Payer Source extracted: ''
[06:19:12] [DOC: 9240077] ℹ️  Diagnosis codes being written:
[06:19:12] [DOC: 9240077] ℹ️    - Latest_Episode_Firstdiagnosis: 'I12.9'
[06:19:12] [DOC: 9240077] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.22'
[06:19:12] [DOC: 9240077] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.32'
[06:19:12] [DOC: 9240077] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R26.9'
[06:19:12] [DOC: 9240077] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R25.1'
[06:19:12] [DOC: 9240077] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[06:19:12] [DOC: 9240077] ✅ Patient data written to CSV: Phillip Sylvia | Sex: MALE | Age: 80 | Service: OT, PT, RN, Skilled Nursing | Payer:  | MRN: 5019015
[06:19:12] ✅    ✅ Document 9240077 processed and saved successfully
[06:19:12] 🔄 
🔄 Step 8: Saving API details...
[06:19:12] [DOC: 9240077] ℹ️  API push details saved for document 9240077
[06:19:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240076                         ║
================================================================================
[06:19:12] ℹ️  Agency: Dartmouth HH
[06:19:12] ℹ️  Date: 04/15/2025
[06:19:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:19:15] [DOC: 9240076] ✅ Text extracted using pdfplumber (1180 chars)
[06:19:15] ✅    ✅ Text extracted using pdfplumber (1180 chars)
[06:19:15] 🔄 
🔄 Step 2: Extracting patient data...
[06:19:17] ℹ️  AI extracted raw sex value: 'M'
[06:19:17] ℹ️  AI extracted service line: 'RN'
[06:19:17] ℹ️  AI extracted payer source: 'Medicare'
[06:19:17] ℹ️  AI extracted diagnoses:
[06:19:17] ℹ️    - Diagnosis 1: 'None'
[06:19:17] ℹ️    - Diagnosis 2: 'None'
[06:19:17] ℹ️    - Diagnosis 3: 'None'
[06:19:17] ℹ️    - Diagnosis 4: 'None'
[06:19:17] ℹ️    - Diagnosis 5: 'None'
[06:19:17] ℹ️    - Diagnosis 6: 'None'
[06:19:17] ℹ️  Final extracted MRN: '842002'
[06:19:17] ℹ️  Final extracted Sex: 'MALE'
[06:19:17] ℹ️  Final extracted Service Line: 'RN'
[06:19:17] ℹ️  Final extracted Payer Source: 'Medicare'
[06:19:17] ✅ Patient data extraction completed successfully
[06:19:17] ✅    ✅ Patient data extracted successfully
[06:19:17] 📊 Patient Response
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:19:17] ✅    ✅ Patient identified: Johannes Bjornson
[06:19:17] ✅    ✅ Patient name validation passed
[06:19:17] 🔄 
🔄 Step 3: Processing patient dates...
[06:19:17] [DOC: 9240076] ℹ️  DOB normalized: 02/09/1942
[06:19:17] [DOC: 9240076] ℹ️  Episode startOfCare normalized: 10/10/2024
[06:19:17] [DOC: 9240076] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[06:19:17] [DOC: 9240076] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[06:19:17] [DOC: 9240076] ✅ Patient date processing completed successfully
[06:19:17] ✅    ✅ Date processing completed
[06:19:17] 📊 Processed Patient Data
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025'}]
[06:19:17] 🔄 
🔄 Step 4: Extracting order data...
[06:19:20] ℹ️  Order extraction - MRN: ''
[06:19:20] ℹ️  Order extraction - Sex: 'MALE'
[06:19:20] ℹ️  Order extraction - Service Line: ''
[06:19:20] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:19:20] ✅ Order data extraction completed successfully
[06:19:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:19:20] ℹ️  Using MRN from patient data: '842002'
[06:19:20] ℹ️  Using service line from patient data: 'RN'
[06:19:20] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:19:20] ✅ Patient name cross-validation successful
[06:19:20] ✅    ✅ Data merged successfully
[06:19:21] ✅    ✅ Order data extracted and validated
[06:19:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:19:21] [DOC: 9240076] ✅ Patient found in local cache: Johannes Bjornson, ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[06:19:21] ✅    ✅ Existing patient found with ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[06:19:21] 🔄 
🔄 Step 6: Pushing order to API...
[06:19:21] [DOC: 9240076] ℹ️  Pushing order via API for patient ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[06:19:22] [DOC: 9240076] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13167"}
[06:19:22] ❌    ❌ Failed to push order
[06:19:22] 🔄 
🔄 Step 7: Writing to CSV...
[06:19:22] [DOC: 9240076] ℹ️  Calculated age: 83 from DOB: 02/09/1942
[06:19:22] [DOC: 9240076] ℹ️  Service Line extracted: 'RN'
[06:19:22] [DOC: 9240076] ℹ️  Payer Source extracted: 'Medicare'
[06:19:22] [DOC: 9240076] ℹ️  Diagnosis codes being written:
[06:19:22] [DOC: 9240076] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:19:22] [DOC: 9240076] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:19:22] [DOC: 9240076] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:19:22] [DOC: 9240076] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:19:22] [DOC: 9240076] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:19:22] [DOC: 9240076] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:19:22] [DOC: 9240076] ✅ Patient data written to CSV: Johannes Bjornson | Sex: MALE | Age: 83 | Service: RN | Payer: Medicare | MRN: 842002
[06:19:22] ✅    ✅ Document 9240076 processed and saved successfully
[06:19:22] 🔄 
🔄 Step 8: Saving API details...
[06:19:22] [DOC: 9240076] ℹ️  API push details saved for document 9240076
[06:19:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240075                         ║
================================================================================
[06:19:22] ℹ️  Agency: Dartmouth HH
[06:19:22] ℹ️  Date: 04/15/2025
[06:19:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:19:24] [DOC: 9240075] ✅ Text extracted using pdfplumber (2280 chars)
[06:19:24] ✅    ✅ Text extracted using pdfplumber (2280 chars)
[06:19:24] 🔄 
🔄 Step 2: Extracting patient data...
[06:19:27] ℹ️  AI extracted raw sex value: 'M'
[06:19:27] ℹ️  AI extracted service line: 'RN, LPN'
[06:19:27] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[06:19:27] ℹ️  AI extracted diagnoses:
[06:19:27] ℹ️    - Diagnosis 1: ''
[06:19:27] ℹ️    - Diagnosis 2: ''
[06:19:27] ℹ️    - Diagnosis 3: ''
[06:19:27] ℹ️    - Diagnosis 4: ''
[06:19:27] ℹ️    - Diagnosis 5: ''
[06:19:27] ℹ️    - Diagnosis 6: ''
[06:19:27] ℹ️  Final extracted MRN: '5019015'
[06:19:27] ℹ️  Final extracted Sex: 'MALE'
[06:19:27] ℹ️  Final extracted Service Line: 'RN, LPN'
[06:19:27] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[06:19:27] ✅ Patient data extraction completed successfully
[06:19:27] ✅    ✅ Patient data extracted successfully
[06:19:27] 📊 Patient Response
     └─ patientFName: Phillip
     └─ patientLName: Sylvia
     └─ dob: 08/03/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5019015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 37 Grove Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:19:27] ✅    ✅ Patient identified: Phillip Sylvia
[06:19:27] ✅    ✅ Patient name validation passed
[06:19:27] 🔄 
🔄 Step 3: Processing patient dates...
[06:19:27] [DOC: 9240075] ℹ️  DOB normalized: 08/03/1944
[06:19:27] [DOC: 9240075] ℹ️  Episode startOfCare normalized: 04/02/2025
[06:19:27] [DOC: 9240075] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[06:19:27] [DOC: 9240075] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[06:19:27] [DOC: 9240075] ✅ Patient date processing completed successfully
[06:19:27] ✅    ✅ Date processing completed
[06:19:27] 📊 Processed Patient Data
     └─ patientFName: Phillip
     └─ patientLName: Sylvia
     └─ dob: 08/03/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5019015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 37 Grove Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:19:27] 🔄 
🔄 Step 4: Extracting order data...
[06:19:29] ℹ️  Order extraction - MRN: ''
[06:19:29] ℹ️  Order extraction - Sex: 'MALE'
[06:19:29] ℹ️  Order extraction - Service Line: 'RN, LPN'
[06:19:29] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[06:19:29] ✅ Order data extraction completed successfully
[06:19:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:19:29] ℹ️  Using MRN from patient data: '5019015'
[06:19:29] ℹ️  Service line consistent in both sources: 'RN, LPN'
[06:19:29] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[06:19:29] ✅ Patient name cross-validation successful
[06:19:29] ✅    ✅ Data merged successfully
[06:19:31] ✅    ✅ Order data extracted and validated
[06:19:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:19:31] [DOC: 9240075] ✅ Patient found in local cache: Phillip Sylvia, ID: da668618-8653-4ff9-a16c-8eb8ca6755a4
[06:19:31] ✅    ✅ Existing patient found with ID: da668618-8653-4ff9-a16c-8eb8ca6755a4
[06:19:31] 🔄 
🔄 Step 6: Pushing order to API...
[06:19:31] [DOC: 9240075] ℹ️  Pushing order via API for patient ID: da668618-8653-4ff9-a16c-8eb8ca6755a4
[06:19:32] [DOC: 9240075] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:19:32] ❌    ❌ Failed to push order
[06:19:32] 🔄 
🔄 Step 7: Writing to CSV...
[06:19:32] [DOC: 9240075] ℹ️  Calculated age: 80 from DOB: 08/03/1944
[06:19:32] [DOC: 9240075] ℹ️  Service Line extracted: 'RN, LPN'
[06:19:32] [DOC: 9240075] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[06:19:32] [DOC: 9240075] ℹ️  Diagnosis codes being written:
[06:19:32] [DOC: 9240075] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:19:32] [DOC: 9240075] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:19:32] [DOC: 9240075] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:19:32] [DOC: 9240075] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:19:32] [DOC: 9240075] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:19:32] [DOC: 9240075] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:19:32] [DOC: 9240075] ✅ Patient data written to CSV: Phillip Sylvia | Sex: MALE | Age: 80 | Service: RN, LPN | Payer: Aetna- Mcare | MRN: 5019015
[06:19:32] ✅    ✅ Document 9240075 processed and saved successfully
[06:19:32] 🔄 
🔄 Step 8: Saving API details...
[06:19:32] [DOC: 9240075] ℹ️  API push details saved for document 9240075
[06:19:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240073                         ║
================================================================================
[06:19:32] ℹ️  Agency: Dartmouth HH
[06:19:32] ℹ️  Date: 04/15/2025
[06:19:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:19:34] [DOC: 9240073] ✅ Text extracted using pdfplumber (1349 chars)
[06:19:34] ✅    ✅ Text extracted using pdfplumber (1349 chars)
[06:19:34] 🔄 
🔄 Step 2: Extracting patient data...
[06:19:36] ℹ️  AI extracted raw sex value: 'F'
[06:19:36] ℹ️  AI extracted service line: 'Hospice'
[06:19:36] ℹ️  AI extracted payer source: 'Medicare'
[06:19:36] ℹ️  AI extracted diagnoses:
[06:19:36] ℹ️    - Diagnosis 1: ''
[06:19:36] ℹ️    - Diagnosis 2: ''
[06:19:36] ℹ️    - Diagnosis 3: ''
[06:19:36] ℹ️    - Diagnosis 4: ''
[06:19:36] ℹ️    - Diagnosis 5: ''
[06:19:36] ℹ️    - Diagnosis 6: ''
[06:19:36] ℹ️  Final extracted MRN: '2406002'
[06:19:36] ℹ️  Final extracted Sex: 'FEMALE'
[06:19:36] ℹ️  Final extracted Service Line: 'Hospice'
[06:19:36] ℹ️  Final extracted Payer Source: 'Medicare'
[06:19:36] ✅ Patient data extraction completed successfully
[06:19:36] ✅    ✅ Patient data extracted successfully
[06:19:36] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Lobo
     └─ dob: 02/06/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2406002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/05/2024', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:19:36] ✅    ✅ Patient identified: Patricia Lobo
[06:19:36] ✅    ✅ Patient name validation passed
[06:19:36] 🔄 
🔄 Step 3: Processing patient dates...
[06:19:36] [DOC: 9240073] ℹ️  DOB normalized: 02/06/1938
[06:19:36] [DOC: 9240073] ℹ️  Episode startOfCare normalized: 06/05/2024
[06:19:36] [DOC: 9240073] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[06:19:36] [DOC: 9240073] ℹ️  Episode endOfEpisode normalized: 05/30/2025
[06:19:36] [DOC: 9240073] ✅ Patient date processing completed successfully
[06:19:36] ✅    ✅ Date processing completed
[06:19:36] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Lobo
     └─ dob: 02/06/1938
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2406002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/05/2024', 'startOfEpisode': '04/01/2025', 'endOfEpisode': '05/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:19:36] 🔄 
🔄 Step 4: Extracting order data...
[06:19:38] ℹ️  Order extraction - MRN: ''
[06:19:38] ℹ️  Order extraction - Sex: 'FEMALE'
[06:19:38] ℹ️  Order extraction - Service Line: 'Hospice'
[06:19:38] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:19:38] ✅ Order data extraction completed successfully
[06:19:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:19:38] ℹ️  Using MRN from patient data: '2406002'
[06:19:38] ℹ️  Service line consistent in both sources: 'Hospice'
[06:19:38] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:19:38] ✅ Patient name cross-validation successful
[06:19:38] ✅    ✅ Data merged successfully
[06:19:39] ✅    ✅ Order data extracted and validated
[06:19:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:19:39] [DOC: 9240073] ✅ Patient found in local cache: Patricia Lobo, ID: e3cec393-5922-48e9-8f93-33ef00fae6a8
[06:19:39] ✅    ✅ Existing patient found with ID: e3cec393-5922-48e9-8f93-33ef00fae6a8
[06:19:39] 🔄 
🔄 Step 6: Pushing order to API...
[06:19:39] [DOC: 9240073] ℹ️  Pushing order via API for patient ID: e3cec393-5922-48e9-8f93-33ef00fae6a8
[06:19:41] [DOC: 9240073] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13949"}
[06:19:41] ❌    ❌ Failed to push order
[06:19:41] 🔄 
🔄 Step 7: Writing to CSV...
[06:19:41] [DOC: 9240073] ℹ️  Calculated age: 87 from DOB: 02/06/1938
[06:19:41] [DOC: 9240073] ℹ️  Service Line extracted: 'Hospice'
[06:19:41] [DOC: 9240073] ℹ️  Payer Source extracted: 'Medicare'
[06:19:41] [DOC: 9240073] ℹ️  Diagnosis codes being written:
[06:19:41] [DOC: 9240073] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:19:41] [DOC: 9240073] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:19:41] [DOC: 9240073] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:19:41] [DOC: 9240073] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:19:41] [DOC: 9240073] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:19:41] [DOC: 9240073] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:19:41] [DOC: 9240073] ✅ Patient data written to CSV: Patricia Lobo | Sex: FEMALE | Age: 87 | Service: Hospice | Payer: Medicare | MRN: 2406002
[06:19:41] ✅    ✅ Document 9240073 processed and saved successfully
[06:19:41] 🔄 
🔄 Step 8: Saving API details...
[06:19:41] [DOC: 9240073] ℹ️  API push details saved for document 9240073
[06:19:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240065                         ║
================================================================================
[06:19:41] ℹ️  Agency: Dartmouth HH
[06:19:41] ℹ️  Date: 04/15/2025
[06:19:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:19:42] [DOC: 9240065] ✅ Text extracted using pdfplumber (1088 chars)
[06:19:42] ✅    ✅ Text extracted using pdfplumber (1088 chars)
[06:19:42] 🔄 
🔄 Step 2: Extracting patient data...
[06:19:45] ℹ️  AI extracted raw sex value: 'M'
[06:19:45] ℹ️  AI extracted service line: 'HHA'
[06:19:45] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[06:19:45] ℹ️  AI extracted diagnoses:
[06:19:45] ℹ️    - Diagnosis 1: ''
[06:19:45] ℹ️    - Diagnosis 2: ''
[06:19:45] ℹ️    - Diagnosis 3: ''
[06:19:45] ℹ️    - Diagnosis 4: ''
[06:19:45] ℹ️    - Diagnosis 5: ''
[06:19:45] ℹ️    - Diagnosis 6: ''
[06:19:45] ℹ️  Final extracted MRN: '6278015'
[06:19:45] ℹ️  Final extracted Sex: 'MALE'
[06:19:45] ℹ️  Final extracted Service Line: 'HHA'
[06:19:45] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[06:19:45] ✅ Patient data extraction completed successfully
[06:19:45] ✅    ✅ Patient data extracted successfully
[06:19:45] 📊 Patient Response
     └─ patientFName: Joao
     └─ patientLName: Matias
     └─ dob: 04/20/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 6278015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:19:45] ✅    ✅ Patient identified: Joao Matias
[06:19:45] ✅    ✅ Patient name validation passed
[06:19:45] 🔄 
🔄 Step 3: Processing patient dates...
[06:19:45] [DOC: 9240065] ℹ️  DOB normalized: 04/20/1954
[06:19:45] [DOC: 9240065] ℹ️  Episode startOfCare normalized: 03/26/2025
[06:19:45] [DOC: 9240065] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[06:19:45] [DOC: 9240065] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[06:19:45] [DOC: 9240065] ✅ Patient date processing completed successfully
[06:19:45] ✅    ✅ Date processing completed
[06:19:45] 📊 Processed Patient Data
     └─ patientFName: Joao
     └─ patientLName: Matias
     └─ dob: 04/20/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 6278015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:19:45] 🔄 
🔄 Step 4: Extracting order data...
[06:19:47] ℹ️  Order extraction - MRN: ''
[06:19:47] ℹ️  Order extraction - Sex: 'MALE'
[06:19:47] ℹ️  Order extraction - Service Line: 'RN'
[06:19:47] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[06:19:47] ✅ Order data extraction completed successfully
[06:19:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:19:47] ℹ️  Using MRN from patient data: '6278015'
[06:19:47] ℹ️  Combined service lines: Patient='HHA' + Order='RN' = 'HHA, RN'
[06:19:47] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[06:19:47] ✅ Patient name cross-validation successful
[06:19:47] ✅    ✅ Data merged successfully
[06:19:49] ✅    ✅ Order data extracted and validated
[06:19:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:19:56] [DOC: 9240065] ✅ Patient exists in API: Joao Matias, ID: 162e9796-685d-41fc-9319-ed281e05db28
[06:19:56] ✅    ✅ Existing patient found with ID: 162e9796-685d-41fc-9319-ed281e05db28
[06:19:56] 🔄 
🔄 Step 6: Pushing order to API...
[06:19:56] [DOC: 9240065] ℹ️  Pushing order via API for patient ID: 162e9796-685d-41fc-9319-ed281e05db28
[06:19:57] [DOC: 9240065] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14043"}
[06:19:57] ❌    ❌ Failed to push order
[06:19:57] 🔄 
🔄 Step 7: Writing to CSV...
[06:19:57] [DOC: 9240065] ℹ️  Calculated age: 71 from DOB: 04/20/1954
[06:19:57] [DOC: 9240065] ℹ️  Service Line extracted: 'HHA, RN'
[06:19:57] [DOC: 9240065] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[06:19:57] [DOC: 9240065] ℹ️  Diagnosis codes being written:
[06:19:57] [DOC: 9240065] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:19:57] [DOC: 9240065] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:19:57] [DOC: 9240065] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:19:57] [DOC: 9240065] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:19:57] [DOC: 9240065] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:19:57] [DOC: 9240065] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:19:57] [DOC: 9240065] ✅ Patient data written to CSV: Joao Matias | Sex: MALE | Age: 71 | Service: HHA, RN | Payer: Blue Cross Medicare Adv | MRN: 6278015
[06:19:57] ✅    ✅ Document 9240065 processed and saved successfully
[06:19:57] 🔄 
🔄 Step 8: Saving API details...
[06:19:57] [DOC: 9240065] ℹ️  API push details saved for document 9240065
[06:19:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240064                         ║
================================================================================
[06:19:57] ℹ️  Agency: Dartmouth HH
[06:19:57] ℹ️  Date: 04/15/2025
[06:19:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:19:59] [DOC: 9240064] ✅ Text extracted using pdfplumber (1178 chars)
[06:19:59] ✅    ✅ Text extracted using pdfplumber (1178 chars)
[06:19:59] 🔄 
🔄 Step 2: Extracting patient data...
[06:20:02] ℹ️  AI extracted raw sex value: 'M'
[06:20:02] ℹ️  AI extracted service line: 'Physical Therapy'
[06:20:02] ℹ️  AI extracted payer source: 'Medicare'
[06:20:02] ℹ️  AI extracted diagnoses:
[06:20:02] ℹ️    - Diagnosis 1: 'None'
[06:20:02] ℹ️    - Diagnosis 2: 'None'
[06:20:02] ℹ️    - Diagnosis 3: 'None'
[06:20:02] ℹ️    - Diagnosis 4: 'None'
[06:20:02] ℹ️    - Diagnosis 5: 'None'
[06:20:02] ℹ️    - Diagnosis 6: 'None'
[06:20:02] ℹ️  Final extracted MRN: '1775015'
[06:20:02] ℹ️  Final extracted Sex: 'MALE'
[06:20:02] ℹ️  Final extracted Service Line: 'Physical Therapy'
[06:20:02] ℹ️  Final extracted Payer Source: 'Medicare'
[06:20:02] ✅ Patient data extraction completed successfully
[06:20:02] ✅    ✅ Patient data extracted successfully
[06:20:02] 📊 Patient Response
     └─ patientFName: Paul
     └─ patientLName: Cote
     └─ dob: 01/24/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 1775015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 40 Hope St
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:20:02] ✅    ✅ Patient identified: Paul Cote
[06:20:02] ✅    ✅ Patient name validation passed
[06:20:02] 🔄 
🔄 Step 3: Processing patient dates...
[06:20:02] [DOC: 9240064] ℹ️  DOB normalized: 01/24/1935
[06:20:02] [DOC: 9240064] ℹ️  Episode startOfCare normalized: 04/03/2025
[06:20:02] [DOC: 9240064] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[06:20:02] [DOC: 9240064] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[06:20:02] [DOC: 9240064] ✅ Patient date processing completed successfully
[06:20:02] ✅    ✅ Date processing completed
[06:20:02] 📊 Processed Patient Data
     └─ patientFName: Paul
     └─ patientLName: Cote
     └─ dob: 01/24/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 1775015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 40 Hope St
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025'}]
[06:20:02] 🔄 
🔄 Step 4: Extracting order data...
[06:20:04] ℹ️  Order extraction - MRN: ''
[06:20:04] ℹ️  Order extraction - Sex: 'MALE'
[06:20:04] ℹ️  Order extraction - Service Line: 'PT'
[06:20:04] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:20:04] ✅ Order data extraction completed successfully
[06:20:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:20:04] ℹ️  Using MRN from patient data: '1775015'
[06:20:04] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[06:20:04] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:20:04] ✅ Patient name cross-validation successful
[06:20:04] ✅    ✅ Data merged successfully
[06:20:06] ✅    ✅ Order data extracted and validated
[06:20:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:20:13] [DOC: 9240064] ✅ Patient exists in API: Paul Cote, ID: 79769d1b-a5bb-4355-bb8f-c1df91dbcc27
[06:20:13] ✅    ✅ Existing patient found with ID: 79769d1b-a5bb-4355-bb8f-c1df91dbcc27
[06:20:13] 🔄 
🔄 Step 6: Pushing order to API...
[06:20:13] [DOC: 9240064] ℹ️  Pushing order via API for patient ID: 79769d1b-a5bb-4355-bb8f-c1df91dbcc27
[06:20:14] [DOC: 9240064] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:20:14] ❌    ❌ Failed to push order
[06:20:14] 🔄 
🔄 Step 7: Writing to CSV...
[06:20:14] [DOC: 9240064] ℹ️  Calculated age: 90 from DOB: 01/24/1935
[06:20:14] [DOC: 9240064] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[06:20:14] [DOC: 9240064] ℹ️  Payer Source extracted: 'Medicare'
[06:20:14] [DOC: 9240064] ℹ️  Diagnosis codes being written:
[06:20:14] [DOC: 9240064] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:20:14] [DOC: 9240064] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:20:14] [DOC: 9240064] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:20:14] [DOC: 9240064] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:20:14] [DOC: 9240064] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:20:14] [DOC: 9240064] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:20:14] [DOC: 9240064] ✅ Patient data written to CSV: Paul Cote | Sex: MALE | Age: 90 | Service: PT, Physical Therapy | Payer: Medicare | MRN: 1775015
[06:20:14] ✅    ✅ Document 9240064 processed and saved successfully
[06:20:14] 🔄 
🔄 Step 8: Saving API details...
[06:20:14] [DOC: 9240064] ℹ️  API push details saved for document 9240064
[06:20:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240063                         ║
================================================================================
[06:20:14] ℹ️  Agency: Dartmouth HH
[06:20:14] ℹ️  Date: 04/15/2025
[06:20:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:20:16] [DOC: 9240063] ✅ Text extracted using pdfplumber (1054 chars)
[06:20:16] ✅    ✅ Text extracted using pdfplumber (1054 chars)
[06:20:16] 🔄 
🔄 Step 2: Extracting patient data...
[06:20:19] ℹ️  AI extracted raw sex value: 'M'
[06:20:19] ℹ️  AI extracted service line: 'MSW'
[06:20:19] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[06:20:19] ℹ️  AI extracted diagnoses:
[06:20:19] ℹ️    - Diagnosis 1: ''
[06:20:19] ℹ️    - Diagnosis 2: ''
[06:20:19] ℹ️    - Diagnosis 3: ''
[06:20:19] ℹ️    - Diagnosis 4: ''
[06:20:19] ℹ️    - Diagnosis 5: ''
[06:20:19] ℹ️    - Diagnosis 6: ''
[06:20:19] ℹ️  Final extracted MRN: '6348015'
[06:20:19] ℹ️  Final extracted Sex: 'MALE'
[06:20:19] ℹ️  Final extracted Service Line: 'MSW'
[06:20:19] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[06:20:19] ✅ Patient data extraction completed successfully
[06:20:19] ✅    ✅ Patient data extracted successfully
[06:20:19] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Teixeira
     └─ dob: 12/29/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 6348015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:20:19] ✅    ✅ Patient identified: David Teixeira
[06:20:19] ✅    ✅ Patient name validation passed
[06:20:19] 🔄 
🔄 Step 3: Processing patient dates...
[06:20:19] [DOC: 9240063] ℹ️  DOB normalized: 12/29/1956
[06:20:19] [DOC: 9240063] ℹ️  Episode startOfCare normalized: 04/08/2025
[06:20:19] [DOC: 9240063] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[06:20:19] [DOC: 9240063] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[06:20:19] [DOC: 9240063] ✅ Patient date processing completed successfully
[06:20:19] ✅    ✅ Date processing completed
[06:20:19] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Teixeira
     └─ dob: 12/29/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 6348015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:20:19] 🔄 
🔄 Step 4: Extracting order data...
[06:20:21] ℹ️  Order extraction - MRN: '6348015'
[06:20:21] ℹ️  Order extraction - Sex: 'MALE'
[06:20:21] ℹ️  Order extraction - Service Line: 'MSW'
[06:20:21] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[06:20:21] ✅ Order data extraction completed successfully
[06:20:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:20:21] ℹ️  Using MRN from patient data: '6348015' over '6348015'
[06:20:21] ℹ️  Service line consistent in both sources: 'MSW'
[06:20:21] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[06:20:21] ✅ Patient name cross-validation successful
[06:20:21] ✅    ✅ Data merged successfully
[06:20:22] ✅    ✅ Order data extracted and validated
[06:20:22] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:20:22] [DOC: 9240063] ✅ Patient found in local cache: David Teixeira, ID: 92d56142-8dce-415a-ac6f-6020de943b51
[06:20:22] ✅    ✅ Existing patient found with ID: 92d56142-8dce-415a-ac6f-6020de943b51
[06:20:22] 🔄 
🔄 Step 6: Pushing order to API...
[06:20:22] [DOC: 9240063] ℹ️  Pushing order via API for patient ID: 92d56142-8dce-415a-ac6f-6020de943b51
[06:20:23] [DOC: 9240063] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:20:23] ❌    ❌ Failed to push order
[06:20:23] 🔄 
🔄 Step 7: Writing to CSV...
[06:20:23] [DOC: 9240063] ℹ️  Calculated age: 68 from DOB: 12/29/1956
[06:20:23] [DOC: 9240063] ℹ️  Service Line extracted: 'MSW'
[06:20:23] [DOC: 9240063] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[06:20:23] [DOC: 9240063] ℹ️  Diagnosis codes being written:
[06:20:23] [DOC: 9240063] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:20:23] [DOC: 9240063] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:20:23] [DOC: 9240063] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:20:23] [DOC: 9240063] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:20:23] [DOC: 9240063] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:20:23] [DOC: 9240063] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:20:23] [DOC: 9240063] ✅ Patient data written to CSV: David Teixeira | Sex: MALE | Age: 68 | Service: MSW | Payer: Blue Cross Blue Shield | MRN: 6348015
[06:20:23] ✅    ✅ Document 9240063 processed and saved successfully
[06:20:23] 🔄 
🔄 Step 8: Saving API details...
[06:20:23] [DOC: 9240063] ℹ️  API push details saved for document 9240063
[06:20:23] ✅    ✅ API details saved
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[06:20:23] ℹ️  Total Processed: 100
[06:20:23] ℹ️  CSV Success: 67
[06:20:23] ℹ️  CSV Errors: 8
[06:20:23] ℹ️  API Success: 0
[06:20:23] ℹ️  API Errors: 92
[06:20:23] ℹ️  CSV Success Rate: 67.0%
[06:20:23] ℹ️  API Success Rate: 0.0%
[06:20:23] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250608_055205.csv
[06:20:23] ℹ️  API Details File: api_outputs/api_push_details_20250608_055205.csv
================================================================================
║          ============================================================          ║
================================================================================
