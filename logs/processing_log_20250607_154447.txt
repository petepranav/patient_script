================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[15:44:47] ℹ️  CSV Data Extraction & API Push Tool
[15:44:47] ℹ️  
[15:44:47] ℹ️  Features:
[15:44:47] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[15:44:47] ℹ️  - AI-powered patient and order data extraction
[15:44:47] ℹ️  - Enhanced error handling and logging
[15:44:47] ℹ️  - Full API integration (patient creation + order pushing)
[15:44:47] ℹ️  - CSV output with comprehensive patient data
[15:44:47] ℹ️  - Detailed API tracking with remarks for every document
[15:44:47] ℹ️  - Complete audit trail of all processing attempts
[15:44:47] ℹ️  
[15:44:47] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[15:44:47] ✅ Created output CSV file: csv_outputs/extracted_patients_20250607_154447.csv
[15:44:47] ✅ Created API details CSV file: api_outputs/api_push_details_20250607_154447.csv
================================================================================
║                        Processing Document ID: 9266606                         ║
================================================================================
[15:44:47] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[15:44:47] ℹ️  Date: 04/29/2025
[15:44:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:44:50] [DOC: 9266606] ✅ Text extracted using pdfplumber (3595 chars)
[15:44:50] ✅    ✅ Text extracted using pdfplumber (3595 chars)
[15:44:50] 🔄 
🔄 Step 2: Extracting patient data...
[15:44:54] ℹ️  AI extracted raw sex value: 'M'
[15:44:54] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:44:54] ℹ️  AI extracted payer source: 'Medicaid/MA'
[15:44:54] ℹ️  AI extracted diagnoses:
[15:44:54] ℹ️    - Diagnosis 1: 'E11.43'
[15:44:54] ℹ️    - Diagnosis 2: 'K31.84'
[15:44:54] ℹ️    - Diagnosis 3: 'K59.89'
[15:44:54] ℹ️    - Diagnosis 4: 'F20.0'
[15:44:54] ℹ️    - Diagnosis 5: 'I10'
[15:44:54] ℹ️    - Diagnosis 6: 'E66.01'
[15:44:54] ℹ️  Final extracted MRN: '457'
[15:44:54] ℹ️  Final extracted Sex: 'MALE'
[15:44:54] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:44:54] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[15:44:54] ✅ Patient data extraction completed successfully
[15:44:54] ✅    ✅ Patient data extracted successfully
[15:44:54] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2024', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'E11.43', 'secondDiagnosis': 'K31.84', 'thirdDiagnosis': 'K59.89', 'fourthDiagnosis': 'F20.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E66.01'}]
[15:44:54] ✅    ✅ Patient identified: Manuel Varela
[15:44:54] ✅    ✅ Patient name validation passed
[15:44:54] 🔄 
🔄 Step 3: Processing patient dates...
[15:44:54] [DOC: 9266606] ℹ️  DOB normalized: 02/08/1969
[15:44:54] [DOC: 9266606] ℹ️  Episode startOfCare normalized: 11/07/2024
[15:44:54] [DOC: 9266606] ℹ️  Episode startOfEpisode normalized: 11/07/2024
[15:44:54] [DOC: 9266606] ℹ️  Episode endOfEpisode normalized: 05/05/2025
[15:44:54] [DOC: 9266606] ✅ Patient date processing completed successfully
[15:44:54] ✅    ✅ Date processing completed
[15:44:54] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Varela
     └─ dob: 02/08/1969
     └─ patientSex: MALE
     └─ medicalRecordNo: 457
     └─ billingProvider: Guardian Home Health Care, LLC
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '11/07/2024', 'startOfEpisode': '11/07/2024', 'endOfEpisode': '05/05/2025', 'firstDiagnosis': 'E11.43', 'secondDiagnosis': 'K31.84', 'thirdDiagnosis': 'K59.89', 'fourthDiagnosis': 'F20.0', 'fifthDiagnosis': 'I10', 'sixthDiagnosis': 'E66.01'}]
[15:44:54] 🔄 
🔄 Step 4: Extracting order data...
[15:44:57] ℹ️  Order extraction - MRN: '457'
[15:44:57] ℹ️  Order extraction - Sex: 'MALE'
[15:44:57] ℹ️  Order extraction - Service Line: 'RN'
[15:44:57] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[15:44:57] ✅ Order data extraction completed successfully
[15:44:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:44:57] ℹ️  Using MRN from patient data: '457' over '457'
[15:44:57] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[15:44:57] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[15:44:57] ✅ Patient name cross-validation successful
[15:44:57] ✅    ✅ Data merged successfully
[15:44:58] ✅    ✅ Order data extracted and validated
[15:44:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:44:58] [DOC: 9266606] ✅ Patient found in local cache: Manuel Varela, ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[15:44:58] ✅    ✅ Existing patient found with ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[15:44:58] 🔄 
🔄 Step 6: Pushing order to API...
[15:44:58] [DOC: 9266606] ℹ️  Pushing order via API for patient ID: 6ec91961-51c9-48ba-b65d-0c658baaac01
[15:44:59] [DOC: 9266606] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:44:59] ❌    ❌ Failed to push order
[15:44:59] 🔄 
🔄 Step 7: Writing to CSV...
[15:44:59] [DOC: 9266606] ℹ️  Calculated age: 56 from DOB: 02/08/1969
[15:44:59] [DOC: 9266606] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[15:44:59] [DOC: 9266606] ℹ️  Payer Source extracted: 'Medicaid/MA'
[15:44:59] [DOC: 9266606] ℹ️  Diagnosis codes being written:
[15:44:59] [DOC: 9266606] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.43'
[15:44:59] [DOC: 9266606] ℹ️    - Latest_Episode_Seconddiagnosis: 'K31.84'
[15:44:59] [DOC: 9266606] ℹ️    - Latest_Episode_Thirddiagnosis: 'K59.89'
[15:44:59] [DOC: 9266606] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F20.0'
[15:44:59] [DOC: 9266606] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I10'
[15:44:59] [DOC: 9266606] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E66.01'
[15:44:59] [DOC: 9266606] ✅ Patient data written to CSV: Manuel Varela | Sex: MALE | Age: 56 | Service: RN, Skilled Nursing | Payer: Medicaid/MA | MRN: 457
[15:44:59] ✅    ✅ Document 9266606 processed and saved successfully
[15:44:59] 🔄 
🔄 Step 8: Saving API details...
[15:44:59] [DOC: 9266606] ℹ️  API push details saved for document 9266606
[15:44:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266597                         ║
================================================================================
[15:44:59] ℹ️  Agency: Fairhaven HH&H
[15:44:59] ℹ️  Date: 04/29/2025
[15:44:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:45:01] [DOC: 9266597] ✅ Text extracted using pdfplumber (1164 chars)
[15:45:01] ✅    ✅ Text extracted using pdfplumber (1164 chars)
[15:45:01] 🔄 
🔄 Step 2: Extracting patient data...
[15:45:04] ℹ️  AI extracted raw sex value: 'F'
[15:45:04] ℹ️  AI extracted service line: 'MSW'
[15:45:04] ℹ️  AI extracted payer source: 'Medicare'
[15:45:04] ℹ️  AI extracted diagnoses:
[15:45:04] ℹ️    - Diagnosis 1: 'None'
[15:45:04] ℹ️    - Diagnosis 2: 'None'
[15:45:04] ℹ️    - Diagnosis 3: 'None'
[15:45:04] ℹ️    - Diagnosis 4: 'None'
[15:45:04] ℹ️    - Diagnosis 5: 'None'
[15:45:04] ℹ️    - Diagnosis 6: 'None'
[15:45:04] ℹ️  Final extracted MRN: '4758015'
[15:45:04] ℹ️  Final extracted Sex: 'FEMALE'
[15:45:04] ℹ️  Final extracted Service Line: 'MSW'
[15:45:04] ℹ️  Final extracted Payer Source: 'Medicare'
[15:45:04] ✅ Patient data extraction completed successfully
[15:45:04] ✅    ✅ Patient data extracted successfully
[15:45:04] 📊 Patient Response
     └─ patientFName: Beverly
     └─ patientLName: Sylvia
     └─ dob: 03/21/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4758015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/13/2024', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:45:04] ✅    ✅ Patient identified: Beverly Sylvia
[15:45:04] ✅    ✅ Patient name validation passed
[15:45:04] 🔄 
🔄 Step 3: Processing patient dates...
[15:45:04] [DOC: 9266597] ℹ️  DOB normalized: 03/21/1937
[15:45:04] [DOC: 9266597] ℹ️  Episode startOfCare normalized: 06/13/2024
[15:45:04] [DOC: 9266597] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[15:45:04] [DOC: 9266597] ℹ️  Episode endOfEpisode normalized: 06/07/2025
[15:45:04] [DOC: 9266597] ✅ Patient date processing completed successfully
[15:45:04] ✅    ✅ Date processing completed
[15:45:04] 📊 Processed Patient Data
     └─ patientFName: Beverly
     └─ patientLName: Sylvia
     └─ dob: 03/21/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4758015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/13/2024', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025'}]
[15:45:04] 🔄 
🔄 Step 4: Extracting order data...
[15:45:06] ℹ️  Order extraction - MRN: ''
[15:45:06] ℹ️  Order extraction - Sex: 'FEMALE'
[15:45:06] ℹ️  Order extraction - Service Line: 'MSW'
[15:45:06] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:45:06] ✅ Order data extraction completed successfully
[15:45:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:45:06] ℹ️  Using MRN from patient data: '4758015'
[15:45:06] ℹ️  Service line consistent in both sources: 'MSW'
[15:45:06] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:45:06] ✅ Patient name cross-validation successful
[15:45:06] ✅    ✅ Data merged successfully
[15:45:07] ✅    ✅ Order data extracted and validated
[15:45:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:45:15] [DOC: 9266597] ℹ️  Patient not found in cache or API: Beverly Sylvia
[15:45:15] [DOC: 9266597] ℹ️  Patient not found, creating new patient via API...
[15:45:15] [DOC: 9266597] ℹ️  Creating patient via API: Beverly Sylvia
[15:45:16] [DOC: 9266597] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:45:16] ❌    ❌ Failed to create patient
[15:45:16] [DOC: 9266597] ℹ️  API push details saved for document 9266597
================================================================================
║                        Processing Document ID: 9266591                         ║
================================================================================
[15:45:16] ℹ️  Agency: Fairhaven HH&H
[15:45:16] ℹ️  Date: 04/29/2025
[15:45:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:45:18] [DOC: 9266591] ✅ Text extracted using pdfplumber (2885 chars)
[15:45:18] ✅    ✅ Text extracted using pdfplumber (2885 chars)
[15:45:18] 🔄 
🔄 Step 2: Extracting patient data...
[15:45:20] ℹ️  AI extracted raw sex value: 'M'
[15:45:20] ℹ️  AI extracted service line: 'Skilled Nursing, HHA'
[15:45:20] ℹ️  AI extracted payer source: 'Medicare'
[15:45:20] ℹ️  AI extracted diagnoses:
[15:45:20] ℹ️    - Diagnosis 1: 'None'
[15:45:20] ℹ️    - Diagnosis 2: 'None'
[15:45:20] ℹ️    - Diagnosis 3: 'None'
[15:45:20] ℹ️    - Diagnosis 4: 'None'
[15:45:20] ℹ️    - Diagnosis 5: 'None'
[15:45:20] ℹ️    - Diagnosis 6: 'None'
[15:45:20] ℹ️  Final extracted MRN: '5021009'
[15:45:20] ℹ️  Final extracted Sex: 'MALE'
[15:45:20] ℹ️  Final extracted Service Line: 'Skilled Nursing, HHA'
[15:45:20] ℹ️  Final extracted Payer Source: 'Medicare'
[15:45:20] ✅ Patient data extraction completed successfully
[15:45:20] ✅    ✅ Patient data extracted successfully
[15:45:20] 📊 Patient Response
     └─ patientFName: William
     └─ patientLName: Hughes
     └─ dob: 07/10/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 5021009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/20/2024', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:45:20] ✅    ✅ Patient identified: William Hughes
[15:45:20] ✅    ✅ Patient name validation passed
[15:45:20] 🔄 
🔄 Step 3: Processing patient dates...
[15:45:20] [DOC: 9266591] ℹ️  DOB normalized: 07/10/1937
[15:45:20] [DOC: 9266591] ℹ️  Episode startOfCare normalized: 11/20/2024
[15:45:20] [DOC: 9266591] ℹ️  Episode startOfEpisode normalized: 02/18/2025
[15:45:20] [DOC: 9266591] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[15:45:20] [DOC: 9266591] ✅ Patient date processing completed successfully
[15:45:20] ✅    ✅ Date processing completed
[15:45:20] 📊 Processed Patient Data
     └─ patientFName: William
     └─ patientLName: Hughes
     └─ dob: 07/10/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 5021009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/20/2024', 'startOfEpisode': '02/18/2025', 'endOfEpisode': '05/18/2025'}]
[15:45:20] 🔄 
🔄 Step 4: Extracting order data...
[15:45:23] ℹ️  Order extraction - MRN: ''
[15:45:23] ℹ️  Order extraction - Sex: 'MALE'
[15:45:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing, HHA'
[15:45:23] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:45:23] ✅ Order data extraction completed successfully
[15:45:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:45:23] ℹ️  Using MRN from patient data: '5021009'
[15:45:23] ℹ️  Service line consistent in both sources: 'Skilled Nursing, HHA'
[15:45:23] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:45:23] ✅ Patient name cross-validation successful
[15:45:23] ✅    ✅ Data merged successfully
[15:45:24] ✅    ✅ Order data extracted and validated
[15:45:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:45:31] [DOC: 9266591] ℹ️  Patient not found in cache or API: William Hughes
[15:45:31] [DOC: 9266591] ℹ️  Patient not found, creating new patient via API...
[15:45:31] [DOC: 9266591] ℹ️  Creating patient via API: William Hughes
[15:45:32] [DOC: 9266591] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:45:32] ❌    ❌ Failed to create patient
[15:45:32] [DOC: 9266591] ℹ️  API push details saved for document 9266591
================================================================================
║                        Processing Document ID: 9266589                         ║
================================================================================
[15:45:32] ℹ️  Agency: Fairhaven HH&H
[15:45:32] ℹ️  Date: 04/29/2025
[15:45:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:45:34] [DOC: 9266589] ✅ Text extracted using pdfplumber (1144 chars)
[15:45:34] ✅    ✅ Text extracted using pdfplumber (1144 chars)
[15:45:34] 🔄 
🔄 Step 2: Extracting patient data...
[15:45:37] ℹ️  AI extracted raw sex value: 'M'
[15:45:37] ℹ️  AI extracted service line: 'Hospice'
[15:45:37] ℹ️  AI extracted payer source: 'Medicare'
[15:45:37] ℹ️  AI extracted diagnoses:
[15:45:37] ℹ️    - Diagnosis 1: ''
[15:45:37] ℹ️    - Diagnosis 2: ''
[15:45:37] ℹ️    - Diagnosis 3: ''
[15:45:37] ℹ️    - Diagnosis 4: ''
[15:45:37] ℹ️    - Diagnosis 5: ''
[15:45:37] ℹ️    - Diagnosis 6: ''
[15:45:37] ℹ️  Final extracted MRN: '5307015'
[15:45:37] ℹ️  Final extracted Sex: 'MALE'
[15:45:37] ℹ️  Final extracted Service Line: 'Hospice'
[15:45:37] ℹ️  Final extracted Payer Source: 'Medicare'
[15:45:37] ✅ Patient data extraction completed successfully
[15:45:37] ✅    ✅ Patient data extracted successfully
[15:45:37] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Rego
     └─ dob: 01/29/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 5307015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/04/2024', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:45:37] ✅    ✅ Patient identified: John Rego
[15:45:37] ✅    ✅ Patient name validation passed
[15:45:37] 🔄 
🔄 Step 3: Processing patient dates...
[15:45:37] [DOC: 9266589] ℹ️  DOB normalized: 01/29/1954
[15:45:37] [DOC: 9266589] ℹ️  Episode startOfCare normalized: 11/04/2024
[15:45:37] [DOC: 9266589] ℹ️  Episode startOfEpisode normalized: 02/02/2025
[15:45:37] [DOC: 9266589] ℹ️  Episode endOfEpisode normalized: 05/02/2025
[15:45:37] [DOC: 9266589] ✅ Patient date processing completed successfully
[15:45:37] ✅    ✅ Date processing completed
[15:45:37] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Rego
     └─ dob: 01/29/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 5307015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Hospice
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/04/2024', 'startOfEpisode': '02/02/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:45:37] 🔄 
🔄 Step 4: Extracting order data...
[15:45:39] ℹ️  Order extraction - MRN: ''
[15:45:39] ℹ️  Order extraction - Sex: 'MALE'
[15:45:39] ℹ️  Order extraction - Service Line: 'HOSPICE'
[15:45:39] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:45:39] ✅ Order data extraction completed successfully
[15:45:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:45:39] ℹ️  Using MRN from patient data: '5307015'
[15:45:39] ℹ️  Service line consistent in both sources: 'Hospice'
[15:45:39] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:45:39] ✅ Patient name cross-validation successful
[15:45:39] ✅    ✅ Data merged successfully
[15:45:41] ✅    ✅ Order data extracted and validated
[15:45:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:45:45] [DOC: 9266589] ✅ Patient exists in API: John Rego, ID: f859c662-8494-4fdb-afc7-7778dac118bf
[15:45:45] ✅    ✅ Existing patient found with ID: f859c662-8494-4fdb-afc7-7778dac118bf
[15:45:45] 🔄 
🔄 Step 6: Pushing order to API...
[15:45:45] [DOC: 9266589] ℹ️  Pushing order via API for patient ID: f859c662-8494-4fdb-afc7-7778dac118bf
[15:45:46] [DOC: 9266589] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:45:46] ❌    ❌ Failed to push order
[15:45:46] 🔄 
🔄 Step 7: Writing to CSV...
[15:45:46] [DOC: 9266589] ℹ️  Calculated age: 71 from DOB: 01/29/1954
[15:45:46] [DOC: 9266589] ℹ️  Service Line extracted: 'Hospice'
[15:45:46] [DOC: 9266589] ℹ️  Payer Source extracted: 'Medicare'
[15:45:46] [DOC: 9266589] ℹ️  Diagnosis codes being written:
[15:45:46] [DOC: 9266589] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:45:46] [DOC: 9266589] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:45:46] [DOC: 9266589] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:45:46] [DOC: 9266589] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:45:46] [DOC: 9266589] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:45:46] [DOC: 9266589] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:45:46] [DOC: 9266589] ✅ Patient data written to CSV: John Rego | Sex: MALE | Age: 71 | Service: Hospice | Payer: Medicare | MRN: 5307015
[15:45:46] ✅    ✅ Document 9266589 processed and saved successfully
[15:45:46] 🔄 
🔄 Step 8: Saving API details...
[15:45:46] [DOC: 9266589] ℹ️  API push details saved for document 9266589
[15:45:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266561                         ║
================================================================================
[15:45:46] ℹ️  Agency: Dartmouth HH
[15:45:46] ℹ️  Date: 04/29/2025
[15:45:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:45:49] [DOC: 9266561] ✅ Text extracted using pdfplumber (14317 chars)
[15:45:49] ✅    ✅ Text extracted using pdfplumber (14317 chars)
[15:45:49] 🔄 
🔄 Step 2: Extracting patient data...
[15:45:52] ℹ️  AI extracted raw sex value: 'F'
[15:45:52] ℹ️  AI extracted service line: 'PT, RN'
[15:45:52] ℹ️  AI extracted payer source: 'None'
[15:45:52] ℹ️  AI extracted diagnoses:
[15:45:52] ℹ️    - Diagnosis 1: 'M17.12'
[15:45:52] ℹ️    - Diagnosis 2: 'M16.0'
[15:45:52] ℹ️    - Diagnosis 3: 'M47.812'
[15:45:52] ℹ️    - Diagnosis 4: 'R26.81'
[15:45:52] ℹ️    - Diagnosis 5: 'M47.816'
[15:45:52] ℹ️    - Diagnosis 6: 'R25.1'
[15:45:52] ℹ️  Final extracted MRN: '227027'
[15:45:52] ℹ️  Final extracted Sex: 'FEMALE'
[15:45:52] ℹ️  Final extracted Service Line: 'PT, RN'
[15:45:52] ℹ️  Final extracted Payer Source: ''
[15:45:52] ✅ Patient data extraction completed successfully
[15:45:52] ✅    ✅ Patient data extracted successfully
[15:45:52] 📊 Patient Response
     └─ patientFName: Claudia
     └─ patientLName: McCarthy
     └─ dob: 01/14/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/15/2025', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'M17.12', 'secondDiagnosis': 'M16.0', 'thirdDiagnosis': 'M47.812', 'fourthDiagnosis': 'R26.81', 'fifthDiagnosis': 'M47.816', 'sixthDiagnosis': 'R25.1'}]
[15:45:52] ✅    ✅ Patient identified: Claudia McCarthy
[15:45:52] ✅    ✅ Patient name validation passed
[15:45:52] 🔄 
🔄 Step 3: Processing patient dates...
[15:45:52] [DOC: 9266561] ℹ️  DOB normalized: 01/14/1947
[15:45:52] [DOC: 9266561] ℹ️  Episode startOfCare normalized: 04/15/2025
[15:45:52] [DOC: 9266561] ℹ️  Episode startOfEpisode normalized: 04/15/2025
[15:45:52] [DOC: 9266561] ℹ️  Episode endOfEpisode normalized: 06/13/2025
[15:45:52] [DOC: 9266561] ✅ Patient date processing completed successfully
[15:45:52] ✅    ✅ Date processing completed
[15:45:52] 📊 Processed Patient Data
     └─ patientFName: Claudia
     └─ patientLName: McCarthy
     └─ dob: 01/14/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/15/2025', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'M17.12', 'secondDiagnosis': 'M16.0', 'thirdDiagnosis': 'M47.812', 'fourthDiagnosis': 'R26.81', 'fifthDiagnosis': 'M47.816', 'sixthDiagnosis': 'R25.1'}]
[15:45:52] 🔄 
🔄 Step 4: Extracting order data...
[15:45:55] ℹ️  Order extraction - MRN: '227027'
[15:45:55] ℹ️  Order extraction - Sex: 'FEMALE'
[15:45:55] ℹ️  Order extraction - Service Line: 'PT, RN'
[15:45:55] ℹ️  Order extraction - Payer Source: ''
[15:45:55] ✅ Order data extraction completed successfully
[15:45:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:45:55] ℹ️  Using MRN from patient data: '227027' over '227027'
[15:45:55] ℹ️  Service line consistent in both sources: 'PT, RN'
[15:45:55] ✅ Patient name cross-validation successful
[15:45:55] ✅    ✅ Data merged successfully
[15:45:56] ✅    ✅ Order data extracted and validated
[15:45:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:46:09] [DOC: 9266561] ✅ Patient exists in API: Claudia McCarthy, ID: 391b69ab-d769-4c68-aadb-1b6ce3b39ced
[15:46:09] ✅    ✅ Existing patient found with ID: 391b69ab-d769-4c68-aadb-1b6ce3b39ced
[15:46:09] 🔄 
🔄 Step 6: Pushing order to API...
[15:46:09] [DOC: 9266561] ℹ️  Pushing order via API for patient ID: 391b69ab-d769-4c68-aadb-1b6ce3b39ced
[15:46:10] [DOC: 9266561] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:46:10] ❌    ❌ Failed to push order
[15:46:10] 🔄 
🔄 Step 7: Writing to CSV...
[15:46:10] [DOC: 9266561] ℹ️  Calculated age: 78 from DOB: 01/14/1947
[15:46:10] [DOC: 9266561] ℹ️  Service Line extracted: 'PT, RN'
[15:46:10] [DOC: 9266561] ℹ️  Payer Source extracted: ''
[15:46:10] [DOC: 9266561] ℹ️  Diagnosis codes being written:
[15:46:10] [DOC: 9266561] ℹ️    - Latest_Episode_Firstdiagnosis: 'M17.12'
[15:46:10] [DOC: 9266561] ℹ️    - Latest_Episode_Seconddiagnosis: 'M16.0'
[15:46:10] [DOC: 9266561] ℹ️    - Latest_Episode_Thirddiagnosis: 'M47.812'
[15:46:10] [DOC: 9266561] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R26.81'
[15:46:10] [DOC: 9266561] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M47.816'
[15:46:10] [DOC: 9266561] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R25.1'
[15:46:10] [DOC: 9266561] ✅ Patient data written to CSV: Claudia McCarthy | Sex: FEMALE | Age: 78 | Service: PT, RN | Payer:  | MRN: 227027
[15:46:10] ✅    ✅ Document 9266561 processed and saved successfully
[15:46:10] 🔄 
🔄 Step 8: Saving API details...
[15:46:10] [DOC: 9266561] ℹ️  API push details saved for document 9266561
[15:46:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266550                         ║
================================================================================
[15:46:10] ℹ️  Agency: Dartmouth HH
[15:46:10] ℹ️  Date: 04/29/2025
[15:46:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:46:13] [DOC: 9266550] ✅ Text extracted using pdfplumber (5839 chars)
[15:46:13] ✅    ✅ Text extracted using pdfplumber (5839 chars)
[15:46:13] 🔄 
🔄 Step 2: Extracting patient data...
[15:46:16] ℹ️  AI extracted raw sex value: 'F'
[15:46:16] ℹ️  AI extracted service line: 'PT'
[15:46:16] ℹ️  AI extracted payer source: 'Medicare'
[15:46:16] ℹ️  AI extracted diagnoses:
[15:46:16] ℹ️    - Diagnosis 1: 'PNA'
[15:46:16] ℹ️    - Diagnosis 2: 'PE'
[15:46:16] ℹ️    - Diagnosis 3: 'CHF'
[15:46:16] ℹ️    - Diagnosis 4: 'anemia'
[15:46:16] ℹ️    - Diagnosis 5: 'GI bleed'
[15:46:16] ℹ️    - Diagnosis 6: 'seizure'
[15:46:16] ℹ️  Final extracted MRN: '771002'
[15:46:16] ℹ️  Final extracted Sex: 'FEMALE'
[15:46:16] ℹ️  Final extracted Service Line: 'PT'
[15:46:16] ℹ️  Final extracted Payer Source: 'Medicare'
[15:46:16] ✅ Patient data extraction completed successfully
[15:46:16] ✅    ✅ Patient data extracted successfully
[15:46:16] 📊 Patient Response
     └─ patientFName: Kathryn
     └─ patientLName: McCollester
     └─ dob: 09/24/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 771002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/17/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'PNA', 'secondDiagnosis': 'PE', 'thirdDiagnosis': 'CHF', 'fourthDiagnosis': 'anemia', 'fifthDiagnosis': 'GI bleed', 'sixthDiagnosis': 'seizure'}]
[15:46:16] ✅    ✅ Patient identified: Kathryn McCollester
[15:46:16] ✅    ✅ Patient name validation passed
[15:46:16] 🔄 
🔄 Step 3: Processing patient dates...
[15:46:16] [DOC: 9266550] ℹ️  DOB normalized: 09/24/1930
[15:46:16] [DOC: 9266550] ℹ️  Episode startOfCare normalized: 02/17/2025
[15:46:16] [DOC: 9266550] ℹ️  Episode startOfEpisode normalized: 04/18/2025
[15:46:16] [DOC: 9266550] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[15:46:16] [DOC: 9266550] ✅ Patient date processing completed successfully
[15:46:16] ✅    ✅ Date processing completed
[15:46:16] 📊 Processed Patient Data
     └─ patientFName: Kathryn
     └─ patientLName: McCollester
     └─ dob: 09/24/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 771002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/17/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'PNA', 'secondDiagnosis': 'PE', 'thirdDiagnosis': 'CHF', 'fourthDiagnosis': 'anemia', 'fifthDiagnosis': 'GI bleed', 'sixthDiagnosis': 'seizure'}]
[15:46:16] 🔄 
🔄 Step 4: Extracting order data...
[15:46:18] ℹ️  Order extraction - MRN: ''
[15:46:18] ℹ️  Order extraction - Sex: 'FEMALE'
[15:46:18] ℹ️  Order extraction - Service Line: 'PT'
[15:46:18] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:46:18] ✅ Order data extraction completed successfully
[15:46:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:46:18] ℹ️  Using MRN from patient data: '771002'
[15:46:18] ℹ️  Service line consistent in both sources: 'PT'
[15:46:18] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:46:18] ✅ Patient name cross-validation successful
[15:46:18] ✅    ✅ Data merged successfully
[15:46:19] ✅    ✅ Order data extracted and validated
[15:46:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:46:37] [DOC: 9266550] ✅ Patient exists in API: Kathryn McCollester, ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[15:46:37] ✅    ✅ Existing patient found with ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[15:46:37] 🔄 
🔄 Step 6: Pushing order to API...
[15:46:37] [DOC: 9266550] ℹ️  Pushing order via API for patient ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[15:46:38] [DOC: 9266550] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:46:38] ❌    ❌ Failed to push order
[15:46:38] 🔄 
🔄 Step 7: Writing to CSV...
[15:46:38] [DOC: 9266550] ℹ️  Calculated age: 94 from DOB: 09/24/1930
[15:46:38] [DOC: 9266550] ℹ️  Service Line extracted: 'PT'
[15:46:38] [DOC: 9266550] ℹ️  Payer Source extracted: 'Medicare'
[15:46:38] [DOC: 9266550] ℹ️  Diagnosis codes being written:
[15:46:38] [DOC: 9266550] ℹ️    - Latest_Episode_Firstdiagnosis: 'PNA'
[15:46:38] [DOC: 9266550] ℹ️    - Latest_Episode_Seconddiagnosis: 'PE'
[15:46:38] [DOC: 9266550] ℹ️    - Latest_Episode_Thirddiagnosis: 'CHF'
[15:46:38] [DOC: 9266550] ℹ️    - Latest_Episode_Fourthdiagnosis: 'anemia'
[15:46:38] [DOC: 9266550] ℹ️    - Latest_Episode_Fifthdiagnosis: 'GI bleed'
[15:46:38] [DOC: 9266550] ℹ️    - Latest_Episode_Sixthdiagnosis: 'seizure'
[15:46:38] [DOC: 9266550] ✅ Patient data written to CSV: Kathryn McCollester | Sex: FEMALE | Age: 94 | Service: PT | Payer: Medicare | MRN: 771002
[15:46:38] ✅    ✅ Document 9266550 processed and saved successfully
[15:46:38] 🔄 
🔄 Step 8: Saving API details...
[15:46:38] [DOC: 9266550] ℹ️  API push details saved for document 9266550
[15:46:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266541                         ║
================================================================================
[15:46:38] ℹ️  Agency: Dartmouth HH
[15:46:38] ℹ️  Date: 04/29/2025
[15:46:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:46:40] [DOC: 9266541] ✅ Text extracted using pdfplumber (1137 chars)
[15:46:40] ✅    ✅ Text extracted using pdfplumber (1137 chars)
[15:46:40] 🔄 
🔄 Step 2: Extracting patient data...
[15:46:42] ℹ️  AI extracted raw sex value: 'M'
[15:46:42] ℹ️  AI extracted service line: 'OT'
[15:46:42] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[15:46:42] ℹ️  AI extracted diagnoses:
[15:46:42] ℹ️    - Diagnosis 1: ''
[15:46:42] ℹ️    - Diagnosis 2: ''
[15:46:42] ℹ️    - Diagnosis 3: ''
[15:46:42] ℹ️    - Diagnosis 4: ''
[15:46:42] ℹ️    - Diagnosis 5: ''
[15:46:42] ℹ️    - Diagnosis 6: ''
[15:46:42] ℹ️  Final extracted MRN: '551011'
[15:46:42] ℹ️  Final extracted Sex: 'MALE'
[15:46:42] ℹ️  Final extracted Service Line: 'OT'
[15:46:42] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[15:46:42] ✅ Patient data extraction completed successfully
[15:46:42] ✅    ✅ Patient data extracted successfully
[15:46:42] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Travers
     └─ dob: 07/02/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 551011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:46:42] ✅    ✅ Patient identified: James Travers
[15:46:42] ✅    ✅ Patient name validation passed
[15:46:42] 🔄 
🔄 Step 3: Processing patient dates...
[15:46:42] [DOC: 9266541] ℹ️  DOB normalized: 07/02/1944
[15:46:42] [DOC: 9266541] ℹ️  Episode startOfCare normalized: 03/23/2025
[15:46:42] [DOC: 9266541] ℹ️  Episode startOfEpisode normalized: 03/23/2025
[15:46:42] [DOC: 9266541] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[15:46:42] [DOC: 9266541] ✅ Patient date processing completed successfully
[15:46:42] ✅    ✅ Date processing completed
[15:46:42] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Travers
     └─ dob: 07/02/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 551011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2025', 'startOfEpisode': '03/23/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:46:42] 🔄 
🔄 Step 4: Extracting order data...
[15:46:45] ℹ️  Order extraction - MRN: ''
[15:46:45] ℹ️  Order extraction - Sex: 'MALE'
[15:46:45] ℹ️  Order extraction - Service Line: 'OT'
[15:46:45] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[15:46:45] ✅ Order data extraction completed successfully
[15:46:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:46:45] ℹ️  Using MRN from patient data: '551011'
[15:46:45] ℹ️  Service line consistent in both sources: 'OT'
[15:46:45] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[15:46:45] ✅ Patient name cross-validation successful
[15:46:45] ✅    ✅ Data merged successfully
[15:46:46] ✅    ✅ Order data extracted and validated
[15:46:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:46:52] [DOC: 9266541] ✅ Patient exists in API: James Travers, ID: c5103623-be0f-42b5-97de-217d9f008d54
[15:46:53] ✅    ✅ Existing patient found with ID: c5103623-be0f-42b5-97de-217d9f008d54
[15:46:53] 🔄 
🔄 Step 6: Pushing order to API...
[15:46:53] [DOC: 9266541] ℹ️  Pushing order via API for patient ID: c5103623-be0f-42b5-97de-217d9f008d54
[15:46:54] [DOC: 9266541] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14359"}
[15:46:54] ❌    ❌ Failed to push order
[15:46:54] 🔄 
🔄 Step 7: Writing to CSV...
[15:46:54] [DOC: 9266541] ℹ️  Calculated age: 80 from DOB: 07/02/1944
[15:46:54] [DOC: 9266541] ℹ️  Service Line extracted: 'OT'
[15:46:54] [DOC: 9266541] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[15:46:54] [DOC: 9266541] ℹ️  Diagnosis codes being written:
[15:46:54] [DOC: 9266541] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:46:54] [DOC: 9266541] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:46:54] [DOC: 9266541] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:46:54] [DOC: 9266541] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:46:54] [DOC: 9266541] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:46:54] [DOC: 9266541] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:46:54] [DOC: 9266541] ✅ Patient data written to CSV: James Travers | Sex: MALE | Age: 80 | Service: OT | Payer: Blue Cross Blue Shield | MRN: 551011
[15:46:54] ✅    ✅ Document 9266541 processed and saved successfully
[15:46:54] 🔄 
🔄 Step 8: Saving API details...
[15:46:54] [DOC: 9266541] ℹ️  API push details saved for document 9266541
[15:46:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266539                         ║
================================================================================
[15:46:54] ℹ️  Agency: Dartmouth HH
[15:46:54] ℹ️  Date: 04/29/2025
[15:46:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:46:56] [DOC: 9266539] ✅ Text extracted using pdfplumber (5530 chars)
[15:46:56] ✅    ✅ Text extracted using pdfplumber (5530 chars)
[15:46:56] 🔄 
🔄 Step 2: Extracting patient data...
[15:46:59] ℹ️  AI extracted raw sex value: 'F'
[15:46:59] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:46:59] ℹ️  AI extracted payer source: 'Medicare'
[15:46:59] ℹ️  AI extracted diagnoses:
[15:46:59] ℹ️    - Diagnosis 1: 'PNA'
[15:46:59] ℹ️    - Diagnosis 2: 'PE'
[15:46:59] ℹ️    - Diagnosis 3: 'Afib'
[15:46:59] ℹ️    - Diagnosis 4: 'CHF'
[15:46:59] ℹ️    - Diagnosis 5: 'Anemia'
[15:46:59] ℹ️    - Diagnosis 6: 'CKD3'
[15:46:59] ℹ️  Final extracted MRN: '771002'
[15:46:59] ℹ️  Final extracted Sex: 'FEMALE'
[15:46:59] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:46:59] ℹ️  Final extracted Payer Source: 'Medicare'
[15:46:59] ✅ Patient data extraction completed successfully
[15:46:59] ✅    ✅ Patient data extracted successfully
[15:46:59] 📊 Patient Response
     └─ patientFName: Kathryn
     └─ patientLName: McCollester
     └─ dob: 09/24/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 771002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/17/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'PNA', 'secondDiagnosis': 'PE', 'thirdDiagnosis': 'Afib', 'fourthDiagnosis': 'CHF', 'fifthDiagnosis': 'Anemia', 'sixthDiagnosis': 'CKD3'}]
[15:46:59] ✅    ✅ Patient identified: Kathryn McCollester
[15:46:59] ✅    ✅ Patient name validation passed
[15:46:59] 🔄 
🔄 Step 3: Processing patient dates...
[15:46:59] [DOC: 9266539] ℹ️  DOB normalized: 09/24/1930
[15:46:59] [DOC: 9266539] ℹ️  Episode startOfCare normalized: 02/17/2025
[15:46:59] [DOC: 9266539] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[15:46:59] [DOC: 9266539] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[15:46:59] [DOC: 9266539] ✅ Patient date processing completed successfully
[15:46:59] ✅    ✅ Date processing completed
[15:46:59] 📊 Processed Patient Data
     └─ patientFName: Kathryn
     └─ patientLName: McCollester
     └─ dob: 09/24/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 771002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/17/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'PNA', 'secondDiagnosis': 'PE', 'thirdDiagnosis': 'Afib', 'fourthDiagnosis': 'CHF', 'fifthDiagnosis': 'Anemia', 'sixthDiagnosis': 'CKD3'}]
[15:46:59] 🔄 
🔄 Step 4: Extracting order data...
[15:47:01] ℹ️  Order extraction - MRN: ''
[15:47:01] ℹ️  Order extraction - Sex: 'FEMALE'
[15:47:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:47:01] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:47:01] ✅ Order data extraction completed successfully
[15:47:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:47:01] ℹ️  Using MRN from patient data: '771002'
[15:47:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:47:01] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:47:01] ✅ Patient name cross-validation successful
[15:47:01] ✅    ✅ Data merged successfully
[15:47:02] ✅    ✅ Order data extracted and validated
[15:47:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:47:02] [DOC: 9266539] ✅ Patient found in local cache: Kathryn McCollester, ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[15:47:02] ✅    ✅ Existing patient found with ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[15:47:02] 🔄 
🔄 Step 6: Pushing order to API...
[15:47:02] [DOC: 9266539] ℹ️  Pushing order via API for patient ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[15:47:03] [DOC: 9266539] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14051"}
[15:47:03] ❌    ❌ Failed to push order
[15:47:03] 🔄 
🔄 Step 7: Writing to CSV...
[15:47:03] [DOC: 9266539] ℹ️  Calculated age: 94 from DOB: 09/24/1930
[15:47:03] [DOC: 9266539] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:47:03] [DOC: 9266539] ℹ️  Payer Source extracted: 'Medicare'
[15:47:03] [DOC: 9266539] ℹ️  Diagnosis codes being written:
[15:47:03] [DOC: 9266539] ℹ️    - Latest_Episode_Firstdiagnosis: 'PNA'
[15:47:03] [DOC: 9266539] ℹ️    - Latest_Episode_Seconddiagnosis: 'PE'
[15:47:03] [DOC: 9266539] ℹ️    - Latest_Episode_Thirddiagnosis: 'Afib'
[15:47:03] [DOC: 9266539] ℹ️    - Latest_Episode_Fourthdiagnosis: 'CHF'
[15:47:03] [DOC: 9266539] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Anemia'
[15:47:03] [DOC: 9266539] ℹ️    - Latest_Episode_Sixthdiagnosis: 'CKD3'
[15:47:03] [DOC: 9266539] ✅ Patient data written to CSV: Kathryn McCollester | Sex: FEMALE | Age: 94 | Service: Skilled Nursing | Payer: Medicare | MRN: 771002
[15:47:03] ✅    ✅ Document 9266539 processed and saved successfully
[15:47:03] 🔄 
🔄 Step 8: Saving API details...
[15:47:03] [DOC: 9266539] ℹ️  API push details saved for document 9266539
[15:47:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266536                         ║
================================================================================
[15:47:03] ℹ️  Agency: Dartmouth HH
[15:47:03] ℹ️  Date: 04/29/2025
[15:47:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:47:05] [DOC: 9266536] ✅ Text extracted using pdfplumber (1323 chars)
[15:47:05] ✅    ✅ Text extracted using pdfplumber (1323 chars)
[15:47:05] 🔄 
🔄 Step 2: Extracting patient data...
[15:47:08] ℹ️  AI extracted raw sex value: 'F'
[15:47:08] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:47:08] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[15:47:08] ℹ️  AI extracted diagnoses:
[15:47:08] ℹ️    - Diagnosis 1: 'None'
[15:47:08] ℹ️    - Diagnosis 2: 'None'
[15:47:08] ℹ️    - Diagnosis 3: 'None'
[15:47:08] ℹ️    - Diagnosis 4: 'None'
[15:47:08] ℹ️    - Diagnosis 5: 'None'
[15:47:08] ℹ️    - Diagnosis 6: 'None'
[15:47:08] ℹ️  Final extracted MRN: '651015'
[15:47:08] ℹ️  Final extracted Sex: 'FEMALE'
[15:47:08] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:47:08] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[15:47:08] ✅ Patient data extraction completed successfully
[15:47:08] ✅    ✅ Patient data extracted successfully
[15:47:08] 📊 Patient Response
     └─ patientFName: A Shirley
     └─ patientLName: Jadlowe
     └─ dob: 01/19/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 651015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '05/23/2024', 'startOfEpisode': '04/27/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:47:08] ✅    ✅ Patient identified: A Shirley Jadlowe
[15:47:08] ✅    ✅ Patient name validation passed
[15:47:08] 🔄 
🔄 Step 3: Processing patient dates...
[15:47:08] [DOC: 9266536] ℹ️  DOB normalized: 01/19/1935
[15:47:08] [DOC: 9266536] ℹ️  Episode startOfCare normalized: 05/23/2024
[15:47:08] [DOC: 9266536] ℹ️  Episode startOfEpisode normalized: 04/27/2025
[15:47:08] [DOC: 9266536] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[15:47:08] [DOC: 9266536] ✅ Patient date processing completed successfully
[15:47:08] ✅    ✅ Date processing completed
[15:47:08] 📊 Processed Patient Data
     └─ patientFName: A Shirley
     └─ patientLName: Jadlowe
     └─ dob: 01/19/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 651015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '05/23/2024', 'startOfEpisode': '04/27/2025', 'endOfEpisode': '05/17/2025'}]
[15:47:08] 🔄 
🔄 Step 4: Extracting order data...
[15:47:11] ℹ️  Order extraction - MRN: ''
[15:47:11] ℹ️  Order extraction - Sex: 'FEMALE'
[15:47:11] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:47:11] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[15:47:11] ✅ Order data extraction completed successfully
[15:47:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:47:11] ℹ️  Using MRN from patient data: '651015'
[15:47:11] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:47:11] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[15:47:11] ✅ Patient name cross-validation successful
[15:47:11] ✅    ✅ Data merged successfully
[15:47:12] ✅    ✅ Order data extracted and validated
[15:47:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:47:20] [DOC: 9266536] ✅ Patient exists in API: A Shirley Jadlowe, ID: f434f7e2-b2e3-4187-b677-c68e57142970
[15:47:20] ✅    ✅ Existing patient found with ID: f434f7e2-b2e3-4187-b677-c68e57142970
[15:47:20] 🔄 
🔄 Step 6: Pushing order to API...
[15:47:20] [DOC: 9266536] ℹ️  Pushing order via API for patient ID: f434f7e2-b2e3-4187-b677-c68e57142970
[15:47:22] [DOC: 9266536] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:47:22] ❌    ❌ Failed to push order
[15:47:22] 🔄 
🔄 Step 7: Writing to CSV...
[15:47:22] [DOC: 9266536] ℹ️  Calculated age: 90 from DOB: 01/19/1935
[15:47:22] [DOC: 9266536] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:47:22] [DOC: 9266536] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[15:47:22] [DOC: 9266536] ℹ️  Diagnosis codes being written:
[15:47:22] [DOC: 9266536] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:47:22] [DOC: 9266536] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:47:22] [DOC: 9266536] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:47:22] [DOC: 9266536] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:47:22] [DOC: 9266536] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:47:22] [DOC: 9266536] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:47:22] [DOC: 9266536] ✅ Patient data written to CSV: A Shirley Jadlowe | Sex: FEMALE | Age: 90 | Service: Skilled Nursing | Payer: Blue Cross Blue Shield | MRN: 651015
[15:47:22] ✅    ✅ Document 9266536 processed and saved successfully
[15:47:22] 🔄 
🔄 Step 8: Saving API details...
[15:47:22] [DOC: 9266536] ℹ️  API push details saved for document 9266536
[15:47:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266528                         ║
================================================================================
[15:47:22] ℹ️  Agency: Dartmouth HH
[15:47:22] ℹ️  Date: 04/29/2025
[15:47:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:47:26] [DOC: 9266528] ✅ Text extracted using pdfplumber (12189 chars)
[15:47:26] ✅    ✅ Text extracted using pdfplumber (12177 chars)
[15:47:26] 🔄 
🔄 Step 2: Extracting patient data...
[15:47:30] ℹ️  AI extracted raw sex value: 'F'
[15:47:30] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[15:47:30] ℹ️  AI extracted payer source: ''
[15:47:30] ℹ️  AI extracted diagnoses:
[15:47:30] ℹ️    - Diagnosis 1: 'J18.9'
[15:47:30] ℹ️    - Diagnosis 2: 'J91.8'
[15:47:30] ℹ️    - Diagnosis 3: 'J96.01'
[15:47:30] ℹ️    - Diagnosis 4: 'I26.99'
[15:47:30] ℹ️    - Diagnosis 5: 'I13.0'
[15:47:30] ℹ️    - Diagnosis 6: 'I50.32'
[15:47:30] ℹ️  Final extracted MRN: '771002'
[15:47:30] ℹ️  Final extracted Sex: 'FEMALE'
[15:47:30] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[15:47:30] ℹ️  Final extracted Payer Source: ''
[15:47:30] ✅ Patient data extraction completed successfully
[15:47:30] ✅    ✅ Patient data extracted successfully
[15:47:30] 📊 Patient Response
     └─ patientFName: Kathryn
     └─ patientLName: McCollester
     └─ dob: 09/24/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 771002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/17/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'J91.8', 'thirdDiagnosis': 'J96.01', 'fourthDiagnosis': 'I26.99', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.32'}]
[15:47:30] ✅    ✅ Patient identified: Kathryn McCollester
[15:47:30] ✅    ✅ Patient name validation passed
[15:47:30] 🔄 
🔄 Step 3: Processing patient dates...
[15:47:30] [DOC: 9266528] ℹ️  DOB normalized: 09/24/1930
[15:47:30] [DOC: 9266528] ℹ️  Episode startOfCare normalized: 02/17/2025
[15:47:30] [DOC: 9266528] ℹ️  Episode startOfEpisode normalized: 04/18/2025
[15:47:30] [DOC: 9266528] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[15:47:30] [DOC: 9266528] ✅ Patient date processing completed successfully
[15:47:30] ✅    ✅ Date processing completed
[15:47:30] 📊 Processed Patient Data
     └─ patientFName: Kathryn
     └─ patientLName: McCollester
     └─ dob: 09/24/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 771002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/17/2025', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'J91.8', 'thirdDiagnosis': 'J96.01', 'fourthDiagnosis': 'I26.99', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.32'}]
[15:47:30] 🔄 
🔄 Step 4: Extracting order data...
[15:47:32] ℹ️  Order extraction - MRN: '771002'
[15:47:32] ℹ️  Order extraction - Sex: 'FEMALE'
[15:47:32] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[15:47:32] ℹ️  Order extraction - Payer Source: ''
[15:47:32] ✅ Order data extraction completed successfully
[15:47:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:47:32] ℹ️  Using MRN from patient data: '771002' over '771002'
[15:47:32] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[15:47:32] ⚠️  Patient name mismatch: Order='McCollister, Kathryn N' vs Patient='Kathryn McCollester'
[15:47:32] ✅    ✅ Data merged successfully
[15:47:33] ✅    ✅ Order data extracted and validated
[15:47:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:47:33] [DOC: 9266528] ✅ Patient found in local cache: Kathryn McCollester, ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[15:47:33] ✅    ✅ Existing patient found with ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[15:47:33] 🔄 
🔄 Step 6: Pushing order to API...
[15:47:33] [DOC: 9266528] ℹ️  Pushing order via API for patient ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[15:47:35] [DOC: 9266528] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:47:35] ❌    ❌ Failed to push order
[15:47:35] 🔄 
🔄 Step 7: Writing to CSV...
[15:47:35] [DOC: 9266528] ℹ️  Calculated age: 94 from DOB: 09/24/1930
[15:47:35] [DOC: 9266528] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT'
[15:47:35] [DOC: 9266528] ℹ️  Payer Source extracted: ''
[15:47:35] [DOC: 9266528] ℹ️  Diagnosis codes being written:
[15:47:35] [DOC: 9266528] ℹ️    - Latest_Episode_Firstdiagnosis: 'J18.9'
[15:47:35] [DOC: 9266528] ℹ️    - Latest_Episode_Seconddiagnosis: 'J91.8'
[15:47:35] [DOC: 9266528] ℹ️    - Latest_Episode_Thirddiagnosis: 'J96.01'
[15:47:35] [DOC: 9266528] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I26.99'
[15:47:35] [DOC: 9266528] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I13.0'
[15:47:35] [DOC: 9266528] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I50.32'
[15:47:35] [DOC: 9266528] ✅ Patient data written to CSV: Kathryn McCollester | Sex: FEMALE | Age: 94 | Service: Skilled Nursing, PT, OT | Payer:  | MRN: 771002
[15:47:35] ✅    ✅ Document 9266528 processed and saved successfully
[15:47:35] 🔄 
🔄 Step 8: Saving API details...
[15:47:35] [DOC: 9266528] ℹ️  API push details saved for document 9266528
[15:47:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266521                         ║
================================================================================
[15:47:35] ℹ️  Agency: Dartmouth HH
[15:47:35] ℹ️  Date: 04/29/2025
[15:47:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:47:37] [DOC: 9266521] ✅ Text extracted using pdfplumber (2751 chars)
[15:47:37] ✅    ✅ Text extracted using pdfplumber (2751 chars)
[15:47:37] 🔄 
🔄 Step 2: Extracting patient data...
[15:47:39] ℹ️  AI extracted raw sex value: 'F'
[15:47:39] ℹ️  AI extracted service line: 'OT'
[15:47:39] ℹ️  AI extracted payer source: 'Medicare'
[15:47:39] ℹ️  AI extracted diagnoses:
[15:47:39] ℹ️    - Diagnosis 1: ''
[15:47:39] ℹ️    - Diagnosis 2: ''
[15:47:39] ℹ️    - Diagnosis 3: ''
[15:47:39] ℹ️    - Diagnosis 4: ''
[15:47:39] ℹ️    - Diagnosis 5: ''
[15:47:39] ℹ️    - Diagnosis 6: ''
[15:47:39] ℹ️  Final extracted MRN: '6063015'
[15:47:39] ℹ️  Final extracted Sex: 'FEMALE'
[15:47:39] ℹ️  Final extracted Service Line: 'OT'
[15:47:39] ℹ️  Final extracted Payer Source: 'Medicare'
[15:47:39] ✅ Patient data extraction completed successfully
[15:47:39] ✅    ✅ Patient data extracted successfully
[15:47:39] 📊 Patient Response
     └─ patientFName: Ann
     └─ patientLName: Bourque
     └─ dob: 11/28/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6063015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:47:39] ✅    ✅ Patient identified: Ann Bourque
[15:47:39] ✅    ✅ Patient name validation passed
[15:47:39] 🔄 
🔄 Step 3: Processing patient dates...
[15:47:39] [DOC: 9266521] ℹ️  DOB normalized: 11/28/1962
[15:47:39] [DOC: 9266521] ℹ️  Episode startOfCare normalized: 03/29/2025
[15:47:39] [DOC: 9266521] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[15:47:39] [DOC: 9266521] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[15:47:39] [DOC: 9266521] ✅ Patient date processing completed successfully
[15:47:39] ✅    ✅ Date processing completed
[15:47:39] 📊 Processed Patient Data
     └─ patientFName: Ann
     └─ patientLName: Bourque
     └─ dob: 11/28/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6063015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:47:39] 🔄 
🔄 Step 4: Extracting order data...
[15:47:42] ℹ️  Order extraction - MRN: ''
[15:47:42] ℹ️  Order extraction - Sex: 'FEMALE'
[15:47:42] ℹ️  Order extraction - Service Line: 'OT'
[15:47:42] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:47:42] ✅ Order data extraction completed successfully
[15:47:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:47:42] ℹ️  Using MRN from patient data: '6063015'
[15:47:42] ℹ️  Service line consistent in both sources: 'OT'
[15:47:42] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:47:42] ✅ Patient name cross-validation successful
[15:47:42] ✅    ✅ Data merged successfully
[15:47:43] ✅    ✅ Order data extracted and validated
[15:47:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:47:48] [DOC: 9266521] ✅ Patient exists in API: Ann Bourque, ID: 1d9a45ed-406d-4acb-90d1-87705ac62b6a
[15:47:48] ✅    ✅ Existing patient found with ID: 1d9a45ed-406d-4acb-90d1-87705ac62b6a
[15:47:48] 🔄 
🔄 Step 6: Pushing order to API...
[15:47:48] [DOC: 9266521] ℹ️  Pushing order via API for patient ID: 1d9a45ed-406d-4acb-90d1-87705ac62b6a
[15:47:49] [DOC: 9266521] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:47:49] ❌    ❌ Failed to push order
[15:47:49] 🔄 
🔄 Step 7: Writing to CSV...
[15:47:49] [DOC: 9266521] ℹ️  Calculated age: 62 from DOB: 11/28/1962
[15:47:49] [DOC: 9266521] ℹ️  Service Line extracted: 'OT'
[15:47:49] [DOC: 9266521] ℹ️  Payer Source extracted: 'Medicare'
[15:47:49] [DOC: 9266521] ℹ️  Diagnosis codes being written:
[15:47:49] [DOC: 9266521] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:47:49] [DOC: 9266521] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:47:49] [DOC: 9266521] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:47:49] [DOC: 9266521] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:47:49] [DOC: 9266521] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:47:49] [DOC: 9266521] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:47:49] [DOC: 9266521] ✅ Patient data written to CSV: Ann Bourque | Sex: FEMALE | Age: 62 | Service: OT | Payer: Medicare | MRN: 6063015
[15:47:49] ✅    ✅ Document 9266521 processed and saved successfully
[15:47:49] 🔄 
🔄 Step 8: Saving API details...
[15:47:49] [DOC: 9266521] ℹ️  API push details saved for document 9266521
[15:47:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266516                         ║
================================================================================
[15:47:49] ℹ️  Agency: Dartmouth HH
[15:47:49] ℹ️  Date: 04/29/2025
[15:47:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:47:51] [DOC: 9266516] ✅ Text extracted using pdfplumber (1150 chars)
[15:47:51] ✅    ✅ Text extracted using pdfplumber (1150 chars)
[15:47:51] 🔄 
🔄 Step 2: Extracting patient data...
[15:47:54] ℹ️  AI extracted raw sex value: 'F'
[15:47:54] ℹ️  AI extracted service line: 'HHA'
[15:47:54] ℹ️  AI extracted payer source: 'Medicare'
[15:47:54] ℹ️  AI extracted diagnoses:
[15:47:54] ℹ️    - Diagnosis 1: 'None'
[15:47:54] ℹ️    - Diagnosis 2: 'None'
[15:47:54] ℹ️    - Diagnosis 3: 'None'
[15:47:54] ℹ️    - Diagnosis 4: 'None'
[15:47:54] ℹ️    - Diagnosis 5: 'None'
[15:47:54] ℹ️    - Diagnosis 6: 'None'
[15:47:54] ℹ️  Final extracted MRN: '637008'
[15:47:54] ℹ️  Final extracted Sex: 'FEMALE'
[15:47:54] ℹ️  Final extracted Service Line: 'HHA'
[15:47:54] ℹ️  Final extracted Payer Source: 'Medicare'
[15:47:54] ✅ Patient data extraction completed successfully
[15:47:54] ✅    ✅ Patient data extracted successfully
[15:47:54] 📊 Patient Response
     └─ patientFName: Florence
     └─ patientLName: Curry
     └─ dob: 06/02/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 637008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 140 D Carriage Drive
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:47:54] ✅    ✅ Patient identified: Florence Curry
[15:47:54] ✅    ✅ Patient name validation passed
[15:47:54] 🔄 
🔄 Step 3: Processing patient dates...
[15:47:54] [DOC: 9266516] ℹ️  DOB normalized: 06/02/1933
[15:47:54] [DOC: 9266516] ℹ️  Episode startOfCare normalized: 04/11/2025
[15:47:54] [DOC: 9266516] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[15:47:54] [DOC: 9266516] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[15:47:54] [DOC: 9266516] ✅ Patient date processing completed successfully
[15:47:54] ✅    ✅ Date processing completed
[15:47:54] 📊 Processed Patient Data
     └─ patientFName: Florence
     └─ patientLName: Curry
     └─ dob: 06/02/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 637008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 140 D Carriage Drive
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025'}]
[15:47:54] 🔄 
🔄 Step 4: Extracting order data...
[15:47:56] ℹ️  Order extraction - MRN: ''
[15:47:56] ℹ️  Order extraction - Sex: 'FEMALE'
[15:47:56] ℹ️  Order extraction - Service Line: 'HHA'
[15:47:56] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:47:56] ✅ Order data extraction completed successfully
[15:47:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:47:56] ℹ️  Using MRN from patient data: '637008'
[15:47:56] ℹ️  Service line consistent in both sources: 'HHA'
[15:47:56] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:47:56] ✅ Patient name cross-validation successful
[15:47:56] ✅    ✅ Data merged successfully
[15:47:57] ✅    ✅ Order data extracted and validated
[15:47:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:48:02] [DOC: 9266516] ℹ️  Patient not found in cache or API: Florence Curry
[15:48:02] [DOC: 9266516] ℹ️  Patient not found, creating new patient via API...
[15:48:02] [DOC: 9266516] ℹ️  Creating patient via API: Florence Curry
[15:48:03] [DOC: 9266516] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:48:03] ❌    ❌ Failed to create patient
[15:48:03] [DOC: 9266516] ℹ️  API push details saved for document 9266516
================================================================================
║                        Processing Document ID: 9266512                         ║
================================================================================
[15:48:03] ℹ️  Agency: Dartmouth HH
[15:48:03] ℹ️  Date: 04/29/2025
[15:48:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:48:05] [DOC: 9266512] ✅ Text extracted using pdfplumber (1558 chars)
[15:48:05] ✅    ✅ Text extracted using pdfplumber (1558 chars)
[15:48:05] 🔄 
🔄 Step 2: Extracting patient data...
[15:48:08] ℹ️  AI extracted raw sex value: 'F'
[15:48:08] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:48:08] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[15:48:08] ℹ️  AI extracted diagnoses:
[15:48:08] ℹ️    - Diagnosis 1: ''
[15:48:08] ℹ️    - Diagnosis 2: ''
[15:48:08] ℹ️    - Diagnosis 3: ''
[15:48:08] ℹ️    - Diagnosis 4: ''
[15:48:08] ℹ️    - Diagnosis 5: ''
[15:48:08] ℹ️    - Diagnosis 6: ''
[15:48:08] ℹ️  Final extracted MRN: '6201015'
[15:48:08] ℹ️  Final extracted Sex: 'FEMALE'
[15:48:08] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:48:08] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[15:48:08] ✅ Patient data extraction completed successfully
[15:48:08] ✅    ✅ Patient data extracted successfully
[15:48:08] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Laborinho
     └─ dob: 02/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6201015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:48:08] ✅    ✅ Patient identified: Maria Laborinho
[15:48:08] ✅    ✅ Patient name validation passed
[15:48:08] 🔄 
🔄 Step 3: Processing patient dates...
[15:48:08] [DOC: 9266512] ℹ️  DOB normalized: 02/08/1951
[15:48:08] [DOC: 9266512] ℹ️  Episode startOfCare normalized: 03/13/2025
[15:48:08] [DOC: 9266512] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[15:48:08] [DOC: 9266512] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[15:48:08] [DOC: 9266512] ✅ Patient date processing completed successfully
[15:48:08] ✅    ✅ Date processing completed
[15:48:08] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Laborinho
     └─ dob: 02/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6201015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:48:08] 🔄 
🔄 Step 4: Extracting order data...
[15:48:11] ℹ️  Order extraction - MRN: ''
[15:48:11] ℹ️  Order extraction - Sex: 'FEMALE'
[15:48:11] ℹ️  Order extraction - Service Line: 'RN'
[15:48:11] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[15:48:11] ✅ Order data extraction completed successfully
[15:48:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:48:11] ℹ️  Using MRN from patient data: '6201015'
[15:48:11] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[15:48:11] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[15:48:11] ✅ Patient name cross-validation successful
[15:48:11] ✅    ✅ Data merged successfully
[15:48:12] ✅    ✅ Order data extracted and validated
[15:48:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:48:18] [DOC: 9266512] ℹ️  Patient not found in cache or API: Maria Laborinho
[15:48:18] [DOC: 9266512] ℹ️  Patient not found, creating new patient via API...
[15:48:18] [DOC: 9266512] ℹ️  Creating patient via API: Maria Laborinho
[15:48:19] [DOC: 9266512] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:48:19] ❌    ❌ Failed to create patient
[15:48:19] [DOC: 9266512] ℹ️  API push details saved for document 9266512
================================================================================
║                        Processing Document ID: 9266500                         ║
================================================================================
[15:48:19] ℹ️  Agency: Dartmouth HH
[15:48:19] ℹ️  Date: 04/29/2025
[15:48:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:48:23] [DOC: 9266500] ✅ Text extracted using pdfplumber (25513 chars)
[15:48:23] ✅    ✅ Text extracted using pdfplumber (25501 chars)
[15:48:23] 🔄 
🔄 Step 2: Extracting patient data...
[15:48:27] ℹ️  AI extracted raw sex value: 'F'
[15:48:27] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[15:48:27] ℹ️  AI extracted payer source: 'Private Pay'
[15:48:27] ℹ️  AI extracted diagnoses:
[15:48:27] ℹ️    - Diagnosis 1: 'I24.89'
[15:48:27] ℹ️    - Diagnosis 2: 'I77.1'
[15:48:27] ℹ️    - Diagnosis 3: 'K55.1'
[15:48:27] ℹ️    - Diagnosis 4: 'I11.0'
[15:48:27] ℹ️    - Diagnosis 5: 'I50.32'
[15:48:27] ℹ️    - Diagnosis 6: 'I48.91'
[15:48:27] ℹ️  Final extracted MRN: '637008'
[15:48:27] ℹ️  Final extracted Sex: 'FEMALE'
[15:48:27] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[15:48:27] ℹ️  Final extracted Payer Source: 'Private Pay'
[15:48:27] ✅ Patient data extraction completed successfully
[15:48:27] ✅    ✅ Patient data extracted successfully
[15:48:27] 📊 Patient Response
     └─ patientFName: Florence
     └─ patientLName: Curry
     └─ dob: 06/02/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 637008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: Private Pay
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'I24.89', 'secondDiagnosis': 'I77.1', 'thirdDiagnosis': 'K55.1', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'I48.91'}]
[15:48:27] ✅    ✅ Patient identified: Florence Curry
[15:48:27] ✅    ✅ Patient name validation passed
[15:48:27] 🔄 
🔄 Step 3: Processing patient dates...
[15:48:27] [DOC: 9266500] ℹ️  DOB normalized: 06/02/1933
[15:48:27] [DOC: 9266500] ℹ️  Episode startOfCare normalized: 04/11/2025
[15:48:27] [DOC: 9266500] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[15:48:27] [DOC: 9266500] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[15:48:27] [DOC: 9266500] ✅ Patient date processing completed successfully
[15:48:27] ✅    ✅ Date processing completed
[15:48:27] 📊 Processed Patient Data
     └─ patientFName: Florence
     └─ patientLName: Curry
     └─ dob: 06/02/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 637008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: Private Pay
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'I24.89', 'secondDiagnosis': 'I77.1', 'thirdDiagnosis': 'K55.1', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.32', 'sixthDiagnosis': 'I48.91'}]
[15:48:27] 🔄 
🔄 Step 4: Extracting order data...
[15:48:29] ℹ️  Order extraction - MRN: '637008'
[15:48:29] ℹ️  Order extraction - Sex: 'FEMALE'
[15:48:29] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[15:48:29] ℹ️  Order extraction - Payer Source: 'Private Pay'
[15:48:29] ✅ Order data extraction completed successfully
[15:48:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:48:29] ℹ️  Using MRN from patient data: '637008' over '637008'
[15:48:29] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[15:48:29] ℹ️  Payer source consistent in both sources: 'Private Pay'
[15:48:29] ✅ Patient name cross-validation successful
[15:48:29] ✅    ✅ Data merged successfully
[15:48:30] ✅    ✅ Order data extracted and validated
[15:48:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:48:35] [DOC: 9266500] ℹ️  Patient not found in cache or API: Florence Curry
[15:48:35] [DOC: 9266500] ℹ️  Patient not found, creating new patient via API...
[15:48:35] [DOC: 9266500] ℹ️  Creating patient via API: Florence Curry
[15:48:36] [DOC: 9266500] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:48:36] ❌    ❌ Failed to create patient
[15:48:36] [DOC: 9266500] ℹ️  API push details saved for document 9266500
================================================================================
║                        Processing Document ID: 9266475                         ║
================================================================================
[15:48:36] ℹ️  Agency: Dartmouth HH
[15:48:36] ℹ️  Date: 04/29/2025
[15:48:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:48:38] [DOC: 9266475] ✅ Text extracted using pdfplumber (4021 chars)
[15:48:38] ✅    ✅ Text extracted using pdfplumber (4021 chars)
[15:48:38] 🔄 
🔄 Step 2: Extracting patient data...
[15:48:41] ℹ️  AI extracted raw sex value: 'F'
[15:48:41] ℹ️  AI extracted service line: 'RN, HHA'
[15:48:41] ℹ️  AI extracted payer source: 'Medicare'
[15:48:41] ℹ️  AI extracted diagnoses:
[15:48:41] ℹ️    - Diagnosis 1: 'S81.812D'
[15:48:41] ℹ️    - Diagnosis 2: 'S51.812D'
[15:48:41] ℹ️    - Diagnosis 3: 'S51.811D'
[15:48:41] ℹ️    - Diagnosis 4: 'None'
[15:48:41] ℹ️    - Diagnosis 5: 'None'
[15:48:41] ℹ️    - Diagnosis 6: 'None'
[15:48:41] ℹ️  Final extracted MRN: '3684011'
[15:48:41] ℹ️  Final extracted Sex: 'FEMALE'
[15:48:41] ℹ️  Final extracted Service Line: 'RN, HHA'
[15:48:41] ℹ️  Final extracted Payer Source: 'Medicare'
[15:48:41] ✅ Patient data extraction completed successfully
[15:48:41] ✅    ✅ Patient data extracted successfully
[15:48:41] 📊 Patient Response
     └─ patientFName: Frances
     └─ patientLName: Levin
     └─ dob: 01/16/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3684011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/28/2024', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': 'S81.812D', 'secondDiagnosis': 'S51.812D', 'thirdDiagnosis': 'S51.811D', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:48:41] ✅    ✅ Patient identified: Frances Levin
[15:48:41] ✅    ✅ Patient name validation passed
[15:48:41] 🔄 
🔄 Step 3: Processing patient dates...
[15:48:41] [DOC: 9266475] ℹ️  DOB normalized: 01/16/1935
[15:48:41] [DOC: 9266475] ℹ️  Episode startOfCare normalized: 06/28/2024
[15:48:41] [DOC: 9266475] ℹ️  Episode startOfEpisode normalized: 02/23/2025
[15:48:41] [DOC: 9266475] ℹ️  Episode endOfEpisode normalized: 04/23/2025
[15:48:41] [DOC: 9266475] ✅ Patient date processing completed successfully
[15:48:41] ✅    ✅ Date processing completed
[15:48:41] 📊 Processed Patient Data
     └─ patientFName: Frances
     └─ patientLName: Levin
     └─ dob: 01/16/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3684011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '06/28/2024', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': 'S81.812D', 'secondDiagnosis': 'S51.812D', 'thirdDiagnosis': 'S51.811D'}]
[15:48:41] 🔄 
🔄 Step 4: Extracting order data...
[15:48:44] ℹ️  Order extraction - MRN: '3684011'
[15:48:44] ℹ️  Order extraction - Sex: 'FEMALE'
[15:48:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:48:44] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:48:44] ✅ Order data extraction completed successfully
[15:48:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:48:44] ℹ️  Using MRN from patient data: '3684011' over '3684011'
[15:48:44] ℹ️  Combined service lines: Patient='RN, HHA' + Order='Skilled Nursing' = 'HHA, RN, Skilled Nursing'
[15:48:44] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:48:44] ✅ Patient name cross-validation successful
[15:48:44] ✅    ✅ Data merged successfully
[15:48:45] ✅    ✅ Order data extracted and validated
[15:48:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:48:52] [DOC: 9266475] ℹ️  Patient not found in cache or API: Frances Levin
[15:48:52] [DOC: 9266475] ℹ️  Patient not found, creating new patient via API...
[15:48:52] [DOC: 9266475] ℹ️  Creating patient via API: Frances Levin
[15:48:53] [DOC: 9266475] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:48:53] ❌    ❌ Failed to create patient
[15:48:53] [DOC: 9266475] ℹ️  API push details saved for document 9266475
================================================================================
║                        Processing Document ID: 9266468                         ║
================================================================================
[15:48:53] ℹ️  Agency: Dartmouth HH
[15:48:53] ℹ️  Date: 04/29/2025
[15:48:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:48:54] [DOC: 9266468] ✅ Text extracted using pdfplumber (1493 chars)
[15:48:54] ✅    ✅ Text extracted using pdfplumber (1493 chars)
[15:48:54] 🔄 
🔄 Step 2: Extracting patient data...
[15:48:57] ℹ️  AI extracted raw sex value: 'M'
[15:48:57] ℹ️  AI extracted service line: 'RN'
[15:48:57] ℹ️  AI extracted payer source: 'Medicare'
[15:48:57] ℹ️  AI extracted diagnoses:
[15:48:57] ℹ️    - Diagnosis 1: ''
[15:48:57] ℹ️    - Diagnosis 2: ''
[15:48:57] ℹ️    - Diagnosis 3: ''
[15:48:57] ℹ️    - Diagnosis 4: ''
[15:48:57] ℹ️    - Diagnosis 5: ''
[15:48:57] ℹ️    - Diagnosis 6: ''
[15:48:57] ℹ️  Final extracted MRN: '6208015'
[15:48:57] ℹ️  Final extracted Sex: 'MALE'
[15:48:57] ℹ️  Final extracted Service Line: 'RN'
[15:48:57] ℹ️  Final extracted Payer Source: 'Medicare'
[15:48:57] ✅ Patient data extraction completed successfully
[15:48:57] ✅    ✅ Patient data extracted successfully
[15:48:57] 📊 Patient Response
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 6208015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1013 Marlborough St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:48:57] ✅    ✅ Patient identified: Stephen Hanna Jr,
[15:48:57] ✅    ✅ Patient name validation passed
[15:48:57] 🔄 
🔄 Step 3: Processing patient dates...
[15:48:57] [DOC: 9266468] ℹ️  DOB normalized: 03/11/1936
[15:48:57] [DOC: 9266468] ℹ️  Episode startOfCare normalized: 03/15/2025
[15:48:57] [DOC: 9266468] ℹ️  Episode startOfEpisode normalized: 03/15/2025
[15:48:57] [DOC: 9266468] ℹ️  Episode endOfEpisode normalized: 05/13/2025
[15:48:57] [DOC: 9266468] ✅ Patient date processing completed successfully
[15:48:57] ✅    ✅ Date processing completed
[15:48:57] 📊 Processed Patient Data
     └─ patientFName: Stephen
     └─ patientLName: Hanna Jr,
     └─ dob: 03/11/1936
     └─ patientSex: MALE
     └─ medicalRecordNo: 6208015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1013 Marlborough St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/15/2025', 'startOfEpisode': '03/15/2025', 'endOfEpisode': '05/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:48:57] 🔄 
🔄 Step 4: Extracting order data...
[15:49:00] ℹ️  Order extraction - MRN: ''
[15:49:00] ℹ️  Order extraction - Sex: 'MALE'
[15:49:00] ℹ️  Order extraction - Service Line: 'RN'
[15:49:00] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:49:00] ✅ Order data extraction completed successfully
[15:49:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:49:00] ℹ️  Using MRN from patient data: '6208015'
[15:49:00] ℹ️  Service line consistent in both sources: 'RN'
[15:49:00] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:49:00] ✅ Patient name cross-validation successful
[15:49:00] ✅    ✅ Data merged successfully
[15:49:01] ✅    ✅ Order data extracted and validated
[15:49:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:49:01] [DOC: 9266468] ✅ Patient found in local cache: Stephen Hanna Jr,, ID: 38583918-d125-4291-a4c2-8551b1d02929
[15:49:01] ✅    ✅ Existing patient found with ID: 38583918-d125-4291-a4c2-8551b1d02929
[15:49:01] 🔄 
🔄 Step 6: Pushing order to API...
[15:49:01] [DOC: 9266468] ℹ️  Pushing order via API for patient ID: 38583918-d125-4291-a4c2-8551b1d02929
[15:49:02] [DOC: 9266468] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13829"}
[15:49:02] ❌    ❌ Failed to push order
[15:49:02] 🔄 
🔄 Step 7: Writing to CSV...
[15:49:02] [DOC: 9266468] ℹ️  Calculated age: 89 from DOB: 03/11/1936
[15:49:02] [DOC: 9266468] ℹ️  Service Line extracted: 'RN'
[15:49:02] [DOC: 9266468] ℹ️  Payer Source extracted: 'Medicare'
[15:49:02] [DOC: 9266468] ℹ️  Diagnosis codes being written:
[15:49:02] [DOC: 9266468] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:49:02] [DOC: 9266468] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:49:02] [DOC: 9266468] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:49:02] [DOC: 9266468] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:49:02] [DOC: 9266468] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:49:02] [DOC: 9266468] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:49:02] [DOC: 9266468] ✅ Patient data written to CSV: Stephen Hanna Jr, | Sex: MALE | Age: 89 | Service: RN | Payer: Medicare | MRN: 6208015
[15:49:02] ✅    ✅ Document 9266468 processed and saved successfully
[15:49:02] 🔄 
🔄 Step 8: Saving API details...
[15:49:02] [DOC: 9266468] ℹ️  API push details saved for document 9266468
[15:49:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266462                         ║
================================================================================
[15:49:02] ℹ️  Agency: Dartmouth HH
[15:49:02] ℹ️  Date: 04/29/2025
[15:49:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:49:04] [DOC: 9266462] ✅ Text extracted using pdfplumber (5793 chars)
[15:49:04] ✅    ✅ Text extracted using pdfplumber (5793 chars)
[15:49:04] 🔄 
🔄 Step 2: Extracting patient data...
[15:49:07] ℹ️  AI extracted raw sex value: 'F'
[15:49:07] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:49:07] ℹ️  AI extracted payer source: 'Medicare'
[15:49:07] ℹ️  AI extracted diagnoses:
[15:49:07] ℹ️    - Diagnosis 1: 'None'
[15:49:07] ℹ️    - Diagnosis 2: 'None'
[15:49:07] ℹ️    - Diagnosis 3: 'None'
[15:49:07] ℹ️    - Diagnosis 4: 'None'
[15:49:07] ℹ️    - Diagnosis 5: 'None'
[15:49:07] ℹ️    - Diagnosis 6: 'None'
[15:49:07] ℹ️  Final extracted MRN: '6203015'
[15:49:07] ℹ️  Final extracted Sex: 'FEMALE'
[15:49:07] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:49:07] ℹ️  Final extracted Payer Source: 'Medicare'
[15:49:07] ✅ Patient data extraction completed successfully
[15:49:07] ✅    ✅ Patient data extracted successfully
[15:49:07] 📊 Patient Response
     └─ patientFName: Sylvia
     └─ patientLName: Lemieux
     └─ dob: 06/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6203015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:49:07] ✅    ✅ Patient identified: Sylvia Lemieux
[15:49:07] ✅    ✅ Patient name validation passed
[15:49:07] 🔄 
🔄 Step 3: Processing patient dates...
[15:49:07] [DOC: 9266462] ℹ️  DOB normalized: 06/08/1941
[15:49:07] [DOC: 9266462] ℹ️  Episode startOfCare normalized: 03/14/2025
[15:49:07] [DOC: 9266462] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[15:49:07] [DOC: 9266462] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[15:49:07] [DOC: 9266462] ✅ Patient date processing completed successfully
[15:49:07] ✅    ✅ Date processing completed
[15:49:07] 📊 Processed Patient Data
     └─ patientFName: Sylvia
     └─ patientLName: Lemieux
     └─ dob: 06/08/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6203015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/14/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025'}]
[15:49:07] 🔄 
🔄 Step 4: Extracting order data...
[15:49:09] ℹ️  Order extraction - MRN: '6203015'
[15:49:09] ℹ️  Order extraction - Sex: 'FEMALE'
[15:49:09] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:49:09] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:49:09] ✅ Order data extraction completed successfully
[15:49:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:49:09] ℹ️  Using MRN from patient data: '6203015' over '6203015'
[15:49:09] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:49:09] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:49:09] ✅ Patient name cross-validation successful
[15:49:09] ✅    ✅ Data merged successfully
[15:49:10] ✅    ✅ Order data extracted and validated
[15:49:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:49:30] [DOC: 9266462] ℹ️  Patient not found in cache or API: Sylvia Lemieux
[15:49:30] [DOC: 9266462] ℹ️  Patient not found, creating new patient via API...
[15:49:30] [DOC: 9266462] ℹ️  Creating patient via API: Sylvia Lemieux
[15:49:31] [DOC: 9266462] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:49:31] ❌    ❌ Failed to create patient
[15:49:31] [DOC: 9266462] ℹ️  API push details saved for document 9266462
================================================================================
║                        Processing Document ID: 9266454                         ║
================================================================================
[15:49:31] ℹ️  Agency: Dartmouth HH
[15:49:31] ℹ️  Date: 04/29/2025
[15:49:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:49:34] [DOC: 9266454] ✅ Text extracted using pdfplumber (12378 chars)
[15:49:34] ✅    ✅ Text extracted using pdfplumber (12366 chars)
[15:49:34] 🔄 
🔄 Step 2: Extracting patient data...
[15:49:37] ℹ️  AI extracted raw sex value: 'F'
[15:49:37] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:49:37] ℹ️  AI extracted payer source: 'Private Pay'
[15:49:37] ℹ️  AI extracted diagnoses:
[15:49:37] ℹ️    - Diagnosis 1: 'S81.811D'
[15:49:37] ℹ️    - Diagnosis 2: 'S81.812D'
[15:49:37] ℹ️    - Diagnosis 3: 'S51.812D'
[15:49:37] ℹ️    - Diagnosis 4: 'S51.811D'
[15:49:37] ℹ️    - Diagnosis 5: 'I08.0'
[15:49:37] ℹ️    - Diagnosis 6: 'I05.1'
[15:49:37] ℹ️  Final extracted MRN: '3684011'
[15:49:37] ℹ️  Final extracted Sex: 'FEMALE'
[15:49:37] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:49:37] ℹ️  Final extracted Payer Source: 'Private Pay'
[15:49:37] ✅ Patient data extraction completed successfully
[15:49:37] ✅    ✅ Patient data extracted successfully
[15:49:37] 📊 Patient Response
     └─ patientFName: Frances
     └─ patientLName: Levin
     └─ dob: 01/16/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3684011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Private Pay
     └─ episodeDiagnoses: [{'startOfCare': '06/26/2024', 'startOfEpisode': '04/24/2025', 'endOfEpisode': '06/22/2025', 'firstDiagnosis': 'S81.811D', 'secondDiagnosis': 'S81.812D', 'thirdDiagnosis': 'S51.812D', 'fourthDiagnosis': 'S51.811D', 'fifthDiagnosis': 'I08.0', 'sixthDiagnosis': 'I05.1'}]
[15:49:37] ✅    ✅ Patient identified: Frances Levin
[15:49:37] ✅    ✅ Patient name validation passed
[15:49:37] 🔄 
🔄 Step 3: Processing patient dates...
[15:49:37] [DOC: 9266454] ℹ️  DOB normalized: 01/16/1935
[15:49:37] [DOC: 9266454] ℹ️  Episode startOfCare normalized: 06/26/2024
[15:49:37] [DOC: 9266454] ℹ️  Episode startOfEpisode normalized: 04/24/2025
[15:49:37] [DOC: 9266454] ℹ️  Episode endOfEpisode normalized: 06/22/2025
[15:49:37] [DOC: 9266454] ✅ Patient date processing completed successfully
[15:49:37] ✅    ✅ Date processing completed
[15:49:37] 📊 Processed Patient Data
     └─ patientFName: Frances
     └─ patientLName: Levin
     └─ dob: 01/16/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3684011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Private Pay
     └─ episodeDiagnoses: [{'startOfCare': '06/26/2024', 'startOfEpisode': '04/24/2025', 'endOfEpisode': '06/22/2025', 'firstDiagnosis': 'S81.811D', 'secondDiagnosis': 'S81.812D', 'thirdDiagnosis': 'S51.812D', 'fourthDiagnosis': 'S51.811D', 'fifthDiagnosis': 'I08.0', 'sixthDiagnosis': 'I05.1'}]
[15:49:37] 🔄 
🔄 Step 4: Extracting order data...
[15:49:40] ℹ️  Order extraction - MRN: '3684011'
[15:49:40] ℹ️  Order extraction - Sex: 'FEMALE'
[15:49:40] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[15:49:40] ℹ️  Order extraction - Payer Source: ''
[15:49:40] ✅ Order data extraction completed successfully
[15:49:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:49:40] ℹ️  Using MRN from patient data: '3684011' over '3684011'
[15:49:40] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, Physical Therapy' = 'Physical Therapy, Skilled Nursing'
[15:49:40] ℹ️  Using payer source from patient data: 'Private Pay'
[15:49:40] ✅ Patient name cross-validation successful
[15:49:40] ✅    ✅ Data merged successfully
[15:49:41] ✅    ✅ Order data extracted and validated
[15:49:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:49:45] [DOC: 9266454] ℹ️  Patient not found in cache or API: Frances Levin
[15:49:45] [DOC: 9266454] ℹ️  Patient not found, creating new patient via API...
[15:49:45] [DOC: 9266454] ℹ️  Creating patient via API: Frances Levin
[15:49:46] [DOC: 9266454] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:49:46] ❌    ❌ Failed to create patient
[15:49:46] [DOC: 9266454] ℹ️  API push details saved for document 9266454
================================================================================
║                        Processing Document ID: 9266400                         ║
================================================================================
[15:49:46] ℹ️  Agency: Dartmouth HH
[15:49:46] ℹ️  Date: 04/29/2025
[15:49:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:49:48] [DOC: 9266400] ✅ Text extracted using pdfplumber (1886 chars)
[15:49:48] ✅    ✅ Text extracted using pdfplumber (1886 chars)
[15:49:48] 🔄 
🔄 Step 2: Extracting patient data...
[15:49:51] ℹ️  AI extracted raw sex value: 'F'
[15:49:51] ℹ️  AI extracted service line: 'RN'
[15:49:51] ℹ️  AI extracted payer source: 'Medicare'
[15:49:51] ℹ️  AI extracted diagnoses:
[15:49:51] ℹ️    - Diagnosis 1: 'None'
[15:49:51] ℹ️    - Diagnosis 2: 'None'
[15:49:51] ℹ️    - Diagnosis 3: 'None'
[15:49:51] ℹ️    - Diagnosis 4: 'None'
[15:49:51] ℹ️    - Diagnosis 5: 'None'
[15:49:51] ℹ️    - Diagnosis 6: 'None'
[15:49:51] ℹ️  Final extracted MRN: '6115015'
[15:49:51] ℹ️  Final extracted Sex: 'FEMALE'
[15:49:51] ℹ️  Final extracted Service Line: 'RN'
[15:49:51] ℹ️  Final extracted Payer Source: 'Medicare'
[15:49:51] ✅ Patient data extraction completed successfully
[15:49:51] ✅    ✅ Patient data extracted successfully
[15:49:51] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:49:51] ✅    ✅ Patient identified: Nancy Silva
[15:49:51] ✅    ✅ Patient name validation passed
[15:49:51] 🔄 
🔄 Step 3: Processing patient dates...
[15:49:51] [DOC: 9266400] ℹ️  DOB normalized: 11/18/1936
[15:49:51] [DOC: 9266400] ℹ️  Episode startOfCare normalized: 03/01/2025
[15:49:51] [DOC: 9266400] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[15:49:51] [DOC: 9266400] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[15:49:51] [DOC: 9266400] ✅ Patient date processing completed successfully
[15:49:51] ✅    ✅ Date processing completed
[15:49:51] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025'}]
[15:49:51] 🔄 
🔄 Step 4: Extracting order data...
[15:49:54] ℹ️  Order extraction - MRN: ''
[15:49:54] ℹ️  Order extraction - Sex: 'FEMALE'
[15:49:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:49:54] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:49:54] ✅ Order data extraction completed successfully
[15:49:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:49:54] ℹ️  Using MRN from patient data: '6115015'
[15:49:54] ℹ️  Combined service lines: Patient='RN' + Order='Skilled Nursing' = 'RN, Skilled Nursing'
[15:49:54] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:49:54] ✅ Patient name cross-validation successful
[15:49:54] ✅    ✅ Data merged successfully
[15:49:55] ✅    ✅ Order data extracted and validated
[15:49:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:49:59] [DOC: 9266400] ✅ Patient exists in API: Nancy Silva, ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[15:49:59] ✅    ✅ Existing patient found with ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[15:49:59] 🔄 
🔄 Step 6: Pushing order to API...
[15:49:59] [DOC: 9266400] ℹ️  Pushing order via API for patient ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[15:50:00] [DOC: 9266400] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:50:00] ❌    ❌ Failed to push order
[15:50:00] 🔄 
🔄 Step 7: Writing to CSV...
[15:50:00] [DOC: 9266400] ℹ️  Calculated age: 88 from DOB: 11/18/1936
[15:50:00] [DOC: 9266400] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[15:50:00] [DOC: 9266400] ℹ️  Payer Source extracted: 'Medicare'
[15:50:00] [DOC: 9266400] ℹ️  Diagnosis codes being written:
[15:50:00] [DOC: 9266400] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:50:00] [DOC: 9266400] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:50:00] [DOC: 9266400] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:50:00] [DOC: 9266400] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:50:00] [DOC: 9266400] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:50:00] [DOC: 9266400] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:50:00] [DOC: 9266400] ✅ Patient data written to CSV: Nancy Silva | Sex: FEMALE | Age: 88 | Service: RN, Skilled Nursing | Payer: Medicare | MRN: 6115015
[15:50:00] ✅    ✅ Document 9266400 processed and saved successfully
[15:50:00] 🔄 
🔄 Step 8: Saving API details...
[15:50:00] [DOC: 9266400] ℹ️  API push details saved for document 9266400
[15:50:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266383                         ║
================================================================================
[15:50:00] ℹ️  Agency: Dartmouth HH
[15:50:00] ℹ️  Date: 04/29/2025
[15:50:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:50:08] [DOC: 9266383] ✅ Text extracted using pdfplumber (5439 chars)
[15:50:08] ✅    ✅ Text extracted using pdfplumber (5439 chars)
[15:50:08] 🔄 
🔄 Step 2: Extracting patient data...
[15:50:11] ℹ️  AI extracted raw sex value: 'F'
[15:50:11] ℹ️  AI extracted service line: 'OT'
[15:50:11] ℹ️  AI extracted payer source: 'Medicare'
[15:50:11] ℹ️  AI extracted diagnoses:
[15:50:11] ℹ️    - Diagnosis 1: ''
[15:50:11] ℹ️    - Diagnosis 2: ''
[15:50:11] ℹ️    - Diagnosis 3: ''
[15:50:11] ℹ️    - Diagnosis 4: ''
[15:50:11] ℹ️    - Diagnosis 5: ''
[15:50:11] ℹ️    - Diagnosis 6: ''
[15:50:11] ℹ️  Final extracted MRN: '6338015'
[15:50:11] ℹ️  Final extracted Sex: 'FEMALE'
[15:50:11] ℹ️  Final extracted Service Line: 'OT'
[15:50:11] ℹ️  Final extracted Payer Source: 'Medicare'
[15:50:11] ✅ Patient data extraction completed successfully
[15:50:11] ✅    ✅ Patient data extracted successfully
[15:50:11] 📊 Patient Response
     └─ patientFName: Margaret
     └─ patientLName: Grassi
     └─ dob: 06/01/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6338015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:50:11] ✅    ✅ Patient identified: Margaret Grassi
[15:50:11] ✅    ✅ Patient name validation passed
[15:50:11] 🔄 
🔄 Step 3: Processing patient dates...
[15:50:11] [DOC: 9266383] ℹ️  DOB normalized: 06/01/1936
[15:50:11] [DOC: 9266383] ℹ️  Episode startOfCare normalized: 04/12/2025
[15:50:11] [DOC: 9266383] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[15:50:11] [DOC: 9266383] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[15:50:11] [DOC: 9266383] ✅ Patient date processing completed successfully
[15:50:11] ✅    ✅ Date processing completed
[15:50:11] 📊 Processed Patient Data
     └─ patientFName: Margaret
     └─ patientLName: Grassi
     └─ dob: 06/01/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6338015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:50:11] 🔄 
🔄 Step 4: Extracting order data...
[15:50:13] ℹ️  Order extraction - MRN: '6338015'
[15:50:13] ℹ️  Order extraction - Sex: 'FEMALE'
[15:50:13] ℹ️  Order extraction - Service Line: 'OT'
[15:50:13] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:50:13] ✅ Order data extraction completed successfully
[15:50:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:50:13] ℹ️  Using MRN from patient data: '6338015' over '6338015'
[15:50:13] ℹ️  Service line consistent in both sources: 'OT'
[15:50:13] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:50:13] ✅ Patient name cross-validation successful
[15:50:13] ✅    ✅ Data merged successfully
[15:50:14] ✅    ✅ Order data extracted and validated
[15:50:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:50:20] [DOC: 9266383] ✅ Patient exists in API: Margaret Grassi, ID: 5949b5c9-4a02-447c-81cd-ea7e69b42149
[15:50:20] ✅    ✅ Existing patient found with ID: 5949b5c9-4a02-447c-81cd-ea7e69b42149
[15:50:20] 🔄 
🔄 Step 6: Pushing order to API...
[15:50:20] [DOC: 9266383] ℹ️  Pushing order via API for patient ID: 5949b5c9-4a02-447c-81cd-ea7e69b42149
[15:50:21] [DOC: 9266383] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:50:21] ❌    ❌ Failed to push order
[15:50:21] 🔄 
🔄 Step 7: Writing to CSV...
[15:50:21] [DOC: 9266383] ℹ️  Calculated age: 89 from DOB: 06/01/1936
[15:50:21] [DOC: 9266383] ℹ️  Service Line extracted: 'OT'
[15:50:21] [DOC: 9266383] ℹ️  Payer Source extracted: 'Medicare'
[15:50:21] [DOC: 9266383] ℹ️  Diagnosis codes being written:
[15:50:21] [DOC: 9266383] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:50:21] [DOC: 9266383] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:50:21] [DOC: 9266383] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:50:21] [DOC: 9266383] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:50:21] [DOC: 9266383] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:50:21] [DOC: 9266383] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:50:21] [DOC: 9266383] ✅ Patient data written to CSV: Margaret Grassi | Sex: FEMALE | Age: 89 | Service: OT | Payer: Medicare | MRN: 6338015
[15:50:21] ✅    ✅ Document 9266383 processed and saved successfully
[15:50:21] 🔄 
🔄 Step 8: Saving API details...
[15:50:21] [DOC: 9266383] ℹ️  API push details saved for document 9266383
[15:50:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266373                         ║
================================================================================
[15:50:21] ℹ️  Agency: Dartmouth HH
[15:50:21] ℹ️  Date: 04/29/2025
[15:50:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:50:24] [DOC: 9266373] ✅ Text extracted using pdfplumber (18089 chars)
[15:50:24] ✅    ✅ Text extracted using pdfplumber (18077 chars)
[15:50:24] 🔄 
🔄 Step 2: Extracting patient data...
[15:50:27] ℹ️  AI extracted raw sex value: 'F'
[15:50:27] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[15:50:27] ℹ️  AI extracted payer source: ''
[15:50:27] ℹ️  AI extracted diagnoses:
[15:50:27] ℹ️    - Diagnosis 1: 'F03.B3'
[15:50:27] ℹ️    - Diagnosis 2: 'I12.9'
[15:50:27] ℹ️    - Diagnosis 3: 'E11.22'
[15:50:27] ℹ️    - Diagnosis 4: 'N18.31'
[15:50:27] ℹ️    - Diagnosis 5: 'M54.50'
[15:50:27] ℹ️    - Diagnosis 6: 'K86.2'
[15:50:27] ℹ️  Final extracted MRN: '227027'
[15:50:27] ℹ️  Final extracted Sex: 'FEMALE'
[15:50:27] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[15:50:27] ℹ️  Final extracted Payer Source: ''
[15:50:27] ✅ Patient data extraction completed successfully
[15:50:27] ✅    ✅ Patient data extracted successfully
[15:50:27] 📊 Patient Response
     └─ patientFName: Margaret
     └─ patientLName: Grassi
     └─ dob: 06/01/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'F03.B3', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'M54.50', 'sixthDiagnosis': 'K86.2'}]
[15:50:27] ✅    ✅ Patient identified: Margaret Grassi
[15:50:27] ✅    ✅ Patient name validation passed
[15:50:27] 🔄 
🔄 Step 3: Processing patient dates...
[15:50:27] [DOC: 9266373] ℹ️  DOB normalized: 06/01/1936
[15:50:27] [DOC: 9266373] ℹ️  Episode startOfCare normalized: 04/12/2025
[15:50:27] [DOC: 9266373] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[15:50:27] [DOC: 9266373] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[15:50:27] [DOC: 9266373] ✅ Patient date processing completed successfully
[15:50:27] ✅    ✅ Date processing completed
[15:50:27] 📊 Processed Patient Data
     └─ patientFName: Margaret
     └─ patientLName: Grassi
     └─ dob: 06/01/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'F03.B3', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'M54.50', 'sixthDiagnosis': 'K86.2'}]
[15:50:27] 🔄 
🔄 Step 4: Extracting order data...
[15:50:30] ℹ️  Order extraction - MRN: '227027'
[15:50:30] ℹ️  Order extraction - Sex: 'FEMALE'
[15:50:30] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[15:50:30] ℹ️  Order extraction - Payer Source: ''
[15:50:30] ✅ Order data extraction completed successfully
[15:50:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:50:30] ℹ️  Using MRN from patient data: '227027' over '227027'
[15:50:30] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[15:50:30] ✅ Patient name cross-validation successful
[15:50:30] ✅    ✅ Data merged successfully
[15:50:31] ✅    ✅ Order data extracted and validated
[15:50:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:50:31] [DOC: 9266373] ✅ Patient found in local cache: Margaret Grassi, ID: 5949b5c9-4a02-447c-81cd-ea7e69b42149
[15:50:31] ✅    ✅ Existing patient found with ID: 5949b5c9-4a02-447c-81cd-ea7e69b42149
[15:50:31] 🔄 
🔄 Step 6: Pushing order to API...
[15:50:31] [DOC: 9266373] ℹ️  Pushing order via API for patient ID: 5949b5c9-4a02-447c-81cd-ea7e69b42149
[15:50:32] [DOC: 9266373] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:50:32] ❌    ❌ Failed to push order
[15:50:32] 🔄 
🔄 Step 7: Writing to CSV...
[15:50:32] [DOC: 9266373] ℹ️  Calculated age: 89 from DOB: 06/01/1936
[15:50:32] [DOC: 9266373] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT'
[15:50:32] [DOC: 9266373] ℹ️  Payer Source extracted: ''
[15:50:32] [DOC: 9266373] ℹ️  Diagnosis codes being written:
[15:50:32] [DOC: 9266373] ℹ️    - Latest_Episode_Firstdiagnosis: 'F03.B3'
[15:50:32] [DOC: 9266373] ℹ️    - Latest_Episode_Seconddiagnosis: 'I12.9'
[15:50:32] [DOC: 9266373] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[15:50:32] [DOC: 9266373] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.31'
[15:50:32] [DOC: 9266373] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M54.50'
[15:50:32] [DOC: 9266373] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K86.2'
[15:50:32] [DOC: 9266373] ✅ Patient data written to CSV: Margaret Grassi | Sex: FEMALE | Age: 89 | Service: Skilled Nursing, PT, OT | Payer:  | MRN: 227027
[15:50:32] ✅    ✅ Document 9266373 processed and saved successfully
[15:50:32] 🔄 
🔄 Step 8: Saving API details...
[15:50:32] [DOC: 9266373] ℹ️  API push details saved for document 9266373
[15:50:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266355                         ║
================================================================================
[15:50:32] ℹ️  Agency: Dartmouth HH
[15:50:32] ℹ️  Date: 04/29/2025
[15:50:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:50:34] [DOC: 9266355] ✅ Text extracted using pdfplumber (1159 chars)
[15:50:34] ✅    ✅ Text extracted using pdfplumber (1159 chars)
[15:50:34] 🔄 
🔄 Step 2: Extracting patient data...
[15:50:37] ℹ️  AI extracted raw sex value: 'F'
[15:50:37] ℹ️  AI extracted service line: 'Physical Therapy'
[15:50:37] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[15:50:37] ℹ️  AI extracted diagnoses:
[15:50:37] ℹ️    - Diagnosis 1: ''
[15:50:37] ℹ️    - Diagnosis 2: ''
[15:50:37] ℹ️    - Diagnosis 3: ''
[15:50:37] ℹ️    - Diagnosis 4: ''
[15:50:37] ℹ️    - Diagnosis 5: ''
[15:50:37] ℹ️    - Diagnosis 6: ''
[15:50:37] ℹ️  Final extracted MRN: '6133015'
[15:50:37] ℹ️  Final extracted Sex: 'FEMALE'
[15:50:37] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:50:37] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[15:50:37] ✅ Patient data extraction completed successfully
[15:50:37] ✅    ✅ Patient data extracted successfully
[15:50:37] 📊 Patient Response
     └─ patientFName: Jacqueline
     └─ patientLName: DeTerra
     └─ dob: 11/04/1976
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6133015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:50:37] ✅    ✅ Patient identified: Jacqueline DeTerra
[15:50:37] ✅    ✅ Patient name validation passed
[15:50:37] 🔄 
🔄 Step 3: Processing patient dates...
[15:50:37] [DOC: 9266355] ℹ️  DOB normalized: 11/04/1976
[15:50:37] [DOC: 9266355] ℹ️  Episode startOfCare normalized: 04/03/2025
[15:50:37] [DOC: 9266355] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[15:50:37] [DOC: 9266355] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[15:50:37] [DOC: 9266355] ✅ Patient date processing completed successfully
[15:50:37] ✅    ✅ Date processing completed
[15:50:37] 📊 Processed Patient Data
     └─ patientFName: Jacqueline
     └─ patientLName: DeTerra
     └─ dob: 11/04/1976
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6133015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:50:37] 🔄 
🔄 Step 4: Extracting order data...
[15:50:40] ℹ️  Order extraction - MRN: ''
[15:50:40] ℹ️  Order extraction - Sex: 'FEMALE'
[15:50:40] ℹ️  Order extraction - Service Line: 'PT'
[15:50:40] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[15:50:40] ✅ Order data extraction completed successfully
[15:50:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:50:40] ℹ️  Using MRN from patient data: '6133015'
[15:50:40] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[15:50:40] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[15:50:40] ✅ Patient name cross-validation successful
[15:50:40] ✅    ✅ Data merged successfully
[15:50:41] ✅    ✅ Order data extracted and validated
[15:50:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:50:46] [DOC: 9266355] ✅ Patient exists in API: Jacqueline DeTerra, ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[15:50:46] ✅    ✅ Existing patient found with ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[15:50:46] 🔄 
🔄 Step 6: Pushing order to API...
[15:50:46] [DOC: 9266355] ℹ️  Pushing order via API for patient ID: 1ffeabe6-42ce-41e0-bf87-4c7a92801a2e
[15:50:47] [DOC: 9266355] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:50:47] ❌    ❌ Failed to push order
[15:50:47] 🔄 
🔄 Step 7: Writing to CSV...
[15:50:47] [DOC: 9266355] ℹ️  Calculated age: 48 from DOB: 11/04/1976
[15:50:47] [DOC: 9266355] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[15:50:47] [DOC: 9266355] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[15:50:47] [DOC: 9266355] ℹ️  Diagnosis codes being written:
[15:50:47] [DOC: 9266355] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:50:47] [DOC: 9266355] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:50:47] [DOC: 9266355] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:50:47] [DOC: 9266355] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:50:47] [DOC: 9266355] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:50:47] [DOC: 9266355] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:50:47] [DOC: 9266355] ✅ Patient data written to CSV: Jacqueline DeTerra | Sex: FEMALE | Age: 48 | Service: PT, Physical Therapy | Payer: Blue Cross Blue Shield | MRN: 6133015
[15:50:47] ✅    ✅ Document 9266355 processed and saved successfully
[15:50:47] 🔄 
🔄 Step 8: Saving API details...
[15:50:47] [DOC: 9266355] ℹ️  API push details saved for document 9266355
[15:50:47] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266352                         ║
================================================================================
[15:50:47] ℹ️  Agency: Dartmouth HH
[15:50:47] ℹ️  Date: 04/29/2025
[15:50:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:50:49] [DOC: 9266352] ✅ Text extracted using pdfplumber (2967 chars)
[15:50:49] ✅    ✅ Text extracted using pdfplumber (2967 chars)
[15:50:49] 🔄 
🔄 Step 2: Extracting patient data...
[15:50:51] ℹ️  AI extracted raw sex value: 'F'
[15:50:51] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:50:51] ℹ️  AI extracted payer source: 'Medicare'
[15:50:51] ℹ️  AI extracted diagnoses:
[15:50:51] ℹ️    - Diagnosis 1: ''
[15:50:51] ℹ️    - Diagnosis 2: ''
[15:50:51] ℹ️    - Diagnosis 3: ''
[15:50:51] ℹ️    - Diagnosis 4: ''
[15:50:51] ℹ️    - Diagnosis 5: ''
[15:50:51] ℹ️    - Diagnosis 6: ''
[15:50:51] ℹ️  Final extracted MRN: '2496015'
[15:50:51] ℹ️  Final extracted Sex: 'FEMALE'
[15:50:51] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:50:51] ℹ️  Final extracted Payer Source: 'Medicare'
[15:50:51] ✅ Patient data extraction completed successfully
[15:50:51] ✅    ✅ Patient data extracted successfully
[15:50:51] 📊 Patient Response
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '04/06/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:50:51] ✅    ✅ Patient identified: Dana Theodore
[15:50:51] ✅    ✅ Patient name validation passed
[15:50:51] 🔄 
🔄 Step 3: Processing patient dates...
[15:50:51] [DOC: 9266352] ℹ️  DOB normalized: 03/16/1954
[15:50:51] [DOC: 9266352] ℹ️  Episode startOfCare normalized: 03/02/2025
[15:50:51] [DOC: 9266352] ℹ️  Episode startOfEpisode normalized: 04/06/2025
[15:50:51] [DOC: 9266352] ℹ️  Episode endOfEpisode normalized: 04/30/2025
[15:50:51] [DOC: 9266352] ✅ Patient date processing completed successfully
[15:50:51] ✅    ✅ Date processing completed
[15:50:51] 📊 Processed Patient Data
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '04/06/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:50:51] 🔄 
🔄 Step 4: Extracting order data...
[15:50:54] ℹ️  Order extraction - MRN: '2496015'
[15:50:54] ℹ️  Order extraction - Sex: 'FEMALE'
[15:50:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:50:54] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:50:54] ✅ Order data extraction completed successfully
[15:50:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:50:54] ℹ️  Using MRN from patient data: '2496015' over '2496015'
[15:50:54] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:50:54] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:50:54] ✅ Patient name cross-validation successful
[15:50:54] ✅    ✅ Data merged successfully
[15:50:55] ✅    ✅ Order data extracted and validated
[15:50:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:51:05] [DOC: 9266352] ✅ Patient exists in API: Dana Theodore, ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[15:51:05] ✅    ✅ Existing patient found with ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[15:51:05] 🔄 
🔄 Step 6: Pushing order to API...
[15:51:05] [DOC: 9266352] ℹ️  Pushing order via API for patient ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[15:51:06] [DOC: 9266352] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:51:06] ❌    ❌ Failed to push order
[15:51:06] 🔄 
🔄 Step 7: Writing to CSV...
[15:51:06] [DOC: 9266352] ℹ️  Calculated age: 71 from DOB: 03/16/1954
[15:51:06] [DOC: 9266352] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:51:06] [DOC: 9266352] ℹ️  Payer Source extracted: 'Medicare'
[15:51:06] [DOC: 9266352] ℹ️  Diagnosis codes being written:
[15:51:06] [DOC: 9266352] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:51:06] [DOC: 9266352] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:51:06] [DOC: 9266352] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:51:06] [DOC: 9266352] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:51:06] [DOC: 9266352] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:51:06] [DOC: 9266352] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:51:06] [DOC: 9266352] ✅ Patient data written to CSV: Dana Theodore | Sex: FEMALE | Age: 71 | Service: Skilled Nursing | Payer: Medicare | MRN: 2496015
[15:51:06] ✅    ✅ Document 9266352 processed and saved successfully
[15:51:06] 🔄 
🔄 Step 8: Saving API details...
[15:51:06] [DOC: 9266352] ℹ️  API push details saved for document 9266352
[15:51:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266346                         ║
================================================================================
[15:51:06] ℹ️  Agency: Dartmouth HH
[15:51:06] ℹ️  Date: 04/29/2025
[15:51:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:51:08] [DOC: 9266346] ✅ Text extracted using pdfplumber (4692 chars)
[15:51:08] ✅    ✅ Text extracted using pdfplumber (4692 chars)
[15:51:08] 🔄 
🔄 Step 2: Extracting patient data...
[15:51:11] ℹ️  AI extracted raw sex value: 'F'
[15:51:11] ℹ️  AI extracted service line: 'PT'
[15:51:11] ℹ️  AI extracted payer source: 'Fallon Navicare'
[15:51:11] ℹ️  AI extracted diagnoses:
[15:51:11] ℹ️    - Diagnosis 1: ''
[15:51:11] ℹ️    - Diagnosis 2: ''
[15:51:11] ℹ️    - Diagnosis 3: ''
[15:51:11] ℹ️    - Diagnosis 4: ''
[15:51:11] ℹ️    - Diagnosis 5: ''
[15:51:11] ℹ️    - Diagnosis 6: ''
[15:51:11] ℹ️  Final extracted MRN: '6046015'
[15:51:11] ℹ️  Final extracted Sex: 'FEMALE'
[15:51:11] ℹ️  Final extracted Service Line: 'PT'
[15:51:11] ℹ️  Final extracted Payer Source: 'Fallon Navicare'
[15:51:11] ✅ Patient data extraction completed successfully
[15:51:11] ✅    ✅ Patient data extracted successfully
[15:51:11] 📊 Patient Response
     └─ patientFName: Joan
     └─ patientLName: Marion
     └─ dob: 01/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6046015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:51:11] ✅    ✅ Patient identified: Joan Marion
[15:51:11] ✅    ✅ Patient name validation passed
[15:51:11] 🔄 
🔄 Step 3: Processing patient dates...
[15:51:11] [DOC: 9266346] ℹ️  DOB normalized: 01/04/1955
[15:51:11] [DOC: 9266346] ℹ️  Episode startOfCare normalized: 03/25/2025
[15:51:11] [DOC: 9266346] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[15:51:11] [DOC: 9266346] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[15:51:11] [DOC: 9266346] ✅ Patient date processing completed successfully
[15:51:11] ✅    ✅ Date processing completed
[15:51:11] 📊 Processed Patient Data
     └─ patientFName: Joan
     └─ patientLName: Marion
     └─ dob: 01/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6046015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Fallon Navicare
     └─ episodeDiagnoses: [{'startOfCare': '03/25/2025', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:51:11] 🔄 
🔄 Step 4: Extracting order data...
[15:51:14] ℹ️  Order extraction - MRN: '6046015'
[15:51:14] ℹ️  Order extraction - Sex: 'FEMALE'
[15:51:14] ℹ️  Order extraction - Service Line: 'PT'
[15:51:14] ℹ️  Order extraction - Payer Source: 'Fallon Navicare'
[15:51:14] ✅ Order data extraction completed successfully
[15:51:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:51:14] ℹ️  Using MRN from patient data: '6046015' over '6046015'
[15:51:14] ℹ️  Service line consistent in both sources: 'PT'
[15:51:14] ℹ️  Payer source consistent in both sources: 'Fallon Navicare'
[15:51:14] ✅ Patient name cross-validation successful
[15:51:14] ✅    ✅ Data merged successfully
[15:51:15] ✅    ✅ Order data extracted and validated
[15:51:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:51:22] [DOC: 9266346] ℹ️  Patient not found in cache or API: Joan Marion
[15:51:22] [DOC: 9266346] ℹ️  Patient not found, creating new patient via API...
[15:51:22] [DOC: 9266346] ℹ️  Creating patient via API: Joan Marion
[15:51:23] [DOC: 9266346] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:51:23] ❌    ❌ Failed to create patient
[15:51:23] [DOC: 9266346] ℹ️  API push details saved for document 9266346
================================================================================
║                        Processing Document ID: 9266341                         ║
================================================================================
[15:51:23] ℹ️  Agency: Dartmouth HH
[15:51:23] ℹ️  Date: 04/29/2025
[15:51:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:51:25] [DOC: 9266341] ✅ Text extracted using pdfplumber (1378 chars)
[15:51:25] ✅    ✅ Text extracted using pdfplumber (1378 chars)
[15:51:25] 🔄 
🔄 Step 2: Extracting patient data...
[15:51:28] ℹ️  AI extracted raw sex value: 'F'
[15:51:28] ℹ️  AI extracted service line: 'Physical Therapy'
[15:51:28] ℹ️  AI extracted payer source: 'Harvard Pilgrim Health Care'
[15:51:28] ℹ️  AI extracted diagnoses:
[15:51:28] ℹ️    - Diagnosis 1: ''
[15:51:28] ℹ️    - Diagnosis 2: ''
[15:51:28] ℹ️    - Diagnosis 3: ''
[15:51:28] ℹ️    - Diagnosis 4: ''
[15:51:28] ℹ️    - Diagnosis 5: ''
[15:51:28] ℹ️    - Diagnosis 6: ''
[15:51:28] ℹ️  Final extracted MRN: '6275015'
[15:51:28] ℹ️  Final extracted Sex: 'FEMALE'
[15:51:28] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:51:28] ℹ️  Final extracted Payer Source: 'Harvard Pilgrim Health Care'
[15:51:28] ✅ Patient data extraction completed successfully
[15:51:28] ✅    ✅ Patient data extracted successfully
[15:51:28] 📊 Patient Response
     └─ patientFName: Annette
     └─ patientLName: Agrella
     └─ dob: 03/01/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6275015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Harvard Pilgrim Health Care
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:51:28] ✅    ✅ Patient identified: Annette Agrella
[15:51:28] ✅    ✅ Patient name validation passed
[15:51:28] 🔄 
🔄 Step 3: Processing patient dates...
[15:51:28] [DOC: 9266341] ℹ️  DOB normalized: 03/01/1959
[15:51:28] [DOC: 9266341] ℹ️  Episode startOfCare normalized: 03/26/2025
[15:51:28] [DOC: 9266341] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[15:51:28] [DOC: 9266341] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[15:51:28] [DOC: 9266341] ✅ Patient date processing completed successfully
[15:51:28] ✅    ✅ Date processing completed
[15:51:28] 📊 Processed Patient Data
     └─ patientFName: Annette
     └─ patientLName: Agrella
     └─ dob: 03/01/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6275015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Harvard Pilgrim Health Care
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:51:28] 🔄 
🔄 Step 4: Extracting order data...
[15:51:30] ℹ️  Order extraction - MRN: ''
[15:51:30] ℹ️  Order extraction - Sex: 'FEMALE'
[15:51:30] ℹ️  Order extraction - Service Line: 'PT'
[15:51:30] ℹ️  Order extraction - Payer Source: 'Harvard Pilgrim Health Care'
[15:51:30] ✅ Order data extraction completed successfully
[15:51:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:51:30] ℹ️  Using MRN from patient data: '6275015'
[15:51:30] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[15:51:30] ℹ️  Payer source consistent in both sources: 'Harvard Pilgrim Health Care'
[15:51:30] ✅ Patient name cross-validation successful
[15:51:30] ✅    ✅ Data merged successfully
[15:51:31] ✅    ✅ Order data extracted and validated
[15:51:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:52:00] [DOC: 9266341] ✅ Patient exists in API: Annette Agrella, ID: 9c8e5242-b427-4173-ad39-442e9229c97a
[15:52:00] ✅    ✅ Existing patient found with ID: 9c8e5242-b427-4173-ad39-442e9229c97a
[15:52:00] 🔄 
🔄 Step 6: Pushing order to API...
[15:52:00] [DOC: 9266341] ℹ️  Pushing order via API for patient ID: 9c8e5242-b427-4173-ad39-442e9229c97a
[15:52:01] [DOC: 9266341] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12853"}
[15:52:01] ❌    ❌ Failed to push order
[15:52:01] 🔄 
🔄 Step 7: Writing to CSV...
[15:52:01] [DOC: 9266341] ℹ️  Calculated age: 66 from DOB: 03/01/1959
[15:52:01] [DOC: 9266341] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[15:52:01] [DOC: 9266341] ℹ️  Payer Source extracted: 'Harvard Pilgrim Health Care'
[15:52:01] [DOC: 9266341] ℹ️  Diagnosis codes being written:
[15:52:01] [DOC: 9266341] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:52:01] [DOC: 9266341] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:52:01] [DOC: 9266341] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:52:01] [DOC: 9266341] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:52:01] [DOC: 9266341] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:52:01] [DOC: 9266341] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:52:01] [DOC: 9266341] ✅ Patient data written to CSV: Annette Agrella | Sex: FEMALE | Age: 66 | Service: PT, Physical Therapy | Payer: Harvard Pilgrim Health Care | MRN: 6275015
[15:52:01] ✅    ✅ Document 9266341 processed and saved successfully
[15:52:01] 🔄 
🔄 Step 8: Saving API details...
[15:52:01] [DOC: 9266341] ℹ️  API push details saved for document 9266341
[15:52:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266332                         ║
================================================================================
[15:52:01] ℹ️  Agency: Dartmouth HH
[15:52:01] ℹ️  Date: 04/29/2025
[15:52:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:52:04] [DOC: 9266332] ✅ Text extracted using pdfplumber (10899 chars)
[15:52:04] ✅    ✅ Text extracted using pdfplumber (10899 chars)
[15:52:04] 🔄 
🔄 Step 2: Extracting patient data...
[15:52:07] ℹ️  AI extracted raw sex value: 'M'
[15:52:07] ℹ️  AI extracted service line: 'PT'
[15:52:07] ℹ️  AI extracted payer source: 'None'
[15:52:07] ℹ️  AI extracted diagnoses:
[15:52:07] ℹ️    - Diagnosis 1: 'Z47.1'
[15:52:07] ℹ️    - Diagnosis 2: 'E66.3'
[15:52:07] ℹ️    - Diagnosis 3: 'Z68.28'
[15:52:07] ℹ️    - Diagnosis 4: 'I10'
[15:52:07] ℹ️    - Diagnosis 5: 'F41.9'
[15:52:07] ℹ️    - Diagnosis 6: 'R94.31'
[15:52:07] ℹ️  Final extracted MRN: '6171015'
[15:52:07] ℹ️  Final extracted Sex: 'MALE'
[15:52:07] ℹ️  Final extracted Service Line: 'PT'
[15:52:07] ℹ️  Final extracted Payer Source: ''
[15:52:07] ✅ Patient data extraction completed successfully
[15:52:07] ✅    ✅ Patient data extracted successfully
[15:52:07] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Twardzik
     └─ dob: 03/04/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 6171015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'E66.3', 'thirdDiagnosis': 'Z68.28', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'R94.31'}]
[15:52:07] ✅    ✅ Patient identified: John Twardzik
[15:52:07] ✅    ✅ Patient name validation passed
[15:52:07] 🔄 
🔄 Step 3: Processing patient dates...
[15:52:07] [DOC: 9266332] ℹ️  DOB normalized: 03/04/1952
[15:52:07] [DOC: 9266332] ℹ️  Episode startOfCare normalized: 04/12/2025
[15:52:07] [DOC: 9266332] ℹ️  Episode startOfEpisode normalized: 04/12/2025
[15:52:07] [DOC: 9266332] ℹ️  Episode endOfEpisode normalized: 06/10/2025
[15:52:07] [DOC: 9266332] ✅ Patient date processing completed successfully
[15:52:07] ✅    ✅ Date processing completed
[15:52:07] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Twardzik
     └─ dob: 03/04/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 6171015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/12/2025', 'startOfEpisode': '04/12/2025', 'endOfEpisode': '06/10/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'E66.3', 'thirdDiagnosis': 'Z68.28', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'F41.9', 'sixthDiagnosis': 'R94.31'}]
[15:52:07] 🔄 
🔄 Step 4: Extracting order data...
[15:52:09] ℹ️  Order extraction - MRN: '6171015'
[15:52:09] ℹ️  Order extraction - Sex: 'MALE'
[15:52:09] ℹ️  Order extraction - Service Line: 'PT'
[15:52:09] ℹ️  Order extraction - Payer Source: ''
[15:52:09] ✅ Order data extraction completed successfully
[15:52:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:52:09] ℹ️  Using MRN from patient data: '6171015' over '6171015'
[15:52:09] ℹ️  Service line consistent in both sources: 'PT'
[15:52:09] ✅ Patient name cross-validation successful
[15:52:09] ✅    ✅ Data merged successfully
[15:52:10] ✅    ✅ Order data extracted and validated
[15:52:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:52:17] [DOC: 9266332] ✅ Patient exists in API: John Twardzik, ID: 93692471-18b5-4de2-81ea-7b4be65fc767
[15:52:17] ✅    ✅ Existing patient found with ID: 93692471-18b5-4de2-81ea-7b4be65fc767
[15:52:17] 🔄 
🔄 Step 6: Pushing order to API...
[15:52:17] [DOC: 9266332] ℹ️  Pushing order via API for patient ID: 93692471-18b5-4de2-81ea-7b4be65fc767
[15:52:18] [DOC: 9266332] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:52:18] ❌    ❌ Failed to push order
[15:52:18] 🔄 
🔄 Step 7: Writing to CSV...
[15:52:18] [DOC: 9266332] ℹ️  Calculated age: 73 from DOB: 03/04/1952
[15:52:18] [DOC: 9266332] ℹ️  Service Line extracted: 'PT'
[15:52:18] [DOC: 9266332] ℹ️  Payer Source extracted: ''
[15:52:18] [DOC: 9266332] ℹ️  Diagnosis codes being written:
[15:52:18] [DOC: 9266332] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[15:52:18] [DOC: 9266332] ℹ️    - Latest_Episode_Seconddiagnosis: 'E66.3'
[15:52:18] [DOC: 9266332] ℹ️    - Latest_Episode_Thirddiagnosis: 'Z68.28'
[15:52:18] [DOC: 9266332] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[15:52:18] [DOC: 9266332] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F41.9'
[15:52:18] [DOC: 9266332] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R94.31'
[15:52:18] [DOC: 9266332] ✅ Patient data written to CSV: John Twardzik | Sex: MALE | Age: 73 | Service: PT | Payer:  | MRN: 6171015
[15:52:18] ✅    ✅ Document 9266332 processed and saved successfully
[15:52:18] 🔄 
🔄 Step 8: Saving API details...
[15:52:18] [DOC: 9266332] ℹ️  API push details saved for document 9266332
[15:52:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266306                         ║
================================================================================
[15:52:18] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[15:52:18] ℹ️  Date: 04/29/2025
[15:52:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:52:20] [DOC: 9266306] ✅ Text extracted using pdfplumber (1347 chars)
[15:52:20] ✅    ✅ Text extracted using pdfplumber (1347 chars)
[15:52:20] 🔄 
🔄 Step 2: Extracting patient data...
[15:52:23] ℹ️  AI extracted raw sex value: 'F'
[15:52:23] ℹ️  AI extracted service line: 'RN'
[15:52:23] ℹ️  AI extracted payer source: 'Senior Whole Health'
[15:52:23] ℹ️  AI extracted diagnoses:
[15:52:23] ℹ️    - Diagnosis 1: ''
[15:52:23] ℹ️    - Diagnosis 2: ''
[15:52:23] ℹ️    - Diagnosis 3: ''
[15:52:23] ℹ️    - Diagnosis 4: ''
[15:52:23] ℹ️    - Diagnosis 5: ''
[15:52:23] ℹ️    - Diagnosis 6: ''
[15:52:23] ℹ️  Final extracted MRN: '25'
[15:52:23] ℹ️  Final extracted Sex: 'FEMALE'
[15:52:23] ℹ️  Final extracted Service Line: 'RN'
[15:52:23] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[15:52:23] ✅ Patient data extraction completed successfully
[15:52:23] ✅    ✅ Patient data extracted successfully
[15:52:23] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Blake
     └─ dob: 07/06/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 25
     └─ billingProvider: Sirjana Dhungana Parajuli, MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 31B Sea Breeze Dr 2 d buzzer from the top
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '08/31/2010', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:52:23] ✅    ✅ Patient identified: Patricia Blake
[15:52:23] ✅    ✅ Patient name validation passed
[15:52:23] 🔄 
🔄 Step 3: Processing patient dates...
[15:52:23] [DOC: 9266306] ℹ️  DOB normalized: 07/06/1953
[15:52:23] [DOC: 9266306] ℹ️  Episode startOfCare normalized: 08/31/2010
[15:52:23] [DOC: 9266306] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[15:52:23] [DOC: 9266306] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[15:52:23] [DOC: 9266306] ✅ Patient date processing completed successfully
[15:52:23] ✅    ✅ Date processing completed
[15:52:23] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Blake
     └─ dob: 07/06/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 25
     └─ billingProvider: Sirjana Dhungana Parajuli, MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 31B Sea Breeze Dr 2 d buzzer from the top
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: RN
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '08/31/2010', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:52:23] 🔄 
🔄 Step 4: Extracting order data...
[15:52:25] ℹ️  Order extraction - MRN: '25'
[15:52:25] ℹ️  Order extraction - Sex: 'FEMALE'
[15:52:25] ℹ️  Order extraction - Service Line: 'HHA'
[15:52:25] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[15:52:25] ✅ Order data extraction completed successfully
[15:52:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:52:25] ℹ️  Using MRN from patient data: '25' over '25'
[15:52:25] ℹ️  Combined service lines: Patient='RN' + Order='HHA' = 'HHA, RN'
[15:52:25] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[15:52:25] ✅ Patient name cross-validation successful
[15:52:25] ✅    ✅ Data merged successfully
[15:52:26] ✅    ✅ Order data extracted and validated
[15:52:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:52:45] [DOC: 9266306] ✅ Patient exists in API: Patricia Blake, ID: c3be0353-a867-454e-b7c1-4aae5231d30d
[15:52:45] ✅    ✅ Existing patient found with ID: c3be0353-a867-454e-b7c1-4aae5231d30d
[15:52:45] 🔄 
🔄 Step 6: Pushing order to API...
[15:52:45] [DOC: 9266306] ℹ️  Pushing order via API for patient ID: c3be0353-a867-454e-b7c1-4aae5231d30d
[15:52:46] [DOC: 9266306] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:52:46] ❌    ❌ Failed to push order
[15:52:46] 🔄 
🔄 Step 7: Writing to CSV...
[15:52:46] [DOC: 9266306] ℹ️  Calculated age: 71 from DOB: 07/06/1953
[15:52:46] [DOC: 9266306] ℹ️  Service Line extracted: 'HHA, RN'
[15:52:46] [DOC: 9266306] ℹ️  Payer Source extracted: 'Senior Whole Health'
[15:52:46] [DOC: 9266306] ℹ️  Diagnosis codes being written:
[15:52:46] [DOC: 9266306] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:52:46] [DOC: 9266306] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:52:46] [DOC: 9266306] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:52:46] [DOC: 9266306] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:52:46] [DOC: 9266306] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:52:46] [DOC: 9266306] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:52:46] [DOC: 9266306] ✅ Patient data written to CSV: Patricia Blake | Sex: FEMALE | Age: 71 | Service: HHA, RN | Payer: Senior Whole Health | MRN: 25
[15:52:46] ✅    ✅ Document 9266306 processed and saved successfully
[15:52:46] 🔄 
🔄 Step 8: Saving API details...
[15:52:46] [DOC: 9266306] ℹ️  API push details saved for document 9266306
[15:52:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266292                         ║
================================================================================
[15:52:46] ℹ️  Agency: Dartmouth HH
[15:52:46] ℹ️  Date: 04/29/2025
[15:52:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:52:48] [DOC: 9266292] ✅ Text extracted using pdfplumber (1046 chars)
[15:52:48] ✅    ✅ Text extracted using pdfplumber (1046 chars)
[15:52:48] 🔄 
🔄 Step 2: Extracting patient data...
[15:52:50] ℹ️  AI extracted raw sex value: 'F'
[15:52:50] ℹ️  AI extracted service line: 'PT'
[15:52:50] ℹ️  AI extracted payer source: 'Wellpoint'
[15:52:50] ℹ️  AI extracted diagnoses:
[15:52:50] ℹ️    - Diagnosis 1: ''
[15:52:50] ℹ️    - Diagnosis 2: ''
[15:52:50] ℹ️    - Diagnosis 3: ''
[15:52:50] ℹ️    - Diagnosis 4: ''
[15:52:50] ℹ️    - Diagnosis 5: ''
[15:52:50] ℹ️    - Diagnosis 6: ''
[15:52:50] ℹ️  Final extracted MRN: '3140011'
[15:52:50] ℹ️  Final extracted Sex: 'FEMALE'
[15:52:50] ℹ️  Final extracted Service Line: 'PT'
[15:52:50] ℹ️  Final extracted Payer Source: 'Wellpoint'
[15:52:50] ✅ Patient data extraction completed successfully
[15:52:50] ✅    ✅ Patient data extracted successfully
[15:52:50] 📊 Patient Response
     └─ patientFName: Tania
     └─ patientLName: Nicolet
     └─ dob: 11/01/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3140011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Wellpoint
     └─ episodeDiagnoses: [{'startOfCare': '04/15/2025', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:52:50] ✅    ✅ Patient identified: Tania Nicolet
[15:52:50] ✅    ✅ Patient name validation passed
[15:52:50] 🔄 
🔄 Step 3: Processing patient dates...
[15:52:50] [DOC: 9266292] ℹ️  DOB normalized: 11/01/1929
[15:52:50] [DOC: 9266292] ℹ️  Episode startOfCare normalized: 04/15/2025
[15:52:50] [DOC: 9266292] ℹ️  Episode startOfEpisode normalized: 04/15/2025
[15:52:50] [DOC: 9266292] ℹ️  Episode endOfEpisode normalized: 06/13/2025
[15:52:50] [DOC: 9266292] ✅ Patient date processing completed successfully
[15:52:50] ✅    ✅ Date processing completed
[15:52:50] 📊 Processed Patient Data
     └─ patientFName: Tania
     └─ patientLName: Nicolet
     └─ dob: 11/01/1929
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3140011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Wellpoint
     └─ episodeDiagnoses: [{'startOfCare': '04/15/2025', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:52:50] 🔄 
🔄 Step 4: Extracting order data...
[15:52:53] ℹ️  Order extraction - MRN: ''
[15:52:53] ℹ️  Order extraction - Sex: 'FEMALE'
[15:52:53] ℹ️  Order extraction - Service Line: 'PT'
[15:52:53] ℹ️  Order extraction - Payer Source: 'Wellpoint'
[15:52:53] ✅ Order data extraction completed successfully
[15:52:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:52:53] ℹ️  Using MRN from patient data: '3140011'
[15:52:53] ℹ️  Service line consistent in both sources: 'PT'
[15:52:53] ℹ️  Payer source consistent in both sources: 'Wellpoint'
[15:52:53] ✅ Patient name cross-validation successful
[15:52:53] ✅    ✅ Data merged successfully
[15:52:54] ✅    ✅ Order data extracted and validated
[15:52:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:52:54] [DOC: 9266292] ✅ Patient found in local cache: Tania Nicolet, ID: f2093759-4696-49f4-a31d-9a5ae07439d0
[15:52:54] ✅    ✅ Existing patient found with ID: f2093759-4696-49f4-a31d-9a5ae07439d0
[15:52:54] 🔄 
🔄 Step 6: Pushing order to API...
[15:52:54] [DOC: 9266292] ℹ️  Pushing order via API for patient ID: f2093759-4696-49f4-a31d-9a5ae07439d0
[15:52:56] [DOC: 9266292] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:52:56] ❌    ❌ Failed to push order
[15:52:56] 🔄 
🔄 Step 7: Writing to CSV...
[15:52:56] [DOC: 9266292] ℹ️  Calculated age: 95 from DOB: 11/01/1929
[15:52:56] [DOC: 9266292] ℹ️  Service Line extracted: 'PT'
[15:52:56] [DOC: 9266292] ℹ️  Payer Source extracted: 'Wellpoint'
[15:52:56] [DOC: 9266292] ℹ️  Diagnosis codes being written:
[15:52:56] [DOC: 9266292] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:52:56] [DOC: 9266292] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:52:56] [DOC: 9266292] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:52:56] [DOC: 9266292] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:52:56] [DOC: 9266292] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:52:56] [DOC: 9266292] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:52:56] [DOC: 9266292] ✅ Patient data written to CSV: Tania Nicolet | Sex: FEMALE | Age: 95 | Service: PT | Payer: Wellpoint | MRN: 3140011
[15:52:56] ✅    ✅ Document 9266292 processed and saved successfully
[15:52:56] 🔄 
🔄 Step 8: Saving API details...
[15:52:56] [DOC: 9266292] ℹ️  API push details saved for document 9266292
[15:52:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266288                         ║
================================================================================
[15:52:56] ℹ️  Agency: Dartmouth HH
[15:52:56] ℹ️  Date: 04/29/2025
[15:52:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:52:58] [DOC: 9266288] ✅ Text extracted using pdfplumber (1688 chars)
[15:52:58] ✅    ✅ Text extracted using pdfplumber (1688 chars)
[15:52:58] 🔄 
🔄 Step 2: Extracting patient data...
[15:53:00] ℹ️  AI extracted raw sex value: 'F'
[15:53:00] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:53:00] ℹ️  AI extracted payer source: 'Senior Whole Health'
[15:53:00] ℹ️  AI extracted diagnoses:
[15:53:00] ℹ️    - Diagnosis 1: ''
[15:53:00] ℹ️    - Diagnosis 2: ''
[15:53:00] ℹ️    - Diagnosis 3: ''
[15:53:00] ℹ️    - Diagnosis 4: ''
[15:53:00] ℹ️    - Diagnosis 5: ''
[15:53:00] ℹ️    - Diagnosis 6: ''
[15:53:00] ℹ️  Final extracted MRN: '3177001'
[15:53:00] ℹ️  Final extracted Sex: 'FEMALE'
[15:53:00] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:53:00] ℹ️  Final extracted Payer Source: 'Senior Whole Health'
[15:53:00] ✅ Patient data extraction completed successfully
[15:53:00] ✅    ✅ Patient data extracted successfully
[15:53:00] 📊 Patient Response
     └─ patientFName: Dorothy
     └─ patientLName: Lynch
     └─ dob: 03/16/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3177001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 68 Chancery Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:53:00] ✅    ✅ Patient identified: Dorothy Lynch
[15:53:00] ✅    ✅ Patient name validation passed
[15:53:00] 🔄 
🔄 Step 3: Processing patient dates...
[15:53:00] [DOC: 9266288] ℹ️  DOB normalized: 03/16/1932
[15:53:00] [DOC: 9266288] ℹ️  Episode startOfCare normalized: 03/12/2025
[15:53:00] [DOC: 9266288] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[15:53:00] [DOC: 9266288] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[15:53:00] [DOC: 9266288] ✅ Patient date processing completed successfully
[15:53:00] ✅    ✅ Date processing completed
[15:53:00] 📊 Processed Patient Data
     └─ patientFName: Dorothy
     └─ patientLName: Lynch
     └─ dob: 03/16/1932
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3177001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 68 Chancery Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Senior Whole Health
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:53:00] 🔄 
🔄 Step 4: Extracting order data...
[15:53:03] ℹ️  Order extraction - MRN: '3177001'
[15:53:03] ℹ️  Order extraction - Sex: 'FEMALE'
[15:53:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:53:03] ℹ️  Order extraction - Payer Source: 'Senior Whole Health'
[15:53:03] ✅ Order data extraction completed successfully
[15:53:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:53:03] ℹ️  Using MRN from patient data: '3177001' over '3177001'
[15:53:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:53:03] ℹ️  Payer source consistent in both sources: 'Senior Whole Health'
[15:53:03] ✅ Patient name cross-validation successful
[15:53:03] ✅    ✅ Data merged successfully
[15:53:05] ✅    ✅ Order data extracted and validated
[15:53:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:53:28] [DOC: 9266288] ✅ Patient exists in API: Dorothy Lynch, ID: d21b3eef-f066-47f0-b26e-3663176af82f
[15:53:28] ✅    ✅ Existing patient found with ID: d21b3eef-f066-47f0-b26e-3663176af82f
[15:53:28] 🔄 
🔄 Step 6: Pushing order to API...
[15:53:28] [DOC: 9266288] ℹ️  Pushing order via API for patient ID: d21b3eef-f066-47f0-b26e-3663176af82f
[15:53:29] [DOC: 9266288] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:53:29] ❌    ❌ Failed to push order
[15:53:29] 🔄 
🔄 Step 7: Writing to CSV...
[15:53:29] [DOC: 9266288] ℹ️  Calculated age: 93 from DOB: 03/16/1932
[15:53:29] [DOC: 9266288] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:53:29] [DOC: 9266288] ℹ️  Payer Source extracted: 'Senior Whole Health'
[15:53:29] [DOC: 9266288] ℹ️  Diagnosis codes being written:
[15:53:29] [DOC: 9266288] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:53:29] [DOC: 9266288] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:53:29] [DOC: 9266288] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:53:29] [DOC: 9266288] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:53:29] [DOC: 9266288] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:53:29] [DOC: 9266288] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:53:29] [DOC: 9266288] ✅ Patient data written to CSV: Dorothy Lynch | Sex: FEMALE | Age: 93 | Service: Skilled Nursing | Payer: Senior Whole Health | MRN: 3177001
[15:53:29] ✅    ✅ Document 9266288 processed and saved successfully
[15:53:29] 🔄 
🔄 Step 8: Saving API details...
[15:53:29] [DOC: 9266288] ℹ️  API push details saved for document 9266288
[15:53:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266284                         ║
================================================================================
[15:53:29] ℹ️  Agency: Dartmouth HH
[15:53:29] ℹ️  Date: 04/29/2025
[15:53:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:53:32] [DOC: 9266284] ✅ Text extracted using pdfplumber (1199 chars)
[15:53:32] ✅    ✅ Text extracted using pdfplumber (1199 chars)
[15:53:32] 🔄 
🔄 Step 2: Extracting patient data...
[15:53:34] ℹ️  AI extracted raw sex value: 'M'
[15:53:34] ℹ️  AI extracted service line: 'HHA'
[15:53:34] ℹ️  AI extracted payer source: 'Medicare'
[15:53:34] ℹ️  AI extracted diagnoses:
[15:53:34] ℹ️    - Diagnosis 1: 'None'
[15:53:34] ℹ️    - Diagnosis 2: 'None'
[15:53:34] ℹ️    - Diagnosis 3: 'None'
[15:53:34] ℹ️    - Diagnosis 4: 'None'
[15:53:34] ℹ️    - Diagnosis 5: 'None'
[15:53:34] ℹ️    - Diagnosis 6: 'None'
[15:53:34] ℹ️  Final extracted MRN: '7573009'
[15:53:34] ℹ️  Final extracted Sex: 'MALE'
[15:53:34] ℹ️  Final extracted Service Line: 'HHA'
[15:53:34] ℹ️  Final extracted Payer Source: 'Medicare'
[15:53:34] ✅ Patient data extraction completed successfully
[15:53:34] ✅    ✅ Patient data extracted successfully
[15:53:34] 📊 Patient Response
     └─ patientFName: Daniel
     └─ patientLName: Felix
     └─ dob: 01/07/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 7573009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 36 Sagamore Street Apt 1
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:53:34] ✅    ✅ Patient identified: Daniel Felix
[15:53:34] ✅    ✅ Patient name validation passed
[15:53:34] 🔄 
🔄 Step 3: Processing patient dates...
[15:53:34] [DOC: 9266284] ℹ️  DOB normalized: 01/07/1935
[15:53:34] [DOC: 9266284] ℹ️  Episode startOfCare normalized: 04/11/2025
[15:53:34] [DOC: 9266284] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[15:53:34] [DOC: 9266284] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[15:53:34] [DOC: 9266284] ✅ Patient date processing completed successfully
[15:53:34] ✅    ✅ Date processing completed
[15:53:34] 📊 Processed Patient Data
     └─ patientFName: Daniel
     └─ patientLName: Felix
     └─ dob: 01/07/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 7573009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 36 Sagamore Street Apt 1
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025'}]
[15:53:34] 🔄 
🔄 Step 4: Extracting order data...
[15:53:37] ℹ️  Order extraction - MRN: ''
[15:53:37] ℹ️  Order extraction - Sex: 'MALE'
[15:53:37] ℹ️  Order extraction - Service Line: ''
[15:53:37] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:53:37] ✅ Order data extraction completed successfully
[15:53:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:53:37] ℹ️  Using MRN from patient data: '7573009'
[15:53:37] ℹ️  Using service line from patient data: 'HHA'
[15:53:37] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:53:37] ✅ Patient name cross-validation successful
[15:53:37] ✅    ✅ Data merged successfully
[15:53:38] ✅    ✅ Order data extracted and validated
[15:53:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:53:48] [DOC: 9266284] ✅ Patient exists in API: Daniel Felix, ID: 04bf1e2c-cacc-4b16-82d9-9579cddb7f3b
[15:53:48] ✅    ✅ Existing patient found with ID: 04bf1e2c-cacc-4b16-82d9-9579cddb7f3b
[15:53:48] 🔄 
🔄 Step 6: Pushing order to API...
[15:53:48] [DOC: 9266284] ℹ️  Pushing order via API for patient ID: 04bf1e2c-cacc-4b16-82d9-9579cddb7f3b
[15:53:50] [DOC: 9266284] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13950"}
[15:53:50] ❌    ❌ Failed to push order
[15:53:50] 🔄 
🔄 Step 7: Writing to CSV...
[15:53:50] [DOC: 9266284] ℹ️  Calculated age: 90 from DOB: 01/07/1935
[15:53:50] [DOC: 9266284] ℹ️  Service Line extracted: 'HHA'
[15:53:50] [DOC: 9266284] ℹ️  Payer Source extracted: 'Medicare'
[15:53:50] [DOC: 9266284] ℹ️  Diagnosis codes being written:
[15:53:50] [DOC: 9266284] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:53:50] [DOC: 9266284] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:53:50] [DOC: 9266284] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:53:50] [DOC: 9266284] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:53:50] [DOC: 9266284] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:53:50] [DOC: 9266284] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:53:50] [DOC: 9266284] ✅ Patient data written to CSV: Daniel Felix | Sex: MALE | Age: 90 | Service: HHA | Payer: Medicare | MRN: 7573009
[15:53:50] ✅    ✅ Document 9266284 processed and saved successfully
[15:53:50] 🔄 
🔄 Step 8: Saving API details...
[15:53:50] [DOC: 9266284] ℹ️  API push details saved for document 9266284
[15:53:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266282                         ║
================================================================================
[15:53:50] ℹ️  Agency: Dartmouth HH
[15:53:50] ℹ️  Date: 04/29/2025
[15:53:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:53:52] [DOC: 9266282] ✅ Text extracted using pdfplumber (3403 chars)
[15:53:52] ✅    ✅ Text extracted using pdfplumber (3403 chars)
[15:53:52] 🔄 
🔄 Step 2: Extracting patient data...
[15:53:55] ℹ️  AI extracted raw sex value: 'F'
[15:53:55] ℹ️  AI extracted service line: 'Physical Therapy'
[15:53:55] ℹ️  AI extracted payer source: 'Medicare'
[15:53:55] ℹ️  AI extracted diagnoses:
[15:53:55] ℹ️    - Diagnosis 1: ''
[15:53:55] ℹ️    - Diagnosis 2: ''
[15:53:55] ℹ️    - Diagnosis 3: ''
[15:53:55] ℹ️    - Diagnosis 4: ''
[15:53:55] ℹ️    - Diagnosis 5: ''
[15:53:55] ℹ️    - Diagnosis 6: ''
[15:53:55] ℹ️  Final extracted MRN: '6176015'
[15:53:55] ℹ️  Final extracted Sex: 'FEMALE'
[15:53:55] ℹ️  Final extracted Service Line: 'Physical Therapy'
[15:53:55] ℹ️  Final extracted Payer Source: 'Medicare'
[15:53:55] ✅ Patient data extraction completed successfully
[15:53:55] ✅    ✅ Patient data extracted successfully
[15:53:55] 📊 Patient Response
     └─ patientFName: Carol
     └─ patientLName: Wester
     └─ dob: 09/10/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6176015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:53:55] ✅    ✅ Patient identified: Carol Wester
[15:53:55] ✅    ✅ Patient name validation passed
[15:53:55] 🔄 
🔄 Step 3: Processing patient dates...
[15:53:55] [DOC: 9266282] ℹ️  DOB normalized: 09/10/1954
[15:53:55] [DOC: 9266282] ℹ️  Episode startOfCare normalized: 03/24/2025
[15:53:55] [DOC: 9266282] ℹ️  Episode startOfEpisode normalized: 03/24/2025
[15:53:55] [DOC: 9266282] ℹ️  Episode endOfEpisode normalized: 05/22/2025
[15:53:55] [DOC: 9266282] ✅ Patient date processing completed successfully
[15:53:55] ✅    ✅ Date processing completed
[15:53:55] 📊 Processed Patient Data
     └─ patientFName: Carol
     └─ patientLName: Wester
     └─ dob: 09/10/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6176015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/24/2025', 'startOfEpisode': '03/24/2025', 'endOfEpisode': '05/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:53:55] 🔄 
🔄 Step 4: Extracting order data...
[15:53:57] ℹ️  Order extraction - MRN: ''
[15:53:57] ℹ️  Order extraction - Sex: 'FEMALE'
[15:53:57] ℹ️  Order extraction - Service Line: 'PT'
[15:53:57] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:53:57] ✅ Order data extraction completed successfully
[15:53:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:53:57] ℹ️  Using MRN from patient data: '6176015'
[15:53:57] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[15:53:57] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:53:57] ✅ Patient name cross-validation successful
[15:53:57] ✅    ✅ Data merged successfully
[15:53:58] ✅    ✅ Order data extracted and validated
[15:53:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:54:20] [DOC: 9266282] ✅ Patient exists in API: Carol Wester, ID: b763e805-3270-49ff-8d1f-3bc7befacc58
[15:54:20] ✅    ✅ Existing patient found with ID: b763e805-3270-49ff-8d1f-3bc7befacc58
[15:54:20] 🔄 
🔄 Step 6: Pushing order to API...
[15:54:20] [DOC: 9266282] ℹ️  Pushing order via API for patient ID: b763e805-3270-49ff-8d1f-3bc7befacc58
[15:54:21] [DOC: 9266282] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14652"}
[15:54:21] ❌    ❌ Failed to push order
[15:54:21] 🔄 
🔄 Step 7: Writing to CSV...
[15:54:21] [DOC: 9266282] ℹ️  Calculated age: 70 from DOB: 09/10/1954
[15:54:21] [DOC: 9266282] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[15:54:21] [DOC: 9266282] ℹ️  Payer Source extracted: 'Medicare'
[15:54:21] [DOC: 9266282] ℹ️  Diagnosis codes being written:
[15:54:21] [DOC: 9266282] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:54:21] [DOC: 9266282] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:54:21] [DOC: 9266282] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:54:21] [DOC: 9266282] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:54:21] [DOC: 9266282] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:54:21] [DOC: 9266282] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:54:21] [DOC: 9266282] ✅ Patient data written to CSV: Carol Wester | Sex: FEMALE | Age: 70 | Service: PT, Physical Therapy | Payer: Medicare | MRN: 6176015
[15:54:21] ✅    ✅ Document 9266282 processed and saved successfully
[15:54:21] 🔄 
🔄 Step 8: Saving API details...
[15:54:21] [DOC: 9266282] ℹ️  API push details saved for document 9266282
[15:54:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266280                         ║
================================================================================
[15:54:21] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[15:54:21] ℹ️  Date: 04/29/2025
[15:54:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:54:23] [DOC: 9266280] ✅ Text extracted using pdfplumber (1278 chars)
[15:54:23] ✅    ✅ Text extracted using pdfplumber (1278 chars)
[15:54:23] 🔄 
🔄 Step 2: Extracting patient data...
[15:54:26] ℹ️  AI extracted raw sex value: 'F'
[15:54:26] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:54:26] ℹ️  AI extracted payer source: 'Medicaid/MA'
[15:54:26] ℹ️  AI extracted diagnoses:
[15:54:26] ℹ️    - Diagnosis 1: ''
[15:54:26] ℹ️    - Diagnosis 2: ''
[15:54:26] ℹ️    - Diagnosis 3: ''
[15:54:26] ℹ️    - Diagnosis 4: ''
[15:54:26] ℹ️    - Diagnosis 5: ''
[15:54:26] ℹ️    - Diagnosis 6: ''
[15:54:26] ℹ️  Final extracted MRN: '554005'
[15:54:26] ℹ️  Final extracted Sex: 'FEMALE'
[15:54:26] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:54:26] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[15:54:26] ✅ Patient data extraction completed successfully
[15:54:26] ✅    ✅ Patient data extracted successfully
[15:54:26] 📊 Patient Response
     └─ patientFName: Yomayra
     └─ patientLName: Velez-Morales
     └─ dob: 10/26/1975
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 554005
     └─ billingProvider: Robert J Caldas, MD
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '06/04/2024', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:54:26] ✅    ✅ Patient identified: Yomayra Velez-Morales
[15:54:26] ✅    ✅ Patient name validation passed
[15:54:26] 🔄 
🔄 Step 3: Processing patient dates...
[15:54:26] [DOC: 9266280] ℹ️  DOB normalized: 10/26/1975
[15:54:26] [DOC: 9266280] ℹ️  Episode startOfCare normalized: 06/04/2024
[15:54:26] [DOC: 9266280] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[15:54:26] [DOC: 9266280] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[15:54:26] [DOC: 9266280] ✅ Patient date processing completed successfully
[15:54:26] ✅    ✅ Date processing completed
[15:54:26] 📊 Processed Patient Data
     └─ patientFName: Yomayra
     └─ patientLName: Velez-Morales
     └─ dob: 10/26/1975
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 554005
     └─ billingProvider: Robert J Caldas, MD
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '06/04/2024', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:54:26] 🔄 
🔄 Step 4: Extracting order data...
[15:54:28] ℹ️  Order extraction - MRN: '554005'
[15:54:28] ℹ️  Order extraction - Sex: 'FEMALE'
[15:54:28] ℹ️  Order extraction - Service Line: 'HHA'
[15:54:28] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[15:54:28] ✅ Order data extraction completed successfully
[15:54:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:54:28] ℹ️  Using MRN from patient data: '554005' over '554005'
[15:54:28] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='HHA' = 'HHA, Skilled Nursing'
[15:54:28] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[15:54:28] ✅ Patient name cross-validation successful
[15:54:28] ✅    ✅ Data merged successfully
[15:54:30] ✅    ✅ Order data extracted and validated
[15:54:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:54:30] [DOC: 9266280] ✅ Patient found in local cache: Yomayra Velez-Morales, ID: e98d4286-e41f-4b12-99e1-b508f6e5aa92
[15:54:30] ✅    ✅ Existing patient found with ID: e98d4286-e41f-4b12-99e1-b508f6e5aa92
[15:54:30] 🔄 
🔄 Step 6: Pushing order to API...
[15:54:30] [DOC: 9266280] ℹ️  Pushing order via API for patient ID: e98d4286-e41f-4b12-99e1-b508f6e5aa92
[15:54:31] [DOC: 9266280] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:54:31] ❌    ❌ Failed to push order
[15:54:31] 🔄 
🔄 Step 7: Writing to CSV...
[15:54:31] [DOC: 9266280] ℹ️  Calculated age: 49 from DOB: 10/26/1975
[15:54:31] [DOC: 9266280] ℹ️  Service Line extracted: 'HHA, Skilled Nursing'
[15:54:31] [DOC: 9266280] ℹ️  Payer Source extracted: 'Medicaid/MA'
[15:54:31] [DOC: 9266280] ℹ️  Diagnosis codes being written:
[15:54:31] [DOC: 9266280] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:54:31] [DOC: 9266280] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:54:31] [DOC: 9266280] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:54:31] [DOC: 9266280] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:54:31] [DOC: 9266280] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:54:31] [DOC: 9266280] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:54:31] [DOC: 9266280] ✅ Patient data written to CSV: Yomayra Velez-Morales | Sex: FEMALE | Age: 49 | Service: HHA, Skilled Nursing | Payer: Medicaid/MA | MRN: 554005
[15:54:31] ✅    ✅ Document 9266280 processed and saved successfully
[15:54:31] 🔄 
🔄 Step 8: Saving API details...
[15:54:31] [DOC: 9266280] ℹ️  API push details saved for document 9266280
[15:54:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266278                         ║
================================================================================
[15:54:31] ℹ️  Agency: Dartmouth HH
[15:54:31] ℹ️  Date: 04/29/2025
[15:54:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:54:33] [DOC: 9266278] ✅ Text extracted using pdfplumber (1487 chars)
[15:54:33] ✅    ✅ Text extracted using pdfplumber (1487 chars)
[15:54:33] 🔄 
🔄 Step 2: Extracting patient data...
[15:54:35] ℹ️  AI extracted raw sex value: 'M'
[15:54:35] ℹ️  AI extracted service line: 'PT'
[15:54:35] ℹ️  AI extracted payer source: 'Medicare'
[15:54:35] ℹ️  AI extracted diagnoses:
[15:54:35] ℹ️    - Diagnosis 1: ''
[15:54:35] ℹ️    - Diagnosis 2: ''
[15:54:35] ℹ️    - Diagnosis 3: ''
[15:54:35] ℹ️    - Diagnosis 4: ''
[15:54:35] ℹ️    - Diagnosis 5: ''
[15:54:35] ℹ️    - Diagnosis 6: ''
[15:54:35] ℹ️  Final extracted MRN: '5671015'
[15:54:35] ℹ️  Final extracted Sex: 'MALE'
[15:54:35] ℹ️  Final extracted Service Line: 'PT'
[15:54:35] ℹ️  Final extracted Payer Source: 'Medicare'
[15:54:35] ✅ Patient data extraction completed successfully
[15:54:35] ✅    ✅ Patient data extracted successfully
[15:54:35] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Osborne
     └─ dob: 10/21/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 5671015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:54:35] ✅    ✅ Patient identified: James Osborne
[15:54:35] ✅    ✅ Patient name validation passed
[15:54:35] 🔄 
🔄 Step 3: Processing patient dates...
[15:54:35] [DOC: 9266278] ℹ️  DOB normalized: 10/21/1940
[15:54:35] [DOC: 9266278] ℹ️  Episode startOfCare normalized: 03/27/2025
[15:54:35] [DOC: 9266278] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[15:54:35] [DOC: 9266278] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[15:54:35] [DOC: 9266278] ✅ Patient date processing completed successfully
[15:54:35] ✅    ✅ Date processing completed
[15:54:35] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Osborne
     └─ dob: 10/21/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 5671015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:54:35] 🔄 
🔄 Step 4: Extracting order data...
[15:54:38] ℹ️  Order extraction - MRN: '5671015'
[15:54:38] ℹ️  Order extraction - Sex: 'MALE'
[15:54:38] ℹ️  Order extraction - Service Line: 'PT'
[15:54:38] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:54:38] ✅ Order data extraction completed successfully
[15:54:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:54:38] ℹ️  Using MRN from patient data: '5671015' over '5671015'
[15:54:38] ℹ️  Service line consistent in both sources: 'PT'
[15:54:38] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:54:38] ✅ Patient name cross-validation successful
[15:54:38] ✅    ✅ Data merged successfully
[15:54:39] ✅    ✅ Order data extracted and validated
[15:54:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:54:50] [DOC: 9266278] ✅ Patient exists in API: James Osborne, ID: 626fa335-2595-4b1c-a092-9ed6ec28b9aa
[15:54:50] ✅    ✅ Existing patient found with ID: 626fa335-2595-4b1c-a092-9ed6ec28b9aa
[15:54:50] 🔄 
🔄 Step 6: Pushing order to API...
[15:54:50] [DOC: 9266278] ℹ️  Pushing order via API for patient ID: 626fa335-2595-4b1c-a092-9ed6ec28b9aa
[15:54:51] [DOC: 9266278] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:54:51] ❌    ❌ Failed to push order
[15:54:51] 🔄 
🔄 Step 7: Writing to CSV...
[15:54:51] [DOC: 9266278] ℹ️  Calculated age: 84 from DOB: 10/21/1940
[15:54:51] [DOC: 9266278] ℹ️  Service Line extracted: 'PT'
[15:54:51] [DOC: 9266278] ℹ️  Payer Source extracted: 'Medicare'
[15:54:51] [DOC: 9266278] ℹ️  Diagnosis codes being written:
[15:54:51] [DOC: 9266278] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:54:51] [DOC: 9266278] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:54:51] [DOC: 9266278] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:54:51] [DOC: 9266278] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:54:51] [DOC: 9266278] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:54:51] [DOC: 9266278] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:54:51] [DOC: 9266278] ✅ Patient data written to CSV: James Osborne | Sex: MALE | Age: 84 | Service: PT | Payer: Medicare | MRN: 5671015
[15:54:51] ✅    ✅ Document 9266278 processed and saved successfully
[15:54:51] 🔄 
🔄 Step 8: Saving API details...
[15:54:51] [DOC: 9266278] ℹ️  API push details saved for document 9266278
[15:54:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266274                         ║
================================================================================
[15:54:51] ℹ️  Agency: Dartmouth HH
[15:54:51] ℹ️  Date: 04/29/2025
[15:54:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:54:56] [DOC: 9266274] ✅ Text extracted using pdfplumber (23115 chars)
[15:54:56] ✅    ✅ Text extracted using pdfplumber (23103 chars)
[15:54:56] 🔄 
🔄 Step 2: Extracting patient data...
[15:54:59] ℹ️  AI extracted raw sex value: 'M'
[15:54:59] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[15:54:59] ℹ️  AI extracted payer source: ''
[15:54:59] ℹ️  AI extracted diagnoses:
[15:54:59] ℹ️    - Diagnosis 1: 'J43.9'
[15:54:59] ℹ️    - Diagnosis 2: 'I11.0'
[15:54:59] ℹ️    - Diagnosis 3: 'I50.32'
[15:54:59] ℹ️    - Diagnosis 4: 'N18.31'
[15:54:59] ℹ️    - Diagnosis 5: 'D63.1'
[15:54:59] ℹ️    - Diagnosis 6: 'I44.7'
[15:54:59] ℹ️  Final extracted MRN: '7573009'
[15:54:59] ℹ️  Final extracted Sex: 'MALE'
[15:54:59] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[15:54:59] ℹ️  Final extracted Payer Source: ''
[15:54:59] ✅ Patient data extraction completed successfully
[15:54:59] ✅    ✅ Patient data extracted successfully
[15:54:59] 📊 Patient Response
     └─ patientFName: Daniel
     └─ patientLName: Felix
     └─ dob: 01/07/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 7573009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'J43.9', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'I44.7'}]
[15:54:59] ✅    ✅ Patient identified: Daniel Felix
[15:54:59] ✅    ✅ Patient name validation passed
[15:54:59] 🔄 
🔄 Step 3: Processing patient dates...
[15:54:59] [DOC: 9266274] ℹ️  DOB normalized: 01/07/1935
[15:54:59] [DOC: 9266274] ℹ️  Episode startOfCare normalized: 04/11/2025
[15:54:59] [DOC: 9266274] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[15:54:59] [DOC: 9266274] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[15:54:59] [DOC: 9266274] ✅ Patient date processing completed successfully
[15:54:59] ✅    ✅ Date processing completed
[15:54:59] 📊 Processed Patient Data
     └─ patientFName: Daniel
     └─ patientLName: Felix
     └─ dob: 01/07/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 7573009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'J43.9', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'D63.1', 'sixthDiagnosis': 'I44.7'}]
[15:54:59] 🔄 
🔄 Step 4: Extracting order data...
[15:55:02] ℹ️  Order extraction - MRN: '7573009'
[15:55:02] ℹ️  Order extraction - Sex: 'MALE'
[15:55:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[15:55:02] ℹ️  Order extraction - Payer Source: ''
[15:55:02] ✅ Order data extraction completed successfully
[15:55:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:55:02] ℹ️  Using MRN from patient data: '7573009' over '7573009'
[15:55:02] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[15:55:02] ✅ Patient name cross-validation successful
[15:55:02] ✅    ✅ Data merged successfully
[15:55:03] ✅    ✅ Order data extracted and validated
[15:55:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:55:03] [DOC: 9266274] ✅ Patient found in local cache: Daniel Felix, ID: 04bf1e2c-cacc-4b16-82d9-9579cddb7f3b
[15:55:03] ✅    ✅ Existing patient found with ID: 04bf1e2c-cacc-4b16-82d9-9579cddb7f3b
[15:55:03] 🔄 
🔄 Step 6: Pushing order to API...
[15:55:03] [DOC: 9266274] ℹ️  Pushing order via API for patient ID: 04bf1e2c-cacc-4b16-82d9-9579cddb7f3b
[15:55:04] [DOC: 9266274] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:55:04] ❌    ❌ Failed to push order
[15:55:04] 🔄 
🔄 Step 7: Writing to CSV...
[15:55:04] [DOC: 9266274] ℹ️  Calculated age: 90 from DOB: 01/07/1935
[15:55:04] [DOC: 9266274] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT'
[15:55:04] [DOC: 9266274] ℹ️  Payer Source extracted: ''
[15:55:04] [DOC: 9266274] ℹ️  Diagnosis codes being written:
[15:55:04] [DOC: 9266274] ℹ️    - Latest_Episode_Firstdiagnosis: 'J43.9'
[15:55:04] [DOC: 9266274] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.0'
[15:55:04] [DOC: 9266274] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.32'
[15:55:04] [DOC: 9266274] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.31'
[15:55:04] [DOC: 9266274] ℹ️    - Latest_Episode_Fifthdiagnosis: 'D63.1'
[15:55:04] [DOC: 9266274] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I44.7'
[15:55:04] [DOC: 9266274] ✅ Patient data written to CSV: Daniel Felix | Sex: MALE | Age: 90 | Service: Skilled Nursing, PT, OT | Payer:  | MRN: 7573009
[15:55:04] ✅    ✅ Document 9266274 processed and saved successfully
[15:55:04] 🔄 
🔄 Step 8: Saving API details...
[15:55:04] [DOC: 9266274] ℹ️  API push details saved for document 9266274
[15:55:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266236                         ║
================================================================================
[15:55:04] ℹ️  Agency: Dartmouth HH
[15:55:04] ℹ️  Date: 04/29/2025
[15:55:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:55:07] [DOC: 9266236] ✅ Text extracted using pdfplumber (10464 chars)
[15:55:07] ✅    ✅ Text extracted using pdfplumber (10452 chars)
[15:55:07] 🔄 
🔄 Step 2: Extracting patient data...
[15:55:10] ℹ️  AI extracted raw sex value: 'F'
[15:55:10] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:55:10] ℹ️  AI extracted payer source: 'None'
[15:55:10] ℹ️  AI extracted diagnoses:
[15:55:10] ℹ️    - Diagnosis 1: 'C44.719'
[15:55:10] ℹ️    - Diagnosis 2: 'J44.9'
[15:55:10] ℹ️    - Diagnosis 3: 'K21.9'
[15:55:10] ℹ️    - Diagnosis 4: 'E03.9'
[15:55:10] ℹ️    - Diagnosis 5: 'E55.9'
[15:55:10] ℹ️    - Diagnosis 6: 'L02.211'
[15:55:10] ℹ️  Final extracted MRN: '5094015'
[15:55:10] ℹ️  Final extracted Sex: 'FEMALE'
[15:55:10] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:55:10] ℹ️  Final extracted Payer Source: ''
[15:55:10] ✅ Patient data extraction completed successfully
[15:55:10] ✅    ✅ Patient data extracted successfully
[15:55:10] 📊 Patient Response
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/25/2024', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': 'C44.719', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'K21.9', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': 'E55.9', 'sixthDiagnosis': 'L02.211'}]
[15:55:10] ✅    ✅ Patient identified: Laura Gregoire
[15:55:10] ✅    ✅ Patient name validation passed
[15:55:10] 🔄 
🔄 Step 3: Processing patient dates...
[15:55:10] [DOC: 9266236] ℹ️  DOB normalized: 12/06/1944
[15:55:10] [DOC: 9266236] ℹ️  Episode startOfCare normalized: 08/25/2024
[15:55:10] [DOC: 9266236] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[15:55:10] [DOC: 9266236] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[15:55:10] [DOC: 9266236] ✅ Patient date processing completed successfully
[15:55:10] ✅    ✅ Date processing completed
[15:55:10] 📊 Processed Patient Data
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/25/2024', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': 'C44.719', 'secondDiagnosis': 'J44.9', 'thirdDiagnosis': 'K21.9', 'fourthDiagnosis': 'E03.9', 'fifthDiagnosis': 'E55.9', 'sixthDiagnosis': 'L02.211'}]
[15:55:10] 🔄 
🔄 Step 4: Extracting order data...
[15:55:13] ℹ️  Order extraction - MRN: '5094015'
[15:55:13] ℹ️  Order extraction - Sex: 'FEMALE'
[15:55:13] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[15:55:13] ℹ️  Order extraction - Payer Source: ''
[15:55:13] ✅ Order data extraction completed successfully
[15:55:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:55:13] ℹ️  Using MRN from patient data: '5094015' over '5094015'
[15:55:13] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, PT, OT' = 'OT, PT, Skilled Nursing'
[15:55:13] ✅ Patient name cross-validation successful
[15:55:13] ✅    ✅ Data merged successfully
[15:55:14] ✅    ✅ Order data extracted and validated
[15:55:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:55:14] [DOC: 9266236] ✅ Patient found in local cache: Laura Gregoire, ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[15:55:14] ✅    ✅ Existing patient found with ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[15:55:14] 🔄 
🔄 Step 6: Pushing order to API...
[15:55:14] [DOC: 9266236] ℹ️  Pushing order via API for patient ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[15:55:15] [DOC: 9266236] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:55:15] ❌    ❌ Failed to push order
[15:55:15] 🔄 
🔄 Step 7: Writing to CSV...
[15:55:15] [DOC: 9266236] ℹ️  Calculated age: 80 from DOB: 12/06/1944
[15:55:15] [DOC: 9266236] ℹ️  Service Line extracted: 'OT, PT, Skilled Nursing'
[15:55:15] [DOC: 9266236] ℹ️  Payer Source extracted: ''
[15:55:15] [DOC: 9266236] ℹ️  Diagnosis codes being written:
[15:55:15] [DOC: 9266236] ℹ️    - Latest_Episode_Firstdiagnosis: 'C44.719'
[15:55:15] [DOC: 9266236] ℹ️    - Latest_Episode_Seconddiagnosis: 'J44.9'
[15:55:15] [DOC: 9266236] ℹ️    - Latest_Episode_Thirddiagnosis: 'K21.9'
[15:55:15] [DOC: 9266236] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E03.9'
[15:55:15] [DOC: 9266236] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E55.9'
[15:55:15] [DOC: 9266236] ℹ️    - Latest_Episode_Sixthdiagnosis: 'L02.211'
[15:55:15] [DOC: 9266236] ✅ Patient data written to CSV: Laura Gregoire | Sex: FEMALE | Age: 80 | Service: OT, PT, Skilled Nursing | Payer:  | MRN: 5094015
[15:55:15] ✅    ✅ Document 9266236 processed and saved successfully
[15:55:15] 🔄 
🔄 Step 8: Saving API details...
[15:55:15] [DOC: 9266236] ℹ️  API push details saved for document 9266236
[15:55:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266238                         ║
================================================================================
[15:55:15] ℹ️  Agency: Nizhoni Health Systems-Somerville
[15:55:15] ℹ️  Date: 04/29/2025
[15:55:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:55:19] [DOC: 9266238] ✅ Text extracted using pdfplumber (14217 chars)
[15:55:19] ✅    ✅ Text extracted using pdfplumber (14217 chars)
[15:55:19] 🔄 
🔄 Step 2: Extracting patient data...
[15:55:22] ℹ️  AI extracted raw sex value: 'F'
[15:55:22] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:55:22] ℹ️  AI extracted payer source: ''
[15:55:22] ℹ️  AI extracted diagnoses:
[15:55:22] ℹ️    - Diagnosis 1: 'F25.0'
[15:55:22] ℹ️    - Diagnosis 2: 'E11.9'
[15:55:22] ℹ️    - Diagnosis 3: 'F41.9'
[15:55:22] ℹ️    - Diagnosis 4: 'J96.11'
[15:55:22] ℹ️    - Diagnosis 5: 'J44.9'
[15:55:22] ℹ️    - Diagnosis 6: 'G47.33'
[15:55:22] ℹ️  Final extracted MRN: '421010'
[15:55:22] ℹ️  Final extracted Sex: 'FEMALE'
[15:55:22] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:55:22] ℹ️  Final extracted Payer Source: ''
[15:55:22] ✅ Patient data extraction completed successfully
[15:55:22] ✅    ✅ Patient data extracted successfully
[15:55:22] 📊 Patient Response
     └─ patientFName: Makaela
     └─ patientLName: Carvalho
     └─ dob: 06/16/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 421010
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/18/2023', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'J96.11', 'fifthDiagnosis': 'J44.9', 'sixthDiagnosis': 'G47.33'}]
[15:55:22] ✅    ✅ Patient identified: Makaela Carvalho
[15:55:22] ✅    ✅ Patient name validation passed
[15:55:22] 🔄 
🔄 Step 3: Processing patient dates...
[15:55:22] [DOC: 9266238] ℹ️  DOB normalized: 06/16/1994
[15:55:22] [DOC: 9266238] ℹ️  Episode startOfCare normalized: 08/18/2023
[15:55:22] [DOC: 9266238] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[15:55:22] [DOC: 9266238] ℹ️  Episode endOfEpisode normalized: 06/07/2025
[15:55:22] [DOC: 9266238] ✅ Patient date processing completed successfully
[15:55:22] ✅    ✅ Date processing completed
[15:55:22] 📊 Processed Patient Data
     └─ patientFName: Makaela
     └─ patientLName: Carvalho
     └─ dob: 06/16/1994
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 421010
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/18/2023', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'F25.0', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'F41.9', 'fourthDiagnosis': 'J96.11', 'fifthDiagnosis': 'J44.9', 'sixthDiagnosis': 'G47.33'}]
[15:55:22] 🔄 
🔄 Step 4: Extracting order data...
[15:55:25] ℹ️  Order extraction - MRN: '421010'
[15:55:25] ℹ️  Order extraction - Sex: 'FEMALE'
[15:55:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:55:25] ℹ️  Order extraction - Payer Source: ''
[15:55:25] ✅ Order data extraction completed successfully
[15:55:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:55:25] ℹ️  Using MRN from patient data: '421010' over '421010'
[15:55:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:55:25] ✅ Patient name cross-validation successful
[15:55:25] ✅    ✅ Data merged successfully
[15:55:26] ✅    ✅ Order data extracted and validated
[15:55:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:55:31] [DOC: 9266238] ✅ Patient exists in API: Makaela Carvalho, ID: a4e29f75-9e46-4832-bdbf-9de150c3e77f
[15:55:31] ✅    ✅ Existing patient found with ID: a4e29f75-9e46-4832-bdbf-9de150c3e77f
[15:55:31] 🔄 
🔄 Step 6: Pushing order to API...
[15:55:31] [DOC: 9266238] ℹ️  Pushing order via API for patient ID: a4e29f75-9e46-4832-bdbf-9de150c3e77f
[15:55:32] [DOC: 9266238] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:55:32] ❌    ❌ Failed to push order
[15:55:32] 🔄 
🔄 Step 7: Writing to CSV...
[15:55:32] [DOC: 9266238] ℹ️  Calculated age: 30 from DOB: 06/16/1994
[15:55:32] [DOC: 9266238] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:55:32] [DOC: 9266238] ℹ️  Payer Source extracted: ''
[15:55:32] [DOC: 9266238] ℹ️  Diagnosis codes being written:
[15:55:32] [DOC: 9266238] ℹ️    - Latest_Episode_Firstdiagnosis: 'F25.0'
[15:55:32] [DOC: 9266238] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[15:55:32] [DOC: 9266238] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.9'
[15:55:32] [DOC: 9266238] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J96.11'
[15:55:32] [DOC: 9266238] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J44.9'
[15:55:32] [DOC: 9266238] ℹ️    - Latest_Episode_Sixthdiagnosis: 'G47.33'
[15:55:32] [DOC: 9266238] ✅ Patient data written to CSV: Makaela Carvalho | Sex: FEMALE | Age: 30 | Service: Skilled Nursing | Payer:  | MRN: 421010
[15:55:32] ✅    ✅ Document 9266238 processed and saved successfully
[15:55:32] 🔄 
🔄 Step 8: Saving API details...
[15:55:32] [DOC: 9266238] ℹ️  API push details saved for document 9266238
[15:55:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266226                         ║
================================================================================
[15:55:32] ℹ️  Agency: Dartmouth HH
[15:55:32] ℹ️  Date: 04/29/2025
[15:55:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:55:34] [DOC: 9266226] ✅ Text extracted using pdfplumber (1421 chars)
[15:55:34] ✅    ✅ Text extracted using pdfplumber (1421 chars)
[15:55:34] 🔄 
🔄 Step 2: Extracting patient data...
[15:55:36] ℹ️  AI extracted raw sex value: 'F'
[15:55:36] ℹ️  AI extracted service line: 'RN'
[15:55:36] ℹ️  AI extracted payer source: 'Medicare'
[15:55:36] ℹ️  AI extracted diagnoses:
[15:55:36] ℹ️    - Diagnosis 1: ''
[15:55:36] ℹ️    - Diagnosis 2: ''
[15:55:36] ℹ️    - Diagnosis 3: ''
[15:55:36] ℹ️    - Diagnosis 4: ''
[15:55:36] ℹ️    - Diagnosis 5: ''
[15:55:36] ℹ️    - Diagnosis 6: ''
[15:55:36] ℹ️  Final extracted MRN: '5094015'
[15:55:36] ℹ️  Final extracted Sex: 'FEMALE'
[15:55:36] ℹ️  Final extracted Service Line: 'RN'
[15:55:36] ℹ️  Final extracted Payer Source: 'Medicare'
[15:55:36] ✅ Patient data extraction completed successfully
[15:55:36] ✅    ✅ Patient data extracted successfully
[15:55:36] 📊 Patient Response
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:55:36] ✅    ✅ Patient identified: Laura Gregoire
[15:55:36] ✅    ✅ Patient name validation passed
[15:55:36] 🔄 
🔄 Step 3: Processing patient dates...
[15:55:36] [DOC: 9266226] ℹ️  DOB normalized: 12/06/1944
[15:55:36] [DOC: 9266226] ℹ️  Episode startOfCare normalized: 08/26/2024
[15:55:36] [DOC: 9266226] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[15:55:36] [DOC: 9266226] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[15:55:36] [DOC: 9266226] ✅ Patient date processing completed successfully
[15:55:36] ✅    ✅ Date processing completed
[15:55:36] 📊 Processed Patient Data
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:55:36] 🔄 
🔄 Step 4: Extracting order data...
[15:55:39] ℹ️  Order extraction - MRN: '5094015'
[15:55:39] ℹ️  Order extraction - Sex: 'FEMALE'
[15:55:39] ℹ️  Order extraction - Service Line: 'RN'
[15:55:39] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:55:39] ✅ Order data extraction completed successfully
[15:55:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:55:39] ℹ️  Using MRN from patient data: '5094015' over '5094015'
[15:55:39] ℹ️  Service line consistent in both sources: 'RN'
[15:55:39] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:55:39] ✅ Patient name cross-validation successful
[15:55:39] ✅    ✅ Data merged successfully
[15:55:40] ✅    ✅ Order data extracted and validated
[15:55:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:55:40] [DOC: 9266226] ✅ Patient found in local cache: Laura Gregoire, ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[15:55:40] ✅    ✅ Existing patient found with ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[15:55:40] 🔄 
🔄 Step 6: Pushing order to API...
[15:55:40] [DOC: 9266226] ℹ️  Pushing order via API for patient ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[15:55:41] [DOC: 9266226] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:55:41] ❌    ❌ Failed to push order
[15:55:41] 🔄 
🔄 Step 7: Writing to CSV...
[15:55:41] [DOC: 9266226] ℹ️  Calculated age: 80 from DOB: 12/06/1944
[15:55:41] [DOC: 9266226] ℹ️  Service Line extracted: 'RN'
[15:55:41] [DOC: 9266226] ℹ️  Payer Source extracted: 'Medicare'
[15:55:41] [DOC: 9266226] ℹ️  Diagnosis codes being written:
[15:55:41] [DOC: 9266226] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:55:41] [DOC: 9266226] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:55:41] [DOC: 9266226] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:55:41] [DOC: 9266226] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:55:41] [DOC: 9266226] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:55:41] [DOC: 9266226] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:55:41] [DOC: 9266226] ✅ Patient data written to CSV: Laura Gregoire | Sex: FEMALE | Age: 80 | Service: RN | Payer: Medicare | MRN: 5094015
[15:55:41] ✅    ✅ Document 9266226 processed and saved successfully
[15:55:41] 🔄 
🔄 Step 8: Saving API details...
[15:55:41] [DOC: 9266226] ℹ️  API push details saved for document 9266226
[15:55:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266222                         ║
================================================================================
[15:55:41] ℹ️  Agency: Dartmouth HH
[15:55:41] ℹ️  Date: 04/29/2025
[15:55:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:55:44] [DOC: 9266222] ✅ Text extracted using pdfplumber (12799 chars)
[15:55:44] ✅    ✅ Text extracted using pdfplumber (12787 chars)
[15:55:44] 🔄 
🔄 Step 2: Extracting patient data...
[15:55:46] ℹ️  AI extracted raw sex value: 'F'
[15:55:46] ℹ️  AI extracted service line: 'PT'
[15:55:46] ℹ️  AI extracted payer source: ''
[15:55:46] ℹ️  AI extracted diagnoses:
[15:55:46] ℹ️    - Diagnosis 1: 'M47.812'
[15:55:46] ℹ️    - Diagnosis 2: 'R26.9'
[15:55:46] ℹ️    - Diagnosis 3: 'G89.4'
[15:55:46] ℹ️    - Diagnosis 4: 'E66.01'
[15:55:46] ℹ️    - Diagnosis 5: 'Z68.42'
[15:55:46] ℹ️    - Diagnosis 6: 'U07.1'
[15:55:46] ℹ️  Final extracted MRN: '227027'
[15:55:46] ℹ️  Final extracted Sex: 'FEMALE'
[15:55:46] ℹ️  Final extracted Service Line: 'PT'
[15:55:46] ℹ️  Final extracted Payer Source: ''
[15:55:46] ✅ Patient data extraction completed successfully
[15:55:46] ✅    ✅ Patient data extracted successfully
[15:55:46] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Furtado
     └─ dob: 04/10/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/25/2025', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': 'M47.812', 'secondDiagnosis': 'R26.9', 'thirdDiagnosis': 'G89.4', 'fourthDiagnosis': 'E66.01', 'fifthDiagnosis': 'Z68.42', 'sixthDiagnosis': 'U07.1'}]
[15:55:47] ✅    ✅ Patient identified: Maria Furtado
[15:55:47] ✅    ✅ Patient name validation passed
[15:55:47] 🔄 
🔄 Step 3: Processing patient dates...
[15:55:47] [DOC: 9266222] ℹ️  DOB normalized: 04/10/1943
[15:55:47] [DOC: 9266222] ℹ️  Episode startOfCare normalized: 04/25/2025
[15:55:47] [DOC: 9266222] ℹ️  Episode startOfEpisode normalized: 04/25/2025
[15:55:47] [DOC: 9266222] ℹ️  Episode endOfEpisode normalized: 06/23/2025
[15:55:47] [DOC: 9266222] ✅ Patient date processing completed successfully
[15:55:47] ✅    ✅ Date processing completed
[15:55:47] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Furtado
     └─ dob: 04/10/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/25/2025', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': 'M47.812', 'secondDiagnosis': 'R26.9', 'thirdDiagnosis': 'G89.4', 'fourthDiagnosis': 'E66.01', 'fifthDiagnosis': 'Z68.42', 'sixthDiagnosis': 'U07.1'}]
[15:55:47] 🔄 
🔄 Step 4: Extracting order data...
[15:55:49] ℹ️  Order extraction - MRN: '6123009'
[15:55:49] ℹ️  Order extraction - Sex: 'FEMALE'
[15:55:49] ℹ️  Order extraction - Service Line: 'PT'
[15:55:49] ℹ️  Order extraction - Payer Source: ''
[15:55:49] ✅ Order data extraction completed successfully
[15:55:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:55:49] ℹ️  Using longer MRN from order data: '6123009' over '227027'
[15:55:49] ℹ️  Service line consistent in both sources: 'PT'
[15:55:49] ✅ Patient name cross-validation successful
[15:55:49] ✅    ✅ Data merged successfully
[15:55:50] ✅    ✅ Order data extracted and validated
[15:55:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:55:58] [DOC: 9266222] ✅ Patient exists in API: Maria Furtado, ID: a673667c-7793-4915-b5ef-84720b12f155
[15:55:58] ✅    ✅ Existing patient found with ID: a673667c-7793-4915-b5ef-84720b12f155
[15:55:58] 🔄 
🔄 Step 6: Pushing order to API...
[15:55:58] [DOC: 9266222] ℹ️  Pushing order via API for patient ID: a673667c-7793-4915-b5ef-84720b12f155
[15:55:59] [DOC: 9266222] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:55:59] ❌    ❌ Failed to push order
[15:55:59] 🔄 
🔄 Step 7: Writing to CSV...
[15:55:59] [DOC: 9266222] ℹ️  Calculated age: 82 from DOB: 04/10/1943
[15:55:59] [DOC: 9266222] ℹ️  Service Line extracted: 'PT'
[15:55:59] [DOC: 9266222] ℹ️  Payer Source extracted: ''
[15:55:59] [DOC: 9266222] ℹ️  Diagnosis codes being written:
[15:55:59] [DOC: 9266222] ℹ️    - Latest_Episode_Firstdiagnosis: 'M47.812'
[15:55:59] [DOC: 9266222] ℹ️    - Latest_Episode_Seconddiagnosis: 'R26.9'
[15:55:59] [DOC: 9266222] ℹ️    - Latest_Episode_Thirddiagnosis: 'G89.4'
[15:55:59] [DOC: 9266222] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E66.01'
[15:55:59] [DOC: 9266222] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z68.42'
[15:55:59] [DOC: 9266222] ℹ️    - Latest_Episode_Sixthdiagnosis: 'U07.1'
[15:55:59] [DOC: 9266222] ✅ Patient data written to CSV: Maria Furtado | Sex: FEMALE | Age: 82 | Service: PT | Payer:  | MRN: 6123009
[15:55:59] ✅    ✅ Document 9266222 processed and saved successfully
[15:55:59] 🔄 
🔄 Step 8: Saving API details...
[15:55:59] [DOC: 9266222] ℹ️  API push details saved for document 9266222
[15:55:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266219                         ║
================================================================================
[15:55:59] ℹ️  Agency: Dartmouth HH
[15:55:59] ℹ️  Date: 04/29/2025
[15:55:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:56:01] [DOC: 9266219] ✅ Text extracted using pdfplumber (1234 chars)
[15:56:01] ✅    ✅ Text extracted using pdfplumber (1234 chars)
[15:56:01] 🔄 
🔄 Step 2: Extracting patient data...
[15:56:04] ℹ️  AI extracted raw sex value: 'F'
[15:56:04] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:56:04] ℹ️  AI extracted payer source: 'Medicare'
[15:56:04] ℹ️  AI extracted diagnoses:
[15:56:04] ℹ️    - Diagnosis 1: ''
[15:56:04] ℹ️    - Diagnosis 2: ''
[15:56:04] ℹ️    - Diagnosis 3: ''
[15:56:04] ℹ️    - Diagnosis 4: ''
[15:56:04] ℹ️    - Diagnosis 5: ''
[15:56:04] ℹ️    - Diagnosis 6: ''
[15:56:04] ℹ️  Final extracted MRN: '5094015'
[15:56:04] ℹ️  Final extracted Sex: 'FEMALE'
[15:56:04] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:56:04] ℹ️  Final extracted Payer Source: 'Medicare'
[15:56:04] ✅ Patient data extraction completed successfully
[15:56:04] ✅    ✅ Patient data extracted successfully
[15:56:04] 📊 Patient Response
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:56:04] ✅    ✅ Patient identified: Laura Gregoire
[15:56:04] ✅    ✅ Patient name validation passed
[15:56:04] 🔄 
🔄 Step 3: Processing patient dates...
[15:56:04] [DOC: 9266219] ℹ️  DOB normalized: 12/06/1944
[15:56:04] [DOC: 9266219] ℹ️  Episode startOfCare normalized: 08/26/2024
[15:56:04] [DOC: 9266219] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[15:56:04] [DOC: 9266219] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[15:56:04] [DOC: 9266219] ✅ Patient date processing completed successfully
[15:56:04] ✅    ✅ Date processing completed
[15:56:04] 📊 Processed Patient Data
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:56:04] 🔄 
🔄 Step 4: Extracting order data...
[15:56:06] ℹ️  Order extraction - MRN: ''
[15:56:06] ℹ️  Order extraction - Sex: 'FEMALE'
[15:56:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:56:06] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:56:06] ✅ Order data extraction completed successfully
[15:56:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:56:06] ℹ️  Using MRN from patient data: '5094015'
[15:56:06] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:56:06] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:56:06] ✅ Patient name cross-validation successful
[15:56:06] ✅    ✅ Data merged successfully
[15:56:07] ✅    ✅ Order data extracted and validated
[15:56:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:56:07] [DOC: 9266219] ✅ Patient found in local cache: Laura Gregoire, ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[15:56:07] ✅    ✅ Existing patient found with ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[15:56:07] 🔄 
🔄 Step 6: Pushing order to API...
[15:56:07] [DOC: 9266219] ℹ️  Pushing order via API for patient ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[15:56:08] [DOC: 9266219] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:56:08] ❌    ❌ Failed to push order
[15:56:08] 🔄 
🔄 Step 7: Writing to CSV...
[15:56:08] [DOC: 9266219] ℹ️  Calculated age: 80 from DOB: 12/06/1944
[15:56:08] [DOC: 9266219] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:56:08] [DOC: 9266219] ℹ️  Payer Source extracted: 'Medicare'
[15:56:08] [DOC: 9266219] ℹ️  Diagnosis codes being written:
[15:56:08] [DOC: 9266219] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:56:08] [DOC: 9266219] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:56:08] [DOC: 9266219] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:56:08] [DOC: 9266219] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:56:08] [DOC: 9266219] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:56:08] [DOC: 9266219] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:56:08] [DOC: 9266219] ✅ Patient data written to CSV: Laura Gregoire | Sex: FEMALE | Age: 80 | Service: Skilled Nursing | Payer: Medicare | MRN: 5094015
[15:56:08] ✅    ✅ Document 9266219 processed and saved successfully
[15:56:08] 🔄 
🔄 Step 8: Saving API details...
[15:56:08] [DOC: 9266219] ℹ️  API push details saved for document 9266219
[15:56:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266217                         ║
================================================================================
[15:56:08] ℹ️  Agency: Dartmouth HH
[15:56:08] ℹ️  Date: 04/29/2025
[15:56:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:56:11] [DOC: 9266217] ✅ Text extracted using pdfplumber (1393 chars)
[15:56:11] ✅    ✅ Text extracted using pdfplumber (1393 chars)
[15:56:11] 🔄 
🔄 Step 2: Extracting patient data...
[15:56:13] ℹ️  AI extracted raw sex value: 'M'
[15:56:13] ℹ️  AI extracted service line: 'RN, HHA'
[15:56:13] ℹ️  AI extracted payer source: 'Medicare'
[15:56:13] ℹ️  AI extracted diagnoses:
[15:56:13] ℹ️    - Diagnosis 1: ''
[15:56:13] ℹ️    - Diagnosis 2: ''
[15:56:13] ℹ️    - Diagnosis 3: ''
[15:56:13] ℹ️    - Diagnosis 4: ''
[15:56:13] ℹ️    - Diagnosis 5: ''
[15:56:13] ℹ️    - Diagnosis 6: ''
[15:56:13] ℹ️  Final extracted MRN: '842002'
[15:56:13] ℹ️  Final extracted Sex: 'MALE'
[15:56:13] ℹ️  Final extracted Service Line: 'RN, HHA'
[15:56:13] ℹ️  Final extracted Payer Source: 'Medicare'
[15:56:13] ✅ Patient data extraction completed successfully
[15:56:13] ✅    ✅ Patient data extracted successfully
[15:56:13] 📊 Patient Response
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Daniel J Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:56:13] ✅    ✅ Patient identified: Johannes Bjornson
[15:56:13] ✅    ✅ Patient name validation passed
[15:56:13] 🔄 
🔄 Step 3: Processing patient dates...
[15:56:13] [DOC: 9266217] ℹ️  DOB normalized: 02/09/1942
[15:56:13] [DOC: 9266217] ℹ️  Episode startOfCare normalized: 10/10/2024
[15:56:13] [DOC: 9266217] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[15:56:13] [DOC: 9266217] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[15:56:13] [DOC: 9266217] ✅ Patient date processing completed successfully
[15:56:13] ✅    ✅ Date processing completed
[15:56:13] 📊 Processed Patient Data
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Daniel J Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:56:13] 🔄 
🔄 Step 4: Extracting order data...
[15:56:16] ℹ️  Order extraction - MRN: ''
[15:56:16] ℹ️  Order extraction - Sex: 'MALE'
[15:56:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:56:16] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:56:16] ✅ Order data extraction completed successfully
[15:56:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:56:16] ℹ️  Using MRN from patient data: '842002'
[15:56:16] ℹ️  Combined service lines: Patient='RN, HHA' + Order='Skilled Nursing' = 'HHA, RN, Skilled Nursing'
[15:56:16] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:56:16] ✅ Patient name cross-validation successful
[15:56:16] ✅    ✅ Data merged successfully
[15:56:17] ✅    ✅ Order data extracted and validated
[15:56:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:56:17] [DOC: 9266217] ✅ Patient found in local cache: Johannes Bjornson, ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[15:56:17] ✅    ✅ Existing patient found with ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[15:56:17] 🔄 
🔄 Step 6: Pushing order to API...
[15:56:17] [DOC: 9266217] ℹ️  Pushing order via API for patient ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[15:56:18] [DOC: 9266217] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13167"}
[15:56:18] ❌    ❌ Failed to push order
[15:56:18] 🔄 
🔄 Step 7: Writing to CSV...
[15:56:18] [DOC: 9266217] ℹ️  Calculated age: 83 from DOB: 02/09/1942
[15:56:18] [DOC: 9266217] ℹ️  Service Line extracted: 'HHA, RN, Skilled Nursing'
[15:56:18] [DOC: 9266217] ℹ️  Payer Source extracted: 'Medicare'
[15:56:18] [DOC: 9266217] ℹ️  Diagnosis codes being written:
[15:56:18] [DOC: 9266217] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:56:18] [DOC: 9266217] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:56:18] [DOC: 9266217] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:56:18] [DOC: 9266217] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:56:18] [DOC: 9266217] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:56:18] [DOC: 9266217] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:56:18] [DOC: 9266217] ✅ Patient data written to CSV: Johannes Bjornson | Sex: MALE | Age: 83 | Service: HHA, RN, Skilled Nursing | Payer: Medicare | MRN: 842002
[15:56:18] ✅    ✅ Document 9266217 processed and saved successfully
[15:56:18] 🔄 
🔄 Step 8: Saving API details...
[15:56:18] [DOC: 9266217] ℹ️  API push details saved for document 9266217
[15:56:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266211                         ║
================================================================================
[15:56:18] ℹ️  Agency: Dartmouth HH
[15:56:18] ℹ️  Date: 04/29/2025
[15:56:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:56:20] [DOC: 9266211] ✅ Text extracted using pdfplumber (2133 chars)
[15:56:20] ✅    ✅ Text extracted using pdfplumber (2133 chars)
[15:56:20] 🔄 
🔄 Step 2: Extracting patient data...
[15:56:23] ℹ️  AI extracted raw sex value: 'F'
[15:56:23] ℹ️  AI extracted service line: 'Skilled Nursing, RN, LPN'
[15:56:23] ℹ️  AI extracted payer source: 'Fallon Health'
[15:56:23] ℹ️  AI extracted diagnoses:
[15:56:23] ℹ️    - Diagnosis 1: ''
[15:56:23] ℹ️    - Diagnosis 2: ''
[15:56:23] ℹ️    - Diagnosis 3: ''
[15:56:23] ℹ️    - Diagnosis 4: ''
[15:56:23] ℹ️    - Diagnosis 5: ''
[15:56:23] ℹ️    - Diagnosis 6: ''
[15:56:23] ℹ️  Final extracted MRN: '4034011'
[15:56:23] ℹ️  Final extracted Sex: 'FEMALE'
[15:56:23] ℹ️  Final extracted Service Line: 'Skilled Nursing, RN, LPN'
[15:56:23] ℹ️  Final extracted Payer Source: 'Fallon Health'
[15:56:23] ✅ Patient data extraction completed successfully
[15:56:23] ✅    ✅ Patient data extracted successfully
[15:56:23] 📊 Patient Response
     └─ patientFName: Joan E
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, RN, LPN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:56:23] ✅    ✅ Patient identified: Joan E Swift
[15:56:23] ✅    ✅ Patient name validation passed
[15:56:23] 🔄 
🔄 Step 3: Processing patient dates...
[15:56:23] [DOC: 9266211] ℹ️  DOB normalized: 05/05/1943
[15:56:23] [DOC: 9266211] ℹ️  Episode startOfCare normalized: 01/08/2025
[15:56:23] [DOC: 9266211] ℹ️  Episode startOfEpisode normalized: 03/09/2025
[15:56:23] [DOC: 9266211] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[15:56:23] [DOC: 9266211] ✅ Patient date processing completed successfully
[15:56:23] ✅    ✅ Date processing completed
[15:56:23] 📊 Processed Patient Data
     └─ patientFName: Joan E
     └─ patientLName: Swift
     └─ dob: 05/05/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4034011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, RN, LPN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '01/08/2025', 'startOfEpisode': '03/09/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:56:23] 🔄 
🔄 Step 4: Extracting order data...
[15:56:26] ℹ️  Order extraction - MRN: ''
[15:56:26] ℹ️  Order extraction - Sex: 'FEMALE'
[15:56:26] ℹ️  Order extraction - Service Line: 'RN, LPN'
[15:56:26] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[15:56:26] ✅ Order data extraction completed successfully
[15:56:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:56:26] ℹ️  Using MRN from patient data: '4034011'
[15:56:26] ℹ️  Combined service lines: Patient='Skilled Nursing, RN, LPN' + Order='RN, LPN' = 'LPN, RN, Skilled Nursing'
[15:56:26] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[15:56:26] ✅ Patient name cross-validation successful
[15:56:26] ✅    ✅ Data merged successfully
[15:56:27] ✅    ✅ Order data extracted and validated
[15:56:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:56:34] [DOC: 9266211] ℹ️  Patient not found in cache or API: Joan E Swift
[15:56:34] [DOC: 9266211] ℹ️  Patient not found, creating new patient via API...
[15:56:34] [DOC: 9266211] ℹ️  Creating patient via API: Joan E Swift
[15:56:36] [DOC: 9266211] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:56:36] ❌    ❌ Failed to create patient
[15:56:36] [DOC: 9266211] ℹ️  API push details saved for document 9266211
================================================================================
║                        Processing Document ID: 9266208                         ║
================================================================================
[15:56:36] ℹ️  Agency: Dartmouth HH
[15:56:36] ℹ️  Date: 04/29/2025
[15:56:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:56:39] [DOC: 9266208] ✅ Text extracted using pdfplumber (10074 chars)
[15:56:39] ✅    ✅ Text extracted using pdfplumber (10074 chars)
[15:56:39] 🔄 
🔄 Step 2: Extracting patient data...
[15:56:42] ℹ️  AI extracted raw sex value: 'F'
[15:56:42] ℹ️  AI extracted service line: 'PT'
[15:56:42] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[15:56:42] ℹ️  AI extracted diagnoses:
[15:56:42] ℹ️    - Diagnosis 1: 'None'
[15:56:42] ℹ️    - Diagnosis 2: 'None'
[15:56:42] ℹ️    - Diagnosis 3: 'None'
[15:56:42] ℹ️    - Diagnosis 4: 'None'
[15:56:42] ℹ️    - Diagnosis 5: 'None'
[15:56:42] ℹ️    - Diagnosis 6: 'None'
[15:56:42] ℹ️  Final extracted MRN: '6843'
[15:56:42] ℹ️  Final extracted Sex: 'FEMALE'
[15:56:42] ℹ️  Final extracted Service Line: 'PT'
[15:56:42] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[15:56:42] ✅ Patient data extraction completed successfully
[15:56:42] ✅    ✅ Patient data extracted successfully
[15:56:42] 📊 Patient Response
     └─ patientFName: Pearl
     └─ patientLName: Moura
     └─ dob: 01/29/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6843
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2022', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[15:56:42] ✅    ✅ Patient identified: Pearl Moura
[15:56:42] ✅    ✅ Patient name validation passed
[15:56:42] 🔄 
🔄 Step 3: Processing patient dates...
[15:56:42] [DOC: 9266208] ℹ️  DOB normalized: 01/29/1930
[15:56:42] [DOC: 9266208] ℹ️  Episode startOfCare normalized: 01/04/2022
[15:56:42] [DOC: 9266208] ℹ️  Episode startOfEpisode normalized: 04/18/2025
[15:56:42] [DOC: 9266208] ℹ️  Episode endOfEpisode normalized: 06/16/2025
[15:56:42] [DOC: 9266208] ✅ Patient date processing completed successfully
[15:56:42] ✅    ✅ Date processing completed
[15:56:42] 📊 Processed Patient Data
     └─ patientFName: Pearl
     └─ patientLName: Moura
     └─ dob: 01/29/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6843
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '01/04/2022', 'startOfEpisode': '04/18/2025', 'endOfEpisode': '06/16/2025'}]
[15:56:42] 🔄 
🔄 Step 4: Extracting order data...
[15:56:44] ℹ️  Order extraction - MRN: ''
[15:56:44] ℹ️  Order extraction - Sex: 'FEMALE'
[15:56:44] ℹ️  Order extraction - Service Line: 'PT'
[15:56:44] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[15:56:44] ✅ Order data extraction completed successfully
[15:56:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:56:44] ℹ️  Using MRN from patient data: '6843'
[15:56:44] ℹ️  Service line consistent in both sources: 'PT'
[15:56:44] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[15:56:44] ✅ Patient name cross-validation successful
[15:56:44] ✅    ✅ Data merged successfully
[15:56:45] ✅    ✅ Order data extracted and validated
[15:56:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:56:56] [DOC: 9266208] ✅ Patient exists in API: Pearl Moura, ID: 96381f05-1d66-4bdb-b9e3-fc82afab3898
[15:56:56] ✅    ✅ Existing patient found with ID: 96381f05-1d66-4bdb-b9e3-fc82afab3898
[15:56:56] 🔄 
🔄 Step 6: Pushing order to API...
[15:56:56] [DOC: 9266208] ℹ️  Pushing order via API for patient ID: 96381f05-1d66-4bdb-b9e3-fc82afab3898
[15:56:57] [DOC: 9266208] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14163"}
[15:56:57] ❌    ❌ Failed to push order
[15:56:57] 🔄 
🔄 Step 7: Writing to CSV...
[15:56:57] [DOC: 9266208] ℹ️  Calculated age: 95 from DOB: 01/29/1930
[15:56:57] [DOC: 9266208] ℹ️  Service Line extracted: 'PT'
[15:56:57] [DOC: 9266208] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[15:56:57] [DOC: 9266208] ℹ️  Diagnosis codes being written:
[15:56:57] [DOC: 9266208] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:56:57] [DOC: 9266208] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:56:57] [DOC: 9266208] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:56:57] [DOC: 9266208] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:56:57] [DOC: 9266208] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:56:57] [DOC: 9266208] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:56:57] [DOC: 9266208] ✅ Patient data written to CSV: Pearl Moura | Sex: FEMALE | Age: 95 | Service: PT | Payer: Aetna- Mcare | MRN: 6843
[15:56:57] ✅    ✅ Document 9266208 processed and saved successfully
[15:56:57] 🔄 
🔄 Step 8: Saving API details...
[15:56:57] [DOC: 9266208] ℹ️  API push details saved for document 9266208
[15:56:57] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266205                         ║
================================================================================
[15:56:57] ℹ️  Agency: Dartmouth HH
[15:56:57] ℹ️  Date: 04/29/2025
[15:56:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:56:59] [DOC: 9266205] ✅ Text extracted using pdfplumber (5559 chars)
[15:56:59] ✅    ✅ Text extracted using pdfplumber (5559 chars)
[15:56:59] 🔄 
🔄 Step 2: Extracting patient data...
[15:57:02] ℹ️  AI extracted raw sex value: 'F'
[15:57:02] ℹ️  AI extracted service line: 'PT, OT'
[15:57:02] ℹ️  AI extracted payer source: 'Medicare'
[15:57:02] ℹ️  AI extracted diagnoses:
[15:57:02] ℹ️    - Diagnosis 1: ''
[15:57:02] ℹ️    - Diagnosis 2: ''
[15:57:02] ℹ️    - Diagnosis 3: ''
[15:57:02] ℹ️    - Diagnosis 4: ''
[15:57:02] ℹ️    - Diagnosis 5: ''
[15:57:02] ℹ️    - Diagnosis 6: ''
[15:57:02] ℹ️  Final extracted MRN: '5240015'
[15:57:02] ℹ️  Final extracted Sex: 'FEMALE'
[15:57:02] ℹ️  Final extracted Service Line: 'PT, OT'
[15:57:02] ℹ️  Final extracted Payer Source: 'Medicare'
[15:57:02] ✅ Patient data extraction completed successfully
[15:57:02] ✅    ✅ Patient data extracted successfully
[15:57:02] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Cabral
     └─ dob: 10/03/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5240015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/18/2024', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:57:02] ✅    ✅ Patient identified: Donna Cabral
[15:57:02] ✅    ✅ Patient name validation passed
[15:57:02] 🔄 
🔄 Step 3: Processing patient dates...
[15:57:02] [DOC: 9266205] ℹ️  DOB normalized: 10/03/1947
[15:57:02] [DOC: 9266205] ℹ️  Episode startOfCare normalized: 09/18/2024
[15:57:02] [DOC: 9266205] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[15:57:02] [DOC: 9266205] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[15:57:02] [DOC: 9266205] ✅ Patient date processing completed successfully
[15:57:02] ✅    ✅ Date processing completed
[15:57:02] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Cabral
     └─ dob: 10/03/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5240015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/18/2024', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:57:02] 🔄 
🔄 Step 4: Extracting order data...
[15:57:05] ℹ️  Order extraction - MRN: '5240015'
[15:57:05] ℹ️  Order extraction - Sex: 'FEMALE'
[15:57:05] ℹ️  Order extraction - Service Line: 'PT, OT'
[15:57:05] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:57:05] ✅ Order data extraction completed successfully
[15:57:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:57:05] ℹ️  Using MRN from patient data: '5240015' over '5240015'
[15:57:05] ℹ️  Service line consistent in both sources: 'PT, OT'
[15:57:05] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:57:05] ✅ Patient name cross-validation successful
[15:57:05] ✅    ✅ Data merged successfully
[15:57:06] ✅    ✅ Order data extracted and validated
[15:57:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:57:24] [DOC: 9266205] ✅ Patient exists in API: Donna Cabral, ID: 79190189-814f-4114-a438-904080ae2281
[15:57:24] ✅    ✅ Existing patient found with ID: 79190189-814f-4114-a438-904080ae2281
[15:57:24] 🔄 
🔄 Step 6: Pushing order to API...
[15:57:24] [DOC: 9266205] ℹ️  Pushing order via API for patient ID: 79190189-814f-4114-a438-904080ae2281
[15:57:25] [DOC: 9266205] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:57:25] ❌    ❌ Failed to push order
[15:57:25] 🔄 
🔄 Step 7: Writing to CSV...
[15:57:25] [DOC: 9266205] ℹ️  Calculated age: 77 from DOB: 10/03/1947
[15:57:25] [DOC: 9266205] ℹ️  Service Line extracted: 'PT, OT'
[15:57:25] [DOC: 9266205] ℹ️  Payer Source extracted: 'Medicare'
[15:57:25] [DOC: 9266205] ℹ️  Diagnosis codes being written:
[15:57:25] [DOC: 9266205] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:57:25] [DOC: 9266205] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:57:25] [DOC: 9266205] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:57:25] [DOC: 9266205] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:57:25] [DOC: 9266205] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:57:25] [DOC: 9266205] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:57:25] [DOC: 9266205] ✅ Patient data written to CSV: Donna Cabral | Sex: FEMALE | Age: 77 | Service: PT, OT | Payer: Medicare | MRN: 5240015
[15:57:25] ✅    ✅ Document 9266205 processed and saved successfully
[15:57:25] 🔄 
🔄 Step 8: Saving API details...
[15:57:25] [DOC: 9266205] ℹ️  API push details saved for document 9266205
[15:57:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266201                         ║
================================================================================
[15:57:25] ℹ️  Agency: Dartmouth HH
[15:57:25] ℹ️  Date: 04/29/2025
[15:57:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:57:27] [DOC: 9266201] ✅ Text extracted using pdfplumber (1075 chars)
[15:57:27] ✅    ✅ Text extracted using pdfplumber (1075 chars)
[15:57:27] 🔄 
🔄 Step 2: Extracting patient data...
[15:57:30] ℹ️  AI extracted raw sex value: 'M'
[15:57:30] ℹ️  AI extracted service line: 'MSW'
[15:57:30] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[15:57:30] ℹ️  AI extracted diagnoses:
[15:57:30] ℹ️    - Diagnosis 1: ''
[15:57:30] ℹ️    - Diagnosis 2: ''
[15:57:30] ℹ️    - Diagnosis 3: ''
[15:57:30] ℹ️    - Diagnosis 4: ''
[15:57:30] ℹ️    - Diagnosis 5: ''
[15:57:30] ℹ️    - Diagnosis 6: ''
[15:57:30] ℹ️  Final extracted MRN: '5019015'
[15:57:30] ℹ️  Final extracted Sex: 'MALE'
[15:57:30] ℹ️  Final extracted Service Line: 'MSW'
[15:57:30] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[15:57:30] ✅ Patient data extraction completed successfully
[15:57:30] ✅    ✅ Patient data extracted successfully
[15:57:30] 📊 Patient Response
     └─ patientFName: Phillip
     └─ patientLName: Sylvia
     └─ dob: 08/03/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5019015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:57:30] ✅    ✅ Patient identified: Phillip Sylvia
[15:57:30] ✅    ✅ Patient name validation passed
[15:57:30] 🔄 
🔄 Step 3: Processing patient dates...
[15:57:30] [DOC: 9266201] ℹ️  DOB normalized: 08/03/1944
[15:57:30] [DOC: 9266201] ℹ️  Episode startOfCare normalized: 04/02/2025
[15:57:30] [DOC: 9266201] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[15:57:30] [DOC: 9266201] ℹ️  Episode endOfEpisode normalized: 05/31/2025
[15:57:30] [DOC: 9266201] ✅ Patient date processing completed successfully
[15:57:30] ✅    ✅ Date processing completed
[15:57:30] 📊 Processed Patient Data
     └─ patientFName: Phillip
     └─ patientLName: Sylvia
     └─ dob: 08/03/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 5019015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '05/31/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:57:30] 🔄 
🔄 Step 4: Extracting order data...
[15:57:32] ℹ️  Order extraction - MRN: ''
[15:57:32] ℹ️  Order extraction - Sex: 'MALE'
[15:57:32] ℹ️  Order extraction - Service Line: 'MSW'
[15:57:32] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[15:57:32] ✅ Order data extraction completed successfully
[15:57:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:57:32] ℹ️  Using MRN from patient data: '5019015'
[15:57:32] ℹ️  Service line consistent in both sources: 'MSW'
[15:57:32] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[15:57:32] ✅ Patient name cross-validation successful
[15:57:32] ✅    ✅ Data merged successfully
[15:57:34] ✅    ✅ Order data extracted and validated
[15:57:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:57:40] [DOC: 9266201] ✅ Patient exists in API: Phillip Sylvia, ID: da668618-8653-4ff9-a16c-8eb8ca6755a4
[15:57:40] ✅    ✅ Existing patient found with ID: da668618-8653-4ff9-a16c-8eb8ca6755a4
[15:57:40] 🔄 
🔄 Step 6: Pushing order to API...
[15:57:40] [DOC: 9266201] ℹ️  Pushing order via API for patient ID: da668618-8653-4ff9-a16c-8eb8ca6755a4
[15:57:41] [DOC: 9266201] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14473"}
[15:57:41] ❌    ❌ Failed to push order
[15:57:41] 🔄 
🔄 Step 7: Writing to CSV...
[15:57:41] [DOC: 9266201] ℹ️  Calculated age: 80 from DOB: 08/03/1944
[15:57:41] [DOC: 9266201] ℹ️  Service Line extracted: 'MSW'
[15:57:41] [DOC: 9266201] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[15:57:41] [DOC: 9266201] ℹ️  Diagnosis codes being written:
[15:57:41] [DOC: 9266201] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:57:41] [DOC: 9266201] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:57:41] [DOC: 9266201] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:57:41] [DOC: 9266201] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:57:41] [DOC: 9266201] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:57:41] [DOC: 9266201] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:57:41] [DOC: 9266201] ✅ Patient data written to CSV: Phillip Sylvia | Sex: MALE | Age: 80 | Service: MSW | Payer: Aetna- Mcare | MRN: 5019015
[15:57:41] ✅    ✅ Document 9266201 processed and saved successfully
[15:57:41] 🔄 
🔄 Step 8: Saving API details...
[15:57:41] [DOC: 9266201] ℹ️  API push details saved for document 9266201
[15:57:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266196                         ║
================================================================================
[15:57:41] ℹ️  Agency: Dartmouth HH
[15:57:41] ℹ️  Date: 04/29/2025
[15:57:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:57:43] [DOC: 9266196] ✅ Text extracted using pdfplumber (6236 chars)
[15:57:43] ✅    ✅ Text extracted using pdfplumber (6236 chars)
[15:57:43] 🔄 
🔄 Step 2: Extracting patient data...
[15:57:46] ℹ️  AI extracted raw sex value: 'F'
[15:57:46] ℹ️  AI extracted service line: 'PT, RN'
[15:57:46] ℹ️  AI extracted payer source: 'Medicare'
[15:57:46] ℹ️  AI extracted diagnoses:
[15:57:46] ℹ️    - Diagnosis 1: 'K50.9'
[15:57:46] ℹ️    - Diagnosis 2: ''
[15:57:46] ℹ️    - Diagnosis 3: ''
[15:57:46] ℹ️    - Diagnosis 4: ''
[15:57:46] ℹ️    - Diagnosis 5: ''
[15:57:46] ℹ️    - Diagnosis 6: ''
[15:57:46] ℹ️  Final extracted MRN: '418014'
[15:57:46] ℹ️  Final extracted Sex: 'FEMALE'
[15:57:46] ℹ️  Final extracted Service Line: 'PT, RN'
[15:57:46] ℹ️  Final extracted Payer Source: 'Medicare'
[15:57:46] ✅ Patient data extraction completed successfully
[15:57:46] ✅    ✅ Patient data extracted successfully
[15:57:46] 📊 Patient Response
     └─ patientFName: Roberta
     └─ patientLName: Souza
     └─ dob: 08/21/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 418014
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': 'K50.9', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:57:46] ✅    ✅ Patient identified: Roberta Souza
[15:57:46] ✅    ✅ Patient name validation passed
[15:57:46] 🔄 
🔄 Step 3: Processing patient dates...
[15:57:46] [DOC: 9266196] ℹ️  DOB normalized: 08/21/1942
[15:57:46] [DOC: 9266196] ℹ️  Episode startOfCare normalized: 04/11/2025
[15:57:46] [DOC: 9266196] ℹ️  Episode startOfEpisode normalized: 04/02/2025
[15:57:46] [DOC: 9266196] ℹ️  Episode endOfEpisode normalized: 04/27/2025
[15:57:46] [DOC: 9266196] ✅ Patient date processing completed successfully
[15:57:46] ✅    ✅ Date processing completed
[15:57:46] 📊 Processed Patient Data
     └─ patientFName: Roberta
     └─ patientLName: Souza
     └─ dob: 08/21/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 418014
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/02/2025', 'endOfEpisode': '04/27/2025', 'firstDiagnosis': 'K50.9', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:57:46] 🔄 
🔄 Step 4: Extracting order data...
[15:57:48] ℹ️  Order extraction - MRN: '418014'
[15:57:48] ℹ️  Order extraction - Sex: 'FEMALE'
[15:57:48] ℹ️  Order extraction - Service Line: 'PT, Skilled Nursing'
[15:57:48] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:57:48] ✅ Order data extraction completed successfully
[15:57:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:57:48] ℹ️  Using MRN from patient data: '418014' over '418014'
[15:57:48] ℹ️  Combined service lines: Patient='PT, RN' + Order='PT, Skilled Nursing' = 'PT, RN, Skilled Nursing'
[15:57:48] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:57:48] ✅ Patient name cross-validation successful
[15:57:48] ✅    ✅ Data merged successfully
[15:57:49] ✅    ✅ Order data extracted and validated
[15:57:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:58:07] [DOC: 9266196] ✅ Patient exists in API: Roberta Souza, ID: 37701397-7ad1-478d-a62e-32dd7f1f1726
[15:58:07] ✅    ✅ Existing patient found with ID: 37701397-7ad1-478d-a62e-32dd7f1f1726
[15:58:07] 🔄 
🔄 Step 6: Pushing order to API...
[15:58:07] [DOC: 9266196] ℹ️  Pushing order via API for patient ID: 37701397-7ad1-478d-a62e-32dd7f1f1726
[15:58:08] [DOC: 9266196] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:58:08] ❌    ❌ Failed to push order
[15:58:08] 🔄 
🔄 Step 7: Writing to CSV...
[15:58:08] [DOC: 9266196] ℹ️  Calculated age: 82 from DOB: 08/21/1942
[15:58:08] [DOC: 9266196] ℹ️  Service Line extracted: 'PT, RN, Skilled Nursing'
[15:58:08] [DOC: 9266196] ℹ️  Payer Source extracted: 'Medicare'
[15:58:08] [DOC: 9266196] ℹ️  Diagnosis codes being written:
[15:58:08] [DOC: 9266196] ℹ️    - Latest_Episode_Firstdiagnosis: 'K50.9'
[15:58:08] [DOC: 9266196] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:58:08] [DOC: 9266196] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:58:08] [DOC: 9266196] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:58:08] [DOC: 9266196] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:58:08] [DOC: 9266196] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:58:08] [DOC: 9266196] ✅ Patient data written to CSV: Roberta Souza | Sex: FEMALE | Age: 82 | Service: PT, RN, Skilled Nursing | Payer: Medicare | MRN: 418014
[15:58:08] ✅    ✅ Document 9266196 processed and saved successfully
[15:58:08] 🔄 
🔄 Step 8: Saving API details...
[15:58:08] [DOC: 9266196] ℹ️  API push details saved for document 9266196
[15:58:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266187                         ║
================================================================================
[15:58:08] ℹ️  Agency: Dartmouth HH
[15:58:08] ℹ️  Date: 04/29/2025
[15:58:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:58:14] [DOC: 9266187] ✅ Text extracted using pdfplumber (8851 chars)
[15:58:14] ✅    ✅ Text extracted using pdfplumber (8839 chars)
[15:58:14] 🔄 
🔄 Step 2: Extracting patient data...
[15:58:17] ℹ️  AI extracted raw sex value: 'M'
[15:58:17] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:58:17] ℹ️  AI extracted payer source: ''
[15:58:17] ℹ️  AI extracted diagnoses:
[15:58:17] ℹ️    - Diagnosis 1: 'E10.40'
[15:58:17] ℹ️    - Diagnosis 2: 'H54.8'
[15:58:17] ℹ️    - Diagnosis 3: 'M54.30'
[15:58:17] ℹ️    - Diagnosis 4: 'H25.019'
[15:58:17] ℹ️    - Diagnosis 5: 'G89.29'
[15:58:17] ℹ️    - Diagnosis 6: 'M54.50'
[15:58:17] ℹ️  Final extracted MRN: '1960002'
[15:58:17] ℹ️  Final extracted Sex: 'MALE'
[15:58:17] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:58:17] ℹ️  Final extracted Payer Source: ''
[15:58:17] ✅ Patient data extraction completed successfully
[15:58:17] ✅    ✅ Patient data extracted successfully
[15:58:17] 📊 Patient Response
     └─ patientFName: Daniel W
     └─ patientLName: Brisson
     └─ dob: 05/18/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 1960002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/21/2023', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'E10.40', 'secondDiagnosis': 'H54.8', 'thirdDiagnosis': 'M54.30', 'fourthDiagnosis': 'H25.019', 'fifthDiagnosis': 'G89.29', 'sixthDiagnosis': 'M54.50'}]
[15:58:17] ✅    ✅ Patient identified: Daniel W Brisson
[15:58:17] ✅    ✅ Patient name validation passed
[15:58:17] 🔄 
🔄 Step 3: Processing patient dates...
[15:58:17] [DOC: 9266187] ℹ️  DOB normalized: 05/18/1949
[15:58:17] [DOC: 9266187] ℹ️  Episode startOfCare normalized: 12/21/2023
[15:58:17] [DOC: 9266187] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[15:58:17] [DOC: 9266187] ℹ️  Episode endOfEpisode normalized: 06/12/2025
[15:58:17] [DOC: 9266187] ✅ Patient date processing completed successfully
[15:58:17] ✅    ✅ Date processing completed
[15:58:17] 📊 Processed Patient Data
     └─ patientFName: Daniel W
     └─ patientLName: Brisson
     └─ dob: 05/18/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 1960002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '12/21/2023', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '06/12/2025', 'firstDiagnosis': 'E10.40', 'secondDiagnosis': 'H54.8', 'thirdDiagnosis': 'M54.30', 'fourthDiagnosis': 'H25.019', 'fifthDiagnosis': 'G89.29', 'sixthDiagnosis': 'M54.50'}]
[15:58:17] 🔄 
🔄 Step 4: Extracting order data...
[15:58:19] ℹ️  Order extraction - MRN: '1960002'
[15:58:19] ℹ️  Order extraction - Sex: 'MALE'
[15:58:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:58:19] ℹ️  Order extraction - Payer Source: ''
[15:58:19] ✅ Order data extraction completed successfully
[15:58:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:58:19] ℹ️  Using MRN from patient data: '1960002' over '1960002'
[15:58:19] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:58:19] ✅ Patient name cross-validation successful
[15:58:19] ✅    ✅ Data merged successfully
[15:58:21] ✅    ✅ Order data extracted and validated
[15:58:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:58:26] [DOC: 9266187] ℹ️  Patient not found in cache or API: Daniel W Brisson
[15:58:26] [DOC: 9266187] ℹ️  Patient not found, creating new patient via API...
[15:58:26] [DOC: 9266187] ℹ️  Creating patient via API: Daniel W Brisson
[15:58:27] [DOC: 9266187] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[15:58:27] ❌    ❌ Failed to create patient
[15:58:27] [DOC: 9266187] ℹ️  API push details saved for document 9266187
================================================================================
║                        Processing Document ID: 9266183                         ║
================================================================================
[15:58:27] ℹ️  Agency: Nizhoni Health-Fall River
[15:58:27] ℹ️  Date: 04/29/2025
[15:58:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:58:30] [DOC: 9266183] ✅ Text extracted using pdfplumber (1266 chars)
[15:58:30] ✅    ✅ Text extracted using pdfplumber (1266 chars)
[15:58:30] 🔄 
🔄 Step 2: Extracting patient data...
[15:58:33] ℹ️  AI extracted raw sex value: 'M'
[15:58:33] ℹ️  AI extracted service line: 'HHA'
[15:58:33] ℹ️  AI extracted payer source: 'Medicaid/MA'
[15:58:33] ℹ️  AI extracted diagnoses:
[15:58:33] ℹ️    - Diagnosis 1: ''
[15:58:33] ℹ️    - Diagnosis 2: ''
[15:58:33] ℹ️    - Diagnosis 3: ''
[15:58:33] ℹ️    - Diagnosis 4: ''
[15:58:33] ℹ️    - Diagnosis 5: ''
[15:58:33] ℹ️    - Diagnosis 6: ''
[15:58:33] ℹ️  Final extracted MRN: '15538'
[15:58:33] ℹ️  Final extracted Sex: 'MALE'
[15:58:33] ℹ️  Final extracted Service Line: 'HHA'
[15:58:33] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[15:58:33] ✅ Patient data extraction completed successfully
[15:58:33] ✅    ✅ Patient data extracted successfully
[15:58:33] 📊 Patient Response
     └─ patientFName: Darryl
     └─ patientLName: Brooks
     └─ dob: 09/12/1978
     └─ patientSex: MALE
     └─ medicalRecordNo: 15538
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 217 Deane St Apt 110
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/04/2014', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:58:33] ✅    ✅ Patient identified: Darryl Brooks
[15:58:33] ✅    ✅ Patient name validation passed
[15:58:33] 🔄 
🔄 Step 3: Processing patient dates...
[15:58:33] [DOC: 9266183] ℹ️  DOB normalized: 09/12/1978
[15:58:33] [DOC: 9266183] ℹ️  Episode startOfCare normalized: 09/04/2014
[15:58:33] [DOC: 9266183] ℹ️  Episode startOfEpisode normalized: 03/10/2025
[15:58:33] [DOC: 9266183] ℹ️  Episode endOfEpisode normalized: 05/08/2025
[15:58:33] [DOC: 9266183] ✅ Patient date processing completed successfully
[15:58:33] ✅    ✅ Date processing completed
[15:58:33] 📊 Processed Patient Data
     └─ patientFName: Darryl
     └─ patientLName: Brooks
     └─ dob: 09/12/1978
     └─ patientSex: MALE
     └─ medicalRecordNo: 15538
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 217 Deane St Apt 110
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02746
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/04/2014', 'startOfEpisode': '03/10/2025', 'endOfEpisode': '05/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[15:58:33] 🔄 
🔄 Step 4: Extracting order data...
[15:58:35] ℹ️  Order extraction - MRN: '15538'
[15:58:35] ℹ️  Order extraction - Sex: 'MALE'
[15:58:35] ℹ️  Order extraction - Service Line: ''
[15:58:35] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[15:58:35] ✅ Order data extraction completed successfully
[15:58:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:58:35] ℹ️  Using MRN from patient data: '15538' over '15538'
[15:58:35] ℹ️  Using service line from patient data: 'HHA'
[15:58:35] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[15:58:35] ✅ Patient name cross-validation successful
[15:58:35] ✅    ✅ Data merged successfully
[15:58:37] ✅    ✅ Order data extracted and validated
[15:58:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:59:01] [DOC: 9266183] ✅ Patient exists in API: Darryl Brooks, ID: d50c5701-e6e1-4a5d-aec6-2bc64ed0d496
[15:59:01] ✅    ✅ Existing patient found with ID: d50c5701-e6e1-4a5d-aec6-2bc64ed0d496
[15:59:01] 🔄 
🔄 Step 6: Pushing order to API...
[15:59:01] [DOC: 9266183] ℹ️  Pushing order via API for patient ID: d50c5701-e6e1-4a5d-aec6-2bc64ed0d496
[15:59:03] [DOC: 9266183] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:59:03] ❌    ❌ Failed to push order
[15:59:03] 🔄 
🔄 Step 7: Writing to CSV...
[15:59:03] [DOC: 9266183] ℹ️  Calculated age: 46 from DOB: 09/12/1978
[15:59:03] [DOC: 9266183] ℹ️  Service Line extracted: 'HHA'
[15:59:03] [DOC: 9266183] ℹ️  Payer Source extracted: 'Medicaid/MA'
[15:59:03] [DOC: 9266183] ℹ️  Diagnosis codes being written:
[15:59:03] [DOC: 9266183] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[15:59:03] [DOC: 9266183] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[15:59:03] [DOC: 9266183] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[15:59:03] [DOC: 9266183] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[15:59:03] [DOC: 9266183] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[15:59:03] [DOC: 9266183] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[15:59:03] [DOC: 9266183] ✅ Patient data written to CSV: Darryl Brooks | Sex: MALE | Age: 46 | Service: HHA | Payer: Medicaid/MA | MRN: 15538
[15:59:03] ✅    ✅ Document 9266183 processed and saved successfully
[15:59:03] 🔄 
🔄 Step 8: Saving API details...
[15:59:03] [DOC: 9266183] ℹ️  API push details saved for document 9266183
[15:59:03] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266181                         ║
================================================================================
[15:59:03] ℹ️  Agency: Dartmouth HH
[15:59:03] ℹ️  Date: 04/29/2025
[15:59:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:59:06] [DOC: 9266181] ✅ Text extracted using pdfplumber (16755 chars)
[15:59:06] ✅    ✅ Text extracted using pdfplumber (16743 chars)
[15:59:06] 🔄 
🔄 Step 2: Extracting patient data...
[15:59:09] ℹ️  AI extracted raw sex value: 'F'
[15:59:09] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT, ST'
[15:59:09] ℹ️  AI extracted payer source: ''
[15:59:09] ℹ️  AI extracted diagnoses:
[15:59:09] ℹ️    - Diagnosis 1: 'K57.32'
[15:59:09] ℹ️    - Diagnosis 2: 'R53.1'
[15:59:09] ℹ️    - Diagnosis 3: 'G50.0'
[15:59:09] ℹ️    - Diagnosis 4: 'E43'
[15:59:09] ℹ️    - Diagnosis 5: 'Z68.21'
[15:59:09] ℹ️    - Diagnosis 6: 'I10'
[15:59:09] ℹ️  Final extracted MRN: '418014'
[15:59:09] ℹ️  Final extracted Sex: 'FEMALE'
[15:59:09] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT, ST'
[15:59:09] ℹ️  Final extracted Payer Source: ''
[15:59:09] ✅ Patient data extraction completed successfully
[15:59:09] ✅    ✅ Patient data extracted successfully
[15:59:09] 📊 Patient Response
     └─ patientFName: Roberta
     └─ patientLName: Souza
     └─ dob: 08/21/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 418014
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'K57.32', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'G50.0', 'fourthDiagnosis': 'E43', 'fifthDiagnosis': 'Z68.21', 'sixthDiagnosis': 'I10'}]
[15:59:09] ✅    ✅ Patient identified: Roberta Souza
[15:59:09] ✅    ✅ Patient name validation passed
[15:59:09] 🔄 
🔄 Step 3: Processing patient dates...
[15:59:09] [DOC: 9266181] ℹ️  DOB normalized: 08/21/1942
[15:59:09] [DOC: 9266181] ℹ️  Episode startOfCare normalized: 04/11/2025
[15:59:09] [DOC: 9266181] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[15:59:09] [DOC: 9266181] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[15:59:09] [DOC: 9266181] ✅ Patient date processing completed successfully
[15:59:09] ✅    ✅ Date processing completed
[15:59:09] 📊 Processed Patient Data
     └─ patientFName: Roberta
     └─ patientLName: Souza
     └─ dob: 08/21/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 418014
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/11/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'K57.32', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'G50.0', 'fourthDiagnosis': 'E43', 'fifthDiagnosis': 'Z68.21', 'sixthDiagnosis': 'I10'}]
[15:59:09] 🔄 
🔄 Step 4: Extracting order data...
[15:59:11] ℹ️  Order extraction - MRN: '418014'
[15:59:11] ℹ️  Order extraction - Sex: 'FEMALE'
[15:59:11] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy'
[15:59:11] ℹ️  Order extraction - Payer Source: ''
[15:59:11] ✅ Order data extraction completed successfully
[15:59:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:59:11] ℹ️  Using MRN from patient data: '418014' over '418014'
[15:59:11] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT, ST' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy, Speech Therapy' = 'OT, Occupational Therapy, PT, Physical Therapy, ST, Skilled Nursing, Speech Therapy'
[15:59:11] ✅ Patient name cross-validation successful
[15:59:11] ✅    ✅ Data merged successfully
[15:59:13] ✅    ✅ Order data extracted and validated
[15:59:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:59:13] [DOC: 9266181] ✅ Patient found in local cache: Roberta Souza, ID: 37701397-7ad1-478d-a62e-32dd7f1f1726
[15:59:13] ✅    ✅ Existing patient found with ID: 37701397-7ad1-478d-a62e-32dd7f1f1726
[15:59:13] 🔄 
🔄 Step 6: Pushing order to API...
[15:59:13] [DOC: 9266181] ℹ️  Pushing order via API for patient ID: 37701397-7ad1-478d-a62e-32dd7f1f1726
[15:59:14] [DOC: 9266181] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:59:14] ❌    ❌ Failed to push order
[15:59:14] 🔄 
🔄 Step 7: Writing to CSV...
[15:59:14] [DOC: 9266181] ℹ️  Calculated age: 82 from DOB: 08/21/1942
[15:59:14] [DOC: 9266181] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy, ST, Skilled Nursing, Speech Therapy'
[15:59:14] [DOC: 9266181] ℹ️  Payer Source extracted: ''
[15:59:14] [DOC: 9266181] ℹ️  Diagnosis codes being written:
[15:59:14] [DOC: 9266181] ℹ️    - Latest_Episode_Firstdiagnosis: 'K57.32'
[15:59:14] [DOC: 9266181] ℹ️    - Latest_Episode_Seconddiagnosis: 'R53.1'
[15:59:14] [DOC: 9266181] ℹ️    - Latest_Episode_Thirddiagnosis: 'G50.0'
[15:59:14] [DOC: 9266181] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E43'
[15:59:14] [DOC: 9266181] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z68.21'
[15:59:14] [DOC: 9266181] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I10'
[15:59:14] [DOC: 9266181] ✅ Patient data written to CSV: Roberta Souza | Sex: FEMALE | Age: 82 | Service: OT, Occupational Therapy, PT, Physical Therapy, ST, Skilled Nursing, Speech Therapy | Payer:  | MRN: 418014
[15:59:14] ✅    ✅ Document 9266181 processed and saved successfully
[15:59:14] 🔄 
🔄 Step 8: Saving API details...
[15:59:14] [DOC: 9266181] ℹ️  API push details saved for document 9266181
[15:59:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9266170                         ║
================================================================================
[15:59:14] ℹ️  Agency: Dartmouth HH
[15:59:14] ℹ️  Date: 04/29/2025
[15:59:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[15:59:16] [DOC: 9266170] ✅ Text extracted using pdfplumber (9185 chars)
[15:59:16] ✅    ✅ Text extracted using pdfplumber (9185 chars)
[15:59:16] 🔄 
🔄 Step 2: Extracting patient data...
[15:59:19] ℹ️  AI extracted raw sex value: 'F'
[15:59:19] ℹ️  AI extracted service line: 'Skilled Nursing'
[15:59:19] ℹ️  AI extracted payer source: 'Medicare'
[15:59:19] ℹ️  AI extracted diagnoses:
[15:59:19] ℹ️    - Diagnosis 1: 'K83.09'
[15:59:19] ℹ️    - Diagnosis 2: 'K85.90'
[15:59:19] ℹ️    - Diagnosis 3: 'A09'
[15:59:19] ℹ️    - Diagnosis 4: 'C25.0'
[15:59:19] ℹ️    - Diagnosis 5: 'E11.65'
[15:59:19] ℹ️    - Diagnosis 6: 'D63.0'
[15:59:19] ℹ️  Final extracted MRN: '2429011'
[15:59:19] ℹ️  Final extracted Sex: 'FEMALE'
[15:59:19] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[15:59:19] ℹ️  Final extracted Payer Source: 'Medicare'
[15:59:19] ✅ Patient data extraction completed successfully
[15:59:19] ✅    ✅ Patient data extracted successfully
[15:59:19] 📊 Patient Response
     └─ patientFName: Eduarda
     └─ patientLName: Demello
     └─ dob: 09/29/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2429011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/04/2024', 'startOfEpisode': '04/24/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': 'K83.09', 'secondDiagnosis': 'K85.90', 'thirdDiagnosis': 'A09', 'fourthDiagnosis': 'C25.0', 'fifthDiagnosis': 'E11.65', 'sixthDiagnosis': 'D63.0'}]
[15:59:19] ✅    ✅ Patient identified: Eduarda Demello
[15:59:19] ✅    ✅ Patient name validation passed
[15:59:19] 🔄 
🔄 Step 3: Processing patient dates...
[15:59:19] [DOC: 9266170] ℹ️  DOB normalized: 09/29/1942
[15:59:19] [DOC: 9266170] ℹ️  Episode startOfCare normalized: 11/04/2024
[15:59:19] [DOC: 9266170] ℹ️  Episode startOfEpisode normalized: 04/24/2025
[15:59:19] [DOC: 9266170] ℹ️  Episode endOfEpisode normalized: 05/02/2025
[15:59:19] [DOC: 9266170] ✅ Patient date processing completed successfully
[15:59:19] ✅    ✅ Date processing completed
[15:59:19] 📊 Processed Patient Data
     └─ patientFName: Eduarda
     └─ patientLName: Demello
     └─ dob: 09/29/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2429011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/04/2024', 'startOfEpisode': '04/24/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': 'K83.09', 'secondDiagnosis': 'K85.90', 'thirdDiagnosis': 'A09', 'fourthDiagnosis': 'C25.0', 'fifthDiagnosis': 'E11.65', 'sixthDiagnosis': 'D63.0'}]
[15:59:19] 🔄 
🔄 Step 4: Extracting order data...
[15:59:22] ℹ️  Order extraction - MRN: ''
[15:59:22] ℹ️  Order extraction - Sex: 'FEMALE'
[15:59:22] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[15:59:22] ℹ️  Order extraction - Payer Source: 'Medicare'
[15:59:22] ✅ Order data extraction completed successfully
[15:59:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[15:59:22] ℹ️  Using MRN from patient data: '2429011'
[15:59:22] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[15:59:22] ℹ️  Payer source consistent in both sources: 'Medicare'
[15:59:22] ✅ Patient name cross-validation successful
[15:59:22] ✅    ✅ Data merged successfully
[15:59:23] ✅    ✅ Order data extracted and validated
[15:59:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[15:59:39] [DOC: 9266170] ✅ Patient exists in API: Eduarda Demello, ID: 1c325c5b-5ef1-405d-9b3b-4d166788bcda
[15:59:39] ✅    ✅ Existing patient found with ID: 1c325c5b-5ef1-405d-9b3b-4d166788bcda
[15:59:39] 🔄 
🔄 Step 6: Pushing order to API...
[15:59:39] [DOC: 9266170] ℹ️  Pushing order via API for patient ID: 1c325c5b-5ef1-405d-9b3b-4d166788bcda
[15:59:40] [DOC: 9266170] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[15:59:40] ❌    ❌ Failed to push order
[15:59:40] 🔄 
🔄 Step 7: Writing to CSV...
[15:59:40] [DOC: 9266170] ℹ️  Calculated age: 82 from DOB: 09/29/1942
[15:59:40] [DOC: 9266170] ℹ️  Service Line extracted: 'Skilled Nursing'
[15:59:40] [DOC: 9266170] ℹ️  Payer Source extracted: 'Medicare'
[15:59:40] [DOC: 9266170] ℹ️  Diagnosis codes being written:
[15:59:40] [DOC: 9266170] ℹ️    - Latest_Episode_Firstdiagnosis: 'K83.09'
[15:59:40] [DOC: 9266170] ℹ️    - Latest_Episode_Seconddiagnosis: 'K85.90'
[15:59:40] [DOC: 9266170] ℹ️    - Latest_Episode_Thirddiagnosis: 'A09'
[15:59:40] [DOC: 9266170] ℹ️    - Latest_Episode_Fourthdiagnosis: 'C25.0'
[15:59:40] [DOC: 9266170] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.65'
[15:59:40] [DOC: 9266170] ℹ️    - Latest_Episode_Sixthdiagnosis: 'D63.0'
[15:59:40] [DOC: 9266170] ✅ Patient data written to CSV: Eduarda Demello | Sex: FEMALE | Age: 82 | Service: Skilled Nursing | Payer: Medicare | MRN: 2429011
[15:59:40] ✅    ✅ Document 9266170 processed and saved successfully
[15:59:40] 🔄 
🔄 Step 8: Saving API details...
[15:59:40] [DOC: 9266170] ℹ️  API push details saved for document 9266170
[15:59:40] ✅    ✅ API details saved
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[15:59:40] ℹ️  Total Processed: 49
[15:59:40] ℹ️  CSV Success: 38
[15:59:40] ℹ️  CSV Errors: 0
[15:59:40] ℹ️  API Success: 0
[15:59:40] ℹ️  API Errors: 49
[15:59:40] ℹ️  CSV Success Rate: 77.6%
[15:59:40] ℹ️  API Success Rate: 0.0%
[15:59:40] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250607_154447.csv
[15:59:40] ℹ️  API Details File: api_outputs/api_push_details_20250607_154447.csv
================================================================================
║          ============================================================          ║
================================================================================
