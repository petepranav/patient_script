================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[23:09:17] ℹ️  CSV Data Extraction & API Push Tool
[23:09:17] ℹ️  
[23:09:17] ℹ️  Features:
[23:09:17] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[23:09:17] ℹ️  - AI-powered patient and order data extraction
[23:09:17] ℹ️  - Enhanced error handling and logging
[23:09:17] ℹ️  - Full API integration (patient creation + order pushing)
[23:09:17] ℹ️  - CSV output with comprehensive patient data
[23:09:17] ℹ️  - Detailed API tracking with remarks for every document
[23:09:17] ℹ️  - Complete audit trail of all processing attempts
[23:09:17] ℹ️  
[23:09:17] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[23:09:17] ✅ Created output CSV file: csv_outputs/extracted_patients_20250606_230917.csv
[23:09:17] ✅ Created API details CSV file: api_outputs/api_push_details_20250606_230917.csv
================================================================================
║                        Processing Document ID: 9259497                         ║
================================================================================
[23:09:17] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[23:09:17] ℹ️  Date: 04/24/2025
[23:09:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[23:09:20] [DOC: 9259497] ✅ Text extracted using pdfplumber (2612 chars)
[23:09:20] ✅    ✅ Text extracted using pdfplumber (2612 chars)
[23:09:20] 🔄 
🔄 Step 2: Extracting patient data...
[23:09:24] ℹ️  AI extracted raw sex value: 'M'
[23:09:24] ℹ️  AI extracted service line: 'Physical Therapy'
[23:09:24] ℹ️  AI extracted payer source: ''
[23:09:24] ℹ️  AI extracted diagnoses:
[23:09:24] ℹ️    - Diagnosis 1: 'None'
[23:09:24] ℹ️    - Diagnosis 2: 'None'
[23:09:24] ℹ️    - Diagnosis 3: 'None'
[23:09:24] ℹ️    - Diagnosis 4: 'None'
[23:09:24] ℹ️    - Diagnosis 5: 'None'
[23:09:24] ℹ️    - Diagnosis 6: 'None'
[23:09:24] ℹ️  Final extracted MRN: '2005206'
[23:09:24] ℹ️  Final extracted Sex: 'MALE'
[23:09:24] ℹ️  Final extracted Service Line: 'Physical Therapy'
[23:09:24] ℹ️  Final extracted Payer Source: ''
[23:09:24] ✅ Patient data extraction completed successfully
[23:09:24] ✅    ✅ Patient data extracted successfully
[23:09:24] 📊 Patient Response
     └─ patientFName: Jose
     └─ patientLName: Baptista
     └─ dob: 07/02/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2005206
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[23:09:24] ✅    ✅ Patient identified: Jose Baptista
[23:09:24] ✅    ✅ Patient name validation passed
[23:09:24] 🔄 
🔄 Step 3: Processing patient dates...
[23:09:24] [DOC: 9259497] ℹ️  DOB normalized: 07/02/1934
[23:09:24] [DOC: 9259497] ✅ Patient date processing completed successfully
[23:09:24] ✅    ✅ Date processing completed
[23:09:24] 📊 Processed Patient Data
     └─ patientFName: Jose
     └─ patientLName: Baptista
     └─ dob: 07/02/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2005206
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[23:09:24] 🔄 
🔄 Step 4: Extracting order data...
[23:09:27] ℹ️  Order extraction - MRN: '2005206'
[23:09:27] ℹ️  Order extraction - Sex: 'MALE'
[23:09:27] ℹ️  Order extraction - Service Line: ''
[23:09:27] ℹ️  Order extraction - Payer Source: ''
[23:09:27] ✅ Order data extraction completed successfully
[23:09:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[23:09:27] ℹ️  Using MRN from patient data: '2005206' over '2005206'
[23:09:27] ℹ️  Using service line from patient data: 'Physical Therapy'
[23:09:27] ✅ Patient name cross-validation successful
[23:09:27] ✅    ✅ Data merged successfully
[23:09:28] ⚠️     ❌ Skipping - missing episode start date
[23:09:28] [DOC: 9259497] ℹ️  API push details saved for document 9259497
================================================================================
║                        Processing Document ID: 9259495                         ║
================================================================================
[23:09:28] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[23:09:28] ℹ️  Date: 04/24/2025
[23:09:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[23:09:33] [DOC: 9259495] ✅ Text extracted using pdfplumber (15814 chars)
[23:09:33] ✅    ✅ Text extracted using pdfplumber (15814 chars)
[23:09:33] 🔄 
🔄 Step 2: Extracting patient data...
[23:09:37] ℹ️  AI extracted raw sex value: 'M'
[23:09:37] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[23:09:37] ℹ️  AI extracted payer source: ''
[23:09:37] ℹ️  AI extracted diagnoses:
[23:09:37] ℹ️    - Diagnosis 1: 'G20.A1'
[23:09:37] ℹ️    - Diagnosis 2: 'I88.0'
[23:09:37] ℹ️    - Diagnosis 3: 'R53.1'
[23:09:37] ℹ️    - Diagnosis 4: 'I10'
[23:09:37] ℹ️    - Diagnosis 5: 'N13.30'
[23:09:37] ℹ️    - Diagnosis 6: 'N40.1'
[23:09:37] ℹ️  Final extracted MRN: '2211831'
[23:09:37] ℹ️  Final extracted Sex: 'MALE'
[23:09:37] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[23:09:37] ℹ️  Final extracted Payer Source: ''
[23:09:37] ✅ Patient data extraction completed successfully
[23:09:37] ✅    ✅ Patient data extracted successfully
[23:09:37] 📊 Patient Response
     └─ patientFName: Viriato
     └─ patientLName: Bala
     └─ dob: 11/12/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 2211831
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/10/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I88.0', 'thirdDiagnosis': 'R53.1', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'N13.30', 'sixthDiagnosis': 'N40.1'}]
[23:09:37] ✅    ✅ Patient identified: Viriato Bala
[23:09:37] ✅    ✅ Patient name validation passed
[23:09:37] 🔄 
🔄 Step 3: Processing patient dates...
[23:09:37] [DOC: 9259495] ℹ️  DOB normalized: 11/12/1937
[23:09:37] [DOC: 9259495] ℹ️  Episode startOfCare normalized: 02/10/2025
[23:09:37] [DOC: 9259495] ℹ️  Episode startOfEpisode normalized: 04/11/2025
[23:09:37] [DOC: 9259495] ℹ️  Episode endOfEpisode normalized: 06/09/2025
[23:09:37] [DOC: 9259495] ✅ Patient date processing completed successfully
[23:09:37] ✅    ✅ Date processing completed
[23:09:37] 📊 Processed Patient Data
     └─ patientFName: Viriato
     └─ patientLName: Bala
     └─ dob: 11/12/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 2211831
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '02/10/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I88.0', 'thirdDiagnosis': 'R53.1', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'N13.30', 'sixthDiagnosis': 'N40.1'}]
[23:09:37] 🔄 
🔄 Step 4: Extracting order data...
[23:09:40] ℹ️  Order extraction - MRN: '2211831'
[23:09:40] ℹ️  Order extraction - Sex: 'MALE'
[23:09:40] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy'
[23:09:40] ℹ️  Order extraction - Payer Source: ''
[23:09:40] ✅ Order data extraction completed successfully
[23:09:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[23:09:40] ℹ️  Using MRN from patient data: '2211831' over '2211831'
[23:09:40] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy'
[23:09:40] ✅ Patient name cross-validation successful
[23:09:40] ✅    ✅ Data merged successfully
[23:09:41] ✅    ✅ Order data extracted and validated
[23:09:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[23:09:41] [DOC: 9259495] ✅ Patient found in local cache: Viriato Bala, ID: b70c4038-8eef-4f28-b15b-74771b9982ae
[23:09:41] ✅    ✅ Existing patient found with ID: b70c4038-8eef-4f28-b15b-74771b9982ae
[23:09:41] 🔄 
🔄 Step 6: Pushing order to API...
[23:09:41] [DOC: 9259495] ℹ️  Pushing order via API for patient ID: b70c4038-8eef-4f28-b15b-74771b9982ae
[23:09:42] [DOC: 9259495] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12982"}
[23:09:42] ❌    ❌ Failed to push order
[23:09:42] 🔄 
🔄 Step 7: Writing to CSV...
[23:09:42] [DOC: 9259495] ℹ️  Calculated age: 87 from DOB: 11/12/1937
[23:09:42] [DOC: 9259495] ℹ️  Service Line extracted: 'Physical Therapy, Occupational Therapy'
[23:09:42] [DOC: 9259495] ℹ️  Payer Source extracted: ''
[23:09:42] [DOC: 9259495] ℹ️  Diagnosis codes being written:
[23:09:42] [DOC: 9259495] ℹ️    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[23:09:42] [DOC: 9259495] ℹ️    - Latest_Episode_Seconddiagnosis: 'I88.0'
[23:09:42] [DOC: 9259495] ℹ️    - Latest_Episode_Thirddiagnosis: 'R53.1'
[23:09:42] [DOC: 9259495] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[23:09:42] [DOC: 9259495] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N13.30'
[23:09:42] [DOC: 9259495] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N40.1'
[23:09:42] [DOC: 9259495] ✅ Patient data written to CSV: Viriato Bala | Sex: MALE | Age: 87 | Service: Physical Therapy, Occupational Therapy | Payer:  | MRN: 2211831
[23:09:42] ✅    ✅ Document 9259495 processed and saved successfully
[23:09:42] 🔄 
🔄 Step 8: Saving API details...
[23:09:42] [DOC: 9259495] ℹ️  API push details saved for document 9259495
[23:09:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258663                         ║
================================================================================
[23:09:42] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[23:09:42] ℹ️  Date: 04/24/2025
[23:09:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[23:09:48] [DOC: 9258663] ✅ Text extracted using pdfplumber (12349 chars)
[23:09:48] ✅    ✅ Text extracted using pdfplumber (12349 chars)
[23:09:48] 🔄 
🔄 Step 2: Extracting patient data...
[23:09:51] ℹ️  AI extracted raw sex value: 'F'
[23:09:51] ℹ️  AI extracted service line: 'OT'
[23:09:51] ℹ️  AI extracted payer source: ''
[23:09:51] ℹ️  AI extracted diagnoses:
[23:09:51] ℹ️    - Diagnosis 1: 'J44.1'
[23:09:51] ℹ️    - Diagnosis 2: 'M62.81'
[23:09:51] ℹ️    - Diagnosis 3: ''
[23:09:51] ℹ️    - Diagnosis 4: ''
[23:09:51] ℹ️    - Diagnosis 5: ''
[23:09:51] ℹ️    - Diagnosis 6: ''
[23:09:51] ℹ️  Final extracted MRN: 'MA250130025704'
[23:09:51] ℹ️  Final extracted Sex: 'FEMALE'
[23:09:51] ℹ️  Final extracted Service Line: 'OT'
[23:09:51] ℹ️  Final extracted Payer Source: ''
[23:09:51] ✅ Patient data extraction completed successfully
[23:09:51] ✅    ✅ Patient data extracted successfully
[23:09:51] 📊 Patient Response
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[23:09:51] ✅    ✅ Patient identified: Theresa Racine
[23:09:51] ✅    ✅ Patient name validation passed
[23:09:51] 🔄 
🔄 Step 3: Processing patient dates...
[23:09:51] [DOC: 9258663] ℹ️  DOB normalized: 02/10/1957
[23:09:51] [DOC: 9258663] ℹ️  Episode startOfEpisode normalized: 03/05/2025
[23:09:51] [DOC: 9258663] ✅ Patient date processing completed successfully
[23:09:51] ✅    ✅ Date processing completed
[23:09:51] 📊 Processed Patient Data
     └─ patientFName: Theresa
     └─ patientLName: Racine
     └─ dob: 02/10/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250130025704
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[23:09:51] 🔄 
🔄 Step 4: Extracting order data...
[23:09:54] ℹ️  Order extraction - MRN: 'MA250130025704'
[23:09:54] ℹ️  Order extraction - Sex: 'FEMALE'
[23:09:54] ℹ️  Order extraction - Service Line: 'OT'
[23:09:54] ℹ️  Order extraction - Payer Source: ''
[23:09:54] ✅ Order data extraction completed successfully
[23:09:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[23:09:54] ℹ️  Using MRN from patient data: 'MA250130025704' over 'MA250130025704'
[23:09:54] ℹ️  Service line consistent in both sources: 'OT'
[23:09:54] ✅ Patient name cross-validation successful
[23:09:54] ✅    ✅ Data merged successfully
[23:09:55] ✅    ✅ Order data extracted and validated
[23:09:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[23:09:55] [DOC: 9258663] ✅ Patient found in local cache: Theresa Racine, ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[23:09:55] ✅    ✅ Existing patient found with ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[23:09:55] 🔄 
🔄 Step 6: Pushing order to API...
[23:09:55] [DOC: 9258663] ℹ️  Pushing order via API for patient ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[23:09:56] [DOC: 9258663] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[23:09:56] ❌    ❌ Failed to push order
[23:09:56] 🔄 
🔄 Step 7: Writing to CSV...
[23:09:56] [DOC: 9258663] ℹ️  Calculated age: 68 from DOB: 02/10/1957
[23:09:56] [DOC: 9258663] ℹ️  Service Line extracted: 'OT'
[23:09:56] [DOC: 9258663] ℹ️  Payer Source extracted: ''
[23:09:56] [DOC: 9258663] ℹ️  Diagnosis codes being written:
[23:09:56] [DOC: 9258663] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[23:09:56] [DOC: 9258663] ℹ️    - Latest_Episode_Seconddiagnosis: 'M62.81'
[23:09:56] [DOC: 9258663] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[23:09:56] [DOC: 9258663] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[23:09:56] [DOC: 9258663] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[23:09:56] [DOC: 9258663] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[23:09:56] [DOC: 9258663] ✅ Patient data written to CSV: Theresa Racine | Sex: FEMALE | Age: 68 | Service: OT | Payer:  | MRN: MA250130025704
[23:09:56] ✅    ✅ Document 9258663 processed and saved successfully
[23:09:56] 🔄 
🔄 Step 8: Saving API details...
[23:09:56] [DOC: 9258663] ℹ️  API push details saved for document 9258663
[23:09:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258661                         ║
================================================================================
[23:09:56] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[23:09:56] ℹ️  Date: 04/24/2025
[23:09:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[23:09:59] [DOC: 9258661] ✅ Text extracted using pdfplumber (1686 chars)
[23:09:59] ✅    ✅ Text extracted using pdfplumber (1686 chars)
[23:09:59] 🔄 
🔄 Step 2: Extracting patient data...
[23:10:02] ℹ️  AI extracted raw sex value: ''
[23:10:02] ℹ️  AI extracted service line: 'Skilled Nursing'
[23:10:02] ℹ️  AI extracted payer source: ''
[23:10:02] ℹ️  AI extracted diagnoses:
[23:10:02] ℹ️    - Diagnosis 1: 'E11.65'
[23:10:02] ℹ️    - Diagnosis 2: 'I10'
[23:10:02] ℹ️    - Diagnosis 3: 'H54.8'
[23:10:02] ℹ️    - Diagnosis 4: 'None'
[23:10:02] ℹ️    - Diagnosis 5: 'None'
[23:10:02] ℹ️    - Diagnosis 6: 'None'
[23:10:02] ℹ️  Final extracted MRN: 'MA210907053505'
[23:10:02] ℹ️  Final extracted Sex: ''
[23:10:02] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[23:10:02] ℹ️  Final extracted Payer Source: ''
[23:10:02] ✅ Patient data extraction completed successfully
[23:10:02] ✅    ✅ Patient data extracted successfully
[23:10:02] 📊 Patient Response
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[23:10:02] ✅    ✅ Patient identified: Rolande Morrell
[23:10:02] ✅    ✅ Patient name validation passed
[23:10:02] 🔄 
🔄 Step 3: Processing patient dates...
[23:10:02] [DOC: 9258661] ℹ️  DOB normalized: 05/15/1935
[23:10:02] [DOC: 9258661] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[23:10:02] [DOC: 9258661] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[23:10:02] [DOC: 9258661] ✅ Patient date processing completed successfully
[23:10:02] ✅    ✅ Date processing completed
[23:10:02] 📊 Processed Patient Data
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8'}]
[23:10:02] 🔄 
🔄 Step 4: Extracting order data...
[23:10:05] ℹ️  Order extraction - MRN: 'MA210907053505'
[23:10:05] ℹ️  Order extraction - Sex: ''
[23:10:05] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[23:10:05] ℹ️  Order extraction - Payer Source: ''
[23:10:05] ✅ Order data extraction completed successfully
[23:10:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[23:10:05] ℹ️  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[23:10:05] ⚠️  Could not determine sex using any available method
[23:10:05] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[23:10:05] ✅ Patient name cross-validation successful
[23:10:05] ✅    ✅ Data merged successfully
[23:10:06] ✅    ✅ Order data extracted and validated
[23:10:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[23:10:06] [DOC: 9258661] ✅ Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[23:10:06] ✅    ✅ Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[23:10:06] 🔄 
🔄 Step 6: Pushing order to API...
[23:10:06] [DOC: 9258661] ℹ️  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[23:10:07] [DOC: 9258661] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14149"}
[23:10:07] ❌    ❌ Failed to push order
[23:10:07] 🔄 
🔄 Step 7: Writing to CSV...
[23:10:07] [DOC: 9258661] ℹ️  Calculated age: 90 from DOB: 05/15/1935
[23:10:07] [DOC: 9258661] ℹ️  Service Line extracted: 'Skilled Nursing'
[23:10:07] [DOC: 9258661] ℹ️  Payer Source extracted: ''
[23:10:07] [DOC: 9258661] ℹ️  Diagnosis codes being written:
[23:10:07] [DOC: 9258661] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[23:10:07] [DOC: 9258661] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[23:10:07] [DOC: 9258661] ℹ️    - Latest_Episode_Thirddiagnosis: 'H54.8'
[23:10:07] [DOC: 9258661] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[23:10:07] [DOC: 9258661] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[23:10:07] [DOC: 9258661] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[23:10:07] [DOC: 9258661] ✅ Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: Skilled Nursing | Payer:  | MRN: MA210907053505
[23:10:07] ✅    ✅ Document 9258661 processed and saved successfully
[23:10:07] 🔄 
🔄 Step 8: Saving API details...
[23:10:07] [DOC: 9258661] ℹ️  API push details saved for document 9258661
[23:10:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9258658                         ║
================================================================================
[23:10:07] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[23:10:07] ℹ️  Date: 04/24/2025
[23:10:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[23:10:09] [DOC: 9258658] ✅ Text extracted using pdfplumber (1147 chars)
[23:10:09] ✅    ✅ Text extracted using pdfplumber (1147 chars)
[23:10:09] 🔄 
🔄 Step 2: Extracting patient data...
[23:10:12] ℹ️  AI extracted raw sex value: ''
[23:10:12] ℹ️  AI extracted service line: 'Speech Therapy'
[23:10:12] ℹ️  AI extracted payer source: ''
[23:10:12] ℹ️  AI extracted diagnoses:
[23:10:12] ℹ️    - Diagnosis 1: 'E11.65'
[23:10:12] ℹ️    - Diagnosis 2: 'I10'
[23:10:12] ℹ️    - Diagnosis 3: 'H54.8'
[23:10:12] ℹ️    - Diagnosis 4: 'None'
[23:10:12] ℹ️    - Diagnosis 5: 'None'
[23:10:12] ℹ️    - Diagnosis 6: 'None'
[23:10:12] ℹ️  Final extracted MRN: 'MA210907053505'
[23:10:12] ℹ️  Final extracted Sex: ''
[23:10:12] ℹ️  Final extracted Service Line: 'Speech Therapy'
[23:10:12] ℹ️  Final extracted Payer Source: ''
[23:10:12] ✅ Patient data extraction completed successfully
[23:10:12] ✅    ✅ Patient data extracted successfully
[23:10:12] 📊 Patient Response
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[23:10:12] ✅    ✅ Patient identified: Rolande Morrell
[23:10:12] ✅    ✅ Patient name validation passed
[23:10:12] 🔄 
🔄 Step 3: Processing patient dates...
[23:10:12] [DOC: 9258658] ℹ️  DOB normalized: 05/15/1935
[23:10:12] [DOC: 9258658] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[23:10:12] [DOC: 9258658] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[23:10:12] [DOC: 9258658] ✅ Patient date processing completed successfully
[23:10:12] ✅    ✅ Date processing completed
[23:10:12] 📊 Processed Patient Data
     └─ patientFName: Rolande
     └─ patientLName: Morrell
     └─ dob: 05/15/1935
     └─ patientSex: 
     └─ medicalRecordNo: MA210907053505
     └─ billingProvider: SACHIN MASKEY MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Speech Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8'}]
[23:10:12] 🔄 
🔄 Step 4: Extracting order data...
[23:10:15] ℹ️  Order extraction - MRN: 'MA210907053505'
[23:10:15] ℹ️  Order extraction - Sex: ''
[23:10:15] ℹ️  Order extraction - Service Line: 'Speech Therapy'
[23:10:15] ℹ️  Order extraction - Payer Source: ''
[23:10:15] ✅ Order data extraction completed successfully
[23:10:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[23:10:15] ℹ️  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[23:10:15] ⚠️  Could not determine sex using any available method
[23:10:15] ℹ️  Service line consistent in both sources: 'Speech Therapy'
[23:10:15] ✅ Patient name cross-validation successful
[23:10:15] ✅    ✅ Data merged successfully
[23:10:16] ✅    ✅ Order data extracted and validated
[23:10:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[23:10:16] [DOC: 9258658] ✅ Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[23:10:16] ✅    ✅ Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[23:10:16] 🔄 
🔄 Step 6: Pushing order to API...
[23:10:16] [DOC: 9258658] ℹ️  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[23:10:17] [DOC: 9258658] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14151"}
[23:10:17] ❌    ❌ Failed to push order
[23:10:17] 🔄 
🔄 Step 7: Writing to CSV...
[23:10:17] [DOC: 9258658] ℹ️  Calculated age: 90 from DOB: 05/15/1935
[23:10:17] [DOC: 9258658] ℹ️  Service Line extracted: 'Speech Therapy'
[23:10:17] [DOC: 9258658] ℹ️  Payer Source extracted: ''
[23:10:17] [DOC: 9258658] ℹ️  Diagnosis codes being written:
[23:10:17] [DOC: 9258658] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.65'
[23:10:17] [DOC: 9258658] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[23:10:17] [DOC: 9258658] ℹ️    - Latest_Episode_Thirddiagnosis: 'H54.8'
[23:10:17] [DOC: 9258658] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[23:10:17] [DOC: 9258658] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[23:10:17] [DOC: 9258658] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[23:10:17] [DOC: 9258658] ✅ Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: Speech Therapy | Payer:  | MRN: MA210907053505
[23:10:17] ✅    ✅ Document 9258658 processed and saved successfully
[23:10:17] 🔄 
🔄 Step 8: Saving API details...
[23:10:17] [DOC: 9258658] ℹ️  API push details saved for document 9258658
[23:10:17] ✅    ✅ API details saved
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[23:10:17] ℹ️  Total Processed: 5
[23:10:17] ℹ️  CSV Success: 4
[23:10:17] ℹ️  CSV Errors: 1
[23:10:17] ℹ️  API Success: 0
[23:10:17] ℹ️  API Errors: 4
[23:10:17] ℹ️  CSV Success Rate: 80.0%
[23:10:17] ℹ️  API Success Rate: 0.0%
[23:10:17] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250606_230917.csv
[23:10:17] ℹ️  API Details File: api_outputs/api_push_details_20250606_230917.csv
================================================================================
║          ============================================================          ║
================================================================================
