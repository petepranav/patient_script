================================================================================
â•‘                            FINAL VERSION PROCESSOR                             â•‘
================================================================================
[23:09:17] â„¹ï¸  CSV Data Extraction & API Push Tool
[23:09:17] â„¹ï¸  
[23:09:17] â„¹ï¸  Features:
[23:09:17] â„¹ï¸  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[23:09:17] â„¹ï¸  - AI-powered patient and order data extraction
[23:09:17] â„¹ï¸  - Enhanced error handling and logging
[23:09:17] â„¹ï¸  - Full API integration (patient creation + order pushing)
[23:09:17] â„¹ï¸  - CSV output with comprehensive patient data
[23:09:17] â„¹ï¸  - Detailed API tracking with remarks for every document
[23:09:17] â„¹ï¸  - Complete audit trail of all processing attempts
[23:09:17] â„¹ï¸  
[23:09:17] â„¹ï¸  Starting CSV processing with API integration: hawthorn_fam.csv
[23:09:17] âœ… Created output CSV file: csv_outputs/extracted_patients_20250606_230917.csv
[23:09:17] âœ… Created API details CSV file: api_outputs/api_push_details_20250606_230917.csv
================================================================================
â•‘                        Processing Document ID: 9259497                         â•‘
================================================================================
[23:09:17] â„¹ï¸  Agency: Southcoast VNA â€“ Community Office (Fairhaven)
[23:09:17] â„¹ï¸  Date: 04/24/2025
[23:09:17] ğŸ”„ 
ğŸ”„ Step 1: Extracting text from PDF...
[23:09:20] [DOC: 9259497] âœ… Text extracted using pdfplumber (2612 chars)
[23:09:20] âœ…    âœ… Text extracted using pdfplumber (2612 chars)
[23:09:20] ğŸ”„ 
ğŸ”„ Step 2: Extracting patient data...
[23:09:24] â„¹ï¸  AI extracted raw sex value: 'M'
[23:09:24] â„¹ï¸  AI extracted service line: 'Physical Therapy'
[23:09:24] â„¹ï¸  AI extracted payer source: ''
[23:09:24] â„¹ï¸  AI extracted diagnoses:
[23:09:24] â„¹ï¸    - Diagnosis 1: 'None'
[23:09:24] â„¹ï¸    - Diagnosis 2: 'None'
[23:09:24] â„¹ï¸    - Diagnosis 3: 'None'
[23:09:24] â„¹ï¸    - Diagnosis 4: 'None'
[23:09:24] â„¹ï¸    - Diagnosis 5: 'None'
[23:09:24] â„¹ï¸    - Diagnosis 6: 'None'
[23:09:24] â„¹ï¸  Final extracted MRN: '2005206'
[23:09:24] â„¹ï¸  Final extracted Sex: 'MALE'
[23:09:24] â„¹ï¸  Final extracted Service Line: 'Physical Therapy'
[23:09:24] â„¹ï¸  Final extracted Payer Source: ''
[23:09:24] âœ… Patient data extraction completed successfully
[23:09:24] âœ…    âœ… Patient data extracted successfully
[23:09:24] ğŸ“Š Patient Response
     â””â”€ patientFName: Jose
     â””â”€ patientLName: Baptista
     â””â”€ dob: 07/02/1934
     â””â”€ patientSex: MALE
     â””â”€ medicalRecordNo: 2005206
     â””â”€ billingProvider: Sachin Maskey, MD
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     â””â”€ address: 200 Mill Road
     â””â”€ city: Fairhaven
     â””â”€ state: MA
     â””â”€ zip: 02719-5252
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 973-3200
     â””â”€ serviceLine: Physical Therapy
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[23:09:24] âœ…    âœ… Patient identified: Jose Baptista
[23:09:24] âœ…    âœ… Patient name validation passed
[23:09:24] ğŸ”„ 
ğŸ”„ Step 3: Processing patient dates...
[23:09:24] [DOC: 9259497] â„¹ï¸  DOB normalized: 07/02/1934
[23:09:24] [DOC: 9259497] âœ… Patient date processing completed successfully
[23:09:24] âœ…    âœ… Date processing completed
[23:09:24] ğŸ“Š Processed Patient Data
     â””â”€ patientFName: Jose
     â””â”€ patientLName: Baptista
     â””â”€ dob: 07/02/1934
     â””â”€ patientSex: MALE
     â””â”€ medicalRecordNo: 2005206
     â””â”€ billingProvider: Sachin Maskey, MD
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     â””â”€ address: 200 Mill Road
     â””â”€ city: Fairhaven
     â””â”€ state: MA
     â””â”€ zip: 02719-5252
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 973-3200
     â””â”€ serviceLine: Physical Therapy
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': ''}]
[23:09:24] ğŸ”„ 
ğŸ”„ Step 4: Extracting order data...
[23:09:27] â„¹ï¸  Order extraction - MRN: '2005206'
[23:09:27] â„¹ï¸  Order extraction - Sex: 'MALE'
[23:09:27] â„¹ï¸  Order extraction - Service Line: ''
[23:09:27] â„¹ï¸  Order extraction - Payer Source: ''
[23:09:27] âœ… Order data extraction completed successfully
[23:09:27] ğŸ”„ 
ğŸ”„ Step 4.5: Merging patient and order data...
[23:09:27] â„¹ï¸  Using MRN from patient data: '2005206' over '2005206'
[23:09:27] â„¹ï¸  Using service line from patient data: 'Physical Therapy'
[23:09:27] âœ… Patient name cross-validation successful
[23:09:27] âœ…    âœ… Data merged successfully
[23:09:28] âš ï¸     âŒ Skipping - missing episode start date
[23:09:28] [DOC: 9259497] â„¹ï¸  API push details saved for document 9259497
================================================================================
â•‘                        Processing Document ID: 9259495                         â•‘
================================================================================
[23:09:28] â„¹ï¸  Agency: Southcoast VNA â€“ Community Office (Fairhaven)
[23:09:28] â„¹ï¸  Date: 04/24/2025
[23:09:28] ğŸ”„ 
ğŸ”„ Step 1: Extracting text from PDF...
[23:09:33] [DOC: 9259495] âœ… Text extracted using pdfplumber (15814 chars)
[23:09:33] âœ…    âœ… Text extracted using pdfplumber (15814 chars)
[23:09:33] ğŸ”„ 
ğŸ”„ Step 2: Extracting patient data...
[23:09:37] â„¹ï¸  AI extracted raw sex value: 'M'
[23:09:37] â„¹ï¸  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[23:09:37] â„¹ï¸  AI extracted payer source: ''
[23:09:37] â„¹ï¸  AI extracted diagnoses:
[23:09:37] â„¹ï¸    - Diagnosis 1: 'G20.A1'
[23:09:37] â„¹ï¸    - Diagnosis 2: 'I88.0'
[23:09:37] â„¹ï¸    - Diagnosis 3: 'R53.1'
[23:09:37] â„¹ï¸    - Diagnosis 4: 'I10'
[23:09:37] â„¹ï¸    - Diagnosis 5: 'N13.30'
[23:09:37] â„¹ï¸    - Diagnosis 6: 'N40.1'
[23:09:37] â„¹ï¸  Final extracted MRN: '2211831'
[23:09:37] â„¹ï¸  Final extracted Sex: 'MALE'
[23:09:37] â„¹ï¸  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[23:09:37] â„¹ï¸  Final extracted Payer Source: ''
[23:09:37] âœ… Patient data extraction completed successfully
[23:09:37] âœ…    âœ… Patient data extracted successfully
[23:09:37] ğŸ“Š Patient Response
     â””â”€ patientFName: Viriato
     â””â”€ patientLName: Bala
     â””â”€ dob: 11/12/1937
     â””â”€ patientSex: MALE
     â””â”€ medicalRecordNo: 2211831
     â””â”€ billingProvider: Stephen C. Mackler, MD
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     â””â”€ address: 200 Mill Road
     â””â”€ city: Fairhaven
     â””â”€ state: MA
     â””â”€ zip: 02719-5252
     â””â”€ email: 
     â””â”€ phoneNumber: 508-973-3200
     â””â”€ serviceLine: Physical Therapy, Occupational Therapy
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '02/10/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I88.0', 'thirdDiagnosis': 'R53.1', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'N13.30', 'sixthDiagnosis': 'N40.1'}]
[23:09:37] âœ…    âœ… Patient identified: Viriato Bala
[23:09:37] âœ…    âœ… Patient name validation passed
[23:09:37] ğŸ”„ 
ğŸ”„ Step 3: Processing patient dates...
[23:09:37] [DOC: 9259495] â„¹ï¸  DOB normalized: 11/12/1937
[23:09:37] [DOC: 9259495] â„¹ï¸  Episode startOfCare normalized: 02/10/2025
[23:09:37] [DOC: 9259495] â„¹ï¸  Episode startOfEpisode normalized: 04/11/2025
[23:09:37] [DOC: 9259495] â„¹ï¸  Episode endOfEpisode normalized: 06/09/2025
[23:09:37] [DOC: 9259495] âœ… Patient date processing completed successfully
[23:09:37] âœ…    âœ… Date processing completed
[23:09:37] ğŸ“Š Processed Patient Data
     â””â”€ patientFName: Viriato
     â””â”€ patientLName: Bala
     â””â”€ dob: 11/12/1937
     â””â”€ patientSex: MALE
     â””â”€ medicalRecordNo: 2211831
     â””â”€ billingProvider: Stephen C. Mackler, MD
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     â””â”€ address: 200 Mill Road
     â””â”€ city: Fairhaven
     â””â”€ state: MA
     â””â”€ zip: 02719-5252
     â””â”€ email: 
     â””â”€ phoneNumber: 508-973-3200
     â””â”€ serviceLine: Physical Therapy, Occupational Therapy
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '02/10/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I88.0', 'thirdDiagnosis': 'R53.1', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'N13.30', 'sixthDiagnosis': 'N40.1'}]
[23:09:37] ğŸ”„ 
ğŸ”„ Step 4: Extracting order data...
[23:09:40] â„¹ï¸  Order extraction - MRN: '2211831'
[23:09:40] â„¹ï¸  Order extraction - Sex: 'MALE'
[23:09:40] â„¹ï¸  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy'
[23:09:40] â„¹ï¸  Order extraction - Payer Source: ''
[23:09:40] âœ… Order data extraction completed successfully
[23:09:40] ğŸ”„ 
ğŸ”„ Step 4.5: Merging patient and order data...
[23:09:40] â„¹ï¸  Using MRN from patient data: '2211831' over '2211831'
[23:09:40] â„¹ï¸  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy'
[23:09:40] âœ… Patient name cross-validation successful
[23:09:40] âœ…    âœ… Data merged successfully
[23:09:41] âœ…    âœ… Order data extracted and validated
[23:09:41] ğŸ”„ 
ğŸ”„ Step 5: Checking/Creating patient...
[23:09:41] [DOC: 9259495] âœ… Patient found in local cache: Viriato Bala, ID: b70c4038-8eef-4f28-b15b-74771b9982ae
[23:09:41] âœ…    âœ… Existing patient found with ID: b70c4038-8eef-4f28-b15b-74771b9982ae
[23:09:41] ğŸ”„ 
ğŸ”„ Step 6: Pushing order to API...
[23:09:41] [DOC: 9259495] â„¹ï¸  Pushing order via API for patient ID: b70c4038-8eef-4f28-b15b-74771b9982ae
[23:09:42] [DOC: 9259495] âŒ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12982"}
[23:09:42] âŒ    âŒ Failed to push order
[23:09:42] ğŸ”„ 
ğŸ”„ Step 7: Writing to CSV...
[23:09:42] [DOC: 9259495] â„¹ï¸  Calculated age: 87 from DOB: 11/12/1937
[23:09:42] [DOC: 9259495] â„¹ï¸  Service Line extracted: 'Physical Therapy, Occupational Therapy'
[23:09:42] [DOC: 9259495] â„¹ï¸  Payer Source extracted: ''
[23:09:42] [DOC: 9259495] â„¹ï¸  Diagnosis codes being written:
[23:09:42] [DOC: 9259495] â„¹ï¸    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[23:09:42] [DOC: 9259495] â„¹ï¸    - Latest_Episode_Seconddiagnosis: 'I88.0'
[23:09:42] [DOC: 9259495] â„¹ï¸    - Latest_Episode_Thirddiagnosis: 'R53.1'
[23:09:42] [DOC: 9259495] â„¹ï¸    - Latest_Episode_Fourthdiagnosis: 'I10'
[23:09:42] [DOC: 9259495] â„¹ï¸    - Latest_Episode_Fifthdiagnosis: 'N13.30'
[23:09:42] [DOC: 9259495] â„¹ï¸    - Latest_Episode_Sixthdiagnosis: 'N40.1'
[23:09:42] [DOC: 9259495] âœ… Patient data written to CSV: Viriato Bala | Sex: MALE | Age: 87 | Service: Physical Therapy, Occupational Therapy | Payer:  | MRN: 2211831
[23:09:42] âœ…    âœ… Document 9259495 processed and saved successfully
[23:09:42] ğŸ”„ 
ğŸ”„ Step 8: Saving API details...
[23:09:42] [DOC: 9259495] â„¹ï¸  API push details saved for document 9259495
[23:09:42] âœ…    âœ… API details saved
================================================================================
â•‘                        Processing Document ID: 9258663                         â•‘
================================================================================
[23:09:42] â„¹ï¸  Agency: Nightingale Visiting Nurses-Taunton
[23:09:42] â„¹ï¸  Date: 04/24/2025
[23:09:42] ğŸ”„ 
ğŸ”„ Step 1: Extracting text from PDF...
[23:09:48] [DOC: 9258663] âœ… Text extracted using pdfplumber (12349 chars)
[23:09:48] âœ…    âœ… Text extracted using pdfplumber (12349 chars)
[23:09:48] ğŸ”„ 
ğŸ”„ Step 2: Extracting patient data...
[23:09:51] â„¹ï¸  AI extracted raw sex value: 'F'
[23:09:51] â„¹ï¸  AI extracted service line: 'OT'
[23:09:51] â„¹ï¸  AI extracted payer source: ''
[23:09:51] â„¹ï¸  AI extracted diagnoses:
[23:09:51] â„¹ï¸    - Diagnosis 1: 'J44.1'
[23:09:51] â„¹ï¸    - Diagnosis 2: 'M62.81'
[23:09:51] â„¹ï¸    - Diagnosis 3: ''
[23:09:51] â„¹ï¸    - Diagnosis 4: ''
[23:09:51] â„¹ï¸    - Diagnosis 5: ''
[23:09:51] â„¹ï¸    - Diagnosis 6: ''
[23:09:51] â„¹ï¸  Final extracted MRN: 'MA250130025704'
[23:09:51] â„¹ï¸  Final extracted Sex: 'FEMALE'
[23:09:51] â„¹ï¸  Final extracted Service Line: 'OT'
[23:09:51] â„¹ï¸  Final extracted Payer Source: ''
[23:09:51] âœ… Patient data extraction completed successfully
[23:09:51] âœ…    âœ… Patient data extracted successfully
[23:09:51] ğŸ“Š Patient Response
     â””â”€ patientFName: Theresa
     â””â”€ patientLName: Racine
     â””â”€ dob: 02/10/1957
     â””â”€ patientSex: FEMALE
     â””â”€ medicalRecordNo: MA250130025704
     â””â”€ billingProvider: Nightingale Visiting Nurses
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Nightingale Visiting Nurses
     â””â”€ address: 125 County ST
     â””â”€ city: Taunton
     â””â”€ state: MA
     â””â”€ zip: 02780
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 967-0761
     â””â”€ serviceLine: OT
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[23:09:51] âœ…    âœ… Patient identified: Theresa Racine
[23:09:51] âœ…    âœ… Patient name validation passed
[23:09:51] ğŸ”„ 
ğŸ”„ Step 3: Processing patient dates...
[23:09:51] [DOC: 9258663] â„¹ï¸  DOB normalized: 02/10/1957
[23:09:51] [DOC: 9258663] â„¹ï¸  Episode startOfEpisode normalized: 03/05/2025
[23:09:51] [DOC: 9258663] âœ… Patient date processing completed successfully
[23:09:51] âœ…    âœ… Date processing completed
[23:09:51] ğŸ“Š Processed Patient Data
     â””â”€ patientFName: Theresa
     â””â”€ patientLName: Racine
     â””â”€ dob: 02/10/1957
     â””â”€ patientSex: FEMALE
     â””â”€ medicalRecordNo: MA250130025704
     â””â”€ billingProvider: Nightingale Visiting Nurses
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Nightingale Visiting Nurses
     â””â”€ address: 125 County ST
     â””â”€ city: Taunton
     â””â”€ state: MA
     â””â”€ zip: 02780
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 967-0761
     â””â”€ serviceLine: OT
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[23:09:51] ğŸ”„ 
ğŸ”„ Step 4: Extracting order data...
[23:09:54] â„¹ï¸  Order extraction - MRN: 'MA250130025704'
[23:09:54] â„¹ï¸  Order extraction - Sex: 'FEMALE'
[23:09:54] â„¹ï¸  Order extraction - Service Line: 'OT'
[23:09:54] â„¹ï¸  Order extraction - Payer Source: ''
[23:09:54] âœ… Order data extraction completed successfully
[23:09:54] ğŸ”„ 
ğŸ”„ Step 4.5: Merging patient and order data...
[23:09:54] â„¹ï¸  Using MRN from patient data: 'MA250130025704' over 'MA250130025704'
[23:09:54] â„¹ï¸  Service line consistent in both sources: 'OT'
[23:09:54] âœ… Patient name cross-validation successful
[23:09:54] âœ…    âœ… Data merged successfully
[23:09:55] âœ…    âœ… Order data extracted and validated
[23:09:55] ğŸ”„ 
ğŸ”„ Step 5: Checking/Creating patient...
[23:09:55] [DOC: 9258663] âœ… Patient found in local cache: Theresa Racine, ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[23:09:55] âœ…    âœ… Existing patient found with ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[23:09:55] ğŸ”„ 
ğŸ”„ Step 6: Pushing order to API...
[23:09:55] [DOC: 9258663] â„¹ï¸  Pushing order via API for patient ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[23:09:56] [DOC: 9258663] âŒ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[23:09:56] âŒ    âŒ Failed to push order
[23:09:56] ğŸ”„ 
ğŸ”„ Step 7: Writing to CSV...
[23:09:56] [DOC: 9258663] â„¹ï¸  Calculated age: 68 from DOB: 02/10/1957
[23:09:56] [DOC: 9258663] â„¹ï¸  Service Line extracted: 'OT'
[23:09:56] [DOC: 9258663] â„¹ï¸  Payer Source extracted: ''
[23:09:56] [DOC: 9258663] â„¹ï¸  Diagnosis codes being written:
[23:09:56] [DOC: 9258663] â„¹ï¸    - Latest_Episode_Firstdiagnosis: 'J44.1'
[23:09:56] [DOC: 9258663] â„¹ï¸    - Latest_Episode_Seconddiagnosis: 'M62.81'
[23:09:56] [DOC: 9258663] â„¹ï¸    - Latest_Episode_Thirddiagnosis: ''
[23:09:56] [DOC: 9258663] â„¹ï¸    - Latest_Episode_Fourthdiagnosis: ''
[23:09:56] [DOC: 9258663] â„¹ï¸    - Latest_Episode_Fifthdiagnosis: ''
[23:09:56] [DOC: 9258663] â„¹ï¸    - Latest_Episode_Sixthdiagnosis: ''
[23:09:56] [DOC: 9258663] âœ… Patient data written to CSV: Theresa Racine | Sex: FEMALE | Age: 68 | Service: OT | Payer:  | MRN: MA250130025704
[23:09:56] âœ…    âœ… Document 9258663 processed and saved successfully
[23:09:56] ğŸ”„ 
ğŸ”„ Step 8: Saving API details...
[23:09:56] [DOC: 9258663] â„¹ï¸  API push details saved for document 9258663
[23:09:56] âœ…    âœ… API details saved
================================================================================
â•‘                        Processing Document ID: 9258661                         â•‘
================================================================================
[23:09:56] â„¹ï¸  Agency: Nightingale Visiting Nurses-Taunton
[23:09:56] â„¹ï¸  Date: 04/24/2025
[23:09:56] ğŸ”„ 
ğŸ”„ Step 1: Extracting text from PDF...
[23:09:59] [DOC: 9258661] âœ… Text extracted using pdfplumber (1686 chars)
[23:09:59] âœ…    âœ… Text extracted using pdfplumber (1686 chars)
[23:09:59] ğŸ”„ 
ğŸ”„ Step 2: Extracting patient data...
[23:10:02] â„¹ï¸  AI extracted raw sex value: ''
[23:10:02] â„¹ï¸  AI extracted service line: 'Skilled Nursing'
[23:10:02] â„¹ï¸  AI extracted payer source: ''
[23:10:02] â„¹ï¸  AI extracted diagnoses:
[23:10:02] â„¹ï¸    - Diagnosis 1: 'E11.65'
[23:10:02] â„¹ï¸    - Diagnosis 2: 'I10'
[23:10:02] â„¹ï¸    - Diagnosis 3: 'H54.8'
[23:10:02] â„¹ï¸    - Diagnosis 4: 'None'
[23:10:02] â„¹ï¸    - Diagnosis 5: 'None'
[23:10:02] â„¹ï¸    - Diagnosis 6: 'None'
[23:10:02] â„¹ï¸  Final extracted MRN: 'MA210907053505'
[23:10:02] â„¹ï¸  Final extracted Sex: ''
[23:10:02] â„¹ï¸  Final extracted Service Line: 'Skilled Nursing'
[23:10:02] â„¹ï¸  Final extracted Payer Source: ''
[23:10:02] âœ… Patient data extraction completed successfully
[23:10:02] âœ…    âœ… Patient data extracted successfully
[23:10:02] ğŸ“Š Patient Response
     â””â”€ patientFName: Rolande
     â””â”€ patientLName: Morrell
     â””â”€ dob: 05/15/1935
     â””â”€ patientSex: 
     â””â”€ medicalRecordNo: MA210907053505
     â””â”€ billingProvider: SACHIN MASKEY MD
     â””â”€ npi: 1134386972
     â””â”€ physicianNPI: 1134386972
     â””â”€ nameOfAgency: Nightingale Visiting Nurses
     â””â”€ address: 125 County ST
     â””â”€ city: Taunton
     â””â”€ state: MA
     â””â”€ zip: 02780
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 967-0761
     â””â”€ serviceLine: Skilled Nursing
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[23:10:02] âœ…    âœ… Patient identified: Rolande Morrell
[23:10:02] âœ…    âœ… Patient name validation passed
[23:10:02] ğŸ”„ 
ğŸ”„ Step 3: Processing patient dates...
[23:10:02] [DOC: 9258661] â„¹ï¸  DOB normalized: 05/15/1935
[23:10:02] [DOC: 9258661] â„¹ï¸  Episode startOfEpisode normalized: 03/14/2025
[23:10:02] [DOC: 9258661] â„¹ï¸  Episode endOfEpisode normalized: 05/12/2025
[23:10:02] [DOC: 9258661] âœ… Patient date processing completed successfully
[23:10:02] âœ…    âœ… Date processing completed
[23:10:02] ğŸ“Š Processed Patient Data
     â””â”€ patientFName: Rolande
     â””â”€ patientLName: Morrell
     â””â”€ dob: 05/15/1935
     â””â”€ patientSex: 
     â””â”€ medicalRecordNo: MA210907053505
     â””â”€ billingProvider: SACHIN MASKEY MD
     â””â”€ npi: 1134386972
     â””â”€ physicianNPI: 1134386972
     â””â”€ nameOfAgency: Nightingale Visiting Nurses
     â””â”€ address: 125 County ST
     â””â”€ city: Taunton
     â””â”€ state: MA
     â””â”€ zip: 02780
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 967-0761
     â””â”€ serviceLine: Skilled Nursing
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8'}]
[23:10:02] ğŸ”„ 
ğŸ”„ Step 4: Extracting order data...
[23:10:05] â„¹ï¸  Order extraction - MRN: 'MA210907053505'
[23:10:05] â„¹ï¸  Order extraction - Sex: ''
[23:10:05] â„¹ï¸  Order extraction - Service Line: 'Skilled Nursing'
[23:10:05] â„¹ï¸  Order extraction - Payer Source: ''
[23:10:05] âœ… Order data extraction completed successfully
[23:10:05] ğŸ”„ 
ğŸ”„ Step 4.5: Merging patient and order data...
[23:10:05] â„¹ï¸  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[23:10:05] âš ï¸  Could not determine sex using any available method
[23:10:05] â„¹ï¸  Service line consistent in both sources: 'Skilled Nursing'
[23:10:05] âœ… Patient name cross-validation successful
[23:10:05] âœ…    âœ… Data merged successfully
[23:10:06] âœ…    âœ… Order data extracted and validated
[23:10:06] ğŸ”„ 
ğŸ”„ Step 5: Checking/Creating patient...
[23:10:06] [DOC: 9258661] âœ… Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[23:10:06] âœ…    âœ… Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[23:10:06] ğŸ”„ 
ğŸ”„ Step 6: Pushing order to API...
[23:10:06] [DOC: 9258661] â„¹ï¸  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[23:10:07] [DOC: 9258661] âŒ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14149"}
[23:10:07] âŒ    âŒ Failed to push order
[23:10:07] ğŸ”„ 
ğŸ”„ Step 7: Writing to CSV...
[23:10:07] [DOC: 9258661] â„¹ï¸  Calculated age: 90 from DOB: 05/15/1935
[23:10:07] [DOC: 9258661] â„¹ï¸  Service Line extracted: 'Skilled Nursing'
[23:10:07] [DOC: 9258661] â„¹ï¸  Payer Source extracted: ''
[23:10:07] [DOC: 9258661] â„¹ï¸  Diagnosis codes being written:
[23:10:07] [DOC: 9258661] â„¹ï¸    - Latest_Episode_Firstdiagnosis: 'E11.65'
[23:10:07] [DOC: 9258661] â„¹ï¸    - Latest_Episode_Seconddiagnosis: 'I10'
[23:10:07] [DOC: 9258661] â„¹ï¸    - Latest_Episode_Thirddiagnosis: 'H54.8'
[23:10:07] [DOC: 9258661] â„¹ï¸    - Latest_Episode_Fourthdiagnosis: ''
[23:10:07] [DOC: 9258661] â„¹ï¸    - Latest_Episode_Fifthdiagnosis: ''
[23:10:07] [DOC: 9258661] â„¹ï¸    - Latest_Episode_Sixthdiagnosis: ''
[23:10:07] [DOC: 9258661] âœ… Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: Skilled Nursing | Payer:  | MRN: MA210907053505
[23:10:07] âœ…    âœ… Document 9258661 processed and saved successfully
[23:10:07] ğŸ”„ 
ğŸ”„ Step 8: Saving API details...
[23:10:07] [DOC: 9258661] â„¹ï¸  API push details saved for document 9258661
[23:10:07] âœ…    âœ… API details saved
================================================================================
â•‘                        Processing Document ID: 9258658                         â•‘
================================================================================
[23:10:07] â„¹ï¸  Agency: Nightingale Visiting Nurses-Taunton
[23:10:07] â„¹ï¸  Date: 04/24/2025
[23:10:07] ğŸ”„ 
ğŸ”„ Step 1: Extracting text from PDF...
[23:10:09] [DOC: 9258658] âœ… Text extracted using pdfplumber (1147 chars)
[23:10:09] âœ…    âœ… Text extracted using pdfplumber (1147 chars)
[23:10:09] ğŸ”„ 
ğŸ”„ Step 2: Extracting patient data...
[23:10:12] â„¹ï¸  AI extracted raw sex value: ''
[23:10:12] â„¹ï¸  AI extracted service line: 'Speech Therapy'
[23:10:12] â„¹ï¸  AI extracted payer source: ''
[23:10:12] â„¹ï¸  AI extracted diagnoses:
[23:10:12] â„¹ï¸    - Diagnosis 1: 'E11.65'
[23:10:12] â„¹ï¸    - Diagnosis 2: 'I10'
[23:10:12] â„¹ï¸    - Diagnosis 3: 'H54.8'
[23:10:12] â„¹ï¸    - Diagnosis 4: 'None'
[23:10:12] â„¹ï¸    - Diagnosis 5: 'None'
[23:10:12] â„¹ï¸    - Diagnosis 6: 'None'
[23:10:12] â„¹ï¸  Final extracted MRN: 'MA210907053505'
[23:10:12] â„¹ï¸  Final extracted Sex: ''
[23:10:12] â„¹ï¸  Final extracted Service Line: 'Speech Therapy'
[23:10:12] â„¹ï¸  Final extracted Payer Source: ''
[23:10:12] âœ… Patient data extraction completed successfully
[23:10:12] âœ…    âœ… Patient data extracted successfully
[23:10:12] ğŸ“Š Patient Response
     â””â”€ patientFName: Rolande
     â””â”€ patientLName: Morrell
     â””â”€ dob: 05/15/1935
     â””â”€ patientSex: 
     â””â”€ medicalRecordNo: MA210907053505
     â””â”€ billingProvider: SACHIN MASKEY MD
     â””â”€ npi: 1134386972
     â””â”€ physicianNPI: 1134386972
     â””â”€ nameOfAgency: Nightingale Visiting Nurses
     â””â”€ address: 125 County ST
     â””â”€ city: Taunton
     â””â”€ state: MA
     â””â”€ zip: 02780
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 967-0761
     â””â”€ serviceLine: Speech Therapy
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[23:10:12] âœ…    âœ… Patient identified: Rolande Morrell
[23:10:12] âœ…    âœ… Patient name validation passed
[23:10:12] ğŸ”„ 
ğŸ”„ Step 3: Processing patient dates...
[23:10:12] [DOC: 9258658] â„¹ï¸  DOB normalized: 05/15/1935
[23:10:12] [DOC: 9258658] â„¹ï¸  Episode startOfEpisode normalized: 03/14/2025
[23:10:12] [DOC: 9258658] â„¹ï¸  Episode endOfEpisode normalized: 05/12/2025
[23:10:12] [DOC: 9258658] âœ… Patient date processing completed successfully
[23:10:12] âœ…    âœ… Date processing completed
[23:10:12] ğŸ“Š Processed Patient Data
     â””â”€ patientFName: Rolande
     â””â”€ patientLName: Morrell
     â””â”€ dob: 05/15/1935
     â””â”€ patientSex: 
     â””â”€ medicalRecordNo: MA210907053505
     â””â”€ billingProvider: SACHIN MASKEY MD
     â””â”€ npi: 1134386972
     â””â”€ physicianNPI: 1134386972
     â””â”€ nameOfAgency: Nightingale Visiting Nurses
     â””â”€ address: 125 County ST
     â””â”€ city: Taunton
     â””â”€ state: MA
     â””â”€ zip: 02780
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 967-0761
     â””â”€ serviceLine: Speech Therapy
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8'}]
[23:10:12] ğŸ”„ 
ğŸ”„ Step 4: Extracting order data...
[23:10:15] â„¹ï¸  Order extraction - MRN: 'MA210907053505'
[23:10:15] â„¹ï¸  Order extraction - Sex: ''
[23:10:15] â„¹ï¸  Order extraction - Service Line: 'Speech Therapy'
[23:10:15] â„¹ï¸  Order extraction - Payer Source: ''
[23:10:15] âœ… Order data extraction completed successfully
[23:10:15] ğŸ”„ 
ğŸ”„ Step 4.5: Merging patient and order data...
[23:10:15] â„¹ï¸  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[23:10:15] âš ï¸  Could not determine sex using any available method
[23:10:15] â„¹ï¸  Service line consistent in both sources: 'Speech Therapy'
[23:10:15] âœ… Patient name cross-validation successful
[23:10:15] âœ…    âœ… Data merged successfully
[23:10:16] âœ…    âœ… Order data extracted and validated
[23:10:16] ğŸ”„ 
ğŸ”„ Step 5: Checking/Creating patient...
[23:10:16] [DOC: 9258658] âœ… Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[23:10:16] âœ…    âœ… Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[23:10:16] ğŸ”„ 
ğŸ”„ Step 6: Pushing order to API...
[23:10:16] [DOC: 9258658] â„¹ï¸  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[23:10:17] [DOC: 9258658] âŒ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14151"}
[23:10:17] âŒ    âŒ Failed to push order
[23:10:17] ğŸ”„ 
ğŸ”„ Step 7: Writing to CSV...
[23:10:17] [DOC: 9258658] â„¹ï¸  Calculated age: 90 from DOB: 05/15/1935
[23:10:17] [DOC: 9258658] â„¹ï¸  Service Line extracted: 'Speech Therapy'
[23:10:17] [DOC: 9258658] â„¹ï¸  Payer Source extracted: ''
[23:10:17] [DOC: 9258658] â„¹ï¸  Diagnosis codes being written:
[23:10:17] [DOC: 9258658] â„¹ï¸    - Latest_Episode_Firstdiagnosis: 'E11.65'
[23:10:17] [DOC: 9258658] â„¹ï¸    - Latest_Episode_Seconddiagnosis: 'I10'
[23:10:17] [DOC: 9258658] â„¹ï¸    - Latest_Episode_Thirddiagnosis: 'H54.8'
[23:10:17] [DOC: 9258658] â„¹ï¸    - Latest_Episode_Fourthdiagnosis: ''
[23:10:17] [DOC: 9258658] â„¹ï¸    - Latest_Episode_Fifthdiagnosis: ''
[23:10:17] [DOC: 9258658] â„¹ï¸    - Latest_Episode_Sixthdiagnosis: ''
[23:10:17] [DOC: 9258658] âœ… Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: Speech Therapy | Payer:  | MRN: MA210907053505
[23:10:17] âœ…    âœ… Document 9258658 processed and saved successfully
[23:10:17] ğŸ”„ 
ğŸ”„ Step 8: Saving API details...
[23:10:17] [DOC: 9258658] â„¹ï¸  API push details saved for document 9258658
[23:10:17] âœ…    âœ… API details saved
================================================================================
â•‘                               PROCESSING SUMMARY                               â•‘
================================================================================
[23:10:17] â„¹ï¸  Total Processed: 5
[23:10:17] â„¹ï¸  CSV Success: 4
[23:10:17] â„¹ï¸  CSV Errors: 1
[23:10:17] â„¹ï¸  API Success: 0
[23:10:17] â„¹ï¸  API Errors: 4
[23:10:17] â„¹ï¸  CSV Success Rate: 80.0%
[23:10:17] â„¹ï¸  API Success Rate: 0.0%
[23:10:17] â„¹ï¸  Output CSV File: csv_outputs/extracted_patients_20250606_230917.csv
[23:10:17] â„¹ï¸  API Details File: api_outputs/api_push_details_20250606_230917.csv
================================================================================
â•‘          ============================================================          â•‘
================================================================================
