================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[13:16:34] ℹ️  CSV Data Extraction & API Push Tool
[13:16:34] ℹ️  
[13:16:34] ℹ️  Features:
[13:16:34] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[13:16:34] ℹ️  - AI-powered patient and order data extraction
[13:16:34] ℹ️  - Enhanced error handling and logging
[13:16:34] ℹ️  - Full API integration (patient creation + order pushing)
[13:16:34] ℹ️  - CSV output with comprehensive patient data
[13:16:34] ℹ️  - Detailed API tracking with remarks for every document
[13:16:34] ℹ️  - Complete audit trail of all processing attempts
[13:16:34] ℹ️  
[13:16:34] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[13:16:34] ✅ Created output CSV file: csv_outputs/extracted_patients_20250607_131634.csv
[13:16:34] ✅ Created API details CSV file: api_outputs/api_push_details_20250607_131634.csv
================================================================================
║                        Processing Document ID: 9316977                         ║
================================================================================
[13:16:34] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[13:16:34] ℹ️  Date: 05/29/2025
[13:16:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:16:38] [DOC: 9316977] ✅ Text extracted using pdfplumber (1421 chars)
[13:16:38] ✅    ✅ Text extracted using pdfplumber (1421 chars)
[13:16:38] 🔄 
🔄 Step 2: Extracting patient data...
[13:16:42] ℹ️  AI extracted raw sex value: 'F'
[13:16:42] ℹ️  AI extracted service line: 'HHA'
[13:16:42] ℹ️  AI extracted payer source: 'Medicaid/MA'
[13:16:42] ℹ️  AI extracted diagnoses:
[13:16:42] ℹ️    - Diagnosis 1: ''
[13:16:42] ℹ️    - Diagnosis 2: ''
[13:16:42] ℹ️    - Diagnosis 3: ''
[13:16:42] ℹ️    - Diagnosis 4: ''
[13:16:42] ℹ️    - Diagnosis 5: ''
[13:16:42] ℹ️    - Diagnosis 6: ''
[13:16:42] ℹ️  Final extracted MRN: '554005'
[13:16:42] ℹ️  Final extracted Sex: 'FEMALE'
[13:16:42] ℹ️  Final extracted Service Line: 'HHA'
[13:16:42] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[13:16:42] ✅ Patient data extraction completed successfully
[13:16:42] ✅    ✅ Patient data extracted successfully
[13:16:42] 📊 Patient Response
     └─ patientFName: Yomayra
     └─ patientLName: Velez-Morales
     └─ dob: 10/26/1975
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 554005
     └─ billingProvider: Robert J Caldas, MD
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '06/04/2024', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:16:42] ✅    ✅ Patient identified: Yomayra Velez-Morales
[13:16:42] ✅    ✅ Patient name validation passed
[13:16:42] 🔄 
🔄 Step 3: Processing patient dates...
[13:16:42] [DOC: 9316977] ℹ️  DOB normalized: 10/26/1975
[13:16:42] [DOC: 9316977] ℹ️  Episode startOfCare normalized: 06/04/2024
[13:16:42] [DOC: 9316977] ℹ️  Episode startOfEpisode normalized: 03/31/2025
[13:16:42] [DOC: 9316977] ℹ️  Episode endOfEpisode normalized: 05/29/2025
[13:16:42] [DOC: 9316977] ✅ Patient date processing completed successfully
[13:16:42] ✅    ✅ Date processing completed
[13:16:42] 📊 Processed Patient Data
     └─ patientFName: Yomayra
     └─ patientLName: Velez-Morales
     └─ dob: 10/26/1975
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 554005
     └─ billingProvider: Robert J Caldas, MD
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: HHA
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '06/04/2024', 'startOfEpisode': '03/31/2025', 'endOfEpisode': '05/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:16:42] 🔄 
🔄 Step 4: Extracting order data...
[13:16:45] ℹ️  Order extraction - MRN: '554005'
[13:16:45] ℹ️  Order extraction - Sex: 'FEMALE'
[13:16:45] ℹ️  Order extraction - Service Line: 'HHA'
[13:16:45] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[13:16:45] ✅ Order data extraction completed successfully
[13:16:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:16:45] ℹ️  Using MRN from patient data: '554005' over '554005'
[13:16:45] ℹ️  Service line consistent in both sources: 'HHA'
[13:16:45] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[13:16:45] ✅ Patient name cross-validation successful
[13:16:45] ✅    ✅ Data merged successfully
[13:16:46] ✅    ✅ Order data extracted and validated
[13:16:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:17:03] [DOC: 9316977] ✅ Patient exists in API: Yomayra Velez-Morales, ID: e98d4286-e41f-4b12-99e1-b508f6e5aa92
[13:17:03] ✅    ✅ Existing patient found with ID: e98d4286-e41f-4b12-99e1-b508f6e5aa92
[13:17:03] 🔄 
🔄 Step 6: Pushing order to API...
[13:17:03] [DOC: 9316977] ℹ️  Pushing order via API for patient ID: e98d4286-e41f-4b12-99e1-b508f6e5aa92
[13:17:04] [DOC: 9316977] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:17:04] ❌    ❌ Failed to push order
[13:17:04] 🔄 
🔄 Step 7: Writing to CSV...
[13:17:04] [DOC: 9316977] ℹ️  Calculated age: 49 from DOB: 10/26/1975
[13:17:04] [DOC: 9316977] ℹ️  Service Line extracted: 'HHA'
[13:17:04] [DOC: 9316977] ℹ️  Payer Source extracted: 'Medicaid/MA'
[13:17:04] [DOC: 9316977] ℹ️  Diagnosis codes being written:
[13:17:04] [DOC: 9316977] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:17:04] [DOC: 9316977] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:17:04] [DOC: 9316977] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:17:04] [DOC: 9316977] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:17:04] [DOC: 9316977] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:17:04] [DOC: 9316977] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:17:04] [DOC: 9316977] ✅ Patient data written to CSV: Yomayra Velez-Morales | Sex: FEMALE | Age: 49 | Service: HHA | Payer: Medicaid/MA | MRN: 554005
[13:17:04] ✅    ✅ Document 9316977 processed and saved successfully
[13:17:04] 🔄 
🔄 Step 8: Saving API details...
[13:17:04] [DOC: 9316977] ℹ️  API push details saved for document 9316977
[13:17:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9316853                         ║
================================================================================
[13:17:04] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:17:04] ℹ️  Date: 05/29/2025
[13:17:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:17:06] [DOC: 9316853] ✅ Text extracted using pdfplumber (1441 chars)
[13:17:06] ✅    ✅ Text extracted using pdfplumber (1429 chars)
[13:17:06] 🔄 
🔄 Step 2: Extracting patient data...
[13:17:09] ℹ️  AI extracted raw sex value: ''
[13:17:09] ℹ️  AI extracted service line: 'Occupational Therapy'
[13:17:09] ℹ️  AI extracted payer source: ''
[13:17:09] ℹ️  AI extracted diagnoses:
[13:17:09] ℹ️    - Diagnosis 1: 'A41.51'
[13:17:09] ℹ️    - Diagnosis 2: 'N39.0'
[13:17:09] ℹ️    - Diagnosis 3: 'G93.41'
[13:17:09] ℹ️    - Diagnosis 4: ''
[13:17:09] ℹ️    - Diagnosis 5: ''
[13:17:09] ℹ️    - Diagnosis 6: ''
[13:17:09] ℹ️  Final extracted MRN: 'MA241218114103'
[13:17:09] ℹ️  Final extracted Sex: ''
[13:17:09] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[13:17:09] ℹ️  Final extracted Payer Source: ''
[13:17:09] ✅ Patient data extraction completed successfully
[13:17:09] ✅    ✅ Patient data extracted successfully
[13:17:09] 📊 Patient Response
     └─ patientFName: Gilda
     └─ patientLName: Desousa
     └─ dob: 11/01/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA241218114103
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/24/2025', 'endOfEpisode': '06/22/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'G93.41', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:17:09] ✅    ✅ Patient identified: Gilda Desousa
[13:17:09] ✅    ✅ Patient name validation passed
[13:17:09] 🔄 
🔄 Step 3: Processing patient dates...
[13:17:09] [DOC: 9316853] ℹ️  DOB normalized: 11/01/1941
[13:17:09] [DOC: 9316853] ℹ️  Episode startOfEpisode normalized: 04/24/2025
[13:17:09] [DOC: 9316853] ℹ️  Episode endOfEpisode normalized: 06/22/2025
[13:17:09] [DOC: 9316853] ✅ Patient date processing completed successfully
[13:17:09] ✅    ✅ Date processing completed
[13:17:09] 📊 Processed Patient Data
     └─ patientFName: Gilda
     └─ patientLName: Desousa
     └─ dob: 11/01/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA241218114103
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/24/2025', 'endOfEpisode': '06/22/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'G93.41', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:17:09] 🔄 
🔄 Step 4: Extracting order data...
[13:17:11] ℹ️  Order extraction - MRN: 'MA241218114103'
[13:17:11] ℹ️  Order extraction - Sex: ''
[13:17:11] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[13:17:11] ℹ️  Order extraction - Payer Source: ''
[13:17:11] ✅ Order data extraction completed successfully
[13:17:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:17:11] ℹ️  Using MRN from patient data: 'MA241218114103' over 'MA241218114103'
[13:17:11] ⚠️  Could not determine sex using any available method
[13:17:11] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[13:17:11] ✅ Patient name cross-validation successful
[13:17:11] ✅    ✅ Data merged successfully
[13:17:13] ✅    ✅ Order data extracted and validated
[13:17:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:17:19] [DOC: 9316853] ℹ️  Patient not found in cache or API: Gilda Desousa
[13:17:19] [DOC: 9316853] ℹ️  Patient not found, creating new patient via API...
[13:17:19] [DOC: 9316853] ℹ️  Creating patient via API: Gilda Desousa
[13:17:20] [DOC: 9316853] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:17:20] ❌    ❌ Failed to create patient
[13:17:20] [DOC: 9316853] ℹ️  API push details saved for document 9316853
================================================================================
║                        Processing Document ID: 9316851                         ║
================================================================================
[13:17:20] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:17:20] ℹ️  Date: 05/29/2025
[13:17:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:17:23] [DOC: 9316851] ✅ Text extracted using pdfplumber (1437 chars)
[13:17:23] ✅    ✅ Text extracted using pdfplumber (1425 chars)
[13:17:23] 🔄 
🔄 Step 2: Extracting patient data...
[13:17:26] ℹ️  AI extracted raw sex value: ''
[13:17:26] ℹ️  AI extracted service line: 'Physical Therapy'
[13:17:26] ℹ️  AI extracted payer source: ''
[13:17:26] ℹ️  AI extracted diagnoses:
[13:17:26] ℹ️    - Diagnosis 1: 'A41.51'
[13:17:26] ℹ️    - Diagnosis 2: 'N39.0'
[13:17:26] ℹ️    - Diagnosis 3: 'G93.41'
[13:17:26] ℹ️    - Diagnosis 4: 'None'
[13:17:26] ℹ️    - Diagnosis 5: 'None'
[13:17:26] ℹ️    - Diagnosis 6: 'None'
[13:17:26] ℹ️  Final extracted MRN: 'MA241218114103'
[13:17:26] ℹ️  Final extracted Sex: ''
[13:17:26] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:17:26] ℹ️  Final extracted Payer Source: ''
[13:17:26] ✅ Patient data extraction completed successfully
[13:17:26] ✅    ✅ Patient data extracted successfully
[13:17:26] 📊 Patient Response
     └─ patientFName: Gilda
     └─ patientLName: Desousa
     └─ dob: 11/01/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA241218114103
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/24/2025', 'endOfEpisode': '06/22/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'G93.41', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:17:26] ✅    ✅ Patient identified: Gilda Desousa
[13:17:26] ✅    ✅ Patient name validation passed
[13:17:26] 🔄 
🔄 Step 3: Processing patient dates...
[13:17:26] [DOC: 9316851] ℹ️  DOB normalized: 11/01/1941
[13:17:26] [DOC: 9316851] ℹ️  Episode startOfEpisode normalized: 04/24/2025
[13:17:26] [DOC: 9316851] ℹ️  Episode endOfEpisode normalized: 06/22/2025
[13:17:26] [DOC: 9316851] ✅ Patient date processing completed successfully
[13:17:26] ✅    ✅ Date processing completed
[13:17:26] 📊 Processed Patient Data
     └─ patientFName: Gilda
     └─ patientLName: Desousa
     └─ dob: 11/01/1941
     └─ patientSex: 
     └─ medicalRecordNo: MA241218114103
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/24/2025', 'endOfEpisode': '06/22/2025', 'firstDiagnosis': 'A41.51', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'G93.41'}]
[13:17:26] 🔄 
🔄 Step 4: Extracting order data...
[13:17:28] ℹ️  Order extraction - MRN: 'MA241218114103'
[13:17:28] ℹ️  Order extraction - Sex: ''
[13:17:28] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[13:17:28] ℹ️  Order extraction - Payer Source: ''
[13:17:28] ✅ Order data extraction completed successfully
[13:17:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:17:28] ℹ️  Using MRN from patient data: 'MA241218114103' over 'MA241218114103'
[13:17:28] ⚠️  Could not determine sex using any available method
[13:17:28] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[13:17:28] ✅ Patient name cross-validation successful
[13:17:28] ✅    ✅ Data merged successfully
[13:17:29] ✅    ✅ Order data extracted and validated
[13:17:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:17:36] [DOC: 9316851] ℹ️  Patient not found in cache or API: Gilda Desousa
[13:17:36] [DOC: 9316851] ℹ️  Patient not found, creating new patient via API...
[13:17:36] [DOC: 9316851] ℹ️  Creating patient via API: Gilda Desousa
[13:17:37] [DOC: 9316851] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:17:37] ❌    ❌ Failed to create patient
[13:17:37] [DOC: 9316851] ℹ️  API push details saved for document 9316851
================================================================================
║                        Processing Document ID: 9316790                         ║
================================================================================
[13:17:37] ℹ️  Agency: AccentCare Fall River
[13:17:37] ℹ️  Date: 05/29/2025
[13:17:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:17:39] [DOC: 9316790] ✅ Text extracted using pdfplumber (1401 chars)
[13:17:39] ✅    ✅ Text extracted using pdfplumber (1401 chars)
[13:17:39] 🔄 
🔄 Step 2: Extracting patient data...
[13:17:42] ℹ️  AI extracted raw sex value: ''
[13:17:42] ℹ️  AI extracted service line: 'RN, LPN'
[13:17:42] ℹ️  AI extracted payer source: ''
[13:17:42] ℹ️  AI extracted diagnoses:
[13:17:42] ℹ️    - Diagnosis 1: ''
[13:17:42] ℹ️    - Diagnosis 2: ''
[13:17:42] ℹ️    - Diagnosis 3: ''
[13:17:42] ℹ️    - Diagnosis 4: ''
[13:17:42] ℹ️    - Diagnosis 5: ''
[13:17:42] ℹ️    - Diagnosis 6: ''
[13:17:42] ℹ️  Final extracted MRN: 'C0200237232301'
[13:17:42] ℹ️  Final extracted Sex: ''
[13:17:42] ℹ️  Final extracted Service Line: 'RN, LPN'
[13:17:42] ℹ️  Final extracted Payer Source: ''
[13:17:42] ✅ Patient data extraction completed successfully
[13:17:42] ✅    ✅ Patient data extracted successfully
[13:17:42] 📊 Patient Response
     └─ patientFName: MILO
     └─ patientLName: WEBSTER
     └─ dob: 07/21/1959
     └─ patientSex: 
     └─ medicalRecordNo: C0200237232301
     └─ billingProvider: JORDAN GULAREK, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: RN, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:17:42] ✅    ✅ Patient identified: MILO WEBSTER
[13:17:42] ✅    ✅ Patient name validation passed
[13:17:42] 🔄 
🔄 Step 3: Processing patient dates...
[13:17:42] [DOC: 9316790] ℹ️  DOB normalized: 07/21/1959
[13:17:42] [DOC: 9316790] ✅ Patient date processing completed successfully
[13:17:42] ✅    ✅ Date processing completed
[13:17:42] 📊 Processed Patient Data
     └─ patientFName: MILO
     └─ patientLName: WEBSTER
     └─ dob: 07/21/1959
     └─ patientSex: 
     └─ medicalRecordNo: C0200237232301
     └─ billingProvider: JORDAN GULAREK, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 21 FATHER DEVALLES BLVD STE 104
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723-1519
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: RN, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:17:42] 🔄 
🔄 Step 4: Extracting order data...
[13:17:44] ℹ️  Order extraction - MRN: 'C0200237232301'
[13:17:44] ℹ️  Order extraction - Sex: ''
[13:17:44] ℹ️  Order extraction - Service Line: 'RN'
[13:17:44] ℹ️  Order extraction - Payer Source: ''
[13:17:44] ✅ Order data extraction completed successfully
[13:17:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:17:44] ℹ️  Using MRN from patient data: 'C0200237232301' over 'C0200237232301'
[13:17:44] ⚠️  Could not determine sex using any available method
[13:17:44] ℹ️  Combined service lines: Patient='RN, LPN' + Order='RN' = 'LPN, RN'
[13:17:44] ✅ Patient name cross-validation successful
[13:17:44] ✅    ✅ Data merged successfully
[13:17:46] ✅    ✅ Order data extracted and validated
[13:17:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:17:52] [DOC: 9316790] ✅ Patient exists in API: MILO WEBSTER, ID: 695c5703-e477-4b11-a055-202369179483
[13:17:52] ✅    ✅ Existing patient found with ID: 695c5703-e477-4b11-a055-202369179483
[13:17:52] 🔄 
🔄 Step 6: Pushing order to API...
[13:17:52] [DOC: 9316790] ℹ️  Pushing order via API for patient ID: 695c5703-e477-4b11-a055-202369179483
[13:17:53] [DOC: 9316790] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16615"}
[13:17:53] ❌    ❌ Failed to push order
[13:17:53] 🔄 
🔄 Step 7: Writing to CSV...
[13:17:53] [DOC: 9316790] ℹ️  Calculated age: 65 from DOB: 07/21/1959
[13:17:53] [DOC: 9316790] ℹ️  Service Line extracted: 'LPN, RN'
[13:17:53] [DOC: 9316790] ℹ️  Payer Source extracted: ''
[13:17:53] [DOC: 9316790] ℹ️  Diagnosis codes being written:
[13:17:53] [DOC: 9316790] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:17:53] [DOC: 9316790] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:17:53] [DOC: 9316790] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:17:53] [DOC: 9316790] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:17:53] [DOC: 9316790] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:17:53] [DOC: 9316790] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:17:53] [DOC: 9316790] ✅ Patient data written to CSV: MILO WEBSTER | Sex:  | Age: 65 | Service: LPN, RN | Payer:  | MRN: C0200237232301
[13:17:53] ✅    ✅ Document 9316790 processed and saved successfully
[13:17:53] 🔄 
🔄 Step 8: Saving API details...
[13:17:53] [DOC: 9316790] ℹ️  API push details saved for document 9316790
[13:17:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9316761                         ║
================================================================================
[13:17:53] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:17:53] ℹ️  Date: 05/29/2025
[13:17:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:17:54] [DOC: 9316761] ✅ Text extracted using pdfplumber (3207 chars)
[13:17:54] ✅    ✅ Text extracted using pdfplumber (3207 chars)
[13:17:54] 🔄 
🔄 Step 2: Extracting patient data...
[13:17:57] ℹ️  AI extracted raw sex value: 'F'
[13:17:57] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:17:57] ℹ️  AI extracted payer source: ''
[13:17:57] ℹ️  AI extracted diagnoses:
[13:17:57] ℹ️    - Diagnosis 1: 'None'
[13:17:57] ℹ️    - Diagnosis 2: 'None'
[13:17:57] ℹ️    - Diagnosis 3: 'None'
[13:17:57] ℹ️    - Diagnosis 4: 'None'
[13:17:57] ℹ️    - Diagnosis 5: 'None'
[13:17:57] ℹ️    - Diagnosis 6: 'None'
[13:17:57] ℹ️  Final extracted MRN: '2577119'
[13:17:57] ℹ️  Final extracted Sex: 'FEMALE'
[13:17:57] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:17:57] ℹ️  Final extracted Payer Source: ''
[13:17:57] ✅ Patient data extraction completed successfully
[13:17:57] ✅    ✅ Patient data extracted successfully
[13:17:57] 📊 Patient Response
     └─ patientFName: Marilyn
     └─ patientLName: Hood
     └─ dob: 10/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2577119
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:17:57] ✅    ✅ Patient identified: Marilyn Hood
[13:17:57] ✅    ✅ Patient name validation passed
[13:17:57] 🔄 
🔄 Step 3: Processing patient dates...
[13:17:57] [DOC: 9316761] ℹ️  DOB normalized: 10/23/1941
[13:17:57] [DOC: 9316761] ✅ Patient date processing completed successfully
[13:17:57] ✅    ✅ Date processing completed
[13:17:57] 📊 Processed Patient Data
     └─ patientFName: Marilyn
     └─ patientLName: Hood
     └─ dob: 10/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2577119
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[13:17:57] 🔄 
🔄 Step 4: Extracting order data...
[13:18:00] ℹ️  Order extraction - MRN: '2577119'
[13:18:00] ℹ️  Order extraction - Sex: 'FEMALE'
[13:18:00] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:18:00] ℹ️  Order extraction - Payer Source: ''
[13:18:00] ✅ Order data extraction completed successfully
[13:18:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:18:00] ℹ️  Using MRN from patient data: '2577119' over '2577119'
[13:18:00] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:18:00] ✅ Patient name cross-validation successful
[13:18:00] ✅    ✅ Data merged successfully
[13:18:01] ✅    ✅ Order data extracted and validated
[13:18:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:18:17] [DOC: 9316761] ✅ Patient exists in API: Marilyn Hood, ID: 6dbefab8-cca3-4e53-942e-025025b735f3
[13:18:17] ✅    ✅ Existing patient found with ID: 6dbefab8-cca3-4e53-942e-025025b735f3
[13:18:17] 🔄 
🔄 Step 6: Pushing order to API...
[13:18:17] [DOC: 9316761] ℹ️  Pushing order via API for patient ID: 6dbefab8-cca3-4e53-942e-025025b735f3
[13:18:18] [DOC: 9316761] ❌ Order push failed with status 201: {"id":"c34fe1fd-3502-4fe2-a36a-612211f2ffaa","orderWAVId":"ORD19940","orderNo":"1086054, 1086084, 1086085, 1086086","orderDate":"04/26/2025","startOfCare":"04/26/2025","episodeStartDate":"04/26/2025","episodeEndDate":"05/27/2025","documentID":"9316761","mrn":"2577119","patientName":"Hood,Marilyn A","sentToPhysicianDate":"05/29/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"06/03/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"6dbefab8-cca3-4e53-942e-025025b735f3","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[13:18:18] ❌    ❌ Failed to push order
[13:18:18] 🔄 
🔄 Step 7: Writing to CSV...
[13:18:18] [DOC: 9316761] ℹ️  Calculated age: 83 from DOB: 10/23/1941
[13:18:18] [DOC: 9316761] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:18:18] [DOC: 9316761] ℹ️  Payer Source extracted: ''
[13:18:18] [DOC: 9316761] ℹ️  Diagnosis codes being written:
[13:18:18] [DOC: 9316761] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:18:18] [DOC: 9316761] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:18:18] [DOC: 9316761] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:18:18] [DOC: 9316761] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:18:18] [DOC: 9316761] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:18:18] [DOC: 9316761] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:18:18] [DOC: 9316761] ✅ Patient data written to CSV: Marilyn Hood | Sex: FEMALE | Age: 83 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: 2577119
[13:18:18] ✅    ✅ Document 9316761 processed and saved successfully
[13:18:18] 🔄 
🔄 Step 8: Saving API details...
[13:18:18] [DOC: 9316761] ℹ️  API push details saved for document 9316761
[13:18:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9316607                         ║
================================================================================
[13:18:18] ℹ️  Agency: Dartmouth HH
[13:18:18] ℹ️  Date: 05/29/2025
[13:18:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:18:21] [DOC: 9316607] ✅ Text extracted using pdfplumber (10430 chars)
[13:18:21] ✅    ✅ Text extracted using pdfplumber (10430 chars)
[13:18:21] 🔄 
🔄 Step 2: Extracting patient data...
[13:18:24] ℹ️  AI extracted raw sex value: 'F'
[13:18:24] ℹ️  AI extracted service line: 'OT'
[13:18:24] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[13:18:24] ℹ️  AI extracted diagnoses:
[13:18:24] ℹ️    - Diagnosis 1: ''
[13:18:24] ℹ️    - Diagnosis 2: ''
[13:18:24] ℹ️    - Diagnosis 3: ''
[13:18:24] ℹ️    - Diagnosis 4: ''
[13:18:24] ℹ️    - Diagnosis 5: ''
[13:18:24] ℹ️    - Diagnosis 6: ''
[13:18:24] ℹ️  Final extracted MRN: '4526015'
[13:18:24] ℹ️  Final extracted Sex: 'FEMALE'
[13:18:24] ℹ️  Final extracted Service Line: 'OT'
[13:18:24] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[13:18:24] ✅ Patient data extraction completed successfully
[13:18:24] ✅    ✅ Patient data extracted successfully
[13:18:24] 📊 Patient Response
     └─ patientFName: Maureen
     └─ patientLName: McCarthy
     └─ dob: 06/04/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4526015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '05/08/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:18:24] ✅    ✅ Patient identified: Maureen McCarthy
[13:18:24] ✅    ✅ Patient name validation passed
[13:18:24] 🔄 
🔄 Step 3: Processing patient dates...
[13:18:24] [DOC: 9316607] ℹ️  DOB normalized: 06/04/1943
[13:18:24] [DOC: 9316607] ℹ️  Episode startOfCare normalized: 05/08/2025
[13:18:24] [DOC: 9316607] ℹ️  Episode startOfEpisode normalized: 05/08/2025
[13:18:24] [DOC: 9316607] ℹ️  Episode endOfEpisode normalized: 07/06/2025
[13:18:24] [DOC: 9316607] ✅ Patient date processing completed successfully
[13:18:24] ✅    ✅ Date processing completed
[13:18:24] 📊 Processed Patient Data
     └─ patientFName: Maureen
     └─ patientLName: McCarthy
     └─ dob: 06/04/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4526015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '05/08/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:18:24] 🔄 
🔄 Step 4: Extracting order data...
[13:18:27] ℹ️  Order extraction - MRN: '4526015'
[13:18:27] ℹ️  Order extraction - Sex: 'FEMALE'
[13:18:27] ℹ️  Order extraction - Service Line: 'OT'
[13:18:27] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[13:18:27] ✅ Order data extraction completed successfully
[13:18:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:18:27] ℹ️  Using MRN from patient data: '4526015' over '4526015'
[13:18:27] ℹ️  Service line consistent in both sources: 'OT'
[13:18:27] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[13:18:27] ✅ Patient name cross-validation successful
[13:18:27] ✅    ✅ Data merged successfully
[13:18:28] ✅    ✅ Order data extracted and validated
[13:18:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:18:34] [DOC: 9316607] ✅ Patient exists in API: Maureen McCarthy, ID: 46e24a65-6bf2-4577-b455-5b59e6a780b5
[13:18:34] ✅    ✅ Existing patient found with ID: 46e24a65-6bf2-4577-b455-5b59e6a780b5
[13:18:34] 🔄 
🔄 Step 6: Pushing order to API...
[13:18:34] [DOC: 9316607] ℹ️  Pushing order via API for patient ID: 46e24a65-6bf2-4577-b455-5b59e6a780b5
[13:18:35] [DOC: 9316607] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:18:35] ❌    ❌ Failed to push order
[13:18:35] 🔄 
🔄 Step 7: Writing to CSV...
[13:18:35] [DOC: 9316607] ℹ️  Calculated age: 82 from DOB: 06/04/1943
[13:18:35] [DOC: 9316607] ℹ️  Service Line extracted: 'OT'
[13:18:35] [DOC: 9316607] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[13:18:35] [DOC: 9316607] ℹ️  Diagnosis codes being written:
[13:18:35] [DOC: 9316607] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:18:35] [DOC: 9316607] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:18:35] [DOC: 9316607] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:18:35] [DOC: 9316607] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:18:35] [DOC: 9316607] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:18:35] [DOC: 9316607] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:18:35] [DOC: 9316607] ✅ Patient data written to CSV: Maureen McCarthy | Sex: FEMALE | Age: 82 | Service: OT | Payer: Blue Cross Medicare Adv | MRN: 4526015
[13:18:35] ✅    ✅ Document 9316607 processed and saved successfully
[13:18:35] 🔄 
🔄 Step 8: Saving API details...
[13:18:35] [DOC: 9316607] ℹ️  API push details saved for document 9316607
[13:18:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9316601                         ║
================================================================================
[13:18:35] ℹ️  Agency: Dartmouth HH
[13:18:35] ℹ️  Date: 05/29/2025
[13:18:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:18:43] [DOC: 9316601] ✅ Text extracted using pdfplumber (16574 chars)
[13:18:43] ✅    ✅ Text extracted using pdfplumber (16574 chars)
[13:18:43] 🔄 
🔄 Step 2: Extracting patient data...
[13:18:46] ℹ️  AI extracted raw sex value: 'F'
[13:18:46] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:18:46] ℹ️  AI extracted payer source: 'None'
[13:18:46] ℹ️  AI extracted diagnoses:
[13:18:46] ℹ️    - Diagnosis 1: 'E11.40'
[13:18:46] ℹ️    - Diagnosis 2: 'R53.1'
[13:18:46] ℹ️    - Diagnosis 3: 'M25.551'
[13:18:46] ℹ️    - Diagnosis 4: 'N39.0'
[13:18:46] ℹ️    - Diagnosis 5: 'M17.12'
[13:18:46] ℹ️    - Diagnosis 6: 'I10'
[13:18:46] ℹ️  Final extracted MRN: '4526015'
[13:18:46] ℹ️  Final extracted Sex: 'FEMALE'
[13:18:46] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:18:46] ℹ️  Final extracted Payer Source: ''
[13:18:46] ✅ Patient data extraction completed successfully
[13:18:46] ✅    ✅ Patient data extracted successfully
[13:18:46] 📊 Patient Response
     └─ patientFName: Maureen
     └─ patientLName: McCarthy
     └─ dob: 06/04/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4526015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 100227740725
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/30/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': 'E11.40', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'M25.551', 'fourthDiagnosis': 'N39.0', 'fifthDiagnosis': 'M17.12', 'sixthDiagnosis': 'I10'}]
[13:18:46] ✅    ✅ Patient identified: Maureen McCarthy
[13:18:46] ✅    ✅ Patient name validation passed
[13:18:46] 🔄 
🔄 Step 3: Processing patient dates...
[13:18:46] [DOC: 9316601] ℹ️  DOB normalized: 06/04/1943
[13:18:46] [DOC: 9316601] ℹ️  Episode startOfCare normalized: 04/30/2025
[13:18:46] [DOC: 9316601] ℹ️  Episode startOfEpisode normalized: 05/08/2025
[13:18:46] [DOC: 9316601] ℹ️  Episode endOfEpisode normalized: 07/06/2025
[13:18:46] [DOC: 9316601] ✅ Patient date processing completed successfully
[13:18:46] ✅    ✅ Date processing completed
[13:18:46] 📊 Processed Patient Data
     └─ patientFName: Maureen
     └─ patientLName: McCarthy
     └─ dob: 06/04/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4526015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 100227740725
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/30/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': 'E11.40', 'secondDiagnosis': 'R53.1', 'thirdDiagnosis': 'M25.551', 'fourthDiagnosis': 'N39.0', 'fifthDiagnosis': 'M17.12', 'sixthDiagnosis': 'I10'}]
[13:18:46] 🔄 
🔄 Step 4: Extracting order data...
[13:18:49] ℹ️  Order extraction - MRN: '4526015'
[13:18:49] ℹ️  Order extraction - Sex: 'FEMALE'
[13:18:49] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[13:18:49] ℹ️  Order extraction - Payer Source: ''
[13:18:49] ✅ Order data extraction completed successfully
[13:18:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:18:49] ℹ️  Using MRN from patient data: '4526015' over '4526015'
[13:18:49] ℹ️  Combined service lines: Patient='Skilled Nursing, Physical Therapy, Occupational Therapy' + Order='Skilled Nursing, PT, OT' = 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[13:18:49] ✅ Patient name cross-validation successful
[13:18:49] ✅    ✅ Data merged successfully
[13:18:50] ✅    ✅ Order data extracted and validated
[13:18:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:18:50] [DOC: 9316601] ✅ Patient found in local cache: Maureen McCarthy, ID: 46e24a65-6bf2-4577-b455-5b59e6a780b5
[13:18:50] ✅    ✅ Existing patient found with ID: 46e24a65-6bf2-4577-b455-5b59e6a780b5
[13:18:50] 🔄 
🔄 Step 6: Pushing order to API...
[13:18:50] [DOC: 9316601] ℹ️  Pushing order via API for patient ID: 46e24a65-6bf2-4577-b455-5b59e6a780b5
[13:18:51] [DOC: 9316601] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:18:51] ❌    ❌ Failed to push order
[13:18:51] 🔄 
🔄 Step 7: Writing to CSV...
[13:18:51] [DOC: 9316601] ℹ️  Calculated age: 82 from DOB: 06/04/1943
[13:18:51] [DOC: 9316601] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[13:18:51] [DOC: 9316601] ℹ️  Payer Source extracted: ''
[13:18:51] [DOC: 9316601] ℹ️  Diagnosis codes being written:
[13:18:51] [DOC: 9316601] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.40'
[13:18:51] [DOC: 9316601] ℹ️    - Latest_Episode_Seconddiagnosis: 'R53.1'
[13:18:51] [DOC: 9316601] ℹ️    - Latest_Episode_Thirddiagnosis: 'M25.551'
[13:18:51] [DOC: 9316601] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N39.0'
[13:18:51] [DOC: 9316601] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M17.12'
[13:18:51] [DOC: 9316601] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I10'
[13:18:51] [DOC: 9316601] ✅ Patient data written to CSV: Maureen McCarthy | Sex: FEMALE | Age: 82 | Service: OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 4526015
[13:18:51] ✅    ✅ Document 9316601 processed and saved successfully
[13:18:51] 🔄 
🔄 Step 8: Saving API details...
[13:18:51] [DOC: 9316601] ℹ️  API push details saved for document 9316601
[13:18:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9316591                         ║
================================================================================
[13:18:51] ℹ️  Agency: Dartmouth HH
[13:18:51] ℹ️  Date: 05/29/2025
[13:18:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:18:53] [DOC: 9316591] ✅ Text extracted using pdfplumber (18179 chars)
[13:18:53] ✅    ✅ Text extracted using pdfplumber (18179 chars)
[13:18:53] 🔄 
🔄 Step 2: Extracting patient data...
[13:18:56] ℹ️  AI extracted raw sex value: 'F'
[13:18:56] ℹ️  AI extracted service line: 'Skilled Nursing, PT, Diet'
[13:18:56] ℹ️  AI extracted payer source: ''
[13:18:56] ℹ️  AI extracted diagnoses:
[13:18:56] ℹ️    - Diagnosis 1: 'I10'
[13:18:56] ℹ️    - Diagnosis 2: 'I95.1'
[13:18:56] ℹ️    - Diagnosis 3: 'R29.6'
[13:18:56] ℹ️    - Diagnosis 4: 'R26.81'
[13:18:56] ℹ️    - Diagnosis 5: 'G89.4'
[13:18:56] ℹ️    - Diagnosis 6: 'G50.0'
[13:18:56] ℹ️  Final extracted MRN: '6545015'
[13:18:56] ℹ️  Final extracted Sex: 'FEMALE'
[13:18:56] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, Diet'
[13:18:56] ℹ️  Final extracted Payer Source: ''
[13:18:56] ✅ Patient data extraction completed successfully
[13:18:56] ✅    ✅ Patient data extracted successfully
[13:18:56] 📊 Patient Response
     └─ patientFName: Sharon S
     └─ patientLName: Costa
     └─ dob: 06/14/1965
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6545015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, Diet
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/14/2025', 'startOfEpisode': '05/20/2025', 'endOfEpisode': '07/18/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I95.1', 'thirdDiagnosis': 'R29.6', 'fourthDiagnosis': 'R26.81', 'fifthDiagnosis': 'G89.4', 'sixthDiagnosis': 'G50.0'}]
[13:18:56] ✅    ✅ Patient identified: Sharon S Costa
[13:18:56] ✅    ✅ Patient name validation passed
[13:18:56] 🔄 
🔄 Step 3: Processing patient dates...
[13:18:56] [DOC: 9316591] ℹ️  DOB normalized: 06/14/1965
[13:18:56] [DOC: 9316591] ℹ️  Episode startOfCare normalized: 05/14/2025
[13:18:56] [DOC: 9316591] ℹ️  Episode startOfEpisode normalized: 05/20/2025
[13:18:56] [DOC: 9316591] ℹ️  Episode endOfEpisode normalized: 07/18/2025
[13:18:56] [DOC: 9316591] ✅ Patient date processing completed successfully
[13:18:56] ✅    ✅ Date processing completed
[13:18:56] 📊 Processed Patient Data
     └─ patientFName: Sharon S
     └─ patientLName: Costa
     └─ dob: 06/14/1965
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6545015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, Diet
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/14/2025', 'startOfEpisode': '05/20/2025', 'endOfEpisode': '07/18/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I95.1', 'thirdDiagnosis': 'R29.6', 'fourthDiagnosis': 'R26.81', 'fifthDiagnosis': 'G89.4', 'sixthDiagnosis': 'G50.0'}]
[13:18:56] 🔄 
🔄 Step 4: Extracting order data...
[13:18:59] ℹ️  Order extraction - MRN: '6545015'
[13:18:59] ℹ️  Order extraction - Sex: 'FEMALE'
[13:18:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[13:18:59] ℹ️  Order extraction - Payer Source: ''
[13:18:59] ✅ Order data extraction completed successfully
[13:18:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:18:59] ℹ️  Using MRN from patient data: '6545015' over '6545015'
[13:18:59] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, Diet' + Order='Skilled Nursing, Physical Therapy' = 'Diet, PT, Physical Therapy, Skilled Nursing'
[13:18:59] ✅ Patient name cross-validation successful
[13:18:59] ✅    ✅ Data merged successfully
[13:19:00] ✅    ✅ Order data extracted and validated
[13:19:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:19:06] [DOC: 9316591] ℹ️  Patient not found in cache or API: Sharon S Costa
[13:19:06] [DOC: 9316591] ℹ️  Patient not found, creating new patient via API...
[13:19:06] [DOC: 9316591] ℹ️  Creating patient via API: Sharon S Costa
[13:19:08] [DOC: 9316591] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:19:08] ❌    ❌ Failed to create patient
[13:19:08] [DOC: 9316591] ℹ️  API push details saved for document 9316591
================================================================================
║                        Processing Document ID: 9316582                         ║
================================================================================
[13:19:08] ℹ️  Agency: Dartmouth HH
[13:19:08] ℹ️  Date: 05/29/2025
[13:19:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:19:11] [DOC: 9316582] ✅ Text extracted using pdfplumber (13196 chars)
[13:19:11] ✅    ✅ Text extracted using pdfplumber (13196 chars)
[13:19:11] 🔄 
🔄 Step 2: Extracting patient data...
[13:19:14] ℹ️  AI extracted raw sex value: 'F'
[13:19:14] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[13:19:14] ℹ️  AI extracted payer source: 'None'
[13:19:14] ℹ️  AI extracted diagnoses:
[13:19:14] ℹ️    - Diagnosis 1: 'J96.11'
[13:19:14] ℹ️    - Diagnosis 2: 'K52.9'
[13:19:14] ℹ️    - Diagnosis 3: 'G89.4'
[13:19:14] ℹ️    - Diagnosis 4: 'M47.897'
[13:19:14] ℹ️    - Diagnosis 5: 'J44.9'
[13:19:14] ℹ️    - Diagnosis 6: 'E11.9'
[13:19:14] ℹ️  Final extracted MRN: '519009'
[13:19:14] ℹ️  Final extracted Sex: 'FEMALE'
[13:19:14] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[13:19:14] ℹ️  Final extracted Payer Source: ''
[13:19:14] ✅ Patient data extraction completed successfully
[13:19:14] ✅    ✅ Patient data extracted successfully
[13:19:14] 📊 Patient Response
     └─ patientFName: Cynthia
     └─ patientLName: Reddy
     └─ dob: 10/04/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 519009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 100009847672
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/16/2025', 'startOfEpisode': '05/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'J96.11', 'secondDiagnosis': 'K52.9', 'thirdDiagnosis': 'G89.4', 'fourthDiagnosis': 'M47.897', 'fifthDiagnosis': 'J44.9', 'sixthDiagnosis': 'E11.9'}]
[13:19:14] ✅    ✅ Patient identified: Cynthia Reddy
[13:19:14] ✅    ✅ Patient name validation passed
[13:19:14] 🔄 
🔄 Step 3: Processing patient dates...
[13:19:14] [DOC: 9316582] ℹ️  DOB normalized: 10/04/1946
[13:19:14] [DOC: 9316582] ℹ️  Episode startOfCare normalized: 05/16/2025
[13:19:14] [DOC: 9316582] ℹ️  Episode startOfEpisode normalized: 05/16/2025
[13:19:14] [DOC: 9316582] ℹ️  Episode endOfEpisode normalized: 07/14/2025
[13:19:14] [DOC: 9316582] ✅ Patient date processing completed successfully
[13:19:14] ✅    ✅ Date processing completed
[13:19:14] 📊 Processed Patient Data
     └─ patientFName: Cynthia
     └─ patientLName: Reddy
     └─ dob: 10/04/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 519009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 100009847672
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/16/2025', 'startOfEpisode': '05/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'J96.11', 'secondDiagnosis': 'K52.9', 'thirdDiagnosis': 'G89.4', 'fourthDiagnosis': 'M47.897', 'fifthDiagnosis': 'J44.9', 'sixthDiagnosis': 'E11.9'}]
[13:19:14] 🔄 
🔄 Step 4: Extracting order data...
[13:19:16] ℹ️  Order extraction - MRN: '519009'
[13:19:16] ℹ️  Order extraction - Sex: 'FEMALE'
[13:19:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[13:19:16] ℹ️  Order extraction - Payer Source: ''
[13:19:16] ✅ Order data extraction completed successfully
[13:19:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:19:16] ℹ️  Using MRN from patient data: '519009' over '519009'
[13:19:16] ℹ️  Combined service lines: Patient='Skilled Nursing, PT, OT' + Order='Skilled Nursing, Physical Therapy, Occupational Therapy' = 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[13:19:16] ✅ Patient name cross-validation successful
[13:19:16] ✅    ✅ Data merged successfully
[13:19:18] ✅    ✅ Order data extracted and validated
[13:19:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:19:18] [DOC: 9316582] ✅ Patient found in local cache: Cynthia Reddy, ID: 7c152491-8a88-48e5-80a0-00d845b5f874
[13:19:18] ✅    ✅ Existing patient found with ID: 7c152491-8a88-48e5-80a0-00d845b5f874
[13:19:18] 🔄 
🔄 Step 6: Pushing order to API...
[13:19:18] [DOC: 9316582] ℹ️  Pushing order via API for patient ID: 7c152491-8a88-48e5-80a0-00d845b5f874
[13:19:19] [DOC: 9316582] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:19:19] ❌    ❌ Failed to push order
[13:19:19] 🔄 
🔄 Step 7: Writing to CSV...
[13:19:19] [DOC: 9316582] ℹ️  Calculated age: 78 from DOB: 10/04/1946
[13:19:19] [DOC: 9316582] ℹ️  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing'
[13:19:19] [DOC: 9316582] ℹ️  Payer Source extracted: ''
[13:19:19] [DOC: 9316582] ℹ️  Diagnosis codes being written:
[13:19:19] [DOC: 9316582] ℹ️    - Latest_Episode_Firstdiagnosis: 'J96.11'
[13:19:19] [DOC: 9316582] ℹ️    - Latest_Episode_Seconddiagnosis: 'K52.9'
[13:19:19] [DOC: 9316582] ℹ️    - Latest_Episode_Thirddiagnosis: 'G89.4'
[13:19:19] [DOC: 9316582] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M47.897'
[13:19:19] [DOC: 9316582] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J44.9'
[13:19:19] [DOC: 9316582] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E11.9'
[13:19:19] [DOC: 9316582] ✅ Patient data written to CSV: Cynthia Reddy | Sex: FEMALE | Age: 78 | Service: OT, Occupational Therapy, PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 519009
[13:19:19] ✅    ✅ Document 9316582 processed and saved successfully
[13:19:19] 🔄 
🔄 Step 8: Saving API details...
[13:19:19] [DOC: 9316582] ℹ️  API push details saved for document 9316582
[13:19:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9316570                         ║
================================================================================
[13:19:19] ℹ️  Agency: Dartmouth HH
[13:19:19] ℹ️  Date: 05/29/2025
[13:19:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:19:22] [DOC: 9316570] ✅ Text extracted using pdfplumber (16081 chars)
[13:19:22] ✅    ✅ Text extracted using pdfplumber (16069 chars)
[13:19:22] 🔄 
🔄 Step 2: Extracting patient data...
[13:19:25] ℹ️  AI extracted raw sex value: 'F'
[13:19:25] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy'
[13:19:25] ℹ️  AI extracted payer source: ''
[13:19:25] ℹ️  AI extracted diagnoses:
[13:19:25] ℹ️    - Diagnosis 1: 'C50.912'
[13:19:25] ℹ️    - Diagnosis 2: 'C77.3'
[13:19:25] ℹ️    - Diagnosis 3: 'J44.9'
[13:19:25] ℹ️    - Diagnosis 4: 'I11.0'
[13:19:25] ℹ️    - Diagnosis 5: 'I50.9'
[13:19:25] ℹ️    - Diagnosis 6: 'E11.9'
[13:19:25] ℹ️  Final extracted MRN: '227027'
[13:19:25] ℹ️  Final extracted Sex: 'FEMALE'
[13:19:25] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy'
[13:19:25] ℹ️  Final extracted Payer Source: ''
[13:19:25] ✅ Patient data extraction completed successfully
[13:19:25] ✅    ✅ Patient data extracted successfully
[13:19:25] 📊 Patient Response
     └─ patientFName: Sandra
     └─ patientLName: Knickerbocker
     └─ dob: 07/22/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '07/23/2025', 'firstDiagnosis': 'C50.912', 'secondDiagnosis': 'C77.3', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.9', 'sixthDiagnosis': 'E11.9'}]
[13:19:25] ✅    ✅ Patient identified: Sandra Knickerbocker
[13:19:25] ✅    ✅ Patient name validation passed
[13:19:25] 🔄 
🔄 Step 3: Processing patient dates...
[13:19:25] [DOC: 9316570] ℹ️  DOB normalized: 07/22/1948
[13:19:25] [DOC: 9316570] ℹ️  Episode startOfCare normalized: 03/26/2025
[13:19:25] [DOC: 9316570] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[13:19:25] [DOC: 9316570] ℹ️  Episode endOfEpisode normalized: 07/23/2025
[13:19:25] [DOC: 9316570] ✅ Patient date processing completed successfully
[13:19:25] ✅    ✅ Date processing completed
[13:19:25] 📊 Processed Patient Data
     └─ patientFName: Sandra
     └─ patientLName: Knickerbocker
     └─ dob: 07/22/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '07/23/2025', 'firstDiagnosis': 'C50.912', 'secondDiagnosis': 'C77.3', 'thirdDiagnosis': 'J44.9', 'fourthDiagnosis': 'I11.0', 'fifthDiagnosis': 'I50.9', 'sixthDiagnosis': 'E11.9'}]
[13:19:25] 🔄 
🔄 Step 4: Extracting order data...
[13:19:28] ℹ️  Order extraction - MRN: '7544009'
[13:19:28] ℹ️  Order extraction - Sex: 'FEMALE'
[13:19:28] ℹ️  Order extraction - Service Line: 'RN, OT'
[13:19:28] ℹ️  Order extraction - Payer Source: ''
[13:19:28] ✅ Order data extraction completed successfully
[13:19:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:19:28] ℹ️  Using longer MRN from order data: '7544009' over '227027'
[13:19:28] ℹ️  Combined service lines: Patient='Skilled Nursing, Occupational Therapy' + Order='RN, OT' = 'OT, Occupational Therapy, RN, Skilled Nursing'
[13:19:28] ✅ Patient name cross-validation successful
[13:19:28] ✅    ✅ Data merged successfully
[13:19:29] ✅    ✅ Order data extracted and validated
[13:19:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:19:29] [DOC: 9316570] ✅ Patient found in local cache: Sandra Knickerbocker, ID: 72b6d189-6994-4d0a-9e48-56e329440311
[13:19:29] ✅    ✅ Existing patient found with ID: 72b6d189-6994-4d0a-9e48-56e329440311
[13:19:29] 🔄 
🔄 Step 6: Pushing order to API...
[13:19:29] [DOC: 9316570] ℹ️  Pushing order via API for patient ID: 72b6d189-6994-4d0a-9e48-56e329440311
[13:19:30] [DOC: 9316570] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:19:30] ❌    ❌ Failed to push order
[13:19:30] 🔄 
🔄 Step 7: Writing to CSV...
[13:19:30] [DOC: 9316570] ℹ️  Calculated age: 76 from DOB: 07/22/1948
[13:19:30] [DOC: 9316570] ℹ️  Service Line extracted: 'OT, Occupational Therapy, RN, Skilled Nursing'
[13:19:30] [DOC: 9316570] ℹ️  Payer Source extracted: ''
[13:19:30] [DOC: 9316570] ℹ️  Diagnosis codes being written:
[13:19:30] [DOC: 9316570] ℹ️    - Latest_Episode_Firstdiagnosis: 'C50.912'
[13:19:30] [DOC: 9316570] ℹ️    - Latest_Episode_Seconddiagnosis: 'C77.3'
[13:19:30] [DOC: 9316570] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.9'
[13:19:30] [DOC: 9316570] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I11.0'
[13:19:30] [DOC: 9316570] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I50.9'
[13:19:30] [DOC: 9316570] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E11.9'
[13:19:30] [DOC: 9316570] ✅ Patient data written to CSV: Sandra Knickerbocker | Sex: FEMALE | Age: 76 | Service: OT, Occupational Therapy, RN, Skilled Nursing | Payer:  | MRN: 7544009
[13:19:30] ✅    ✅ Document 9316570 processed and saved successfully
[13:19:30] 🔄 
🔄 Step 8: Saving API details...
[13:19:30] [DOC: 9316570] ℹ️  API push details saved for document 9316570
[13:19:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9316965                         ║
================================================================================
[13:19:30] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[13:19:30] ℹ️  Date: 05/29/2025
[13:19:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:19:32] [DOC: 9316965] ✅ Text extracted using pdfplumber (1350 chars)
[13:19:32] ✅    ✅ Text extracted using pdfplumber (1350 chars)
[13:19:32] 🔄 
🔄 Step 2: Extracting patient data...
[13:19:35] ℹ️  AI extracted raw sex value: 'M'
[13:19:35] ℹ️  AI extracted service line: ''
[13:19:35] ℹ️  AI extracted payer source: 'Medicaid/MA'
[13:19:35] ℹ️  AI extracted diagnoses:
[13:19:35] ℹ️    - Diagnosis 1: ''
[13:19:35] ℹ️    - Diagnosis 2: ''
[13:19:35] ℹ️    - Diagnosis 3: ''
[13:19:35] ℹ️    - Diagnosis 4: ''
[13:19:35] ℹ️    - Diagnosis 5: ''
[13:19:35] ℹ️    - Diagnosis 6: ''
[13:19:35] ℹ️  Final extracted MRN: '174003'
[13:19:35] ℹ️  Final extracted Sex: 'MALE'
[13:19:35] ℹ️  Final extracted Service Line: ''
[13:19:35] ℹ️  Final extracted Payer Source: 'Medicaid/MA'
[13:19:35] ✅ Patient data extraction completed successfully
[13:19:35] ✅    ✅ Patient data extracted successfully
[13:19:35] 📊 Patient Response
     └─ patientFName: Julio
     └─ patientLName: Philogene
     └─ dob: 07/29/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 174003
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 67 Hunter St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: 
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/08/2017', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:19:35] ✅    ✅ Patient identified: Julio Philogene
[13:19:35] ✅    ✅ Patient name validation passed
[13:19:35] 🔄 
🔄 Step 3: Processing patient dates...
[13:19:35] [DOC: 9316965] ℹ️  DOB normalized: 07/29/1980
[13:19:35] [DOC: 9316965] ℹ️  Episode startOfCare normalized: 09/08/2017
[13:19:35] [DOC: 9316965] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[13:19:35] [DOC: 9316965] ℹ️  Episode endOfEpisode normalized: 05/28/2025
[13:19:35] [DOC: 9316965] ✅ Patient date processing completed successfully
[13:19:35] ✅    ✅ Date processing completed
[13:19:35] 📊 Processed Patient Data
     └─ patientFName: Julio
     └─ patientLName: Philogene
     └─ dob: 07/29/1980
     └─ patientSex: MALE
     └─ medicalRecordNo: 174003
     └─ billingProvider: Sachin Maskey, MD
     └─ npi: 1134386972
     └─ physicianNPI: 1134386972
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 67 Hunter St
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: 
     └─ payorSource: Medicaid/MA
     └─ episodeDiagnoses: [{'startOfCare': '09/08/2017', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:19:35] 🔄 
🔄 Step 4: Extracting order data...
[13:19:37] ℹ️  Order extraction - MRN: '174003'
[13:19:37] ℹ️  Order extraction - Sex: 'MALE'
[13:19:37] ℹ️  Order extraction - Service Line: ''
[13:19:37] ℹ️  Order extraction - Payer Source: 'Medicaid/MA'
[13:19:37] ✅ Order data extraction completed successfully
[13:19:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:19:37] ℹ️  Using MRN from patient data: '174003' over '174003'
[13:19:37] ℹ️  Payer source consistent in both sources: 'Medicaid/MA'
[13:19:37] ✅ Patient name cross-validation successful
[13:19:37] ✅    ✅ Data merged successfully
[13:19:38] ✅    ✅ Order data extracted and validated
[13:19:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:19:44] [DOC: 9316965] ✅ Patient exists in API: Julio Philogene, ID: 2a11f5dd-a46e-4892-9391-fb9412ba9ee7
[13:19:44] ✅    ✅ Existing patient found with ID: 2a11f5dd-a46e-4892-9391-fb9412ba9ee7
[13:19:44] 🔄 
🔄 Step 6: Pushing order to API...
[13:19:44] [DOC: 9316965] ℹ️  Pushing order via API for patient ID: 2a11f5dd-a46e-4892-9391-fb9412ba9ee7
[13:19:45] [DOC: 9316965] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:19:45] ❌    ❌ Failed to push order
[13:19:45] 🔄 
🔄 Step 7: Writing to CSV...
[13:19:45] [DOC: 9316965] ℹ️  Calculated age: 44 from DOB: 07/29/1980
[13:19:45] [DOC: 9316965] ℹ️  Service Line extracted: ''
[13:19:45] [DOC: 9316965] ℹ️  Payer Source extracted: 'Medicaid/MA'
[13:19:45] [DOC: 9316965] ℹ️  Diagnosis codes being written:
[13:19:45] [DOC: 9316965] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:19:45] [DOC: 9316965] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:19:45] [DOC: 9316965] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:19:45] [DOC: 9316965] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:19:45] [DOC: 9316965] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:19:45] [DOC: 9316965] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:19:45] [DOC: 9316965] ✅ Patient data written to CSV: Julio Philogene | Sex: MALE | Age: 44 | Service:  | Payer: Medicaid/MA | MRN: 174003
[13:19:45] ✅    ✅ Document 9316965 processed and saved successfully
[13:19:45] 🔄 
🔄 Step 8: Saving API details...
[13:19:45] [DOC: 9316965] ℹ️  API push details saved for document 9316965
[13:19:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9315648                         ║
================================================================================
[13:19:45] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[13:19:45] ℹ️  Date: 05/28/2025
[13:19:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:19:47] [DOC: 9315648] ✅ Text extracted using pdfplumber (7632 chars)
[13:19:47] ✅    ✅ Text extracted using pdfplumber (7632 chars)
[13:19:47] 🔄 
🔄 Step 2: Extracting patient data...
[13:19:50] ℹ️  AI extracted raw sex value: 'F'
[13:19:50] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:19:50] ℹ️  AI extracted payer source: 'None'
[13:19:50] ℹ️  AI extracted diagnoses:
[13:19:50] ℹ️    - Diagnosis 1: 'F31.9'
[13:19:50] ℹ️    - Diagnosis 2: 'F41.9'
[13:19:50] ℹ️    - Diagnosis 3: 'F43.10'
[13:19:50] ℹ️    - Diagnosis 4: 'F90.1'
[13:19:50] ℹ️    - Diagnosis 5: 'G40.909'
[13:19:50] ℹ️    - Diagnosis 6: 'M54.50'
[13:19:50] ℹ️  Final extracted MRN: '1005'
[13:19:50] ℹ️  Final extracted Sex: 'FEMALE'
[13:19:50] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:19:50] ℹ️  Final extracted Payer Source: ''
[13:19:50] ✅ Patient data extraction completed successfully
[13:19:50] ✅    ✅ Patient data extracted successfully
[13:19:50] 📊 Patient Response
     └─ patientFName: Christina
     └─ patientLName: Bosworth
     └─ dob: 07/02/1990
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1005
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 1114903663
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: None
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/17/2022', 'startOfEpisode': '06/02/2025', 'endOfEpisode': '07/31/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'F43.10', 'fourthDiagnosis': 'F90.1', 'fifthDiagnosis': 'G40.909', 'sixthDiagnosis': 'M54.50'}]
[13:19:50] ✅    ✅ Patient identified: Christina Bosworth
[13:19:50] ✅    ✅ Patient name validation passed
[13:19:50] 🔄 
🔄 Step 3: Processing patient dates...
[13:19:50] [DOC: 9315648] ℹ️  DOB normalized: 07/02/1990
[13:19:50] [DOC: 9315648] ℹ️  Episode startOfCare normalized: 08/17/2022
[13:19:50] [DOC: 9315648] ℹ️  Episode startOfEpisode normalized: 06/02/2025
[13:19:50] [DOC: 9315648] ℹ️  Episode endOfEpisode normalized: 07/31/2025
[13:19:50] [DOC: 9315648] ✅ Patient date processing completed successfully
[13:19:50] ✅    ✅ Date processing completed
[13:19:50] 📊 Processed Patient Data
     └─ patientFName: Christina
     └─ patientLName: Bosworth
     └─ dob: 07/02/1990
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1005
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 1114903663
     └─ physicianNPI: 
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/17/2022', 'startOfEpisode': '06/02/2025', 'endOfEpisode': '07/31/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'F43.10', 'fourthDiagnosis': 'F90.1', 'fifthDiagnosis': 'G40.909', 'sixthDiagnosis': 'M54.50'}]
[13:19:50] 🔄 
🔄 Step 4: Extracting order data...
[13:19:53] ℹ️  Order extraction - MRN: '1005'
[13:19:53] ℹ️  Order extraction - Sex: 'FEMALE'
[13:19:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:19:53] ℹ️  Order extraction - Payer Source: ''
[13:19:53] ✅ Order data extraction completed successfully
[13:19:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:19:53] ℹ️  Using MRN from patient data: '1005' over '1005'
[13:19:53] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:19:53] ✅ Patient name cross-validation successful
[13:19:53] ✅    ✅ Data merged successfully
[13:19:54] ✅    ✅ Order data extracted and validated
[13:19:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:19:54] [DOC: 9315648] ✅ Patient found in local cache: Christina Bosworth, ID: 189e87b4-7506-4371-aa11-46e767bb1879
[13:19:54] ✅    ✅ Existing patient found with ID: 189e87b4-7506-4371-aa11-46e767bb1879
[13:19:54] 🔄 
🔄 Step 6: Pushing order to API...
[13:19:54] [DOC: 9315648] ℹ️  Pushing order via API for patient ID: 189e87b4-7506-4371-aa11-46e767bb1879
[13:19:55] [DOC: 9315648] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:19:55] ❌    ❌ Failed to push order
[13:19:55] 🔄 
🔄 Step 7: Writing to CSV...
[13:19:55] [DOC: 9315648] ℹ️  Calculated age: 34 from DOB: 07/02/1990
[13:19:55] [DOC: 9315648] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:19:55] [DOC: 9315648] ℹ️  Payer Source extracted: ''
[13:19:55] [DOC: 9315648] ℹ️  Diagnosis codes being written:
[13:19:55] [DOC: 9315648] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.9'
[13:19:55] [DOC: 9315648] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.9'
[13:19:55] [DOC: 9315648] ℹ️    - Latest_Episode_Thirddiagnosis: 'F43.10'
[13:19:55] [DOC: 9315648] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F90.1'
[13:19:55] [DOC: 9315648] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G40.909'
[13:19:55] [DOC: 9315648] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M54.50'
[13:19:55] [DOC: 9315648] ✅ Patient data written to CSV: Christina Bosworth | Sex: FEMALE | Age: 34 | Service: Skilled Nursing | Payer:  | MRN: 1005
[13:19:55] ✅    ✅ Document 9315648 processed and saved successfully
[13:19:55] 🔄 
🔄 Step 8: Saving API details...
[13:19:55] [DOC: 9315648] ℹ️  API push details saved for document 9315648
[13:19:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9315617                         ║
================================================================================
[13:19:55] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[13:19:55] ℹ️  Date: 05/28/2025
[13:19:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:19:58] [DOC: 9315617] ✅ Text extracted using pdfplumber (8114 chars)
[13:19:58] ✅    ✅ Text extracted using pdfplumber (8114 chars)
[13:19:58] 🔄 
🔄 Step 2: Extracting patient data...
[13:20:01] ℹ️  AI extracted raw sex value: 'F'
[13:20:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:20:01] ℹ️  AI extracted payer source: ''
[13:20:01] ℹ️  AI extracted diagnoses:
[13:20:01] ℹ️    - Diagnosis 1: 'E11.22'
[13:20:01] ℹ️    - Diagnosis 2: 'I12.9'
[13:20:01] ℹ️    - Diagnosis 3: 'N18.31'
[13:20:01] ℹ️    - Diagnosis 4: 'F32.2'
[13:20:01] ℹ️    - Diagnosis 5: 'E11.42'
[13:20:01] ℹ️    - Diagnosis 6: 'K59.00'
[13:20:01] ℹ️  Final extracted MRN: '554005'
[13:20:01] ℹ️  Final extracted Sex: 'FEMALE'
[13:20:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:20:01] ℹ️  Final extracted Payer Source: ''
[13:20:01] ✅ Patient data extraction completed successfully
[13:20:01] ✅    ✅ Patient data extracted successfully
[13:20:01] 📊 Patient Response
     └─ patientFName: Yomayra
     └─ patientLName: Velez-Morales
     └─ dob: 10/26/1975
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 554005
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 100031947029
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '06/04/2024', 'startOfEpisode': '05/30/2025', 'endOfEpisode': '07/28/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'F32.2', 'fifthDiagnosis': 'E11.42', 'sixthDiagnosis': 'K59.00'}]
[13:20:01] ✅    ✅ Patient identified: Yomayra Velez-Morales
[13:20:01] ✅    ✅ Patient name validation passed
[13:20:01] 🔄 
🔄 Step 3: Processing patient dates...
[13:20:01] [DOC: 9315617] ℹ️  DOB normalized: 10/26/1975
[13:20:01] [DOC: 9315617] ℹ️  Episode startOfCare normalized: 06/04/2024
[13:20:01] [DOC: 9315617] ℹ️  Episode startOfEpisode normalized: 05/30/2025
[13:20:01] [DOC: 9315617] ℹ️  Episode endOfEpisode normalized: 07/28/2025
[13:20:01] [DOC: 9315617] ✅ Patient date processing completed successfully
[13:20:01] ✅    ✅ Date processing completed
[13:20:01] 📊 Processed Patient Data
     └─ patientFName: Yomayra
     └─ patientLName: Velez-Morales
     └─ dob: 10/26/1975
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 554005
     └─ billingProvider: Guardian Home Health Care, ACP LLC
     └─ npi: 100031947029
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Guardian Home Health Care, ACP LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '06/04/2024', 'startOfEpisode': '05/30/2025', 'endOfEpisode': '07/28/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I12.9', 'thirdDiagnosis': 'N18.31', 'fourthDiagnosis': 'F32.2', 'fifthDiagnosis': 'E11.42', 'sixthDiagnosis': 'K59.00'}]
[13:20:01] 🔄 
🔄 Step 4: Extracting order data...
[13:20:04] ℹ️  Order extraction - MRN: '554005'
[13:20:04] ℹ️  Order extraction - Sex: 'FEMALE'
[13:20:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:20:04] ℹ️  Order extraction - Payer Source: ''
[13:20:04] ✅ Order data extraction completed successfully
[13:20:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:20:04] ℹ️  Using MRN from patient data: '554005' over '554005'
[13:20:04] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:20:04] ✅ Patient name cross-validation successful
[13:20:04] ✅    ✅ Data merged successfully
[13:20:05] ✅    ✅ Order data extracted and validated
[13:20:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:20:05] [DOC: 9315617] ✅ Patient found in local cache: Yomayra Velez-Morales, ID: e98d4286-e41f-4b12-99e1-b508f6e5aa92
[13:20:05] ✅    ✅ Existing patient found with ID: e98d4286-e41f-4b12-99e1-b508f6e5aa92
[13:20:05] 🔄 
🔄 Step 6: Pushing order to API...
[13:20:05] [DOC: 9315617] ℹ️  Pushing order via API for patient ID: e98d4286-e41f-4b12-99e1-b508f6e5aa92
[13:20:06] [DOC: 9315617] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14386"}
[13:20:06] ❌    ❌ Failed to push order
[13:20:06] 🔄 
🔄 Step 7: Writing to CSV...
[13:20:06] [DOC: 9315617] ℹ️  Calculated age: 49 from DOB: 10/26/1975
[13:20:06] [DOC: 9315617] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:20:06] [DOC: 9315617] ℹ️  Payer Source extracted: ''
[13:20:06] [DOC: 9315617] ℹ️  Diagnosis codes being written:
[13:20:06] [DOC: 9315617] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.22'
[13:20:06] [DOC: 9315617] ℹ️    - Latest_Episode_Seconddiagnosis: 'I12.9'
[13:20:06] [DOC: 9315617] ℹ️    - Latest_Episode_Thirddiagnosis: 'N18.31'
[13:20:06] [DOC: 9315617] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F32.2'
[13:20:06] [DOC: 9315617] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E11.42'
[13:20:06] [DOC: 9315617] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K59.00'
[13:20:06] [DOC: 9315617] ✅ Patient data written to CSV: Yomayra Velez-Morales | Sex: FEMALE | Age: 49 | Service: Skilled Nursing | Payer:  | MRN: 554005
[13:20:06] ✅    ✅ Document 9315617 processed and saved successfully
[13:20:06] 🔄 
🔄 Step 8: Saving API details...
[13:20:06] [DOC: 9315617] ℹ️  API push details saved for document 9315617
[13:20:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9315540                         ║
================================================================================
[13:20:06] ℹ️  Agency: Guardian Home Health Care LLC - West Bridgewater
[13:20:06] ℹ️  Date: 05/28/2025
[13:20:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:20:08] [DOC: 9315540] ✅ Text extracted using pdfplumber (7746 chars)
[13:20:08] ✅    ✅ Text extracted using pdfplumber (7746 chars)
[13:20:08] 🔄 
🔄 Step 2: Extracting patient data...
[13:20:11] ℹ️  AI extracted raw sex value: 'F'
[13:20:11] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[13:20:11] ℹ️  AI extracted payer source: ''
[13:20:11] ℹ️  AI extracted diagnoses:
[13:20:11] ℹ️    - Diagnosis 1: 'E11.22'
[13:20:11] ℹ️    - Diagnosis 2: 'I13.0'
[13:20:11] ℹ️    - Diagnosis 3: 'I50.32'
[13:20:11] ℹ️    - Diagnosis 4: 'N18.30'
[13:20:11] ℹ️    - Diagnosis 5: 'E11.40'
[13:20:11] ℹ️    - Diagnosis 6: 'I48.0'
[13:20:11] ℹ️  Final extracted MRN: '76003'
[13:20:11] ℹ️  Final extracted Sex: 'FEMALE'
[13:20:11] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[13:20:11] ℹ️  Final extracted Payer Source: ''
[13:20:11] ✅ Patient data extraction completed successfully
[13:20:11] ✅    ✅ Patient data extracted successfully
[13:20:11] 📊 Patient Response
     └─ patientFName: Gili
     └─ patientLName: Aquilina
     └─ dob: 06/13/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 76003
     └─ billingProvider: Achilles Romualdo E Alcaraz, MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/07/2023', 'startOfEpisode': '08/07/2023', 'endOfEpisode': '07/26/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'E11.40', 'sixthDiagnosis': 'I48.0'}]
[13:20:11] ✅    ✅ Patient identified: Gili Aquilina
[13:20:11] ✅    ✅ Patient name validation passed
[13:20:11] 🔄 
🔄 Step 3: Processing patient dates...
[13:20:11] [DOC: 9315540] ℹ️  DOB normalized: 06/13/1934
[13:20:11] [DOC: 9315540] ℹ️  Episode startOfCare normalized: 08/07/2023
[13:20:11] [DOC: 9315540] ℹ️  Episode startOfEpisode normalized: 08/07/2023
[13:20:11] [DOC: 9315540] ℹ️  Episode endOfEpisode normalized: 07/26/2025
[13:20:11] [DOC: 9315540] ✅ Patient date processing completed successfully
[13:20:11] ✅    ✅ Date processing completed
[13:20:11] 📊 Processed Patient Data
     └─ patientFName: Gili
     └─ patientLName: Aquilina
     └─ dob: 06/13/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 76003
     └─ billingProvider: Achilles Romualdo E Alcaraz, MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Guardian Home Health Care, LLC
     └─ address: 750 West Center St 3rd Floor
     └─ city: W Bridgewater
     └─ state: MA
     └─ zip: 02379
     └─ email: 
     └─ phoneNumber: (508) 588-5811
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '08/07/2023', 'startOfEpisode': '08/07/2023', 'endOfEpisode': '07/26/2025', 'firstDiagnosis': 'E11.22', 'secondDiagnosis': 'I13.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': 'N18.30', 'fifthDiagnosis': 'E11.40', 'sixthDiagnosis': 'I48.0'}]
[13:20:11] 🔄 
🔄 Step 4: Extracting order data...
[13:20:14] ℹ️  Order extraction - MRN: '76003'
[13:20:14] ℹ️  Order extraction - Sex: 'FEMALE'
[13:20:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[13:20:14] ℹ️  Order extraction - Payer Source: ''
[13:20:14] ✅ Order data extraction completed successfully
[13:20:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:20:14] ℹ️  Using MRN from patient data: '76003' over '76003'
[13:20:14] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT'
[13:20:14] ✅ Patient name cross-validation successful
[13:20:14] ✅    ✅ Data merged successfully
[13:20:15] ✅    ✅ Order data extracted and validated
[13:20:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:20:21] [DOC: 9315540] ℹ️  Patient not found in cache or API: Gili Aquilina
[13:20:21] [DOC: 9315540] ℹ️  Patient not found, creating new patient via API...
[13:20:21] [DOC: 9315540] ℹ️  Creating patient via API: Gili Aquilina
[13:20:22] [DOC: 9315540] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:20:22] ❌    ❌ Failed to create patient
[13:20:22] [DOC: 9315540] ℹ️  API push details saved for document 9315540
================================================================================
║                        Processing Document ID: 2179509                         ║
================================================================================
[13:20:22] ℹ️  Agency: Visiting Rehab & Nursing Services
[13:20:22] ℹ️  Date: 05/28/2025
[13:20:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:20:24] [DOC: 2179509] ❌ Critical failure in get_pdf_text: Invalid response format
[13:20:24] ❌ Failed to extract text for Doc ID 2179509
[13:20:24] [DOC: 2179509] ℹ️  API push details saved for document 2179509
================================================================================
║                        Processing Document ID: 2179492                         ║
================================================================================
[13:20:24] ℹ️  Agency: Enhabit OF NEW ENGLAND - (SPR)
[13:20:24] ℹ️  Date: 05/28/2025
[13:20:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:20:25] [DOC: 2179492] ❌ Critical failure in get_pdf_text: Invalid response format
[13:20:25] ❌ Failed to extract text for Doc ID 2179492
[13:20:25] [DOC: 2179492] ℹ️  API push details saved for document 2179492
================================================================================
║                        Processing Document ID: 9314974                         ║
================================================================================
[13:20:25] ℹ️  Agency: Nizhoni Health Systems-Somerville
[13:20:25] ℹ️  Date: 05/28/2025
[13:20:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:20:31] [DOC: 9314974] ✅ Text extracted using pdfplumber (18086 chars)
[13:20:31] ✅    ✅ Text extracted using pdfplumber (18086 chars)
[13:20:31] 🔄 
🔄 Step 2: Extracting patient data...
[13:20:35] ℹ️  AI extracted raw sex value: 'F'
[13:20:35] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:20:35] ℹ️  AI extracted payer source: 'CCA insurance'
[13:20:35] ℹ️  AI extracted diagnoses:
[13:20:35] ℹ️    - Diagnosis 1: 'E11.649'
[13:20:35] ℹ️    - Diagnosis 2: 'F31.9'
[13:20:35] ℹ️    - Diagnosis 3: 'F41.1'
[13:20:35] ℹ️    - Diagnosis 4: 'M79.7'
[13:20:35] ℹ️    - Diagnosis 5: 'G43.909'
[13:20:35] ℹ️    - Diagnosis 6: 'E03.9'
[13:20:35] ℹ️  Final extracted MRN: '149007'
[13:20:35] ℹ️  Final extracted Sex: 'FEMALE'
[13:20:35] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:20:35] ℹ️  Final extracted Payer Source: 'CCA insurance'
[13:20:35] ✅ Patient data extraction completed successfully
[13:20:35] ✅    ✅ Patient data extracted successfully
[13:20:35] 📊 Patient Response
     └─ patientFName: Michelle
     └─ patientLName: Medeiros
     └─ dob: 04/01/1976
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 149007
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100050091022
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: CCA insurance
     └─ episodeDiagnoses: [{'startOfCare': '12/07/2018', 'startOfEpisode': '12/07/2018', 'endOfEpisode': '07/02/2025', 'firstDiagnosis': 'E11.649', 'secondDiagnosis': 'F31.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': 'M79.7', 'fifthDiagnosis': 'G43.909', 'sixthDiagnosis': 'E03.9'}]
[13:20:35] ✅    ✅ Patient identified: Michelle Medeiros
[13:20:35] ✅    ✅ Patient name validation passed
[13:20:35] 🔄 
🔄 Step 3: Processing patient dates...
[13:20:35] [DOC: 9314974] ℹ️  DOB normalized: 04/01/1976
[13:20:35] [DOC: 9314974] ℹ️  Episode startOfCare normalized: 12/07/2018
[13:20:35] [DOC: 9314974] ℹ️  Episode startOfEpisode normalized: 12/07/2018
[13:20:35] [DOC: 9314974] ℹ️  Episode endOfEpisode normalized: 07/02/2025
[13:20:35] [DOC: 9314974] ✅ Patient date processing completed successfully
[13:20:35] ✅    ✅ Date processing completed
[13:20:35] 📊 Processed Patient Data
     └─ patientFName: Michelle
     └─ patientLName: Medeiros
     └─ dob: 04/01/1976
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 149007
     └─ billingProvider: Innovive Health of Massachusetts LLC
     └─ npi: 100050091022
     └─ physicianNPI: 
     └─ nameOfAgency: Innovive Health of Massachusetts LLC
     └─ address: 10 Cabot Rd Suite 201
     └─ city: Medford
     └─ state: MA
     └─ zip: 02155
     └─ email: 
     └─ phoneNumber: (617) 623-3211
     └─ serviceLine: Skilled Nursing
     └─ payorSource: CCA insurance
     └─ episodeDiagnoses: [{'startOfCare': '12/07/2018', 'startOfEpisode': '12/07/2018', 'endOfEpisode': '07/02/2025', 'firstDiagnosis': 'E11.649', 'secondDiagnosis': 'F31.9', 'thirdDiagnosis': 'F41.1', 'fourthDiagnosis': 'M79.7', 'fifthDiagnosis': 'G43.909', 'sixthDiagnosis': 'E03.9'}]
[13:20:35] 🔄 
🔄 Step 4: Extracting order data...
[13:20:38] ℹ️  Order extraction - MRN: '149007'
[13:20:38] ℹ️  Order extraction - Sex: 'FEMALE'
[13:20:38] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:20:38] ℹ️  Order extraction - Payer Source: ''
[13:20:38] ✅ Order data extraction completed successfully
[13:20:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:20:38] ℹ️  Using MRN from patient data: '149007' over '149007'
[13:20:38] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:20:38] ℹ️  Using payer source from patient data: 'CCA insurance'
[13:20:38] ✅ Patient name cross-validation successful
[13:20:38] ✅    ✅ Data merged successfully
[13:20:39] ✅    ✅ Order data extracted and validated
[13:20:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:20:44] [DOC: 9314974] ✅ Patient exists in API: Michelle Medeiros, ID: a22c4d90-a8e4-46e8-9f60-ed12d9f03a92
[13:20:44] ✅    ✅ Existing patient found with ID: a22c4d90-a8e4-46e8-9f60-ed12d9f03a92
[13:20:44] 🔄 
🔄 Step 6: Pushing order to API...
[13:20:44] [DOC: 9314974] ℹ️  Pushing order via API for patient ID: a22c4d90-a8e4-46e8-9f60-ed12d9f03a92
[13:20:46] [DOC: 9314974] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:20:46] ❌    ❌ Failed to push order
[13:20:46] 🔄 
🔄 Step 7: Writing to CSV...
[13:20:46] [DOC: 9314974] ℹ️  Calculated age: 49 from DOB: 04/01/1976
[13:20:46] [DOC: 9314974] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:20:46] [DOC: 9314974] ℹ️  Payer Source extracted: 'CCA insurance'
[13:20:46] [DOC: 9314974] ℹ️  Diagnosis codes being written:
[13:20:46] [DOC: 9314974] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.649'
[13:20:46] [DOC: 9314974] ℹ️    - Latest_Episode_Seconddiagnosis: 'F31.9'
[13:20:46] [DOC: 9314974] ℹ️    - Latest_Episode_Thirddiagnosis: 'F41.1'
[13:20:46] [DOC: 9314974] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M79.7'
[13:20:46] [DOC: 9314974] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G43.909'
[13:20:46] [DOC: 9314974] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E03.9'
[13:20:46] [DOC: 9314974] ✅ Patient data written to CSV: Michelle Medeiros | Sex: FEMALE | Age: 49 | Service: Skilled Nursing | Payer: CCA insurance | MRN: 149007
[13:20:46] ✅    ✅ Document 9314974 processed and saved successfully
[13:20:46] 🔄 
🔄 Step 8: Saving API details...
[13:20:46] [DOC: 9314974] ℹ️  API push details saved for document 9314974
[13:20:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 2179467                         ║
================================================================================
[13:20:46] ℹ️  Agency: All At Home Health Care-Allston
[13:20:46] ℹ️  Date: 05/28/2025
[13:20:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:20:47] [DOC: 2179467] ❌ Critical failure in get_pdf_text: Invalid response format
[13:20:47] ❌ Failed to extract text for Doc ID 2179467
[13:20:47] [DOC: 2179467] ℹ️  API push details saved for document 2179467
================================================================================
║                        Processing Document ID: 2179466                         ║
================================================================================
[13:20:47] ℹ️  Agency: All At Home Health Care-Allston
[13:20:47] ℹ️  Date: 05/28/2025
[13:20:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:20:48] [DOC: 2179466] ❌ Critical failure in get_pdf_text: Invalid response format
[13:20:48] ❌ Failed to extract text for Doc ID 2179466
[13:20:48] [DOC: 2179466] ℹ️  API push details saved for document 2179466
================================================================================
║                        Processing Document ID: 9314132                         ║
================================================================================
[13:20:48] ℹ️  Agency: Fairhaven HH&H
[13:20:48] ℹ️  Date: 05/28/2025
[13:20:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:20:51] [DOC: 9314132] ✅ Text extracted using pdfplumber (1651 chars)
[13:20:51] ✅    ✅ Text extracted using pdfplumber (1651 chars)
[13:20:51] 🔄 
🔄 Step 2: Extracting patient data...
[13:20:53] ℹ️  AI extracted raw sex value: 'M'
[13:20:53] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:20:53] ℹ️  AI extracted payer source: 'Health Plans Inc.'
[13:20:53] ℹ️  AI extracted diagnoses:
[13:20:53] ℹ️    - Diagnosis 1: ''
[13:20:53] ℹ️    - Diagnosis 2: ''
[13:20:53] ℹ️    - Diagnosis 3: ''
[13:20:53] ℹ️    - Diagnosis 4: ''
[13:20:53] ℹ️    - Diagnosis 5: ''
[13:20:53] ℹ️    - Diagnosis 6: ''
[13:20:53] ℹ️  Final extracted MRN: '1661015'
[13:20:53] ℹ️  Final extracted Sex: 'MALE'
[13:20:53] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:20:53] ℹ️  Final extracted Payer Source: 'Health Plans Inc.'
[13:20:53] ✅ Patient data extraction completed successfully
[13:20:53] ✅    ✅ Patient data extracted successfully
[13:20:53] 📊 Patient Response
     └─ patientFName: Norman
     └─ patientLName: Fuller
     └─ dob: 03/26/1932
     └─ patientSex: MALE
     └─ medicalRecordNo: 1661015
     └─ billingProvider: Health Plans Inc.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Health Plans Inc.
     └─ episodeDiagnoses: [{'startOfCare': '05/01/2025', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '07/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:20:53] ✅    ✅ Patient identified: Norman Fuller
[13:20:53] ✅    ✅ Patient name validation passed
[13:20:53] 🔄 
🔄 Step 3: Processing patient dates...
[13:20:53] [DOC: 9314132] ℹ️  DOB normalized: 03/26/1932
[13:20:53] [DOC: 9314132] ℹ️  Episode startOfCare normalized: 05/01/2025
[13:20:53] [DOC: 9314132] ℹ️  Episode startOfEpisode normalized: 05/01/2025
[13:20:53] [DOC: 9314132] ℹ️  Episode endOfEpisode normalized: 07/29/2025
[13:20:53] [DOC: 9314132] ✅ Patient date processing completed successfully
[13:20:53] ✅    ✅ Date processing completed
[13:20:53] 📊 Processed Patient Data
     └─ patientFName: Norman
     └─ patientLName: Fuller
     └─ dob: 03/26/1932
     └─ patientSex: MALE
     └─ medicalRecordNo: 1661015
     └─ billingProvider: Health Plans Inc.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Health Plans Inc.
     └─ episodeDiagnoses: [{'startOfCare': '05/01/2025', 'startOfEpisode': '05/01/2025', 'endOfEpisode': '07/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:20:53] 🔄 
🔄 Step 4: Extracting order data...
[13:20:56] ℹ️  Order extraction - MRN: ''
[13:20:56] ℹ️  Order extraction - Sex: 'MALE'
[13:20:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:20:56] ℹ️  Order extraction - Payer Source: 'Health Plans Inc.'
[13:20:56] ✅ Order data extraction completed successfully
[13:20:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:20:56] ℹ️  Using MRN from patient data: '1661015'
[13:20:56] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:20:56] ℹ️  Payer source consistent in both sources: 'Health Plans Inc.'
[13:20:56] ✅ Patient name cross-validation successful
[13:20:56] ✅    ✅ Data merged successfully
[13:20:57] ✅    ✅ Order data extracted and validated
[13:20:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:21:25] [DOC: 9314132] ✅ Patient exists in API: Norman Fuller, ID: d0b427fa-85cd-4a1c-8c18-91b0f60fcf9e
[13:21:25] ✅    ✅ Existing patient found with ID: d0b427fa-85cd-4a1c-8c18-91b0f60fcf9e
[13:21:25] 🔄 
🔄 Step 6: Pushing order to API...
[13:21:25] [DOC: 9314132] ℹ️  Pushing order via API for patient ID: d0b427fa-85cd-4a1c-8c18-91b0f60fcf9e
[13:21:26] [DOC: 9314132] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:21:26] ❌    ❌ Failed to push order
[13:21:26] 🔄 
🔄 Step 7: Writing to CSV...
[13:21:26] [DOC: 9314132] ℹ️  Calculated age: 93 from DOB: 03/26/1932
[13:21:26] [DOC: 9314132] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:21:26] [DOC: 9314132] ℹ️  Payer Source extracted: 'Health Plans Inc.'
[13:21:26] [DOC: 9314132] ℹ️  Diagnosis codes being written:
[13:21:26] [DOC: 9314132] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:21:26] [DOC: 9314132] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:21:26] [DOC: 9314132] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:21:26] [DOC: 9314132] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:21:26] [DOC: 9314132] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:21:26] [DOC: 9314132] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:21:26] [DOC: 9314132] ✅ Patient data written to CSV: Norman Fuller | Sex: MALE | Age: 93 | Service: Skilled Nursing | Payer: Health Plans Inc. | MRN: 1661015
[13:21:26] ✅    ✅ Document 9314132 processed and saved successfully
[13:21:26] 🔄 
🔄 Step 8: Saving API details...
[13:21:26] [DOC: 9314132] ℹ️  API push details saved for document 9314132
[13:21:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9314116                         ║
================================================================================
[13:21:26] ℹ️  Agency: Fairhaven HH&H
[13:21:26] ℹ️  Date: 05/28/2025
[13:21:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:21:27] [DOC: 9314116] ❌ Critical failure in get_pdf_text: Invalid response format
[13:21:27] ❌ Failed to extract text for Doc ID 9314116
[13:21:27] [DOC: 9314116] ℹ️  API push details saved for document 9314116
================================================================================
║                        Processing Document ID: 9314099                         ║
================================================================================
[13:21:27] ℹ️  Agency: Fairhaven HH&H
[13:21:27] ℹ️  Date: 05/28/2025
[13:21:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:21:29] [DOC: 9314099] ✅ Text extracted using pdfplumber (1070 chars)
[13:21:29] ✅    ✅ Text extracted using pdfplumber (1070 chars)
[13:21:29] 🔄 
🔄 Step 2: Extracting patient data...
[13:21:32] ℹ️  AI extracted raw sex value: 'F'
[13:21:32] ℹ️  AI extracted service line: 'MSW'
[13:21:32] ℹ️  AI extracted payer source: 'Medicare'
[13:21:32] ℹ️  AI extracted diagnoses:
[13:21:32] ℹ️    - Diagnosis 1: ''
[13:21:32] ℹ️    - Diagnosis 2: ''
[13:21:32] ℹ️    - Diagnosis 3: ''
[13:21:32] ℹ️    - Diagnosis 4: ''
[13:21:32] ℹ️    - Diagnosis 5: ''
[13:21:32] ℹ️    - Diagnosis 6: ''
[13:21:32] ℹ️  Final extracted MRN: '5350011'
[13:21:32] ℹ️  Final extracted Sex: 'FEMALE'
[13:21:32] ℹ️  Final extracted Service Line: 'MSW'
[13:21:32] ℹ️  Final extracted Payer Source: 'Medicare'
[13:21:32] ✅ Patient data extraction completed successfully
[13:21:32] ✅    ✅ Patient data extracted successfully
[13:21:32] 📊 Patient Response
     └─ patientFName: Rosemary
     └─ patientLName: Crompton
     └─ dob: 08/17/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5350011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/02/2023', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:21:32] ✅    ✅ Patient identified: Rosemary Crompton
[13:21:32] ✅    ✅ Patient name validation passed
[13:21:32] 🔄 
🔄 Step 3: Processing patient dates...
[13:21:32] [DOC: 9314099] ℹ️  DOB normalized: 08/17/1944
[13:21:32] [DOC: 9314099] ℹ️  Episode startOfCare normalized: 12/02/2023
[13:21:32] [DOC: 9314099] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[13:21:32] [DOC: 9314099] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[13:21:32] [DOC: 9314099] ✅ Patient date processing completed successfully
[13:21:32] ✅    ✅ Date processing completed
[13:21:32] 📊 Processed Patient Data
     └─ patientFName: Rosemary
     └─ patientLName: Crompton
     └─ dob: 08/17/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5350011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: MSW
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/02/2023', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:21:32] 🔄 
🔄 Step 4: Extracting order data...
[13:21:34] ℹ️  Order extraction - MRN: '5350011'
[13:21:34] ℹ️  Order extraction - Sex: 'FEMALE'
[13:21:34] ℹ️  Order extraction - Service Line: 'MSW'
[13:21:34] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:21:34] ✅ Order data extraction completed successfully
[13:21:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:21:34] ℹ️  Using MRN from patient data: '5350011' over '5350011'
[13:21:34] ℹ️  Service line consistent in both sources: 'MSW'
[13:21:34] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:21:34] ✅ Patient name cross-validation successful
[13:21:34] ✅    ✅ Data merged successfully
[13:21:36] ✅    ✅ Order data extracted and validated
[13:21:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:21:41] [DOC: 9314099] ✅ Patient exists in API: Rosemary Crompton, ID: 9e9a2730-2134-440b-9deb-8a3dc67fd265
[13:21:41] ✅    ✅ Existing patient found with ID: 9e9a2730-2134-440b-9deb-8a3dc67fd265
[13:21:41] 🔄 
🔄 Step 6: Pushing order to API...
[13:21:41] [DOC: 9314099] ℹ️  Pushing order via API for patient ID: 9e9a2730-2134-440b-9deb-8a3dc67fd265
[13:21:42] [DOC: 9314099] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:21:42] ❌    ❌ Failed to push order
[13:21:42] 🔄 
🔄 Step 7: Writing to CSV...
[13:21:42] [DOC: 9314099] ℹ️  Calculated age: 80 from DOB: 08/17/1944
[13:21:42] [DOC: 9314099] ℹ️  Service Line extracted: 'MSW'
[13:21:42] [DOC: 9314099] ℹ️  Payer Source extracted: 'Medicare'
[13:21:42] [DOC: 9314099] ℹ️  Diagnosis codes being written:
[13:21:42] [DOC: 9314099] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:21:42] [DOC: 9314099] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:21:42] [DOC: 9314099] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:21:42] [DOC: 9314099] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:21:42] [DOC: 9314099] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:21:42] [DOC: 9314099] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:21:42] [DOC: 9314099] ✅ Patient data written to CSV: Rosemary Crompton | Sex: FEMALE | Age: 80 | Service: MSW | Payer: Medicare | MRN: 5350011
[13:21:42] ✅    ✅ Document 9314099 processed and saved successfully
[13:21:42] 🔄 
🔄 Step 8: Saving API details...
[13:21:42] [DOC: 9314099] ℹ️  API push details saved for document 9314099
[13:21:42] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9314078                         ║
================================================================================
[13:21:42] ℹ️  Agency: Fairhaven HH&H
[13:21:42] ℹ️  Date: 05/28/2025
[13:21:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:21:43] [DOC: 9314078] ❌ Critical failure in get_pdf_text: Invalid response format
[13:21:43] ❌ Failed to extract text for Doc ID 9314078
[13:21:43] [DOC: 9314078] ℹ️  API push details saved for document 9314078
================================================================================
║                        Processing Document ID: 9314072                         ║
================================================================================
[13:21:43] ℹ️  Agency: Fairhaven HH&H
[13:21:43] ℹ️  Date: 05/28/2025
[13:21:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:21:45] [DOC: 9314072] ❌ Critical failure in get_pdf_text: Invalid response format
[13:21:45] ❌ Failed to extract text for Doc ID 9314072
[13:21:45] [DOC: 9314072] ℹ️  API push details saved for document 9314072
================================================================================
║                        Processing Document ID: 9314061                         ║
================================================================================
[13:21:45] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[13:21:45] ℹ️  Date: 05/28/2025
[13:21:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:21:51] [DOC: 9314061] ✅ Text extracted using pdfplumber (1307 chars)
[13:21:51] ✅    ✅ Text extracted using pdfplumber (1307 chars)
[13:21:51] 🔄 
🔄 Step 2: Extracting patient data...
[13:21:54] ℹ️  AI extracted raw sex value: 'M'
[13:21:54] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:21:54] ℹ️  AI extracted payer source: ''
[13:21:54] ℹ️  AI extracted diagnoses:
[13:21:54] ℹ️    - Diagnosis 1: 'None'
[13:21:54] ℹ️    - Diagnosis 2: 'None'
[13:21:54] ℹ️    - Diagnosis 3: 'None'
[13:21:54] ℹ️    - Diagnosis 4: 'None'
[13:21:54] ℹ️    - Diagnosis 5: 'None'
[13:21:54] ℹ️    - Diagnosis 6: 'None'
[13:21:54] ℹ️  Final extracted MRN: '2170342'
[13:21:54] ℹ️  Final extracted Sex: 'MALE'
[13:21:54] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:21:54] ℹ️  Final extracted Payer Source: ''
[13:21:54] ✅ Patient data extraction completed successfully
[13:21:54] ✅    ✅ Patient data extracted successfully
[13:21:54] 📊 Patient Response
     └─ patientFName: Joao
     └─ patientLName: Aguiar
     └─ dob: 08/11/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 2170342
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:21:54] ✅    ✅ Patient identified: Joao Aguiar
[13:21:54] ✅    ✅ Patient name validation passed
[13:21:54] 🔄 
🔄 Step 3: Processing patient dates...
[13:21:54] [DOC: 9314061] ℹ️  DOB normalized: 08/11/1954
[13:21:54] [DOC: 9314061] ✅ Patient date processing completed successfully
[13:21:54] ✅    ✅ Date processing completed
[13:21:54] 📊 Processed Patient Data
     └─ patientFName: Joao
     └─ patientLName: Aguiar
     └─ dob: 08/11/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 2170342
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[13:21:54] 🔄 
🔄 Step 4: Extracting order data...
[13:21:56] ℹ️  Order extraction - MRN: '2170342'
[13:21:56] ℹ️  Order extraction - Sex: 'MALE'
[13:21:56] ℹ️  Order extraction - Service Line: 'SN'
[13:21:56] ℹ️  Order extraction - Payer Source: ''
[13:21:56] ✅ Order data extraction completed successfully
[13:21:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:21:56] ℹ️  Using MRN from patient data: '2170342' over '2170342'
[13:21:56] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='SN' = 'SN, Skilled Nursing'
[13:21:56] ✅ Patient name cross-validation successful
[13:21:56] ✅    ✅ Data merged successfully
[13:21:57] ✅    ✅ Order data extracted and validated
[13:21:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:22:22] [DOC: 9314061] ✅ Patient exists in API: Joao Aguiar, ID: f41aab89-225a-480a-9b25-f9b0069dd743
[13:22:22] ✅    ✅ Existing patient found with ID: f41aab89-225a-480a-9b25-f9b0069dd743
[13:22:22] 🔄 
🔄 Step 6: Pushing order to API...
[13:22:22] [DOC: 9314061] ℹ️  Pushing order via API for patient ID: f41aab89-225a-480a-9b25-f9b0069dd743
[13:22:24] [DOC: 9314061] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD15776"}
[13:22:24] ❌    ❌ Failed to push order
[13:22:24] 🔄 
🔄 Step 7: Writing to CSV...
[13:22:24] [DOC: 9314061] ℹ️  Calculated age: 70 from DOB: 08/11/1954
[13:22:24] [DOC: 9314061] ℹ️  Service Line extracted: 'SN, Skilled Nursing'
[13:22:24] [DOC: 9314061] ℹ️  Payer Source extracted: ''
[13:22:24] [DOC: 9314061] ℹ️  Diagnosis codes being written:
[13:22:24] [DOC: 9314061] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:22:24] [DOC: 9314061] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:22:24] [DOC: 9314061] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:22:24] [DOC: 9314061] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:22:24] [DOC: 9314061] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:22:24] [DOC: 9314061] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:22:24] [DOC: 9314061] ✅ Patient data written to CSV: Joao Aguiar | Sex: MALE | Age: 70 | Service: SN, Skilled Nursing | Payer:  | MRN: 2170342
[13:22:24] ✅    ✅ Document 9314061 processed and saved successfully
[13:22:24] 🔄 
🔄 Step 8: Saving API details...
[13:22:24] [DOC: 9314061] ℹ️  API push details saved for document 9314061
[13:22:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9314058                         ║
================================================================================
[13:22:24] ℹ️  Agency: Fairhaven HH&H
[13:22:24] ℹ️  Date: 05/28/2025
[13:22:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:22:25] [DOC: 9314058] ❌ Critical failure in get_pdf_text: Invalid response format
[13:22:25] ❌ Failed to extract text for Doc ID 9314058
[13:22:25] [DOC: 9314058] ℹ️  API push details saved for document 9314058
================================================================================
║                        Processing Document ID: 9314050                         ║
================================================================================
[13:22:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:22:25] ℹ️  Date: 05/28/2025
[13:22:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:22:29] [DOC: 9314050] ✅ Text extracted using pdfplumber (14187 chars)
[13:22:29] ✅    ✅ Text extracted using pdfplumber (14187 chars)
[13:22:29] 🔄 
🔄 Step 2: Extracting patient data...
[13:22:32] ℹ️  AI extracted raw sex value: 'F'
[13:22:32] ℹ️  AI extracted service line: 'PT'
[13:22:32] ℹ️  AI extracted payer source: 'None'
[13:22:32] ℹ️  AI extracted diagnoses:
[13:22:32] ℹ️    - Diagnosis 1: 'I10'
[13:22:32] ℹ️    - Diagnosis 2: 'None'
[13:22:32] ℹ️    - Diagnosis 3: 'None'
[13:22:32] ℹ️    - Diagnosis 4: 'None'
[13:22:32] ℹ️    - Diagnosis 5: 'None'
[13:22:32] ℹ️    - Diagnosis 6: 'None'
[13:22:32] ℹ️  Final extracted MRN: 'MA210707054107'
[13:22:32] ℹ️  Final extracted Sex: 'FEMALE'
[13:22:32] ℹ️  Final extracted Service Line: 'PT'
[13:22:32] ℹ️  Final extracted Payer Source: ''
[13:22:32] ✅ Patient data extraction completed successfully
[13:22:32] ✅    ✅ Patient data extracted successfully
[13:22:32] 📊 Patient Response
     └─ patientFName: Carmen
     └─ patientLName: Nunes
     └─ dob: 05/24/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210707054107
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/19/2025', 'endOfEpisode': None, 'firstDiagnosis': 'I10', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:22:32] ✅    ✅ Patient identified: Carmen Nunes
[13:22:32] ✅    ✅ Patient name validation passed
[13:22:32] 🔄 
🔄 Step 3: Processing patient dates...
[13:22:32] [DOC: 9314050] ℹ️  DOB normalized: 05/24/1941
[13:22:32] [DOC: 9314050] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[13:22:32] [DOC: 9314050] ✅ Patient date processing completed successfully
[13:22:32] ✅    ✅ Date processing completed
[13:22:32] 📊 Processed Patient Data
     └─ patientFName: Carmen
     └─ patientLName: Nunes
     └─ dob: 05/24/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210707054107
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/19/2025', 'firstDiagnosis': 'I10'}]
[13:22:32] 🔄 
🔄 Step 4: Extracting order data...
[13:22:34] ℹ️  Order extraction - MRN: 'MA210707054107'
[13:22:34] ℹ️  Order extraction - Sex: 'FEMALE'
[13:22:34] ℹ️  Order extraction - Service Line: 'PT'
[13:22:34] ℹ️  Order extraction - Payer Source: ''
[13:22:34] ✅ Order data extraction completed successfully
[13:22:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:22:34] ℹ️  Using MRN from patient data: 'MA210707054107' over 'MA210707054107'
[13:22:34] ℹ️  Service line consistent in both sources: 'PT'
[13:22:34] ✅ Patient name cross-validation successful
[13:22:34] ✅    ✅ Data merged successfully
[13:22:35] ⚠️     ❌ Skipping - missing episode start date
[13:22:35] [DOC: 9314050] ℹ️  API push details saved for document 9314050
================================================================================
║                        Processing Document ID: 9313966                         ║
================================================================================
[13:22:35] ℹ️  Agency: Dartmouth HH
[13:22:35] ℹ️  Date: 05/28/2025
[13:22:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:22:37] [DOC: 9313966] ✅ Text extracted using pdfplumber (1785 chars)
[13:22:37] ✅    ✅ Text extracted using pdfplumber (1785 chars)
[13:22:37] 🔄 
🔄 Step 2: Extracting patient data...
[13:22:40] ℹ️  AI extracted raw sex value: 'M'
[13:22:40] ℹ️  AI extracted service line: 'PT'
[13:22:40] ℹ️  AI extracted payer source: 'Medicare'
[13:22:40] ℹ️  AI extracted diagnoses:
[13:22:40] ℹ️    - Diagnosis 1: 'None'
[13:22:40] ℹ️    - Diagnosis 2: 'None'
[13:22:40] ℹ️    - Diagnosis 3: 'None'
[13:22:40] ℹ️    - Diagnosis 4: 'None'
[13:22:40] ℹ️    - Diagnosis 5: 'None'
[13:22:40] ℹ️    - Diagnosis 6: 'None'
[13:22:40] ℹ️  Final extracted MRN: '3061015'
[13:22:40] ℹ️  Final extracted Sex: 'MALE'
[13:22:40] ℹ️  Final extracted Service Line: 'PT'
[13:22:40] ℹ️  Final extracted Payer Source: 'Medicare'
[13:22:40] ✅ Patient data extraction completed successfully
[13:22:40] ✅    ✅ Patient data extracted successfully
[13:22:40] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Conway
     └─ dob: 03/14/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3061015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/23/2025', 'startOfEpisode': None, 'endOfEpisode': '06/21/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:22:40] ✅    ✅ Patient identified: Joseph Conway
[13:22:40] ✅    ✅ Patient name validation passed
[13:22:40] 🔄 
🔄 Step 3: Processing patient dates...
[13:22:40] [DOC: 9313966] ℹ️  DOB normalized: 03/14/1939
[13:22:40] [DOC: 9313966] ℹ️  Episode startOfCare normalized: 04/23/2025
[13:22:40] [DOC: 9313966] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[13:22:40] [DOC: 9313966] ✅ Patient date processing completed successfully
[13:22:40] ✅    ✅ Date processing completed
[13:22:40] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Conway
     └─ dob: 03/14/1939
     └─ patientSex: MALE
     └─ medicalRecordNo: 3061015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/23/2025', 'endOfEpisode': '06/21/2025'}]
[13:22:40] 🔄 
🔄 Step 4: Extracting order data...
[13:22:42] ℹ️  Order extraction - MRN: '3061015'
[13:22:42] ℹ️  Order extraction - Sex: 'MALE'
[13:22:42] ℹ️  Order extraction - Service Line: 'PT'
[13:22:42] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:22:42] ✅ Order data extraction completed successfully
[13:22:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:22:42] ℹ️  Using MRN from patient data: '3061015' over '3061015'
[13:22:42] ℹ️  Service line consistent in both sources: 'PT'
[13:22:42] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:22:42] ✅ Patient name cross-validation successful
[13:22:42] ✅    ✅ Data merged successfully
[13:22:46] ✅    ✅ Order data extracted and validated
[13:22:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:22:51] [DOC: 9313966] ✅ Patient exists in API: Joseph Conway, ID: 1023d763-3745-400f-9349-d2ba1ce2dd40
[13:22:51] ✅    ✅ Existing patient found with ID: 1023d763-3745-400f-9349-d2ba1ce2dd40
[13:22:51] 🔄 
🔄 Step 6: Pushing order to API...
[13:22:51] [DOC: 9313966] ℹ️  Pushing order via API for patient ID: 1023d763-3745-400f-9349-d2ba1ce2dd40
[13:22:52] [DOC: 9313966] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:22:52] ❌    ❌ Failed to push order
[13:22:52] 🔄 
🔄 Step 7: Writing to CSV...
[13:22:52] [DOC: 9313966] ℹ️  Calculated age: 86 from DOB: 03/14/1939
[13:22:52] [DOC: 9313966] ℹ️  Service Line extracted: 'PT'
[13:22:52] [DOC: 9313966] ℹ️  Payer Source extracted: 'Medicare'
[13:22:52] [DOC: 9313966] ℹ️  Diagnosis codes being written:
[13:22:52] [DOC: 9313966] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:22:52] [DOC: 9313966] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:22:52] [DOC: 9313966] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:22:52] [DOC: 9313966] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:22:52] [DOC: 9313966] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:22:52] [DOC: 9313966] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:22:52] [DOC: 9313966] ✅ Patient data written to CSV: Joseph Conway | Sex: MALE | Age: 86 | Service: PT | Payer: Medicare | MRN: 3061015
[13:22:52] ✅    ✅ Document 9313966 processed and saved successfully
[13:22:52] 🔄 
🔄 Step 8: Saving API details...
[13:22:52] [DOC: 9313966] ℹ️  API push details saved for document 9313966
[13:22:52] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313961                         ║
================================================================================
[13:22:52] ℹ️  Agency: Dartmouth HH
[13:22:52] ℹ️  Date: 05/28/2025
[13:22:52] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:22:54] [DOC: 9313961] ✅ Text extracted using pdfplumber (4189 chars)
[13:22:54] ✅    ✅ Text extracted using pdfplumber (4189 chars)
[13:22:54] 🔄 
🔄 Step 2: Extracting patient data...
[13:22:57] ℹ️  AI extracted raw sex value: 'F'
[13:22:57] ℹ️  AI extracted service line: 'Physical Therapy'
[13:22:57] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[13:22:57] ℹ️  AI extracted diagnoses:
[13:22:57] ℹ️    - Diagnosis 1: ''
[13:22:57] ℹ️    - Diagnosis 2: ''
[13:22:57] ℹ️    - Diagnosis 3: ''
[13:22:57] ℹ️    - Diagnosis 4: ''
[13:22:57] ℹ️    - Diagnosis 5: ''
[13:22:57] ℹ️    - Diagnosis 6: ''
[13:22:57] ℹ️  Final extracted MRN: '667011'
[13:22:57] ℹ️  Final extracted Sex: 'FEMALE'
[13:22:57] ℹ️  Final extracted Service Line: 'Physical Therapy'
[13:22:57] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[13:22:57] ✅ Patient data extraction completed successfully
[13:22:57] ✅    ✅ Patient data extracted successfully
[13:22:57] 📊 Patient Response
     └─ patientFName: Linda
     └─ patientLName: Hotte
     └─ dob: 09/14/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 667011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '05/03/2025', 'startOfEpisode': '05/03/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:22:57] ✅    ✅ Patient identified: Linda Hotte
[13:22:57] ✅    ✅ Patient name validation passed
[13:22:57] 🔄 
🔄 Step 3: Processing patient dates...
[13:22:57] [DOC: 9313961] ℹ️  DOB normalized: 09/14/1952
[13:22:57] [DOC: 9313961] ℹ️  Episode startOfCare normalized: 05/03/2025
[13:22:57] [DOC: 9313961] ℹ️  Episode startOfEpisode normalized: 05/03/2025
[13:22:57] [DOC: 9313961] ℹ️  Episode endOfEpisode normalized: 07/01/2025
[13:22:57] [DOC: 9313961] ✅ Patient date processing completed successfully
[13:22:57] ✅    ✅ Date processing completed
[13:22:57] 📊 Processed Patient Data
     └─ patientFName: Linda
     └─ patientLName: Hotte
     └─ dob: 09/14/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 667011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Physical Therapy
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '05/03/2025', 'startOfEpisode': '05/03/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:22:57] 🔄 
🔄 Step 4: Extracting order data...
[13:22:59] ℹ️  Order extraction - MRN: ''
[13:22:59] ℹ️  Order extraction - Sex: 'FEMALE'
[13:22:59] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[13:22:59] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[13:22:59] ✅ Order data extraction completed successfully
[13:22:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:22:59] ℹ️  Using MRN from patient data: '667011'
[13:22:59] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[13:22:59] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[13:22:59] ✅ Patient name cross-validation successful
[13:22:59] ✅    ✅ Data merged successfully
[13:23:01] ✅    ✅ Order data extracted and validated
[13:23:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:23:06] [DOC: 9313961] ℹ️  Patient not found in cache or API: Linda Hotte
[13:23:06] [DOC: 9313961] ℹ️  Patient not found, creating new patient via API...
[13:23:06] [DOC: 9313961] ℹ️  Creating patient via API: Linda Hotte
[13:23:08] [DOC: 9313961] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:23:08] ❌    ❌ Failed to create patient
[13:23:08] [DOC: 9313961] ℹ️  API push details saved for document 9313961
================================================================================
║                        Processing Document ID: 9313952                         ║
================================================================================
[13:23:08] ℹ️  Agency: Dartmouth HH
[13:23:08] ℹ️  Date: 05/28/2025
[13:23:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:23:11] [DOC: 9313952] ✅ Text extracted using pdfplumber (21873 chars)
[13:23:11] ✅    ✅ Text extracted using pdfplumber (21861 chars)
[13:23:11] 🔄 
🔄 Step 2: Extracting patient data...
[13:23:14] ℹ️  AI extracted raw sex value: 'F'
[13:23:14] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[13:23:14] ℹ️  AI extracted payer source: 'None'
[13:23:14] ℹ️  AI extracted diagnoses:
[13:23:14] ℹ️    - Diagnosis 1: 'S72.141D'
[13:23:14] ℹ️    - Diagnosis 2: 'Z47.89'
[13:23:14] ℹ️    - Diagnosis 3: 'M20.41'
[13:23:14] ℹ️    - Diagnosis 4: 'G89.4'
[13:23:14] ℹ️    - Diagnosis 5: 'G47.33'
[13:23:14] ℹ️    - Diagnosis 6: 'F41.9'
[13:23:14] ℹ️  Final extracted MRN: '227027'
[13:23:14] ℹ️  Final extracted Sex: 'FEMALE'
[13:23:14] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[13:23:14] ℹ️  Final extracted Payer Source: ''
[13:23:14] ✅ Patient data extraction completed successfully
[13:23:14] ✅    ✅ Patient data extracted successfully
[13:23:14] 📊 Patient Response
     └─ patientFName: Brenda
     └─ patientLName: DuPont
     └─ dob: 11/19/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/08/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': 'S72.141D', 'secondDiagnosis': 'Z47.89', 'thirdDiagnosis': 'M20.41', 'fourthDiagnosis': 'G89.4', 'fifthDiagnosis': 'G47.33', 'sixthDiagnosis': 'F41.9'}]
[13:23:14] ✅    ✅ Patient identified: Brenda DuPont
[13:23:14] ✅    ✅ Patient name validation passed
[13:23:14] 🔄 
🔄 Step 3: Processing patient dates...
[13:23:14] [DOC: 9313952] ℹ️  DOB normalized: 11/19/1953
[13:23:14] [DOC: 9313952] ℹ️  Episode startOfCare normalized: 05/08/2025
[13:23:14] [DOC: 9313952] ℹ️  Episode startOfEpisode normalized: 05/08/2025
[13:23:14] [DOC: 9313952] ℹ️  Episode endOfEpisode normalized: 07/06/2025
[13:23:14] [DOC: 9313952] ✅ Patient date processing completed successfully
[13:23:14] ✅    ✅ Date processing completed
[13:23:14] 📊 Processed Patient Data
     └─ patientFName: Brenda
     └─ patientLName: DuPont
     └─ dob: 11/19/1953
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/08/2025', 'startOfEpisode': '05/08/2025', 'endOfEpisode': '07/06/2025', 'firstDiagnosis': 'S72.141D', 'secondDiagnosis': 'Z47.89', 'thirdDiagnosis': 'M20.41', 'fourthDiagnosis': 'G89.4', 'fifthDiagnosis': 'G47.33', 'sixthDiagnosis': 'F41.9'}]
[13:23:14] 🔄 
🔄 Step 4: Extracting order data...
[13:23:17] ℹ️  Order extraction - MRN: '6483015'
[13:23:17] ℹ️  Order extraction - Sex: 'FEMALE'
[13:23:17] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[13:23:17] ℹ️  Order extraction - Payer Source: ''
[13:23:17] ✅ Order data extraction completed successfully
[13:23:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:23:17] ℹ️  Using longer MRN from order data: '6483015' over '227027'
[13:23:17] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[13:23:17] ✅ Patient name cross-validation successful
[13:23:17] ✅    ✅ Data merged successfully
[13:23:18] ✅    ✅ Order data extracted and validated
[13:23:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:23:26] [DOC: 9313952] ✅ Patient exists in API: Brenda DuPont, ID: 053e29ff-76e5-4cbb-9231-16a13e232093
[13:23:26] ✅    ✅ Existing patient found with ID: 053e29ff-76e5-4cbb-9231-16a13e232093
[13:23:26] 🔄 
🔄 Step 6: Pushing order to API...
[13:23:26] [DOC: 9313952] ℹ️  Pushing order via API for patient ID: 053e29ff-76e5-4cbb-9231-16a13e232093
[13:23:27] [DOC: 9313952] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:23:27] ❌    ❌ Failed to push order
[13:23:27] 🔄 
🔄 Step 7: Writing to CSV...
[13:23:27] [DOC: 9313952] ℹ️  Calculated age: 71 from DOB: 11/19/1953
[13:23:27] [DOC: 9313952] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT'
[13:23:27] [DOC: 9313952] ℹ️  Payer Source extracted: ''
[13:23:27] [DOC: 9313952] ℹ️  Diagnosis codes being written:
[13:23:27] [DOC: 9313952] ℹ️    - Latest_Episode_Firstdiagnosis: 'S72.141D'
[13:23:27] [DOC: 9313952] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z47.89'
[13:23:27] [DOC: 9313952] ℹ️    - Latest_Episode_Thirddiagnosis: 'M20.41'
[13:23:27] [DOC: 9313952] ℹ️    - Latest_Episode_Fourthdiagnosis: 'G89.4'
[13:23:27] [DOC: 9313952] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G47.33'
[13:23:27] [DOC: 9313952] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[13:23:27] [DOC: 9313952] ✅ Patient data written to CSV: Brenda DuPont | Sex: FEMALE | Age: 71 | Service: Skilled Nursing, PT, OT | Payer:  | MRN: 6483015
[13:23:27] ✅    ✅ Document 9313952 processed and saved successfully
[13:23:27] 🔄 
🔄 Step 8: Saving API details...
[13:23:27] [DOC: 9313952] ℹ️  API push details saved for document 9313952
[13:23:27] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313947                         ║
================================================================================
[13:23:27] ℹ️  Agency: Dartmouth HH
[13:23:27] ℹ️  Date: 05/28/2025
[13:23:27] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:23:30] [DOC: 9313947] ✅ Text extracted using pdfplumber (9911 chars)
[13:23:30] ✅    ✅ Text extracted using pdfplumber (9899 chars)
[13:23:30] 🔄 
🔄 Step 2: Extracting patient data...
[13:23:34] ℹ️  AI extracted raw sex value: 'F'
[13:23:34] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy'
[13:23:34] ℹ️  AI extracted payer source: 'None'
[13:23:34] ℹ️  AI extracted diagnoses:
[13:23:34] ℹ️    - Diagnosis 1: 'G80.9'
[13:23:34] ℹ️    - Diagnosis 2: 'B37.2'
[13:23:34] ℹ️    - Diagnosis 3: 'G91.1'
[13:23:34] ℹ️    - Diagnosis 4: 'F79'
[13:23:34] ℹ️    - Diagnosis 5: 'K59.04'
[13:23:34] ℹ️    - Diagnosis 6: 'R13.12'
[13:23:34] ℹ️  Final extracted MRN: '227027'
[13:23:34] ℹ️  Final extracted Sex: 'FEMALE'
[13:23:34] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy'
[13:23:34] ℹ️  Final extracted Payer Source: ''
[13:23:34] ✅ Patient data extraction completed successfully
[13:23:34] ✅    ✅ Patient data extracted successfully
[13:23:34] 📊 Patient Response
     └─ patientFName: Kim
     └─ patientLName: Teixeira
     └─ dob: 02/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/18/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '07/16/2025', 'firstDiagnosis': 'G80.9', 'secondDiagnosis': 'B37.2', 'thirdDiagnosis': 'G91.1', 'fourthDiagnosis': 'F79', 'fifthDiagnosis': 'K59.04', 'sixthDiagnosis': 'R13.12'}]
[13:23:34] ✅    ✅ Patient identified: Kim Teixeira
[13:23:34] ✅    ✅ Patient name validation passed
[13:23:34] 🔄 
🔄 Step 3: Processing patient dates...
[13:23:34] [DOC: 9313947] ℹ️  DOB normalized: 02/28/1964
[13:23:34] [DOC: 9313947] ℹ️  Episode startOfCare normalized: 01/18/2025
[13:23:34] [DOC: 9313947] ℹ️  Episode startOfEpisode normalized: 01/18/2025
[13:23:34] [DOC: 9313947] ℹ️  Episode endOfEpisode normalized: 07/16/2025
[13:23:34] [DOC: 9313947] ✅ Patient date processing completed successfully
[13:23:34] ✅    ✅ Date processing completed
[13:23:34] 📊 Processed Patient Data
     └─ patientFName: Kim
     └─ patientLName: Teixeira
     └─ dob: 02/28/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '01/18/2025', 'startOfEpisode': '01/18/2025', 'endOfEpisode': '07/16/2025', 'firstDiagnosis': 'G80.9', 'secondDiagnosis': 'B37.2', 'thirdDiagnosis': 'G91.1', 'fourthDiagnosis': 'F79', 'fifthDiagnosis': 'K59.04', 'sixthDiagnosis': 'R13.12'}]
[13:23:34] 🔄 
🔄 Step 4: Extracting order data...
[13:23:36] ℹ️  Order extraction - MRN: '6448011'
[13:23:36] ℹ️  Order extraction - Sex: 'FEMALE'
[13:23:36] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Occupational Therapy'
[13:23:36] ℹ️  Order extraction - Payer Source: ''
[13:23:36] ✅ Order data extraction completed successfully
[13:23:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:23:36] ℹ️  Using longer MRN from order data: '6448011' over '227027'
[13:23:36] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Occupational Therapy'
[13:23:36] ✅ Patient name cross-validation successful
[13:23:36] ✅    ✅ Data merged successfully
[13:23:37] ✅    ✅ Order data extracted and validated
[13:23:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:23:50] [DOC: 9313947] ✅ Patient exists in API: Kim Teixeira, ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[13:23:50] ✅    ✅ Existing patient found with ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[13:23:50] 🔄 
🔄 Step 6: Pushing order to API...
[13:23:50] [DOC: 9313947] ℹ️  Pushing order via API for patient ID: 9397bc52-4356-4c77-975b-fb147e17bb37
[13:23:51] [DOC: 9313947] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:23:51] ❌    ❌ Failed to push order
[13:23:51] 🔄 
🔄 Step 7: Writing to CSV...
[13:23:51] [DOC: 9313947] ℹ️  Calculated age: 61 from DOB: 02/28/1964
[13:23:51] [DOC: 9313947] ℹ️  Service Line extracted: 'Skilled Nursing, Occupational Therapy'
[13:23:51] [DOC: 9313947] ℹ️  Payer Source extracted: ''
[13:23:51] [DOC: 9313947] ℹ️  Diagnosis codes being written:
[13:23:51] [DOC: 9313947] ℹ️    - Latest_Episode_Firstdiagnosis: 'G80.9'
[13:23:51] [DOC: 9313947] ℹ️    - Latest_Episode_Seconddiagnosis: 'B37.2'
[13:23:51] [DOC: 9313947] ℹ️    - Latest_Episode_Thirddiagnosis: 'G91.1'
[13:23:51] [DOC: 9313947] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F79'
[13:23:51] [DOC: 9313947] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K59.04'
[13:23:51] [DOC: 9313947] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R13.12'
[13:23:51] [DOC: 9313947] ✅ Patient data written to CSV: Kim Teixeira | Sex: FEMALE | Age: 61 | Service: Skilled Nursing, Occupational Therapy | Payer:  | MRN: 6448011
[13:23:51] ✅    ✅ Document 9313947 processed and saved successfully
[13:23:51] 🔄 
🔄 Step 8: Saving API details...
[13:23:51] [DOC: 9313947] ℹ️  API push details saved for document 9313947
[13:23:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313877                         ║
================================================================================
[13:23:51] ℹ️  Agency: Dartmouth HH
[13:23:51] ℹ️  Date: 05/28/2025
[13:23:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:23:56] [DOC: 9313877] ✅ Text extracted using pdfplumber (16204 chars)
[13:23:56] ✅    ✅ Text extracted using pdfplumber (16192 chars)
[13:23:56] 🔄 
🔄 Step 2: Extracting patient data...
[13:23:59] ℹ️  AI extracted raw sex value: 'F'
[13:23:59] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[13:23:59] ℹ️  AI extracted payer source: ''
[13:23:59] ℹ️  AI extracted diagnoses:
[13:23:59] ℹ️    - Diagnosis 1: 'C15.4'
[13:23:59] ℹ️    - Diagnosis 2: 'Z93.4'
[13:23:59] ℹ️    - Diagnosis 3: 'Z90.49'
[13:23:59] ℹ️    - Diagnosis 4: 'K21.9'
[13:23:59] ℹ️    - Diagnosis 5: 'R13.10'
[13:23:59] ℹ️    - Diagnosis 6: 'R63.4'
[13:23:59] ℹ️  Final extracted MRN: '6523015'
[13:23:59] ℹ️  Final extracted Sex: 'FEMALE'
[13:23:59] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[13:23:59] ℹ️  Final extracted Payer Source: ''
[13:23:59] ✅ Patient data extraction completed successfully
[13:23:59] ✅    ✅ Patient data extracted successfully
[13:23:59] 📊 Patient Response
     └─ patientFName: Dolores
     └─ patientLName: Hanson
     └─ dob: 11/26/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6523015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2025', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': 'C15.4', 'secondDiagnosis': 'Z93.4', 'thirdDiagnosis': 'Z90.49', 'fourthDiagnosis': 'K21.9', 'fifthDiagnosis': 'R13.10', 'sixthDiagnosis': 'R63.4'}]
[13:23:59] ✅    ✅ Patient identified: Dolores Hanson
[13:23:59] ✅    ✅ Patient name validation passed
[13:23:59] 🔄 
🔄 Step 3: Processing patient dates...
[13:23:59] [DOC: 9313877] ℹ️  DOB normalized: 11/26/1931
[13:23:59] [DOC: 9313877] ℹ️  Episode startOfCare normalized: 05/21/2025
[13:23:59] [DOC: 9313877] ℹ️  Episode startOfEpisode normalized: 05/21/2025
[13:23:59] [DOC: 9313877] ℹ️  Episode endOfEpisode normalized: 07/19/2025
[13:23:59] [DOC: 9313877] ✅ Patient date processing completed successfully
[13:23:59] ✅    ✅ Date processing completed
[13:23:59] 📊 Processed Patient Data
     └─ patientFName: Dolores
     └─ patientLName: Hanson
     └─ dob: 11/26/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6523015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2025', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': 'C15.4', 'secondDiagnosis': 'Z93.4', 'thirdDiagnosis': 'Z90.49', 'fourthDiagnosis': 'K21.9', 'fifthDiagnosis': 'R13.10', 'sixthDiagnosis': 'R63.4'}]
[13:23:59] 🔄 
🔄 Step 4: Extracting order data...
[13:24:02] ℹ️  Order extraction - MRN: '6523015'
[13:24:02] ℹ️  Order extraction - Sex: 'FEMALE'
[13:24:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[13:24:02] ℹ️  Order extraction - Payer Source: ''
[13:24:02] ✅ Order data extraction completed successfully
[13:24:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:24:02] ℹ️  Using MRN from patient data: '6523015' over '6523015'
[13:24:02] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT'
[13:24:02] ✅ Patient name cross-validation successful
[13:24:02] ✅    ✅ Data merged successfully
[13:24:04] ✅    ✅ Order data extracted and validated
[13:24:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:24:04] [DOC: 9313877] ✅ Patient found in local cache: Dolores Hanson, ID: dd622d4d-efdc-446e-8265-00fae76c09a4
[13:24:04] ✅    ✅ Existing patient found with ID: dd622d4d-efdc-446e-8265-00fae76c09a4
[13:24:04] 🔄 
🔄 Step 6: Pushing order to API...
[13:24:04] [DOC: 9313877] ℹ️  Pushing order via API for patient ID: dd622d4d-efdc-446e-8265-00fae76c09a4
[13:24:05] [DOC: 9313877] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:24:05] ❌    ❌ Failed to push order
[13:24:05] 🔄 
🔄 Step 7: Writing to CSV...
[13:24:05] [DOC: 9313877] ℹ️  Calculated age: 93 from DOB: 11/26/1931
[13:24:05] [DOC: 9313877] ℹ️  Service Line extracted: 'Skilled Nursing, PT'
[13:24:05] [DOC: 9313877] ℹ️  Payer Source extracted: ''
[13:24:05] [DOC: 9313877] ℹ️  Diagnosis codes being written:
[13:24:05] [DOC: 9313877] ℹ️    - Latest_Episode_Firstdiagnosis: 'C15.4'
[13:24:05] [DOC: 9313877] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z93.4'
[13:24:05] [DOC: 9313877] ℹ️    - Latest_Episode_Thirddiagnosis: 'Z90.49'
[13:24:05] [DOC: 9313877] ℹ️    - Latest_Episode_Fourthdiagnosis: 'K21.9'
[13:24:05] [DOC: 9313877] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R13.10'
[13:24:05] [DOC: 9313877] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R63.4'
[13:24:05] [DOC: 9313877] ✅ Patient data written to CSV: Dolores Hanson | Sex: FEMALE | Age: 93 | Service: Skilled Nursing, PT | Payer:  | MRN: 6523015
[13:24:05] ✅    ✅ Document 9313877 processed and saved successfully
[13:24:05] 🔄 
🔄 Step 8: Saving API details...
[13:24:05] [DOC: 9313877] ℹ️  API push details saved for document 9313877
[13:24:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313874                         ║
================================================================================
[13:24:05] ℹ️  Agency: Dartmouth HH
[13:24:05] ℹ️  Date: 05/28/2025
[13:24:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:24:07] [DOC: 9313874] ✅ Text extracted using pdfplumber (2128 chars)
[13:24:07] ✅    ✅ Text extracted using pdfplumber (2128 chars)
[13:24:07] 🔄 
🔄 Step 2: Extracting patient data...
[13:24:10] ℹ️  AI extracted raw sex value: 'F'
[13:24:10] ℹ️  AI extracted service line: 'RN'
[13:24:10] ℹ️  AI extracted payer source: 'Medicare'
[13:24:10] ℹ️  AI extracted diagnoses:
[13:24:10] ℹ️    - Diagnosis 1: ''
[13:24:10] ℹ️    - Diagnosis 2: ''
[13:24:10] ℹ️    - Diagnosis 3: ''
[13:24:10] ℹ️    - Diagnosis 4: ''
[13:24:10] ℹ️    - Diagnosis 5: ''
[13:24:10] ℹ️    - Diagnosis 6: ''
[13:24:10] ℹ️  Final extracted MRN: '5094015'
[13:24:10] ℹ️  Final extracted Sex: 'FEMALE'
[13:24:10] ℹ️  Final extracted Service Line: 'RN'
[13:24:10] ℹ️  Final extracted Payer Source: 'Medicare'
[13:24:10] ✅ Patient data extraction completed successfully
[13:24:10] ✅    ✅ Patient data extracted successfully
[13:24:10] 📊 Patient Response
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:24:10] ✅    ✅ Patient identified: Laura Gregoire
[13:24:10] ✅    ✅ Patient name validation passed
[13:24:10] 🔄 
🔄 Step 3: Processing patient dates...
[13:24:10] [DOC: 9313874] ℹ️  DOB normalized: 12/06/1944
[13:24:10] [DOC: 9313874] ℹ️  Episode startOfCare normalized: 08/26/2024
[13:24:10] [DOC: 9313874] ℹ️  Episode startOfEpisode normalized: 04/23/2025
[13:24:10] [DOC: 9313874] ℹ️  Episode endOfEpisode normalized: 06/21/2025
[13:24:10] [DOC: 9313874] ✅ Patient date processing completed successfully
[13:24:10] ✅    ✅ Date processing completed
[13:24:10] 📊 Processed Patient Data
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '04/23/2025', 'endOfEpisode': '06/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:24:10] 🔄 
🔄 Step 4: Extracting order data...
[13:24:12] ℹ️  Order extraction - MRN: '5094015'
[13:24:12] ℹ️  Order extraction - Sex: 'FEMALE'
[13:24:12] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:24:12] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:24:12] ✅ Order data extraction completed successfully
[13:24:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:24:12] ℹ️  Using MRN from patient data: '5094015' over '5094015'
[13:24:12] ℹ️  Combined service lines: Patient='RN' + Order='Skilled Nursing' = 'RN, Skilled Nursing'
[13:24:12] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:24:12] ✅ Patient name cross-validation successful
[13:24:12] ✅    ✅ Data merged successfully
[13:24:13] ✅    ✅ Order data extracted and validated
[13:24:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:24:31] [DOC: 9313874] ✅ Patient exists in API: Laura Gregoire, ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[13:24:31] ✅    ✅ Existing patient found with ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[13:24:31] 🔄 
🔄 Step 6: Pushing order to API...
[13:24:31] [DOC: 9313874] ℹ️  Pushing order via API for patient ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[13:24:32] [DOC: 9313874] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:24:32] ❌    ❌ Failed to push order
[13:24:32] 🔄 
🔄 Step 7: Writing to CSV...
[13:24:32] [DOC: 9313874] ℹ️  Calculated age: 80 from DOB: 12/06/1944
[13:24:32] [DOC: 9313874] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[13:24:32] [DOC: 9313874] ℹ️  Payer Source extracted: 'Medicare'
[13:24:32] [DOC: 9313874] ℹ️  Diagnosis codes being written:
[13:24:32] [DOC: 9313874] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:24:32] [DOC: 9313874] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:24:32] [DOC: 9313874] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:24:32] [DOC: 9313874] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:24:32] [DOC: 9313874] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:24:32] [DOC: 9313874] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:24:32] [DOC: 9313874] ✅ Patient data written to CSV: Laura Gregoire | Sex: FEMALE | Age: 80 | Service: RN, Skilled Nursing | Payer: Medicare | MRN: 5094015
[13:24:32] ✅    ✅ Document 9313874 processed and saved successfully
[13:24:32] 🔄 
🔄 Step 8: Saving API details...
[13:24:32] [DOC: 9313874] ℹ️  API push details saved for document 9313874
[13:24:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313870                         ║
================================================================================
[13:24:32] ℹ️  Agency: Dartmouth HH
[13:24:32] ℹ️  Date: 05/28/2025
[13:24:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:24:34] [DOC: 9313870] ✅ Text extracted using pdfplumber (6318 chars)
[13:24:34] ✅    ✅ Text extracted using pdfplumber (6318 chars)
[13:24:34] 🔄 
🔄 Step 2: Extracting patient data...
[13:24:37] ℹ️  AI extracted raw sex value: 'F'
[13:24:37] ℹ️  AI extracted service line: 'OT'
[13:24:37] ℹ️  AI extracted payer source: 'Medicare'
[13:24:37] ℹ️  AI extracted diagnoses:
[13:24:37] ℹ️    - Diagnosis 1: ''
[13:24:37] ℹ️    - Diagnosis 2: ''
[13:24:37] ℹ️    - Diagnosis 3: ''
[13:24:37] ℹ️    - Diagnosis 4: ''
[13:24:37] ℹ️    - Diagnosis 5: ''
[13:24:37] ℹ️    - Diagnosis 6: ''
[13:24:37] ℹ️  Final extracted MRN: '1259001'
[13:24:37] ℹ️  Final extracted Sex: 'FEMALE'
[13:24:37] ℹ️  Final extracted Service Line: 'OT'
[13:24:37] ℹ️  Final extracted Payer Source: 'Medicare'
[13:24:37] ✅ Patient data extraction completed successfully
[13:24:37] ✅    ✅ Patient data extracted successfully
[13:24:37] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Lombardo
     └─ dob: 02/21/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1259001
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/12/2025', 'startOfEpisode': '05/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:24:37] ✅    ✅ Patient identified: Barbara Lombardo
[13:24:37] ✅    ✅ Patient name validation passed
[13:24:37] 🔄 
🔄 Step 3: Processing patient dates...
[13:24:37] [DOC: 9313870] ℹ️  DOB normalized: 02/21/1941
[13:24:37] [DOC: 9313870] ℹ️  Episode startOfCare normalized: 05/12/2025
[13:24:37] [DOC: 9313870] ℹ️  Episode startOfEpisode normalized: 05/12/2025
[13:24:37] [DOC: 9313870] ℹ️  Episode endOfEpisode normalized: 07/10/2025
[13:24:37] [DOC: 9313870] ✅ Patient date processing completed successfully
[13:24:37] ✅    ✅ Date processing completed
[13:24:37] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Lombardo
     └─ dob: 02/21/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1259001
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/12/2025', 'startOfEpisode': '05/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:24:37] 🔄 
🔄 Step 4: Extracting order data...
[13:24:40] ℹ️  Order extraction - MRN: ''
[13:24:40] ℹ️  Order extraction - Sex: 'FEMALE'
[13:24:40] ℹ️  Order extraction - Service Line: 'OT'
[13:24:40] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:24:40] ✅ Order data extraction completed successfully
[13:24:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:24:40] ℹ️  Using MRN from patient data: '1259001'
[13:24:40] ℹ️  Service line consistent in both sources: 'OT'
[13:24:40] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:24:40] ✅ Patient name cross-validation successful
[13:24:40] ✅    ✅ Data merged successfully
[13:24:41] ✅    ✅ Order data extracted and validated
[13:24:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:24:50] [DOC: 9313870] ✅ Patient exists in API: Barbara Lombardo, ID: e8867258-532b-4def-bc9b-3913c67672c2
[13:24:50] ✅    ✅ Existing patient found with ID: e8867258-532b-4def-bc9b-3913c67672c2
[13:24:50] 🔄 
🔄 Step 6: Pushing order to API...
[13:24:50] [DOC: 9313870] ℹ️  Pushing order via API for patient ID: e8867258-532b-4def-bc9b-3913c67672c2
[13:24:51] [DOC: 9313870] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16515"}
[13:24:51] ❌    ❌ Failed to push order
[13:24:51] 🔄 
🔄 Step 7: Writing to CSV...
[13:24:51] [DOC: 9313870] ℹ️  Calculated age: 84 from DOB: 02/21/1941
[13:24:51] [DOC: 9313870] ℹ️  Service Line extracted: 'OT'
[13:24:51] [DOC: 9313870] ℹ️  Payer Source extracted: 'Medicare'
[13:24:51] [DOC: 9313870] ℹ️  Diagnosis codes being written:
[13:24:51] [DOC: 9313870] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:24:51] [DOC: 9313870] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:24:51] [DOC: 9313870] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:24:51] [DOC: 9313870] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:24:51] [DOC: 9313870] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:24:51] [DOC: 9313870] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:24:51] [DOC: 9313870] ✅ Patient data written to CSV: Barbara Lombardo | Sex: FEMALE | Age: 84 | Service: OT | Payer: Medicare | MRN: 1259001
[13:24:51] ✅    ✅ Document 9313870 processed and saved successfully
[13:24:51] 🔄 
🔄 Step 8: Saving API details...
[13:24:51] [DOC: 9313870] ℹ️  API push details saved for document 9313870
[13:24:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313869                         ║
================================================================================
[13:24:51] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[13:24:51] ℹ️  Date: 05/28/2025
[13:24:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:24:54] [DOC: 9313869] ✅ Text extracted using pdfplumber (10391 chars)
[13:24:54] ✅    ✅ Text extracted using pdfplumber (10391 chars)
[13:24:54] 🔄 
🔄 Step 2: Extracting patient data...
[13:24:57] ℹ️  AI extracted raw sex value: 'F'
[13:24:57] ℹ️  AI extracted service line: 'OT'
[13:24:57] ℹ️  AI extracted payer source: 'None'
[13:24:57] ℹ️  AI extracted diagnoses:
[13:24:57] ℹ️    - Diagnosis 1: 'closed nasal bone fracture, forehead laceration'
[13:24:57] ℹ️    - Diagnosis 2: 'muscle weakness'
[13:24:57] ℹ️    - Diagnosis 3: 'None'
[13:24:57] ℹ️    - Diagnosis 4: 'None'
[13:24:57] ℹ️    - Diagnosis 5: 'None'
[13:24:57] ℹ️    - Diagnosis 6: 'None'
[13:24:57] ℹ️  Final extracted MRN: 'MA241009113701'
[13:24:57] ℹ️  Final extracted Sex: 'FEMALE'
[13:24:57] ℹ️  Final extracted Service Line: 'OT'
[13:24:57] ℹ️  Final extracted Payer Source: ''
[13:24:57] ✅ Patient data extraction completed successfully
[13:24:57] ✅    ✅ Patient data extracted successfully
[13:24:57] 📊 Patient Response
     └─ patientFName: Maria Ines
     └─ patientLName: Figueiredo
     └─ dob: 11/11/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241009113701
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/26/2025', 'endOfEpisode': None, 'firstDiagnosis': 'closed nasal bone fracture, forehead laceration', 'secondDiagnosis': 'muscle weakness', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:24:57] ✅    ✅ Patient identified: Maria Ines Figueiredo
[13:24:57] ✅    ✅ Patient name validation passed
[13:24:57] 🔄 
🔄 Step 3: Processing patient dates...
[13:24:57] [DOC: 9313869] ℹ️  DOB normalized: 11/11/1937
[13:24:57] [DOC: 9313869] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[13:24:57] [DOC: 9313869] ✅ Patient date processing completed successfully
[13:24:57] ✅    ✅ Date processing completed
[13:24:57] 📊 Processed Patient Data
     └─ patientFName: Maria Ines
     └─ patientLName: Figueiredo
     └─ dob: 11/11/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241009113701
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/26/2025', 'firstDiagnosis': 'closed nasal bone fracture, forehead laceration', 'secondDiagnosis': 'muscle weakness'}]
[13:24:57] 🔄 
🔄 Step 4: Extracting order data...
[13:24:59] ℹ️  Order extraction - MRN: 'MA241009113701'
[13:24:59] ℹ️  Order extraction - Sex: 'FEMALE'
[13:24:59] ℹ️  Order extraction - Service Line: 'OT'
[13:24:59] ℹ️  Order extraction - Payer Source: ''
[13:24:59] ✅ Order data extraction completed successfully
[13:24:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:24:59] ℹ️  Using MRN from patient data: 'MA241009113701' over 'MA241009113701'
[13:24:59] ℹ️  Service line consistent in both sources: 'OT'
[13:24:59] ✅ Patient name cross-validation successful
[13:24:59] ✅    ✅ Data merged successfully
[13:25:01] ✅    ✅ Order data extracted and validated
[13:25:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:25:09] [DOC: 9313869] ✅ Patient exists in API: Maria Ines Figueiredo, ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[13:25:09] ✅    ✅ Existing patient found with ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[13:25:09] 🔄 
🔄 Step 6: Pushing order to API...
[13:25:09] [DOC: 9313869] ℹ️  Pushing order via API for patient ID: 57618296-ffc6-495c-8791-4a304f9a4aba
[13:25:10] [DOC: 9313869] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:25:10] ❌    ❌ Failed to push order
[13:25:10] 🔄 
🔄 Step 7: Writing to CSV...
[13:25:10] [DOC: 9313869] ℹ️  Calculated age: 87 from DOB: 11/11/1937
[13:25:10] [DOC: 9313869] ℹ️  Service Line extracted: 'OT'
[13:25:10] [DOC: 9313869] ℹ️  Payer Source extracted: ''
[13:25:10] [DOC: 9313869] ℹ️  Diagnosis codes being written:
[13:25:10] [DOC: 9313869] ℹ️    - Latest_Episode_Firstdiagnosis: 'closed nasal bone fracture, forehead laceration'
[13:25:10] [DOC: 9313869] ℹ️    - Latest_Episode_Seconddiagnosis: 'muscle weakness'
[13:25:10] [DOC: 9313869] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:25:10] [DOC: 9313869] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:25:10] [DOC: 9313869] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:25:10] [DOC: 9313869] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:25:10] [DOC: 9313869] ✅ Patient data written to CSV: Maria Ines Figueiredo | Sex: FEMALE | Age: 87 | Service: OT | Payer:  | MRN: MA241009113701
[13:25:10] ✅    ✅ Document 9313869 processed and saved successfully
[13:25:10] 🔄 
🔄 Step 8: Saving API details...
[13:25:10] [DOC: 9313869] ℹ️  API push details saved for document 9313869
[13:25:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313868                         ║
================================================================================
[13:25:10] ℹ️  Agency: Dartmouth HH
[13:25:10] ℹ️  Date: 05/28/2025
[13:25:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:25:11] [DOC: 9313868] ✅ Text extracted using pdfplumber (2641 chars)
[13:25:11] ✅    ✅ Text extracted using pdfplumber (2641 chars)
[13:25:11] 🔄 
🔄 Step 2: Extracting patient data...
[13:25:14] ℹ️  AI extracted raw sex value: 'M'
[13:25:14] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:25:14] ℹ️  AI extracted payer source: 'Medicare'
[13:25:14] ℹ️  AI extracted diagnoses:
[13:25:14] ℹ️    - Diagnosis 1: ''
[13:25:14] ℹ️    - Diagnosis 2: ''
[13:25:14] ℹ️    - Diagnosis 3: ''
[13:25:14] ℹ️    - Diagnosis 4: ''
[13:25:14] ℹ️    - Diagnosis 5: ''
[13:25:14] ℹ️    - Diagnosis 6: ''
[13:25:14] ℹ️  Final extracted MRN: '6506015'
[13:25:14] ℹ️  Final extracted Sex: 'MALE'
[13:25:14] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:25:14] ℹ️  Final extracted Payer Source: 'Medicare'
[13:25:14] ✅ Patient data extraction completed successfully
[13:25:14] ✅    ✅ Patient data extracted successfully
[13:25:14] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Costa
     └─ dob: 09/13/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 6506015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/09/2025', 'startOfEpisode': '05/09/2025', 'endOfEpisode': '07/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:25:14] ✅    ✅ Patient identified: Raymond Costa
[13:25:14] ✅    ✅ Patient name validation passed
[13:25:14] 🔄 
🔄 Step 3: Processing patient dates...
[13:25:14] [DOC: 9313868] ℹ️  DOB normalized: 09/13/1950
[13:25:14] [DOC: 9313868] ℹ️  Episode startOfCare normalized: 05/09/2025
[13:25:14] [DOC: 9313868] ℹ️  Episode startOfEpisode normalized: 05/09/2025
[13:25:14] [DOC: 9313868] ℹ️  Episode endOfEpisode normalized: 07/07/2025
[13:25:14] [DOC: 9313868] ✅ Patient date processing completed successfully
[13:25:14] ✅    ✅ Date processing completed
[13:25:14] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Costa
     └─ dob: 09/13/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 6506015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/09/2025', 'startOfEpisode': '05/09/2025', 'endOfEpisode': '07/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:25:14] 🔄 
🔄 Step 4: Extracting order data...
[13:25:16] ℹ️  Order extraction - MRN: ''
[13:25:16] ℹ️  Order extraction - Sex: 'MALE'
[13:25:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:25:16] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:25:16] ✅ Order data extraction completed successfully
[13:25:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:25:16] ℹ️  Using MRN from patient data: '6506015'
[13:25:16] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:25:16] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:25:16] ✅ Patient name cross-validation successful
[13:25:16] ✅    ✅ Data merged successfully
[13:25:18] ✅    ✅ Order data extracted and validated
[13:25:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:25:37] [DOC: 9313868] ✅ Patient exists in API: Raymond Costa, ID: 710e055b-3f3f-40d2-8aac-60e4838c1b54
[13:25:37] ✅    ✅ Existing patient found with ID: 710e055b-3f3f-40d2-8aac-60e4838c1b54
[13:25:37] 🔄 
🔄 Step 6: Pushing order to API...
[13:25:37] [DOC: 9313868] ℹ️  Pushing order via API for patient ID: 710e055b-3f3f-40d2-8aac-60e4838c1b54
[13:25:38] [DOC: 9313868] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:25:38] ❌    ❌ Failed to push order
[13:25:38] 🔄 
🔄 Step 7: Writing to CSV...
[13:25:38] [DOC: 9313868] ℹ️  Calculated age: 74 from DOB: 09/13/1950
[13:25:38] [DOC: 9313868] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:25:38] [DOC: 9313868] ℹ️  Payer Source extracted: 'Medicare'
[13:25:38] [DOC: 9313868] ℹ️  Diagnosis codes being written:
[13:25:38] [DOC: 9313868] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:25:38] [DOC: 9313868] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:25:38] [DOC: 9313868] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:25:38] [DOC: 9313868] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:25:38] [DOC: 9313868] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:25:38] [DOC: 9313868] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:25:38] [DOC: 9313868] ✅ Patient data written to CSV: Raymond Costa | Sex: MALE | Age: 74 | Service: Skilled Nursing | Payer: Medicare | MRN: 6506015
[13:25:38] ✅    ✅ Document 9313868 processed and saved successfully
[13:25:38] 🔄 
🔄 Step 8: Saving API details...
[13:25:38] [DOC: 9313868] ℹ️  API push details saved for document 9313868
[13:25:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313860                         ║
================================================================================
[13:25:38] ℹ️  Agency: Dartmouth HH
[13:25:38] ℹ️  Date: 05/28/2025
[13:25:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:25:41] [DOC: 9313860] ✅ Text extracted using pdfplumber (11720 chars)
[13:25:41] ✅    ✅ Text extracted using pdfplumber (11708 chars)
[13:25:41] 🔄 
🔄 Step 2: Extracting patient data...
[13:25:44] ℹ️  AI extracted raw sex value: 'M'
[13:25:44] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:25:44] ℹ️  AI extracted payer source: ''
[13:25:44] ℹ️  AI extracted diagnoses:
[13:25:44] ℹ️    - Diagnosis 1: 'L02.213'
[13:25:44] ℹ️    - Diagnosis 2: 'I69.341'
[13:25:44] ℹ️    - Diagnosis 3: 'I69.315'
[13:25:44] ℹ️    - Diagnosis 4: 'I25.10'
[13:25:44] ℹ️    - Diagnosis 5: 'I12.9'
[13:25:44] ℹ️    - Diagnosis 6: 'N18.2'
[13:25:44] ℹ️  Final extracted MRN: '6506015'
[13:25:44] ℹ️  Final extracted Sex: 'MALE'
[13:25:44] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:25:44] ℹ️  Final extracted Payer Source: ''
[13:25:44] ✅ Patient data extraction completed successfully
[13:25:44] ✅    ✅ Patient data extracted successfully
[13:25:44] 📊 Patient Response
     └─ patientFName: Raymond
     └─ patientLName: Costa
     └─ dob: 09/13/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 6506015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/09/2025', 'startOfEpisode': '05/09/2025', 'endOfEpisode': '07/07/2025', 'firstDiagnosis': 'L02.213', 'secondDiagnosis': 'I69.341', 'thirdDiagnosis': 'I69.315', 'fourthDiagnosis': 'I25.10', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.2'}]
[13:25:44] ✅    ✅ Patient identified: Raymond Costa
[13:25:44] ✅    ✅ Patient name validation passed
[13:25:44] 🔄 
🔄 Step 3: Processing patient dates...
[13:25:44] [DOC: 9313860] ℹ️  DOB normalized: 09/13/1950
[13:25:44] [DOC: 9313860] ℹ️  Episode startOfCare normalized: 05/09/2025
[13:25:44] [DOC: 9313860] ℹ️  Episode startOfEpisode normalized: 05/09/2025
[13:25:44] [DOC: 9313860] ℹ️  Episode endOfEpisode normalized: 07/07/2025
[13:25:44] [DOC: 9313860] ✅ Patient date processing completed successfully
[13:25:44] ✅    ✅ Date processing completed
[13:25:44] 📊 Processed Patient Data
     └─ patientFName: Raymond
     └─ patientLName: Costa
     └─ dob: 09/13/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 6506015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/09/2025', 'startOfEpisode': '05/09/2025', 'endOfEpisode': '07/07/2025', 'firstDiagnosis': 'L02.213', 'secondDiagnosis': 'I69.341', 'thirdDiagnosis': 'I69.315', 'fourthDiagnosis': 'I25.10', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.2'}]
[13:25:44] 🔄 
🔄 Step 4: Extracting order data...
[13:25:46] ℹ️  Order extraction - MRN: '6506015'
[13:25:46] ℹ️  Order extraction - Sex: 'MALE'
[13:25:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[13:25:46] ℹ️  Order extraction - Payer Source: ''
[13:25:46] ✅ Order data extraction completed successfully
[13:25:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:25:46] ℹ️  Using MRN from patient data: '6506015' over '6506015'
[13:25:46] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='Skilled Nursing, PT' = 'PT, Skilled Nursing'
[13:25:46] ✅ Patient name cross-validation successful
[13:25:46] ✅    ✅ Data merged successfully
[13:25:48] ✅    ✅ Order data extracted and validated
[13:25:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:25:48] [DOC: 9313860] ✅ Patient found in local cache: Raymond Costa, ID: 710e055b-3f3f-40d2-8aac-60e4838c1b54
[13:25:48] ✅    ✅ Existing patient found with ID: 710e055b-3f3f-40d2-8aac-60e4838c1b54
[13:25:48] 🔄 
🔄 Step 6: Pushing order to API...
[13:25:48] [DOC: 9313860] ℹ️  Pushing order via API for patient ID: 710e055b-3f3f-40d2-8aac-60e4838c1b54
[13:25:49] [DOC: 9313860] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:25:49] ❌    ❌ Failed to push order
[13:25:49] 🔄 
🔄 Step 7: Writing to CSV...
[13:25:49] [DOC: 9313860] ℹ️  Calculated age: 74 from DOB: 09/13/1950
[13:25:49] [DOC: 9313860] ℹ️  Service Line extracted: 'PT, Skilled Nursing'
[13:25:49] [DOC: 9313860] ℹ️  Payer Source extracted: ''
[13:25:49] [DOC: 9313860] ℹ️  Diagnosis codes being written:
[13:25:49] [DOC: 9313860] ℹ️    - Latest_Episode_Firstdiagnosis: 'L02.213'
[13:25:49] [DOC: 9313860] ℹ️    - Latest_Episode_Seconddiagnosis: 'I69.341'
[13:25:49] [DOC: 9313860] ℹ️    - Latest_Episode_Thirddiagnosis: 'I69.315'
[13:25:49] [DOC: 9313860] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I25.10'
[13:25:49] [DOC: 9313860] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I12.9'
[13:25:49] [DOC: 9313860] ℹ️    - Latest_Episode_Sixthdiagnosis: 'N18.2'
[13:25:49] [DOC: 9313860] ✅ Patient data written to CSV: Raymond Costa | Sex: MALE | Age: 74 | Service: PT, Skilled Nursing | Payer:  | MRN: 6506015
[13:25:49] ✅    ✅ Document 9313860 processed and saved successfully
[13:25:49] 🔄 
🔄 Step 8: Saving API details...
[13:25:49] [DOC: 9313860] ℹ️  API push details saved for document 9313860
[13:25:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313854                         ║
================================================================================
[13:25:49] ℹ️  Agency: Dartmouth HH
[13:25:49] ℹ️  Date: 05/28/2025
[13:25:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:25:51] [DOC: 9313854] ✅ Text extracted using pdfplumber (1363 chars)
[13:25:51] ✅    ✅ Text extracted using pdfplumber (1363 chars)
[13:25:51] 🔄 
🔄 Step 2: Extracting patient data...
[13:25:53] ℹ️  AI extracted raw sex value: 'M'
[13:25:53] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:25:53] ℹ️  AI extracted payer source: 'Medicare'
[13:25:53] ℹ️  AI extracted diagnoses:
[13:25:53] ℹ️    - Diagnosis 1: ''
[13:25:53] ℹ️    - Diagnosis 2: ''
[13:25:53] ℹ️    - Diagnosis 3: ''
[13:25:53] ℹ️    - Diagnosis 4: ''
[13:25:53] ℹ️    - Diagnosis 5: ''
[13:25:53] ℹ️    - Diagnosis 6: ''
[13:25:53] ℹ️  Final extracted MRN: '1661011'
[13:25:53] ℹ️  Final extracted Sex: 'MALE'
[13:25:53] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:25:53] ℹ️  Final extracted Payer Source: 'Medicare'
[13:25:53] ✅ Patient data extraction completed successfully
[13:25:53] ✅    ✅ Patient data extracted successfully
[13:25:53] 📊 Patient Response
     └─ patientFName: William
     └─ patientLName: Wilson
     └─ dob: 02/15/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 1661011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 54 Duncan St Apt 1W
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/20/2025', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:25:53] ✅    ✅ Patient identified: William Wilson
[13:25:53] ✅    ✅ Patient name validation passed
[13:25:53] 🔄 
🔄 Step 3: Processing patient dates...
[13:25:53] [DOC: 9313854] ℹ️  DOB normalized: 02/15/1953
[13:25:53] [DOC: 9313854] ℹ️  Episode startOfCare normalized: 04/20/2025
[13:25:53] [DOC: 9313854] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[13:25:53] [DOC: 9313854] ℹ️  Episode endOfEpisode normalized: 06/18/2025
[13:25:53] [DOC: 9313854] ✅ Patient date processing completed successfully
[13:25:53] ✅    ✅ Date processing completed
[13:25:53] 📊 Processed Patient Data
     └─ patientFName: William
     └─ patientLName: Wilson
     └─ dob: 02/15/1953
     └─ patientSex: MALE
     └─ medicalRecordNo: 1661011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 54 Duncan St Apt 1W
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/20/2025', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:25:53] 🔄 
🔄 Step 4: Extracting order data...
[13:25:56] ℹ️  Order extraction - MRN: ''
[13:25:56] ℹ️  Order extraction - Sex: 'MALE'
[13:25:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:25:56] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:25:56] ✅ Order data extraction completed successfully
[13:25:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:25:56] ℹ️  Using MRN from patient data: '1661011'
[13:25:56] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:25:56] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:25:56] ✅ Patient name cross-validation successful
[13:25:56] ✅    ✅ Data merged successfully
[13:25:57] ✅    ✅ Order data extracted and validated
[13:25:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:26:04] [DOC: 9313854] ✅ Patient exists in API: William Wilson, ID: fd08612d-dfc9-47e5-b4d9-7cd1e7bb95c0
[13:26:04] ✅    ✅ Existing patient found with ID: fd08612d-dfc9-47e5-b4d9-7cd1e7bb95c0
[13:26:04] 🔄 
🔄 Step 6: Pushing order to API...
[13:26:04] [DOC: 9313854] ℹ️  Pushing order via API for patient ID: fd08612d-dfc9-47e5-b4d9-7cd1e7bb95c0
[13:26:05] [DOC: 9313854] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:26:05] ❌    ❌ Failed to push order
[13:26:05] 🔄 
🔄 Step 7: Writing to CSV...
[13:26:05] [DOC: 9313854] ℹ️  Calculated age: 72 from DOB: 02/15/1953
[13:26:05] [DOC: 9313854] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:26:05] [DOC: 9313854] ℹ️  Payer Source extracted: 'Medicare'
[13:26:05] [DOC: 9313854] ℹ️  Diagnosis codes being written:
[13:26:05] [DOC: 9313854] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:26:05] [DOC: 9313854] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:26:05] [DOC: 9313854] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:26:05] [DOC: 9313854] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:26:05] [DOC: 9313854] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:26:05] [DOC: 9313854] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:26:05] [DOC: 9313854] ✅ Patient data written to CSV: William Wilson | Sex: MALE | Age: 72 | Service: Skilled Nursing | Payer: Medicare | MRN: 1661011
[13:26:05] ✅    ✅ Document 9313854 processed and saved successfully
[13:26:05] 🔄 
🔄 Step 8: Saving API details...
[13:26:05] [DOC: 9313854] ℹ️  API push details saved for document 9313854
[13:26:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313852                         ║
================================================================================
[13:26:05] ℹ️  Agency: Dartmouth HH
[13:26:05] ℹ️  Date: 05/28/2025
[13:26:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:26:07] [DOC: 9313852] ✅ Text extracted using pdfplumber (1338 chars)
[13:26:07] ✅    ✅ Text extracted using pdfplumber (1338 chars)
[13:26:07] 🔄 
🔄 Step 2: Extracting patient data...
[13:26:09] ℹ️  AI extracted raw sex value: 'M'
[13:26:09] ℹ️  AI extracted service line: 'OT'
[13:26:09] ℹ️  AI extracted payer source: 'Medicare'
[13:26:09] ℹ️  AI extracted diagnoses:
[13:26:09] ℹ️    - Diagnosis 1: ''
[13:26:09] ℹ️    - Diagnosis 2: ''
[13:26:09] ℹ️    - Diagnosis 3: ''
[13:26:09] ℹ️    - Diagnosis 4: ''
[13:26:09] ℹ️    - Diagnosis 5: ''
[13:26:09] ℹ️    - Diagnosis 6: ''
[13:26:09] ℹ️  Final extracted MRN: '6129015'
[13:26:09] ℹ️  Final extracted Sex: 'MALE'
[13:26:09] ℹ️  Final extracted Service Line: 'OT'
[13:26:09] ℹ️  Final extracted Payer Source: 'Medicare'
[13:26:09] ✅ Patient data extraction completed successfully
[13:26:09] ✅    ✅ Patient data extracted successfully
[13:26:09] 📊 Patient Response
     └─ patientFName: Theodore
     └─ patientLName: Small
     └─ dob: 09/25/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 6129015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '04/29/2025', 'endOfEpisode': '06/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:26:09] ✅    ✅ Patient identified: Theodore Small
[13:26:09] ✅    ✅ Patient name validation passed
[13:26:09] 🔄 
🔄 Step 3: Processing patient dates...
[13:26:09] [DOC: 9313852] ℹ️  DOB normalized: 09/25/1931
[13:26:09] [DOC: 9313852] ℹ️  Episode startOfCare normalized: 02/28/2025
[13:26:09] [DOC: 9313852] ℹ️  Episode startOfEpisode normalized: 04/29/2025
[13:26:09] [DOC: 9313852] ℹ️  Episode endOfEpisode normalized: 06/27/2025
[13:26:09] [DOC: 9313852] ✅ Patient date processing completed successfully
[13:26:09] ✅    ✅ Date processing completed
[13:26:09] 📊 Processed Patient Data
     └─ patientFName: Theodore
     └─ patientLName: Small
     └─ dob: 09/25/1931
     └─ patientSex: MALE
     └─ medicalRecordNo: 6129015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/28/2025', 'startOfEpisode': '04/29/2025', 'endOfEpisode': '06/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:26:09] 🔄 
🔄 Step 4: Extracting order data...
[13:26:12] ℹ️  Order extraction - MRN: ''
[13:26:12] ℹ️  Order extraction - Sex: 'MALE'
[13:26:12] ℹ️  Order extraction - Service Line: 'OT'
[13:26:12] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:26:12] ✅ Order data extraction completed successfully
[13:26:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:26:12] ℹ️  Using MRN from patient data: '6129015'
[13:26:12] ℹ️  Service line consistent in both sources: 'OT'
[13:26:12] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:26:12] ✅ Patient name cross-validation successful
[13:26:12] ✅    ✅ Data merged successfully
[13:26:13] ✅    ✅ Order data extracted and validated
[13:26:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:26:18] [DOC: 9313852] ✅ Patient exists in API: Theodore Small, ID: 8c849805-1775-4653-aa7c-ce211697fc95
[13:26:18] ✅    ✅ Existing patient found with ID: 8c849805-1775-4653-aa7c-ce211697fc95
[13:26:18] 🔄 
🔄 Step 6: Pushing order to API...
[13:26:18] [DOC: 9313852] ℹ️  Pushing order via API for patient ID: 8c849805-1775-4653-aa7c-ce211697fc95
[13:26:19] [DOC: 9313852] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:26:19] ❌    ❌ Failed to push order
[13:26:19] 🔄 
🔄 Step 7: Writing to CSV...
[13:26:19] [DOC: 9313852] ℹ️  Calculated age: 93 from DOB: 09/25/1931
[13:26:19] [DOC: 9313852] ℹ️  Service Line extracted: 'OT'
[13:26:19] [DOC: 9313852] ℹ️  Payer Source extracted: 'Medicare'
[13:26:19] [DOC: 9313852] ℹ️  Diagnosis codes being written:
[13:26:19] [DOC: 9313852] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:26:19] [DOC: 9313852] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:26:19] [DOC: 9313852] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:26:19] [DOC: 9313852] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:26:19] [DOC: 9313852] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:26:19] [DOC: 9313852] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:26:19] [DOC: 9313852] ✅ Patient data written to CSV: Theodore Small | Sex: MALE | Age: 93 | Service: OT | Payer: Medicare | MRN: 6129015
[13:26:19] ✅    ✅ Document 9313852 processed and saved successfully
[13:26:19] 🔄 
🔄 Step 8: Saving API details...
[13:26:19] [DOC: 9313852] ℹ️  API push details saved for document 9313852
[13:26:19] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313848                         ║
================================================================================
[13:26:19] ℹ️  Agency: Dartmouth HH
[13:26:19] ℹ️  Date: 05/28/2025
[13:26:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:26:20] [DOC: 9313848] ✅ Text extracted using pdfplumber (1153 chars)
[13:26:20] ✅    ✅ Text extracted using pdfplumber (1153 chars)
[13:26:20] 🔄 
🔄 Step 2: Extracting patient data...
[13:26:23] ℹ️  AI extracted raw sex value: 'F'
[13:26:23] ℹ️  AI extracted service line: 'HHA'
[13:26:23] ℹ️  AI extracted payer source: 'Medicare'
[13:26:23] ℹ️  AI extracted diagnoses:
[13:26:23] ℹ️    - Diagnosis 1: ''
[13:26:23] ℹ️    - Diagnosis 2: ''
[13:26:23] ℹ️    - Diagnosis 3: ''
[13:26:23] ℹ️    - Diagnosis 4: ''
[13:26:23] ℹ️    - Diagnosis 5: ''
[13:26:23] ℹ️    - Diagnosis 6: ''
[13:26:23] ℹ️  Final extracted MRN: '6388015'
[13:26:23] ℹ️  Final extracted Sex: 'FEMALE'
[13:26:23] ℹ️  Final extracted Service Line: 'HHA'
[13:26:23] ℹ️  Final extracted Payer Source: 'Medicare'
[13:26:23] ✅ Patient data extraction completed successfully
[13:26:23] ✅    ✅ Patient data extracted successfully
[13:26:23] 📊 Patient Response
     └─ patientFName: Debra
     └─ patientLName: Golen
     └─ dob: 10/11/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6388015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2025', 'startOfEpisode': '04/19/2025', 'endOfEpisode': '06/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:26:23] ✅    ✅ Patient identified: Debra Golen
[13:26:23] ✅    ✅ Patient name validation passed
[13:26:23] 🔄 
🔄 Step 3: Processing patient dates...
[13:26:23] [DOC: 9313848] ℹ️  DOB normalized: 10/11/1959
[13:26:23] [DOC: 9313848] ℹ️  Episode startOfCare normalized: 04/19/2025
[13:26:23] [DOC: 9313848] ℹ️  Episode startOfEpisode normalized: 04/19/2025
[13:26:23] [DOC: 9313848] ℹ️  Episode endOfEpisode normalized: 06/17/2025
[13:26:23] [DOC: 9313848] ✅ Patient date processing completed successfully
[13:26:23] ✅    ✅ Date processing completed
[13:26:23] 📊 Processed Patient Data
     └─ patientFName: Debra
     └─ patientLName: Golen
     └─ dob: 10/11/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6388015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/19/2025', 'startOfEpisode': '04/19/2025', 'endOfEpisode': '06/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:26:23] 🔄 
🔄 Step 4: Extracting order data...
[13:26:26] ℹ️  Order extraction - MRN: ''
[13:26:26] ℹ️  Order extraction - Sex: 'FEMALE'
[13:26:26] ℹ️  Order extraction - Service Line: 'RN'
[13:26:26] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:26:26] ✅ Order data extraction completed successfully
[13:26:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:26:26] ℹ️  Using MRN from patient data: '6388015'
[13:26:26] ℹ️  Combined service lines: Patient='HHA' + Order='RN' = 'HHA, RN'
[13:26:26] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:26:26] ✅ Patient name cross-validation successful
[13:26:26] ✅    ✅ Data merged successfully
[13:26:27] ✅    ✅ Order data extracted and validated
[13:26:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:26:27] [DOC: 9313848] ✅ Patient found in local cache: Debra Golen, ID: 8ad987e4-de36-4026-98ee-7d79d753bc6c
[13:26:27] ✅    ✅ Existing patient found with ID: 8ad987e4-de36-4026-98ee-7d79d753bc6c
[13:26:27] 🔄 
🔄 Step 6: Pushing order to API...
[13:26:27] [DOC: 9313848] ℹ️  Pushing order via API for patient ID: 8ad987e4-de36-4026-98ee-7d79d753bc6c
[13:26:28] [DOC: 9313848] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:26:28] ❌    ❌ Failed to push order
[13:26:28] 🔄 
🔄 Step 7: Writing to CSV...
[13:26:28] [DOC: 9313848] ℹ️  Calculated age: 65 from DOB: 10/11/1959
[13:26:28] [DOC: 9313848] ℹ️  Service Line extracted: 'HHA, RN'
[13:26:28] [DOC: 9313848] ℹ️  Payer Source extracted: 'Medicare'
[13:26:28] [DOC: 9313848] ℹ️  Diagnosis codes being written:
[13:26:28] [DOC: 9313848] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:26:28] [DOC: 9313848] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:26:28] [DOC: 9313848] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:26:28] [DOC: 9313848] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:26:28] [DOC: 9313848] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:26:28] [DOC: 9313848] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:26:28] [DOC: 9313848] ✅ Patient data written to CSV: Debra Golen | Sex: FEMALE | Age: 65 | Service: HHA, RN | Payer: Medicare | MRN: 6388015
[13:26:28] ✅    ✅ Document 9313848 processed and saved successfully
[13:26:28] 🔄 
🔄 Step 8: Saving API details...
[13:26:28] [DOC: 9313848] ℹ️  API push details saved for document 9313848
[13:26:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313844                         ║
================================================================================
[13:26:28] ℹ️  Agency: Dartmouth HH
[13:26:28] ℹ️  Date: 05/28/2025
[13:26:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:26:30] [DOC: 9313844] ✅ Text extracted using pdfplumber (1917 chars)
[13:26:30] ✅    ✅ Text extracted using pdfplumber (1917 chars)
[13:26:30] 🔄 
🔄 Step 2: Extracting patient data...
[13:26:33] ℹ️  AI extracted raw sex value: 'F'
[13:26:33] ℹ️  AI extracted service line: 'PT, OT'
[13:26:33] ℹ️  AI extracted payer source: 'Medicare'
[13:26:33] ℹ️  AI extracted diagnoses:
[13:26:33] ℹ️    - Diagnosis 1: 'None'
[13:26:33] ℹ️    - Diagnosis 2: 'None'
[13:26:33] ℹ️    - Diagnosis 3: 'None'
[13:26:33] ℹ️    - Diagnosis 4: 'None'
[13:26:33] ℹ️    - Diagnosis 5: 'None'
[13:26:33] ℹ️    - Diagnosis 6: 'None'
[13:26:33] ℹ️  Final extracted MRN: '919015'
[13:26:33] ℹ️  Final extracted Sex: 'FEMALE'
[13:26:33] ℹ️  Final extracted Service Line: 'PT, OT'
[13:26:33] ℹ️  Final extracted Payer Source: 'Medicare'
[13:26:33] ✅ Patient data extraction completed successfully
[13:26:33] ✅    ✅ Patient data extracted successfully
[13:26:33] 📊 Patient Response
     └─ patientFName: Julieta
     └─ patientLName: Pereira
     └─ dob: 03/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 919015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 20 Palmer Street
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/26/2024', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[13:26:33] ✅    ✅ Patient identified: Julieta Pereira
[13:26:33] ✅    ✅ Patient name validation passed
[13:26:33] 🔄 
🔄 Step 3: Processing patient dates...
[13:26:33] [DOC: 9313844] ℹ️  DOB normalized: 03/23/1941
[13:26:33] [DOC: 9313844] ℹ️  Episode startOfCare normalized: 11/26/2024
[13:26:33] [DOC: 9313844] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[13:26:33] [DOC: 9313844] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[13:26:33] [DOC: 9313844] ✅ Patient date processing completed successfully
[13:26:33] ✅    ✅ Date processing completed
[13:26:33] 📊 Processed Patient Data
     └─ patientFName: Julieta
     └─ patientLName: Pereira
     └─ dob: 03/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 919015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 20 Palmer Street
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/26/2024', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025'}]
[13:26:33] 🔄 
🔄 Step 4: Extracting order data...
[13:26:35] ℹ️  Order extraction - MRN: ''
[13:26:35] ℹ️  Order extraction - Sex: 'FEMALE'
[13:26:35] ℹ️  Order extraction - Service Line: 'PT, OT'
[13:26:35] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:26:35] ✅ Order data extraction completed successfully
[13:26:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:26:35] ℹ️  Using MRN from patient data: '919015'
[13:26:35] ℹ️  Service line consistent in both sources: 'PT, OT'
[13:26:35] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:26:35] ✅ Patient name cross-validation successful
[13:26:35] ✅    ✅ Data merged successfully
[13:26:36] ✅    ✅ Order data extracted and validated
[13:26:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:26:42] [DOC: 9313844] ✅ Patient exists in API: Julieta Pereira, ID: c2e7114d-362f-4392-9923-06c73f2eab17
[13:26:42] ✅    ✅ Existing patient found with ID: c2e7114d-362f-4392-9923-06c73f2eab17
[13:26:42] 🔄 
🔄 Step 6: Pushing order to API...
[13:26:42] [DOC: 9313844] ℹ️  Pushing order via API for patient ID: c2e7114d-362f-4392-9923-06c73f2eab17
[13:26:43] [DOC: 9313844] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13013"}
[13:26:43] ❌    ❌ Failed to push order
[13:26:43] 🔄 
🔄 Step 7: Writing to CSV...
[13:26:43] [DOC: 9313844] ℹ️  Calculated age: 84 from DOB: 03/23/1941
[13:26:43] [DOC: 9313844] ℹ️  Service Line extracted: 'PT, OT'
[13:26:43] [DOC: 9313844] ℹ️  Payer Source extracted: 'Medicare'
[13:26:43] [DOC: 9313844] ℹ️  Diagnosis codes being written:
[13:26:43] [DOC: 9313844] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:26:43] [DOC: 9313844] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:26:43] [DOC: 9313844] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:26:43] [DOC: 9313844] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:26:43] [DOC: 9313844] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:26:43] [DOC: 9313844] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:26:43] [DOC: 9313844] ✅ Patient data written to CSV: Julieta Pereira | Sex: FEMALE | Age: 84 | Service: PT, OT | Payer: Medicare | MRN: 919015
[13:26:43] ✅    ✅ Document 9313844 processed and saved successfully
[13:26:43] 🔄 
🔄 Step 8: Saving API details...
[13:26:43] [DOC: 9313844] ℹ️  API push details saved for document 9313844
[13:26:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313841                         ║
================================================================================
[13:26:43] ℹ️  Agency: Dartmouth HH
[13:26:43] ℹ️  Date: 05/28/2025
[13:26:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:26:45] [DOC: 9313841] ✅ Text extracted using pdfplumber (1700 chars)
[13:26:45] ✅    ✅ Text extracted using pdfplumber (1700 chars)
[13:26:45] 🔄 
🔄 Step 2: Extracting patient data...
[13:26:48] ℹ️  AI extracted raw sex value: 'M'
[13:26:48] ℹ️  AI extracted service line: 'RN'
[13:26:48] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[13:26:48] ℹ️  AI extracted diagnoses:
[13:26:48] ℹ️    - Diagnosis 1: ''
[13:26:48] ℹ️    - Diagnosis 2: ''
[13:26:48] ℹ️    - Diagnosis 3: ''
[13:26:48] ℹ️    - Diagnosis 4: ''
[13:26:48] ℹ️    - Diagnosis 5: ''
[13:26:48] ℹ️    - Diagnosis 6: ''
[13:26:48] ℹ️  Final extracted MRN: '6348015'
[13:26:48] ℹ️  Final extracted Sex: 'MALE'
[13:26:48] ℹ️  Final extracted Service Line: 'RN'
[13:26:48] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[13:26:48] ✅ Patient data extraction completed successfully
[13:26:48] ✅    ✅ Patient data extracted successfully
[13:26:48] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Teixeira
     └─ dob: 12/29/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 6348015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:26:48] ✅    ✅ Patient identified: David Teixeira
[13:26:48] ✅    ✅ Patient name validation passed
[13:26:48] 🔄 
🔄 Step 3: Processing patient dates...
[13:26:48] [DOC: 9313841] ℹ️  DOB normalized: 12/29/1956
[13:26:48] [DOC: 9313841] ℹ️  Episode startOfCare normalized: 04/08/2025
[13:26:48] [DOC: 9313841] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[13:26:48] [DOC: 9313841] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[13:26:48] [DOC: 9313841] ✅ Patient date processing completed successfully
[13:26:48] ✅    ✅ Date processing completed
[13:26:48] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Teixeira
     └─ dob: 12/29/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 6348015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '04/08/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:26:48] 🔄 
🔄 Step 4: Extracting order data...
[13:26:50] ℹ️  Order extraction - MRN: '6348015'
[13:26:50] ℹ️  Order extraction - Sex: 'MALE'
[13:26:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:26:50] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[13:26:50] ✅ Order data extraction completed successfully
[13:26:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:26:50] ℹ️  Using MRN from patient data: '6348015' over '6348015'
[13:26:50] ℹ️  Combined service lines: Patient='RN' + Order='Skilled Nursing' = 'RN, Skilled Nursing'
[13:26:50] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[13:26:50] ✅ Patient name cross-validation successful
[13:26:50] ✅    ✅ Data merged successfully
[13:26:52] ✅    ✅ Order data extracted and validated
[13:26:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:27:00] [DOC: 9313841] ✅ Patient exists in API: David Teixeira, ID: 92d56142-8dce-415a-ac6f-6020de943b51
[13:27:00] ✅    ✅ Existing patient found with ID: 92d56142-8dce-415a-ac6f-6020de943b51
[13:27:00] 🔄 
🔄 Step 6: Pushing order to API...
[13:27:00] [DOC: 9313841] ℹ️  Pushing order via API for patient ID: 92d56142-8dce-415a-ac6f-6020de943b51
[13:27:01] [DOC: 9313841] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:27:01] ❌    ❌ Failed to push order
[13:27:01] 🔄 
🔄 Step 7: Writing to CSV...
[13:27:01] [DOC: 9313841] ℹ️  Calculated age: 68 from DOB: 12/29/1956
[13:27:01] [DOC: 9313841] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[13:27:01] [DOC: 9313841] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[13:27:01] [DOC: 9313841] ℹ️  Diagnosis codes being written:
[13:27:01] [DOC: 9313841] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:27:01] [DOC: 9313841] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:27:01] [DOC: 9313841] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:27:01] [DOC: 9313841] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:27:01] [DOC: 9313841] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:27:01] [DOC: 9313841] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:27:01] [DOC: 9313841] ✅ Patient data written to CSV: David Teixeira | Sex: MALE | Age: 68 | Service: RN, Skilled Nursing | Payer: Blue Cross Blue Shield | MRN: 6348015
[13:27:01] ✅    ✅ Document 9313841 processed and saved successfully
[13:27:01] 🔄 
🔄 Step 8: Saving API details...
[13:27:01] [DOC: 9313841] ℹ️  API push details saved for document 9313841
[13:27:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313839                         ║
================================================================================
[13:27:01] ℹ️  Agency: Dartmouth HH
[13:27:01] ℹ️  Date: 05/28/2025
[13:27:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:27:03] [DOC: 9313839] ✅ Text extracted using pdfplumber (5194 chars)
[13:27:03] ✅    ✅ Text extracted using pdfplumber (5194 chars)
[13:27:03] 🔄 
🔄 Step 2: Extracting patient data...
[13:27:06] ℹ️  AI extracted raw sex value: 'F'
[13:27:06] ℹ️  AI extracted service line: 'OT, SN, PT'
[13:27:06] ℹ️  AI extracted payer source: 'Medicare'
[13:27:06] ℹ️  AI extracted diagnoses:
[13:27:06] ℹ️    - Diagnosis 1: ''
[13:27:06] ℹ️    - Diagnosis 2: ''
[13:27:06] ℹ️    - Diagnosis 3: ''
[13:27:06] ℹ️    - Diagnosis 4: ''
[13:27:06] ℹ️    - Diagnosis 5: ''
[13:27:06] ℹ️    - Diagnosis 6: ''
[13:27:06] ℹ️  Final extracted MRN: '4799015'
[13:27:06] ℹ️  Final extracted Sex: 'FEMALE'
[13:27:06] ℹ️  Final extracted Service Line: 'OT, SN, PT'
[13:27:06] ℹ️  Final extracted Payer Source: 'Medicare'
[13:27:06] ✅ Patient data extraction completed successfully
[13:27:06] ✅    ✅ Patient data extracted successfully
[13:27:06] 📊 Patient Response
     └─ patientFName: Agatina
     └─ patientLName: Manna
     └─ dob: 03/10/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4799015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, SN, PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/17/2024', 'startOfEpisode': '11/22/2024', 'endOfEpisode': '03/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:27:06] ✅    ✅ Patient identified: Agatina Manna
[13:27:06] ✅    ✅ Patient name validation passed
[13:27:06] 🔄 
🔄 Step 3: Processing patient dates...
[13:27:06] [DOC: 9313839] ℹ️  DOB normalized: 03/10/1937
[13:27:06] [DOC: 9313839] ℹ️  Episode startOfCare normalized: 11/17/2024
[13:27:06] [DOC: 9313839] ℹ️  Episode startOfEpisode normalized: 11/22/2024
[13:27:06] [DOC: 9313839] ℹ️  Episode endOfEpisode normalized: 03/11/2025
[13:27:06] [DOC: 9313839] ✅ Patient date processing completed successfully
[13:27:06] ✅    ✅ Date processing completed
[13:27:06] 📊 Processed Patient Data
     └─ patientFName: Agatina
     └─ patientLName: Manna
     └─ dob: 03/10/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4799015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, SN, PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/17/2024', 'startOfEpisode': '11/22/2024', 'endOfEpisode': '03/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:27:06] 🔄 
🔄 Step 4: Extracting order data...
[13:27:08] ℹ️  Order extraction - MRN: '4799015'
[13:27:08] ℹ️  Order extraction - Sex: 'FEMALE'
[13:27:08] ℹ️  Order extraction - Service Line: 'OT, SN, PT'
[13:27:08] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:27:08] ✅ Order data extraction completed successfully
[13:27:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:27:08] ℹ️  Using MRN from patient data: '4799015' over '4799015'
[13:27:08] ℹ️  Service line consistent in both sources: 'OT, SN, PT'
[13:27:08] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:27:08] ✅ Patient name cross-validation successful
[13:27:08] ✅    ✅ Data merged successfully
[13:27:09] ✅    ✅ Order data extracted and validated
[13:27:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:27:21] [DOC: 9313839] ✅ Patient exists in API: Agatina Manna, ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[13:27:21] ✅    ✅ Existing patient found with ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[13:27:21] 🔄 
🔄 Step 6: Pushing order to API...
[13:27:21] [DOC: 9313839] ℹ️  Pushing order via API for patient ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[13:27:22] [DOC: 9313839] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:27:22] ❌    ❌ Failed to push order
[13:27:22] 🔄 
🔄 Step 7: Writing to CSV...
[13:27:22] [DOC: 9313839] ℹ️  Calculated age: 88 from DOB: 03/10/1937
[13:27:22] [DOC: 9313839] ℹ️  Service Line extracted: 'OT, SN, PT'
[13:27:22] [DOC: 9313839] ℹ️  Payer Source extracted: 'Medicare'
[13:27:22] [DOC: 9313839] ℹ️  Diagnosis codes being written:
[13:27:22] [DOC: 9313839] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:27:22] [DOC: 9313839] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:27:22] [DOC: 9313839] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:27:22] [DOC: 9313839] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:27:22] [DOC: 9313839] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:27:22] [DOC: 9313839] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:27:22] [DOC: 9313839] ✅ Patient data written to CSV: Agatina Manna | Sex: FEMALE | Age: 88 | Service: OT, SN, PT | Payer: Medicare | MRN: 4799015
[13:27:22] ✅    ✅ Document 9313839 processed and saved successfully
[13:27:22] 🔄 
🔄 Step 8: Saving API details...
[13:27:22] [DOC: 9313839] ℹ️  API push details saved for document 9313839
[13:27:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313837                         ║
================================================================================
[13:27:22] ℹ️  Agency: Dartmouth HH
[13:27:22] ℹ️  Date: 05/28/2025
[13:27:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:27:28] [DOC: 9313837] ✅ Text extracted using pdfplumber (1072 chars)
[13:27:28] ✅    ✅ Text extracted using pdfplumber (1072 chars)
[13:27:28] 🔄 
🔄 Step 2: Extracting patient data...
[13:27:30] ℹ️  AI extracted raw sex value: 'F'
[13:27:30] ℹ️  AI extracted service line: 'HHA'
[13:27:30] ℹ️  AI extracted payer source: 'Medicare'
[13:27:30] ℹ️  AI extracted diagnoses:
[13:27:30] ℹ️    - Diagnosis 1: ''
[13:27:30] ℹ️    - Diagnosis 2: ''
[13:27:30] ℹ️    - Diagnosis 3: ''
[13:27:30] ℹ️    - Diagnosis 4: ''
[13:27:30] ℹ️    - Diagnosis 5: ''
[13:27:30] ℹ️    - Diagnosis 6: ''
[13:27:30] ℹ️  Final extracted MRN: '1690001'
[13:27:30] ℹ️  Final extracted Sex: 'FEMALE'
[13:27:30] ℹ️  Final extracted Service Line: 'HHA'
[13:27:30] ℹ️  Final extracted Payer Source: 'Medicare'
[13:27:30] ✅ Patient data extraction completed successfully
[13:27:30] ✅    ✅ Patient data extracted successfully
[13:27:30] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Rocha
     └─ dob: 04/26/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1690001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/03/2025', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:27:30] ✅    ✅ Patient identified: Nancy Rocha
[13:27:30] ✅    ✅ Patient name validation passed
[13:27:30] 🔄 
🔄 Step 3: Processing patient dates...
[13:27:30] [DOC: 9313837] ℹ️  DOB normalized: 04/26/1933
[13:27:30] [DOC: 9313837] ℹ️  Episode startOfCare normalized: 01/03/2025
[13:27:30] [DOC: 9313837] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[13:27:30] [DOC: 9313837] ℹ️  Episode endOfEpisode normalized: 07/01/2025
[13:27:30] [DOC: 9313837] ✅ Patient date processing completed successfully
[13:27:30] ✅    ✅ Date processing completed
[13:27:30] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Rocha
     └─ dob: 04/26/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1690001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/03/2025', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:27:30] 🔄 
🔄 Step 4: Extracting order data...
[13:27:33] ℹ️  Order extraction - MRN: ''
[13:27:33] ℹ️  Order extraction - Sex: 'FEMALE'
[13:27:33] ℹ️  Order extraction - Service Line: 'HHA'
[13:27:33] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:27:33] ✅ Order data extraction completed successfully
[13:27:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:27:33] ℹ️  Using MRN from patient data: '1690001'
[13:27:33] ℹ️  Service line consistent in both sources: 'HHA'
[13:27:33] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:27:33] ✅ Patient name cross-validation successful
[13:27:33] ✅    ✅ Data merged successfully
[13:27:37] ✅    ✅ Order data extracted and validated
[13:27:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:27:37] [DOC: 9313837] ✅ Patient found in local cache: Nancy Rocha, ID: 34212fde-a89b-47f5-a81f-07e123e156e2
[13:27:37] ✅    ✅ Existing patient found with ID: 34212fde-a89b-47f5-a81f-07e123e156e2
[13:27:37] 🔄 
🔄 Step 6: Pushing order to API...
[13:27:37] [DOC: 9313837] ℹ️  Pushing order via API for patient ID: 34212fde-a89b-47f5-a81f-07e123e156e2
[13:27:39] [DOC: 9313837] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14263"}
[13:27:39] ❌    ❌ Failed to push order
[13:27:39] 🔄 
🔄 Step 7: Writing to CSV...
[13:27:39] [DOC: 9313837] ℹ️  Calculated age: 92 from DOB: 04/26/1933
[13:27:39] [DOC: 9313837] ℹ️  Service Line extracted: 'HHA'
[13:27:39] [DOC: 9313837] ℹ️  Payer Source extracted: 'Medicare'
[13:27:39] [DOC: 9313837] ℹ️  Diagnosis codes being written:
[13:27:39] [DOC: 9313837] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:27:39] [DOC: 9313837] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:27:39] [DOC: 9313837] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:27:39] [DOC: 9313837] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:27:39] [DOC: 9313837] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:27:39] [DOC: 9313837] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:27:39] [DOC: 9313837] ✅ Patient data written to CSV: Nancy Rocha | Sex: FEMALE | Age: 92 | Service: HHA | Payer: Medicare | MRN: 1690001
[13:27:39] ✅    ✅ Document 9313837 processed and saved successfully
[13:27:39] 🔄 
🔄 Step 8: Saving API details...
[13:27:39] [DOC: 9313837] ℹ️  API push details saved for document 9313837
[13:27:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313834                         ║
================================================================================
[13:27:39] ℹ️  Agency: Dartmouth HH
[13:27:39] ℹ️  Date: 05/28/2025
[13:27:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:27:41] [DOC: 9313834] ✅ Text extracted using pdfplumber (1822 chars)
[13:27:41] ✅    ✅ Text extracted using pdfplumber (1822 chars)
[13:27:41] 🔄 
🔄 Step 2: Extracting patient data...
[13:27:43] ℹ️  AI extracted raw sex value: 'M'
[13:27:43] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:27:43] ℹ️  AI extracted payer source: 'Fallon Health'
[13:27:43] ℹ️  AI extracted diagnoses:
[13:27:43] ℹ️    - Diagnosis 1: ''
[13:27:43] ℹ️    - Diagnosis 2: ''
[13:27:43] ℹ️    - Diagnosis 3: ''
[13:27:43] ℹ️    - Diagnosis 4: ''
[13:27:43] ℹ️    - Diagnosis 5: ''
[13:27:43] ℹ️    - Diagnosis 6: ''
[13:27:43] ℹ️  Final extracted MRN: '6476015'
[13:27:43] ℹ️  Final extracted Sex: 'MALE'
[13:27:43] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:27:43] ℹ️  Final extracted Payer Source: 'Fallon Health'
[13:27:43] ✅ Patient data extraction completed successfully
[13:27:43] ✅    ✅ Patient data extracted successfully
[13:27:43] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Mathieu
     └─ dob: 04/14/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 6476015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '05/03/2025', 'startOfEpisode': '05/03/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:27:43] ✅    ✅ Patient identified: Joseph Mathieu
[13:27:43] ✅    ✅ Patient name validation passed
[13:27:43] 🔄 
🔄 Step 3: Processing patient dates...
[13:27:43] [DOC: 9313834] ℹ️  DOB normalized: 04/14/1947
[13:27:43] [DOC: 9313834] ℹ️  Episode startOfCare normalized: 05/03/2025
[13:27:43] [DOC: 9313834] ℹ️  Episode startOfEpisode normalized: 05/03/2025
[13:27:43] [DOC: 9313834] ℹ️  Episode endOfEpisode normalized: 07/01/2025
[13:27:43] [DOC: 9313834] ✅ Patient date processing completed successfully
[13:27:43] ✅    ✅ Date processing completed
[13:27:43] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Mathieu
     └─ dob: 04/14/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 6476015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '05/03/2025', 'startOfEpisode': '05/03/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:27:43] 🔄 
🔄 Step 4: Extracting order data...
[13:27:46] ℹ️  Order extraction - MRN: '6476015'
[13:27:46] ℹ️  Order extraction - Sex: 'MALE'
[13:27:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:27:46] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[13:27:46] ✅ Order data extraction completed successfully
[13:27:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:27:46] ℹ️  Using MRN from patient data: '6476015' over '6476015'
[13:27:46] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:27:46] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[13:27:46] ✅ Patient name cross-validation successful
[13:27:46] ✅    ✅ Data merged successfully
[13:27:47] ✅    ✅ Order data extracted and validated
[13:27:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:27:55] [DOC: 9313834] ℹ️  Patient not found in cache or API: Joseph Mathieu
[13:27:55] [DOC: 9313834] ℹ️  Patient not found, creating new patient via API...
[13:27:55] [DOC: 9313834] ℹ️  Creating patient via API: Joseph Mathieu
[13:27:57] [DOC: 9313834] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[13:27:57] ❌    ❌ Failed to create patient
[13:27:57] [DOC: 9313834] ℹ️  API push details saved for document 9313834
================================================================================
║                        Processing Document ID: 9313832                         ║
================================================================================
[13:27:57] ℹ️  Agency: Dartmouth HH
[13:27:57] ℹ️  Date: 05/28/2025
[13:27:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:27:59] [DOC: 9313832] ✅ Text extracted using pdfplumber (12334 chars)
[13:27:59] ✅    ✅ Text extracted using pdfplumber (12322 chars)
[13:27:59] 🔄 
🔄 Step 2: Extracting patient data...
[13:28:02] ℹ️  AI extracted raw sex value: 'F'
[13:28:02] ℹ️  AI extracted service line: 'PT, RN'
[13:28:02] ℹ️  AI extracted payer source: ''
[13:28:02] ℹ️  AI extracted diagnoses:
[13:28:02] ℹ️    - Diagnosis 1: 'M48.062'
[13:28:02] ℹ️    - Diagnosis 2: 'M47.814'
[13:28:02] ℹ️    - Diagnosis 3: 'M41.26'
[13:28:02] ℹ️    - Diagnosis 4: 'M45.9'
[13:28:02] ℹ️    - Diagnosis 5: 'M54.50'
[13:28:02] ℹ️    - Diagnosis 6: 'M62.81'
[13:28:02] ℹ️  Final extracted MRN: '3851011'
[13:28:02] ℹ️  Final extracted Sex: 'FEMALE'
[13:28:02] ℹ️  Final extracted Service Line: 'PT, RN'
[13:28:02] ℹ️  Final extracted Payer Source: ''
[13:28:02] ✅ Patient data extraction completed successfully
[13:28:02] ✅    ✅ Patient data extracted successfully
[13:28:02] 📊 Patient Response
     └─ patientFName: Anne
     └─ patientLName: Carney
     └─ dob: 12/24/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3851011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/28/2025', 'startOfEpisode': '04/28/2025', 'endOfEpisode': '06/26/2025', 'firstDiagnosis': 'M48.062', 'secondDiagnosis': 'M47.814', 'thirdDiagnosis': 'M41.26', 'fourthDiagnosis': 'M45.9', 'fifthDiagnosis': 'M54.50', 'sixthDiagnosis': 'M62.81'}]
[13:28:02] ✅    ✅ Patient identified: Anne Carney
[13:28:02] ✅    ✅ Patient name validation passed
[13:28:02] 🔄 
🔄 Step 3: Processing patient dates...
[13:28:02] [DOC: 9313832] ℹ️  DOB normalized: 12/24/1936
[13:28:02] [DOC: 9313832] ℹ️  Episode startOfCare normalized: 04/28/2025
[13:28:02] [DOC: 9313832] ℹ️  Episode startOfEpisode normalized: 04/28/2025
[13:28:02] [DOC: 9313832] ℹ️  Episode endOfEpisode normalized: 06/26/2025
[13:28:02] [DOC: 9313832] ✅ Patient date processing completed successfully
[13:28:02] ✅    ✅ Date processing completed
[13:28:02] 📊 Processed Patient Data
     └─ patientFName: Anne
     └─ patientLName: Carney
     └─ dob: 12/24/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3851011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/28/2025', 'startOfEpisode': '04/28/2025', 'endOfEpisode': '06/26/2025', 'firstDiagnosis': 'M48.062', 'secondDiagnosis': 'M47.814', 'thirdDiagnosis': 'M41.26', 'fourthDiagnosis': 'M45.9', 'fifthDiagnosis': 'M54.50', 'sixthDiagnosis': 'M62.81'}]
[13:28:02] 🔄 
🔄 Step 4: Extracting order data...
[13:28:05] ℹ️  Order extraction - MRN: '3851011'
[13:28:05] ℹ️  Order extraction - Sex: 'FEMALE'
[13:28:05] ℹ️  Order extraction - Service Line: 'PT, RN'
[13:28:05] ℹ️  Order extraction - Payer Source: ''
[13:28:05] ✅ Order data extraction completed successfully
[13:28:05] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:28:05] ℹ️  Using MRN from patient data: '3851011' over '3851011'
[13:28:05] ℹ️  Service line consistent in both sources: 'PT, RN'
[13:28:05] ✅ Patient name cross-validation successful
[13:28:05] ✅    ✅ Data merged successfully
[13:28:06] ✅    ✅ Order data extracted and validated
[13:28:06] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:28:13] [DOC: 9313832] ✅ Patient exists in API: Anne Carney, ID: fdbcc0da-c295-420b-abfd-cad0bc54119e
[13:28:13] ✅    ✅ Existing patient found with ID: fdbcc0da-c295-420b-abfd-cad0bc54119e
[13:28:13] 🔄 
🔄 Step 6: Pushing order to API...
[13:28:13] [DOC: 9313832] ℹ️  Pushing order via API for patient ID: fdbcc0da-c295-420b-abfd-cad0bc54119e
[13:28:15] [DOC: 9313832] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:28:15] ❌    ❌ Failed to push order
[13:28:15] 🔄 
🔄 Step 7: Writing to CSV...
[13:28:15] [DOC: 9313832] ℹ️  Calculated age: 88 from DOB: 12/24/1936
[13:28:15] [DOC: 9313832] ℹ️  Service Line extracted: 'PT, RN'
[13:28:15] [DOC: 9313832] ℹ️  Payer Source extracted: ''
[13:28:15] [DOC: 9313832] ℹ️  Diagnosis codes being written:
[13:28:15] [DOC: 9313832] ℹ️    - Latest_Episode_Firstdiagnosis: 'M48.062'
[13:28:15] [DOC: 9313832] ℹ️    - Latest_Episode_Seconddiagnosis: 'M47.814'
[13:28:15] [DOC: 9313832] ℹ️    - Latest_Episode_Thirddiagnosis: 'M41.26'
[13:28:15] [DOC: 9313832] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M45.9'
[13:28:15] [DOC: 9313832] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M54.50'
[13:28:15] [DOC: 9313832] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M62.81'
[13:28:15] [DOC: 9313832] ✅ Patient data written to CSV: Anne Carney | Sex: FEMALE | Age: 88 | Service: PT, RN | Payer:  | MRN: 3851011
[13:28:15] ✅    ✅ Document 9313832 processed and saved successfully
[13:28:15] 🔄 
🔄 Step 8: Saving API details...
[13:28:15] [DOC: 9313832] ℹ️  API push details saved for document 9313832
[13:28:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313830                         ║
================================================================================
[13:28:15] ℹ️  Agency: Dartmouth HH
[13:28:15] ℹ️  Date: 05/28/2025
[13:28:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:28:16] [DOC: 9313830] ✅ Text extracted using pdfplumber (1261 chars)
[13:28:16] ✅    ✅ Text extracted using pdfplumber (1261 chars)
[13:28:16] 🔄 
🔄 Step 2: Extracting patient data...
[13:28:19] ℹ️  AI extracted raw sex value: 'F'
[13:28:19] ℹ️  AI extracted service line: 'RN'
[13:28:19] ℹ️  AI extracted payer source: 'Medicare'
[13:28:19] ℹ️  AI extracted diagnoses:
[13:28:19] ℹ️    - Diagnosis 1: ''
[13:28:19] ℹ️    - Diagnosis 2: ''
[13:28:19] ℹ️    - Diagnosis 3: ''
[13:28:19] ℹ️    - Diagnosis 4: ''
[13:28:19] ℹ️    - Diagnosis 5: ''
[13:28:19] ℹ️    - Diagnosis 6: ''
[13:28:19] ℹ️  Final extracted MRN: '3206001'
[13:28:19] ℹ️  Final extracted Sex: 'FEMALE'
[13:28:19] ℹ️  Final extracted Service Line: 'RN'
[13:28:19] ℹ️  Final extracted Payer Source: 'Medicare'
[13:28:19] ✅ Patient data extraction completed successfully
[13:28:19] ✅    ✅ Patient data extracted successfully
[13:28:19] 📊 Patient Response
     └─ patientFName: Marilyn
     └─ patientLName: Morgado
     └─ dob: 05/27/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3206001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 115 Jouvette Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/03/2025', 'startOfEpisode': '05/03/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:28:19] ✅    ✅ Patient identified: Marilyn Morgado
[13:28:19] ✅    ✅ Patient name validation passed
[13:28:19] 🔄 
🔄 Step 3: Processing patient dates...
[13:28:19] [DOC: 9313830] ℹ️  DOB normalized: 05/27/1937
[13:28:19] [DOC: 9313830] ℹ️  Episode startOfCare normalized: 05/03/2025
[13:28:19] [DOC: 9313830] ℹ️  Episode startOfEpisode normalized: 05/03/2025
[13:28:19] [DOC: 9313830] ℹ️  Episode endOfEpisode normalized: 07/01/2025
[13:28:19] [DOC: 9313830] ✅ Patient date processing completed successfully
[13:28:19] ✅    ✅ Date processing completed
[13:28:19] 📊 Processed Patient Data
     └─ patientFName: Marilyn
     └─ patientLName: Morgado
     └─ dob: 05/27/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3206001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 115 Jouvette Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/03/2025', 'startOfEpisode': '05/03/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[13:28:19] 🔄 
🔄 Step 4: Extracting order data...
[13:28:22] ℹ️  Order extraction - MRN: ''
[13:28:22] ℹ️  Order extraction - Sex: 'FEMALE'
[13:28:22] ℹ️  Order extraction - Service Line: 'RN'
[13:28:22] ℹ️  Order extraction - Payer Source: 'Medicare'
[13:28:22] ✅ Order data extraction completed successfully
[13:28:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:28:22] ℹ️  Using MRN from patient data: '3206001'
[13:28:22] ℹ️  Service line consistent in both sources: 'RN'
[13:28:22] ℹ️  Payer source consistent in both sources: 'Medicare'
[13:28:22] ✅ Patient name cross-validation successful
[13:28:22] ✅    ✅ Data merged successfully
[13:28:23] ✅    ✅ Order data extracted and validated
[13:28:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:28:33] [DOC: 9313830] ✅ Patient exists in API: Marilyn Morgado, ID: 18cd12be-7620-4152-aa8d-1fb71b749060
[13:28:33] ✅    ✅ Existing patient found with ID: 18cd12be-7620-4152-aa8d-1fb71b749060
[13:28:33] 🔄 
🔄 Step 6: Pushing order to API...
[13:28:33] [DOC: 9313830] ℹ️  Pushing order via API for patient ID: 18cd12be-7620-4152-aa8d-1fb71b749060
[13:28:41] [DOC: 9313830] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD16575"}
[13:28:41] ❌    ❌ Failed to push order
[13:28:41] 🔄 
🔄 Step 7: Writing to CSV...
[13:28:41] [DOC: 9313830] ℹ️  Calculated age: 88 from DOB: 05/27/1937
[13:28:41] [DOC: 9313830] ℹ️  Service Line extracted: 'RN'
[13:28:41] [DOC: 9313830] ℹ️  Payer Source extracted: 'Medicare'
[13:28:41] [DOC: 9313830] ℹ️  Diagnosis codes being written:
[13:28:41] [DOC: 9313830] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[13:28:41] [DOC: 9313830] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[13:28:41] [DOC: 9313830] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[13:28:41] [DOC: 9313830] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[13:28:41] [DOC: 9313830] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[13:28:41] [DOC: 9313830] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[13:28:41] [DOC: 9313830] ✅ Patient data written to CSV: Marilyn Morgado | Sex: FEMALE | Age: 88 | Service: RN | Payer: Medicare | MRN: 3206001
[13:28:41] ✅    ✅ Document 9313830 processed and saved successfully
[13:28:41] 🔄 
🔄 Step 8: Saving API details...
[13:28:41] [DOC: 9313830] ℹ️  API push details saved for document 9313830
[13:28:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313821                         ║
================================================================================
[13:28:41] ℹ️  Agency: Dartmouth HH
[13:28:41] ℹ️  Date: 05/28/2025
[13:28:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:28:46] [DOC: 9313821] ✅ Text extracted using pdfplumber (11975 chars)
[13:28:46] ✅    ✅ Text extracted using pdfplumber (11963 chars)
[13:28:46] 🔄 
🔄 Step 2: Extracting patient data...
[13:28:49] ℹ️  AI extracted raw sex value: 'F'
[13:28:49] ℹ️  AI extracted service line: 'PT, RN'
[13:28:49] ℹ️  AI extracted payer source: ''
[13:28:49] ℹ️  AI extracted diagnoses:
[13:28:49] ℹ️    - Diagnosis 1: 'M48.062'
[13:28:49] ℹ️    - Diagnosis 2: 'M47.814'
[13:28:49] ℹ️    - Diagnosis 3: 'M41.26'
[13:28:49] ℹ️    - Diagnosis 4: 'M45.9'
[13:28:49] ℹ️    - Diagnosis 5: 'M54.50'
[13:28:49] ℹ️    - Diagnosis 6: 'M62.81'
[13:28:49] ℹ️  Final extracted MRN: '3851011'
[13:28:49] ℹ️  Final extracted Sex: 'FEMALE'
[13:28:49] ℹ️  Final extracted Service Line: 'PT, RN'
[13:28:49] ℹ️  Final extracted Payer Source: ''
[13:28:49] ✅ Patient data extraction completed successfully
[13:28:49] ✅    ✅ Patient data extracted successfully
[13:28:49] 📊 Patient Response
     └─ patientFName: Anne
     └─ patientLName: Carney
     └─ dob: 12/24/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3851011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/28/2025', 'startOfEpisode': '04/28/2025', 'endOfEpisode': '06/26/2025', 'firstDiagnosis': 'M48.062', 'secondDiagnosis': 'M47.814', 'thirdDiagnosis': 'M41.26', 'fourthDiagnosis': 'M45.9', 'fifthDiagnosis': 'M54.50', 'sixthDiagnosis': 'M62.81'}]
[13:28:49] ✅    ✅ Patient identified: Anne Carney
[13:28:49] ✅    ✅ Patient name validation passed
[13:28:49] 🔄 
🔄 Step 3: Processing patient dates...
[13:28:49] [DOC: 9313821] ℹ️  DOB normalized: 12/24/1936
[13:28:49] [DOC: 9313821] ℹ️  Episode startOfCare normalized: 04/28/2025
[13:28:49] [DOC: 9313821] ℹ️  Episode startOfEpisode normalized: 04/28/2025
[13:28:49] [DOC: 9313821] ℹ️  Episode endOfEpisode normalized: 06/26/2025
[13:28:49] [DOC: 9313821] ✅ Patient date processing completed successfully
[13:28:49] ✅    ✅ Date processing completed
[13:28:49] 📊 Processed Patient Data
     └─ patientFName: Anne
     └─ patientLName: Carney
     └─ dob: 12/24/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3851011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/28/2025', 'startOfEpisode': '04/28/2025', 'endOfEpisode': '06/26/2025', 'firstDiagnosis': 'M48.062', 'secondDiagnosis': 'M47.814', 'thirdDiagnosis': 'M41.26', 'fourthDiagnosis': 'M45.9', 'fifthDiagnosis': 'M54.50', 'sixthDiagnosis': 'M62.81'}]
[13:28:49] 🔄 
🔄 Step 4: Extracting order data...
[13:28:52] ℹ️  Order extraction - MRN: '3851011'
[13:28:52] ℹ️  Order extraction - Sex: 'FEMALE'
[13:28:52] ℹ️  Order extraction - Service Line: 'PT, RN'
[13:28:52] ℹ️  Order extraction - Payer Source: ''
[13:28:52] ✅ Order data extraction completed successfully
[13:28:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:28:52] ℹ️  Using MRN from patient data: '3851011' over '3851011'
[13:28:52] ℹ️  Service line consistent in both sources: 'PT, RN'
[13:28:52] ✅ Patient name cross-validation successful
[13:28:52] ✅    ✅ Data merged successfully
[13:28:53] ✅    ✅ Order data extracted and validated
[13:28:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:28:53] [DOC: 9313821] ✅ Patient found in local cache: Anne Carney, ID: fdbcc0da-c295-420b-abfd-cad0bc54119e
[13:28:53] ✅    ✅ Existing patient found with ID: fdbcc0da-c295-420b-abfd-cad0bc54119e
[13:28:53] 🔄 
🔄 Step 6: Pushing order to API...
[13:28:53] [DOC: 9313821] ℹ️  Pushing order via API for patient ID: fdbcc0da-c295-420b-abfd-cad0bc54119e
[13:28:54] [DOC: 9313821] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:28:54] ❌    ❌ Failed to push order
[13:28:54] 🔄 
🔄 Step 7: Writing to CSV...
[13:28:54] [DOC: 9313821] ℹ️  Calculated age: 88 from DOB: 12/24/1936
[13:28:54] [DOC: 9313821] ℹ️  Service Line extracted: 'PT, RN'
[13:28:54] [DOC: 9313821] ℹ️  Payer Source extracted: ''
[13:28:54] [DOC: 9313821] ℹ️  Diagnosis codes being written:
[13:28:54] [DOC: 9313821] ℹ️    - Latest_Episode_Firstdiagnosis: 'M48.062'
[13:28:54] [DOC: 9313821] ℹ️    - Latest_Episode_Seconddiagnosis: 'M47.814'
[13:28:54] [DOC: 9313821] ℹ️    - Latest_Episode_Thirddiagnosis: 'M41.26'
[13:28:54] [DOC: 9313821] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M45.9'
[13:28:54] [DOC: 9313821] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M54.50'
[13:28:54] [DOC: 9313821] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M62.81'
[13:28:54] [DOC: 9313821] ✅ Patient data written to CSV: Anne Carney | Sex: FEMALE | Age: 88 | Service: PT, RN | Payer:  | MRN: 3851011
[13:28:54] ✅    ✅ Document 9313821 processed and saved successfully
[13:28:54] 🔄 
🔄 Step 8: Saving API details...
[13:28:54] [DOC: 9313821] ℹ️  API push details saved for document 9313821
[13:28:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9313817                         ║
================================================================================
[13:28:54] ℹ️  Agency: Dartmouth HH
[13:28:54] ℹ️  Date: 05/28/2025
[13:28:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[13:28:58] [DOC: 9313817] ✅ Text extracted using pdfplumber (12063 chars)
[13:28:58] ✅    ✅ Text extracted using pdfplumber (12051 chars)
[13:28:58] 🔄 
🔄 Step 2: Extracting patient data...
[13:29:01] ℹ️  AI extracted raw sex value: 'F'
[13:29:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[13:29:01] ℹ️  AI extracted payer source: ''
[13:29:01] ℹ️  AI extracted diagnoses:
[13:29:01] ℹ️    - Diagnosis 1: 'I48.0'
[13:29:01] ℹ️    - Diagnosis 2: 'J90'
[13:29:01] ℹ️    - Diagnosis 3: 'N30.01'
[13:29:01] ℹ️    - Diagnosis 4: 'R33.8'
[13:29:01] ℹ️    - Diagnosis 5: 'N75.0'
[13:29:01] ℹ️    - Diagnosis 6: 'Z46.6'
[13:29:01] ℹ️  Final extracted MRN: '3206001'
[13:29:01] ℹ️  Final extracted Sex: 'FEMALE'
[13:29:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[13:29:01] ℹ️  Final extracted Payer Source: ''
[13:29:01] ✅ Patient data extraction completed successfully
[13:29:01] ✅    ✅ Patient data extracted successfully
[13:29:01] 📊 Patient Response
     └─ patientFName: Marilyn
     └─ patientLName: Morgado
     └─ dob: 05/27/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3206001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/03/2025', 'startOfEpisode': '05/03/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': 'I48.0', 'secondDiagnosis': 'J90', 'thirdDiagnosis': 'N30.01', 'fourthDiagnosis': 'R33.8', 'fifthDiagnosis': 'N75.0', 'sixthDiagnosis': 'Z46.6'}]
[13:29:01] ✅    ✅ Patient identified: Marilyn Morgado
[13:29:01] ✅    ✅ Patient name validation passed
[13:29:01] 🔄 
🔄 Step 3: Processing patient dates...
[13:29:01] [DOC: 9313817] ℹ️  DOB normalized: 05/27/1937
[13:29:01] [DOC: 9313817] ℹ️  Episode startOfCare normalized: 05/03/2025
[13:29:01] [DOC: 9313817] ℹ️  Episode startOfEpisode normalized: 05/03/2025
[13:29:01] [DOC: 9313817] ℹ️  Episode endOfEpisode normalized: 07/01/2025
[13:29:01] [DOC: 9313817] ✅ Patient date processing completed successfully
[13:29:01] ✅    ✅ Date processing completed
[13:29:01] 📊 Processed Patient Data
     └─ patientFName: Marilyn
     └─ patientLName: Morgado
     └─ dob: 05/27/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3206001
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/03/2025', 'startOfEpisode': '05/03/2025', 'endOfEpisode': '07/01/2025', 'firstDiagnosis': 'I48.0', 'secondDiagnosis': 'J90', 'thirdDiagnosis': 'N30.01', 'fourthDiagnosis': 'R33.8', 'fifthDiagnosis': 'N75.0', 'sixthDiagnosis': 'Z46.6'}]
[13:29:01] 🔄 
🔄 Step 4: Extracting order data...
[13:29:04] ℹ️  Order extraction - MRN: '3206001'
[13:29:04] ℹ️  Order extraction - Sex: 'FEMALE'
[13:29:04] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[13:29:04] ℹ️  Order extraction - Payer Source: ''
[13:29:04] ✅ Order data extraction completed successfully
[13:29:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[13:29:04] ℹ️  Using MRN from patient data: '3206001' over '3206001'
[13:29:04] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[13:29:04] ✅ Patient name cross-validation successful
[13:29:04] ✅    ✅ Data merged successfully
[13:29:05] ✅    ✅ Order data extracted and validated
[13:29:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[13:29:05] [DOC: 9313817] ✅ Patient found in local cache: Marilyn Morgado, ID: 18cd12be-7620-4152-aa8d-1fb71b749060
[13:29:05] ✅    ✅ Existing patient found with ID: 18cd12be-7620-4152-aa8d-1fb71b749060
[13:29:05] 🔄 
🔄 Step 6: Pushing order to API...
[13:29:05] [DOC: 9313817] ℹ️  Pushing order via API for patient ID: 18cd12be-7620-4152-aa8d-1fb71b749060
[13:29:06] [DOC: 9313817] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[13:29:06] ❌    ❌ Failed to push order
[13:29:06] 🔄 
🔄 Step 7: Writing to CSV...
[13:29:06] [DOC: 9313817] ℹ️  Calculated age: 88 from DOB: 05/27/1937
[13:29:06] [DOC: 9313817] ℹ️  Service Line extracted: 'Skilled Nursing'
[13:29:06] [DOC: 9313817] ℹ️  Payer Source extracted: ''
[13:29:06] [DOC: 9313817] ℹ️  Diagnosis codes being written:
[13:29:06] [DOC: 9313817] ℹ️    - Latest_Episode_Firstdiagnosis: 'I48.0'
[13:29:06] [DOC: 9313817] ℹ️    - Latest_Episode_Seconddiagnosis: 'J90'
[13:29:06] [DOC: 9313817] ℹ️    - Latest_Episode_Thirddiagnosis: 'N30.01'
[13:29:06] [DOC: 9313817] ℹ️    - Latest_Episode_Fourthdiagnosis: 'R33.8'
[13:29:06] [DOC: 9313817] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N75.0'
[13:29:06] [DOC: 9313817] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z46.6'
[13:29:06] [DOC: 9313817] ✅ Patient data written to CSV: Marilyn Morgado | Sex: FEMALE | Age: 88 | Service: Skilled Nursing | Payer:  | MRN: 3206001
[13:29:06] ✅    ✅ Document 9313817 processed and saved successfully
[13:29:06] 🔄 
🔄 Step 8: Saving API details...
[13:29:06] [DOC: 9313817] ℹ️  API push details saved for document 9313817
[13:29:06] ✅    ✅ API details saved
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[13:29:06] ℹ️  Total Processed: 49
[13:29:06] ℹ️  CSV Success: 34
[13:29:06] ℹ️  CSV Errors: 9
[13:29:06] ℹ️  API Success: 0
[13:29:06] ℹ️  API Errors: 40
[13:29:06] ℹ️  CSV Success Rate: 69.4%
[13:29:06] ℹ️  API Success Rate: 0.0%
[13:29:06] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250607_131634.csv
[13:29:06] ℹ️  API Details File: api_outputs/api_push_details_20250607_131634.csv
================================================================================
║          ============================================================          ║
================================================================================
