================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[06:35:04] ℹ️  CSV Data Extraction & API Push Tool
[06:35:04] ℹ️  
[06:35:04] ℹ️  Features:
[06:35:04] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[06:35:04] ℹ️  - AI-powered patient and order data extraction
[06:35:04] ℹ️  - Enhanced error handling and logging
[06:35:04] ℹ️  - Full API integration (patient creation + order pushing)
[06:35:04] ℹ️  - CSV output with comprehensive patient data
[06:35:04] ℹ️  - Detailed API tracking with remarks for every document
[06:35:04] ℹ️  - Complete audit trail of all processing attempts
[06:35:04] ℹ️  
[06:35:04] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[06:35:04] ✅ Created output CSV file: csv_outputs/extracted_patients_20250608_063504.csv
[06:35:04] ✅ Created API details CSV file: api_outputs/api_push_details_20250608_063504.csv
================================================================================
║                        Processing Document ID: 9240062                         ║
================================================================================
[06:35:04] ℹ️  Agency: Dartmouth HH
[06:35:04] ℹ️  Date: 04/15/2025
[06:35:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:35:07] [DOC: 9240062] ✅ Text extracted using pdfplumber (13047 chars)
[06:35:07] ✅    ✅ Text extracted using pdfplumber (13035 chars)
[06:35:07] 🔄 
🔄 Step 2: Extracting patient data...
[06:35:12] ℹ️  AI extracted raw sex value: 'M'
[06:35:12] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[06:35:12] ℹ️  AI extracted payer source: 'None'
[06:35:12] ℹ️  AI extracted diagnoses:
[06:35:12] ℹ️    - Diagnosis 1: 'A41.9'
[06:35:12] ℹ️    - Diagnosis 2: 'N39.0'
[06:35:12] ℹ️    - Diagnosis 3: 'N40.1'
[06:35:12] ℹ️    - Diagnosis 4: 'N13.8'
[06:35:12] ℹ️    - Diagnosis 5: 'K50.90'
[06:35:12] ℹ️    - Diagnosis 6: 'I10'
[06:35:12] ℹ️  Final extracted MRN: '227027'
[06:35:12] ℹ️  Final extracted Sex: 'MALE'
[06:35:12] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[06:35:12] ℹ️  Final extracted Payer Source: ''
[06:35:12] ✅ Patient data extraction completed successfully
[06:35:12] ✅    ✅ Patient data extracted successfully
[06:35:12] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Teixeira
     └─ dob: 12/29/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'A41.9', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'N40.1', 'fourthDiagnosis': 'N13.8', 'fifthDiagnosis': 'K50.90', 'sixthDiagnosis': 'I10'}]
[06:35:12] ✅    ✅ Patient identified: David Teixeira
[06:35:12] ✅    ✅ Patient name validation passed
[06:35:12] 🔄 
🔄 Step 3: Processing patient dates...
[06:35:12] [DOC: 9240062] ℹ️  DOB normalized: 12/29/1956
[06:35:12] [DOC: 9240062] ℹ️  Episode startOfCare normalized: 04/07/2025
[06:35:12] [DOC: 9240062] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[06:35:12] [DOC: 9240062] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[06:35:12] [DOC: 9240062] ✅ Patient date processing completed successfully
[06:35:12] ✅    ✅ Date processing completed
[06:35:12] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Teixeira
     └─ dob: 12/29/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/07/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'A41.9', 'secondDiagnosis': 'N39.0', 'thirdDiagnosis': 'N40.1', 'fourthDiagnosis': 'N13.8', 'fifthDiagnosis': 'K50.90', 'sixthDiagnosis': 'I10'}]
[06:35:12] 🔄 
🔄 Step 4: Extracting order data...
[06:35:14] ℹ️  Order extraction - MRN: '227027'
[06:35:14] ℹ️  Order extraction - Sex: 'MALE'
[06:35:14] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[06:35:14] ℹ️  Order extraction - Payer Source: ''
[06:35:14] ✅ Order data extraction completed successfully
[06:35:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:35:14] ℹ️  Using MRN from patient data: '227027' over '227027'
[06:35:14] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT'
[06:35:14] ✅ Patient name cross-validation successful
[06:35:14] ✅    ✅ Data merged successfully
[06:35:16] ✅    ✅ Order data extracted and validated
[06:35:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:35:16] [DOC: 9240062] ✅ Patient found in local cache: David Teixeira, ID: 92d56142-8dce-415a-ac6f-6020de943b51
[06:35:16] ✅    ✅ Existing patient found with ID: 92d56142-8dce-415a-ac6f-6020de943b51
[06:35:16] 🔄 
🔄 Step 6: Pushing order to API...
[06:35:16] [DOC: 9240062] ℹ️  Pushing order via API for patient ID: 92d56142-8dce-415a-ac6f-6020de943b51
[06:35:18] [DOC: 9240062] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:35:18] ❌    ❌ Failed to push order
[06:35:18] 🔄 
🔄 Step 7: Writing to CSV...
[06:35:18] [DOC: 9240062] ℹ️  Calculated age: 68 from DOB: 12/29/1956
[06:35:18] [DOC: 9240062] ℹ️  Service Line extracted: 'Skilled Nursing, PT'
[06:35:18] [DOC: 9240062] ℹ️  Payer Source extracted: ''
[06:35:18] [DOC: 9240062] ℹ️  Diagnosis codes being written:
[06:35:18] [DOC: 9240062] ℹ️    - Latest_Episode_Firstdiagnosis: 'A41.9'
[06:35:18] [DOC: 9240062] ℹ️    - Latest_Episode_Seconddiagnosis: 'N39.0'
[06:35:18] [DOC: 9240062] ℹ️    - Latest_Episode_Thirddiagnosis: 'N40.1'
[06:35:18] [DOC: 9240062] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N13.8'
[06:35:18] [DOC: 9240062] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K50.90'
[06:35:18] [DOC: 9240062] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I10'
[06:35:18] [DOC: 9240062] ✅ Patient data written to CSV: David Teixeira | Sex: MALE | Age: 68 | Service: Skilled Nursing, PT | Payer:  | MRN: 227027
[06:35:18] ✅    ✅ Document 9240062 processed and saved successfully
[06:35:18] 🔄 
🔄 Step 8: Saving API details...
[06:35:18] [DOC: 9240062] ℹ️  API push details saved for document 9240062
[06:35:18] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240060                         ║
================================================================================
[06:35:18] ℹ️  Agency: Dartmouth HH
[06:35:18] ℹ️  Date: 04/15/2025
[06:35:18] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:35:20] [DOC: 9240060] ✅ Text extracted using pdfplumber (1107 chars)
[06:35:20] ✅    ✅ Text extracted using pdfplumber (1107 chars)
[06:35:20] 🔄 
🔄 Step 2: Extracting patient data...
[06:35:23] ℹ️  AI extracted raw sex value: 'M'
[06:35:23] ℹ️  AI extracted service line: 'RN'
[06:35:23] ℹ️  AI extracted payer source: 'Medicare'
[06:35:23] ℹ️  AI extracted diagnoses:
[06:35:23] ℹ️    - Diagnosis 1: 'None'
[06:35:23] ℹ️    - Diagnosis 2: 'None'
[06:35:23] ℹ️    - Diagnosis 3: 'None'
[06:35:23] ℹ️    - Diagnosis 4: 'None'
[06:35:23] ℹ️    - Diagnosis 5: 'None'
[06:35:23] ℹ️    - Diagnosis 6: 'None'
[06:35:23] ℹ️  Final extracted MRN: '5564011'
[06:35:23] ℹ️  Final extracted Sex: 'MALE'
[06:35:23] ℹ️  Final extracted Service Line: 'RN'
[06:35:23] ℹ️  Final extracted Payer Source: 'Medicare'
[06:35:23] ✅ Patient data extraction completed successfully
[06:35:23] ✅    ✅ Patient data extracted successfully
[06:35:23] 📊 Patient Response
     └─ patientFName: Chauncey
     └─ patientLName: Geer Jr,
     └─ dob: 10/27/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 5564011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:35:23] ✅    ✅ Patient identified: Chauncey Geer Jr,
[06:35:23] ✅    ✅ Patient name validation passed
[06:35:23] 🔄 
🔄 Step 3: Processing patient dates...
[06:35:23] [DOC: 9240060] ℹ️  DOB normalized: 10/27/1935
[06:35:23] [DOC: 9240060] ℹ️  Episode startOfCare normalized: 01/26/2025
[06:35:23] [DOC: 9240060] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[06:35:23] [DOC: 9240060] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[06:35:23] [DOC: 9240060] ✅ Patient date processing completed successfully
[06:35:23] ✅    ✅ Date processing completed
[06:35:23] 📊 Processed Patient Data
     └─ patientFName: Chauncey
     └─ patientLName: Geer Jr,
     └─ dob: 10/27/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 5564011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025'}]
[06:35:23] 🔄 
🔄 Step 4: Extracting order data...
[06:35:26] ℹ️  Order extraction - MRN: ''
[06:35:26] ℹ️  Order extraction - Sex: 'MALE'
[06:35:26] ℹ️  Order extraction - Service Line: 'RN'
[06:35:26] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:35:26] ✅ Order data extraction completed successfully
[06:35:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:35:26] ℹ️  Using MRN from patient data: '5564011'
[06:35:26] ℹ️  Service line consistent in both sources: 'RN'
[06:35:26] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:35:26] ✅ Patient name cross-validation successful
[06:35:26] ✅    ✅ Data merged successfully
[06:35:27] ✅    ✅ Order data extracted and validated
[06:35:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:35:47] [DOC: 9240060] ✅ Patient exists in API: Chauncey Geer Jr,, ID: 5f36389d-bdd3-45b9-9d8a-d2096383a006
[06:35:47] ✅    ✅ Existing patient found with ID: 5f36389d-bdd3-45b9-9d8a-d2096383a006
[06:35:47] 🔄 
🔄 Step 6: Pushing order to API...
[06:35:47] [DOC: 9240060] ℹ️  Pushing order via API for patient ID: 5f36389d-bdd3-45b9-9d8a-d2096383a006
[06:35:49] [DOC: 9240060] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13779"}
[06:35:49] ❌    ❌ Failed to push order
[06:35:49] 🔄 
🔄 Step 7: Writing to CSV...
[06:35:49] [DOC: 9240060] ℹ️  Calculated age: 89 from DOB: 10/27/1935
[06:35:49] [DOC: 9240060] ℹ️  Service Line extracted: 'RN'
[06:35:49] [DOC: 9240060] ℹ️  Payer Source extracted: 'Medicare'
[06:35:49] [DOC: 9240060] ℹ️  Diagnosis codes being written:
[06:35:49] [DOC: 9240060] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:35:49] [DOC: 9240060] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:35:49] [DOC: 9240060] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:35:49] [DOC: 9240060] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:35:49] [DOC: 9240060] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:35:49] [DOC: 9240060] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:35:49] [DOC: 9240060] ✅ Patient data written to CSV: Chauncey Geer Jr, | Sex: MALE | Age: 89 | Service: RN | Payer: Medicare | MRN: 5564011
[06:35:49] ✅    ✅ Document 9240060 processed and saved successfully
[06:35:49] 🔄 
🔄 Step 8: Saving API details...
[06:35:49] [DOC: 9240060] ℹ️  API push details saved for document 9240060
[06:35:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240059                         ║
================================================================================
[06:35:49] ℹ️  Agency: Dartmouth HH
[06:35:49] ℹ️  Date: 04/15/2025
[06:35:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:35:53] [DOC: 9240059] ✅ Text extracted using pdfplumber (4391 chars)
[06:35:53] ✅    ✅ Text extracted using pdfplumber (4391 chars)
[06:35:53] 🔄 
🔄 Step 2: Extracting patient data...
[06:35:56] ℹ️  AI extracted raw sex value: 'F'
[06:35:56] ℹ️  AI extracted service line: 'Speech Therapy'
[06:35:56] ℹ️  AI extracted payer source: 'Medicare'
[06:35:56] ℹ️  AI extracted diagnoses:
[06:35:56] ℹ️    - Diagnosis 1: 'Hypoxemia'
[06:35:56] ℹ️    - Diagnosis 2: 'interstitial lung disease'
[06:35:56] ℹ️    - Diagnosis 3: ''
[06:35:56] ℹ️    - Diagnosis 4: ''
[06:35:56] ℹ️    - Diagnosis 5: ''
[06:35:56] ℹ️    - Diagnosis 6: ''
[06:35:56] ℹ️  Final extracted MRN: '4799015'
[06:35:56] ℹ️  Final extracted Sex: 'FEMALE'
[06:35:56] ℹ️  Final extracted Service Line: 'Speech Therapy'
[06:35:56] ℹ️  Final extracted Payer Source: 'Medicare'
[06:35:56] ✅ Patient data extraction completed successfully
[06:35:56] ✅    ✅ Patient data extracted successfully
[06:35:56] 📊 Patient Response
     └─ patientFName: Agatina
     └─ patientLName: Manna
     └─ dob: 03/10/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4799015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Speech Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/17/2024', 'startOfEpisode': '11/17/2024', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'Hypoxemia', 'secondDiagnosis': 'interstitial lung disease', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:35:56] ✅    ✅ Patient identified: Agatina Manna
[06:35:56] ✅    ✅ Patient name validation passed
[06:35:56] 🔄 
🔄 Step 3: Processing patient dates...
[06:35:56] [DOC: 9240059] ℹ️  DOB normalized: 03/10/1937
[06:35:56] [DOC: 9240059] ℹ️  Episode startOfCare normalized: 11/17/2024
[06:35:56] [DOC: 9240059] ℹ️  Episode startOfEpisode normalized: 11/17/2024
[06:35:56] [DOC: 9240059] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[06:35:56] [DOC: 9240059] ✅ Patient date processing completed successfully
[06:35:56] ✅    ✅ Date processing completed
[06:35:56] 📊 Processed Patient Data
     └─ patientFName: Agatina
     └─ patientLName: Manna
     └─ dob: 03/10/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4799015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Speech Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/17/2024', 'startOfEpisode': '11/17/2024', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'Hypoxemia', 'secondDiagnosis': 'interstitial lung disease', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:35:56] 🔄 
🔄 Step 4: Extracting order data...
[06:35:58] ℹ️  Order extraction - MRN: ''
[06:35:58] ℹ️  Order extraction - Sex: 'FEMALE'
[06:35:58] ℹ️  Order extraction - Service Line: 'ST'
[06:35:58] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:35:58] ✅ Order data extraction completed successfully
[06:35:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:35:58] ℹ️  Using MRN from patient data: '4799015'
[06:35:58] ℹ️  Combined service lines: Patient='Speech Therapy' + Order='ST' = 'ST, Speech Therapy'
[06:35:58] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:35:58] ✅ Patient name cross-validation successful
[06:35:58] ✅    ✅ Data merged successfully
[06:36:00] ✅    ✅ Order data extracted and validated
[06:36:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:36:00] [DOC: 9240059] ✅ Patient found in local cache: Agatina Manna, ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[06:36:00] ✅    ✅ Existing patient found with ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[06:36:00] 🔄 
🔄 Step 6: Pushing order to API...
[06:36:00] [DOC: 9240059] ℹ️  Pushing order via API for patient ID: 6d8965a4-2ff9-44c3-82d8-741d64157c20
[06:36:01] [DOC: 9240059] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:36:01] ❌    ❌ Failed to push order
[06:36:01] 🔄 
🔄 Step 7: Writing to CSV...
[06:36:01] [DOC: 9240059] ℹ️  Calculated age: 88 from DOB: 03/10/1937
[06:36:01] [DOC: 9240059] ℹ️  Service Line extracted: 'ST, Speech Therapy'
[06:36:01] [DOC: 9240059] ℹ️  Payer Source extracted: 'Medicare'
[06:36:01] [DOC: 9240059] ℹ️  Diagnosis codes being written:
[06:36:01] [DOC: 9240059] ℹ️    - Latest_Episode_Firstdiagnosis: 'Hypoxemia'
[06:36:01] [DOC: 9240059] ℹ️    - Latest_Episode_Seconddiagnosis: 'interstitial lung disease'
[06:36:01] [DOC: 9240059] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:36:01] [DOC: 9240059] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:36:01] [DOC: 9240059] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:36:01] [DOC: 9240059] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:36:01] [DOC: 9240059] ✅ Patient data written to CSV: Agatina Manna | Sex: FEMALE | Age: 88 | Service: ST, Speech Therapy | Payer: Medicare | MRN: 4799015
[06:36:01] ✅    ✅ Document 9240059 processed and saved successfully
[06:36:01] 🔄 
🔄 Step 8: Saving API details...
[06:36:01] [DOC: 9240059] ℹ️  API push details saved for document 9240059
[06:36:01] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240055                         ║
================================================================================
[06:36:01] ℹ️  Agency: Dartmouth HH
[06:36:01] ℹ️  Date: 04/15/2025
[06:36:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:36:03] [DOC: 9240055] ✅ Text extracted using pdfplumber (1129 chars)
[06:36:03] ✅    ✅ Text extracted using pdfplumber (1129 chars)
[06:36:03] 🔄 
🔄 Step 2: Extracting patient data...
[06:36:05] ℹ️  AI extracted raw sex value: 'M'
[06:36:05] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:36:05] ℹ️  AI extracted payer source: 'Medicare'
[06:36:05] ℹ️  AI extracted diagnoses:
[06:36:05] ℹ️    - Diagnosis 1: ''
[06:36:05] ℹ️    - Diagnosis 2: ''
[06:36:05] ℹ️    - Diagnosis 3: ''
[06:36:05] ℹ️    - Diagnosis 4: ''
[06:36:05] ℹ️    - Diagnosis 5: ''
[06:36:05] ℹ️    - Diagnosis 6: ''
[06:36:05] ℹ️  Final extracted MRN: '6140015'
[06:36:05] ℹ️  Final extracted Sex: 'MALE'
[06:36:05] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:36:05] ℹ️  Final extracted Payer Source: 'Medicare'
[06:36:05] ✅ Patient data extraction completed successfully
[06:36:05] ✅    ✅ Patient data extracted successfully
[06:36:05] 📊 Patient Response
     └─ patientFName: Ernest
     └─ patientLName: Barboza
     └─ dob: 02/22/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 6140015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:36:05] ✅    ✅ Patient identified: Ernest Barboza
[06:36:05] ✅    ✅ Patient name validation passed
[06:36:05] 🔄 
🔄 Step 3: Processing patient dates...
[06:36:05] [DOC: 9240055] ℹ️  DOB normalized: 02/22/1937
[06:36:05] [DOC: 9240055] ℹ️  Episode startOfCare normalized: 03/06/2025
[06:36:05] [DOC: 9240055] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[06:36:05] [DOC: 9240055] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[06:36:05] [DOC: 9240055] ✅ Patient date processing completed successfully
[06:36:05] ✅    ✅ Date processing completed
[06:36:05] 📊 Processed Patient Data
     └─ patientFName: Ernest
     └─ patientLName: Barboza
     └─ dob: 02/22/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 6140015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:36:05] 🔄 
🔄 Step 4: Extracting order data...
[06:36:08] ℹ️  Order extraction - MRN: ''
[06:36:08] ℹ️  Order extraction - Sex: 'MALE'
[06:36:08] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:36:08] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:36:08] ✅ Order data extraction completed successfully
[06:36:08] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:36:08] ℹ️  Using MRN from patient data: '6140015'
[06:36:08] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:36:08] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:36:08] ✅ Patient name cross-validation successful
[06:36:08] ✅    ✅ Data merged successfully
[06:36:10] ✅    ✅ Order data extracted and validated
[06:36:10] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:36:10] [DOC: 9240055] ✅ Patient found in local cache: Ernest Barboza, ID: adb22793-6127-48ac-9c27-184ca9af82cc
[06:36:10] ✅    ✅ Existing patient found with ID: adb22793-6127-48ac-9c27-184ca9af82cc
[06:36:10] 🔄 
🔄 Step 6: Pushing order to API...
[06:36:10] [DOC: 9240055] ℹ️  Pushing order via API for patient ID: adb22793-6127-48ac-9c27-184ca9af82cc
[06:36:11] [DOC: 9240055] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13004"}
[06:36:11] ❌    ❌ Failed to push order
[06:36:11] 🔄 
🔄 Step 7: Writing to CSV...
[06:36:11] [DOC: 9240055] ℹ️  Calculated age: 88 from DOB: 02/22/1937
[06:36:11] [DOC: 9240055] ℹ️  Service Line extracted: 'Skilled Nursing'
[06:36:11] [DOC: 9240055] ℹ️  Payer Source extracted: 'Medicare'
[06:36:11] [DOC: 9240055] ℹ️  Diagnosis codes being written:
[06:36:11] [DOC: 9240055] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:36:11] [DOC: 9240055] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:36:11] [DOC: 9240055] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:36:11] [DOC: 9240055] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:36:11] [DOC: 9240055] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:36:11] [DOC: 9240055] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:36:11] [DOC: 9240055] ✅ Patient data written to CSV: Ernest Barboza | Sex: MALE | Age: 88 | Service: Skilled Nursing | Payer: Medicare | MRN: 6140015
[06:36:11] ✅    ✅ Document 9240055 processed and saved successfully
[06:36:11] 🔄 
🔄 Step 8: Saving API details...
[06:36:11] [DOC: 9240055] ℹ️  API push details saved for document 9240055
[06:36:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240054                         ║
================================================================================
[06:36:11] ℹ️  Agency: Dartmouth HH
[06:36:11] ℹ️  Date: 04/15/2025
[06:36:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:36:13] [DOC: 9240054] ✅ Text extracted using pdfplumber (1537 chars)
[06:36:13] ✅    ✅ Text extracted using pdfplumber (1537 chars)
[06:36:13] 🔄 
🔄 Step 2: Extracting patient data...
[06:36:16] ℹ️  AI extracted raw sex value: 'F'
[06:36:16] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:36:16] ℹ️  AI extracted payer source: 'Aetna- Mcare'
[06:36:16] ℹ️  AI extracted diagnoses:
[06:36:16] ℹ️    - Diagnosis 1: 'hypercholesteremia'
[06:36:16] ℹ️    - Diagnosis 2: ''
[06:36:16] ℹ️    - Diagnosis 3: ''
[06:36:16] ℹ️    - Diagnosis 4: ''
[06:36:16] ℹ️    - Diagnosis 5: ''
[06:36:16] ℹ️    - Diagnosis 6: ''
[06:36:16] ℹ️  Final extracted MRN: '6204015'
[06:36:16] ℹ️  Final extracted Sex: 'FEMALE'
[06:36:16] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:36:16] ℹ️  Final extracted Payer Source: 'Aetna- Mcare'
[06:36:16] ✅ Patient data extraction completed successfully
[06:36:16] ✅    ✅ Patient data extracted successfully
[06:36:16] 📊 Patient Response
     └─ patientFName: Rita
     └─ patientLName: Costa
     └─ dob: 10/16/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6204015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 32 Newbury Ave
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'hypercholesteremia', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:36:16] ✅    ✅ Patient identified: Rita Costa
[06:36:16] ✅    ✅ Patient name validation passed
[06:36:16] 🔄 
🔄 Step 3: Processing patient dates...
[06:36:16] [DOC: 9240054] ℹ️  DOB normalized: 10/16/1930
[06:36:16] [DOC: 9240054] ℹ️  Episode startOfCare normalized: 03/17/2025
[06:36:16] [DOC: 9240054] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[06:36:16] [DOC: 9240054] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[06:36:16] [DOC: 9240054] ✅ Patient date processing completed successfully
[06:36:16] ✅    ✅ Date processing completed
[06:36:16] 📊 Processed Patient Data
     └─ patientFName: Rita
     └─ patientLName: Costa
     └─ dob: 10/16/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6204015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 32 Newbury Ave
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Aetna- Mcare
     └─ episodeDiagnoses: [{'startOfCare': '03/17/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'hypercholesteremia', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:36:16] 🔄 
🔄 Step 4: Extracting order data...
[06:36:18] ℹ️  Order extraction - MRN: ''
[06:36:18] ℹ️  Order extraction - Sex: 'FEMALE'
[06:36:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:36:18] ℹ️  Order extraction - Payer Source: 'Aetna- Mcare'
[06:36:18] ✅ Order data extraction completed successfully
[06:36:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:36:18] ℹ️  Using MRN from patient data: '6204015'
[06:36:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:36:18] ℹ️  Payer source consistent in both sources: 'Aetna- Mcare'
[06:36:18] ✅ Patient name cross-validation successful
[06:36:18] ✅    ✅ Data merged successfully
[06:36:20] ✅    ✅ Order data extracted and validated
[06:36:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:36:20] [DOC: 9240054] ✅ Patient found in local cache: Rita Costa, ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[06:36:20] ✅    ✅ Existing patient found with ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[06:36:20] 🔄 
🔄 Step 6: Pushing order to API...
[06:36:20] [DOC: 9240054] ℹ️  Pushing order via API for patient ID: 4aa7c3ef-5354-42d0-952b-24b7381eb84d
[06:36:21] [DOC: 9240054] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:36:21] ❌    ❌ Failed to push order
[06:36:21] 🔄 
🔄 Step 7: Writing to CSV...
[06:36:21] [DOC: 9240054] ℹ️  Calculated age: 94 from DOB: 10/16/1930
[06:36:21] [DOC: 9240054] ℹ️  Service Line extracted: 'Skilled Nursing'
[06:36:21] [DOC: 9240054] ℹ️  Payer Source extracted: 'Aetna- Mcare'
[06:36:21] [DOC: 9240054] ℹ️  Diagnosis codes being written:
[06:36:21] [DOC: 9240054] ℹ️    - Latest_Episode_Firstdiagnosis: 'hypercholesteremia'
[06:36:21] [DOC: 9240054] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:36:21] [DOC: 9240054] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:36:21] [DOC: 9240054] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:36:21] [DOC: 9240054] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:36:21] [DOC: 9240054] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:36:21] [DOC: 9240054] ✅ Patient data written to CSV: Rita Costa | Sex: FEMALE | Age: 94 | Service: Skilled Nursing | Payer: Aetna- Mcare | MRN: 6204015
[06:36:21] ✅    ✅ Document 9240054 processed and saved successfully
[06:36:21] 🔄 
🔄 Step 8: Saving API details...
[06:36:21] [DOC: 9240054] ℹ️  API push details saved for document 9240054
[06:36:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240052                         ║
================================================================================
[06:36:21] ℹ️  Agency: Dartmouth HH
[06:36:21] ℹ️  Date: 04/15/2025
[06:36:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:36:24] [DOC: 9240052] ✅ Text extracted using pdfplumber (7381 chars)
[06:36:24] ✅    ✅ Text extracted using pdfplumber (7381 chars)
[06:36:24] 🔄 
🔄 Step 2: Extracting patient data...
[06:36:26] ℹ️  AI extracted raw sex value: 'M'
[06:36:26] ℹ️  AI extracted service line: 'Speech Therapy'
[06:36:26] ℹ️  AI extracted payer source: 'Medicare'
[06:36:26] ℹ️  AI extracted diagnoses:
[06:36:26] ℹ️    - Diagnosis 1: 'C-DIFF - Colitis'
[06:36:26] ℹ️    - Diagnosis 2: 'Parkinson's'
[06:36:26] ℹ️    - Diagnosis 3: 'prostate CA'
[06:36:26] ℹ️    - Diagnosis 4: 'BPH'
[06:36:26] ℹ️    - Diagnosis 5: 'GERD'
[06:36:26] ℹ️    - Diagnosis 6: 'anemia'
[06:36:26] ℹ️  Final extracted MRN: '1396009'
[06:36:26] ℹ️  Final extracted Sex: 'MALE'
[06:36:26] ℹ️  Final extracted Service Line: 'Speech Therapy'
[06:36:26] ℹ️  Final extracted Payer Source: 'Medicare'
[06:36:26] ✅ Patient data extraction completed successfully
[06:36:26] ✅    ✅ Patient data extracted successfully
[06:36:26] 📊 Patient Response
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Speech Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'C-DIFF - Colitis', 'secondDiagnosis': "Parkinson's", 'thirdDiagnosis': 'prostate CA', 'fourthDiagnosis': 'BPH', 'fifthDiagnosis': 'GERD', 'sixthDiagnosis': 'anemia'}]
[06:36:26] ✅    ✅ Patient identified: Elias Ramos
[06:36:26] ✅    ✅ Patient name validation passed
[06:36:26] 🔄 
🔄 Step 3: Processing patient dates...
[06:36:26] [DOC: 9240052] ℹ️  DOB normalized: 08/28/1938
[06:36:26] [DOC: 9240052] ℹ️  Episode startOfCare normalized: 12/31/2024
[06:36:26] [DOC: 9240052] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[06:36:26] [DOC: 9240052] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[06:36:26] [DOC: 9240052] ✅ Patient date processing completed successfully
[06:36:26] ✅    ✅ Date processing completed
[06:36:26] 📊 Processed Patient Data
     └─ patientFName: Elias
     └─ patientLName: Ramos
     └─ dob: 08/28/1938
     └─ patientSex: MALE
     └─ medicalRecordNo: 1396009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Speech Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/31/2024', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': 'C-DIFF - Colitis', 'secondDiagnosis': "Parkinson's", 'thirdDiagnosis': 'prostate CA', 'fourthDiagnosis': 'BPH', 'fifthDiagnosis': 'GERD', 'sixthDiagnosis': 'anemia'}]
[06:36:26] 🔄 
🔄 Step 4: Extracting order data...
[06:36:29] ℹ️  Order extraction - MRN: ''
[06:36:29] ℹ️  Order extraction - Sex: 'MALE'
[06:36:29] ℹ️  Order extraction - Service Line: 'ST'
[06:36:29] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:36:29] ✅ Order data extraction completed successfully
[06:36:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:36:29] ℹ️  Using MRN from patient data: '1396009'
[06:36:29] ℹ️  Combined service lines: Patient='Speech Therapy' + Order='ST' = 'ST, Speech Therapy'
[06:36:29] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:36:29] ✅ Patient name cross-validation successful
[06:36:29] ✅    ✅ Data merged successfully
[06:36:31] ✅    ✅ Order data extracted and validated
[06:36:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:36:31] [DOC: 9240052] ✅ Patient found in local cache: Elias Ramos, ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[06:36:31] ✅    ✅ Existing patient found with ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[06:36:31] 🔄 
🔄 Step 6: Pushing order to API...
[06:36:31] [DOC: 9240052] ℹ️  Pushing order via API for patient ID: ec9635b3-a909-4fbb-8388-2475ca523c27
[06:36:32] [DOC: 9240052] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:36:32] ❌    ❌ Failed to push order
[06:36:32] 🔄 
🔄 Step 7: Writing to CSV...
[06:36:32] [DOC: 9240052] ℹ️  Calculated age: 86 from DOB: 08/28/1938
[06:36:32] [DOC: 9240052] ℹ️  Service Line extracted: 'ST, Speech Therapy'
[06:36:32] [DOC: 9240052] ℹ️  Payer Source extracted: 'Medicare'
[06:36:32] [DOC: 9240052] ℹ️  Diagnosis codes being written:
[06:36:32] [DOC: 9240052] ℹ️    - Latest_Episode_Firstdiagnosis: 'C-DIFF - Colitis'
[06:36:32] [DOC: 9240052] ℹ️    - Latest_Episode_Seconddiagnosis: 'Parkinson's'
[06:36:32] [DOC: 9240052] ℹ️    - Latest_Episode_Thirddiagnosis: 'prostate CA'
[06:36:32] [DOC: 9240052] ℹ️    - Latest_Episode_Fourthdiagnosis: 'BPH'
[06:36:32] [DOC: 9240052] ℹ️    - Latest_Episode_Fifthdiagnosis: 'GERD'
[06:36:32] [DOC: 9240052] ℹ️    - Latest_Episode_Sixthdiagnosis: 'anemia'
[06:36:32] [DOC: 9240052] ✅ Patient data written to CSV: Elias Ramos | Sex: MALE | Age: 86 | Service: ST, Speech Therapy | Payer: Medicare | MRN: 1396009
[06:36:32] ✅    ✅ Document 9240052 processed and saved successfully
[06:36:32] 🔄 
🔄 Step 8: Saving API details...
[06:36:32] [DOC: 9240052] ℹ️  API push details saved for document 9240052
[06:36:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240051                         ║
================================================================================
[06:36:32] ℹ️  Agency: Dartmouth HH
[06:36:32] ℹ️  Date: 04/15/2025
[06:36:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:36:34] [DOC: 9240051] ✅ Text extracted using pdfplumber (4607 chars)
[06:36:34] ✅    ✅ Text extracted using pdfplumber (4607 chars)
[06:36:34] 🔄 
🔄 Step 2: Extracting patient data...
[06:36:37] ℹ️  AI extracted raw sex value: 'M'
[06:36:37] ℹ️  AI extracted service line: 'PT, SN, OT'
[06:36:37] ℹ️  AI extracted payer source: 'Medicare'
[06:36:37] ℹ️  AI extracted diagnoses:
[06:36:37] ℹ️    - Diagnosis 1: 'CHF'
[06:36:37] ℹ️    - Diagnosis 2: 'AFIB'
[06:36:37] ℹ️    - Diagnosis 3: 'depression'
[06:36:37] ℹ️    - Diagnosis 4: 'HTN'
[06:36:37] ℹ️    - Diagnosis 5: 'HLD'
[06:36:37] ℹ️    - Diagnosis 6: 'lumbar spondylosis'
[06:36:37] ℹ️  Final extracted MRN: '6190015'
[06:36:37] ℹ️  Final extracted Sex: 'MALE'
[06:36:37] ℹ️  Final extracted Service Line: 'PT, SN, OT'
[06:36:37] ℹ️  Final extracted Payer Source: 'Medicare'
[06:36:37] ✅ Patient data extraction completed successfully
[06:36:37] ✅    ✅ Patient data extracted successfully
[06:36:37] 📊 Patient Response
     └─ patientFName: John
     └─ patientLName: Ostapow
     └─ dob: 11/23/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 6190015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, SN, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'CHF', 'secondDiagnosis': 'AFIB', 'thirdDiagnosis': 'depression', 'fourthDiagnosis': 'HTN', 'fifthDiagnosis': 'HLD', 'sixthDiagnosis': 'lumbar spondylosis'}]
[06:36:37] ✅    ✅ Patient identified: John Ostapow
[06:36:37] ✅    ✅ Patient name validation passed
[06:36:37] 🔄 
🔄 Step 3: Processing patient dates...
[06:36:37] [DOC: 9240051] ℹ️  DOB normalized: 11/23/1935
[06:36:37] [DOC: 9240051] ℹ️  Episode startOfCare normalized: 03/12/2025
[06:36:37] [DOC: 9240051] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[06:36:37] [DOC: 9240051] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[06:36:37] [DOC: 9240051] ✅ Patient date processing completed successfully
[06:36:37] ✅    ✅ Date processing completed
[06:36:37] 📊 Processed Patient Data
     └─ patientFName: John
     └─ patientLName: Ostapow
     └─ dob: 11/23/1935
     └─ patientSex: MALE
     └─ medicalRecordNo: 6190015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, SN, OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': 'CHF', 'secondDiagnosis': 'AFIB', 'thirdDiagnosis': 'depression', 'fourthDiagnosis': 'HTN', 'fifthDiagnosis': 'HLD', 'sixthDiagnosis': 'lumbar spondylosis'}]
[06:36:37] 🔄 
🔄 Step 4: Extracting order data...
[06:36:40] ℹ️  Order extraction - MRN: ''
[06:36:40] ℹ️  Order extraction - Sex: 'MALE'
[06:36:40] ℹ️  Order extraction - Service Line: 'PT'
[06:36:40] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:36:40] ✅ Order data extraction completed successfully
[06:36:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:36:40] ℹ️  Using MRN from patient data: '6190015'
[06:36:40] ℹ️  Combined service lines: Patient='PT, SN, OT' + Order='PT' = 'OT, PT, SN'
[06:36:40] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:36:40] ✅ Patient name cross-validation successful
[06:36:40] ✅    ✅ Data merged successfully
[06:36:41] ✅    ✅ Order data extracted and validated
[06:36:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:36:41] [DOC: 9240051] ✅ Patient found in local cache: John Ostapow, ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[06:36:41] ✅    ✅ Existing patient found with ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[06:36:41] 🔄 
🔄 Step 6: Pushing order to API...
[06:36:41] [DOC: 9240051] ℹ️  Pushing order via API for patient ID: 402ee4cc-dae9-4fba-9d9e-8274ed3f7b62
[06:36:43] [DOC: 9240051] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12966"}
[06:36:43] ❌    ❌ Failed to push order
[06:36:43] 🔄 
🔄 Step 7: Writing to CSV...
[06:36:43] [DOC: 9240051] ℹ️  Calculated age: 89 from DOB: 11/23/1935
[06:36:43] [DOC: 9240051] ℹ️  Service Line extracted: 'OT, PT, SN'
[06:36:43] [DOC: 9240051] ℹ️  Payer Source extracted: 'Medicare'
[06:36:43] [DOC: 9240051] ℹ️  Diagnosis codes being written:
[06:36:43] [DOC: 9240051] ℹ️    - Latest_Episode_Firstdiagnosis: 'CHF'
[06:36:43] [DOC: 9240051] ℹ️    - Latest_Episode_Seconddiagnosis: 'AFIB'
[06:36:43] [DOC: 9240051] ℹ️    - Latest_Episode_Thirddiagnosis: 'depression'
[06:36:43] [DOC: 9240051] ℹ️    - Latest_Episode_Fourthdiagnosis: 'HTN'
[06:36:43] [DOC: 9240051] ℹ️    - Latest_Episode_Fifthdiagnosis: 'HLD'
[06:36:43] [DOC: 9240051] ℹ️    - Latest_Episode_Sixthdiagnosis: 'lumbar spondylosis'
[06:36:43] [DOC: 9240051] ✅ Patient data written to CSV: John Ostapow | Sex: MALE | Age: 89 | Service: OT, PT, SN | Payer: Medicare | MRN: 6190015
[06:36:43] ✅    ✅ Document 9240051 processed and saved successfully
[06:36:43] 🔄 
🔄 Step 8: Saving API details...
[06:36:43] [DOC: 9240051] ℹ️  API push details saved for document 9240051
[06:36:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240050                         ║
================================================================================
[06:36:43] ℹ️  Agency: Dartmouth HH
[06:36:43] ℹ️  Date: 04/15/2025
[06:36:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:36:45] [DOC: 9240050] ✅ Text extracted using pdfplumber (1195 chars)
[06:36:45] ✅    ✅ Text extracted using pdfplumber (1195 chars)
[06:36:45] 🔄 
🔄 Step 2: Extracting patient data...
[06:36:48] ℹ️  AI extracted raw sex value: 'M'
[06:36:48] ℹ️  AI extracted service line: 'RN'
[06:36:48] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[06:36:48] ℹ️  AI extracted diagnoses:
[06:36:48] ℹ️    - Diagnosis 1: ''
[06:36:48] ℹ️    - Diagnosis 2: ''
[06:36:48] ℹ️    - Diagnosis 3: ''
[06:36:48] ℹ️    - Diagnosis 4: ''
[06:36:48] ℹ️    - Diagnosis 5: ''
[06:36:48] ℹ️    - Diagnosis 6: ''
[06:36:48] ℹ️  Final extracted MRN: '5879015'
[06:36:48] ℹ️  Final extracted Sex: 'MALE'
[06:36:48] ℹ️  Final extracted Service Line: 'RN'
[06:36:48] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[06:36:48] ✅ Patient data extraction completed successfully
[06:36:48] ✅    ✅ Patient data extracted successfully
[06:36:48] 📊 Patient Response
     └─ patientFName: Roger
     └─ patientLName: Alves
     └─ dob: 11/12/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 5879015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:36:48] ✅    ✅ Patient identified: Roger Alves
[06:36:48] ✅    ✅ Patient name validation passed
[06:36:48] 🔄 
🔄 Step 3: Processing patient dates...
[06:36:48] [DOC: 9240050] ℹ️  DOB normalized: 11/12/1943
[06:36:48] [DOC: 9240050] ℹ️  Episode startOfCare normalized: 01/20/2025
[06:36:48] [DOC: 9240050] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[06:36:48] [DOC: 9240050] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[06:36:48] [DOC: 9240050] ✅ Patient date processing completed successfully
[06:36:48] ✅    ✅ Date processing completed
[06:36:48] 📊 Processed Patient Data
     └─ patientFName: Roger
     └─ patientLName: Alves
     └─ dob: 11/12/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: 5879015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '01/20/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:36:48] 🔄 
🔄 Step 4: Extracting order data...
[06:36:50] ℹ️  Order extraction - MRN: ''
[06:36:50] ℹ️  Order extraction - Sex: 'MALE'
[06:36:50] ℹ️  Order extraction - Service Line: 'RN'
[06:36:50] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[06:36:50] ✅ Order data extraction completed successfully
[06:36:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:36:50] ℹ️  Using MRN from patient data: '5879015'
[06:36:50] ℹ️  Service line consistent in both sources: 'RN'
[06:36:50] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[06:36:50] ✅ Patient name cross-validation successful
[06:36:50] ✅    ✅ Data merged successfully
[06:36:55] ✅    ✅ Order data extracted and validated
[06:36:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:36:55] [DOC: 9240050] ✅ Patient found in local cache: Roger Alves, ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[06:36:55] ✅    ✅ Existing patient found with ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[06:36:55] 🔄 
🔄 Step 6: Pushing order to API...
[06:36:55] [DOC: 9240050] ℹ️  Pushing order via API for patient ID: 6c33fc25-a395-49f7-97c9-fe209dc65557
[06:36:56] [DOC: 9240050] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12874"}
[06:36:56] ❌    ❌ Failed to push order
[06:36:56] 🔄 
🔄 Step 7: Writing to CSV...
[06:36:56] [DOC: 9240050] ℹ️  Calculated age: 81 from DOB: 11/12/1943
[06:36:56] [DOC: 9240050] ℹ️  Service Line extracted: 'RN'
[06:36:56] [DOC: 9240050] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[06:36:56] [DOC: 9240050] ℹ️  Diagnosis codes being written:
[06:36:56] [DOC: 9240050] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:36:56] [DOC: 9240050] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:36:56] [DOC: 9240050] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:36:56] [DOC: 9240050] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:36:56] [DOC: 9240050] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:36:56] [DOC: 9240050] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:36:56] [DOC: 9240050] ✅ Patient data written to CSV: Roger Alves | Sex: MALE | Age: 81 | Service: RN | Payer: Tufts Health Plan Medicare Preferred | MRN: 5879015
[06:36:56] ✅    ✅ Document 9240050 processed and saved successfully
[06:36:56] 🔄 
🔄 Step 8: Saving API details...
[06:36:56] [DOC: 9240050] ℹ️  API push details saved for document 9240050
[06:36:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9240048                         ║
================================================================================
[06:36:56] ℹ️  Agency: Dartmouth HH
[06:36:56] ℹ️  Date: 04/15/2025
[06:36:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:36:58] [DOC: 9240048] ✅ Text extracted using pdfplumber (1168 chars)
[06:36:58] ✅    ✅ Text extracted using pdfplumber (1168 chars)
[06:36:58] 🔄 
🔄 Step 2: Extracting patient data...
[06:37:01] ℹ️  AI extracted raw sex value: 'M'
[06:37:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:37:01] ℹ️  AI extracted payer source: 'United Health Care'
[06:37:01] ℹ️  AI extracted diagnoses:
[06:37:01] ℹ️    - Diagnosis 1: ''
[06:37:01] ℹ️    - Diagnosis 2: ''
[06:37:01] ℹ️    - Diagnosis 3: ''
[06:37:01] ℹ️    - Diagnosis 4: ''
[06:37:01] ℹ️    - Diagnosis 5: ''
[06:37:01] ℹ️    - Diagnosis 6: ''
[06:37:01] ℹ️  Final extracted MRN: '7046009'
[06:37:01] ℹ️  Final extracted Sex: 'MALE'
[06:37:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:37:01] ℹ️  Final extracted Payer Source: 'United Health Care'
[06:37:01] ✅ Patient data extraction completed successfully
[06:37:01] ✅    ✅ Patient data extracted successfully
[06:37:01] 📊 Patient Response
     └─ patientFName: Julio
     └─ patientLName: Demelo
     └─ dob: 02/23/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 7046009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '10/31/2024', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:37:01] ✅    ✅ Patient identified: Julio Demelo
[06:37:01] ✅    ✅ Patient name validation passed
[06:37:01] 🔄 
🔄 Step 3: Processing patient dates...
[06:37:01] [DOC: 9240048] ℹ️  DOB normalized: 02/23/1950
[06:37:01] [DOC: 9240048] ℹ️  Episode startOfCare normalized: 10/31/2024
[06:37:01] [DOC: 9240048] ℹ️  Episode startOfEpisode normalized: 03/02/2025
[06:37:01] [DOC: 9240048] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[06:37:01] [DOC: 9240048] ✅ Patient date processing completed successfully
[06:37:01] ✅    ✅ Date processing completed
[06:37:01] 📊 Processed Patient Data
     └─ patientFName: Julio
     └─ patientLName: Demelo
     └─ dob: 02/23/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 7046009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: United Health Care
     └─ episodeDiagnoses: [{'startOfCare': '10/31/2024', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:37:01] 🔄 
🔄 Step 4: Extracting order data...
[06:37:03] ℹ️  Order extraction - MRN: ''
[06:37:03] ℹ️  Order extraction - Sex: 'MALE'
[06:37:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:37:03] ℹ️  Order extraction - Payer Source: 'United Health Care'
[06:37:03] ✅ Order data extraction completed successfully
[06:37:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:37:03] ℹ️  Using MRN from patient data: '7046009'
[06:37:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:37:03] ℹ️  Payer source consistent in both sources: 'United Health Care'
[06:37:03] ✅ Patient name cross-validation successful
[06:37:03] ✅    ✅ Data merged successfully
[06:37:05] ✅    ✅ Order data extracted and validated
[06:37:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:38:09] [DOC: 9240048] ℹ️  Patient not found in cache or API: Julio Demelo
[06:38:09] [DOC: 9240048] ℹ️  Patient not found, creating new patient via API...
[06:38:09] [DOC: 9240048] ℹ️  Creating patient via API: Julio Demelo
[06:38:12] [DOC: 9240048] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:38:12] ❌    ❌ Failed to create patient
[06:38:12] [DOC: 9240048] ℹ️  API push details saved for document 9240048
================================================================================
║                        Processing Document ID: 9240028                         ║
================================================================================
[06:38:12] ℹ️  Agency: Visiting Rehab & Nursing Services
[06:38:12] ℹ️  Date: 04/15/2025
[06:38:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:38:15] [DOC: 9240028] ✅ Text extracted using pdfplumber (5000 chars)
[06:38:15] ✅    ✅ Text extracted using pdfplumber (5000 chars)
[06:38:15] 🔄 
🔄 Step 2: Extracting patient data...
[06:38:17] ℹ️  AI extracted raw sex value: 'None'
[06:38:17] ℹ️  AI extracted service line: 'None'
[06:38:17] ℹ️  AI extracted payer source: 'None'
[06:38:17] ℹ️  AI extracted diagnoses:
[06:38:17] ℹ️    - Diagnosis 1: ''
[06:38:17] ℹ️    - Diagnosis 2: ''
[06:38:17] ℹ️    - Diagnosis 3: ''
[06:38:17] ℹ️    - Diagnosis 4: ''
[06:38:17] ℹ️    - Diagnosis 5: ''
[06:38:17] ℹ️    - Diagnosis 6: ''
[06:38:17] ℹ️  Final extracted MRN: ''
[06:38:17] ℹ️  Final extracted Sex: ''
[06:38:17] ℹ️  Final extracted Service Line: ''
[06:38:17] ℹ️  Final extracted Payer Source: ''
[06:38:17] ✅ Patient data extraction completed successfully
[06:38:17] ✅    ✅ Patient data extracted successfully
[06:38:17] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[06:38:17] ⚠️     ❌ Insufficient patient data extracted
[06:38:17] [DOC: 9240028] ℹ️  API push details saved for document 9240028
================================================================================
║                        Processing Document ID: 9240027                         ║
================================================================================
[06:38:17] ℹ️  Agency: Visiting Rehab & Nursing Services
[06:38:17] ℹ️  Date: 04/15/2025
[06:38:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:38:21] [DOC: 9240027] ✅ Text extracted using pdfplumber (5107 chars)
[06:38:21] ✅    ✅ Text extracted using pdfplumber (5107 chars)
[06:38:21] 🔄 
🔄 Step 2: Extracting patient data...
[06:38:23] ℹ️  AI extracted raw sex value: 'None'
[06:38:23] ℹ️  AI extracted service line: 'None'
[06:38:23] ℹ️  AI extracted payer source: 'None'
[06:38:23] ℹ️  AI extracted diagnoses:
[06:38:23] ℹ️    - Diagnosis 1: ''
[06:38:23] ℹ️    - Diagnosis 2: ''
[06:38:23] ℹ️    - Diagnosis 3: ''
[06:38:23] ℹ️    - Diagnosis 4: ''
[06:38:23] ℹ️    - Diagnosis 5: ''
[06:38:23] ℹ️    - Diagnosis 6: ''
[06:38:23] ℹ️  Final extracted MRN: ''
[06:38:23] ℹ️  Final extracted Sex: ''
[06:38:23] ℹ️  Final extracted Service Line: ''
[06:38:23] ℹ️  Final extracted Payer Source: ''
[06:38:23] ✅ Patient data extraction completed successfully
[06:38:23] ✅    ✅ Patient data extracted successfully
[06:38:23] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[06:38:23] ⚠️     ❌ Insufficient patient data extracted
[06:38:23] [DOC: 9240027] ℹ️  API push details saved for document 9240027
================================================================================
║                        Processing Document ID: 9240026                         ║
================================================================================
[06:38:23] ℹ️  Agency: Visiting Rehab & Nursing Services
[06:38:23] ℹ️  Date: 04/15/2025
[06:38:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:38:40] [DOC: 9240026] ✅ Text extracted using pdfplumber (36432 chars)
[06:38:40] ✅    ✅ Text extracted using pdfplumber (36432 chars)
[06:38:40] 🔄 
🔄 Step 2: Extracting patient data...
[06:38:43] ℹ️  AI extracted raw sex value: ''
[06:38:43] ℹ️  AI extracted service line: ''
[06:38:43] ℹ️  AI extracted payer source: ''
[06:38:43] ℹ️  AI extracted diagnoses:
[06:38:43] ℹ️    - Diagnosis 1: ''
[06:38:43] ℹ️    - Diagnosis 2: ''
[06:38:43] ℹ️    - Diagnosis 3: ''
[06:38:43] ℹ️    - Diagnosis 4: ''
[06:38:43] ℹ️    - Diagnosis 5: ''
[06:38:43] ℹ️    - Diagnosis 6: ''
[06:38:43] ℹ️  Final extracted MRN: ''
[06:38:43] ℹ️  Final extracted Sex: ''
[06:38:43] ℹ️  Final extracted Service Line: ''
[06:38:43] ℹ️  Final extracted Payer Source: ''
[06:38:43] ✅ Patient data extraction completed successfully
[06:38:43] ✅    ✅ Patient data extracted successfully
[06:38:43] 📊 Patient Response
     └─ patientFName: 
     └─ patientLName: 
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: 
     └─ address: 
     └─ city: 
     └─ state: 
     └─ zip: 
     └─ email: 
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:38:43] ⚠️     ❌ Insufficient patient data extracted
[06:38:43] [DOC: 9240026] ℹ️  API push details saved for document 9240026
================================================================================
║                        Processing Document ID: 9237947                         ║
================================================================================
[06:38:43] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:38:43] ℹ️  Date: 04/14/2025
[06:38:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:38:49] [DOC: 9237947] ✅ Text extracted using pdfplumber (1136 chars)
[06:38:49] ✅    ✅ Text extracted using pdfplumber (1136 chars)
[06:38:49] 🔄 
🔄 Step 2: Extracting patient data...
[06:38:52] ℹ️  AI extracted raw sex value: ''
[06:38:52] ℹ️  AI extracted service line: 'Nursing, LVN/LPN'
[06:38:52] ℹ️  AI extracted payer source: ''
[06:38:52] ℹ️  AI extracted diagnoses:
[06:38:52] ℹ️    - Diagnosis 1: 'F31.30'
[06:38:52] ℹ️    - Diagnosis 2: 'I11.0'
[06:38:52] ℹ️    - Diagnosis 3: 'I50.32'
[06:38:52] ℹ️    - Diagnosis 4: 'None'
[06:38:52] ℹ️    - Diagnosis 5: 'None'
[06:38:52] ℹ️    - Diagnosis 6: 'None'
[06:38:52] ℹ️  Final extracted MRN: '100991032'
[06:38:52] ℹ️  Final extracted Sex: ''
[06:38:52] ℹ️  Final extracted Service Line: 'Nursing, LVN/LPN'
[06:38:52] ℹ️  Final extracted Payer Source: ''
[06:38:52] ✅ Patient data extraction completed successfully
[06:38:52] ✅    ✅ Patient data extracted successfully
[06:38:52] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Ferreira
     └─ dob: 10/01/1944
     └─ patientSex: 
     └─ medicalRecordNo: 100991032
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing, LVN/LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '07/11/2024', 'endOfEpisode': '09/08/2024', 'firstDiagnosis': 'F31.30', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.32', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:38:52] ✅    ✅ Patient identified: Gloria Ferreira
[06:38:52] ✅    ✅ Patient name validation passed
[06:38:52] 🔄 
🔄 Step 3: Processing patient dates...
[06:38:52] [DOC: 9237947] ℹ️  DOB normalized: 10/01/1944
[06:38:52] [DOC: 9237947] ℹ️  Episode startOfEpisode normalized: 07/11/2024
[06:38:52] [DOC: 9237947] ℹ️  Episode endOfEpisode normalized: 09/08/2024
[06:38:52] [DOC: 9237947] ✅ Patient date processing completed successfully
[06:38:52] ✅    ✅ Date processing completed
[06:38:52] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Ferreira
     └─ dob: 10/01/1944
     └─ patientSex: 
     └─ medicalRecordNo: 100991032
     └─ billingProvider: Daniel Martin MD
     └─ npi: 1720058803
     └─ physicianNPI: 1720058803
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Nursing, LVN/LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '07/11/2024', 'endOfEpisode': '09/08/2024', 'firstDiagnosis': 'F31.30', 'secondDiagnosis': 'I11.0', 'thirdDiagnosis': 'I50.32'}]
[06:38:52] 🔄 
🔄 Step 4: Extracting order data...
[06:38:55] ℹ️  Order extraction - MRN: '100991032'
[06:38:55] ℹ️  Order extraction - Sex: ''
[06:38:55] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:38:55] ℹ️  Order extraction - Payer Source: ''
[06:38:55] ✅ Order data extraction completed successfully
[06:38:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:38:55] ℹ️  Using MRN from patient data: '100991032' over '100991032'
[06:38:55] ⚠️  Could not determine sex using any available method
[06:38:55] ℹ️  Combined service lines: Patient='Nursing, LVN/LPN' + Order='Skilled Nursing' = 'LVN/LPN, Nursing, Skilled Nursing'
[06:38:55] ✅ Patient name cross-validation successful
[06:38:55] ✅    ✅ Data merged successfully
[06:38:56] ✅    ✅ Order data extracted and validated
[06:38:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:39:45] [DOC: 9237947] ✅ Patient exists in API: Gloria Ferreira, ID: dcfebf51-52ae-47da-9854-9f77f47e667a
[06:39:45] ✅    ✅ Existing patient found with ID: dcfebf51-52ae-47da-9854-9f77f47e667a
[06:39:45] 🔄 
🔄 Step 6: Pushing order to API...
[06:39:45] [DOC: 9237947] ℹ️  Pushing order via API for patient ID: dcfebf51-52ae-47da-9854-9f77f47e667a
[06:39:48] [DOC: 9237947] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13976"}
[06:39:48] ❌    ❌ Failed to push order
[06:39:48] 🔄 
🔄 Step 7: Writing to CSV...
[06:39:48] [DOC: 9237947] ℹ️  Calculated age: 80 from DOB: 10/01/1944
[06:39:48] [DOC: 9237947] ℹ️  Service Line extracted: 'LVN/LPN, Nursing, Skilled Nursing'
[06:39:48] [DOC: 9237947] ℹ️  Payer Source extracted: ''
[06:39:48] [DOC: 9237947] ℹ️  Diagnosis codes being written:
[06:39:48] [DOC: 9237947] ℹ️    - Latest_Episode_Firstdiagnosis: 'F31.30'
[06:39:48] [DOC: 9237947] ℹ️    - Latest_Episode_Seconddiagnosis: 'I11.0'
[06:39:48] [DOC: 9237947] ℹ️    - Latest_Episode_Thirddiagnosis: 'I50.32'
[06:39:48] [DOC: 9237947] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:39:48] [DOC: 9237947] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:39:48] [DOC: 9237947] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:39:48] [DOC: 9237947] ✅ Patient data written to CSV: Gloria Ferreira | Sex:  | Age: 80 | Service: LVN/LPN, Nursing, Skilled Nursing | Payer:  | MRN: 100991032
[06:39:48] ✅    ✅ Document 9237947 processed and saved successfully
[06:39:48] 🔄 
🔄 Step 8: Saving API details...
[06:39:48] [DOC: 9237947] ℹ️  API push details saved for document 9237947
[06:39:48] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235515                         ║
================================================================================
[06:39:48] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:39:48] ℹ️  Date: 04/11/2025
[06:39:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:39:50] [DOC: 9235515] ✅ Text extracted using pdfplumber (1126 chars)
[06:39:50] ✅    ✅ Text extracted using pdfplumber (1126 chars)
[06:39:50] 🔄 
🔄 Step 2: Extracting patient data...
[06:39:53] ℹ️  AI extracted raw sex value: ''
[06:39:53] ℹ️  AI extracted service line: 'Skilled Nursing, LPN'
[06:39:53] ℹ️  AI extracted payer source: ''
[06:39:53] ℹ️  AI extracted diagnoses:
[06:39:53] ℹ️    - Diagnosis 1: 'C67.9'
[06:39:53] ℹ️    - Diagnosis 2: 'Z48.3'
[06:39:53] ℹ️    - Diagnosis 3: 'Z46.6'
[06:39:53] ℹ️    - Diagnosis 4: ''
[06:39:53] ℹ️    - Diagnosis 5: ''
[06:39:53] ℹ️    - Diagnosis 6: ''
[06:39:53] ℹ️  Final extracted MRN: 'MA250206063603'
[06:39:53] ℹ️  Final extracted Sex: ''
[06:39:53] ℹ️  Final extracted Service Line: 'Skilled Nursing, LPN'
[06:39:53] ℹ️  Final extracted Payer Source: ''
[06:39:53] ✅ Patient data extraction completed successfully
[06:39:53] ✅    ✅ Patient data extracted successfully
[06:39:53] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Lopes
     └─ dob: 06/25/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250206063603
     └─ billingProvider: JONATHAN BIER MD
     └─ npi: 1306883343
     └─ physicianNPI: 1306883343
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': 'C67.9', 'secondDiagnosis': 'Z48.3', 'thirdDiagnosis': 'Z46.6', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:39:53] ✅    ✅ Patient identified: Maria Lopes
[06:39:53] ✅    ✅ Patient name validation passed
[06:39:53] 🔄 
🔄 Step 3: Processing patient dates...
[06:39:53] [DOC: 9235515] ℹ️  DOB normalized: 06/25/1936
[06:39:53] [DOC: 9235515] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[06:39:53] [DOC: 9235515] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[06:39:53] [DOC: 9235515] ✅ Patient date processing completed successfully
[06:39:53] ✅    ✅ Date processing completed
[06:39:53] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Lopes
     └─ dob: 06/25/1936
     └─ patientSex: 
     └─ medicalRecordNo: MA250206063603
     └─ billingProvider: JONATHAN BIER MD
     └─ npi: 1306883343
     └─ physicianNPI: 1306883343
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, LPN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': 'C67.9', 'secondDiagnosis': 'Z48.3', 'thirdDiagnosis': 'Z46.6', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:39:53] 🔄 
🔄 Step 4: Extracting order data...
[06:39:56] ℹ️  Order extraction - MRN: 'MA250206063603'
[06:39:56] ℹ️  Order extraction - Sex: ''
[06:39:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:39:56] ℹ️  Order extraction - Payer Source: ''
[06:39:56] ✅ Order data extraction completed successfully
[06:39:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:39:56] ℹ️  Using MRN from patient data: 'MA250206063603' over 'MA250206063603'
[06:39:56] ℹ️  Inferred sex as FEMALE from name: Maria
[06:39:56] ℹ️  Combined service lines: Patient='Skilled Nursing, LPN' + Order='Skilled Nursing' = 'LPN, Skilled Nursing'
[06:39:56] ✅ Patient name cross-validation successful
[06:39:56] ✅    ✅ Data merged successfully
[06:39:57] ✅    ✅ Order data extracted and validated
[06:39:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:40:40] [DOC: 9235515] ℹ️  Patient not found in cache or API: Maria Lopes
[06:40:40] [DOC: 9235515] ℹ️  Patient not found, creating new patient via API...
[06:40:40] [DOC: 9235515] ℹ️  Creating patient via API: Maria Lopes
[06:40:42] [DOC: 9235515] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:40:42] ❌    ❌ Failed to create patient
[06:40:42] [DOC: 9235515] ℹ️  API push details saved for document 9235515
================================================================================
║                        Processing Document ID: 9237108                         ║
================================================================================
[06:40:42] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[06:40:42] ℹ️  Date: 04/11/2025
[06:40:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:40:45] [DOC: 9237108] ✅ Text extracted using pdfplumber (1746 chars)
[06:40:45] ✅    ✅ Text extracted using pdfplumber (1746 chars)
[06:40:45] 🔄 
🔄 Step 2: Extracting patient data...
[06:40:48] ℹ️  AI extracted raw sex value: ''
[06:40:48] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:40:48] ℹ️  AI extracted payer source: 'Medicare'
[06:40:48] ℹ️  AI extracted diagnoses:
[06:40:48] ℹ️    - Diagnosis 1: ''
[06:40:48] ℹ️    - Diagnosis 2: ''
[06:40:48] ℹ️    - Diagnosis 3: ''
[06:40:48] ℹ️    - Diagnosis 4: ''
[06:40:48] ℹ️    - Diagnosis 5: ''
[06:40:48] ℹ️    - Diagnosis 6: ''
[06:40:48] ℹ️  Final extracted MRN: '28700210537101'
[06:40:48] ℹ️  Final extracted Sex: ''
[06:40:48] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:40:48] ℹ️  Final extracted Payer Source: 'Medicare'
[06:40:48] ✅ Patient data extraction completed successfully
[06:40:48] ✅    ✅ Patient data extracted successfully
[06:40:48] 📊 Patient Response
     └─ patientFName: DANIEL
     └─ patientLName: CORREIA
     └─ dob: 02/24/1956
     └─ patientSex: 
     └─ medicalRecordNo: 28700210537101
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:40:48] ✅    ✅ Patient identified: DANIEL CORREIA
[06:40:48] ✅    ✅ Patient name validation passed
[06:40:48] 🔄 
🔄 Step 3: Processing patient dates...
[06:40:48] [DOC: 9237108] ℹ️  DOB normalized: 02/24/1956
[06:40:48] [DOC: 9237108] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[06:40:48] [DOC: 9237108] ℹ️  Episode endOfEpisode normalized: 03/26/2025
[06:40:48] [DOC: 9237108] ✅ Patient date processing completed successfully
[06:40:48] ✅    ✅ Date processing completed
[06:40:48] 📊 Processed Patient Data
     └─ patientFName: DANIEL
     └─ patientLName: CORREIA
     └─ dob: 02/24/1956
     └─ patientSex: 
     └─ medicalRecordNo: 28700210537101
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 368 FAUNCE CORNER ROAD
     └─ city: DARTMOUTH
     └─ state: MA
     └─ zip: 02747-1257
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '03/26/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:40:48] 🔄 
🔄 Step 4: Extracting order data...
[06:40:50] ℹ️  Order extraction - MRN: '28700210537101'
[06:40:50] ℹ️  Order extraction - Sex: ''
[06:40:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:40:50] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:40:50] ✅ Order data extraction completed successfully
[06:40:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:40:50] ℹ️  Using MRN from patient data: '28700210537101' over '28700210537101'
[06:40:50] ℹ️  Inferred sex as MALE from name: DANIEL
[06:40:50] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:40:50] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:40:50] ✅ Patient name cross-validation successful
[06:40:50] ✅    ✅ Data merged successfully
[06:40:51] ✅    ✅ Order data extracted and validated
[06:40:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:41:10] [DOC: 9237108] ✅ Patient exists in API: DANIEL CORREIA, ID: cb8b090e-5a6b-4260-b138-28d8bba8963e
[06:41:10] ✅    ✅ Existing patient found with ID: cb8b090e-5a6b-4260-b138-28d8bba8963e
[06:41:10] 🔄 
🔄 Step 6: Pushing order to API...
[06:41:10] [DOC: 9237108] ℹ️  Pushing order via API for patient ID: cb8b090e-5a6b-4260-b138-28d8bba8963e
[06:41:12] [DOC: 9237108] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13656"}
[06:41:12] ❌    ❌ Failed to push order
[06:41:12] 🔄 
🔄 Step 7: Writing to CSV...
[06:41:12] [DOC: 9237108] ℹ️  Calculated age: 69 from DOB: 02/24/1956
[06:41:12] [DOC: 9237108] ℹ️  Service Line extracted: 'Skilled Nursing'
[06:41:12] [DOC: 9237108] ℹ️  Payer Source extracted: 'Medicare'
[06:41:12] [DOC: 9237108] ℹ️  Diagnosis codes being written:
[06:41:12] [DOC: 9237108] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:41:12] [DOC: 9237108] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:41:12] [DOC: 9237108] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:41:12] [DOC: 9237108] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:41:12] [DOC: 9237108] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:41:12] [DOC: 9237108] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:41:12] [DOC: 9237108] ✅ Patient data written to CSV: DANIEL CORREIA | Sex: MALE | Age: 69 | Service: Skilled Nursing | Payer: Medicare | MRN: 28700210537101
[06:41:12] ✅    ✅ Document 9237108 processed and saved successfully
[06:41:12] 🔄 
🔄 Step 8: Saving API details...
[06:41:12] [DOC: 9237108] ℹ️  API push details saved for document 9237108
[06:41:12] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9236659                         ║
================================================================================
[06:41:12] ℹ️  Agency: Alphacare Home Health Agency
[06:41:12] ℹ️  Date: 04/11/2025
[06:41:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:41:15] [DOC: 9236659] ✅ Text extracted using pdfplumber (1396 chars)
[06:41:15] ✅    ✅ Text extracted using pdfplumber (1396 chars)
[06:41:15] 🔄 
🔄 Step 2: Extracting patient data...
[06:41:17] ℹ️  AI extracted raw sex value: ''
[06:41:17] ℹ️  AI extracted service line: 'PT'
[06:41:17] ℹ️  AI extracted payer source: ''
[06:41:17] ℹ️  AI extracted diagnoses:
[06:41:17] ℹ️    - Diagnosis 1: 'None'
[06:41:17] ℹ️    - Diagnosis 2: 'None'
[06:41:17] ℹ️    - Diagnosis 3: 'None'
[06:41:17] ℹ️    - Diagnosis 4: 'None'
[06:41:17] ℹ️    - Diagnosis 5: 'None'
[06:41:17] ℹ️    - Diagnosis 6: 'None'
[06:41:17] ℹ️  Final extracted MRN: '000004567'
[06:41:17] ℹ️  Final extracted Sex: ''
[06:41:17] ℹ️  Final extracted Service Line: 'PT'
[06:41:17] ℹ️  Final extracted Payer Source: ''
[06:41:17] ✅ Patient data extraction completed successfully
[06:41:17] ✅    ✅ Patient data extracted successfully
[06:41:17] 📊 Patient Response
     └─ patientFName: Lauren
     └─ patientLName: Thomas
     └─ dob: 09/17/1978
     └─ patientSex: 
     └─ medicalRecordNo: 000004567
     └─ billingProvider: Liu, Bing (MD (Dr. Alliance))
     └─ npi: 1699745810
     └─ physicianNPI: 1699745810
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:41:17] ✅    ✅ Patient identified: Lauren Thomas
[06:41:17] ✅    ✅ Patient name validation passed
[06:41:17] 🔄 
🔄 Step 3: Processing patient dates...
[06:41:17] [DOC: 9236659] ℹ️  DOB normalized: 09/17/1978
[06:41:17] [DOC: 9236659] ✅ Patient date processing completed successfully
[06:41:17] ✅    ✅ Date processing completed
[06:41:17] 📊 Processed Patient Data
     └─ patientFName: Lauren
     └─ patientLName: Thomas
     └─ dob: 09/17/1978
     └─ patientSex: 
     └─ medicalRecordNo: 000004567
     └─ billingProvider: Liu, Bing (MD (Dr. Alliance))
     └─ npi: 1699745810
     └─ physicianNPI: 1699745810
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[06:41:17] 🔄 
🔄 Step 4: Extracting order data...
[06:41:19] ℹ️  Order extraction - MRN: '000004567'
[06:41:19] ℹ️  Order extraction - Sex: ''
[06:41:19] ℹ️  Order extraction - Service Line: 'PT'
[06:41:19] ℹ️  Order extraction - Payer Source: ''
[06:41:19] ✅ Order data extraction completed successfully
[06:41:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:41:19] ℹ️  Using MRN from patient data: '000004567' over '000004567'
[06:41:19] ⚠️  Could not determine sex using any available method
[06:41:19] ℹ️  Service line consistent in both sources: 'PT'
[06:41:19] ✅ Patient name cross-validation successful
[06:41:19] ✅    ✅ Data merged successfully
[06:41:20] ✅    ✅ Order data extracted and validated
[06:41:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:41:48] [DOC: 9236659] ✅ Patient exists in API: Lauren Thomas, ID: 0f5d4c61-1da0-4677-9d9f-5898326280a0
[06:41:48] ✅    ✅ Existing patient found with ID: 0f5d4c61-1da0-4677-9d9f-5898326280a0
[06:41:48] 🔄 
🔄 Step 6: Pushing order to API...
[06:41:48] [DOC: 9236659] ℹ️  Pushing order via API for patient ID: 0f5d4c61-1da0-4677-9d9f-5898326280a0
[06:41:49] [DOC: 9236659] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:41:49] ❌    ❌ Failed to push order
[06:41:49] 🔄 
🔄 Step 7: Writing to CSV...
[06:41:49] [DOC: 9236659] ℹ️  Calculated age: 46 from DOB: 09/17/1978
[06:41:49] [DOC: 9236659] ℹ️  Service Line extracted: 'PT'
[06:41:49] [DOC: 9236659] ℹ️  Payer Source extracted: ''
[06:41:49] [DOC: 9236659] ℹ️  Diagnosis codes being written:
[06:41:49] [DOC: 9236659] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:41:49] [DOC: 9236659] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:41:49] [DOC: 9236659] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:41:49] [DOC: 9236659] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:41:49] [DOC: 9236659] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:41:49] [DOC: 9236659] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:41:49] [DOC: 9236659] ✅ Patient data written to CSV: Lauren Thomas | Sex:  | Age: 46 | Service: PT | Payer:  | MRN: 000004567
[06:41:49] ✅    ✅ Document 9236659 processed and saved successfully
[06:41:49] 🔄 
🔄 Step 8: Saving API details...
[06:41:49] [DOC: 9236659] ℹ️  API push details saved for document 9236659
[06:41:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9236655                         ║
================================================================================
[06:41:49] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:41:49] ℹ️  Date: 04/11/2025
[06:41:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:41:53] [DOC: 9236655] ✅ Text extracted using pdfplumber (1358 chars)
[06:41:53] ✅    ✅ Text extracted using pdfplumber (1358 chars)
[06:41:53] 🔄 
🔄 Step 2: Extracting patient data...
[06:41:56] ℹ️  AI extracted raw sex value: ''
[06:41:56] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:41:56] ℹ️  AI extracted payer source: ''
[06:41:56] ℹ️  AI extracted diagnoses:
[06:41:56] ℹ️    - Diagnosis 1: 'M47.26'
[06:41:56] ℹ️    - Diagnosis 2: 'M47.812'
[06:41:56] ℹ️    - Diagnosis 3: 'M75.101'
[06:41:56] ℹ️    - Diagnosis 4: ''
[06:41:56] ℹ️    - Diagnosis 5: ''
[06:41:56] ℹ️    - Diagnosis 6: ''
[06:41:56] ℹ️  Final extracted MRN: 'MA240617055801'
[06:41:56] ℹ️  Final extracted Sex: ''
[06:41:56] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:41:56] ℹ️  Final extracted Payer Source: ''
[06:41:56] ✅ Patient data extraction completed successfully
[06:41:56] ✅    ✅ Patient data extracted successfully
[06:41:56] 📊 Patient Response
     └─ patientFName: Leticia
     └─ patientLName: Alves
     └─ dob: 05/25/1958
     └─ patientSex: 
     └─ medicalRecordNo: MA240617055801
     └─ billingProvider: MARY DIAS-REGUS NP
     └─ npi: 1326015496
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03-27-25', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'M47.26', 'secondDiagnosis': 'M47.812', 'thirdDiagnosis': 'M75.101', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:41:56] ✅    ✅ Patient identified: Leticia Alves
[06:41:56] ✅    ✅ Patient name validation passed
[06:41:56] 🔄 
🔄 Step 3: Processing patient dates...
[06:41:56] [DOC: 9236655] ℹ️  DOB normalized: 05/25/1958
[06:41:56] [DOC: 9236655] ⚠️  Invalid startOfCare format: 03-27-25
[06:41:56] [DOC: 9236655] ℹ️  Episode startOfEpisode normalized: 04/03/2025
[06:41:56] [DOC: 9236655] ℹ️  Episode endOfEpisode normalized: 06/01/2025
[06:41:56] [DOC: 9236655] ✅ Patient date processing completed successfully
[06:41:56] ✅    ✅ Date processing completed
[06:41:56] 📊 Processed Patient Data
     └─ patientFName: Leticia
     └─ patientLName: Alves
     └─ dob: 05/25/1958
     └─ patientSex: 
     └─ medicalRecordNo: MA240617055801
     └─ billingProvider: MARY DIAS-REGUS NP
     └─ npi: 1326015496
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03-27-25', 'startOfEpisode': '04/03/2025', 'endOfEpisode': '06/01/2025', 'firstDiagnosis': 'M47.26', 'secondDiagnosis': 'M47.812', 'thirdDiagnosis': 'M75.101', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:41:56] 🔄 
🔄 Step 4: Extracting order data...
[06:41:59] ℹ️  Order extraction - MRN: 'MA240617055801'
[06:41:59] ℹ️  Order extraction - Sex: ''
[06:41:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:41:59] ℹ️  Order extraction - Payer Source: ''
[06:41:59] ✅ Order data extraction completed successfully
[06:41:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:41:59] ℹ️  Using MRN from patient data: 'MA240617055801' over 'MA240617055801'
[06:41:59] ⚠️  Could not determine sex using any available method
[06:41:59] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:41:59] ✅ Patient name cross-validation successful
[06:41:59] ✅    ✅ Data merged successfully
[06:42:00] ✅    ✅ Order data extracted and validated
[06:42:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:42:00] [DOC: 9236655] ✅ Patient found in local cache: Leticia Alves, ID: 9d1435a0-398f-4377-8037-07d8a159253d
[06:42:00] ✅    ✅ Existing patient found with ID: 9d1435a0-398f-4377-8037-07d8a159253d
[06:42:00] 🔄 
🔄 Step 6: Pushing order to API...
[06:42:00] [DOC: 9236655] ℹ️  Pushing order via API for patient ID: 9d1435a0-398f-4377-8037-07d8a159253d
[06:42:02] [DOC: 9236655] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12871"}
[06:42:02] ❌    ❌ Failed to push order
[06:42:02] 🔄 
🔄 Step 7: Writing to CSV...
[06:42:02] [DOC: 9236655] ℹ️  Calculated age: 67 from DOB: 05/25/1958
[06:42:02] [DOC: 9236655] ℹ️  Service Line extracted: 'Skilled Nursing'
[06:42:02] [DOC: 9236655] ℹ️  Payer Source extracted: ''
[06:42:02] [DOC: 9236655] ℹ️  Diagnosis codes being written:
[06:42:02] [DOC: 9236655] ℹ️    - Latest_Episode_Firstdiagnosis: 'M47.26'
[06:42:02] [DOC: 9236655] ℹ️    - Latest_Episode_Seconddiagnosis: 'M47.812'
[06:42:02] [DOC: 9236655] ℹ️    - Latest_Episode_Thirddiagnosis: 'M75.101'
[06:42:02] [DOC: 9236655] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:42:02] [DOC: 9236655] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:42:02] [DOC: 9236655] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:42:02] [DOC: 9236655] ✅ Patient data written to CSV: Leticia Alves | Sex:  | Age: 67 | Service: Skilled Nursing | Payer:  | MRN: MA240617055801
[06:42:02] ✅    ✅ Document 9236655 processed and saved successfully
[06:42:02] 🔄 
🔄 Step 8: Saving API details...
[06:42:02] [DOC: 9236655] ℹ️  API push details saved for document 9236655
[06:42:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9236644                         ║
================================================================================
[06:42:02] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:42:02] ℹ️  Date: 04/11/2025
[06:42:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:42:06] [DOC: 9236644] ✅ Text extracted using pdfplumber (1286 chars)
[06:42:06] ✅    ✅ Text extracted using pdfplumber (1286 chars)
[06:42:06] 🔄 
🔄 Step 2: Extracting patient data...
[06:42:09] ℹ️  AI extracted raw sex value: ''
[06:42:09] ℹ️  AI extracted service line: 'PT'
[06:42:09] ℹ️  AI extracted payer source: ''
[06:42:09] ℹ️  AI extracted diagnoses:
[06:42:09] ℹ️    - Diagnosis 1: 'I10'
[06:42:09] ℹ️    - Diagnosis 2: 'E05.90'
[06:42:09] ℹ️    - Diagnosis 3: 'E78.5'
[06:42:09] ℹ️    - Diagnosis 4: ''
[06:42:09] ℹ️    - Diagnosis 5: ''
[06:42:09] ℹ️    - Diagnosis 6: ''
[06:42:09] ℹ️  Final extracted MRN: 'MA211105042902'
[06:42:09] ℹ️  Final extracted Sex: ''
[06:42:09] ℹ️  Final extracted Service Line: 'PT'
[06:42:09] ℹ️  Final extracted Payer Source: ''
[06:42:09] ✅ Patient data extraction completed successfully
[06:42:09] ✅    ✅ Patient data extracted successfully
[06:42:09] 📊 Patient Response
     └─ patientFName: Louisa
     └─ patientLName: Ramos
     └─ dob: 04/03/1929
     └─ patientSex: 
     └─ medicalRecordNo: MA211105042902
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E05.90', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:42:09] ✅    ✅ Patient identified: Louisa Ramos
[06:42:09] ✅    ✅ Patient name validation passed
[06:42:09] 🔄 
🔄 Step 3: Processing patient dates...
[06:42:09] [DOC: 9236644] ℹ️  DOB normalized: 04/03/1929
[06:42:09] [DOC: 9236644] ℹ️  Episode startOfCare normalized: 04/01/2025
[06:42:09] [DOC: 9236644] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[06:42:09] [DOC: 9236644] ℹ️  Episode endOfEpisode normalized: 06/06/2025
[06:42:09] [DOC: 9236644] ✅ Patient date processing completed successfully
[06:42:09] ✅    ✅ Date processing completed
[06:42:09] 📊 Processed Patient Data
     └─ patientFName: Louisa
     └─ patientLName: Ramos
     └─ dob: 04/03/1929
     └─ patientSex: 
     └─ medicalRecordNo: MA211105042902
     └─ billingProvider: SIRJANA DHUNGANA PARAJULI MD
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/01/2025', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/06/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'E05.90', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:42:09] 🔄 
🔄 Step 4: Extracting order data...
[06:42:12] ℹ️  Order extraction - MRN: 'MA211105042902'
[06:42:12] ℹ️  Order extraction - Sex: ''
[06:42:12] ℹ️  Order extraction - Service Line: 'PT'
[06:42:12] ℹ️  Order extraction - Payer Source: ''
[06:42:12] ✅ Order data extraction completed successfully
[06:42:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:42:12] ℹ️  Using MRN from patient data: 'MA211105042902' over 'MA211105042902'
[06:42:12] ⚠️  Could not determine sex using any available method
[06:42:12] ℹ️  Service line consistent in both sources: 'PT'
[06:42:12] ✅ Patient name cross-validation successful
[06:42:12] ✅    ✅ Data merged successfully
[06:42:13] ✅    ✅ Order data extracted and validated
[06:42:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:42:13] [DOC: 9236644] ✅ Patient found in local cache: Louisa Ramos, ID: 09ccab87-75ac-49b4-94be-64b9ffa095e7
[06:42:13] ✅    ✅ Existing patient found with ID: 09ccab87-75ac-49b4-94be-64b9ffa095e7
[06:42:13] 🔄 
🔄 Step 6: Pushing order to API...
[06:42:13] [DOC: 9236644] ℹ️  Pushing order via API for patient ID: 09ccab87-75ac-49b4-94be-64b9ffa095e7
[06:42:14] [DOC: 9236644] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13144"}
[06:42:14] ❌    ❌ Failed to push order
[06:42:14] 🔄 
🔄 Step 7: Writing to CSV...
[06:42:14] [DOC: 9236644] ℹ️  Calculated age: 96 from DOB: 04/03/1929
[06:42:14] [DOC: 9236644] ℹ️  Service Line extracted: 'PT'
[06:42:14] [DOC: 9236644] ℹ️  Payer Source extracted: ''
[06:42:14] [DOC: 9236644] ℹ️  Diagnosis codes being written:
[06:42:14] [DOC: 9236644] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[06:42:14] [DOC: 9236644] ℹ️    - Latest_Episode_Seconddiagnosis: 'E05.90'
[06:42:14] [DOC: 9236644] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[06:42:14] [DOC: 9236644] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:42:14] [DOC: 9236644] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:42:14] [DOC: 9236644] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:42:14] [DOC: 9236644] ✅ Patient data written to CSV: Louisa Ramos | Sex:  | Age: 96 | Service: PT | Payer:  | MRN: MA211105042902
[06:42:14] ✅    ✅ Document 9236644 processed and saved successfully
[06:42:14] 🔄 
🔄 Step 8: Saving API details...
[06:42:14] [DOC: 9236644] ℹ️  API push details saved for document 9236644
[06:42:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9236637                         ║
================================================================================
[06:42:14] ℹ️  Agency: Alphacare Home Health Agency
[06:42:14] ℹ️  Date: 04/11/2025
[06:42:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:42:23] [DOC: 9236637] ✅ Text extracted using pdfplumber (13779 chars)
[06:42:23] ✅    ✅ Text extracted using pdfplumber (13779 chars)
[06:42:23] 🔄 
🔄 Step 2: Extracting patient data...
[06:42:27] ℹ️  AI extracted raw sex value: 'M'
[06:42:27] ℹ️  AI extracted service line: 'PT, OT, Skilled Nursing'
[06:42:27] ℹ️  AI extracted payer source: 'MassHealth (Medicaid)'
[06:42:27] ℹ️  AI extracted diagnoses:
[06:42:27] ℹ️    - Diagnosis 1: 'M48.52XD'
[06:42:27] ℹ️    - Diagnosis 2: 'S14.105D'
[06:42:27] ℹ️    - Diagnosis 3: 'Z47.89'
[06:42:27] ℹ️    - Diagnosis 4: 'M62.81'
[06:42:27] ℹ️    - Diagnosis 5: 'R26.89'
[06:42:27] ℹ️    - Diagnosis 6: 'R52'
[06:42:27] ℹ️  Final extracted MRN: '000004567'
[06:42:27] ℹ️  Final extracted Sex: 'MALE'
[06:42:27] ℹ️  Final extracted Service Line: 'PT, OT, Skilled Nursing'
[06:42:27] ℹ️  Final extracted Payer Source: 'MassHealth (Medicaid)'
[06:42:27] ✅ Patient data extraction completed successfully
[06:42:27] ✅    ✅ Patient data extracted successfully
[06:42:27] 📊 Patient Response
     └─ patientFName: Lauren
     └─ patientLName: Thomas
     └─ dob: 09/17/1978
     └─ patientSex: MALE
     └─ medicalRecordNo: 000004567
     └─ billingProvider: AlphaCare Home Health Agency, Inc.
     └─ npi: 1699745810
     └─ physicianNPI: 
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 383 Chase Road
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: (617) 600-4547
     └─ serviceLine: PT, OT, Skilled Nursing
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M48.52XD', 'secondDiagnosis': 'S14.105D', 'thirdDiagnosis': 'Z47.89', 'fourthDiagnosis': 'M62.81', 'fifthDiagnosis': 'R26.89', 'sixthDiagnosis': 'R52'}]
[06:42:27] ✅    ✅ Patient identified: Lauren Thomas
[06:42:27] ✅    ✅ Patient name validation passed
[06:42:27] 🔄 
🔄 Step 3: Processing patient dates...
[06:42:27] [DOC: 9236637] ℹ️  DOB normalized: 09/17/1978
[06:42:27] [DOC: 9236637] ℹ️  Episode startOfCare normalized: 03/20/2025
[06:42:27] [DOC: 9236637] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[06:42:27] [DOC: 9236637] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[06:42:27] [DOC: 9236637] ✅ Patient date processing completed successfully
[06:42:27] ✅    ✅ Date processing completed
[06:42:27] 📊 Processed Patient Data
     └─ patientFName: Lauren
     └─ patientLName: Thomas
     └─ dob: 09/17/1978
     └─ patientSex: MALE
     └─ medicalRecordNo: 000004567
     └─ billingProvider: AlphaCare Home Health Agency, Inc.
     └─ npi: 1699745810
     └─ physicianNPI: 
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 383 Chase Road
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: (617) 600-4547
     └─ serviceLine: PT, OT, Skilled Nursing
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '03/20/2025', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'M48.52XD', 'secondDiagnosis': 'S14.105D', 'thirdDiagnosis': 'Z47.89', 'fourthDiagnosis': 'M62.81', 'fifthDiagnosis': 'R26.89', 'sixthDiagnosis': 'R52'}]
[06:42:27] 🔄 
🔄 Step 4: Extracting order data...
[06:42:30] ℹ️  Order extraction - MRN: '000004567'
[06:42:30] ℹ️  Order extraction - Sex: 'MALE'
[06:42:30] ℹ️  Order extraction - Service Line: 'PT, OT, Skilled Nursing'
[06:42:30] ℹ️  Order extraction - Payer Source: 'MassHealth (Medicaid)'
[06:42:30] ✅ Order data extraction completed successfully
[06:42:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:42:30] ℹ️  Using MRN from patient data: '000004567' over '000004567'
[06:42:30] ℹ️  Service line consistent in both sources: 'PT, OT, Skilled Nursing'
[06:42:30] ℹ️  Payer source consistent in both sources: 'MassHealth (Medicaid)'
[06:42:30] ✅ Patient name cross-validation successful
[06:42:30] ✅    ✅ Data merged successfully
[06:42:31] ✅    ✅ Order data extracted and validated
[06:42:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:42:31] [DOC: 9236637] ✅ Patient found in local cache: Lauren Thomas, ID: 0f5d4c61-1da0-4677-9d9f-5898326280a0
[06:42:31] ✅    ✅ Existing patient found with ID: 0f5d4c61-1da0-4677-9d9f-5898326280a0
[06:42:31] 🔄 
🔄 Step 6: Pushing order to API...
[06:42:31] [DOC: 9236637] ℹ️  Pushing order via API for patient ID: 0f5d4c61-1da0-4677-9d9f-5898326280a0
[06:42:32] [DOC: 9236637] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:42:32] ❌    ❌ Failed to push order
[06:42:32] 🔄 
🔄 Step 7: Writing to CSV...
[06:42:32] [DOC: 9236637] ℹ️  Calculated age: 46 from DOB: 09/17/1978
[06:42:32] [DOC: 9236637] ℹ️  Service Line extracted: 'PT, OT, Skilled Nursing'
[06:42:32] [DOC: 9236637] ℹ️  Payer Source extracted: 'MassHealth (Medicaid)'
[06:42:32] [DOC: 9236637] ℹ️  Diagnosis codes being written:
[06:42:32] [DOC: 9236637] ℹ️    - Latest_Episode_Firstdiagnosis: 'M48.52XD'
[06:42:32] [DOC: 9236637] ℹ️    - Latest_Episode_Seconddiagnosis: 'S14.105D'
[06:42:32] [DOC: 9236637] ℹ️    - Latest_Episode_Thirddiagnosis: 'Z47.89'
[06:42:32] [DOC: 9236637] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M62.81'
[06:42:32] [DOC: 9236637] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R26.89'
[06:42:32] [DOC: 9236637] ℹ️    - Latest_Episode_Sixthdiagnosis: 'R52'
[06:42:32] [DOC: 9236637] ✅ Patient data written to CSV: Lauren Thomas | Sex: MALE | Age: 46 | Service: PT, OT, Skilled Nursing | Payer: MassHealth (Medicaid) | MRN: 000004567
[06:42:32] ✅    ✅ Document 9236637 processed and saved successfully
[06:42:32] 🔄 
🔄 Step 8: Saving API details...
[06:42:32] [DOC: 9236637] ℹ️  API push details saved for document 9236637
[06:42:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9236639                         ║
================================================================================
[06:42:32] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:42:32] ℹ️  Date: 04/11/2025
[06:42:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:42:45] [DOC: 9236639] ✅ Text extracted using pdfplumber (13744 chars)
[06:42:45] ✅    ✅ Text extracted using pdfplumber (13744 chars)
[06:42:45] 🔄 
🔄 Step 2: Extracting patient data...
[06:42:48] ℹ️  AI extracted raw sex value: 'F'
[06:42:48] ℹ️  AI extracted service line: 'OT'
[06:42:48] ℹ️  AI extracted payer source: 'None'
[06:42:48] ℹ️  AI extracted diagnoses:
[06:42:48] ℹ️    - Diagnosis 1: 'J44.1'
[06:42:48] ℹ️    - Diagnosis 2: 'M62.81'
[06:42:48] ℹ️    - Diagnosis 3: 'I10'
[06:42:48] ℹ️    - Diagnosis 4: 'E11.9'
[06:42:48] ℹ️    - Diagnosis 5: 'F25.1'
[06:42:48] ℹ️    - Diagnosis 6: 'F41.1'
[06:42:48] ℹ️  Final extracted MRN: '100990744'
[06:42:48] ℹ️  Final extracted Sex: 'FEMALE'
[06:42:48] ℹ️  Final extracted Service Line: 'OT'
[06:42:48] ℹ️  Final extracted Payer Source: ''
[06:42:48] ✅ Patient data extraction completed successfully
[06:42:48] ✅    ✅ Patient data extracted successfully
[06:42:48] 📊 Patient Response
     └─ patientFName: Barbara
     └─ patientLName: Grace
     └─ dob: 10/21/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990744
     └─ billingProvider: Dr. Dhungana Parajuli
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '02/27/2025', 'endOfEpisode': None, 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'F25.1', 'sixthDiagnosis': 'F41.1'}]
[06:42:48] ✅    ✅ Patient identified: Barbara Grace
[06:42:48] ✅    ✅ Patient name validation passed
[06:42:48] 🔄 
🔄 Step 3: Processing patient dates...
[06:42:48] [DOC: 9236639] ℹ️  DOB normalized: 10/21/1948
[06:42:48] [DOC: 9236639] ℹ️  Episode startOfEpisode normalized: 02/27/2025
[06:42:48] [DOC: 9236639] ✅ Patient date processing completed successfully
[06:42:48] ✅    ✅ Date processing completed
[06:42:48] 📊 Processed Patient Data
     └─ patientFName: Barbara
     └─ patientLName: Grace
     └─ dob: 10/21/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 100990744
     └─ billingProvider: Dr. Dhungana Parajuli
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/27/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'E11.9', 'fifthDiagnosis': 'F25.1', 'sixthDiagnosis': 'F41.1'}]
[06:42:48] 🔄 
🔄 Step 4: Extracting order data...
[06:42:51] ℹ️  Order extraction - MRN: '100990744'
[06:42:51] ℹ️  Order extraction - Sex: 'FEMALE'
[06:42:51] ℹ️  Order extraction - Service Line: 'OT'
[06:42:51] ℹ️  Order extraction - Payer Source: ''
[06:42:51] ✅ Order data extraction completed successfully
[06:42:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:42:51] ℹ️  Using MRN from patient data: '100990744' over '100990744'
[06:42:51] ℹ️  Service line consistent in both sources: 'OT'
[06:42:51] ✅ Patient name cross-validation successful
[06:42:51] ✅    ✅ Data merged successfully
[06:42:52] ✅    ✅ Order data extracted and validated
[06:42:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:42:52] [DOC: 9236639] ✅ Patient found in local cache: Barbara Grace, ID: 579e1f1c-438b-4928-9793-bad56e38e647
[06:42:52] ✅    ✅ Existing patient found with ID: 579e1f1c-438b-4928-9793-bad56e38e647
[06:42:52] 🔄 
🔄 Step 6: Pushing order to API...
[06:42:52] [DOC: 9236639] ℹ️  Pushing order via API for patient ID: 579e1f1c-438b-4928-9793-bad56e38e647
[06:42:53] [DOC: 9236639] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:42:53] ❌    ❌ Failed to push order
[06:42:53] 🔄 
🔄 Step 7: Writing to CSV...
[06:42:53] [DOC: 9236639] ℹ️  Calculated age: 76 from DOB: 10/21/1948
[06:42:53] [DOC: 9236639] ℹ️  Service Line extracted: 'OT'
[06:42:53] [DOC: 9236639] ℹ️  Payer Source extracted: ''
[06:42:53] [DOC: 9236639] ℹ️  Diagnosis codes being written:
[06:42:53] [DOC: 9236639] ℹ️    - Latest_Episode_Firstdiagnosis: 'J44.1'
[06:42:53] [DOC: 9236639] ℹ️    - Latest_Episode_Seconddiagnosis: 'M62.81'
[06:42:53] [DOC: 9236639] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[06:42:53] [DOC: 9236639] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E11.9'
[06:42:53] [DOC: 9236639] ℹ️    - Latest_Episode_Fifthdiagnosis: 'F25.1'
[06:42:53] [DOC: 9236639] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.1'
[06:42:53] [DOC: 9236639] ✅ Patient data written to CSV: Barbara Grace | Sex: FEMALE | Age: 76 | Service: OT | Payer:  | MRN: 100990744
[06:42:53] ✅    ✅ Document 9236639 processed and saved successfully
[06:42:53] 🔄 
🔄 Step 8: Saving API details...
[06:42:53] [DOC: 9236639] ℹ️  API push details saved for document 9236639
[06:42:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9236601                         ║
================================================================================
[06:42:53] ℹ️  Agency: Alphacare Home Health Agency
[06:42:53] ℹ️  Date: 04/11/2025
[06:42:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:43:13] [DOC: 9236601] ✅ Text extracted using pdfplumber (22056 chars)
[06:43:13] ✅    ✅ Text extracted using pdfplumber (22056 chars)
[06:43:13] 🔄 
🔄 Step 2: Extracting patient data...
[06:43:16] ℹ️  AI extracted raw sex value: 'M'
[06:43:16] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:43:16] ℹ️  AI extracted payer source: 'MassHealth (Medicaid)'
[06:43:16] ℹ️  AI extracted diagnoses:
[06:43:16] ℹ️    - Diagnosis 1: 'F31.9'
[06:43:16] ℹ️    - Diagnosis 2: 'E11.65'
[06:43:16] ℹ️    - Diagnosis 3: 'I10'
[06:43:16] ℹ️    - Diagnosis 4: 'R44.0'
[06:43:16] ℹ️    - Diagnosis 5: 'I25.2'
[06:43:16] ℹ️    - Diagnosis 6: 'E66.09'
[06:43:16] ℹ️  Final extracted MRN: '000000085'
[06:43:16] ℹ️  Final extracted Sex: 'MALE'
[06:43:16] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:43:16] ℹ️  Final extracted Payer Source: 'MassHealth (Medicaid)'
[06:43:16] ✅ Patient data extraction completed successfully
[06:43:16] ✅    ✅ Patient data extracted successfully
[06:43:16] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Lowman
     └─ dob: 04/05/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 000000085
     └─ billingProvider: AlphaCare Home Health Agency, Inc.
     └─ npi: 1063606473
     └─ physicianNPI: 
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 2 Rolling Green Dr Suite/Apt #D
     └─ city: Fall River
     └─ state: MA
     └─ zip: 02720
     └─ email: 
     └─ phoneNumber: (508) 542-6478
     └─ serviceLine: Skilled Nursing
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '09/07/2017', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'R44.0', 'fifthDiagnosis': 'I25.2', 'sixthDiagnosis': 'E66.09'}]
[06:43:16] ✅    ✅ Patient identified: James Lowman
[06:43:16] ✅    ✅ Patient name validation passed
[06:43:16] 🔄 
🔄 Step 3: Processing patient dates...
[06:43:16] [DOC: 9236601] ℹ️  DOB normalized: 04/05/1968
[06:43:16] [DOC: 9236601] ℹ️  Episode startOfCare normalized: 09/07/2017
[06:43:16] [DOC: 9236601] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[06:43:16] [DOC: 9236601] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[06:43:16] [DOC: 9236601] ✅ Patient date processing completed successfully
[06:43:16] ✅    ✅ Date processing completed
[06:43:16] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Lowman
     └─ dob: 04/05/1968
     └─ patientSex: MALE
     └─ medicalRecordNo: 000000085
     └─ billingProvider: AlphaCare Home Health Agency, Inc.
     └─ npi: 1063606473
     └─ physicianNPI: 
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 2 Rolling Green Dr Suite/Apt #D
     └─ city: Fall River
     └─ state: MA
     └─ zip: 02720
     └─ email: 
     └─ phoneNumber: (508) 542-6478
     └─ serviceLine: Skilled Nursing
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '09/07/2017', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'F31.9', 'secondDiagnosis': 'E11.65', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'R44.0', 'fifthDiagnosis': 'I25.2', 'sixthDiagnosis': 'E66.09'}]
[06:43:16] 🔄 
🔄 Step 4: Extracting order data...
[06:43:19] ℹ️  Order extraction - MRN: '000000085'
[06:43:19] ℹ️  Order extraction - Sex: 'MALE'
[06:43:19] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:43:19] ℹ️  Order extraction - Payer Source: 'MassHealth (Medicaid)'
[06:43:19] ✅ Order data extraction completed successfully
[06:43:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:43:19] ℹ️  Using MRN from patient data: '000000085' over '000000085'
[06:43:19] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:43:19] ℹ️  Payer source consistent in both sources: 'MassHealth (Medicaid)'
[06:43:19] ✅ Patient name cross-validation successful
[06:43:19] ✅    ✅ Data merged successfully
[06:43:21] ✅    ✅ Order data extracted and validated
[06:43:21] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:43:56] [DOC: 9236601] ℹ️  Patient not found in cache or API: James Lowman
[06:43:56] [DOC: 9236601] ℹ️  Patient not found, creating new patient via API...
[06:43:56] [DOC: 9236601] ℹ️  Creating patient via API: James Lowman
[06:43:58] [DOC: 9236601] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:43:58] ❌    ❌ Failed to create patient
[06:43:58] [DOC: 9236601] ℹ️  API push details saved for document 9236601
================================================================================
║                        Processing Document ID: 9236492                         ║
================================================================================
[06:43:58] ℹ️  Agency: Alphacare Home Health Agency
[06:43:58] ℹ️  Date: 04/11/2025
[06:43:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:44:08] [DOC: 9236492] ✅ Text extracted using pdfplumber (13612 chars)
[06:44:08] ✅    ✅ Text extracted using pdfplumber (13612 chars)
[06:44:08] 🔄 
🔄 Step 2: Extracting patient data...
[06:44:12] ℹ️  AI extracted raw sex value: 'M'
[06:44:12] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:44:12] ℹ️  AI extracted payer source: 'MassHealth (Medicaid)'
[06:44:12] ℹ️  AI extracted diagnoses:
[06:44:12] ℹ️    - Diagnosis 1: 'I10'
[06:44:12] ℹ️    - Diagnosis 2: 'I73.9'
[06:44:12] ℹ️    - Diagnosis 3: 'Z87.820'
[06:44:12] ℹ️    - Diagnosis 4: 'I69.954'
[06:44:12] ℹ️    - Diagnosis 5: 'G83.9'
[06:44:12] ℹ️    - Diagnosis 6: 'Z86.718'
[06:44:12] ℹ️  Final extracted MRN: '000000015'
[06:44:12] ℹ️  Final extracted Sex: 'MALE'
[06:44:12] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:44:12] ℹ️  Final extracted Payer Source: 'MassHealth (Medicaid)'
[06:44:12] ✅ Patient data extraction completed successfully
[06:44:12] ✅    ✅ Patient data extracted successfully
[06:44:12] 📊 Patient Response
     └─ patientFName: Dennis
     └─ patientLName: OBrien
     └─ dob: 04/01/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 000000015
     └─ billingProvider: AlphaCare Home Health Agency, Inc
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc
     └─ address: 114 Riverside Ave Suite/Apt #Apt. 123
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: Skilled Nursing
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '07/31/2023', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I73.9', 'thirdDiagnosis': 'Z87.820', 'fourthDiagnosis': 'I69.954', 'fifthDiagnosis': 'G83.9', 'sixthDiagnosis': 'Z86.718'}]
[06:44:12] ✅    ✅ Patient identified: Dennis OBrien
[06:44:12] ✅    ✅ Patient name validation passed
[06:44:12] 🔄 
🔄 Step 3: Processing patient dates...
[06:44:12] [DOC: 9236492] ℹ️  DOB normalized: 04/01/1950
[06:44:12] [DOC: 9236492] ℹ️  Episode startOfCare normalized: 07/31/2023
[06:44:12] [DOC: 9236492] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[06:44:12] [DOC: 9236492] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[06:44:12] [DOC: 9236492] ✅ Patient date processing completed successfully
[06:44:12] ✅    ✅ Date processing completed
[06:44:12] 📊 Processed Patient Data
     └─ patientFName: Dennis
     └─ patientLName: OBrien
     └─ dob: 04/01/1950
     └─ patientSex: MALE
     └─ medicalRecordNo: 000000015
     └─ billingProvider: AlphaCare Home Health Agency, Inc
     └─ npi: 1346571098
     └─ physicianNPI: 1346571098
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc
     └─ address: 114 Riverside Ave Suite/Apt #Apt. 123
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: Skilled Nursing
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '07/31/2023', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'I73.9', 'thirdDiagnosis': 'Z87.820', 'fourthDiagnosis': 'I69.954', 'fifthDiagnosis': 'G83.9', 'sixthDiagnosis': 'Z86.718'}]
[06:44:12] 🔄 
🔄 Step 4: Extracting order data...
[06:44:15] ℹ️  Order extraction - MRN: '000000015'
[06:44:15] ℹ️  Order extraction - Sex: 'MALE'
[06:44:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:44:15] ℹ️  Order extraction - Payer Source: 'MassHealth (Medicaid)'
[06:44:15] ✅ Order data extraction completed successfully
[06:44:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:44:15] ℹ️  Using MRN from patient data: '000000015' over '000000015'
[06:44:15] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:44:15] ℹ️  Payer source consistent in both sources: 'MassHealth (Medicaid)'
[06:44:15] ✅ Patient name cross-validation successful
[06:44:15] ✅    ✅ Data merged successfully
[06:44:16] ✅    ✅ Order data extracted and validated
[06:44:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:44:35] [DOC: 9236492] ✅ Patient exists in API: Dennis OBrien, ID: 61a29eb5-61b9-49a7-8e50-e4398e642db4
[06:44:35] ✅    ✅ Existing patient found with ID: 61a29eb5-61b9-49a7-8e50-e4398e642db4
[06:44:35] 🔄 
🔄 Step 6: Pushing order to API...
[06:44:35] [DOC: 9236492] ℹ️  Pushing order via API for patient ID: 61a29eb5-61b9-49a7-8e50-e4398e642db4
[06:44:36] [DOC: 9236492] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:44:36] ❌    ❌ Failed to push order
[06:44:36] 🔄 
🔄 Step 7: Writing to CSV...
[06:44:36] [DOC: 9236492] ℹ️  Calculated age: 75 from DOB: 04/01/1950
[06:44:36] [DOC: 9236492] ℹ️  Service Line extracted: 'Skilled Nursing'
[06:44:36] [DOC: 9236492] ℹ️  Payer Source extracted: 'MassHealth (Medicaid)'
[06:44:36] [DOC: 9236492] ℹ️  Diagnosis codes being written:
[06:44:36] [DOC: 9236492] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[06:44:36] [DOC: 9236492] ℹ️    - Latest_Episode_Seconddiagnosis: 'I73.9'
[06:44:36] [DOC: 9236492] ℹ️    - Latest_Episode_Thirddiagnosis: 'Z87.820'
[06:44:36] [DOC: 9236492] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I69.954'
[06:44:36] [DOC: 9236492] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G83.9'
[06:44:36] [DOC: 9236492] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z86.718'
[06:44:36] [DOC: 9236492] ✅ Patient data written to CSV: Dennis OBrien | Sex: MALE | Age: 75 | Service: Skilled Nursing | Payer: MassHealth (Medicaid) | MRN: 000000015
[06:44:36] ✅    ✅ Document 9236492 processed and saved successfully
[06:44:36] 🔄 
🔄 Step 8: Saving API details...
[06:44:36] [DOC: 9236492] ℹ️  API push details saved for document 9236492
[06:44:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9236467                         ║
================================================================================
[06:44:36] ℹ️  Agency: Alphacare Home Health Agency
[06:44:36] ℹ️  Date: 04/11/2025
[06:44:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:44:52] [DOC: 9236467] ✅ Text extracted using pdfplumber (27095 chars)
[06:44:52] ✅    ✅ Text extracted using pdfplumber (27095 chars)
[06:44:52] 🔄 
🔄 Step 2: Extracting patient data...
[06:44:56] ℹ️  AI extracted raw sex value: 'M'
[06:44:56] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[06:44:56] ℹ️  AI extracted payer source: 'MassHealth (Medicaid)'
[06:44:56] ℹ️  AI extracted diagnoses:
[06:44:56] ℹ️    - Diagnosis 1: 'N12'
[06:44:56] ℹ️    - Diagnosis 2: 'N15.1'
[06:44:56] ℹ️    - Diagnosis 3: 'R78.81'
[06:44:56] ℹ️    - Diagnosis 4: 'Z96.0'
[06:44:56] ℹ️    - Diagnosis 5: 'M17.12'
[06:44:56] ℹ️    - Diagnosis 6: 'M25.562'
[06:44:56] ℹ️  Final extracted MRN: '000003599'
[06:44:56] ℹ️  Final extracted Sex: 'MALE'
[06:44:56] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[06:44:56] ℹ️  Final extracted Payer Source: 'MassHealth (Medicaid)'
[06:44:56] ✅ Patient data extraction completed successfully
[06:44:56] ✅    ✅ Patient data extracted successfully
[06:44:56] 📊 Patient Response
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 000003599
     └─ billingProvider: AlphaCare Home Health Agency, Inc.
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 26 Sol E Mar Lane
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: 774-994-6756
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2023', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'N12', 'secondDiagnosis': 'N15.1', 'thirdDiagnosis': 'R78.81', 'fourthDiagnosis': 'Z96.0', 'fifthDiagnosis': 'M17.12', 'sixthDiagnosis': 'M25.562'}]
[06:44:56] ✅    ✅ Patient identified: June Stykowski
[06:44:56] ✅    ✅ Patient name validation passed
[06:44:56] 🔄 
🔄 Step 3: Processing patient dates...
[06:44:56] [DOC: 9236467] ℹ️  DOB normalized: 11/08/1952
[06:44:56] [DOC: 9236467] ℹ️  Episode startOfCare normalized: 03/31/2023
[06:44:56] [DOC: 9236467] ℹ️  Episode startOfEpisode normalized: 03/20/2025
[06:44:56] [DOC: 9236467] ℹ️  Episode endOfEpisode normalized: 05/18/2025
[06:44:56] [DOC: 9236467] ✅ Patient date processing completed successfully
[06:44:56] ✅    ✅ Date processing completed
[06:44:56] 📊 Processed Patient Data
     └─ patientFName: June
     └─ patientLName: Stykowski
     └─ dob: 11/08/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: 000003599
     └─ billingProvider: AlphaCare Home Health Agency, Inc.
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 26 Sol E Mar Lane
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: 774-994-6756
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: MassHealth (Medicaid)
     └─ episodeDiagnoses: [{'startOfCare': '03/31/2023', 'startOfEpisode': '03/20/2025', 'endOfEpisode': '05/18/2025', 'firstDiagnosis': 'N12', 'secondDiagnosis': 'N15.1', 'thirdDiagnosis': 'R78.81', 'fourthDiagnosis': 'Z96.0', 'fifthDiagnosis': 'M17.12', 'sixthDiagnosis': 'M25.562'}]
[06:44:56] 🔄 
🔄 Step 4: Extracting order data...
[06:44:59] ℹ️  Order extraction - MRN: '000003599'
[06:44:59] ℹ️  Order extraction - Sex: 'MALE'
[06:44:59] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[06:44:59] ℹ️  Order extraction - Payer Source: 'MassHealth (Medicaid)'
[06:44:59] ✅ Order data extraction completed successfully
[06:44:59] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:44:59] ℹ️  Using MRN from patient data: '000003599' over '000003599'
[06:44:59] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[06:44:59] ℹ️  Payer source consistent in both sources: 'MassHealth (Medicaid)'
[06:44:59] ✅ Patient name cross-validation successful
[06:44:59] ✅    ✅ Data merged successfully
[06:45:00] ✅    ✅ Order data extracted and validated
[06:45:00] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:45:28] [DOC: 9236467] ✅ Patient exists in API: June Stykowski, ID: 2f2bc479-83f5-430c-8b64-ea174639cc9e
[06:45:28] ✅    ✅ Existing patient found with ID: 2f2bc479-83f5-430c-8b64-ea174639cc9e
[06:45:28] 🔄 
🔄 Step 6: Pushing order to API...
[06:45:28] [DOC: 9236467] ℹ️  Pushing order via API for patient ID: 2f2bc479-83f5-430c-8b64-ea174639cc9e
[06:45:29] [DOC: 9236467] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:45:29] ❌    ❌ Failed to push order
[06:45:29] 🔄 
🔄 Step 7: Writing to CSV...
[06:45:29] [DOC: 9236467] ℹ️  Calculated age: 72 from DOB: 11/08/1952
[06:45:29] [DOC: 9236467] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[06:45:29] [DOC: 9236467] ℹ️  Payer Source extracted: 'MassHealth (Medicaid)'
[06:45:29] [DOC: 9236467] ℹ️  Diagnosis codes being written:
[06:45:29] [DOC: 9236467] ℹ️    - Latest_Episode_Firstdiagnosis: 'N12'
[06:45:29] [DOC: 9236467] ℹ️    - Latest_Episode_Seconddiagnosis: 'N15.1'
[06:45:29] [DOC: 9236467] ℹ️    - Latest_Episode_Thirddiagnosis: 'R78.81'
[06:45:29] [DOC: 9236467] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Z96.0'
[06:45:29] [DOC: 9236467] ℹ️    - Latest_Episode_Fifthdiagnosis: 'M17.12'
[06:45:29] [DOC: 9236467] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M25.562'
[06:45:29] [DOC: 9236467] ✅ Patient data written to CSV: June Stykowski | Sex: MALE | Age: 72 | Service: Skilled Nursing, Physical Therapy | Payer: MassHealth (Medicaid) | MRN: 000003599
[06:45:29] ✅    ✅ Document 9236467 processed and saved successfully
[06:45:29] 🔄 
🔄 Step 8: Saving API details...
[06:45:29] [DOC: 9236467] ℹ️  API push details saved for document 9236467
[06:45:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9236459                         ║
================================================================================
[06:45:29] ℹ️  Agency: AccentCare Fall River
[06:45:29] ℹ️  Date: 04/11/2025
[06:45:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:45:41] [DOC: 9236459] ✅ Text extracted using pdfplumber (23638 chars)
[06:45:41] ✅    ✅ Text extracted using pdfplumber (23542 chars)
[06:45:41] 🔄 
🔄 Step 2: Extracting patient data...
[06:45:45] ℹ️  AI extracted raw sex value: 'M'
[06:45:45] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[06:45:45] ℹ️  AI extracted payer source: 'Medicare'
[06:45:45] ℹ️  AI extracted diagnoses:
[06:45:45] ℹ️    - Diagnosis 1: 'Z47.1'
[06:45:45] ℹ️    - Diagnosis 2: 'D64.9'
[06:45:45] ℹ️    - Diagnosis 3: 'Z79.01'
[06:45:45] ℹ️    - Diagnosis 4: 'Z96.643'
[06:45:45] ℹ️    - Diagnosis 5: 'Z98.84'
[06:45:45] ℹ️    - Diagnosis 6: 'Z85.46'
[06:45:45] ℹ️  Final extracted MRN: 'C0200228136501'
[06:45:45] ℹ️  Final extracted Sex: 'MALE'
[06:45:45] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[06:45:45] ℹ️  Final extracted Payer Source: 'Medicare'
[06:45:45] ✅ Patient data extraction completed successfully
[06:45:45] ✅    ✅ Patient data extracted successfully
[06:45:45] 📊 Patient Response
     └─ patientFName: MICHAEL
     └─ patientLName: SAVAGE
     └─ dob: 05/19/1961
     └─ patientSex: MALE
     └─ medicalRecordNo: C0200228136501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 49 LARK ST
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'D64.9', 'thirdDiagnosis': 'Z79.01', 'fourthDiagnosis': 'Z96.643', 'fifthDiagnosis': 'Z98.84', 'sixthDiagnosis': 'Z85.46'}]
[06:45:45] ✅    ✅ Patient identified: MICHAEL SAVAGE
[06:45:45] ✅    ✅ Patient name validation passed
[06:45:45] 🔄 
🔄 Step 3: Processing patient dates...
[06:45:45] [DOC: 9236459] ℹ️  DOB normalized: 05/19/1961
[06:45:45] [DOC: 9236459] ℹ️  Episode startOfCare normalized: 04/04/2025
[06:45:45] [DOC: 9236459] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[06:45:45] [DOC: 9236459] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[06:45:45] [DOC: 9236459] ✅ Patient date processing completed successfully
[06:45:45] ✅    ✅ Date processing completed
[06:45:45] 📊 Processed Patient Data
     └─ patientFName: MICHAEL
     └─ patientLName: SAVAGE
     └─ dob: 05/19/1961
     └─ patientSex: MALE
     └─ medicalRecordNo: C0200228136501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 227203
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 49 LARK ST
     └─ city: FALL RIVER
     └─ state: MA
     └─ zip: 02723
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'D64.9', 'thirdDiagnosis': 'Z79.01', 'fourthDiagnosis': 'Z96.643', 'fifthDiagnosis': 'Z98.84', 'sixthDiagnosis': 'Z85.46'}]
[06:45:45] 🔄 
🔄 Step 4: Extracting order data...
[06:45:48] ℹ️  Order extraction - MRN: 'C0200228136501'
[06:45:48] ℹ️  Order extraction - Sex: 'MALE'
[06:45:48] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[06:45:48] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:45:48] ✅ Order data extraction completed successfully
[06:45:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:45:48] ℹ️  Using MRN from patient data: 'C0200228136501' over 'C0200228136501'
[06:45:48] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[06:45:48] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:45:48] ✅ Patient name cross-validation successful
[06:45:48] ✅    ✅ Data merged successfully
[06:45:49] ✅    ✅ Order data extracted and validated
[06:45:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:46:58] [DOC: 9236459] ✅ Patient exists in API: MICHAEL SAVAGE, ID: ad448f5a-1df9-4198-bea9-d0f5466e5db1
[06:46:58] ✅    ✅ Existing patient found with ID: ad448f5a-1df9-4198-bea9-d0f5466e5db1
[06:46:58] 🔄 
🔄 Step 6: Pushing order to API...
[06:46:58] [DOC: 9236459] ℹ️  Pushing order via API for patient ID: ad448f5a-1df9-4198-bea9-d0f5466e5db1
[06:47:02] [DOC: 9236459] ❌ Order push failed with status 201: {"id":"86f1650b-f4ab-4316-b3f0-3b99ff7447b9","orderWAVId":"ORD20034","orderNo":"HOME HEALTH CERTIFICATION AND PLAN OF CARE 11976655","orderDate":"04/04/2025","startOfCare":"04/04/2025","episodeStartDate":"04/04/2025","episodeEndDate":"06/02/2025","documentID":"9236459","mrn":"C0200228136501","patientName":"MICHAEL R SAVAGE","sentToPhysicianDate":"04/11/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/27/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"ad448f5a-1df9-4198-bea9-d0f5466e5db1","companyId":"c7cc6389-e15a-468f-bfbc-bc60ac4d4e81","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[06:47:02] ❌    ❌ Failed to push order
[06:47:02] 🔄 
🔄 Step 7: Writing to CSV...
[06:47:02] [DOC: 9236459] ℹ️  Calculated age: 64 from DOB: 05/19/1961
[06:47:02] [DOC: 9236459] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[06:47:02] [DOC: 9236459] ℹ️  Payer Source extracted: 'Medicare'
[06:47:02] [DOC: 9236459] ℹ️  Diagnosis codes being written:
[06:47:02] [DOC: 9236459] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[06:47:02] [DOC: 9236459] ℹ️    - Latest_Episode_Seconddiagnosis: 'D64.9'
[06:47:02] [DOC: 9236459] ℹ️    - Latest_Episode_Thirddiagnosis: 'Z79.01'
[06:47:02] [DOC: 9236459] ℹ️    - Latest_Episode_Fourthdiagnosis: 'Z96.643'
[06:47:02] [DOC: 9236459] ℹ️    - Latest_Episode_Fifthdiagnosis: 'Z98.84'
[06:47:02] [DOC: 9236459] ℹ️    - Latest_Episode_Sixthdiagnosis: 'Z85.46'
[06:47:02] [DOC: 9236459] ✅ Patient data written to CSV: MICHAEL SAVAGE | Sex: MALE | Age: 64 | Service: Skilled Nursing, Physical Therapy | Payer: Medicare | MRN: C0200228136501
[06:47:02] ✅    ✅ Document 9236459 processed and saved successfully
[06:47:02] 🔄 
🔄 Step 8: Saving API details...
[06:47:02] [DOC: 9236459] ℹ️  API push details saved for document 9236459
[06:47:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9236220                         ║
================================================================================
[06:47:02] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:47:02] ℹ️  Date: 04/11/2025
[06:47:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:47:12] [DOC: 9236220] ✅ Text extracted using pdfplumber (21947 chars)
[06:47:12] ✅    ✅ Text extracted using pdfplumber (21947 chars)
[06:47:12] 🔄 
🔄 Step 2: Extracting patient data...
[06:47:15] ℹ️  AI extracted raw sex value: 'M'
[06:47:15] ℹ️  AI extracted service line: 'Physical Therapy'
[06:47:15] ℹ️  AI extracted payer source: ''
[06:47:15] ℹ️  AI extracted diagnoses:
[06:47:15] ℹ️    - Diagnosis 1: 'R hip pain'
[06:47:15] ℹ️    - Diagnosis 2: 'occult R patella fracture'
[06:47:15] ℹ️    - Diagnosis 3: 'None'
[06:47:15] ℹ️    - Diagnosis 4: 'None'
[06:47:15] ℹ️    - Diagnosis 5: 'None'
[06:47:15] ℹ️    - Diagnosis 6: 'None'
[06:47:15] ℹ️  Final extracted MRN: 'MA250124104906'
[06:47:15] ℹ️  Final extracted Sex: 'MALE'
[06:47:15] ℹ️  Final extracted Service Line: 'Physical Therapy'
[06:47:15] ℹ️  Final extracted Payer Source: ''
[06:47:15] ✅ Patient data extraction completed successfully
[06:47:15] ✅    ✅ Patient data extracted successfully
[06:47:15] 📊 Patient Response
     └─ patientFName: George
     └─ patientLName: Carmo
     └─ dob: 10/06/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250124104906
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/27/2025', 'endOfEpisode': None, 'firstDiagnosis': 'R hip pain', 'secondDiagnosis': 'occult R patella fracture', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:47:15] ✅    ✅ Patient identified: George Carmo
[06:47:15] ✅    ✅ Patient name validation passed
[06:47:15] 🔄 
🔄 Step 3: Processing patient dates...
[06:47:15] [DOC: 9236220] ℹ️  DOB normalized: 10/06/1949
[06:47:15] [DOC: 9236220] ℹ️  Episode startOfEpisode normalized: 01/27/2025
[06:47:15] [DOC: 9236220] ✅ Patient date processing completed successfully
[06:47:15] ✅    ✅ Date processing completed
[06:47:15] 📊 Processed Patient Data
     └─ patientFName: George
     └─ patientLName: Carmo
     └─ dob: 10/06/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250124104906
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/27/2025', 'firstDiagnosis': 'R hip pain', 'secondDiagnosis': 'occult R patella fracture'}]
[06:47:15] 🔄 
🔄 Step 4: Extracting order data...
[06:47:19] ℹ️  Order extraction - MRN: 'MA250124104906'
[06:47:19] ℹ️  Order extraction - Sex: 'MALE'
[06:47:19] ℹ️  Order extraction - Service Line: 'PT'
[06:47:19] ℹ️  Order extraction - Payer Source: ''
[06:47:19] ✅ Order data extraction completed successfully
[06:47:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:47:19] ℹ️  Using MRN from patient data: 'MA250124104906' over 'MA250124104906'
[06:47:19] ℹ️  Combined service lines: Patient='Physical Therapy' + Order='PT' = 'PT, Physical Therapy'
[06:47:19] ✅ Patient name cross-validation successful
[06:47:19] ✅    ✅ Data merged successfully
[06:47:20] ✅    ✅ Order data extracted and validated
[06:47:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:47:20] [DOC: 9236220] ✅ Patient found in local cache: George Carmo, ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[06:47:20] ✅    ✅ Existing patient found with ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[06:47:20] 🔄 
🔄 Step 6: Pushing order to API...
[06:47:20] [DOC: 9236220] ℹ️  Pushing order via API for patient ID: 747a9e45-d4ec-4f67-b697-918d82625f8d
[06:47:22] [DOC: 9236220] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:47:22] ❌    ❌ Failed to push order
[06:47:22] 🔄 
🔄 Step 7: Writing to CSV...
[06:47:22] [DOC: 9236220] ℹ️  Calculated age: 75 from DOB: 10/06/1949
[06:47:22] [DOC: 9236220] ℹ️  Service Line extracted: 'PT, Physical Therapy'
[06:47:22] [DOC: 9236220] ℹ️  Payer Source extracted: ''
[06:47:22] [DOC: 9236220] ℹ️  Diagnosis codes being written:
[06:47:22] [DOC: 9236220] ℹ️    - Latest_Episode_Firstdiagnosis: 'R hip pain'
[06:47:22] [DOC: 9236220] ℹ️    - Latest_Episode_Seconddiagnosis: 'occult R patella fracture'
[06:47:22] [DOC: 9236220] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:47:22] [DOC: 9236220] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:47:22] [DOC: 9236220] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:47:22] [DOC: 9236220] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:47:22] [DOC: 9236220] ✅ Patient data written to CSV: George Carmo | Sex: MALE | Age: 75 | Service: PT, Physical Therapy | Payer:  | MRN: MA250124104906
[06:47:22] ✅    ✅ Document 9236220 processed and saved successfully
[06:47:22] 🔄 
🔄 Step 8: Saving API details...
[06:47:22] [DOC: 9236220] ℹ️  API push details saved for document 9236220
[06:47:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9236148                         ║
================================================================================
[06:47:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:47:22] ℹ️  Date: 04/11/2025
[06:47:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:47:25] [DOC: 9236148] ✅ Text extracted using pdfplumber (1407 chars)
[06:47:25] ✅    ✅ Text extracted using pdfplumber (1407 chars)
[06:47:25] 🔄 
🔄 Step 2: Extracting patient data...
[06:47:27] ℹ️  AI extracted raw sex value: ''
[06:47:27] ℹ️  AI extracted service line: 'HHA'
[06:47:27] ℹ️  AI extracted payer source: ''
[06:47:27] ℹ️  AI extracted diagnoses:
[06:47:27] ℹ️    - Diagnosis 1: 'S82.65X'
[06:47:27] ℹ️    - Diagnosis 2: 'I10'
[06:47:27] ℹ️    - Diagnosis 3: 'I25.10'
[06:47:27] ℹ️    - Diagnosis 4: 'None'
[06:47:27] ℹ️    - Diagnosis 5: 'None'
[06:47:27] ℹ️    - Diagnosis 6: 'None'
[06:47:27] ℹ️  Final extracted MRN: 'MA250321073103'
[06:47:27] ℹ️  Final extracted Sex: ''
[06:47:27] ℹ️  Final extracted Service Line: 'HHA'
[06:47:27] ℹ️  Final extracted Payer Source: ''
[06:47:27] ✅ Patient data extraction completed successfully
[06:47:27] ✅    ✅ Patient data extracted successfully
[06:47:27] 📊 Patient Response
     └─ patientFName: Evelyn
     └─ patientLName: Gauthier
     └─ dob: 07/06/1931
     └─ patientSex: 
     └─ medicalRecordNo: MA250321073103
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'S82.65X', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:47:27] ✅    ✅ Patient identified: Evelyn Gauthier
[06:47:27] ✅    ✅ Patient name validation passed
[06:47:27] 🔄 
🔄 Step 3: Processing patient dates...
[06:47:27] [DOC: 9236148] ℹ️  DOB normalized: 07/06/1931
[06:47:27] [DOC: 9236148] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[06:47:27] [DOC: 9236148] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[06:47:27] [DOC: 9236148] ✅ Patient date processing completed successfully
[06:47:27] ✅    ✅ Date processing completed
[06:47:27] 📊 Processed Patient Data
     └─ patientFName: Evelyn
     └─ patientLName: Gauthier
     └─ dob: 07/06/1931
     └─ patientSex: 
     └─ medicalRecordNo: MA250321073103
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'S82.65X', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I25.10'}]
[06:47:27] 🔄 
🔄 Step 4: Extracting order data...
[06:47:30] ℹ️  Order extraction - MRN: 'MA250321073103'
[06:47:30] ℹ️  Order extraction - Sex: ''
[06:47:30] ℹ️  Order extraction - Service Line: 'HHA'
[06:47:30] ℹ️  Order extraction - Payer Source: ''
[06:47:30] ✅ Order data extraction completed successfully
[06:47:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:47:30] ℹ️  Using MRN from patient data: 'MA250321073103' over 'MA250321073103'
[06:47:30] ⚠️  Could not determine sex using any available method
[06:47:30] ℹ️  Service line consistent in both sources: 'HHA'
[06:47:30] ✅ Patient name cross-validation successful
[06:47:30] ✅    ✅ Data merged successfully
[06:47:33] ✅    ✅ Order data extracted and validated
[06:47:33] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:48:09] [DOC: 9236148] ✅ Patient exists in API: Evelyn Gauthier, ID: 74e439ac-f83e-46e2-bdff-cf3edd98eb58
[06:48:09] ✅    ✅ Existing patient found with ID: 74e439ac-f83e-46e2-bdff-cf3edd98eb58
[06:48:09] 🔄 
🔄 Step 6: Pushing order to API...
[06:48:09] [DOC: 9236148] ℹ️  Pushing order via API for patient ID: 74e439ac-f83e-46e2-bdff-cf3edd98eb58
[06:48:10] [DOC: 9236148] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13773"}
[06:48:10] ❌    ❌ Failed to push order
[06:48:10] 🔄 
🔄 Step 7: Writing to CSV...
[06:48:10] [DOC: 9236148] ℹ️  Calculated age: 93 from DOB: 07/06/1931
[06:48:10] [DOC: 9236148] ℹ️  Service Line extracted: 'HHA'
[06:48:10] [DOC: 9236148] ℹ️  Payer Source extracted: ''
[06:48:10] [DOC: 9236148] ℹ️  Diagnosis codes being written:
[06:48:10] [DOC: 9236148] ℹ️    - Latest_Episode_Firstdiagnosis: 'S82.65X'
[06:48:10] [DOC: 9236148] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[06:48:10] [DOC: 9236148] ℹ️    - Latest_Episode_Thirddiagnosis: 'I25.10'
[06:48:10] [DOC: 9236148] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:48:10] [DOC: 9236148] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:48:10] [DOC: 9236148] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:48:10] [DOC: 9236148] ✅ Patient data written to CSV: Evelyn Gauthier | Sex:  | Age: 93 | Service: HHA | Payer:  | MRN: MA250321073103
[06:48:10] ✅    ✅ Document 9236148 processed and saved successfully
[06:48:10] 🔄 
🔄 Step 8: Saving API details...
[06:48:10] [DOC: 9236148] ℹ️  API push details saved for document 9236148
[06:48:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9236145                         ║
================================================================================
[06:48:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:48:10] ℹ️  Date: 04/11/2025
[06:48:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:48:17] [DOC: 9236145] ✅ Text extracted using pdfplumber (1459 chars)
[06:48:17] ✅    ✅ Text extracted using pdfplumber (1459 chars)
[06:48:17] 🔄 
🔄 Step 2: Extracting patient data...
[06:48:20] ℹ️  AI extracted raw sex value: ''
[06:48:20] ℹ️  AI extracted service line: 'Occupational Therapy'
[06:48:20] ℹ️  AI extracted payer source: ''
[06:48:20] ℹ️  AI extracted diagnoses:
[06:48:20] ℹ️    - Diagnosis 1: 'S82.65X'
[06:48:20] ℹ️    - Diagnosis 2: 'I10'
[06:48:20] ℹ️    - Diagnosis 3: 'I25.10'
[06:48:20] ℹ️    - Diagnosis 4: ''
[06:48:20] ℹ️    - Diagnosis 5: ''
[06:48:20] ℹ️    - Diagnosis 6: ''
[06:48:20] ℹ️  Final extracted MRN: 'MA250321073103'
[06:48:20] ℹ️  Final extracted Sex: ''
[06:48:20] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[06:48:20] ℹ️  Final extracted Payer Source: ''
[06:48:20] ✅ Patient data extraction completed successfully
[06:48:20] ✅    ✅ Patient data extracted successfully
[06:48:20] 📊 Patient Response
     └─ patientFName: Evelyn
     └─ patientLName: Gauthier
     └─ dob: 07/06/1931
     └─ patientSex: 
     └─ medicalRecordNo: MA250321073103
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'S82.65X', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:48:20] ✅    ✅ Patient identified: Evelyn Gauthier
[06:48:20] ✅    ✅ Patient name validation passed
[06:48:20] 🔄 
🔄 Step 3: Processing patient dates...
[06:48:20] [DOC: 9236145] ℹ️  DOB normalized: 07/06/1931
[06:48:20] [DOC: 9236145] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[06:48:20] [DOC: 9236145] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[06:48:20] [DOC: 9236145] ✅ Patient date processing completed successfully
[06:48:20] ✅    ✅ Date processing completed
[06:48:20] 📊 Processed Patient Data
     └─ patientFName: Evelyn
     └─ patientLName: Gauthier
     └─ dob: 07/06/1931
     └─ patientSex: 
     └─ medicalRecordNo: MA250321073103
     └─ billingProvider: ROBERT CALDAS DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'S82.65X', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:48:20] 🔄 
🔄 Step 4: Extracting order data...
[06:48:23] ℹ️  Order extraction - MRN: 'MA250321073103'
[06:48:23] ℹ️  Order extraction - Sex: ''
[06:48:23] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[06:48:23] ℹ️  Order extraction - Payer Source: ''
[06:48:23] ✅ Order data extraction completed successfully
[06:48:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:48:23] ℹ️  Using MRN from patient data: 'MA250321073103' over 'MA250321073103'
[06:48:23] ⚠️  Could not determine sex using any available method
[06:48:23] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[06:48:23] ✅ Patient name cross-validation successful
[06:48:23] ✅    ✅ Data merged successfully
[06:48:24] ✅    ✅ Order data extracted and validated
[06:48:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:48:24] [DOC: 9236145] ✅ Patient found in local cache: Evelyn Gauthier, ID: 74e439ac-f83e-46e2-bdff-cf3edd98eb58
[06:48:24] ✅    ✅ Existing patient found with ID: 74e439ac-f83e-46e2-bdff-cf3edd98eb58
[06:48:24] 🔄 
🔄 Step 6: Pushing order to API...
[06:48:24] [DOC: 9236145] ℹ️  Pushing order via API for patient ID: 74e439ac-f83e-46e2-bdff-cf3edd98eb58
[06:48:25] [DOC: 9236145] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13774"}
[06:48:25] ❌    ❌ Failed to push order
[06:48:25] 🔄 
🔄 Step 7: Writing to CSV...
[06:48:25] [DOC: 9236145] ℹ️  Calculated age: 93 from DOB: 07/06/1931
[06:48:25] [DOC: 9236145] ℹ️  Service Line extracted: 'Occupational Therapy'
[06:48:25] [DOC: 9236145] ℹ️  Payer Source extracted: ''
[06:48:25] [DOC: 9236145] ℹ️  Diagnosis codes being written:
[06:48:25] [DOC: 9236145] ℹ️    - Latest_Episode_Firstdiagnosis: 'S82.65X'
[06:48:25] [DOC: 9236145] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[06:48:25] [DOC: 9236145] ℹ️    - Latest_Episode_Thirddiagnosis: 'I25.10'
[06:48:25] [DOC: 9236145] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:48:25] [DOC: 9236145] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:48:25] [DOC: 9236145] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:48:25] [DOC: 9236145] ✅ Patient data written to CSV: Evelyn Gauthier | Sex:  | Age: 93 | Service: Occupational Therapy | Payer:  | MRN: MA250321073103
[06:48:25] ✅    ✅ Document 9236145 processed and saved successfully
[06:48:25] 🔄 
🔄 Step 8: Saving API details...
[06:48:25] [DOC: 9236145] ℹ️  API push details saved for document 9236145
[06:48:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9236144                         ║
================================================================================
[06:48:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:48:25] ℹ️  Date: 04/11/2025
[06:48:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:48:31] [DOC: 9236144] ✅ Text extracted using pdfplumber (13331 chars)
[06:48:31] ✅    ✅ Text extracted using pdfplumber (13331 chars)
[06:48:31] 🔄 
🔄 Step 2: Extracting patient data...
[06:48:34] ℹ️  AI extracted raw sex value: 'F'
[06:48:34] ℹ️  AI extracted service line: 'OT'
[06:48:34] ℹ️  AI extracted payer source: ''
[06:48:34] ℹ️  AI extracted diagnoses:
[06:48:34] ℹ️    - Diagnosis 1: ''
[06:48:34] ℹ️    - Diagnosis 2: ''
[06:48:34] ℹ️    - Diagnosis 3: ''
[06:48:34] ℹ️    - Diagnosis 4: ''
[06:48:34] ℹ️    - Diagnosis 5: ''
[06:48:34] ℹ️    - Diagnosis 6: ''
[06:48:34] ℹ️  Final extracted MRN: 'MA250321073103'
[06:48:34] ℹ️  Final extracted Sex: 'FEMALE'
[06:48:34] ℹ️  Final extracted Service Line: 'OT'
[06:48:34] ℹ️  Final extracted Payer Source: ''
[06:48:34] ✅ Patient data extraction completed successfully
[06:48:34] ✅    ✅ Patient data extracted successfully
[06:48:34] 📊 Patient Response
     └─ patientFName: Evelyn
     └─ patientLName: Gauthier
     └─ dob: 07/06/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250321073103
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:48:34] ✅    ✅ Patient identified: Evelyn Gauthier
[06:48:34] ✅    ✅ Patient name validation passed
[06:48:34] 🔄 
🔄 Step 3: Processing patient dates...
[06:48:34] [DOC: 9236144] ℹ️  DOB normalized: 07/06/1931
[06:48:34] [DOC: 9236144] ℹ️  Episode startOfEpisode normalized: 03/28/2025
[06:48:34] [DOC: 9236144] ✅ Patient date processing completed successfully
[06:48:34] ✅    ✅ Date processing completed
[06:48:34] 📊 Processed Patient Data
     └─ patientFName: Evelyn
     └─ patientLName: Gauthier
     └─ dob: 07/06/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250321073103
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/28/2025', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:48:34] 🔄 
🔄 Step 4: Extracting order data...
[06:48:37] ℹ️  Order extraction - MRN: 'MA250321073103'
[06:48:37] ℹ️  Order extraction - Sex: 'FEMALE'
[06:48:37] ℹ️  Order extraction - Service Line: 'OT'
[06:48:37] ℹ️  Order extraction - Payer Source: ''
[06:48:37] ✅ Order data extraction completed successfully
[06:48:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:48:37] ℹ️  Using MRN from patient data: 'MA250321073103' over 'MA250321073103'
[06:48:37] ℹ️  Service line consistent in both sources: 'OT'
[06:48:37] ✅ Patient name cross-validation successful
[06:48:37] ✅    ✅ Data merged successfully
[06:48:38] ✅    ✅ Order data extracted and validated
[06:48:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:48:38] [DOC: 9236144] ✅ Patient found in local cache: Evelyn Gauthier, ID: 74e439ac-f83e-46e2-bdff-cf3edd98eb58
[06:48:38] ✅    ✅ Existing patient found with ID: 74e439ac-f83e-46e2-bdff-cf3edd98eb58
[06:48:38] 🔄 
🔄 Step 6: Pushing order to API...
[06:48:38] [DOC: 9236144] ℹ️  Pushing order via API for patient ID: 74e439ac-f83e-46e2-bdff-cf3edd98eb58
[06:48:39] [DOC: 9236144] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:48:39] ❌    ❌ Failed to push order
[06:48:39] 🔄 
🔄 Step 7: Writing to CSV...
[06:48:39] [DOC: 9236144] ℹ️  Calculated age: 93 from DOB: 07/06/1931
[06:48:39] [DOC: 9236144] ℹ️  Service Line extracted: 'OT'
[06:48:39] [DOC: 9236144] ℹ️  Payer Source extracted: ''
[06:48:39] [DOC: 9236144] ℹ️  Diagnosis codes being written:
[06:48:39] [DOC: 9236144] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:48:39] [DOC: 9236144] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:48:39] [DOC: 9236144] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:48:39] [DOC: 9236144] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:48:39] [DOC: 9236144] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:48:39] [DOC: 9236144] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:48:39] [DOC: 9236144] ✅ Patient data written to CSV: Evelyn Gauthier | Sex: FEMALE | Age: 93 | Service: OT | Payer:  | MRN: MA250321073103
[06:48:39] ✅    ✅ Document 9236144 processed and saved successfully
[06:48:39] 🔄 
🔄 Step 8: Saving API details...
[06:48:39] [DOC: 9236144] ℹ️  API push details saved for document 9236144
[06:48:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9236142                         ║
================================================================================
[06:48:39] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:48:39] ℹ️  Date: 04/11/2025
[06:48:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:48:46] [DOC: 9236142] ✅ Text extracted using pdfplumber (13969 chars)
[06:48:46] ✅    ✅ Text extracted using pdfplumber (13969 chars)
[06:48:46] 🔄 
🔄 Step 2: Extracting patient data...
[06:48:49] ℹ️  AI extracted raw sex value: 'F'
[06:48:49] ℹ️  AI extracted service line: 'PT, OT, HHA'
[06:48:49] ℹ️  AI extracted payer source: 'Medicare'
[06:48:49] ℹ️  AI extracted diagnoses:
[06:48:49] ℹ️    - Diagnosis 1: 'S82.65X'
[06:48:49] ℹ️    - Diagnosis 2: 'I10'
[06:48:49] ℹ️    - Diagnosis 3: 'I25.10'
[06:48:49] ℹ️    - Diagnosis 4: 'I05.1'
[06:48:49] ℹ️    - Diagnosis 5: 'I44.2'
[06:48:49] ℹ️    - Diagnosis 6: 'M81.0'
[06:48:49] ℹ️  Final extracted MRN: 'MA250321073103'
[06:48:49] ℹ️  Final extracted Sex: 'FEMALE'
[06:48:49] ℹ️  Final extracted Service Line: 'PT, OT, HHA'
[06:48:49] ℹ️  Final extracted Payer Source: 'Medicare'
[06:48:49] ✅ Patient data extraction completed successfully
[06:48:49] ✅    ✅ Patient data extracted successfully
[06:48:49] 📊 Patient Response
     └─ patientFName: Evelyn
     └─ patientLName: Gauthier
     └─ dob: 07/06/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250321073103
     └─ billingProvider: CALDAS, ROBERT DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 27 Slade St
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: None
     └─ phoneNumber: (774) 218-5059
     └─ serviceLine: PT, OT, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'S82.65X', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'I05.1', 'fifthDiagnosis': 'I44.2', 'sixthDiagnosis': 'M81.0'}]
[06:48:49] ✅    ✅ Patient identified: Evelyn Gauthier
[06:48:49] ✅    ✅ Patient name validation passed
[06:48:49] 🔄 
🔄 Step 3: Processing patient dates...
[06:48:49] [DOC: 9236142] ℹ️  DOB normalized: 07/06/1931
[06:48:49] [DOC: 9236142] ℹ️  Episode startOfCare normalized: 03/22/2025
[06:48:49] [DOC: 9236142] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[06:48:49] [DOC: 9236142] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[06:48:49] [DOC: 9236142] ✅ Patient date processing completed successfully
[06:48:49] ✅    ✅ Date processing completed
[06:48:49] 📊 Processed Patient Data
     └─ patientFName: Evelyn
     └─ patientLName: Gauthier
     └─ dob: 07/06/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250321073103
     └─ billingProvider: CALDAS, ROBERT DO
     └─ npi: 1124032883
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 27 Slade St
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ phoneNumber: (774) 218-5059
     └─ serviceLine: PT, OT, HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': 'S82.65X', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'I05.1', 'fifthDiagnosis': 'I44.2', 'sixthDiagnosis': 'M81.0'}]
[06:48:49] 🔄 
🔄 Step 4: Extracting order data...
[06:48:52] ℹ️  Order extraction - MRN: 'MA250321073103'
[06:48:52] ℹ️  Order extraction - Sex: 'FEMALE'
[06:48:52] ℹ️  Order extraction - Service Line: 'PT, OT, HHA'
[06:48:52] ℹ️  Order extraction - Payer Source: ''
[06:48:52] ✅ Order data extraction completed successfully
[06:48:52] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:48:52] ℹ️  Using MRN from patient data: 'MA250321073103' over 'MA250321073103'
[06:48:52] ℹ️  Service line consistent in both sources: 'PT, OT, HHA'
[06:48:52] ℹ️  Using payer source from patient data: 'Medicare'
[06:48:52] ✅ Patient name cross-validation successful
[06:48:52] ✅    ✅ Data merged successfully
[06:48:53] ✅    ✅ Order data extracted and validated
[06:48:53] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:48:53] [DOC: 9236142] ✅ Patient found in local cache: Evelyn Gauthier, ID: 74e439ac-f83e-46e2-bdff-cf3edd98eb58
[06:48:53] ✅    ✅ Existing patient found with ID: 74e439ac-f83e-46e2-bdff-cf3edd98eb58
[06:48:53] 🔄 
🔄 Step 6: Pushing order to API...
[06:48:53] [DOC: 9236142] ℹ️  Pushing order via API for patient ID: 74e439ac-f83e-46e2-bdff-cf3edd98eb58
[06:48:54] [DOC: 9236142] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13775"}
[06:48:54] ❌    ❌ Failed to push order
[06:48:54] 🔄 
🔄 Step 7: Writing to CSV...
[06:48:54] [DOC: 9236142] ℹ️  Calculated age: 93 from DOB: 07/06/1931
[06:48:54] [DOC: 9236142] ℹ️  Service Line extracted: 'PT, OT, HHA'
[06:48:54] [DOC: 9236142] ℹ️  Payer Source extracted: 'Medicare'
[06:48:54] [DOC: 9236142] ℹ️  Diagnosis codes being written:
[06:48:54] [DOC: 9236142] ℹ️    - Latest_Episode_Firstdiagnosis: 'S82.65X'
[06:48:54] [DOC: 9236142] ℹ️    - Latest_Episode_Seconddiagnosis: 'I10'
[06:48:54] [DOC: 9236142] ℹ️    - Latest_Episode_Thirddiagnosis: 'I25.10'
[06:48:54] [DOC: 9236142] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I05.1'
[06:48:54] [DOC: 9236142] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I44.2'
[06:48:54] [DOC: 9236142] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M81.0'
[06:48:54] [DOC: 9236142] ✅ Patient data written to CSV: Evelyn Gauthier | Sex: FEMALE | Age: 93 | Service: PT, OT, HHA | Payer: Medicare | MRN: MA250321073103
[06:48:54] ✅    ✅ Document 9236142 processed and saved successfully
[06:48:54] 🔄 
🔄 Step 8: Saving API details...
[06:48:54] [DOC: 9236142] ℹ️  API push details saved for document 9236142
[06:48:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9236093                         ║
================================================================================
[06:48:54] ℹ️  Agency: Alphacare Home Health Agency
[06:48:54] ℹ️  Date: 04/11/2025
[06:48:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:48:59] [DOC: 9236093] ✅ Text extracted using pdfplumber (1529 chars)
[06:48:59] ✅    ✅ Text extracted using pdfplumber (1529 chars)
[06:48:59] 🔄 
🔄 Step 2: Extracting patient data...
[06:49:02] ℹ️  AI extracted raw sex value: ''
[06:49:02] ℹ️  AI extracted service line: 'RN'
[06:49:02] ℹ️  AI extracted payer source: ''
[06:49:02] ℹ️  AI extracted diagnoses:
[06:49:02] ℹ️    - Diagnosis 1: 'None'
[06:49:02] ℹ️    - Diagnosis 2: 'None'
[06:49:02] ℹ️    - Diagnosis 3: 'None'
[06:49:02] ℹ️    - Diagnosis 4: 'None'
[06:49:02] ℹ️    - Diagnosis 5: 'None'
[06:49:02] ℹ️    - Diagnosis 6: 'None'
[06:49:02] ℹ️  Final extracted MRN: '000000085'
[06:49:02] ℹ️  Final extracted Sex: ''
[06:49:02] ℹ️  Final extracted Service Line: 'RN'
[06:49:02] ℹ️  Final extracted Payer Source: ''
[06:49:02] ✅ Patient data extraction completed successfully
[06:49:02] ✅    ✅ Patient data extracted successfully
[06:49:02] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Lowman
     └─ dob: 04/05/1968
     └─ patientSex: 
     └─ medicalRecordNo: 000000085
     └─ billingProvider: Dhungana Parajuli, Sirjana (MD (Dr. Alliance))
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:49:02] ✅    ✅ Patient identified: James Lowman
[06:49:02] ✅    ✅ Patient name validation passed
[06:49:02] 🔄 
🔄 Step 3: Processing patient dates...
[06:49:02] [DOC: 9236093] ℹ️  DOB normalized: 04/05/1968
[06:49:02] [DOC: 9236093] ✅ Patient date processing completed successfully
[06:49:02] ✅    ✅ Date processing completed
[06:49:02] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Lowman
     └─ dob: 04/05/1968
     └─ patientSex: 
     └─ medicalRecordNo: 000000085
     └─ billingProvider: Dhungana Parajuli, Sirjana (MD (Dr. Alliance))
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[06:49:02] 🔄 
🔄 Step 4: Extracting order data...
[06:49:04] ℹ️  Order extraction - MRN: '000000085'
[06:49:04] ℹ️  Order extraction - Sex: ''
[06:49:04] ℹ️  Order extraction - Service Line: 'HHA'
[06:49:04] ℹ️  Order extraction - Payer Source: ''
[06:49:04] ✅ Order data extraction completed successfully
[06:49:04] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:49:04] ℹ️  Using MRN from patient data: '000000085' over '000000085'
[06:49:04] ℹ️  Inferred sex as MALE from name: James
[06:49:04] ℹ️  Combined service lines: Patient='RN' + Order='HHA' = 'HHA, RN'
[06:49:04] ✅ Patient name cross-validation successful
[06:49:04] ✅    ✅ Data merged successfully
[06:49:06] ⚠️     ❌ Skipping - missing episode start date
[06:49:06] [DOC: 9236093] ℹ️  API push details saved for document 9236093
================================================================================
║                        Processing Document ID: 9235719                         ║
================================================================================
[06:49:06] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:49:06] ℹ️  Date: 04/11/2025
[06:49:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:49:08] [DOC: 9235719] ✅ Text extracted using pdfplumber (18182 chars)
[06:49:08] ✅    ✅ Text extracted using pdfplumber (18170 chars)
[06:49:08] 🔄 
🔄 Step 2: Extracting patient data...
[06:49:12] ℹ️  AI extracted raw sex value: 'F'
[06:49:12] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide'
[06:49:12] ℹ️  AI extracted payer source: 'NGS medicare'
[06:49:12] ℹ️  AI extracted diagnoses:
[06:49:12] ℹ️    - Diagnosis 1: 'S02.2XX'
[06:49:12] ℹ️    - Diagnosis 2: 'S01.81X'
[06:49:12] ℹ️    - Diagnosis 3: 'E03.9'
[06:49:12] ℹ️    - Diagnosis 4: 'I10'
[06:49:12] ℹ️    - Diagnosis 5: 'R26.89'
[06:49:12] ℹ️    - Diagnosis 6: 'Z90.710'
[06:49:12] ℹ️  Final extracted MRN: 'MA241009113701'
[06:49:12] ℹ️  Final extracted Sex: 'FEMALE'
[06:49:12] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide'
[06:49:12] ℹ️  Final extracted Payer Source: 'NGS medicare'
[06:49:12] ✅ Patient data extraction completed successfully
[06:49:12] ✅    ✅ Patient data extracted successfully
[06:49:12] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Figueiredo
     └─ dob: 11/11/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241009113701
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 1881923936
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 570 Old Westport Rd
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: None
     └─ phoneNumber: (508) 636-2772
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide
     └─ payorSource: NGS medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'S02.2XX', 'secondDiagnosis': 'S01.81X', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'R26.89', 'sixthDiagnosis': 'Z90.710'}]
[06:49:12] ✅    ✅ Patient identified: Maria Figueiredo
[06:49:12] ✅    ✅ Patient name validation passed
[06:49:12] 🔄 
🔄 Step 3: Processing patient dates...
[06:49:12] [DOC: 9235719] ℹ️  DOB normalized: 11/11/1937
[06:49:12] [DOC: 9235719] ℹ️  Episode startOfCare normalized: 03/18/2025
[06:49:12] [DOC: 9235719] ℹ️  Episode startOfEpisode normalized: 03/21/2025
[06:49:12] [DOC: 9235719] ℹ️  Episode endOfEpisode normalized: 05/19/2025
[06:49:12] [DOC: 9235719] ✅ Patient date processing completed successfully
[06:49:12] ✅    ✅ Date processing completed
[06:49:12] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Figueiredo
     └─ dob: 11/11/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241009113701
     └─ billingProvider: Dr. Caldas, Robert J.
     └─ npi: 1881923936
     └─ physicianNPI: 1124032883
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 570 Old Westport Rd
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ phoneNumber: (508) 636-2772
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide
     └─ payorSource: NGS medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/18/2025', 'startOfEpisode': '03/21/2025', 'endOfEpisode': '05/19/2025', 'firstDiagnosis': 'S02.2XX', 'secondDiagnosis': 'S01.81X', 'thirdDiagnosis': 'E03.9', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'R26.89', 'sixthDiagnosis': 'Z90.710'}]
[06:49:12] 🔄 
🔄 Step 4: Extracting order data...
[06:49:15] ℹ️  Order extraction - MRN: 'MA241009113701'
[06:49:15] ℹ️  Order extraction - Sex: 'FEMALE'
[06:49:15] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide'
[06:49:15] ℹ️  Order extraction - Payer Source: 'NGS medicare'
[06:49:15] ✅ Order data extraction completed successfully
[06:49:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:49:15] ℹ️  Using MRN from patient data: 'MA241009113701' over 'MA241009113701'
[06:49:15] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy, Home Health Aide'
[06:49:15] ℹ️  Payer source consistent in both sources: 'NGS medicare'
[06:49:15] ✅ Patient name cross-validation successful
[06:49:15] ✅    ✅ Data merged successfully
[06:49:16] ✅    ✅ Order data extracted and validated
[06:49:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:50:35] [DOC: 9235719] ℹ️  Patient not found in cache or API: Maria Figueiredo
[06:50:35] [DOC: 9235719] ℹ️  Patient not found, creating new patient via API...
[06:50:35] [DOC: 9235719] ℹ️  Creating patient via API: Maria Figueiredo
[06:50:36] [DOC: 9235719] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:50:36] ❌    ❌ Failed to create patient
[06:50:36] [DOC: 9235719] ℹ️  API push details saved for document 9235719
================================================================================
║                        Processing Document ID: 9235556                         ║
================================================================================
[06:50:36] ℹ️  Agency: Alphacare Home Health Agency
[06:50:36] ℹ️  Date: 04/11/2025
[06:50:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:50:40] [DOC: 9235556] ✅ Text extracted using pdfplumber (1587 chars)
[06:50:40] ✅    ✅ Text extracted using pdfplumber (1587 chars)
[06:50:40] 🔄 
🔄 Step 2: Extracting patient data...
[06:50:42] ℹ️  AI extracted raw sex value: ''
[06:50:42] ℹ️  AI extracted service line: 'RN'
[06:50:42] ℹ️  AI extracted payer source: ''
[06:50:42] ℹ️  AI extracted diagnoses:
[06:50:42] ℹ️    - Diagnosis 1: ''
[06:50:42] ℹ️    - Diagnosis 2: ''
[06:50:42] ℹ️    - Diagnosis 3: ''
[06:50:42] ℹ️    - Diagnosis 4: ''
[06:50:42] ℹ️    - Diagnosis 5: ''
[06:50:42] ℹ️    - Diagnosis 6: ''
[06:50:42] ℹ️  Final extracted MRN: '000000085'
[06:50:42] ℹ️  Final extracted Sex: ''
[06:50:42] ℹ️  Final extracted Service Line: 'RN'
[06:50:42] ℹ️  Final extracted Payer Source: ''
[06:50:42] ✅ Patient data extraction completed successfully
[06:50:42] ✅    ✅ Patient data extracted successfully
[06:50:42] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Lowman
     └─ dob: 04/05/1968
     └─ patientSex: 
     └─ medicalRecordNo: 000000085
     └─ billingProvider: Dhungana Parajuli, Sirjana (MD (Dr. Alliance))
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:50:42] ✅    ✅ Patient identified: James Lowman
[06:50:42] ✅    ✅ Patient name validation passed
[06:50:42] 🔄 
🔄 Step 3: Processing patient dates...
[06:50:42] [DOC: 9235556] ℹ️  DOB normalized: 04/05/1968
[06:50:42] [DOC: 9235556] ✅ Patient date processing completed successfully
[06:50:42] ✅    ✅ Date processing completed
[06:50:42] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Lowman
     └─ dob: 04/05/1968
     └─ patientSex: 
     └─ medicalRecordNo: 000000085
     └─ billingProvider: Dhungana Parajuli, Sirjana (MD (Dr. Alliance))
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:50:42] 🔄 
🔄 Step 4: Extracting order data...
[06:50:45] ℹ️  Order extraction - MRN: '000000085'
[06:50:45] ℹ️  Order extraction - Sex: ''
[06:50:45] ℹ️  Order extraction - Service Line: 'HHA'
[06:50:45] ℹ️  Order extraction - Payer Source: ''
[06:50:45] ✅ Order data extraction completed successfully
[06:50:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:50:45] ℹ️  Using MRN from patient data: '000000085' over '000000085'
[06:50:45] ℹ️  Inferred sex as MALE from name: James
[06:50:45] ℹ️  Combined service lines: Patient='RN' + Order='HHA' = 'HHA, RN'
[06:50:45] ✅ Patient name cross-validation successful
[06:50:45] ✅    ✅ Data merged successfully
[06:50:46] ⚠️     ❌ Skipping - missing episode start date
[06:50:46] [DOC: 9235556] ℹ️  API push details saved for document 9235556
================================================================================
║                        Processing Document ID: 9235501                         ║
================================================================================
[06:50:46] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:50:46] ℹ️  Date: 04/11/2025
[06:50:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:50:50] [DOC: 9235501] ✅ Text extracted using pdfplumber (4469 chars)
[06:50:50] ✅    ✅ Text extracted using pdfplumber (4469 chars)
[06:50:50] 🔄 
🔄 Step 2: Extracting patient data...
[06:50:52] ℹ️  AI extracted raw sex value: ''
[06:50:52] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:50:52] ℹ️  AI extracted payer source: 'None'
[06:50:52] ℹ️  AI extracted diagnoses:
[06:50:52] ℹ️    - Diagnosis 1: 'I48.92'
[06:50:52] ℹ️    - Diagnosis 2: 'A08.4'
[06:50:52] ℹ️    - Diagnosis 3: 'J18.9'
[06:50:52] ℹ️    - Diagnosis 4: 'None'
[06:50:52] ℹ️    - Diagnosis 5: 'None'
[06:50:52] ℹ️    - Diagnosis 6: 'None'
[06:50:52] ℹ️  Final extracted MRN: 'MA220722094502'
[06:50:52] ℹ️  Final extracted Sex: ''
[06:50:52] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:50:52] ℹ️  Final extracted Payer Source: ''
[06:50:52] ✅ Patient data extraction completed successfully
[06:50:52] ✅    ✅ Patient data extracted successfully
[06:50:52] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: CHARLES BEALE M. D.
     └─ npi: 1407146962
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'I48.92', 'secondDiagnosis': 'A08.4', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:50:52] ✅    ✅ Patient identified: Robert McHale
[06:50:52] ✅    ✅ Patient name validation passed
[06:50:52] 🔄 
🔄 Step 3: Processing patient dates...
[06:50:52] [DOC: 9235501] ℹ️  DOB normalized: 09/12/1945
[06:50:52] [DOC: 9235501] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[06:50:52] [DOC: 9235501] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[06:50:52] [DOC: 9235501] ✅ Patient date processing completed successfully
[06:50:52] ✅    ✅ Date processing completed
[06:50:52] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: CHARLES BEALE M. D.
     └─ npi: 1407146962
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'I48.92', 'secondDiagnosis': 'A08.4', 'thirdDiagnosis': 'J18.9'}]
[06:50:52] 🔄 
🔄 Step 4: Extracting order data...
[06:50:55] ℹ️  Order extraction - MRN: 'MA220722094502'
[06:50:55] ℹ️  Order extraction - Sex: ''
[06:50:55] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:50:55] ℹ️  Order extraction - Payer Source: ''
[06:50:55] ✅ Order data extraction completed successfully
[06:50:55] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:50:55] ℹ️  Using MRN from patient data: 'MA220722094502' over 'MA220722094502'
[06:50:55] ℹ️  Inferred sex as MALE from name: Robert
[06:50:55] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:50:55] ✅ Patient name cross-validation successful
[06:50:55] ✅    ✅ Data merged successfully
[06:50:56] ✅    ✅ Order data extracted and validated
[06:50:56] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:51:58] [DOC: 9235501] ℹ️  Patient not found in cache or API: Robert McHale
[06:51:58] [DOC: 9235501] ℹ️  Patient not found, creating new patient via API...
[06:51:58] [DOC: 9235501] ℹ️  Creating patient via API: Robert McHale
[06:52:01] [DOC: 9235501] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:52:01] ❌    ❌ Failed to create patient
[06:52:01] [DOC: 9235501] ℹ️  API push details saved for document 9235501
================================================================================
║                        Processing Document ID: 9235490                         ║
================================================================================
[06:52:01] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:52:01] ℹ️  Date: 04/11/2025
[06:52:01] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:52:03] [DOC: 9235490] ✅ Text extracted using pdfplumber (1575 chars)
[06:52:03] ✅    ✅ Text extracted using pdfplumber (1575 chars)
[06:52:03] 🔄 
🔄 Step 2: Extracting patient data...
[06:52:06] ℹ️  AI extracted raw sex value: ''
[06:52:06] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:52:06] ℹ️  AI extracted payer source: ''
[06:52:06] ℹ️  AI extracted diagnoses:
[06:52:06] ℹ️    - Diagnosis 1: 'L97.519'
[06:52:06] ℹ️    - Diagnosis 2: 'E11.621'
[06:52:06] ℹ️    - Diagnosis 3: 'Z47.81'
[06:52:06] ℹ️    - Diagnosis 4: ''
[06:52:06] ℹ️    - Diagnosis 5: ''
[06:52:06] ℹ️    - Diagnosis 6: ''
[06:52:06] ℹ️  Final extracted MRN: '100994258'
[06:52:06] ℹ️  Final extracted Sex: ''
[06:52:06] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:52:06] ℹ️  Final extracted Payer Source: ''
[06:52:06] ✅ Patient data extraction completed successfully
[06:52:06] ✅    ✅ Patient data extracted successfully
[06:52:06] 📊 Patient Response
     └─ patientFName: Gloria
     └─ patientLName: Diaz
     └─ dob: 04/09/1951
     └─ patientSex: 
     └─ medicalRecordNo: 100994258
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '04/09/2025', 'firstDiagnosis': 'L97.519', 'secondDiagnosis': 'E11.621', 'thirdDiagnosis': 'Z47.81', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:52:06] ✅    ✅ Patient identified: Gloria Diaz
[06:52:06] ✅    ✅ Patient name validation passed
[06:52:06] 🔄 
🔄 Step 3: Processing patient dates...
[06:52:06] [DOC: 9235490] ℹ️  DOB normalized: 04/09/1951
[06:52:06] [DOC: 9235490] ℹ️  Episode startOfEpisode normalized: 02/09/2025
[06:52:06] [DOC: 9235490] ℹ️  Episode endOfEpisode normalized: 04/09/2025
[06:52:06] [DOC: 9235490] ✅ Patient date processing completed successfully
[06:52:06] ✅    ✅ Date processing completed
[06:52:06] 📊 Processed Patient Data
     └─ patientFName: Gloria
     └─ patientLName: Diaz
     └─ dob: 04/09/1951
     └─ patientSex: 
     └─ medicalRecordNo: 100994258
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '02/09/2025', 'endOfEpisode': '04/09/2025', 'firstDiagnosis': 'L97.519', 'secondDiagnosis': 'E11.621', 'thirdDiagnosis': 'Z47.81', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:52:06] 🔄 
🔄 Step 4: Extracting order data...
[06:52:09] ℹ️  Order extraction - MRN: '100994258'
[06:52:09] ℹ️  Order extraction - Sex: ''
[06:52:09] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:52:09] ℹ️  Order extraction - Payer Source: ''
[06:52:09] ✅ Order data extraction completed successfully
[06:52:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:52:09] ℹ️  Using MRN from patient data: '100994258' over '100994258'
[06:52:09] ⚠️  Could not determine sex using any available method
[06:52:09] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:52:09] ✅ Patient name cross-validation successful
[06:52:09] ✅    ✅ Data merged successfully
[06:52:11] ✅    ✅ Order data extracted and validated
[06:52:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:53:59] [DOC: 9235490] ℹ️  Patient not found in cache or API: Gloria Diaz
[06:53:59] [DOC: 9235490] ℹ️  Patient not found, creating new patient via API...
[06:53:59] [DOC: 9235490] ℹ️  Creating patient via API: Gloria Diaz
[06:54:06] [DOC: 9235490] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:54:06] ❌    ❌ Failed to create patient
[06:54:06] [DOC: 9235490] ℹ️  API push details saved for document 9235490
================================================================================
║                        Processing Document ID: 9235483                         ║
================================================================================
[06:54:06] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:54:06] ℹ️  Date: 04/11/2025
[06:54:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:54:44] [DOC: 9235483] ⚠️  Network error attempt 1, retrying...
[06:54:56] [DOC: 9235483] ✅ Text extracted using pdfplumber (22243 chars)
[06:54:56] ✅    ✅ Text extracted using pdfplumber (22243 chars)
[06:54:56] 🔄 
🔄 Step 2: Extracting patient data...
[06:55:00] ℹ️  AI extracted raw sex value: 'F'
[06:55:00] ℹ️  AI extracted service line: 'OT'
[06:55:00] ℹ️  AI extracted payer source: 'None'
[06:55:00] ℹ️  AI extracted diagnoses:
[06:55:00] ℹ️    - Diagnosis 1: 'altered mental status'
[06:55:00] ℹ️    - Diagnosis 2: 'weakness/limitations/bed bound'
[06:55:00] ℹ️    - Diagnosis 3: 'MS which impacts her overall functioning'
[06:55:00] ℹ️    - Diagnosis 4: 'Multiple sclerosis'
[06:55:00] ℹ️    - Diagnosis 5: 'Spondylosis w/o myelopathy or radiculopathy, cervical region'
[06:55:00] ℹ️    - Diagnosis 6: 'Age-related osteoporosis w/o current pathological fracture, thoracic,thoracolumbar and lumbosacral disc disorder'
[06:55:00] ℹ️  Final extracted MRN: 'MA210203125202'
[06:55:00] ℹ️  Final extracted Sex: 'FEMALE'
[06:55:00] ℹ️  Final extracted Service Line: 'OT'
[06:55:00] ℹ️  Final extracted Payer Source: ''
[06:55:00] ✅ Patient data extraction completed successfully
[06:55:00] ✅    ✅ Patient data extracted successfully
[06:55:00] 📊 Patient Response
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '01/11/2025', 'endOfEpisode': None, 'firstDiagnosis': 'altered mental status', 'secondDiagnosis': 'weakness/limitations/bed bound', 'thirdDiagnosis': 'MS which impacts her overall functioning', 'fourthDiagnosis': 'Multiple sclerosis', 'fifthDiagnosis': 'Spondylosis w/o myelopathy or radiculopathy, cervical region', 'sixthDiagnosis': 'Age-related osteoporosis w/o current pathological fracture, thoracic,thoracolumbar and lumbosacral disc disorder'}]
[06:55:00] ✅    ✅ Patient identified: Ida Souza
[06:55:00] ✅    ✅ Patient name validation passed
[06:55:00] 🔄 
🔄 Step 3: Processing patient dates...
[06:55:00] [DOC: 9235483] ℹ️  DOB normalized: 12/11/1952
[06:55:00] [DOC: 9235483] ℹ️  Episode startOfEpisode normalized: 01/11/2025
[06:55:00] [DOC: 9235483] ✅ Patient date processing completed successfully
[06:55:00] ✅    ✅ Date processing completed
[06:55:00] 📊 Processed Patient Data
     └─ patientFName: Ida
     └─ patientLName: Souza
     └─ dob: 12/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210203125202
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/11/2025', 'firstDiagnosis': 'altered mental status', 'secondDiagnosis': 'weakness/limitations/bed bound', 'thirdDiagnosis': 'MS which impacts her overall functioning', 'fourthDiagnosis': 'Multiple sclerosis', 'fifthDiagnosis': 'Spondylosis w/o myelopathy or radiculopathy, cervical region', 'sixthDiagnosis': 'Age-related osteoporosis w/o current pathological fracture, thoracic,thoracolumbar and lumbosacral disc disorder'}]
[06:55:00] 🔄 
🔄 Step 4: Extracting order data...
[06:55:06] ℹ️  Order extraction - MRN: 'MA210203125202'
[06:55:06] ℹ️  Order extraction - Sex: 'FEMALE'
[06:55:06] ℹ️  Order extraction - Service Line: 'OT'
[06:55:06] ℹ️  Order extraction - Payer Source: ''
[06:55:06] ✅ Order data extraction completed successfully
[06:55:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:55:06] ℹ️  Using MRN from patient data: 'MA210203125202' over 'MA210203125202'
[06:55:06] ℹ️  Service line consistent in both sources: 'OT'
[06:55:06] ✅ Patient name cross-validation successful
[06:55:06] ✅    ✅ Data merged successfully
[06:55:11] ⚠️     ❌ Skipping - missing episode start date
[06:55:11] [DOC: 9235483] ℹ️  API push details saved for document 9235483
================================================================================
║                        Processing Document ID: 9235477                         ║
================================================================================
[06:55:11] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:55:11] ℹ️  Date: 04/11/2025
[06:55:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:55:16] [DOC: 9235477] ✅ Text extracted using pdfplumber (9360 chars)
[06:55:16] ✅    ✅ Text extracted using pdfplumber (9360 chars)
[06:55:16] 🔄 
🔄 Step 2: Extracting patient data...
[06:55:20] ℹ️  AI extracted raw sex value: 'F'
[06:55:20] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:55:20] ℹ️  AI extracted payer source: 'Medicare'
[06:55:20] ℹ️  AI extracted diagnoses:
[06:55:20] ℹ️    - Diagnosis 1: 'E11.65'
[06:55:20] ℹ️    - Diagnosis 2: 'E78.00'
[06:55:20] ℹ️    - Diagnosis 3: 'M15.9'
[06:55:20] ℹ️    - Diagnosis 4: 'K91.2'
[06:55:20] ℹ️    - Diagnosis 5: 'G25.81'
[06:55:20] ℹ️    - Diagnosis 6: 'D50.9'
[06:55:20] ℹ️  Final extracted MRN: 'MA241111055903'
[06:55:20] ℹ️  Final extracted Sex: 'FEMALE'
[06:55:20] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:55:20] ℹ️  Final extracted Payer Source: 'Medicare'
[06:55:20] ✅ Patient data extraction completed successfully
[06:55:20] ✅    ✅ Patient data extracted successfully
[06:55:20] 📊 Patient Response
     └─ patientFName: Anabela
     └─ patientLName: Ferrinha
     └─ dob: 05/24/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241111055903
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 956 Rockdale Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: None
     └─ phoneNumber: (508) 728-5414
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/14/2024', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E78.00', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': 'K91.2', 'fifthDiagnosis': 'G25.81', 'sixthDiagnosis': 'D50.9'}]
[06:55:20] ✅    ✅ Patient identified: Anabela Ferrinha
[06:55:20] ✅    ✅ Patient name validation passed
[06:55:20] 🔄 
🔄 Step 3: Processing patient dates...
[06:55:20] [DOC: 9235477] ℹ️  DOB normalized: 05/24/1959
[06:55:20] [DOC: 9235477] ℹ️  Episode startOfCare normalized: 11/14/2024
[06:55:20] [DOC: 9235477] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[06:55:20] [DOC: 9235477] ℹ️  Episode endOfEpisode normalized: 05/12/2025
[06:55:20] [DOC: 9235477] ✅ Patient date processing completed successfully
[06:55:20] ✅    ✅ Date processing completed
[06:55:20] 📊 Processed Patient Data
     └─ patientFName: Anabela
     └─ patientLName: Ferrinha
     └─ dob: 05/24/1959
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA241111055903
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 1881923936
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 956 Rockdale Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ phoneNumber: (508) 728-5414
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/14/2024', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'E78.00', 'thirdDiagnosis': 'M15.9', 'fourthDiagnosis': 'K91.2', 'fifthDiagnosis': 'G25.81', 'sixthDiagnosis': 'D50.9'}]
[06:55:20] 🔄 
🔄 Step 4: Extracting order data...
[06:55:41] ℹ️  Order extraction - MRN: 'MA241111055903'
[06:55:41] ℹ️  Order extraction - Sex: 'FEMALE'
[06:55:41] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:55:41] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:55:41] ✅ Order data extraction completed successfully
[06:55:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:55:41] ℹ️  Using MRN from patient data: 'MA241111055903' over 'MA241111055903'
[06:55:41] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:55:41] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:55:41] ✅ Patient name cross-validation successful
[06:55:41] ✅    ✅ Data merged successfully
[06:55:42] ✅    ✅ Order data extracted and validated
[06:55:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:56:15] [DOC: 9235477] ℹ️  Patient not found in cache or API: Anabela Ferrinha
[06:56:15] [DOC: 9235477] ℹ️  Patient not found, creating new patient via API...
[06:56:15] [DOC: 9235477] ℹ️  Creating patient via API: Anabela Ferrinha
[06:56:17] [DOC: 9235477] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[06:56:17] ❌    ❌ Failed to create patient
[06:56:17] [DOC: 9235477] ℹ️  API push details saved for document 9235477
================================================================================
║                        Processing Document ID: 9235416                         ║
================================================================================
[06:56:17] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:56:17] ℹ️  Date: 04/11/2025
[06:56:17] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:56:20] [DOC: 9235416] ✅ Text extracted using pdfplumber (1560 chars)
[06:56:20] ✅    ✅ Text extracted using pdfplumber (1560 chars)
[06:56:20] 🔄 
🔄 Step 2: Extracting patient data...
[06:56:23] ℹ️  AI extracted raw sex value: ''
[06:56:23] ℹ️  AI extracted service line: 'Physical Therapy'
[06:56:23] ℹ️  AI extracted payer source: ''
[06:56:23] ℹ️  AI extracted diagnoses:
[06:56:23] ℹ️    - Diagnosis 1: 'K25.9'
[06:56:23] ℹ️    - Diagnosis 2: 'D50.0'
[06:56:23] ℹ️    - Diagnosis 3: 'K50.90'
[06:56:23] ℹ️    - Diagnosis 4: 'None'
[06:56:23] ℹ️    - Diagnosis 5: 'None'
[06:56:23] ℹ️    - Diagnosis 6: 'None'
[06:56:23] ℹ️  Final extracted MRN: 'MA250328114901'
[06:56:23] ℹ️  Final extracted Sex: ''
[06:56:23] ℹ️  Final extracted Service Line: 'Physical Therapy'
[06:56:23] ℹ️  Final extracted Payer Source: ''
[06:56:23] ✅ Patient data extraction completed successfully
[06:56:23] ✅    ✅ Patient data extracted successfully
[06:56:23] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:56:23] ✅    ✅ Patient identified: Shirley Tavares
[06:56:23] ✅    ✅ Patient name validation passed
[06:56:23] 🔄 
🔄 Step 3: Processing patient dates...
[06:56:23] [DOC: 9235416] ℹ️  DOB normalized: 11/10/1949
[06:56:23] [DOC: 9235416] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[06:56:23] [DOC: 9235416] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[06:56:23] [DOC: 9235416] ✅ Patient date processing completed successfully
[06:56:23] ✅    ✅ Date processing completed
[06:56:23] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90'}]
[06:56:23] 🔄 
🔄 Step 4: Extracting order data...
[06:56:26] ℹ️  Order extraction - MRN: 'MA250328114901'
[06:56:26] ℹ️  Order extraction - Sex: ''
[06:56:26] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[06:56:26] ℹ️  Order extraction - Payer Source: ''
[06:56:26] ✅ Order data extraction completed successfully
[06:56:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:56:26] ℹ️  Using MRN from patient data: 'MA250328114901' over 'MA250328114901'
[06:56:26] ⚠️  Could not determine sex using any available method
[06:56:26] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[06:56:26] ✅ Patient name cross-validation successful
[06:56:26] ✅    ✅ Data merged successfully
[06:56:28] ✅    ✅ Order data extracted and validated
[06:56:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:56:28] [DOC: 9235416] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:56:28] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:56:28] 🔄 
🔄 Step 6: Pushing order to API...
[06:56:28] [DOC: 9235416] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:56:29] [DOC: 9235416] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14233"}
[06:56:29] ❌    ❌ Failed to push order
[06:56:29] 🔄 
🔄 Step 7: Writing to CSV...
[06:56:29] [DOC: 9235416] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[06:56:29] [DOC: 9235416] ℹ️  Service Line extracted: 'Physical Therapy'
[06:56:29] [DOC: 9235416] ℹ️  Payer Source extracted: ''
[06:56:29] [DOC: 9235416] ℹ️  Diagnosis codes being written:
[06:56:29] [DOC: 9235416] ℹ️    - Latest_Episode_Firstdiagnosis: 'K25.9'
[06:56:29] [DOC: 9235416] ℹ️    - Latest_Episode_Seconddiagnosis: 'D50.0'
[06:56:29] [DOC: 9235416] ℹ️    - Latest_Episode_Thirddiagnosis: 'K50.90'
[06:56:29] [DOC: 9235416] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:56:29] [DOC: 9235416] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:56:29] [DOC: 9235416] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:56:29] [DOC: 9235416] ✅ Patient data written to CSV: Shirley Tavares | Sex:  | Age: 75 | Service: Physical Therapy | Payer:  | MRN: MA250328114901
[06:56:29] ✅    ✅ Document 9235416 processed and saved successfully
[06:56:29] 🔄 
🔄 Step 8: Saving API details...
[06:56:29] [DOC: 9235416] ℹ️  API push details saved for document 9235416
[06:56:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235413                         ║
================================================================================
[06:56:29] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:56:29] ℹ️  Date: 04/11/2025
[06:56:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:56:31] [DOC: 9235413] ✅ Text extracted using pdfplumber (1425 chars)
[06:56:31] ✅    ✅ Text extracted using pdfplumber (1425 chars)
[06:56:31] 🔄 
🔄 Step 2: Extracting patient data...
[06:56:34] ℹ️  AI extracted raw sex value: ''
[06:56:34] ℹ️  AI extracted service line: 'Physical Therapy'
[06:56:34] ℹ️  AI extracted payer source: ''
[06:56:34] ℹ️  AI extracted diagnoses:
[06:56:34] ℹ️    - Diagnosis 1: 'K25.9'
[06:56:34] ℹ️    - Diagnosis 2: 'D50.0'
[06:56:34] ℹ️    - Diagnosis 3: 'K50.90'
[06:56:34] ℹ️    - Diagnosis 4: ''
[06:56:34] ℹ️    - Diagnosis 5: ''
[06:56:34] ℹ️    - Diagnosis 6: ''
[06:56:34] ℹ️  Final extracted MRN: 'MA250328114901'
[06:56:34] ℹ️  Final extracted Sex: ''
[06:56:34] ℹ️  Final extracted Service Line: 'Physical Therapy'
[06:56:34] ℹ️  Final extracted Payer Source: ''
[06:56:34] ✅ Patient data extraction completed successfully
[06:56:34] ✅    ✅ Patient data extracted successfully
[06:56:34] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:56:34] ✅    ✅ Patient identified: Shirley Tavares
[06:56:34] ✅    ✅ Patient name validation passed
[06:56:34] 🔄 
🔄 Step 3: Processing patient dates...
[06:56:34] [DOC: 9235413] ℹ️  DOB normalized: 11/10/1949
[06:56:34] [DOC: 9235413] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[06:56:34] [DOC: 9235413] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[06:56:34] [DOC: 9235413] ✅ Patient date processing completed successfully
[06:56:34] ✅    ✅ Date processing completed
[06:56:34] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'K25.9', 'secondDiagnosis': 'D50.0', 'thirdDiagnosis': 'K50.90', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:56:34] 🔄 
🔄 Step 4: Extracting order data...
[06:56:36] ℹ️  Order extraction - MRN: 'MA250328114901'
[06:56:36] ℹ️  Order extraction - Sex: ''
[06:56:36] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[06:56:36] ℹ️  Order extraction - Payer Source: ''
[06:56:36] ✅ Order data extraction completed successfully
[06:56:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:56:36] ℹ️  Using MRN from patient data: 'MA250328114901' over 'MA250328114901'
[06:56:36] ⚠️  Could not determine sex using any available method
[06:56:36] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[06:56:36] ✅ Patient name cross-validation successful
[06:56:36] ✅    ✅ Data merged successfully
[06:56:37] ✅    ✅ Order data extracted and validated
[06:56:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:56:37] [DOC: 9235413] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:56:37] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:56:37] 🔄 
🔄 Step 6: Pushing order to API...
[06:56:37] [DOC: 9235413] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:56:39] [DOC: 9235413] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14234"}
[06:56:39] ❌    ❌ Failed to push order
[06:56:39] 🔄 
🔄 Step 7: Writing to CSV...
[06:56:39] [DOC: 9235413] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[06:56:39] [DOC: 9235413] ℹ️  Service Line extracted: 'Physical Therapy'
[06:56:39] [DOC: 9235413] ℹ️  Payer Source extracted: ''
[06:56:39] [DOC: 9235413] ℹ️  Diagnosis codes being written:
[06:56:39] [DOC: 9235413] ℹ️    - Latest_Episode_Firstdiagnosis: 'K25.9'
[06:56:39] [DOC: 9235413] ℹ️    - Latest_Episode_Seconddiagnosis: 'D50.0'
[06:56:39] [DOC: 9235413] ℹ️    - Latest_Episode_Thirddiagnosis: 'K50.90'
[06:56:39] [DOC: 9235413] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:56:39] [DOC: 9235413] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:56:39] [DOC: 9235413] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:56:39] [DOC: 9235413] ✅ Patient data written to CSV: Shirley Tavares | Sex:  | Age: 75 | Service: Physical Therapy | Payer:  | MRN: MA250328114901
[06:56:39] ✅    ✅ Document 9235413 processed and saved successfully
[06:56:39] 🔄 
🔄 Step 8: Saving API details...
[06:56:39] [DOC: 9235413] ℹ️  API push details saved for document 9235413
[06:56:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235411                         ║
================================================================================
[06:56:39] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:56:39] ℹ️  Date: 04/11/2025
[06:56:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:56:41] [DOC: 9235411] ✅ Text extracted using pdfplumber (1554 chars)
[06:56:41] ✅    ✅ Text extracted using pdfplumber (1554 chars)
[06:56:41] 🔄 
🔄 Step 2: Extracting patient data...
[06:56:44] ℹ️  AI extracted raw sex value: ''
[06:56:44] ℹ️  AI extracted service line: 'Physical Therapy'
[06:56:44] ℹ️  AI extracted payer source: ''
[06:56:44] ℹ️  AI extracted diagnoses:
[06:56:44] ℹ️    - Diagnosis 1: 'I13.2'
[06:56:44] ℹ️    - Diagnosis 2: 'I50.32'
[06:56:44] ℹ️    - Diagnosis 3: 'E11.22'
[06:56:44] ℹ️    - Diagnosis 4: 'None'
[06:56:44] ℹ️    - Diagnosis 5: 'None'
[06:56:44] ℹ️    - Diagnosis 6: 'None'
[06:56:44] ℹ️  Final extracted MRN: 'MA250328114901'
[06:56:44] ℹ️  Final extracted Sex: ''
[06:56:44] ℹ️  Final extracted Service Line: 'Physical Therapy'
[06:56:44] ℹ️  Final extracted Payer Source: ''
[06:56:44] ✅ Patient data extraction completed successfully
[06:56:44] ✅    ✅ Patient data extracted successfully
[06:56:44] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'I13.2', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:56:44] ✅    ✅ Patient identified: Shirley Tavares
[06:56:44] ✅    ✅ Patient name validation passed
[06:56:44] 🔄 
🔄 Step 3: Processing patient dates...
[06:56:44] [DOC: 9235411] ℹ️  DOB normalized: 11/10/1949
[06:56:44] [DOC: 9235411] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[06:56:44] [DOC: 9235411] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[06:56:44] [DOC: 9235411] ✅ Patient date processing completed successfully
[06:56:44] ✅    ✅ Date processing completed
[06:56:44] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'I13.2', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'E11.22'}]
[06:56:44] 🔄 
🔄 Step 4: Extracting order data...
[06:56:46] ℹ️  Order extraction - MRN: 'MA250328114901'
[06:56:46] ℹ️  Order extraction - Sex: ''
[06:56:46] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[06:56:46] ℹ️  Order extraction - Payer Source: ''
[06:56:46] ✅ Order data extraction completed successfully
[06:56:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:56:46] ℹ️  Using MRN from patient data: 'MA250328114901' over 'MA250328114901'
[06:56:46] ⚠️  Could not determine sex using any available method
[06:56:46] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[06:56:46] ✅ Patient name cross-validation successful
[06:56:46] ✅    ✅ Data merged successfully
[06:56:48] ✅    ✅ Order data extracted and validated
[06:56:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:56:48] [DOC: 9235411] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:56:48] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:56:48] 🔄 
🔄 Step 6: Pushing order to API...
[06:56:48] [DOC: 9235411] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:56:49] [DOC: 9235411] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14235"}
[06:56:49] ❌    ❌ Failed to push order
[06:56:49] 🔄 
🔄 Step 7: Writing to CSV...
[06:56:49] [DOC: 9235411] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[06:56:49] [DOC: 9235411] ℹ️  Service Line extracted: 'Physical Therapy'
[06:56:49] [DOC: 9235411] ℹ️  Payer Source extracted: ''
[06:56:49] [DOC: 9235411] ℹ️  Diagnosis codes being written:
[06:56:49] [DOC: 9235411] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.2'
[06:56:49] [DOC: 9235411] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[06:56:49] [DOC: 9235411] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[06:56:49] [DOC: 9235411] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:56:49] [DOC: 9235411] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:56:49] [DOC: 9235411] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:56:49] [DOC: 9235411] ✅ Patient data written to CSV: Shirley Tavares | Sex:  | Age: 75 | Service: Physical Therapy | Payer:  | MRN: MA250328114901
[06:56:49] ✅    ✅ Document 9235411 processed and saved successfully
[06:56:49] 🔄 
🔄 Step 8: Saving API details...
[06:56:49] [DOC: 9235411] ℹ️  API push details saved for document 9235411
[06:56:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235409                         ║
================================================================================
[06:56:49] ℹ️  Agency: Alphacare Home Health Agency
[06:56:49] ℹ️  Date: 04/11/2025
[06:56:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:56:52] [DOC: 9235409] ✅ Text extracted using pdfplumber (2357 chars)
[06:56:52] ✅    ✅ Text extracted using pdfplumber (2357 chars)
[06:56:52] 🔄 
🔄 Step 2: Extracting patient data...
[06:56:54] ℹ️  AI extracted raw sex value: ''
[06:56:54] ℹ️  AI extracted service line: 'SN, HHA'
[06:56:54] ℹ️  AI extracted payer source: ''
[06:56:54] ℹ️  AI extracted diagnoses:
[06:56:54] ℹ️    - Diagnosis 1: ''
[06:56:54] ℹ️    - Diagnosis 2: ''
[06:56:54] ℹ️    - Diagnosis 3: ''
[06:56:54] ℹ️    - Diagnosis 4: ''
[06:56:54] ℹ️    - Diagnosis 5: ''
[06:56:54] ℹ️    - Diagnosis 6: ''
[06:56:54] ℹ️  Final extracted MRN: '000000085'
[06:56:54] ℹ️  Final extracted Sex: ''
[06:56:54] ℹ️  Final extracted Service Line: 'SN, HHA'
[06:56:54] ℹ️  Final extracted Payer Source: ''
[06:56:54] ✅ Patient data extraction completed successfully
[06:56:54] ✅    ✅ Patient data extracted successfully
[06:56:54] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Lowman
     └─ dob: 04/05/1968
     └─ patientSex: 
     └─ medicalRecordNo: 000000085
     └─ billingProvider: Dhungana Parajuli, Sirjana (MD (Dr. Alliance))
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: SN, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:56:54] ✅    ✅ Patient identified: James Lowman
[06:56:54] ✅    ✅ Patient name validation passed
[06:56:54] 🔄 
🔄 Step 3: Processing patient dates...
[06:56:54] [DOC: 9235409] ℹ️  DOB normalized: 04/05/1968
[06:56:54] [DOC: 9235409] ✅ Patient date processing completed successfully
[06:56:54] ✅    ✅ Date processing completed
[06:56:54] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Lowman
     └─ dob: 04/05/1968
     └─ patientSex: 
     └─ medicalRecordNo: 000000085
     └─ billingProvider: Dhungana Parajuli, Sirjana (MD (Dr. Alliance))
     └─ npi: 1063606473
     └─ physicianNPI: 1063606473
     └─ nameOfAgency: AlphaCare Home Health Agency, Inc.
     └─ address: 1707 GAR Highway
     └─ city: Swansea
     └─ state: MA
     └─ zip: 02777
     └─ email: 
     └─ phoneNumber: 617-600-4547
     └─ serviceLine: SN, HHA
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:56:54] 🔄 
🔄 Step 4: Extracting order data...
[06:56:57] ℹ️  Order extraction - MRN: '000000085'
[06:56:57] ℹ️  Order extraction - Sex: ''
[06:56:57] ℹ️  Order extraction - Service Line: 'SN'
[06:56:57] ℹ️  Order extraction - Payer Source: ''
[06:56:57] ✅ Order data extraction completed successfully
[06:56:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:56:57] ℹ️  Using MRN from patient data: '000000085' over '000000085'
[06:56:57] ℹ️  Inferred sex as MALE from name: James
[06:56:57] ℹ️  Combined service lines: Patient='SN, HHA' + Order='SN' = 'HHA, SN'
[06:56:57] ✅ Patient name cross-validation successful
[06:56:57] ✅    ✅ Data merged successfully
[06:56:58] ⚠️     ❌ Skipping - missing episode start date
[06:56:58] [DOC: 9235409] ℹ️  API push details saved for document 9235409
================================================================================
║                        Processing Document ID: 9235405                         ║
================================================================================
[06:56:58] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:56:58] ℹ️  Date: 04/11/2025
[06:56:58] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:57:00] [DOC: 9235405] ✅ Text extracted using pdfplumber (1497 chars)
[06:57:00] ✅    ✅ Text extracted using pdfplumber (1497 chars)
[06:57:00] 🔄 
🔄 Step 2: Extracting patient data...
[06:57:03] ℹ️  AI extracted raw sex value: ''
[06:57:03] ℹ️  AI extracted service line: 'Occupational Therapy'
[06:57:03] ℹ️  AI extracted payer source: ''
[06:57:03] ℹ️  AI extracted diagnoses:
[06:57:03] ℹ️    - Diagnosis 1: 'I13.2'
[06:57:03] ℹ️    - Diagnosis 2: 'I50.32'
[06:57:03] ℹ️    - Diagnosis 3: 'E11.22'
[06:57:03] ℹ️    - Diagnosis 4: ''
[06:57:03] ℹ️    - Diagnosis 5: ''
[06:57:03] ℹ️    - Diagnosis 6: ''
[06:57:03] ℹ️  Final extracted MRN: 'MA250328114901'
[06:57:03] ℹ️  Final extracted Sex: ''
[06:57:03] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[06:57:03] ℹ️  Final extracted Payer Source: ''
[06:57:03] ✅ Patient data extraction completed successfully
[06:57:03] ✅    ✅ Patient data extracted successfully
[06:57:03] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'I13.2', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:57:03] ✅    ✅ Patient identified: Shirley Tavares
[06:57:03] ✅    ✅ Patient name validation passed
[06:57:03] 🔄 
🔄 Step 3: Processing patient dates...
[06:57:03] [DOC: 9235405] ℹ️  DOB normalized: 11/10/1949
[06:57:03] [DOC: 9235405] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[06:57:03] [DOC: 9235405] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[06:57:03] [DOC: 9235405] ✅ Patient date processing completed successfully
[06:57:03] ✅    ✅ Date processing completed
[06:57:03] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'I13.2', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:57:03] 🔄 
🔄 Step 4: Extracting order data...
[06:57:06] ℹ️  Order extraction - MRN: 'MA250328114901'
[06:57:06] ℹ️  Order extraction - Sex: ''
[06:57:06] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[06:57:06] ℹ️  Order extraction - Payer Source: ''
[06:57:06] ✅ Order data extraction completed successfully
[06:57:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:57:06] ℹ️  Using MRN from patient data: 'MA250328114901' over 'MA250328114901'
[06:57:06] ⚠️  Could not determine sex using any available method
[06:57:06] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[06:57:06] ✅ Patient name cross-validation successful
[06:57:06] ✅    ✅ Data merged successfully
[06:57:07] ✅    ✅ Order data extracted and validated
[06:57:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:57:07] [DOC: 9235405] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:57:07] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:57:07] 🔄 
🔄 Step 6: Pushing order to API...
[06:57:07] [DOC: 9235405] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:57:08] [DOC: 9235405] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14236"}
[06:57:08] ❌    ❌ Failed to push order
[06:57:08] 🔄 
🔄 Step 7: Writing to CSV...
[06:57:08] [DOC: 9235405] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[06:57:08] [DOC: 9235405] ℹ️  Service Line extracted: 'Occupational Therapy'
[06:57:08] [DOC: 9235405] ℹ️  Payer Source extracted: ''
[06:57:08] [DOC: 9235405] ℹ️  Diagnosis codes being written:
[06:57:08] [DOC: 9235405] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.2'
[06:57:08] [DOC: 9235405] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[06:57:08] [DOC: 9235405] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[06:57:08] [DOC: 9235405] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:57:08] [DOC: 9235405] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:57:08] [DOC: 9235405] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:57:08] [DOC: 9235405] ✅ Patient data written to CSV: Shirley Tavares | Sex:  | Age: 75 | Service: Occupational Therapy | Payer:  | MRN: MA250328114901
[06:57:08] ✅    ✅ Document 9235405 processed and saved successfully
[06:57:08] 🔄 
🔄 Step 8: Saving API details...
[06:57:08] [DOC: 9235405] ℹ️  API push details saved for document 9235405
[06:57:08] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235401                         ║
================================================================================
[06:57:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:57:08] ℹ️  Date: 04/11/2025
[06:57:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:57:12] [DOC: 9235401] ✅ Text extracted using pdfplumber (1374 chars)
[06:57:12] ✅    ✅ Text extracted using pdfplumber (1374 chars)
[06:57:12] 🔄 
🔄 Step 2: Extracting patient data...
[06:57:15] ℹ️  AI extracted raw sex value: ''
[06:57:15] ℹ️  AI extracted service line: 'RN'
[06:57:15] ℹ️  AI extracted payer source: ''
[06:57:15] ℹ️  AI extracted diagnoses:
[06:57:15] ℹ️    - Diagnosis 1: 'I13.2'
[06:57:15] ℹ️    - Diagnosis 2: 'I50.32'
[06:57:15] ℹ️    - Diagnosis 3: 'E11.22'
[06:57:15] ℹ️    - Diagnosis 4: ''
[06:57:15] ℹ️    - Diagnosis 5: ''
[06:57:15] ℹ️    - Diagnosis 6: ''
[06:57:15] ℹ️  Final extracted MRN: 'MA250328114901'
[06:57:15] ℹ️  Final extracted Sex: ''
[06:57:15] ℹ️  Final extracted Service Line: 'RN'
[06:57:15] ℹ️  Final extracted Payer Source: ''
[06:57:15] ✅ Patient data extraction completed successfully
[06:57:15] ✅    ✅ Patient data extracted successfully
[06:57:15] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'I13.2', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:57:15] ✅    ✅ Patient identified: Shirley Tavares
[06:57:15] ✅    ✅ Patient name validation passed
[06:57:15] 🔄 
🔄 Step 3: Processing patient dates...
[06:57:15] [DOC: 9235401] ℹ️  DOB normalized: 11/10/1949
[06:57:15] [DOC: 9235401] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[06:57:15] [DOC: 9235401] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[06:57:15] [DOC: 9235401] ✅ Patient date processing completed successfully
[06:57:15] ✅    ✅ Date processing completed
[06:57:15] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'I13.2', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:57:15] 🔄 
🔄 Step 4: Extracting order data...
[06:57:17] ℹ️  Order extraction - MRN: 'MA250328114901'
[06:57:17] ℹ️  Order extraction - Sex: ''
[06:57:17] ℹ️  Order extraction - Service Line: 'RN'
[06:57:17] ℹ️  Order extraction - Payer Source: ''
[06:57:17] ✅ Order data extraction completed successfully
[06:57:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:57:17] ℹ️  Using MRN from patient data: 'MA250328114901' over 'MA250328114901'
[06:57:17] ⚠️  Could not determine sex using any available method
[06:57:17] ℹ️  Service line consistent in both sources: 'RN'
[06:57:17] ✅ Patient name cross-validation successful
[06:57:17] ✅    ✅ Data merged successfully
[06:57:19] ✅    ✅ Order data extracted and validated
[06:57:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:57:19] [DOC: 9235401] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:57:19] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:57:19] 🔄 
🔄 Step 6: Pushing order to API...
[06:57:19] [DOC: 9235401] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:57:20] [DOC: 9235401] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14237"}
[06:57:20] ❌    ❌ Failed to push order
[06:57:20] 🔄 
🔄 Step 7: Writing to CSV...
[06:57:20] [DOC: 9235401] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[06:57:20] [DOC: 9235401] ℹ️  Service Line extracted: 'RN'
[06:57:20] [DOC: 9235401] ℹ️  Payer Source extracted: ''
[06:57:20] [DOC: 9235401] ℹ️  Diagnosis codes being written:
[06:57:20] [DOC: 9235401] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.2'
[06:57:20] [DOC: 9235401] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[06:57:20] [DOC: 9235401] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[06:57:20] [DOC: 9235401] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:57:20] [DOC: 9235401] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:57:20] [DOC: 9235401] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:57:20] [DOC: 9235401] ✅ Patient data written to CSV: Shirley Tavares | Sex:  | Age: 75 | Service: RN | Payer:  | MRN: MA250328114901
[06:57:20] ✅    ✅ Document 9235401 processed and saved successfully
[06:57:20] 🔄 
🔄 Step 8: Saving API details...
[06:57:20] [DOC: 9235401] ℹ️  API push details saved for document 9235401
[06:57:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235397                         ║
================================================================================
[06:57:20] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:57:20] ℹ️  Date: 04/11/2025
[06:57:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:57:23] [DOC: 9235397] ✅ Text extracted using pdfplumber (1632 chars)
[06:57:23] ✅    ✅ Text extracted using pdfplumber (1632 chars)
[06:57:23] 🔄 
🔄 Step 2: Extracting patient data...
[06:57:26] ℹ️  AI extracted raw sex value: ''
[06:57:26] ℹ️  AI extracted service line: 'Occupational Therapy'
[06:57:26] ℹ️  AI extracted payer source: ''
[06:57:26] ℹ️  AI extracted diagnoses:
[06:57:26] ℹ️    - Diagnosis 1: 'I13.2'
[06:57:26] ℹ️    - Diagnosis 2: 'I50.32'
[06:57:26] ℹ️    - Diagnosis 3: 'E11.22'
[06:57:26] ℹ️    - Diagnosis 4: 'None'
[06:57:26] ℹ️    - Diagnosis 5: 'None'
[06:57:26] ℹ️    - Diagnosis 6: 'None'
[06:57:26] ℹ️  Final extracted MRN: 'MA250328114901'
[06:57:26] ℹ️  Final extracted Sex: ''
[06:57:26] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[06:57:26] ℹ️  Final extracted Payer Source: ''
[06:57:26] ✅ Patient data extraction completed successfully
[06:57:26] ✅    ✅ Patient data extracted successfully
[06:57:26] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'I13.2', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:57:26] ✅    ✅ Patient identified: Shirley Tavares
[06:57:26] ✅    ✅ Patient name validation passed
[06:57:26] 🔄 
🔄 Step 3: Processing patient dates...
[06:57:26] [DOC: 9235397] ℹ️  DOB normalized: 11/10/1949
[06:57:26] [DOC: 9235397] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[06:57:26] [DOC: 9235397] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[06:57:26] [DOC: 9235397] ✅ Patient date processing completed successfully
[06:57:26] ✅    ✅ Date processing completed
[06:57:26] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: 
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: KARMINA BAUTISTA MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'I13.2', 'secondDiagnosis': 'I50.32', 'thirdDiagnosis': 'E11.22'}]
[06:57:26] 🔄 
🔄 Step 4: Extracting order data...
[06:57:29] ℹ️  Order extraction - MRN: 'MA250328114901'
[06:57:29] ℹ️  Order extraction - Sex: ''
[06:57:29] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[06:57:29] ℹ️  Order extraction - Payer Source: ''
[06:57:29] ✅ Order data extraction completed successfully
[06:57:29] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:57:29] ℹ️  Using MRN from patient data: 'MA250328114901' over 'MA250328114901'
[06:57:29] ⚠️  Could not determine sex using any available method
[06:57:29] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[06:57:29] ✅ Patient name cross-validation successful
[06:57:29] ✅    ✅ Data merged successfully
[06:57:30] ✅    ✅ Order data extracted and validated
[06:57:30] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:57:30] [DOC: 9235397] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:57:30] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:57:30] 🔄 
🔄 Step 6: Pushing order to API...
[06:57:30] [DOC: 9235397] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:57:31] [DOC: 9235397] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14238"}
[06:57:31] ❌    ❌ Failed to push order
[06:57:31] 🔄 
🔄 Step 7: Writing to CSV...
[06:57:31] [DOC: 9235397] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[06:57:31] [DOC: 9235397] ℹ️  Service Line extracted: 'Occupational Therapy'
[06:57:31] [DOC: 9235397] ℹ️  Payer Source extracted: ''
[06:57:31] [DOC: 9235397] ℹ️  Diagnosis codes being written:
[06:57:31] [DOC: 9235397] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.2'
[06:57:31] [DOC: 9235397] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.32'
[06:57:31] [DOC: 9235397] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[06:57:31] [DOC: 9235397] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:57:31] [DOC: 9235397] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:57:31] [DOC: 9235397] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:57:31] [DOC: 9235397] ✅ Patient data written to CSV: Shirley Tavares | Sex:  | Age: 75 | Service: Occupational Therapy | Payer:  | MRN: MA250328114901
[06:57:31] ✅    ✅ Document 9235397 processed and saved successfully
[06:57:31] 🔄 
🔄 Step 8: Saving API details...
[06:57:31] [DOC: 9235397] ℹ️  API push details saved for document 9235397
[06:57:31] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235393                         ║
================================================================================
[06:57:31] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[06:57:31] ℹ️  Date: 04/11/2025
[06:57:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:57:38] [DOC: 9235393] ✅ Text extracted using pdfplumber (13526 chars)
[06:57:38] ✅    ✅ Text extracted using pdfplumber (13526 chars)
[06:57:38] 🔄 
🔄 Step 2: Extracting patient data...
[06:57:41] ℹ️  AI extracted raw sex value: 'F'
[06:57:41] ℹ️  AI extracted service line: 'OT'
[06:57:41] ℹ️  AI extracted payer source: 'None'
[06:57:41] ℹ️  AI extracted diagnoses:
[06:57:41] ℹ️    - Diagnosis 1: 'End stage Renal Failure Exacerbation'
[06:57:41] ℹ️    - Diagnosis 2: 'muscle weakness Exacerbation'
[06:57:41] ℹ️    - Diagnosis 3: 'None'
[06:57:41] ℹ️    - Diagnosis 4: 'None'
[06:57:41] ℹ️    - Diagnosis 5: 'None'
[06:57:41] ℹ️    - Diagnosis 6: 'None'
[06:57:41] ℹ️  Final extracted MRN: 'MA250328114901'
[06:57:41] ℹ️  Final extracted Sex: 'FEMALE'
[06:57:41] ℹ️  Final extracted Service Line: 'OT'
[06:57:41] ℹ️  Final extracted Payer Source: ''
[06:57:41] ✅ Patient data extraction completed successfully
[06:57:41] ✅    ✅ Patient data extracted successfully
[06:57:41] 📊 Patient Response
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/01/2025', 'endOfEpisode': None, 'firstDiagnosis': 'End stage Renal Failure Exacerbation', 'secondDiagnosis': 'muscle weakness Exacerbation', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[06:57:41] ✅    ✅ Patient identified: Shirley Tavares
[06:57:41] ✅    ✅ Patient name validation passed
[06:57:41] 🔄 
🔄 Step 3: Processing patient dates...
[06:57:41] [DOC: 9235393] ℹ️  DOB normalized: 11/10/1949
[06:57:41] [DOC: 9235393] ℹ️  Episode startOfEpisode normalized: 04/01/2025
[06:57:41] [DOC: 9235393] ✅ Patient date processing completed successfully
[06:57:41] ✅    ✅ Date processing completed
[06:57:41] 📊 Processed Patient Data
     └─ patientFName: Shirley
     └─ patientLName: Tavares
     └─ dob: 11/10/1949
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA250328114901
     └─ billingProvider: Dr. Bautista, Karmina
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/01/2025', 'firstDiagnosis': 'End stage Renal Failure Exacerbation', 'secondDiagnosis': 'muscle weakness Exacerbation'}]
[06:57:41] 🔄 
🔄 Step 4: Extracting order data...
[06:57:44] ℹ️  Order extraction - MRN: 'MA250328114901'
[06:57:44] ℹ️  Order extraction - Sex: 'FEMALE'
[06:57:44] ℹ️  Order extraction - Service Line: 'OT'
[06:57:44] ℹ️  Order extraction - Payer Source: ''
[06:57:44] ✅ Order data extraction completed successfully
[06:57:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:57:44] ℹ️  Using MRN from patient data: 'MA250328114901' over 'MA250328114901'
[06:57:44] ℹ️  Service line consistent in both sources: 'OT'
[06:57:44] ✅ Patient name cross-validation successful
[06:57:44] ✅    ✅ Data merged successfully
[06:57:45] ✅    ✅ Order data extracted and validated
[06:57:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:57:45] [DOC: 9235393] ✅ Patient found in local cache: Shirley Tavares, ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:57:45] ✅    ✅ Existing patient found with ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:57:45] 🔄 
🔄 Step 6: Pushing order to API...
[06:57:45] [DOC: 9235393] ℹ️  Pushing order via API for patient ID: ec91b63e-ba51-449b-872f-64cf58a01d41
[06:57:46] [DOC: 9235393] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:57:46] ❌    ❌ Failed to push order
[06:57:46] 🔄 
🔄 Step 7: Writing to CSV...
[06:57:46] [DOC: 9235393] ℹ️  Calculated age: 75 from DOB: 11/10/1949
[06:57:46] [DOC: 9235393] ℹ️  Service Line extracted: 'OT'
[06:57:46] [DOC: 9235393] ℹ️  Payer Source extracted: ''
[06:57:46] [DOC: 9235393] ℹ️  Diagnosis codes being written:
[06:57:46] [DOC: 9235393] ℹ️    - Latest_Episode_Firstdiagnosis: 'End stage Renal Failure Exacerbation'
[06:57:46] [DOC: 9235393] ℹ️    - Latest_Episode_Seconddiagnosis: 'muscle weakness Exacerbation'
[06:57:46] [DOC: 9235393] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:57:46] [DOC: 9235393] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:57:46] [DOC: 9235393] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:57:46] [DOC: 9235393] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:57:46] [DOC: 9235393] ✅ Patient data written to CSV: Shirley Tavares | Sex: FEMALE | Age: 75 | Service: OT | Payer:  | MRN: MA250328114901
[06:57:46] ✅    ✅ Document 9235393 processed and saved successfully
[06:57:46] 🔄 
🔄 Step 8: Saving API details...
[06:57:46] [DOC: 9235393] ℹ️  API push details saved for document 9235393
[06:57:46] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235269                         ║
================================================================================
[06:57:46] ℹ️  Agency: Dartmouth HH
[06:57:46] ℹ️  Date: 04/11/2025
[06:57:46] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:57:48] [DOC: 9235269] ✅ Text extracted using pdfplumber (5739 chars)
[06:57:48] ✅    ✅ Text extracted using pdfplumber (5739 chars)
[06:57:48] 🔄 
🔄 Step 2: Extracting patient data...
[06:57:51] ℹ️  AI extracted raw sex value: 'F'
[06:57:51] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[06:57:51] ℹ️  AI extracted payer source: 'Medicare'
[06:57:51] ℹ️  AI extracted diagnoses:
[06:57:51] ℹ️    - Diagnosis 1: ''
[06:57:51] ℹ️    - Diagnosis 2: ''
[06:57:51] ℹ️    - Diagnosis 3: ''
[06:57:51] ℹ️    - Diagnosis 4: ''
[06:57:51] ℹ️    - Diagnosis 5: ''
[06:57:51] ℹ️    - Diagnosis 6: ''
[06:57:51] ℹ️  Final extracted MRN: '5862015'
[06:57:51] ℹ️  Final extracted Sex: 'FEMALE'
[06:57:51] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[06:57:51] ℹ️  Final extracted Payer Source: 'Medicare'
[06:57:51] ✅ Patient data extraction completed successfully
[06:57:51] ✅    ✅ Patient data extracted successfully
[06:57:51] 📊 Patient Response
     └─ patientFName: Janice
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '02/08/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:57:51] ✅    ✅ Patient identified: Janice Arruda
[06:57:51] ✅    ✅ Patient name validation passed
[06:57:51] 🔄 
🔄 Step 3: Processing patient dates...
[06:57:51] [DOC: 9235269] ℹ️  DOB normalized: 01/24/1950
[06:57:51] [DOC: 9235269] ℹ️  Episode startOfCare normalized: 02/08/2025
[06:57:51] [DOC: 9235269] ℹ️  Episode startOfEpisode normalized: 02/08/2025
[06:57:51] [DOC: 9235269] ℹ️  Episode endOfEpisode normalized: 04/08/2025
[06:57:51] [DOC: 9235269] ✅ Patient date processing completed successfully
[06:57:51] ✅    ✅ Date processing completed
[06:57:51] 📊 Processed Patient Data
     └─ patientFName: Janice
     └─ patientLName: Arruda
     └─ dob: 01/24/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5862015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/08/2025', 'startOfEpisode': '02/08/2025', 'endOfEpisode': '04/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:57:51] 🔄 
🔄 Step 4: Extracting order data...
[06:57:54] ℹ️  Order extraction - MRN: '5862015'
[06:57:54] ℹ️  Order extraction - Sex: 'FEMALE'
[06:57:54] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[06:57:54] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:57:54] ✅ Order data extraction completed successfully
[06:57:54] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:57:54] ℹ️  Using MRN from patient data: '5862015' over '5862015'
[06:57:54] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[06:57:54] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:57:54] ✅ Patient name cross-validation successful
[06:57:54] ✅    ✅ Data merged successfully
[06:57:55] ✅    ✅ Order data extracted and validated
[06:57:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:57:55] [DOC: 9235269] ✅ Patient found in local cache: Janice Arruda, ID: cc67108f-d504-4858-959a-d21d91141958
[06:57:55] ✅    ✅ Existing patient found with ID: cc67108f-d504-4858-959a-d21d91141958
[06:57:55] 🔄 
🔄 Step 6: Pushing order to API...
[06:57:55] [DOC: 9235269] ℹ️  Pushing order via API for patient ID: cc67108f-d504-4858-959a-d21d91141958
[06:57:56] [DOC: 9235269] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:57:56] ❌    ❌ Failed to push order
[06:57:56] 🔄 
🔄 Step 7: Writing to CSV...
[06:57:56] [DOC: 9235269] ℹ️  Calculated age: 75 from DOB: 01/24/1950
[06:57:56] [DOC: 9235269] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[06:57:56] [DOC: 9235269] ℹ️  Payer Source extracted: 'Medicare'
[06:57:56] [DOC: 9235269] ℹ️  Diagnosis codes being written:
[06:57:56] [DOC: 9235269] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:57:56] [DOC: 9235269] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:57:56] [DOC: 9235269] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:57:56] [DOC: 9235269] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:57:56] [DOC: 9235269] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:57:56] [DOC: 9235269] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:57:56] [DOC: 9235269] ✅ Patient data written to CSV: Janice Arruda | Sex: FEMALE | Age: 75 | Service: Skilled Nursing, Physical Therapy | Payer: Medicare | MRN: 5862015
[06:57:56] ✅    ✅ Document 9235269 processed and saved successfully
[06:57:56] 🔄 
🔄 Step 8: Saving API details...
[06:57:56] [DOC: 9235269] ℹ️  API push details saved for document 9235269
[06:57:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235202                         ║
================================================================================
[06:57:56] ℹ️  Agency: Fairhaven HH&H
[06:57:56] ℹ️  Date: 04/11/2025
[06:57:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:57:58] [DOC: 9235202] ✅ Text extracted using pdfplumber (1266 chars)
[06:57:58] ✅    ✅ Text extracted using pdfplumber (1266 chars)
[06:57:58] 🔄 
🔄 Step 2: Extracting patient data...
[06:58:00] ℹ️  AI extracted raw sex value: 'F'
[06:58:00] ℹ️  AI extracted service line: 'RN, LPN'
[06:58:00] ℹ️  AI extracted payer source: 'Medicare'
[06:58:00] ℹ️  AI extracted diagnoses:
[06:58:00] ℹ️    - Diagnosis 1: ''
[06:58:00] ℹ️    - Diagnosis 2: ''
[06:58:00] ℹ️    - Diagnosis 3: ''
[06:58:00] ℹ️    - Diagnosis 4: ''
[06:58:00] ℹ️    - Diagnosis 5: ''
[06:58:00] ℹ️    - Diagnosis 6: ''
[06:58:00] ℹ️  Final extracted MRN: '7180009'
[06:58:00] ℹ️  Final extracted Sex: 'FEMALE'
[06:58:00] ℹ️  Final extracted Service Line: 'RN, LPN'
[06:58:00] ℹ️  Final extracted Payer Source: 'Medicare'
[06:58:00] ✅ Patient data extraction completed successfully
[06:58:00] ✅    ✅ Patient data extracted successfully
[06:58:00] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Fernandes
     └─ dob: 10/09/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7180009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/06/2023', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:58:00] ✅    ✅ Patient identified: Judith Fernandes
[06:58:00] ✅    ✅ Patient name validation passed
[06:58:00] 🔄 
🔄 Step 3: Processing patient dates...
[06:58:00] [DOC: 9235202] ℹ️  DOB normalized: 10/09/1935
[06:58:00] [DOC: 9235202] ℹ️  Episode startOfCare normalized: 12/06/2023
[06:58:00] [DOC: 9235202] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[06:58:00] [DOC: 9235202] ℹ️  Episode endOfEpisode normalized: 05/28/2025
[06:58:00] [DOC: 9235202] ✅ Patient date processing completed successfully
[06:58:00] ✅    ✅ Date processing completed
[06:58:00] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Fernandes
     └─ dob: 10/09/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7180009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '12/06/2023', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:58:00] 🔄 
🔄 Step 4: Extracting order data...
[06:58:03] ℹ️  Order extraction - MRN: ''
[06:58:03] ℹ️  Order extraction - Sex: 'FEMALE'
[06:58:03] ℹ️  Order extraction - Service Line: 'RN, LPN'
[06:58:03] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:58:03] ✅ Order data extraction completed successfully
[06:58:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:58:03] ℹ️  Using MRN from patient data: '7180009'
[06:58:03] ℹ️  Service line consistent in both sources: 'RN, LPN'
[06:58:03] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:58:03] ✅ Patient name cross-validation successful
[06:58:03] ✅    ✅ Data merged successfully
[06:58:04] ✅    ✅ Order data extracted and validated
[06:58:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:58:24] [DOC: 9235202] ✅ Patient exists in API: Judith Fernandes, ID: 7cad3e82-9942-4b46-ab8c-5d9421bb7a27
[06:58:24] ✅    ✅ Existing patient found with ID: 7cad3e82-9942-4b46-ab8c-5d9421bb7a27
[06:58:24] 🔄 
🔄 Step 6: Pushing order to API...
[06:58:24] [DOC: 9235202] ℹ️  Pushing order via API for patient ID: 7cad3e82-9942-4b46-ab8c-5d9421bb7a27
[06:58:25] [DOC: 9235202] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:58:25] ❌    ❌ Failed to push order
[06:58:25] 🔄 
🔄 Step 7: Writing to CSV...
[06:58:25] [DOC: 9235202] ℹ️  Calculated age: 89 from DOB: 10/09/1935
[06:58:25] [DOC: 9235202] ℹ️  Service Line extracted: 'RN, LPN'
[06:58:25] [DOC: 9235202] ℹ️  Payer Source extracted: 'Medicare'
[06:58:25] [DOC: 9235202] ℹ️  Diagnosis codes being written:
[06:58:25] [DOC: 9235202] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:58:25] [DOC: 9235202] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:58:25] [DOC: 9235202] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:58:25] [DOC: 9235202] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:58:25] [DOC: 9235202] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:58:25] [DOC: 9235202] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:58:25] [DOC: 9235202] ✅ Patient data written to CSV: Judith Fernandes | Sex: FEMALE | Age: 89 | Service: RN, LPN | Payer: Medicare | MRN: 7180009
[06:58:25] ✅    ✅ Document 9235202 processed and saved successfully
[06:58:25] 🔄 
🔄 Step 8: Saving API details...
[06:58:25] [DOC: 9235202] ℹ️  API push details saved for document 9235202
[06:58:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235196                         ║
================================================================================
[06:58:25] ℹ️  Agency: Dartmouth HH
[06:58:25] ℹ️  Date: 04/11/2025
[06:58:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:58:27] [DOC: 9235196] ✅ Text extracted using pdfplumber (7735 chars)
[06:58:27] ✅    ✅ Text extracted using pdfplumber (7735 chars)
[06:58:27] 🔄 
🔄 Step 2: Extracting patient data...
[06:58:31] ℹ️  AI extracted raw sex value: 'F'
[06:58:31] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:58:31] ℹ️  AI extracted payer source: 'Medicare'
[06:58:31] ℹ️  AI extracted diagnoses:
[06:58:31] ℹ️    - Diagnosis 1: 'J18.9'
[06:58:31] ℹ️    - Diagnosis 2: 'J91.8'
[06:58:31] ℹ️    - Diagnosis 3: 'J96.01'
[06:58:31] ℹ️    - Diagnosis 4: 'I26.99'
[06:58:31] ℹ️    - Diagnosis 5: 'I13.0'
[06:58:31] ℹ️    - Diagnosis 6: 'I50.32'
[06:58:31] ℹ️  Final extracted MRN: '771002'
[06:58:31] ℹ️  Final extracted Sex: 'FEMALE'
[06:58:31] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:58:31] ℹ️  Final extracted Payer Source: 'Medicare'
[06:58:31] ✅ Patient data extraction completed successfully
[06:58:31] ✅    ✅ Patient data extracted successfully
[06:58:31] 📊 Patient Response
     └─ patientFName: Kathryn
     └─ patientLName: McCollester
     └─ dob: 09/24/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 771002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/17/2025', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'J91.8', 'thirdDiagnosis': 'J96.01', 'fourthDiagnosis': 'I26.99', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.32'}]
[06:58:31] ✅    ✅ Patient identified: Kathryn McCollester
[06:58:31] ✅    ✅ Patient name validation passed
[06:58:31] 🔄 
🔄 Step 3: Processing patient dates...
[06:58:31] [DOC: 9235196] ℹ️  DOB normalized: 09/24/1930
[06:58:31] [DOC: 9235196] ℹ️  Episode startOfCare normalized: 02/17/2025
[06:58:31] [DOC: 9235196] ℹ️  Episode startOfEpisode normalized: 02/17/2025
[06:58:31] [DOC: 9235196] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[06:58:31] [DOC: 9235196] ✅ Patient date processing completed successfully
[06:58:31] ✅    ✅ Date processing completed
[06:58:31] 📊 Processed Patient Data
     └─ patientFName: Kathryn
     └─ patientLName: McCollester
     └─ dob: 09/24/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 771002
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/17/2025', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': 'J18.9', 'secondDiagnosis': 'J91.8', 'thirdDiagnosis': 'J96.01', 'fourthDiagnosis': 'I26.99', 'fifthDiagnosis': 'I13.0', 'sixthDiagnosis': 'I50.32'}]
[06:58:31] 🔄 
🔄 Step 4: Extracting order data...
[06:58:33] ℹ️  Order extraction - MRN: ''
[06:58:33] ℹ️  Order extraction - Sex: 'FEMALE'
[06:58:33] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:58:33] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:58:33] ✅ Order data extraction completed successfully
[06:58:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:58:33] ℹ️  Using MRN from patient data: '771002'
[06:58:33] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:58:33] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:58:33] ✅ Patient name cross-validation successful
[06:58:33] ✅    ✅ Data merged successfully
[06:58:34] ✅    ✅ Order data extracted and validated
[06:58:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:58:34] [DOC: 9235196] ✅ Patient found in local cache: Kathryn McCollester, ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[06:58:34] ✅    ✅ Existing patient found with ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[06:58:34] 🔄 
🔄 Step 6: Pushing order to API...
[06:58:34] [DOC: 9235196] ℹ️  Pushing order via API for patient ID: 47c0c8be-f10e-480f-8905-ca112f69d3ee
[06:58:35] [DOC: 9235196] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14051"}
[06:58:35] ❌    ❌ Failed to push order
[06:58:35] 🔄 
🔄 Step 7: Writing to CSV...
[06:58:35] [DOC: 9235196] ℹ️  Calculated age: 94 from DOB: 09/24/1930
[06:58:35] [DOC: 9235196] ℹ️  Service Line extracted: 'Skilled Nursing'
[06:58:35] [DOC: 9235196] ℹ️  Payer Source extracted: 'Medicare'
[06:58:35] [DOC: 9235196] ℹ️  Diagnosis codes being written:
[06:58:35] [DOC: 9235196] ℹ️    - Latest_Episode_Firstdiagnosis: 'J18.9'
[06:58:35] [DOC: 9235196] ℹ️    - Latest_Episode_Seconddiagnosis: 'J91.8'
[06:58:35] [DOC: 9235196] ℹ️    - Latest_Episode_Thirddiagnosis: 'J96.01'
[06:58:35] [DOC: 9235196] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I26.99'
[06:58:35] [DOC: 9235196] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I13.0'
[06:58:35] [DOC: 9235196] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I50.32'
[06:58:35] [DOC: 9235196] ✅ Patient data written to CSV: Kathryn McCollester | Sex: FEMALE | Age: 94 | Service: Skilled Nursing | Payer: Medicare | MRN: 771002
[06:58:35] ✅    ✅ Document 9235196 processed and saved successfully
[06:58:35] 🔄 
🔄 Step 8: Saving API details...
[06:58:35] [DOC: 9235196] ℹ️  API push details saved for document 9235196
[06:58:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235193                         ║
================================================================================
[06:58:35] ℹ️  Agency: Dartmouth HH
[06:58:35] ℹ️  Date: 04/11/2025
[06:58:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:58:38] [DOC: 9235193] ✅ Text extracted using pdfplumber (1524 chars)
[06:58:38] ✅    ✅ Text extracted using pdfplumber (1524 chars)
[06:58:38] 🔄 
🔄 Step 2: Extracting patient data...
[06:58:40] ℹ️  AI extracted raw sex value: 'M'
[06:58:40] ℹ️  AI extracted service line: 'Skilled Nursing'
[06:58:40] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[06:58:40] ℹ️  AI extracted diagnoses:
[06:58:40] ℹ️    - Diagnosis 1: ''
[06:58:40] ℹ️    - Diagnosis 2: ''
[06:58:40] ℹ️    - Diagnosis 3: ''
[06:58:40] ℹ️    - Diagnosis 4: ''
[06:58:40] ℹ️    - Diagnosis 5: ''
[06:58:40] ℹ️    - Diagnosis 6: ''
[06:58:40] ℹ️  Final extracted MRN: '551011'
[06:58:40] ℹ️  Final extracted Sex: 'MALE'
[06:58:40] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[06:58:40] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[06:58:40] ✅ Patient data extraction completed successfully
[06:58:40] ✅    ✅ Patient data extracted successfully
[06:58:40] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Travers
     └─ dob: 07/02/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 551011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2025', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:58:40] ✅    ✅ Patient identified: James Travers
[06:58:40] ✅    ✅ Patient name validation passed
[06:58:40] 🔄 
🔄 Step 3: Processing patient dates...
[06:58:40] [DOC: 9235193] ℹ️  DOB normalized: 07/02/1944
[06:58:40] [DOC: 9235193] ℹ️  Episode startOfCare normalized: 03/23/2025
[06:58:40] [DOC: 9235193] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[06:58:40] [DOC: 9235193] ℹ️  Episode endOfEpisode normalized: 05/21/2025
[06:58:40] [DOC: 9235193] ✅ Patient date processing completed successfully
[06:58:40] ✅    ✅ Date processing completed
[06:58:40] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Travers
     └─ dob: 07/02/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 551011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '03/23/2025', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/21/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:58:40] 🔄 
🔄 Step 4: Extracting order data...
[06:58:43] ℹ️  Order extraction - MRN: ''
[06:58:43] ℹ️  Order extraction - Sex: 'MALE'
[06:58:43] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:58:43] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[06:58:43] ✅ Order data extraction completed successfully
[06:58:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:58:43] ℹ️  Using MRN from patient data: '551011'
[06:58:43] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[06:58:43] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[06:58:43] ✅ Patient name cross-validation successful
[06:58:43] ✅    ✅ Data merged successfully
[06:58:44] ✅    ✅ Order data extracted and validated
[06:58:44] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:58:44] [DOC: 9235193] ✅ Patient found in local cache: James Travers, ID: c5103623-be0f-42b5-97de-217d9f008d54
[06:58:44] ✅    ✅ Existing patient found with ID: c5103623-be0f-42b5-97de-217d9f008d54
[06:58:44] 🔄 
🔄 Step 6: Pushing order to API...
[06:58:44] [DOC: 9235193] ℹ️  Pushing order via API for patient ID: c5103623-be0f-42b5-97de-217d9f008d54
[06:58:45] [DOC: 9235193] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:58:45] ❌    ❌ Failed to push order
[06:58:45] 🔄 
🔄 Step 7: Writing to CSV...
[06:58:45] [DOC: 9235193] ℹ️  Calculated age: 80 from DOB: 07/02/1944
[06:58:45] [DOC: 9235193] ℹ️  Service Line extracted: 'Skilled Nursing'
[06:58:45] [DOC: 9235193] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[06:58:45] [DOC: 9235193] ℹ️  Diagnosis codes being written:
[06:58:45] [DOC: 9235193] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:58:45] [DOC: 9235193] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:58:45] [DOC: 9235193] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:58:45] [DOC: 9235193] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:58:45] [DOC: 9235193] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:58:45] [DOC: 9235193] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:58:45] [DOC: 9235193] ✅ Patient data written to CSV: James Travers | Sex: MALE | Age: 80 | Service: Skilled Nursing | Payer: Blue Cross Blue Shield | MRN: 551011
[06:58:45] ✅    ✅ Document 9235193 processed and saved successfully
[06:58:45] 🔄 
🔄 Step 8: Saving API details...
[06:58:45] [DOC: 9235193] ℹ️  API push details saved for document 9235193
[06:58:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235190                         ║
================================================================================
[06:58:45] ℹ️  Agency: Dartmouth HH
[06:58:45] ℹ️  Date: 04/11/2025
[06:58:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:58:47] [DOC: 9235190] ✅ Text extracted using pdfplumber (1832 chars)
[06:58:47] ✅    ✅ Text extracted using pdfplumber (1832 chars)
[06:58:47] 🔄 
🔄 Step 2: Extracting patient data...
[06:58:50] ℹ️  AI extracted raw sex value: 'F'
[06:58:50] ℹ️  AI extracted service line: 'RN'
[06:58:50] ℹ️  AI extracted payer source: 'Blue Cross Blue Shield'
[06:58:50] ℹ️  AI extracted diagnoses:
[06:58:50] ℹ️    - Diagnosis 1: ''
[06:58:50] ℹ️    - Diagnosis 2: ''
[06:58:50] ℹ️    - Diagnosis 3: ''
[06:58:50] ℹ️    - Diagnosis 4: ''
[06:58:50] ℹ️    - Diagnosis 5: ''
[06:58:50] ℹ️    - Diagnosis 6: ''
[06:58:50] ℹ️  Final extracted MRN: '651015'
[06:58:50] ℹ️  Final extracted Sex: 'FEMALE'
[06:58:50] ℹ️  Final extracted Service Line: 'RN'
[06:58:50] ℹ️  Final extracted Payer Source: 'Blue Cross Blue Shield'
[06:58:50] ✅ Patient data extraction completed successfully
[06:58:50] ✅    ✅ Patient data extracted successfully
[06:58:50] 📊 Patient Response
     └─ patientFName: A Shirley
     └─ patientLName: Jadlowe
     └─ dob: 01/19/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 651015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '05/23/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:58:50] ✅    ✅ Patient identified: A Shirley Jadlowe
[06:58:50] ✅    ✅ Patient name validation passed
[06:58:50] 🔄 
🔄 Step 3: Processing patient dates...
[06:58:50] [DOC: 9235190] ℹ️  DOB normalized: 01/19/1935
[06:58:50] [DOC: 9235190] ℹ️  Episode startOfCare normalized: 05/23/2024
[06:58:50] [DOC: 9235190] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[06:58:50] [DOC: 9235190] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[06:58:50] [DOC: 9235190] ✅ Patient date processing completed successfully
[06:58:50] ✅    ✅ Date processing completed
[06:58:50] 📊 Processed Patient Data
     └─ patientFName: A Shirley
     └─ patientLName: Jadlowe
     └─ dob: 01/19/1935
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 651015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Blue Cross Blue Shield
     └─ episodeDiagnoses: [{'startOfCare': '05/23/2024', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:58:50] 🔄 
🔄 Step 4: Extracting order data...
[06:58:53] ℹ️  Order extraction - MRN: '651015'
[06:58:53] ℹ️  Order extraction - Sex: 'FEMALE'
[06:58:53] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[06:58:53] ℹ️  Order extraction - Payer Source: 'Blue Cross Blue Shield'
[06:58:53] ✅ Order data extraction completed successfully
[06:58:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:58:53] ℹ️  Using MRN from patient data: '651015' over '651015'
[06:58:53] ℹ️  Combined service lines: Patient='RN' + Order='Skilled Nursing' = 'RN, Skilled Nursing'
[06:58:53] ℹ️  Payer source consistent in both sources: 'Blue Cross Blue Shield'
[06:58:53] ✅ Patient name cross-validation successful
[06:58:53] ✅    ✅ Data merged successfully
[06:58:54] ✅    ✅ Order data extracted and validated
[06:58:54] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:58:54] [DOC: 9235190] ✅ Patient found in local cache: A Shirley Jadlowe, ID: f434f7e2-b2e3-4187-b677-c68e57142970
[06:58:54] ✅    ✅ Existing patient found with ID: f434f7e2-b2e3-4187-b677-c68e57142970
[06:58:54] 🔄 
🔄 Step 6: Pushing order to API...
[06:58:54] [DOC: 9235190] ℹ️  Pushing order via API for patient ID: f434f7e2-b2e3-4187-b677-c68e57142970
[06:58:55] [DOC: 9235190] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:58:55] ❌    ❌ Failed to push order
[06:58:55] 🔄 
🔄 Step 7: Writing to CSV...
[06:58:55] [DOC: 9235190] ℹ️  Calculated age: 90 from DOB: 01/19/1935
[06:58:55] [DOC: 9235190] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[06:58:55] [DOC: 9235190] ℹ️  Payer Source extracted: 'Blue Cross Blue Shield'
[06:58:55] [DOC: 9235190] ℹ️  Diagnosis codes being written:
[06:58:55] [DOC: 9235190] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:58:55] [DOC: 9235190] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:58:55] [DOC: 9235190] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:58:55] [DOC: 9235190] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:58:55] [DOC: 9235190] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:58:55] [DOC: 9235190] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:58:55] [DOC: 9235190] ✅ Patient data written to CSV: A Shirley Jadlowe | Sex: FEMALE | Age: 90 | Service: RN, Skilled Nursing | Payer: Blue Cross Blue Shield | MRN: 651015
[06:58:55] ✅    ✅ Document 9235190 processed and saved successfully
[06:58:55] 🔄 
🔄 Step 8: Saving API details...
[06:58:55] [DOC: 9235190] ℹ️  API push details saved for document 9235190
[06:58:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235188                         ║
================================================================================
[06:58:55] ℹ️  Agency: Dartmouth HH
[06:58:55] ℹ️  Date: 04/11/2025
[06:58:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:59:01] [DOC: 9235188] ✅ Text extracted using pdfplumber (3254 chars)
[06:59:01] ✅    ✅ Text extracted using pdfplumber (3254 chars)
[06:59:01] 🔄 
🔄 Step 2: Extracting patient data...
[06:59:03] ℹ️  AI extracted raw sex value: 'F'
[06:59:03] ℹ️  AI extracted service line: 'PT'
[06:59:03] ℹ️  AI extracted payer source: 'Medicare'
[06:59:03] ℹ️  AI extracted diagnoses:
[06:59:03] ℹ️    - Diagnosis 1: ''
[06:59:03] ℹ️    - Diagnosis 2: ''
[06:59:03] ℹ️    - Diagnosis 3: ''
[06:59:03] ℹ️    - Diagnosis 4: ''
[06:59:03] ℹ️    - Diagnosis 5: ''
[06:59:03] ℹ️    - Diagnosis 6: ''
[06:59:03] ℹ️  Final extracted MRN: '2801011'
[06:59:03] ℹ️  Final extracted Sex: 'FEMALE'
[06:59:03] ℹ️  Final extracted Service Line: 'PT'
[06:59:03] ℹ️  Final extracted Payer Source: 'Medicare'
[06:59:03] ✅ Patient data extraction completed successfully
[06:59:03] ✅    ✅ Patient data extracted successfully
[06:59:03] 📊 Patient Response
     └─ patientFName: Dolores
     └─ patientLName: Gomes
     └─ dob: 02/01/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2801011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/19/2025', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:59:03] ✅    ✅ Patient identified: Dolores Gomes
[06:59:03] ✅    ✅ Patient name validation passed
[06:59:03] 🔄 
🔄 Step 3: Processing patient dates...
[06:59:03] [DOC: 9235188] ℹ️  DOB normalized: 02/01/1937
[06:59:03] [DOC: 9235188] ℹ️  Episode startOfCare normalized: 02/19/2025
[06:59:03] [DOC: 9235188] ℹ️  Episode startOfEpisode normalized: 02/19/2025
[06:59:03] [DOC: 9235188] ℹ️  Episode endOfEpisode normalized: 04/19/2025
[06:59:03] [DOC: 9235188] ✅ Patient date processing completed successfully
[06:59:03] ✅    ✅ Date processing completed
[06:59:03] 📊 Processed Patient Data
     └─ patientFName: Dolores
     └─ patientLName: Gomes
     └─ dob: 02/01/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2801011
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/19/2025', 'startOfEpisode': '02/19/2025', 'endOfEpisode': '04/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[06:59:03] 🔄 
🔄 Step 4: Extracting order data...
[06:59:06] ℹ️  Order extraction - MRN: '2801011'
[06:59:06] ℹ️  Order extraction - Sex: 'FEMALE'
[06:59:06] ℹ️  Order extraction - Service Line: 'PT'
[06:59:06] ℹ️  Order extraction - Payer Source: 'Medicare'
[06:59:06] ✅ Order data extraction completed successfully
[06:59:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:59:06] ℹ️  Using MRN from patient data: '2801011' over '2801011'
[06:59:06] ℹ️  Service line consistent in both sources: 'PT'
[06:59:06] ℹ️  Payer source consistent in both sources: 'Medicare'
[06:59:06] ✅ Patient name cross-validation successful
[06:59:06] ✅    ✅ Data merged successfully
[06:59:07] ✅    ✅ Order data extracted and validated
[06:59:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[06:59:35] [DOC: 9235188] ✅ Patient exists in API: Dolores Gomes, ID: ca822250-6268-4d98-93fc-9c099831fbdd
[06:59:35] ✅    ✅ Existing patient found with ID: ca822250-6268-4d98-93fc-9c099831fbdd
[06:59:35] 🔄 
🔄 Step 6: Pushing order to API...
[06:59:35] [DOC: 9235188] ℹ️  Pushing order via API for patient ID: ca822250-6268-4d98-93fc-9c099831fbdd
[06:59:36] [DOC: 9235188] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[06:59:36] ❌    ❌ Failed to push order
[06:59:36] 🔄 
🔄 Step 7: Writing to CSV...
[06:59:36] [DOC: 9235188] ℹ️  Calculated age: 88 from DOB: 02/01/1937
[06:59:36] [DOC: 9235188] ℹ️  Service Line extracted: 'PT'
[06:59:36] [DOC: 9235188] ℹ️  Payer Source extracted: 'Medicare'
[06:59:36] [DOC: 9235188] ℹ️  Diagnosis codes being written:
[06:59:36] [DOC: 9235188] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[06:59:36] [DOC: 9235188] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[06:59:36] [DOC: 9235188] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[06:59:36] [DOC: 9235188] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[06:59:36] [DOC: 9235188] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[06:59:36] [DOC: 9235188] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[06:59:36] [DOC: 9235188] ✅ Patient data written to CSV: Dolores Gomes | Sex: FEMALE | Age: 88 | Service: PT | Payer: Medicare | MRN: 2801011
[06:59:36] ✅    ✅ Document 9235188 processed and saved successfully
[06:59:36] 🔄 
🔄 Step 8: Saving API details...
[06:59:36] [DOC: 9235188] ℹ️  API push details saved for document 9235188
[06:59:36] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235183                         ║
================================================================================
[06:59:36] ℹ️  Agency: Dartmouth HH
[06:59:36] ℹ️  Date: 04/11/2025
[06:59:36] 🔄 
🔄 Step 1: Extracting text from PDF...
[06:59:40] [DOC: 9235183] ✅ Text extracted using pdfplumber (13752 chars)
[06:59:40] ✅    ✅ Text extracted using pdfplumber (13740 chars)
[06:59:40] 🔄 
🔄 Step 2: Extracting patient data...
[06:59:43] ℹ️  AI extracted raw sex value: 'F'
[06:59:43] ℹ️  AI extracted service line: 'PT, OT'
[06:59:43] ℹ️  AI extracted payer source: ''
[06:59:43] ℹ️  AI extracted diagnoses:
[06:59:43] ℹ️    - Diagnosis 1: 'M54.41'
[06:59:43] ℹ️    - Diagnosis 2: 'M62.81'
[06:59:43] ℹ️    - Diagnosis 3: 'M70.61'
[06:59:43] ℹ️    - Diagnosis 4: 'M17.12'
[06:59:43] ℹ️    - Diagnosis 5: 'M70.52'
[06:59:43] ℹ️    - Diagnosis 6: 'M25.511'
[06:59:43] ℹ️  Final extracted MRN: '1183008'
[06:59:43] ℹ️  Final extracted Sex: 'FEMALE'
[06:59:43] ℹ️  Final extracted Service Line: 'PT, OT'
[06:59:43] ℹ️  Final extracted Payer Source: ''
[06:59:43] ✅ Patient data extraction completed successfully
[06:59:43] ✅    ✅ Patient data extracted successfully
[06:59:43] 📊 Patient Response
     └─ patientFName: Jean
     └─ patientLName: Silver
     └─ dob: 02/12/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1183008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'M54.41', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'M70.61', 'fourthDiagnosis': 'M17.12', 'fifthDiagnosis': 'M70.52', 'sixthDiagnosis': 'M25.511'}]
[06:59:43] ✅    ✅ Patient identified: Jean Silver
[06:59:43] ✅    ✅ Patient name validation passed
[06:59:43] 🔄 
🔄 Step 3: Processing patient dates...
[06:59:43] [DOC: 9235183] ℹ️  DOB normalized: 02/12/1931
[06:59:43] [DOC: 9235183] ℹ️  Episode startOfCare normalized: 03/29/2025
[06:59:43] [DOC: 9235183] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[06:59:43] [DOC: 9235183] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[06:59:43] [DOC: 9235183] ✅ Patient date processing completed successfully
[06:59:43] ✅    ✅ Date processing completed
[06:59:43] 📊 Processed Patient Data
     └─ patientFName: Jean
     └─ patientLName: Silver
     └─ dob: 02/12/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 1183008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': 'M54.41', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': 'M70.61', 'fourthDiagnosis': 'M17.12', 'fifthDiagnosis': 'M70.52', 'sixthDiagnosis': 'M25.511'}]
[06:59:43] 🔄 
🔄 Step 4: Extracting order data...
[06:59:45] ℹ️  Order extraction - MRN: '1183008'
[06:59:45] ℹ️  Order extraction - Sex: 'FEMALE'
[06:59:45] ℹ️  Order extraction - Service Line: 'PT, OT'
[06:59:45] ℹ️  Order extraction - Payer Source: ''
[06:59:45] ✅ Order data extraction completed successfully
[06:59:45] 🔄 
🔄 Step 4.5: Merging patient and order data...
[06:59:45] ℹ️  Using MRN from patient data: '1183008' over '1183008'
[06:59:45] ℹ️  Service line consistent in both sources: 'PT, OT'
[06:59:45] ✅ Patient name cross-validation successful
[06:59:45] ✅    ✅ Data merged successfully
[06:59:46] ✅    ✅ Order data extracted and validated
[06:59:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:00:32] [DOC: 9235183] ℹ️  Patient not found in cache or API: Jean Silver
[07:00:32] [DOC: 9235183] ℹ️  Patient not found, creating new patient via API...
[07:00:32] [DOC: 9235183] ℹ️  Creating patient via API: Jean Silver
[07:00:34] [DOC: 9235183] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[07:00:34] ❌    ❌ Failed to create patient
[07:00:34] [DOC: 9235183] ℹ️  API push details saved for document 9235183
================================================================================
║                        Processing Document ID: 9235179                         ║
================================================================================
[07:00:34] ℹ️  Agency: Dartmouth HH
[07:00:34] ℹ️  Date: 04/11/2025
[07:00:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:00:39] [DOC: 9235179] ✅ Text extracted using pdfplumber (1377 chars)
[07:00:39] ✅    ✅ Text extracted using pdfplumber (1377 chars)
[07:00:39] 🔄 
🔄 Step 2: Extracting patient data...
[07:00:42] ℹ️  AI extracted raw sex value: 'F'
[07:00:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[07:00:42] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[07:00:42] ℹ️  AI extracted diagnoses:
[07:00:42] ℹ️    - Diagnosis 1: ''
[07:00:42] ℹ️    - Diagnosis 2: ''
[07:00:42] ℹ️    - Diagnosis 3: ''
[07:00:42] ℹ️    - Diagnosis 4: ''
[07:00:42] ℹ️    - Diagnosis 5: ''
[07:00:42] ℹ️    - Diagnosis 6: ''
[07:00:42] ℹ️  Final extracted MRN: '6201015'
[07:00:42] ℹ️  Final extracted Sex: 'FEMALE'
[07:00:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[07:00:42] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[07:00:42] ✅ Patient data extraction completed successfully
[07:00:42] ✅    ✅ Patient data extracted successfully
[07:00:42] 📊 Patient Response
     └─ patientFName: Maria
     └─ patientLName: Laborinho
     └─ dob: 02/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6201015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 103 Fair St, Apt 2
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '04/06/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:00:42] ✅    ✅ Patient identified: Maria Laborinho
[07:00:42] ✅    ✅ Patient name validation passed
[07:00:42] 🔄 
🔄 Step 3: Processing patient dates...
[07:00:42] [DOC: 9235179] ℹ️  DOB normalized: 02/08/1951
[07:00:42] [DOC: 9235179] ℹ️  Episode startOfCare normalized: 03/13/2025
[07:00:42] [DOC: 9235179] ℹ️  Episode startOfEpisode normalized: 04/06/2025
[07:00:42] [DOC: 9235179] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[07:00:42] [DOC: 9235179] ✅ Patient date processing completed successfully
[07:00:42] ✅    ✅ Date processing completed
[07:00:42] 📊 Processed Patient Data
     └─ patientFName: Maria
     └─ patientLName: Laborinho
     └─ dob: 02/08/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6201015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 103 Fair St, Apt 2
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '04/06/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:00:42] 🔄 
🔄 Step 4: Extracting order data...
[07:00:44] ℹ️  Order extraction - MRN: ''
[07:00:44] ℹ️  Order extraction - Sex: 'FEMALE'
[07:00:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[07:00:44] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[07:00:44] ✅ Order data extraction completed successfully
[07:00:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:00:44] ℹ️  Using MRN from patient data: '6201015'
[07:00:44] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[07:00:44] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[07:00:44] ✅ Patient name cross-validation successful
[07:00:44] ✅    ✅ Data merged successfully
[07:00:46] ✅    ✅ Order data extracted and validated
[07:00:46] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:00:52] [DOC: 9235179] ℹ️  Patient not found in cache or API: Maria Laborinho
[07:00:52] [DOC: 9235179] ℹ️  Patient not found, creating new patient via API...
[07:00:52] [DOC: 9235179] ℹ️  Creating patient via API: Maria Laborinho
[07:00:53] [DOC: 9235179] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[07:00:53] ❌    ❌ Failed to create patient
[07:00:53] [DOC: 9235179] ℹ️  API push details saved for document 9235179
================================================================================
║                        Processing Document ID: 9235176                         ║
================================================================================
[07:00:53] ℹ️  Agency: Dartmouth HH
[07:00:53] ℹ️  Date: 04/11/2025
[07:00:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:00:56] [DOC: 9235176] ✅ Text extracted using pdfplumber (6392 chars)
[07:00:56] ✅    ✅ Text extracted using pdfplumber (6392 chars)
[07:00:56] 🔄 
🔄 Step 2: Extracting patient data...
[07:00:59] ℹ️  AI extracted raw sex value: 'F'
[07:00:59] ℹ️  AI extracted service line: 'PT'
[07:00:59] ℹ️  AI extracted payer source: 'Medicare'
[07:00:59] ℹ️  AI extracted diagnoses:
[07:00:59] ℹ️    - Diagnosis 1: ''
[07:00:59] ℹ️    - Diagnosis 2: ''
[07:00:59] ℹ️    - Diagnosis 3: ''
[07:00:59] ℹ️    - Diagnosis 4: ''
[07:00:59] ℹ️    - Diagnosis 5: ''
[07:00:59] ℹ️    - Diagnosis 6: ''
[07:00:59] ℹ️  Final extracted MRN: '672008'
[07:00:59] ℹ️  Final extracted Sex: 'FEMALE'
[07:00:59] ℹ️  Final extracted Service Line: 'PT'
[07:00:59] ℹ️  Final extracted Payer Source: 'Medicare'
[07:00:59] ✅ Patient data extraction completed successfully
[07:00:59] ✅    ✅ Patient data extracted successfully
[07:00:59] 📊 Patient Response
     └─ patientFName: Jane
     └─ patientLName: Lonsdale
     └─ dob: 02/20/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 672008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:00:59] ✅    ✅ Patient identified: Jane Lonsdale
[07:00:59] ✅    ✅ Patient name validation passed
[07:00:59] 🔄 
🔄 Step 3: Processing patient dates...
[07:00:59] [DOC: 9235176] ℹ️  DOB normalized: 02/20/1930
[07:00:59] [DOC: 9235176] ℹ️  Episode startOfCare normalized: 03/09/2025
[07:00:59] [DOC: 9235176] ℹ️  Episode startOfEpisode normalized: 03/14/2025
[07:00:59] [DOC: 9235176] ℹ️  Episode endOfEpisode normalized: 05/07/2025
[07:00:59] [DOC: 9235176] ✅ Patient date processing completed successfully
[07:00:59] ✅    ✅ Date processing completed
[07:00:59] 📊 Processed Patient Data
     └─ patientFName: Jane
     └─ patientLName: Lonsdale
     └─ dob: 02/20/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 672008
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/09/2025', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/07/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:00:59] 🔄 
🔄 Step 4: Extracting order data...
[07:01:01] ℹ️  Order extraction - MRN: ''
[07:01:01] ℹ️  Order extraction - Sex: 'FEMALE'
[07:01:01] ℹ️  Order extraction - Service Line: 'PT'
[07:01:01] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:01:01] ✅ Order data extraction completed successfully
[07:01:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:01:01] ℹ️  Using MRN from patient data: '672008'
[07:01:01] ℹ️  Service line consistent in both sources: 'PT'
[07:01:01] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:01:01] ✅ Patient name cross-validation successful
[07:01:01] ✅    ✅ Data merged successfully
[07:01:03] ✅    ✅ Order data extracted and validated
[07:01:03] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:01:30] [DOC: 9235176] ℹ️  Patient not found in cache or API: Jane Lonsdale
[07:01:30] [DOC: 9235176] ℹ️  Patient not found, creating new patient via API...
[07:01:30] [DOC: 9235176] ℹ️  Creating patient via API: Jane Lonsdale
[07:01:31] [DOC: 9235176] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[07:01:31] ❌    ❌ Failed to create patient
[07:01:31] [DOC: 9235176] ℹ️  API push details saved for document 9235176
================================================================================
║                        Processing Document ID: 9235174                         ║
================================================================================
[07:01:31] ℹ️  Agency: Dartmouth HH
[07:01:31] ℹ️  Date: 04/11/2025
[07:01:31] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:01:34] [DOC: 9235174] ✅ Text extracted using pdfplumber (1147 chars)
[07:01:34] ✅    ✅ Text extracted using pdfplumber (1147 chars)
[07:01:34] 🔄 
🔄 Step 2: Extracting patient data...
[07:01:36] ℹ️  AI extracted raw sex value: 'F'
[07:01:36] ℹ️  AI extracted service line: 'HHA'
[07:01:36] ℹ️  AI extracted payer source: 'Medicare'
[07:01:36] ℹ️  AI extracted diagnoses:
[07:01:36] ℹ️    - Diagnosis 1: ''
[07:01:36] ℹ️    - Diagnosis 2: ''
[07:01:36] ℹ️    - Diagnosis 3: ''
[07:01:36] ℹ️    - Diagnosis 4: ''
[07:01:36] ℹ️    - Diagnosis 5: ''
[07:01:36] ℹ️    - Diagnosis 6: ''
[07:01:36] ℹ️  Final extracted MRN: '6063015'
[07:01:36] ℹ️  Final extracted Sex: 'FEMALE'
[07:01:36] ℹ️  Final extracted Service Line: 'HHA'
[07:01:36] ℹ️  Final extracted Payer Source: 'Medicare'
[07:01:36] ✅ Patient data extraction completed successfully
[07:01:36] ✅    ✅ Patient data extracted successfully
[07:01:36] 📊 Patient Response
     └─ patientFName: Ann
     └─ patientLName: Bourque
     └─ dob: 11/28/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6063015
     └─ billingProvider: Christine A Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1452 Morton Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:01:36] ✅    ✅ Patient identified: Ann Bourque
[07:01:36] ✅    ✅ Patient name validation passed
[07:01:36] 🔄 
🔄 Step 3: Processing patient dates...
[07:01:36] [DOC: 9235174] ℹ️  DOB normalized: 11/28/1962
[07:01:36] [DOC: 9235174] ℹ️  Episode startOfCare normalized: 03/29/2025
[07:01:36] [DOC: 9235174] ℹ️  Episode startOfEpisode normalized: 03/29/2025
[07:01:36] [DOC: 9235174] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[07:01:36] [DOC: 9235174] ✅ Patient date processing completed successfully
[07:01:36] ✅    ✅ Date processing completed
[07:01:36] 📊 Processed Patient Data
     └─ patientFName: Ann
     └─ patientLName: Bourque
     └─ dob: 11/28/1962
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6063015
     └─ billingProvider: Christine A Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 1452 Morton Ave
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/29/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:01:36] 🔄 
🔄 Step 4: Extracting order data...
[07:01:38] ℹ️  Order extraction - MRN: ''
[07:01:38] ℹ️  Order extraction - Sex: 'FEMALE'
[07:01:38] ℹ️  Order extraction - Service Line: 'RN'
[07:01:38] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:01:38] ✅ Order data extraction completed successfully
[07:01:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:01:38] ℹ️  Using MRN from patient data: '6063015'
[07:01:38] ℹ️  Combined service lines: Patient='HHA' + Order='RN' = 'HHA, RN'
[07:01:38] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:01:38] ✅ Patient name cross-validation successful
[07:01:38] ✅    ✅ Data merged successfully
[07:01:40] ✅    ✅ Order data extracted and validated
[07:01:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:01:40] [DOC: 9235174] ✅ Patient found in local cache: Ann Bourque, ID: 1d9a45ed-406d-4acb-90d1-87705ac62b6a
[07:01:40] ✅    ✅ Existing patient found with ID: 1d9a45ed-406d-4acb-90d1-87705ac62b6a
[07:01:40] 🔄 
🔄 Step 6: Pushing order to API...
[07:01:40] [DOC: 9235174] ℹ️  Pushing order via API for patient ID: 1d9a45ed-406d-4acb-90d1-87705ac62b6a
[07:01:41] [DOC: 9235174] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13324"}
[07:01:41] ❌    ❌ Failed to push order
[07:01:41] 🔄 
🔄 Step 7: Writing to CSV...
[07:01:41] [DOC: 9235174] ℹ️  Calculated age: 62 from DOB: 11/28/1962
[07:01:41] [DOC: 9235174] ℹ️  Service Line extracted: 'HHA, RN'
[07:01:41] [DOC: 9235174] ℹ️  Payer Source extracted: 'Medicare'
[07:01:41] [DOC: 9235174] ℹ️  Diagnosis codes being written:
[07:01:41] [DOC: 9235174] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:01:41] [DOC: 9235174] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:01:41] [DOC: 9235174] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:01:41] [DOC: 9235174] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:01:41] [DOC: 9235174] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:01:41] [DOC: 9235174] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:01:41] [DOC: 9235174] ✅ Patient data written to CSV: Ann Bourque | Sex: FEMALE | Age: 62 | Service: HHA, RN | Payer: Medicare | MRN: 6063015
[07:01:41] ✅    ✅ Document 9235174 processed and saved successfully
[07:01:41] 🔄 
🔄 Step 8: Saving API details...
[07:01:41] [DOC: 9235174] ℹ️  API push details saved for document 9235174
[07:01:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235166                         ║
================================================================================
[07:01:41] ℹ️  Agency: Dartmouth HH
[07:01:41] ℹ️  Date: 04/11/2025
[07:01:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:01:43] [DOC: 9235166] ✅ Text extracted using pdfplumber (2346 chars)
[07:01:43] ✅    ✅ Text extracted using pdfplumber (2346 chars)
[07:01:43] 🔄 
🔄 Step 2: Extracting patient data...
[07:01:46] ℹ️  AI extracted raw sex value: 'F'
[07:01:46] ℹ️  AI extracted service line: 'Skilled Nursing'
[07:01:46] ℹ️  AI extracted payer source: 'Medicare'
[07:01:46] ℹ️  AI extracted diagnoses:
[07:01:46] ℹ️    - Diagnosis 1: 'None'
[07:01:46] ℹ️    - Diagnosis 2: 'None'
[07:01:46] ℹ️    - Diagnosis 3: 'None'
[07:01:46] ℹ️    - Diagnosis 4: 'None'
[07:01:46] ℹ️    - Diagnosis 5: 'None'
[07:01:46] ℹ️    - Diagnosis 6: 'None'
[07:01:46] ℹ️  Final extracted MRN: '2496015'
[07:01:46] ℹ️  Final extracted Sex: 'FEMALE'
[07:01:46] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[07:01:46] ℹ️  Final extracted Payer Source: 'Medicare'
[07:01:46] ✅ Patient data extraction completed successfully
[07:01:46] ✅    ✅ Patient data extracted successfully
[07:01:46] 📊 Patient Response
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[07:01:46] ✅    ✅ Patient identified: Dana Theodore
[07:01:46] ✅    ✅ Patient name validation passed
[07:01:46] 🔄 
🔄 Step 3: Processing patient dates...
[07:01:46] [DOC: 9235166] ℹ️  DOB normalized: 03/16/1954
[07:01:46] [DOC: 9235166] ℹ️  Episode startOfCare normalized: 03/02/2025
[07:01:46] [DOC: 9235166] ℹ️  Episode startOfEpisode normalized: 03/02/2025
[07:01:46] [DOC: 9235166] ℹ️  Episode endOfEpisode normalized: 04/30/2025
[07:01:46] [DOC: 9235166] ✅ Patient date processing completed successfully
[07:01:46] ✅    ✅ Date processing completed
[07:01:46] 📊 Processed Patient Data
     └─ patientFName: Dana
     └─ patientLName: Theodore
     └─ dob: 03/16/1954
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2496015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/02/2025', 'startOfEpisode': '03/02/2025', 'endOfEpisode': '04/30/2025'}]
[07:01:46] 🔄 
🔄 Step 4: Extracting order data...
[07:01:48] ℹ️  Order extraction - MRN: ''
[07:01:48] ℹ️  Order extraction - Sex: 'FEMALE'
[07:01:48] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[07:01:48] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:01:48] ✅ Order data extraction completed successfully
[07:01:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:01:48] ℹ️  Using MRN from patient data: '2496015'
[07:01:48] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[07:01:48] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:01:48] ✅ Patient name cross-validation successful
[07:01:48] ✅    ✅ Data merged successfully
[07:01:49] ✅    ✅ Order data extracted and validated
[07:01:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:01:49] [DOC: 9235166] ✅ Patient found in local cache: Dana Theodore, ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[07:01:49] ✅    ✅ Existing patient found with ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[07:01:49] 🔄 
🔄 Step 6: Pushing order to API...
[07:01:49] [DOC: 9235166] ℹ️  Pushing order via API for patient ID: 9905cce6-dee2-4548-bbbc-669f282a9521
[07:01:50] [DOC: 9235166] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:01:50] ❌    ❌ Failed to push order
[07:01:50] 🔄 
🔄 Step 7: Writing to CSV...
[07:01:50] [DOC: 9235166] ℹ️  Calculated age: 71 from DOB: 03/16/1954
[07:01:50] [DOC: 9235166] ℹ️  Service Line extracted: 'Skilled Nursing'
[07:01:50] [DOC: 9235166] ℹ️  Payer Source extracted: 'Medicare'
[07:01:50] [DOC: 9235166] ℹ️  Diagnosis codes being written:
[07:01:50] [DOC: 9235166] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:01:50] [DOC: 9235166] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:01:50] [DOC: 9235166] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:01:50] [DOC: 9235166] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:01:50] [DOC: 9235166] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:01:50] [DOC: 9235166] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:01:50] [DOC: 9235166] ✅ Patient data written to CSV: Dana Theodore | Sex: FEMALE | Age: 71 | Service: Skilled Nursing | Payer: Medicare | MRN: 2496015
[07:01:50] ✅    ✅ Document 9235166 processed and saved successfully
[07:01:50] 🔄 
🔄 Step 8: Saving API details...
[07:01:50] [DOC: 9235166] ℹ️  API push details saved for document 9235166
[07:01:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235163                         ║
================================================================================
[07:01:50] ℹ️  Agency: Dartmouth HH
[07:01:50] ℹ️  Date: 04/11/2025
[07:01:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:01:53] [DOC: 9235163] ✅ Text extracted using pdfplumber (1676 chars)
[07:01:53] ✅    ✅ Text extracted using pdfplumber (1676 chars)
[07:01:53] 🔄 
🔄 Step 2: Extracting patient data...
[07:01:56] ℹ️  AI extracted raw sex value: 'F'
[07:01:56] ℹ️  AI extracted service line: 'Skilled Nursing'
[07:01:56] ℹ️  AI extracted payer source: 'Medicare'
[07:01:56] ℹ️  AI extracted diagnoses:
[07:01:56] ℹ️    - Diagnosis 1: ''
[07:01:56] ℹ️    - Diagnosis 2: ''
[07:01:56] ℹ️    - Diagnosis 3: ''
[07:01:56] ℹ️    - Diagnosis 4: ''
[07:01:56] ℹ️    - Diagnosis 5: ''
[07:01:56] ℹ️    - Diagnosis 6: ''
[07:01:56] ℹ️  Final extracted MRN: '6115015'
[07:01:56] ℹ️  Final extracted Sex: 'FEMALE'
[07:01:56] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[07:01:56] ℹ️  Final extracted Payer Source: 'Medicare'
[07:01:56] ✅ Patient data extraction completed successfully
[07:01:56] ✅    ✅ Patient data extracted successfully
[07:01:56] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:01:56] ✅    ✅ Patient identified: Nancy Silva
[07:01:56] ✅    ✅ Patient name validation passed
[07:01:56] 🔄 
🔄 Step 3: Processing patient dates...
[07:01:56] [DOC: 9235163] ℹ️  DOB normalized: 11/18/1936
[07:01:56] [DOC: 9235163] ℹ️  Episode startOfCare normalized: 03/01/2025
[07:01:56] [DOC: 9235163] ℹ️  Episode startOfEpisode normalized: 03/16/2025
[07:01:56] [DOC: 9235163] ℹ️  Episode endOfEpisode normalized: 04/29/2025
[07:01:56] [DOC: 9235163] ✅ Patient date processing completed successfully
[07:01:56] ✅    ✅ Date processing completed
[07:01:56] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Silva
     └─ dob: 11/18/1936
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6115015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/01/2025', 'startOfEpisode': '03/16/2025', 'endOfEpisode': '04/29/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:01:56] 🔄 
🔄 Step 4: Extracting order data...
[07:01:58] ℹ️  Order extraction - MRN: '6115015'
[07:01:58] ℹ️  Order extraction - Sex: 'FEMALE'
[07:01:58] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[07:01:58] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:01:58] ✅ Order data extraction completed successfully
[07:01:58] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:01:58] ℹ️  Using MRN from patient data: '6115015' over '6115015'
[07:01:58] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[07:01:58] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:01:58] ✅ Patient name cross-validation successful
[07:01:58] ✅    ✅ Data merged successfully
[07:01:59] ✅    ✅ Order data extracted and validated
[07:01:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:01:59] [DOC: 9235163] ✅ Patient found in local cache: Nancy Silva, ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[07:01:59] ✅    ✅ Existing patient found with ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[07:01:59] 🔄 
🔄 Step 6: Pushing order to API...
[07:01:59] [DOC: 9235163] ℹ️  Pushing order via API for patient ID: 4dd98008-6514-4e29-a1bf-4e671f846505
[07:02:00] [DOC: 9235163] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:02:00] ❌    ❌ Failed to push order
[07:02:00] 🔄 
🔄 Step 7: Writing to CSV...
[07:02:00] [DOC: 9235163] ℹ️  Calculated age: 88 from DOB: 11/18/1936
[07:02:00] [DOC: 9235163] ℹ️  Service Line extracted: 'Skilled Nursing'
[07:02:00] [DOC: 9235163] ℹ️  Payer Source extracted: 'Medicare'
[07:02:00] [DOC: 9235163] ℹ️  Diagnosis codes being written:
[07:02:00] [DOC: 9235163] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:02:00] [DOC: 9235163] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:02:00] [DOC: 9235163] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:02:00] [DOC: 9235163] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:02:00] [DOC: 9235163] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:02:00] [DOC: 9235163] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:02:00] [DOC: 9235163] ✅ Patient data written to CSV: Nancy Silva | Sex: FEMALE | Age: 88 | Service: Skilled Nursing | Payer: Medicare | MRN: 6115015
[07:02:00] ✅    ✅ Document 9235163 processed and saved successfully
[07:02:00] 🔄 
🔄 Step 8: Saving API details...
[07:02:00] [DOC: 9235163] ℹ️  API push details saved for document 9235163
[07:02:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235161                         ║
================================================================================
[07:02:00] ℹ️  Agency: Dartmouth HH
[07:02:00] ℹ️  Date: 04/11/2025
[07:02:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:02:02] [DOC: 9235161] ✅ Text extracted using pdfplumber (1075 chars)
[07:02:02] ✅    ✅ Text extracted using pdfplumber (1075 chars)
[07:02:02] 🔄 
🔄 Step 2: Extracting patient data...
[07:02:05] ℹ️  AI extracted raw sex value: 'F'
[07:02:05] ℹ️  AI extracted service line: 'Skilled Nursing'
[07:02:05] ℹ️  AI extracted payer source: 'Medicare'
[07:02:05] ℹ️  AI extracted diagnoses:
[07:02:05] ℹ️    - Diagnosis 1: 'None'
[07:02:05] ℹ️    - Diagnosis 2: 'None'
[07:02:05] ℹ️    - Diagnosis 3: 'None'
[07:02:05] ℹ️    - Diagnosis 4: 'None'
[07:02:05] ℹ️    - Diagnosis 5: 'None'
[07:02:05] ℹ️    - Diagnosis 6: 'None'
[07:02:05] ℹ️  Final extracted MRN: '6095015'
[07:02:05] ℹ️  Final extracted Sex: 'FEMALE'
[07:02:05] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[07:02:05] ℹ️  Final extracted Payer Source: 'Medicare'
[07:02:05] ✅ Patient data extraction completed successfully
[07:02:05] ✅    ✅ Patient data extracted successfully
[07:02:05] 📊 Patient Response
     └─ patientFName: Gabriel
     └─ patientLName: Ditata
     └─ dob: 03/18/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6095015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/23/2025', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[07:02:05] ✅    ✅ Patient identified: Gabriel Ditata
[07:02:05] ✅    ✅ Patient name validation passed
[07:02:05] 🔄 
🔄 Step 3: Processing patient dates...
[07:02:05] [DOC: 9235161] ℹ️  DOB normalized: 03/18/1933
[07:02:05] [DOC: 9235161] ℹ️  Episode startOfCare normalized: 02/23/2025
[07:02:05] [DOC: 9235161] ℹ️  Episode startOfEpisode normalized: 02/23/2025
[07:02:05] [DOC: 9235161] ℹ️  Episode endOfEpisode normalized: 04/23/2025
[07:02:05] [DOC: 9235161] ✅ Patient date processing completed successfully
[07:02:05] ✅    ✅ Date processing completed
[07:02:05] 📊 Processed Patient Data
     └─ patientFName: Gabriel
     └─ patientLName: Ditata
     └─ dob: 03/18/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6095015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '02/23/2025', 'startOfEpisode': '02/23/2025', 'endOfEpisode': '04/23/2025'}]
[07:02:05] 🔄 
🔄 Step 4: Extracting order data...
[07:02:07] ℹ️  Order extraction - MRN: ''
[07:02:07] ℹ️  Order extraction - Sex: 'FEMALE'
[07:02:07] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[07:02:07] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:02:07] ✅ Order data extraction completed successfully
[07:02:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:02:07] ℹ️  Using MRN from patient data: '6095015'
[07:02:07] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[07:02:07] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:02:07] ✅ Patient name cross-validation successful
[07:02:07] ✅    ✅ Data merged successfully
[07:02:09] ✅    ✅ Order data extracted and validated
[07:02:09] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:02:26] [DOC: 9235161] ℹ️  Patient not found in cache or API: Gabriel Ditata
[07:02:26] [DOC: 9235161] ℹ️  Patient not found, creating new patient via API...
[07:02:26] [DOC: 9235161] ℹ️  Creating patient via API: Gabriel Ditata
[07:02:29] [DOC: 9235161] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[07:02:29] ❌    ❌ Failed to create patient
[07:02:29] [DOC: 9235161] ℹ️  API push details saved for document 9235161
================================================================================
║                        Processing Document ID: 9235156                         ║
================================================================================
[07:02:29] ℹ️  Agency: Dartmouth HH
[07:02:29] ℹ️  Date: 04/11/2025
[07:02:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:02:31] [DOC: 9235156] ✅ Text extracted using pdfplumber (1165 chars)
[07:02:31] ✅    ✅ Text extracted using pdfplumber (1165 chars)
[07:02:31] 🔄 
🔄 Step 2: Extracting patient data...
[07:02:34] ℹ️  AI extracted raw sex value: 'M'
[07:02:34] ℹ️  AI extracted service line: 'RN, LPN'
[07:02:34] ℹ️  AI extracted payer source: 'Medicare'
[07:02:34] ℹ️  AI extracted diagnoses:
[07:02:34] ℹ️    - Diagnosis 1: ''
[07:02:34] ℹ️    - Diagnosis 2: ''
[07:02:34] ℹ️    - Diagnosis 3: ''
[07:02:34] ℹ️    - Diagnosis 4: ''
[07:02:34] ℹ️    - Diagnosis 5: ''
[07:02:34] ℹ️    - Diagnosis 6: ''
[07:02:34] ℹ️  Final extracted MRN: '6396009'
[07:02:34] ℹ️  Final extracted Sex: 'MALE'
[07:02:34] ℹ️  Final extracted Service Line: 'RN, LPN'
[07:02:34] ℹ️  Final extracted Payer Source: 'Medicare'
[07:02:34] ✅ Patient data extraction completed successfully
[07:02:34] ✅    ✅ Patient data extracted successfully
[07:02:34] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Edwards
     └─ dob: 04/08/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 12 Hathaway Road
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:02:34] ✅    ✅ Patient identified: Frank Edwards
[07:02:34] ✅    ✅ Patient name validation passed
[07:02:34] 🔄 
🔄 Step 3: Processing patient dates...
[07:02:34] [DOC: 9235156] ℹ️  DOB normalized: 04/08/1942
[07:02:34] [DOC: 9235156] ℹ️  Episode startOfCare normalized: 03/13/2025
[07:02:34] [DOC: 9235156] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[07:02:34] [DOC: 9235156] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[07:02:34] [DOC: 9235156] ✅ Patient date processing completed successfully
[07:02:34] ✅    ✅ Date processing completed
[07:02:34] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Edwards
     └─ dob: 04/08/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6396009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 12 Hathaway Road
     └─ city: Acushnet
     └─ state: MA
     └─ zip: 02743
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:02:34] 🔄 
🔄 Step 4: Extracting order data...
[07:02:36] ℹ️  Order extraction - MRN: ''
[07:02:36] ℹ️  Order extraction - Sex: 'MALE'
[07:02:36] ℹ️  Order extraction - Service Line: 'RN, LPN'
[07:02:36] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:02:36] ✅ Order data extraction completed successfully
[07:02:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:02:36] ℹ️  Using MRN from patient data: '6396009'
[07:02:36] ℹ️  Service line consistent in both sources: 'RN, LPN'
[07:02:36] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:02:36] ✅ Patient name cross-validation successful
[07:02:36] ✅    ✅ Data merged successfully
[07:02:38] ✅    ✅ Order data extracted and validated
[07:02:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:02:38] [DOC: 9235156] ✅ Patient found in local cache: Frank Edwards, ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[07:02:38] ✅    ✅ Existing patient found with ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[07:02:38] 🔄 
🔄 Step 6: Pushing order to API...
[07:02:38] [DOC: 9235156] ℹ️  Pushing order via API for patient ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[07:02:39] [DOC: 9235156] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13905"}
[07:02:39] ❌    ❌ Failed to push order
[07:02:39] 🔄 
🔄 Step 7: Writing to CSV...
[07:02:39] [DOC: 9235156] ℹ️  Calculated age: 83 from DOB: 04/08/1942
[07:02:39] [DOC: 9235156] ℹ️  Service Line extracted: 'RN, LPN'
[07:02:39] [DOC: 9235156] ℹ️  Payer Source extracted: 'Medicare'
[07:02:39] [DOC: 9235156] ℹ️  Diagnosis codes being written:
[07:02:39] [DOC: 9235156] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:02:39] [DOC: 9235156] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:02:39] [DOC: 9235156] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:02:39] [DOC: 9235156] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:02:39] [DOC: 9235156] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:02:39] [DOC: 9235156] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:02:39] [DOC: 9235156] ✅ Patient data written to CSV: Frank Edwards | Sex: MALE | Age: 83 | Service: RN, LPN | Payer: Medicare | MRN: 6396009
[07:02:39] ✅    ✅ Document 9235156 processed and saved successfully
[07:02:39] 🔄 
🔄 Step 8: Saving API details...
[07:02:39] [DOC: 9235156] ℹ️  API push details saved for document 9235156
[07:02:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235153                         ║
================================================================================
[07:02:39] ℹ️  Agency: Dartmouth HH
[07:02:39] ℹ️  Date: 04/11/2025
[07:02:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:02:40] [DOC: 9235153] ✅ Text extracted using pdfplumber (1785 chars)
[07:02:40] ✅    ✅ Text extracted using pdfplumber (1785 chars)
[07:02:40] 🔄 
🔄 Step 2: Extracting patient data...
[07:02:43] ℹ️  AI extracted raw sex value: 'M'
[07:02:43] ℹ️  AI extracted service line: 'OT, RN, LPN'
[07:02:43] ℹ️  AI extracted payer source: 'Medicare'
[07:02:43] ℹ️  AI extracted diagnoses:
[07:02:43] ℹ️    - Diagnosis 1: ''
[07:02:43] ℹ️    - Diagnosis 2: ''
[07:02:43] ℹ️    - Diagnosis 3: ''
[07:02:43] ℹ️    - Diagnosis 4: ''
[07:02:43] ℹ️    - Diagnosis 5: ''
[07:02:43] ℹ️    - Diagnosis 6: ''
[07:02:43] ℹ️  Final extracted MRN: '1556015'
[07:02:43] ℹ️  Final extracted Sex: 'MALE'
[07:02:43] ℹ️  Final extracted Service Line: 'OT, RN, LPN'
[07:02:43] ℹ️  Final extracted Payer Source: 'Medicare'
[07:02:43] ✅ Patient data extraction completed successfully
[07:02:43] ✅    ✅ Patient data extracted successfully
[07:02:43] 📊 Patient Response
     └─ patientFName: Andrew
     └─ patientLName: Reuter
     └─ dob: 07/06/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 1556015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:02:43] ✅    ✅ Patient identified: Andrew Reuter
[07:02:43] ✅    ✅ Patient name validation passed
[07:02:43] 🔄 
🔄 Step 3: Processing patient dates...
[07:02:43] [DOC: 9235153] ℹ️  DOB normalized: 07/06/1927
[07:02:43] [DOC: 9235153] ℹ️  Episode startOfCare normalized: 03/26/2025
[07:02:43] [DOC: 9235153] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[07:02:43] [DOC: 9235153] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[07:02:43] [DOC: 9235153] ✅ Patient date processing completed successfully
[07:02:43] ✅    ✅ Date processing completed
[07:02:43] 📊 Processed Patient Data
     └─ patientFName: Andrew
     └─ patientLName: Reuter
     └─ dob: 07/06/1927
     └─ patientSex: MALE
     └─ medicalRecordNo: 1556015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN, LPN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:02:43] 🔄 
🔄 Step 4: Extracting order data...
[07:02:46] ℹ️  Order extraction - MRN: ''
[07:02:46] ℹ️  Order extraction - Sex: 'MALE'
[07:02:46] ℹ️  Order extraction - Service Line: 'OT, RN, LPN'
[07:02:46] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:02:46] ✅ Order data extraction completed successfully
[07:02:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:02:46] ℹ️  Using MRN from patient data: '1556015'
[07:02:46] ℹ️  Service line consistent in both sources: 'OT, RN, LPN'
[07:02:46] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:02:46] ✅ Patient name cross-validation successful
[07:02:46] ✅    ✅ Data merged successfully
[07:02:47] ✅    ✅ Order data extracted and validated
[07:02:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:03:06] [DOC: 9235153] ✅ Patient exists in API: Andrew Reuter, ID: eab2bd6e-c7d2-415b-8478-644eb6f28ec1
[07:03:06] ✅    ✅ Existing patient found with ID: eab2bd6e-c7d2-415b-8478-644eb6f28ec1
[07:03:06] 🔄 
🔄 Step 6: Pushing order to API...
[07:03:06] [DOC: 9235153] ℹ️  Pushing order via API for patient ID: eab2bd6e-c7d2-415b-8478-644eb6f28ec1
[07:03:07] [DOC: 9235153] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13164"}
[07:03:07] ❌    ❌ Failed to push order
[07:03:07] 🔄 
🔄 Step 7: Writing to CSV...
[07:03:07] [DOC: 9235153] ℹ️  Calculated age: 97 from DOB: 07/06/1927
[07:03:07] [DOC: 9235153] ℹ️  Service Line extracted: 'OT, RN, LPN'
[07:03:07] [DOC: 9235153] ℹ️  Payer Source extracted: 'Medicare'
[07:03:07] [DOC: 9235153] ℹ️  Diagnosis codes being written:
[07:03:07] [DOC: 9235153] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:03:07] [DOC: 9235153] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:03:07] [DOC: 9235153] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:03:07] [DOC: 9235153] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:03:07] [DOC: 9235153] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:03:07] [DOC: 9235153] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:03:07] [DOC: 9235153] ✅ Patient data written to CSV: Andrew Reuter | Sex: MALE | Age: 97 | Service: OT, RN, LPN | Payer: Medicare | MRN: 1556015
[07:03:07] ✅    ✅ Document 9235153 processed and saved successfully
[07:03:07] 🔄 
🔄 Step 8: Saving API details...
[07:03:07] [DOC: 9235153] ℹ️  API push details saved for document 9235153
[07:03:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235119                         ║
================================================================================
[07:03:07] ℹ️  Agency: Dartmouth HH
[07:03:07] ℹ️  Date: 04/11/2025
[07:03:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:03:09] [DOC: 9235119] ✅ Text extracted using pdfplumber (1034 chars)
[07:03:09] ✅    ✅ Text extracted using pdfplumber (1034 chars)
[07:03:09] 🔄 
🔄 Step 2: Extracting patient data...
[07:03:12] ℹ️  AI extracted raw sex value: 'F'
[07:03:12] ℹ️  AI extracted service line: 'Skilled Nursing'
[07:03:12] ℹ️  AI extracted payer source: 'Medicare'
[07:03:12] ℹ️  AI extracted diagnoses:
[07:03:12] ℹ️    - Diagnosis 1: ''
[07:03:12] ℹ️    - Diagnosis 2: ''
[07:03:12] ℹ️    - Diagnosis 3: ''
[07:03:12] ℹ️    - Diagnosis 4: ''
[07:03:12] ℹ️    - Diagnosis 5: ''
[07:03:12] ℹ️    - Diagnosis 6: ''
[07:03:12] ℹ️  Final extracted MRN: '323014'
[07:03:12] ℹ️  Final extracted Sex: 'FEMALE'
[07:03:12] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[07:03:12] ℹ️  Final extracted Payer Source: 'Medicare'
[07:03:12] ✅ Patient data extraction completed successfully
[07:03:12] ✅    ✅ Patient data extracted successfully
[07:03:12] 📊 Patient Response
     └─ patientFName: Sandra
     └─ patientLName: Plissey
     └─ dob: 11/19/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 323014
     └─ billingProvider: Shan Qin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/07/2024', 'startOfEpisode': '02/04/2025', 'endOfEpisode': '04/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:03:12] ✅    ✅ Patient identified: Sandra Plissey
[07:03:12] ✅    ✅ Patient name validation passed
[07:03:12] 🔄 
🔄 Step 3: Processing patient dates...
[07:03:12] [DOC: 9235119] ℹ️  DOB normalized: 11/19/1943
[07:03:12] [DOC: 9235119] ℹ️  Episode startOfCare normalized: 10/07/2024
[07:03:12] [DOC: 9235119] ℹ️  Episode startOfEpisode normalized: 02/04/2025
[07:03:12] [DOC: 9235119] ℹ️  Episode endOfEpisode normalized: 04/04/2025
[07:03:12] [DOC: 9235119] ✅ Patient date processing completed successfully
[07:03:12] ✅    ✅ Date processing completed
[07:03:12] 📊 Processed Patient Data
     └─ patientFName: Sandra
     └─ patientLName: Plissey
     └─ dob: 11/19/1943
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 323014
     └─ billingProvider: Shan Qin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/07/2024', 'startOfEpisode': '02/04/2025', 'endOfEpisode': '04/04/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:03:12] 🔄 
🔄 Step 4: Extracting order data...
[07:03:14] ℹ️  Order extraction - MRN: ''
[07:03:14] ℹ️  Order extraction - Sex: 'FEMALE'
[07:03:14] ℹ️  Order extraction - Service Line: 'RN'
[07:03:14] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:03:14] ✅ Order data extraction completed successfully
[07:03:14] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:03:14] ℹ️  Using MRN from patient data: '323014'
[07:03:14] ℹ️  Combined service lines: Patient='Skilled Nursing' + Order='RN' = 'RN, Skilled Nursing'
[07:03:14] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:03:14] ✅ Patient name cross-validation successful
[07:03:14] ✅    ✅ Data merged successfully
[07:03:15] ✅    ✅ Order data extracted and validated
[07:03:15] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:03:15] [DOC: 9235119] ✅ Patient found in local cache: Sandra Plissey, ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[07:03:15] ✅    ✅ Existing patient found with ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[07:03:15] 🔄 
🔄 Step 6: Pushing order to API...
[07:03:15] [DOC: 9235119] ℹ️  Pushing order via API for patient ID: 89dd9480-4975-4667-be64-0e2aac1bbc23
[07:03:16] [DOC: 9235119] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13081"}
[07:03:16] ❌    ❌ Failed to push order
[07:03:16] 🔄 
🔄 Step 7: Writing to CSV...
[07:03:16] [DOC: 9235119] ℹ️  Calculated age: 81 from DOB: 11/19/1943
[07:03:16] [DOC: 9235119] ℹ️  Service Line extracted: 'RN, Skilled Nursing'
[07:03:16] [DOC: 9235119] ℹ️  Payer Source extracted: 'Medicare'
[07:03:16] [DOC: 9235119] ℹ️  Diagnosis codes being written:
[07:03:16] [DOC: 9235119] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:03:16] [DOC: 9235119] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:03:16] [DOC: 9235119] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:03:16] [DOC: 9235119] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:03:16] [DOC: 9235119] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:03:16] [DOC: 9235119] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:03:16] [DOC: 9235119] ✅ Patient data written to CSV: Sandra Plissey | Sex: FEMALE | Age: 81 | Service: RN, Skilled Nursing | Payer: Medicare | MRN: 323014
[07:03:16] ✅    ✅ Document 9235119 processed and saved successfully
[07:03:16] 🔄 
🔄 Step 8: Saving API details...
[07:03:16] [DOC: 9235119] ℹ️  API push details saved for document 9235119
[07:03:16] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235095                         ║
================================================================================
[07:03:16] ℹ️  Agency: Dartmouth HH
[07:03:16] ℹ️  Date: 04/11/2025
[07:03:16] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:03:18] [DOC: 9235095] ✅ Text extracted using pdfplumber (1091 chars)
[07:03:18] ✅    ✅ Text extracted using pdfplumber (1091 chars)
[07:03:18] 🔄 
🔄 Step 2: Extracting patient data...
[07:03:21] ℹ️  AI extracted raw sex value: 'F'
[07:03:21] ℹ️  AI extracted service line: 'Skilled Nursing'
[07:03:21] ℹ️  AI extracted payer source: 'Medicare'
[07:03:21] ℹ️  AI extracted diagnoses:
[07:03:21] ℹ️    - Diagnosis 1: ''
[07:03:21] ℹ️    - Diagnosis 2: ''
[07:03:21] ℹ️    - Diagnosis 3: ''
[07:03:21] ℹ️    - Diagnosis 4: ''
[07:03:21] ℹ️    - Diagnosis 5: ''
[07:03:21] ℹ️    - Diagnosis 6: ''
[07:03:21] ℹ️  Final extracted MRN: '3320011'
[07:03:21] ℹ️  Final extracted Sex: 'FEMALE'
[07:03:21] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[07:03:21] ℹ️  Final extracted Payer Source: 'Medicare'
[07:03:21] ✅ Patient data extraction completed successfully
[07:03:21] ✅    ✅ Patient data extracted successfully
[07:03:21] 📊 Patient Response
     └─ patientFName: Bonnie
     └─ patientLName: Werly
     └─ dob: 06/16/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3320011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 239 Cross Rd Autumn Glen at Dartmouth Apt 219
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:03:21] ✅    ✅ Patient identified: Bonnie Werly
[07:03:21] ✅    ✅ Patient name validation passed
[07:03:21] 🔄 
🔄 Step 3: Processing patient dates...
[07:03:21] [DOC: 9235095] ℹ️  DOB normalized: 06/16/1939
[07:03:21] [DOC: 9235095] ℹ️  Episode startOfCare normalized: 09/01/2024
[07:03:21] [DOC: 9235095] ℹ️  Episode startOfEpisode normalized: 02/28/2025
[07:03:21] [DOC: 9235095] ℹ️  Episode endOfEpisode normalized: 04/28/2025
[07:03:21] [DOC: 9235095] ✅ Patient date processing completed successfully
[07:03:21] ✅    ✅ Date processing completed
[07:03:21] 📊 Processed Patient Data
     └─ patientFName: Bonnie
     └─ patientLName: Werly
     └─ dob: 06/16/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3320011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 239 Cross Rd Autumn Glen at Dartmouth Apt 219
     └─ city: Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '09/01/2024', 'startOfEpisode': '02/28/2025', 'endOfEpisode': '04/28/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:03:21] 🔄 
🔄 Step 4: Extracting order data...
[07:03:23] ℹ️  Order extraction - MRN: ''
[07:03:23] ℹ️  Order extraction - Sex: 'FEMALE'
[07:03:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[07:03:23] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:03:23] ✅ Order data extraction completed successfully
[07:03:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:03:23] ℹ️  Using MRN from patient data: '3320011'
[07:03:23] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[07:03:23] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:03:23] ✅ Patient name cross-validation successful
[07:03:23] ✅    ✅ Data merged successfully
[07:03:25] ✅    ✅ Order data extracted and validated
[07:03:25] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:03:25] [DOC: 9235095] ✅ Patient found in local cache: Bonnie Werly, ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[07:03:25] ✅    ✅ Existing patient found with ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[07:03:25] 🔄 
🔄 Step 6: Pushing order to API...
[07:03:25] [DOC: 9235095] ℹ️  Pushing order via API for patient ID: 24e0626e-85c6-49fe-aa51-0da969434f71
[07:03:26] [DOC: 9235095] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14422"}
[07:03:26] ❌    ❌ Failed to push order
[07:03:26] 🔄 
🔄 Step 7: Writing to CSV...
[07:03:26] [DOC: 9235095] ℹ️  Calculated age: 85 from DOB: 06/16/1939
[07:03:26] [DOC: 9235095] ℹ️  Service Line extracted: 'Skilled Nursing'
[07:03:26] [DOC: 9235095] ℹ️  Payer Source extracted: 'Medicare'
[07:03:26] [DOC: 9235095] ℹ️  Diagnosis codes being written:
[07:03:26] [DOC: 9235095] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:03:26] [DOC: 9235095] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:03:26] [DOC: 9235095] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:03:26] [DOC: 9235095] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:03:26] [DOC: 9235095] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:03:26] [DOC: 9235095] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:03:26] [DOC: 9235095] ✅ Patient data written to CSV: Bonnie Werly | Sex: FEMALE | Age: 85 | Service: Skilled Nursing | Payer: Medicare | MRN: 3320011
[07:03:26] ✅    ✅ Document 9235095 processed and saved successfully
[07:03:26] 🔄 
🔄 Step 8: Saving API details...
[07:03:26] [DOC: 9235095] ℹ️  API push details saved for document 9235095
[07:03:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235090                         ║
================================================================================
[07:03:26] ℹ️  Agency: Dartmouth HH
[07:03:26] ℹ️  Date: 04/11/2025
[07:03:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:03:28] [DOC: 9235090] ✅ Text extracted using pdfplumber (1242 chars)
[07:03:28] ✅    ✅ Text extracted using pdfplumber (1242 chars)
[07:03:28] 🔄 
🔄 Step 2: Extracting patient data...
[07:03:31] ℹ️  AI extracted raw sex value: 'F'
[07:03:31] ℹ️  AI extracted service line: 'PT'
[07:03:31] ℹ️  AI extracted payer source: 'Medicare'
[07:03:31] ℹ️  AI extracted diagnoses:
[07:03:31] ℹ️    - Diagnosis 1: ''
[07:03:31] ℹ️    - Diagnosis 2: ''
[07:03:31] ℹ️    - Diagnosis 3: ''
[07:03:31] ℹ️    - Diagnosis 4: ''
[07:03:31] ℹ️    - Diagnosis 5: ''
[07:03:31] ℹ️    - Diagnosis 6: ''
[07:03:31] ℹ️  Final extracted MRN: '6267009'
[07:03:31] ℹ️  Final extracted Sex: 'FEMALE'
[07:03:31] ℹ️  Final extracted Service Line: 'PT'
[07:03:31] ℹ️  Final extracted Payer Source: 'Medicare'
[07:03:31] ✅ Patient data extraction completed successfully
[07:03:31] ✅    ✅ Patient data extracted successfully
[07:03:31] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Finni
     └─ dob: 04/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6267009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:03:31] ✅    ✅ Patient identified: Donna Finni
[07:03:31] ✅    ✅ Patient name validation passed
[07:03:31] 🔄 
🔄 Step 3: Processing patient dates...
[07:03:31] [DOC: 9235090] ℹ️  DOB normalized: 04/04/1955
[07:03:31] [DOC: 9235090] ℹ️  Episode startOfCare normalized: 03/19/2025
[07:03:31] [DOC: 9235090] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[07:03:31] [DOC: 9235090] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[07:03:31] [DOC: 9235090] ✅ Patient date processing completed successfully
[07:03:31] ✅    ✅ Date processing completed
[07:03:31] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Finni
     └─ dob: 04/04/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6267009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/19/2025', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:03:31] 🔄 
🔄 Step 4: Extracting order data...
[07:03:33] ℹ️  Order extraction - MRN: ''
[07:03:33] ℹ️  Order extraction - Sex: 'FEMALE'
[07:03:33] ℹ️  Order extraction - Service Line: 'PT'
[07:03:33] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:03:33] ✅ Order data extraction completed successfully
[07:03:33] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:03:33] ℹ️  Using MRN from patient data: '6267009'
[07:03:33] ℹ️  Service line consistent in both sources: 'PT'
[07:03:33] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:03:33] ✅ Patient name cross-validation successful
[07:03:33] ✅    ✅ Data merged successfully
[07:03:35] ✅    ✅ Order data extracted and validated
[07:03:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:03:41] [DOC: 9235090] ℹ️  Patient not found in cache or API: Donna Finni
[07:03:41] [DOC: 9235090] ℹ️  Patient not found, creating new patient via API...
[07:03:41] [DOC: 9235090] ℹ️  Creating patient via API: Donna Finni
[07:03:42] [DOC: 9235090] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[07:03:42] ❌    ❌ Failed to create patient
[07:03:42] [DOC: 9235090] ℹ️  API push details saved for document 9235090
================================================================================
║                        Processing Document ID: 9235087                         ║
================================================================================
[07:03:42] ℹ️  Agency: Dartmouth HH
[07:03:42] ℹ️  Date: 04/11/2025
[07:03:42] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:03:44] [DOC: 9235087] ✅ Text extracted using pdfplumber (1136 chars)
[07:03:44] ✅    ✅ Text extracted using pdfplumber (1136 chars)
[07:03:44] 🔄 
🔄 Step 2: Extracting patient data...
[07:03:46] ℹ️  AI extracted raw sex value: 'F'
[07:03:46] ℹ️  AI extracted service line: 'RN'
[07:03:46] ℹ️  AI extracted payer source: 'Medicare'
[07:03:46] ℹ️  AI extracted diagnoses:
[07:03:46] ℹ️    - Diagnosis 1: 'None'
[07:03:46] ℹ️    - Diagnosis 2: 'None'
[07:03:46] ℹ️    - Diagnosis 3: 'None'
[07:03:46] ℹ️    - Diagnosis 4: 'None'
[07:03:46] ℹ️    - Diagnosis 5: 'None'
[07:03:46] ℹ️    - Diagnosis 6: 'None'
[07:03:46] ℹ️  Final extracted MRN: '5915015'
[07:03:46] ℹ️  Final extracted Sex: 'FEMALE'
[07:03:46] ℹ️  Final extracted Service Line: 'RN'
[07:03:46] ℹ️  Final extracted Payer Source: 'Medicare'
[07:03:46] ✅ Patient data extraction completed successfully
[07:03:46] ✅    ✅ Patient data extracted successfully
[07:03:46] 📊 Patient Response
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/26/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[07:03:46] ✅    ✅ Patient identified: Suzanne Fawcett
[07:03:46] ✅    ✅ Patient name validation passed
[07:03:46] 🔄 
🔄 Step 3: Processing patient dates...
[07:03:46] [DOC: 9235087] ℹ️  DOB normalized: 12/08/1939
[07:03:46] [DOC: 9235087] ℹ️  Episode startOfCare normalized: 01/26/2025
[07:03:46] [DOC: 9235087] ℹ️  Episode startOfEpisode normalized: 01/26/2025
[07:03:46] [DOC: 9235087] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[07:03:46] [DOC: 9235087] ✅ Patient date processing completed successfully
[07:03:46] ✅    ✅ Date processing completed
[07:03:46] 📊 Processed Patient Data
     └─ patientFName: Suzanne
     └─ patientLName: Fawcett
     └─ dob: 12/08/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5915015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/26/2025', 'startOfEpisode': '01/26/2025', 'endOfEpisode': '05/25/2025'}]
[07:03:46] 🔄 
🔄 Step 4: Extracting order data...
[07:03:49] ℹ️  Order extraction - MRN: ''
[07:03:49] ℹ️  Order extraction - Sex: 'FEMALE'
[07:03:49] ℹ️  Order extraction - Service Line: ''
[07:03:49] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:03:49] ✅ Order data extraction completed successfully
[07:03:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:03:49] ℹ️  Using MRN from patient data: '5915015'
[07:03:49] ℹ️  Using service line from patient data: 'RN'
[07:03:49] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:03:49] ✅ Patient name cross-validation successful
[07:03:49] ✅    ✅ Data merged successfully
[07:03:50] ✅    ✅ Order data extracted and validated
[07:03:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:04:01] [DOC: 9235087] ℹ️  Patient not found in cache or API: Suzanne Fawcett
[07:04:01] [DOC: 9235087] ℹ️  Patient not found, creating new patient via API...
[07:04:01] [DOC: 9235087] ℹ️  Creating patient via API: Suzanne Fawcett
[07:04:02] [DOC: 9235087] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[07:04:02] ❌    ❌ Failed to create patient
[07:04:02] [DOC: 9235087] ℹ️  API push details saved for document 9235087
================================================================================
║                        Processing Document ID: 9235083                         ║
================================================================================
[07:04:02] ℹ️  Agency: Dartmouth HH
[07:04:02] ℹ️  Date: 04/11/2025
[07:04:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:04:05] [DOC: 9235083] ✅ Text extracted using pdfplumber (1172 chars)
[07:04:05] ✅    ✅ Text extracted using pdfplumber (1172 chars)
[07:04:05] 🔄 
🔄 Step 2: Extracting patient data...
[07:04:08] ℹ️  AI extracted raw sex value: 'F'
[07:04:08] ℹ️  AI extracted service line: 'RN, LPN'
[07:04:08] ℹ️  AI extracted payer source: 'Tufts Health Plan Senior Care Options'
[07:04:08] ℹ️  AI extracted diagnoses:
[07:04:08] ℹ️    - Diagnosis 1: ''
[07:04:08] ℹ️    - Diagnosis 2: ''
[07:04:08] ℹ️    - Diagnosis 3: ''
[07:04:08] ℹ️    - Diagnosis 4: ''
[07:04:08] ℹ️    - Diagnosis 5: ''
[07:04:08] ℹ️    - Diagnosis 6: ''
[07:04:08] ℹ️  Final extracted MRN: '7624009'
[07:04:08] ℹ️  Final extracted Sex: 'FEMALE'
[07:04:08] ℹ️  Final extracted Service Line: 'RN, LPN'
[07:04:08] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Senior Care Options'
[07:04:08] ✅ Patient data extraction completed successfully
[07:04:08] ✅    ✅ Patient data extracted successfully
[07:04:08] 📊 Patient Response
     └─ patientFName: Irene
     └─ patientLName: Peets
     └─ dob: 05/25/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7624009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Tufts Health Plan Senior Care Options
     └─ episodeDiagnoses: [{'startOfCare': '12/17/2024', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '04/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:04:08] ✅    ✅ Patient identified: Irene Peets
[07:04:08] ✅    ✅ Patient name validation passed
[07:04:08] 🔄 
🔄 Step 3: Processing patient dates...
[07:04:08] [DOC: 9235083] ℹ️  DOB normalized: 05/25/1939
[07:04:08] [DOC: 9235083] ℹ️  Episode startOfCare normalized: 12/17/2024
[07:04:08] [DOC: 9235083] ℹ️  Episode startOfEpisode normalized: 02/15/2025
[07:04:08] [DOC: 9235083] ℹ️  Episode endOfEpisode normalized: 04/15/2025
[07:04:08] [DOC: 9235083] ✅ Patient date processing completed successfully
[07:04:08] ✅    ✅ Date processing completed
[07:04:08] 📊 Processed Patient Data
     └─ patientFName: Irene
     └─ patientLName: Peets
     └─ dob: 05/25/1939
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7624009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Tufts Health Plan Senior Care Options
     └─ episodeDiagnoses: [{'startOfCare': '12/17/2024', 'startOfEpisode': '02/15/2025', 'endOfEpisode': '04/15/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:04:08] 🔄 
🔄 Step 4: Extracting order data...
[07:04:11] ℹ️  Order extraction - MRN: ''
[07:04:11] ℹ️  Order extraction - Sex: 'FEMALE'
[07:04:11] ℹ️  Order extraction - Service Line: 'RN, LPN'
[07:04:11] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Senior Care Options'
[07:04:11] ✅ Order data extraction completed successfully
[07:04:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:04:11] ℹ️  Using MRN from patient data: '7624009'
[07:04:11] ℹ️  Service line consistent in both sources: 'RN, LPN'
[07:04:11] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Senior Care Options'
[07:04:11] ✅ Patient name cross-validation successful
[07:04:11] ✅    ✅ Data merged successfully
[07:04:12] ✅    ✅ Order data extracted and validated
[07:04:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:04:19] [DOC: 9235083] ✅ Patient exists in API: Irene Peets, ID: 03f1aa96-fe5b-46f5-919c-dec9f08aa07a
[07:04:19] ✅    ✅ Existing patient found with ID: 03f1aa96-fe5b-46f5-919c-dec9f08aa07a
[07:04:19] 🔄 
🔄 Step 6: Pushing order to API...
[07:04:19] [DOC: 9235083] ℹ️  Pushing order via API for patient ID: 03f1aa96-fe5b-46f5-919c-dec9f08aa07a
[07:04:20] [DOC: 9235083] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12998"}
[07:04:20] ❌    ❌ Failed to push order
[07:04:20] 🔄 
🔄 Step 7: Writing to CSV...
[07:04:20] [DOC: 9235083] ℹ️  Calculated age: 86 from DOB: 05/25/1939
[07:04:20] [DOC: 9235083] ℹ️  Service Line extracted: 'RN, LPN'
[07:04:20] [DOC: 9235083] ℹ️  Payer Source extracted: 'Tufts Health Plan Senior Care Options'
[07:04:20] [DOC: 9235083] ℹ️  Diagnosis codes being written:
[07:04:20] [DOC: 9235083] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:04:20] [DOC: 9235083] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:04:20] [DOC: 9235083] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:04:20] [DOC: 9235083] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:04:20] [DOC: 9235083] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:04:20] [DOC: 9235083] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:04:20] [DOC: 9235083] ✅ Patient data written to CSV: Irene Peets | Sex: FEMALE | Age: 86 | Service: RN, LPN | Payer: Tufts Health Plan Senior Care Options | MRN: 7624009
[07:04:20] ✅    ✅ Document 9235083 processed and saved successfully
[07:04:20] 🔄 
🔄 Step 8: Saving API details...
[07:04:20] [DOC: 9235083] ℹ️  API push details saved for document 9235083
[07:04:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235077                         ║
================================================================================
[07:04:20] ℹ️  Agency: Dartmouth HH
[07:04:20] ℹ️  Date: 04/11/2025
[07:04:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:04:22] [DOC: 9235077] ✅ Text extracted using pdfplumber (4801 chars)
[07:04:22] ✅    ✅ Text extracted using pdfplumber (4801 chars)
[07:04:22] 🔄 
🔄 Step 2: Extracting patient data...
[07:04:25] ℹ️  AI extracted raw sex value: 'M'
[07:04:25] ℹ️  AI extracted service line: 'OT'
[07:04:25] ℹ️  AI extracted payer source: 'Medicare'
[07:04:25] ℹ️  AI extracted diagnoses:
[07:04:25] ℹ️    - Diagnosis 1: ''
[07:04:25] ℹ️    - Diagnosis 2: ''
[07:04:25] ℹ️    - Diagnosis 3: ''
[07:04:25] ℹ️    - Diagnosis 4: ''
[07:04:25] ℹ️    - Diagnosis 5: ''
[07:04:25] ℹ️    - Diagnosis 6: ''
[07:04:25] ℹ️  Final extracted MRN: '5671015'
[07:04:25] ℹ️  Final extracted Sex: 'MALE'
[07:04:25] ℹ️  Final extracted Service Line: 'OT'
[07:04:25] ℹ️  Final extracted Payer Source: 'Medicare'
[07:04:25] ✅ Patient data extraction completed successfully
[07:04:25] ✅    ✅ Patient data extracted successfully
[07:04:25] 📊 Patient Response
     └─ patientFName: James
     └─ patientLName: Osborne
     └─ dob: 10/21/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 5671015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '03/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:04:25] ✅    ✅ Patient identified: James Osborne
[07:04:25] ✅    ✅ Patient name validation passed
[07:04:25] 🔄 
🔄 Step 3: Processing patient dates...
[07:04:25] [DOC: 9235077] ℹ️  DOB normalized: 10/21/1940
[07:04:25] [DOC: 9235077] ℹ️  Episode startOfCare normalized: 03/27/2025
[07:04:25] [DOC: 9235077] ℹ️  Episode startOfEpisode normalized: 03/05/2025
[07:04:25] [DOC: 9235077] ℹ️  Episode endOfEpisode normalized: 03/08/2025
[07:04:25] [DOC: 9235077] ✅ Patient date processing completed successfully
[07:04:25] ✅    ✅ Date processing completed
[07:04:25] 📊 Processed Patient Data
     └─ patientFName: James
     └─ patientLName: Osborne
     └─ dob: 10/21/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 5671015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '03/08/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:04:25] 🔄 
🔄 Step 4: Extracting order data...
[07:04:28] ℹ️  Order extraction - MRN: ''
[07:04:28] ℹ️  Order extraction - Sex: 'MALE'
[07:04:28] ℹ️  Order extraction - Service Line: 'OT'
[07:04:28] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:04:28] ✅ Order data extraction completed successfully
[07:04:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:04:28] ℹ️  Using MRN from patient data: '5671015'
[07:04:28] ℹ️  Service line consistent in both sources: 'OT'
[07:04:28] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:04:28] ✅ Patient name cross-validation successful
[07:04:28] ✅    ✅ Data merged successfully
[07:04:29] ✅    ✅ Order data extracted and validated
[07:04:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:04:29] [DOC: 9235077] ✅ Patient found in local cache: James Osborne, ID: 626fa335-2595-4b1c-a092-9ed6ec28b9aa
[07:04:29] ✅    ✅ Existing patient found with ID: 626fa335-2595-4b1c-a092-9ed6ec28b9aa
[07:04:29] 🔄 
🔄 Step 6: Pushing order to API...
[07:04:29] [DOC: 9235077] ℹ️  Pushing order via API for patient ID: 626fa335-2595-4b1c-a092-9ed6ec28b9aa
[07:04:30] [DOC: 9235077] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:04:30] ❌    ❌ Failed to push order
[07:04:30] 🔄 
🔄 Step 7: Writing to CSV...
[07:04:30] [DOC: 9235077] ℹ️  Calculated age: 84 from DOB: 10/21/1940
[07:04:30] [DOC: 9235077] ℹ️  Service Line extracted: 'OT'
[07:04:30] [DOC: 9235077] ℹ️  Payer Source extracted: 'Medicare'
[07:04:30] [DOC: 9235077] ℹ️  Diagnosis codes being written:
[07:04:30] [DOC: 9235077] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:04:30] [DOC: 9235077] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:04:30] [DOC: 9235077] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:04:30] [DOC: 9235077] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:04:30] [DOC: 9235077] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:04:30] [DOC: 9235077] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:04:30] [DOC: 9235077] ✅ Patient data written to CSV: James Osborne | Sex: MALE | Age: 84 | Service: OT | Payer: Medicare | MRN: 5671015
[07:04:30] ✅    ✅ Document 9235077 processed and saved successfully
[07:04:30] 🔄 
🔄 Step 8: Saving API details...
[07:04:30] [DOC: 9235077] ℹ️  API push details saved for document 9235077
[07:04:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235076                         ║
================================================================================
[07:04:30] ℹ️  Agency: Dartmouth HH
[07:04:30] ℹ️  Date: 04/11/2025
[07:04:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:04:32] [DOC: 9235076] ✅ Text extracted using pdfplumber (1893 chars)
[07:04:32] ✅    ✅ Text extracted using pdfplumber (1893 chars)
[07:04:32] 🔄 
🔄 Step 2: Extracting patient data...
[07:04:35] ℹ️  AI extracted raw sex value: 'F'
[07:04:35] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[07:04:35] ℹ️  AI extracted payer source: 'Medicare'
[07:04:35] ℹ️  AI extracted diagnoses:
[07:04:35] ℹ️    - Diagnosis 1: ''
[07:04:35] ℹ️    - Diagnosis 2: ''
[07:04:35] ℹ️    - Diagnosis 3: ''
[07:04:35] ℹ️    - Diagnosis 4: ''
[07:04:35] ℹ️    - Diagnosis 5: ''
[07:04:35] ℹ️    - Diagnosis 6: ''
[07:04:35] ℹ️  Final extracted MRN: '7027009'
[07:04:35] ℹ️  Final extracted Sex: 'FEMALE'
[07:04:35] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[07:04:35] ℹ️  Final extracted Payer Source: 'Medicare'
[07:04:35] ✅ Patient data extraction completed successfully
[07:04:35] ✅    ✅ Patient data extracted successfully
[07:04:35] 📊 Patient Response
     └─ patientFName: Adelaide
     └─ patientLName: Ferro
     └─ dob: 11/03/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7027009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '03/08/2025', 'endOfEpisode': '05/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:04:35] ✅    ✅ Patient identified: Adelaide Ferro
[07:04:35] ✅    ✅ Patient name validation passed
[07:04:35] 🔄 
🔄 Step 3: Processing patient dates...
[07:04:35] [DOC: 9235076] ℹ️  DOB normalized: 11/03/1933
[07:04:35] [DOC: 9235076] ℹ️  Episode startOfCare normalized: 03/08/2025
[07:04:35] [DOC: 9235076] ℹ️  Episode startOfEpisode normalized: 03/08/2025
[07:04:35] [DOC: 9235076] ℹ️  Episode endOfEpisode normalized: 05/06/2025
[07:04:35] [DOC: 9235076] ✅ Patient date processing completed successfully
[07:04:35] ✅    ✅ Date processing completed
[07:04:35] 📊 Processed Patient Data
     └─ patientFName: Adelaide
     └─ patientLName: Ferro
     └─ dob: 11/03/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 7027009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '03/08/2025', 'endOfEpisode': '05/06/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:04:35] 🔄 
🔄 Step 4: Extracting order data...
[07:04:37] ℹ️  Order extraction - MRN: ''
[07:04:37] ℹ️  Order extraction - Sex: 'FEMALE'
[07:04:37] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT'
[07:04:37] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:04:37] ✅ Order data extraction completed successfully
[07:04:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:04:37] ℹ️  Using MRN from patient data: '7027009'
[07:04:37] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT'
[07:04:37] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:04:37] ✅ Patient name cross-validation successful
[07:04:37] ✅    ✅ Data merged successfully
[07:04:38] ✅    ✅ Order data extracted and validated
[07:04:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:04:44] [DOC: 9235076] ✅ Patient exists in API: Adelaide Ferro, ID: 7e684eab-6432-431e-a991-a8994f0c555b
[07:04:44] ✅    ✅ Existing patient found with ID: 7e684eab-6432-431e-a991-a8994f0c555b
[07:04:44] 🔄 
🔄 Step 6: Pushing order to API...
[07:04:44] [DOC: 9235076] ℹ️  Pushing order via API for patient ID: 7e684eab-6432-431e-a991-a8994f0c555b
[07:04:45] [DOC: 9235076] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:04:45] ❌    ❌ Failed to push order
[07:04:45] 🔄 
🔄 Step 7: Writing to CSV...
[07:04:45] [DOC: 9235076] ℹ️  Calculated age: 91 from DOB: 11/03/1933
[07:04:45] [DOC: 9235076] ℹ️  Service Line extracted: 'Skilled Nursing, PT'
[07:04:45] [DOC: 9235076] ℹ️  Payer Source extracted: 'Medicare'
[07:04:45] [DOC: 9235076] ℹ️  Diagnosis codes being written:
[07:04:45] [DOC: 9235076] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:04:45] [DOC: 9235076] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:04:45] [DOC: 9235076] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:04:45] [DOC: 9235076] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:04:45] [DOC: 9235076] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:04:45] [DOC: 9235076] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:04:45] [DOC: 9235076] ✅ Patient data written to CSV: Adelaide Ferro | Sex: FEMALE | Age: 91 | Service: Skilled Nursing, PT | Payer: Medicare | MRN: 7027009
[07:04:45] ✅    ✅ Document 9235076 processed and saved successfully
[07:04:45] 🔄 
🔄 Step 8: Saving API details...
[07:04:45] [DOC: 9235076] ℹ️  API push details saved for document 9235076
[07:04:45] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235074                         ║
================================================================================
[07:04:45] ℹ️  Agency: Dartmouth HH
[07:04:45] ℹ️  Date: 04/11/2025
[07:04:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:04:48] [DOC: 9235074] ✅ Text extracted using pdfplumber (3910 chars)
[07:04:48] ✅    ✅ Text extracted using pdfplumber (3910 chars)
[07:04:48] 🔄 
🔄 Step 2: Extracting patient data...
[07:04:51] ℹ️  AI extracted raw sex value: 'F'
[07:04:51] ℹ️  AI extracted service line: 'PT'
[07:04:51] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[07:04:51] ℹ️  AI extracted diagnoses:
[07:04:51] ℹ️    - Diagnosis 1: ''
[07:04:51] ℹ️    - Diagnosis 2: ''
[07:04:51] ℹ️    - Diagnosis 3: ''
[07:04:51] ℹ️    - Diagnosis 4: ''
[07:04:51] ℹ️    - Diagnosis 5: ''
[07:04:51] ℹ️    - Diagnosis 6: ''
[07:04:51] ℹ️  Final extracted MRN: '556008'
[07:04:51] ℹ️  Final extracted Sex: 'FEMALE'
[07:04:51] ℹ️  Final extracted Service Line: 'PT'
[07:04:51] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[07:04:51] ✅ Patient data extraction completed successfully
[07:04:51] ✅    ✅ Patient data extracted successfully
[07:04:51] 📊 Patient Response
     └─ patientFName: Ludovina
     └─ patientLName: Rodrigues
     └─ dob: 01/20/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 556008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:04:51] ✅    ✅ Patient identified: Ludovina Rodrigues
[07:04:51] ✅    ✅ Patient name validation passed
[07:04:51] 🔄 
🔄 Step 3: Processing patient dates...
[07:04:51] [DOC: 9235074] ℹ️  DOB normalized: 01/20/1937
[07:04:51] [DOC: 9235074] ℹ️  Episode startOfCare normalized: 03/12/2025
[07:04:51] [DOC: 9235074] ℹ️  Episode startOfEpisode normalized: 03/12/2025
[07:04:51] [DOC: 9235074] ℹ️  Episode endOfEpisode normalized: 05/10/2025
[07:04:51] [DOC: 9235074] ✅ Patient date processing completed successfully
[07:04:51] ✅    ✅ Date processing completed
[07:04:51] 📊 Processed Patient Data
     └─ patientFName: Ludovina
     └─ patientLName: Rodrigues
     └─ dob: 01/20/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 556008
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '03/12/2025', 'startOfEpisode': '03/12/2025', 'endOfEpisode': '05/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:04:51] 🔄 
🔄 Step 4: Extracting order data...
[07:04:53] ℹ️  Order extraction - MRN: ''
[07:04:53] ℹ️  Order extraction - Sex: 'FEMALE'
[07:04:53] ℹ️  Order extraction - Service Line: 'PT'
[07:04:53] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[07:04:53] ✅ Order data extraction completed successfully
[07:04:53] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:04:53] ℹ️  Using MRN from patient data: '556008'
[07:04:53] ℹ️  Service line consistent in both sources: 'PT'
[07:04:53] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[07:04:53] ✅ Patient name cross-validation successful
[07:04:53] ✅    ✅ Data merged successfully
[07:04:55] ✅    ✅ Order data extracted and validated
[07:04:55] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:05:13] [DOC: 9235074] ✅ Patient exists in API: Ludovina Rodrigues, ID: 8276e591-54df-429f-a08f-c4cd67541f11
[07:05:13] ✅    ✅ Existing patient found with ID: 8276e591-54df-429f-a08f-c4cd67541f11
[07:05:13] 🔄 
🔄 Step 6: Pushing order to API...
[07:05:13] [DOC: 9235074] ℹ️  Pushing order via API for patient ID: 8276e591-54df-429f-a08f-c4cd67541f11
[07:05:14] [DOC: 9235074] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14276"}
[07:05:14] ❌    ❌ Failed to push order
[07:05:14] 🔄 
🔄 Step 7: Writing to CSV...
[07:05:14] [DOC: 9235074] ℹ️  Calculated age: 88 from DOB: 01/20/1937
[07:05:14] [DOC: 9235074] ℹ️  Service Line extracted: 'PT'
[07:05:14] [DOC: 9235074] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[07:05:14] [DOC: 9235074] ℹ️  Diagnosis codes being written:
[07:05:14] [DOC: 9235074] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:05:14] [DOC: 9235074] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:05:14] [DOC: 9235074] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:05:14] [DOC: 9235074] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:05:14] [DOC: 9235074] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:05:14] [DOC: 9235074] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:05:14] [DOC: 9235074] ✅ Patient data written to CSV: Ludovina Rodrigues | Sex: FEMALE | Age: 88 | Service: PT | Payer: Tufts Health Plan Medicare Preferred | MRN: 556008
[07:05:14] ✅    ✅ Document 9235074 processed and saved successfully
[07:05:14] 🔄 
🔄 Step 8: Saving API details...
[07:05:14] [DOC: 9235074] ℹ️  API push details saved for document 9235074
[07:05:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235064                         ║
================================================================================
[07:05:14] ℹ️  Agency: Dartmouth HH
[07:05:14] ℹ️  Date: 04/11/2025
[07:05:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:05:17] [DOC: 9235064] ✅ Text extracted using pdfplumber (10118 chars)
[07:05:17] ✅    ✅ Text extracted using pdfplumber (10118 chars)
[07:05:17] 🔄 
🔄 Step 2: Extracting patient data...
[07:05:19] ℹ️  AI extracted raw sex value: 'M'
[07:05:19] ℹ️  AI extracted service line: 'PT'
[07:05:19] ℹ️  AI extracted payer source: ''
[07:05:19] ℹ️  AI extracted diagnoses:
[07:05:19] ℹ️    - Diagnosis 1: 'Z47.1'
[07:05:19] ℹ️    - Diagnosis 2: 'E66.3'
[07:05:19] ℹ️    - Diagnosis 3: 'Z68.26'
[07:05:19] ℹ️    - Diagnosis 4: 'R73.01'
[07:05:19] ℹ️    - Diagnosis 5: 'H91.90'
[07:05:19] ℹ️    - Diagnosis 6: 'H66.90'
[07:05:19] ℹ️  Final extracted MRN: '227027'
[07:05:19] ℹ️  Final extracted Sex: 'MALE'
[07:05:19] ℹ️  Final extracted Service Line: 'PT'
[07:05:19] ℹ️  Final extracted Payer Source: ''
[07:05:19] ✅ Patient data extraction completed successfully
[07:05:19] ✅    ✅ Patient data extracted successfully
[07:05:19] 📊 Patient Response
     └─ patientFName: Correia
     └─ patientLName: Terry
     └─ dob: 09/26/1976
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/10/2025', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '06/08/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'E66.3', 'thirdDiagnosis': 'Z68.26', 'fourthDiagnosis': 'R73.01', 'fifthDiagnosis': 'H91.90', 'sixthDiagnosis': 'H66.90'}]
[07:05:19] ✅    ✅ Patient identified: Correia Terry
[07:05:19] ✅    ✅ Patient name validation passed
[07:05:19] 🔄 
🔄 Step 3: Processing patient dates...
[07:05:19] [DOC: 9235064] ℹ️  DOB normalized: 09/26/1976
[07:05:19] [DOC: 9235064] ℹ️  Episode startOfCare normalized: 04/10/2025
[07:05:19] [DOC: 9235064] ℹ️  Episode startOfEpisode normalized: 04/10/2025
[07:05:19] [DOC: 9235064] ℹ️  Episode endOfEpisode normalized: 06/08/2025
[07:05:19] [DOC: 9235064] ✅ Patient date processing completed successfully
[07:05:19] ✅    ✅ Date processing completed
[07:05:19] 📊 Processed Patient Data
     └─ patientFName: Correia
     └─ patientLName: Terry
     └─ dob: 09/26/1976
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/10/2025', 'startOfEpisode': '04/10/2025', 'endOfEpisode': '06/08/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'E66.3', 'thirdDiagnosis': 'Z68.26', 'fourthDiagnosis': 'R73.01', 'fifthDiagnosis': 'H91.90', 'sixthDiagnosis': 'H66.90'}]
[07:05:19] 🔄 
🔄 Step 4: Extracting order data...
[07:05:22] ℹ️  Order extraction - MRN: '6169015'
[07:05:22] ℹ️  Order extraction - Sex: 'MALE'
[07:05:22] ℹ️  Order extraction - Service Line: 'PT'
[07:05:22] ℹ️  Order extraction - Payer Source: ''
[07:05:22] ✅ Order data extraction completed successfully
[07:05:22] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:05:22] ℹ️  Using longer MRN from order data: '6169015' over '227027'
[07:05:22] ℹ️  Service line consistent in both sources: 'PT'
[07:05:22] ✅ Patient name cross-validation successful
[07:05:22] ✅    ✅ Data merged successfully
[07:05:23] ✅    ✅ Order data extracted and validated
[07:05:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:05:29] [DOC: 9235064] ℹ️  Patient not found in cache or API: Correia Terry
[07:05:29] [DOC: 9235064] ℹ️  Patient not found, creating new patient via API...
[07:05:29] [DOC: 9235064] ℹ️  Creating patient via API: Correia Terry
[07:05:30] [DOC: 9235064] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[07:05:30] ❌    ❌ Failed to create patient
[07:05:30] [DOC: 9235064] ℹ️  API push details saved for document 9235064
================================================================================
║                        Processing Document ID: 9235058                         ║
================================================================================
[07:05:30] ℹ️  Agency: Dartmouth HH
[07:05:30] ℹ️  Date: 04/11/2025
[07:05:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:05:32] [DOC: 9235058] ✅ Text extracted using pdfplumber (1138 chars)
[07:05:32] ✅    ✅ Text extracted using pdfplumber (1138 chars)
[07:05:32] 🔄 
🔄 Step 2: Extracting patient data...
[07:05:35] ℹ️  AI extracted raw sex value: 'F'
[07:05:35] ℹ️  AI extracted service line: 'RN'
[07:05:35] ℹ️  AI extracted payer source: 'Medicare'
[07:05:35] ℹ️  AI extracted diagnoses:
[07:05:35] ℹ️    - Diagnosis 1: ''
[07:05:35] ℹ️    - Diagnosis 2: ''
[07:05:35] ℹ️    - Diagnosis 3: ''
[07:05:35] ℹ️    - Diagnosis 4: ''
[07:05:35] ℹ️    - Diagnosis 5: ''
[07:05:35] ℹ️    - Diagnosis 6: ''
[07:05:35] ℹ️  Final extracted MRN: '5094015'
[07:05:35] ℹ️  Final extracted Sex: 'FEMALE'
[07:05:35] ℹ️  Final extracted Service Line: 'RN'
[07:05:35] ℹ️  Final extracted Payer Source: 'Medicare'
[07:05:35] ✅ Patient data extraction completed successfully
[07:05:35] ✅    ✅ Patient data extracted successfully
[07:05:35] 📊 Patient Response
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:05:35] ✅    ✅ Patient identified: Laura Gregoire
[07:05:35] ✅    ✅ Patient name validation passed
[07:05:35] 🔄 
🔄 Step 3: Processing patient dates...
[07:05:35] [DOC: 9235058] ℹ️  DOB normalized: 12/06/1944
[07:05:35] [DOC: 9235058] ℹ️  Episode startOfCare normalized: 08/26/2024
[07:05:35] [DOC: 9235058] ℹ️  Episode startOfEpisode normalized: 02/22/2025
[07:05:35] [DOC: 9235058] ℹ️  Episode endOfEpisode normalized: 04/22/2025
[07:05:35] [DOC: 9235058] ✅ Patient date processing completed successfully
[07:05:35] ✅    ✅ Date processing completed
[07:05:35] 📊 Processed Patient Data
     └─ patientFName: Laura
     └─ patientLName: Gregoire
     └─ dob: 12/06/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5094015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '08/26/2024', 'startOfEpisode': '02/22/2025', 'endOfEpisode': '04/22/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:05:35] 🔄 
🔄 Step 4: Extracting order data...
[07:05:37] ℹ️  Order extraction - MRN: ''
[07:05:37] ℹ️  Order extraction - Sex: 'FEMALE'
[07:05:37] ℹ️  Order extraction - Service Line: ''
[07:05:37] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:05:37] ✅ Order data extraction completed successfully
[07:05:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:05:37] ℹ️  Using MRN from patient data: '5094015'
[07:05:37] ℹ️  Using service line from patient data: 'RN'
[07:05:37] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:05:37] ✅ Patient name cross-validation successful
[07:05:37] ✅    ✅ Data merged successfully
[07:05:38] ✅    ✅ Order data extracted and validated
[07:05:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:05:38] [DOC: 9235058] ✅ Patient found in local cache: Laura Gregoire, ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[07:05:38] ✅    ✅ Existing patient found with ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[07:05:38] 🔄 
🔄 Step 6: Pushing order to API...
[07:05:38] [DOC: 9235058] ℹ️  Pushing order via API for patient ID: 7f4d314e-be82-42eb-b804-a48edba1b2af
[07:05:39] [DOC: 9235058] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:05:39] ❌    ❌ Failed to push order
[07:05:39] 🔄 
🔄 Step 7: Writing to CSV...
[07:05:39] [DOC: 9235058] ℹ️  Calculated age: 80 from DOB: 12/06/1944
[07:05:39] [DOC: 9235058] ℹ️  Service Line extracted: 'RN'
[07:05:39] [DOC: 9235058] ℹ️  Payer Source extracted: 'Medicare'
[07:05:39] [DOC: 9235058] ℹ️  Diagnosis codes being written:
[07:05:39] [DOC: 9235058] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:05:39] [DOC: 9235058] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:05:39] [DOC: 9235058] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:05:39] [DOC: 9235058] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:05:39] [DOC: 9235058] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:05:39] [DOC: 9235058] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:05:39] [DOC: 9235058] ✅ Patient data written to CSV: Laura Gregoire | Sex: FEMALE | Age: 80 | Service: RN | Payer: Medicare | MRN: 5094015
[07:05:39] ✅    ✅ Document 9235058 processed and saved successfully
[07:05:39] 🔄 
🔄 Step 8: Saving API details...
[07:05:39] [DOC: 9235058] ℹ️  API push details saved for document 9235058
[07:05:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235054                         ║
================================================================================
[07:05:39] ℹ️  Agency: Dartmouth HH
[07:05:39] ℹ️  Date: 04/11/2025
[07:05:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:05:42] [DOC: 9235054] ✅ Text extracted using pdfplumber (7926 chars)
[07:05:42] ✅    ✅ Text extracted using pdfplumber (7926 chars)
[07:05:42] 🔄 
🔄 Step 2: Extracting patient data...
[07:05:45] ℹ️  AI extracted raw sex value: 'M'
[07:05:45] ℹ️  AI extracted service line: 'Skilled Nursing'
[07:05:45] ℹ️  AI extracted payer source: 'Medicare'
[07:05:45] ℹ️  AI extracted diagnoses:
[07:05:45] ℹ️    - Diagnosis 1: 'CHF'
[07:05:45] ℹ️    - Diagnosis 2: 'urinary retention'
[07:05:45] ℹ️    - Diagnosis 3: 'COPD'
[07:05:45] ℹ️    - Diagnosis 4: ''
[07:05:45] ℹ️    - Diagnosis 5: ''
[07:05:45] ℹ️    - Diagnosis 6: ''
[07:05:45] ℹ️  Final extracted MRN: '842002'
[07:05:45] ℹ️  Final extracted Sex: 'MALE'
[07:05:45] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[07:05:45] ℹ️  Final extracted Payer Source: 'Medicare'
[07:05:45] ✅ Patient data extraction completed successfully
[07:05:45] ✅    ✅ Patient data extracted successfully
[07:05:45] 📊 Patient Response
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': 'CHF', 'secondDiagnosis': 'urinary retention', 'thirdDiagnosis': 'COPD', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:05:45] ✅    ✅ Patient identified: Johannes Bjornson
[07:05:45] ✅    ✅ Patient name validation passed
[07:05:45] 🔄 
🔄 Step 3: Processing patient dates...
[07:05:45] [DOC: 9235054] ℹ️  DOB normalized: 02/09/1942
[07:05:45] [DOC: 9235054] ℹ️  Episode startOfCare normalized: 10/10/2024
[07:05:45] [DOC: 9235054] ℹ️  Episode startOfEpisode normalized: 02/07/2025
[07:05:45] [DOC: 9235054] ℹ️  Episode endOfEpisode normalized: 04/07/2025
[07:05:45] [DOC: 9235054] ✅ Patient date processing completed successfully
[07:05:45] ✅    ✅ Date processing completed
[07:05:45] 📊 Processed Patient Data
     └─ patientFName: Johannes
     └─ patientLName: Bjornson
     └─ dob: 02/09/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 842002
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/10/2024', 'startOfEpisode': '02/07/2025', 'endOfEpisode': '04/07/2025', 'firstDiagnosis': 'CHF', 'secondDiagnosis': 'urinary retention', 'thirdDiagnosis': 'COPD', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:05:45] 🔄 
🔄 Step 4: Extracting order data...
[07:05:47] ℹ️  Order extraction - MRN: ''
[07:05:47] ℹ️  Order extraction - Sex: 'MALE'
[07:05:47] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[07:05:47] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:05:47] ✅ Order data extraction completed successfully
[07:05:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:05:47] ℹ️  Using MRN from patient data: '842002'
[07:05:47] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[07:05:47] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:05:47] ✅ Patient name cross-validation successful
[07:05:47] ✅    ✅ Data merged successfully
[07:05:48] ✅    ✅ Order data extracted and validated
[07:05:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:05:48] [DOC: 9235054] ✅ Patient found in local cache: Johannes Bjornson, ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[07:05:48] ✅    ✅ Existing patient found with ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[07:05:48] 🔄 
🔄 Step 6: Pushing order to API...
[07:05:48] [DOC: 9235054] ℹ️  Pushing order via API for patient ID: 0993ef32-76a1-4fc2-b022-b270dbd37f31
[07:05:50] [DOC: 9235054] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13167"}
[07:05:50] ❌    ❌ Failed to push order
[07:05:50] 🔄 
🔄 Step 7: Writing to CSV...
[07:05:50] [DOC: 9235054] ℹ️  Calculated age: 83 from DOB: 02/09/1942
[07:05:50] [DOC: 9235054] ℹ️  Service Line extracted: 'Skilled Nursing'
[07:05:50] [DOC: 9235054] ℹ️  Payer Source extracted: 'Medicare'
[07:05:50] [DOC: 9235054] ℹ️  Diagnosis codes being written:
[07:05:50] [DOC: 9235054] ℹ️    - Latest_Episode_Firstdiagnosis: 'CHF'
[07:05:50] [DOC: 9235054] ℹ️    - Latest_Episode_Seconddiagnosis: 'urinary retention'
[07:05:50] [DOC: 9235054] ℹ️    - Latest_Episode_Thirddiagnosis: 'COPD'
[07:05:50] [DOC: 9235054] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:05:50] [DOC: 9235054] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:05:50] [DOC: 9235054] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:05:50] [DOC: 9235054] ✅ Patient data written to CSV: Johannes Bjornson | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: 842002
[07:05:50] ✅    ✅ Document 9235054 processed and saved successfully
[07:05:50] 🔄 
🔄 Step 8: Saving API details...
[07:05:50] [DOC: 9235054] ℹ️  API push details saved for document 9235054
[07:05:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235051                         ║
================================================================================
[07:05:50] ℹ️  Agency: Dartmouth HH
[07:05:50] ℹ️  Date: 04/11/2025
[07:05:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:05:52] [DOC: 9235051] ✅ Text extracted using pdfplumber (4009 chars)
[07:05:52] ✅    ✅ Text extracted using pdfplumber (4009 chars)
[07:05:52] 🔄 
🔄 Step 2: Extracting patient data...
[07:05:55] ℹ️  AI extracted raw sex value: 'F'
[07:05:55] ℹ️  AI extracted service line: 'OT'
[07:05:55] ℹ️  AI extracted payer source: 'Medicare'
[07:05:55] ℹ️  AI extracted diagnoses:
[07:05:55] ℹ️    - Diagnosis 1: 'OA'
[07:05:55] ℹ️    - Diagnosis 2: 'Bipolar disorder'
[07:05:55] ℹ️    - Diagnosis 3: 'back pain'
[07:05:55] ℹ️    - Diagnosis 4: 'sciatica'
[07:05:55] ℹ️    - Diagnosis 5: 'shingles'
[07:05:55] ℹ️    - Diagnosis 6: 'hyperlipidemia'
[07:05:55] ℹ️  Final extracted MRN: '6034015'
[07:05:55] ℹ️  Final extracted Sex: 'FEMALE'
[07:05:55] ℹ️  Final extracted Service Line: 'OT'
[07:05:55] ℹ️  Final extracted Payer Source: 'Medicare'
[07:05:55] ✅ Patient data extraction completed successfully
[07:05:55] ✅    ✅ Patient data extracted successfully
[07:05:55] 📊 Patient Response
     └─ patientFName: Margaret
     └─ patientLName: Peart
     └─ dob: 06/23/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6034015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'OA', 'secondDiagnosis': 'Bipolar disorder', 'thirdDiagnosis': 'back pain', 'fourthDiagnosis': 'sciatica', 'fifthDiagnosis': 'shingles', 'sixthDiagnosis': 'hyperlipidemia'}]
[07:05:55] ✅    ✅ Patient identified: Margaret Peart
[07:05:55] ✅    ✅ Patient name validation passed
[07:05:55] 🔄 
🔄 Step 3: Processing patient dates...
[07:05:55] [DOC: 9235051] ℹ️  DOB normalized: 06/23/1945
[07:05:55] [DOC: 9235051] ℹ️  Episode startOfCare normalized: 03/27/2025
[07:05:55] [DOC: 9235051] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[07:05:55] [DOC: 9235051] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[07:05:55] [DOC: 9235051] ✅ Patient date processing completed successfully
[07:05:55] ✅    ✅ Date processing completed
[07:05:55] 📊 Processed Patient Data
     └─ patientFName: Margaret
     └─ patientLName: Peart
     └─ dob: 06/23/1945
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6034015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': 'OA', 'secondDiagnosis': 'Bipolar disorder', 'thirdDiagnosis': 'back pain', 'fourthDiagnosis': 'sciatica', 'fifthDiagnosis': 'shingles', 'sixthDiagnosis': 'hyperlipidemia'}]
[07:05:55] 🔄 
🔄 Step 4: Extracting order data...
[07:05:57] ℹ️  Order extraction - MRN: ''
[07:05:57] ℹ️  Order extraction - Sex: 'FEMALE'
[07:05:57] ℹ️  Order extraction - Service Line: 'OT'
[07:05:57] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:05:57] ✅ Order data extraction completed successfully
[07:05:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:05:57] ℹ️  Using MRN from patient data: '6034015'
[07:05:57] ℹ️  Service line consistent in both sources: 'OT'
[07:05:57] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:05:57] ✅ Patient name cross-validation successful
[07:05:57] ✅    ✅ Data merged successfully
[07:05:59] ✅    ✅ Order data extracted and validated
[07:05:59] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:06:06] [DOC: 9235051] ✅ Patient exists in API: Margaret Peart, ID: 0db0333d-8306-4556-a304-4845228fdb62
[07:06:06] ✅    ✅ Existing patient found with ID: 0db0333d-8306-4556-a304-4845228fdb62
[07:06:06] 🔄 
🔄 Step 6: Pushing order to API...
[07:06:06] [DOC: 9235051] ℹ️  Pushing order via API for patient ID: 0db0333d-8306-4556-a304-4845228fdb62
[07:06:07] [DOC: 9235051] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:06:07] ❌    ❌ Failed to push order
[07:06:07] 🔄 
🔄 Step 7: Writing to CSV...
[07:06:07] [DOC: 9235051] ℹ️  Calculated age: 79 from DOB: 06/23/1945
[07:06:07] [DOC: 9235051] ℹ️  Service Line extracted: 'OT'
[07:06:07] [DOC: 9235051] ℹ️  Payer Source extracted: 'Medicare'
[07:06:07] [DOC: 9235051] ℹ️  Diagnosis codes being written:
[07:06:07] [DOC: 9235051] ℹ️    - Latest_Episode_Firstdiagnosis: 'OA'
[07:06:07] [DOC: 9235051] ℹ️    - Latest_Episode_Seconddiagnosis: 'Bipolar disorder'
[07:06:07] [DOC: 9235051] ℹ️    - Latest_Episode_Thirddiagnosis: 'back pain'
[07:06:07] [DOC: 9235051] ℹ️    - Latest_Episode_Fourthdiagnosis: 'sciatica'
[07:06:07] [DOC: 9235051] ℹ️    - Latest_Episode_Fifthdiagnosis: 'shingles'
[07:06:07] [DOC: 9235051] ℹ️    - Latest_Episode_Sixthdiagnosis: 'hyperlipidemia'
[07:06:07] [DOC: 9235051] ✅ Patient data written to CSV: Margaret Peart | Sex: FEMALE | Age: 79 | Service: OT | Payer: Medicare | MRN: 6034015
[07:06:07] ✅    ✅ Document 9235051 processed and saved successfully
[07:06:07] 🔄 
🔄 Step 8: Saving API details...
[07:06:07] [DOC: 9235051] ℹ️  API push details saved for document 9235051
[07:06:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9235044                         ║
================================================================================
[07:06:07] ℹ️  Agency: Dartmouth HH
[07:06:07] ℹ️  Date: 04/11/2025
[07:06:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:06:11] [DOC: 9235044] ✅ Text extracted using pdfplumber (10201 chars)
[07:06:11] ✅    ✅ Text extracted using pdfplumber (10189 chars)
[07:06:11] 🔄 
🔄 Step 2: Extracting patient data...
[07:06:14] ℹ️  AI extracted raw sex value: 'M'
[07:06:14] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT, ST'
[07:06:14] ℹ️  AI extracted payer source: ''
[07:06:14] ℹ️  AI extracted diagnoses:
[07:06:14] ℹ️    - Diagnosis 1: 'I13.0'
[07:06:14] ℹ️    - Diagnosis 2: 'I50.33'
[07:06:14] ℹ️    - Diagnosis 3: 'E11.22'
[07:06:14] ℹ️    - Diagnosis 4: 'N18.31'
[07:06:14] ℹ️    - Diagnosis 5: 'J96.01'
[07:06:14] ℹ️    - Diagnosis 6: 'J44.1'
[07:06:14] ℹ️  Final extracted MRN: '2731011'
[07:06:14] ℹ️  Final extracted Sex: 'MALE'
[07:06:14] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT, ST'
[07:06:14] ℹ️  Final extracted Payer Source: ''
[07:06:14] ✅ Patient data extraction completed successfully
[07:06:14] ✅    ✅ Patient data extracted successfully
[07:06:14] 📊 Patient Response
     └─ patientFName: Paul
     └─ patientLName: Penha
     └─ dob: 07/08/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2731011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'J96.01', 'sixthDiagnosis': 'J44.1'}]
[07:06:14] ✅    ✅ Patient identified: Paul Penha
[07:06:14] ✅    ✅ Patient name validation passed
[07:06:14] 🔄 
🔄 Step 3: Processing patient dates...
[07:06:14] [DOC: 9235044] ℹ️  DOB normalized: 07/08/1934
[07:06:14] [DOC: 9235044] ℹ️  Episode startOfCare normalized: 04/04/2025
[07:06:14] [DOC: 9235044] ℹ️  Episode startOfEpisode normalized: 04/05/2025
[07:06:14] [DOC: 9235044] ℹ️  Episode endOfEpisode normalized: 06/03/2025
[07:06:14] [DOC: 9235044] ✅ Patient date processing completed successfully
[07:06:14] ✅    ✅ Date processing completed
[07:06:14] 📊 Processed Patient Data
     └─ patientFName: Paul
     └─ patientLName: Penha
     └─ dob: 07/08/1934
     └─ patientSex: MALE
     └─ medicalRecordNo: 2731011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT, ST
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/04/2025', 'startOfEpisode': '04/05/2025', 'endOfEpisode': '06/03/2025', 'firstDiagnosis': 'I13.0', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'E11.22', 'fourthDiagnosis': 'N18.31', 'fifthDiagnosis': 'J96.01', 'sixthDiagnosis': 'J44.1'}]
[07:06:14] 🔄 
🔄 Step 4: Extracting order data...
[07:06:16] ℹ️  Order extraction - MRN: '2731011'
[07:06:16] ℹ️  Order extraction - Sex: 'MALE'
[07:06:16] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT, ST'
[07:06:16] ℹ️  Order extraction - Payer Source: ''
[07:06:16] ✅ Order data extraction completed successfully
[07:06:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:06:16] ℹ️  Using MRN from patient data: '2731011' over '2731011'
[07:06:16] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT, ST'
[07:06:16] ✅ Patient name cross-validation successful
[07:06:16] ✅    ✅ Data merged successfully
[07:06:18] ✅    ✅ Order data extracted and validated
[07:06:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:06:38] [DOC: 9235044] ✅ Patient exists in API: Paul Penha, ID: acd1fced-75ff-43a8-8304-4681296c9d26
[07:06:38] ✅    ✅ Existing patient found with ID: acd1fced-75ff-43a8-8304-4681296c9d26
[07:06:38] 🔄 
🔄 Step 6: Pushing order to API...
[07:06:38] [DOC: 9235044] ℹ️  Pushing order via API for patient ID: acd1fced-75ff-43a8-8304-4681296c9d26
[07:06:40] [DOC: 9235044] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:06:40] ❌    ❌ Failed to push order
[07:06:40] 🔄 
🔄 Step 7: Writing to CSV...
[07:06:40] [DOC: 9235044] ℹ️  Calculated age: 90 from DOB: 07/08/1934
[07:06:40] [DOC: 9235044] ℹ️  Service Line extracted: 'Skilled Nursing, PT, OT, ST'
[07:06:40] [DOC: 9235044] ℹ️  Payer Source extracted: ''
[07:06:40] [DOC: 9235044] ℹ️  Diagnosis codes being written:
[07:06:40] [DOC: 9235044] ℹ️    - Latest_Episode_Firstdiagnosis: 'I13.0'
[07:06:40] [DOC: 9235044] ℹ️    - Latest_Episode_Seconddiagnosis: 'I50.33'
[07:06:40] [DOC: 9235044] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.22'
[07:06:40] [DOC: 9235044] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N18.31'
[07:06:40] [DOC: 9235044] ℹ️    - Latest_Episode_Fifthdiagnosis: 'J96.01'
[07:06:40] [DOC: 9235044] ℹ️    - Latest_Episode_Sixthdiagnosis: 'J44.1'
[07:06:40] [DOC: 9235044] ✅ Patient data written to CSV: Paul Penha | Sex: MALE | Age: 90 | Service: Skilled Nursing, PT, OT, ST | Payer:  | MRN: 2731011
[07:06:40] ✅    ✅ Document 9235044 processed and saved successfully
[07:06:40] 🔄 
🔄 Step 8: Saving API details...
[07:06:40] [DOC: 9235044] ℹ️  API push details saved for document 9235044
[07:06:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234944                         ║
================================================================================
[07:06:40] ℹ️  Agency: Dartmouth HH
[07:06:40] ℹ️  Date: 04/11/2025
[07:06:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:06:42] [DOC: 9234944] ✅ Text extracted using pdfplumber (16044 chars)
[07:06:42] ✅    ✅ Text extracted using pdfplumber (16032 chars)
[07:06:42] 🔄 
🔄 Step 2: Extracting patient data...
[07:06:45] ℹ️  AI extracted raw sex value: 'F'
[07:06:45] ℹ️  AI extracted service line: 'PT, RN'
[07:06:45] ℹ️  AI extracted payer source: 'None'
[07:06:45] ℹ️  AI extracted diagnoses:
[07:06:45] ℹ️    - Diagnosis 1: 'G25.0'
[07:06:45] ℹ️    - Diagnosis 2: 'R29.6'
[07:06:45] ℹ️    - Diagnosis 3: 'R26.81'
[07:06:45] ℹ️    - Diagnosis 4: 'F03.90'
[07:06:45] ℹ️    - Diagnosis 5: 'I48.91'
[07:06:45] ℹ️    - Diagnosis 6: 'H90.3'
[07:06:45] ℹ️  Final extracted MRN: '6351015'
[07:06:45] ℹ️  Final extracted Sex: 'FEMALE'
[07:06:45] ℹ️  Final extracted Service Line: 'PT, RN'
[07:06:45] ℹ️  Final extracted Payer Source: ''
[07:06:45] ✅ Patient data extraction completed successfully
[07:06:45] ✅    ✅ Patient data extracted successfully
[07:06:45] 📊 Patient Response
     └─ patientFName: Jackie
     └─ patientLName: Slade
     └─ dob: 03/03/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6351015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/09/2025', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'G25.0', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'R26.81', 'fourthDiagnosis': 'F03.90', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'H90.3'}]
[07:06:45] ✅    ✅ Patient identified: Jackie Slade
[07:06:45] ✅    ✅ Patient name validation passed
[07:06:45] 🔄 
🔄 Step 3: Processing patient dates...
[07:06:45] [DOC: 9234944] ℹ️  DOB normalized: 03/03/1937
[07:06:45] [DOC: 9234944] ℹ️  Episode startOfCare normalized: 04/09/2025
[07:06:45] [DOC: 9234944] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[07:06:45] [DOC: 9234944] ℹ️  Episode endOfEpisode normalized: 06/07/2025
[07:06:45] [DOC: 9234944] ✅ Patient date processing completed successfully
[07:06:45] ✅    ✅ Date processing completed
[07:06:45] 📊 Processed Patient Data
     └─ patientFName: Jackie
     └─ patientLName: Slade
     └─ dob: 03/03/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6351015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT, RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/09/2025', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'G25.0', 'secondDiagnosis': 'R29.6', 'thirdDiagnosis': 'R26.81', 'fourthDiagnosis': 'F03.90', 'fifthDiagnosis': 'I48.91', 'sixthDiagnosis': 'H90.3'}]
[07:06:45] 🔄 
🔄 Step 4: Extracting order data...
[07:06:48] ℹ️  Order extraction - MRN: '6351015'
[07:06:48] ℹ️  Order extraction - Sex: 'FEMALE'
[07:06:48] ℹ️  Order extraction - Service Line: 'PT, RN'
[07:06:48] ℹ️  Order extraction - Payer Source: ''
[07:06:48] ✅ Order data extraction completed successfully
[07:06:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:06:48] ℹ️  Using MRN from patient data: '6351015' over '6351015'
[07:06:48] ℹ️  Service line consistent in both sources: 'PT, RN'
[07:06:48] ⚠️  Patient name mismatch: Order='Slade, Virginia J' vs Patient='Jackie Slade'
[07:06:48] ✅    ✅ Data merged successfully
[07:06:49] ✅    ✅ Order data extracted and validated
[07:06:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:06:55] [DOC: 9234944] ℹ️  Patient not found in cache or API: Jackie Slade
[07:06:55] [DOC: 9234944] ℹ️  Patient not found, creating new patient via API...
[07:06:55] [DOC: 9234944] ℹ️  Creating patient via API: Jackie Slade
[07:06:56] [DOC: 9234944] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[07:06:56] ❌    ❌ Failed to create patient
[07:06:56] [DOC: 9234944] ℹ️  API push details saved for document 9234944
================================================================================
║                        Processing Document ID: 9234931                         ║
================================================================================
[07:06:56] ℹ️  Agency: Dartmouth HH
[07:06:56] ℹ️  Date: 04/11/2025
[07:06:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:06:58] [DOC: 9234931] ✅ Text extracted using pdfplumber (1126 chars)
[07:06:58] ✅    ✅ Text extracted using pdfplumber (1126 chars)
[07:06:58] 🔄 
🔄 Step 2: Extracting patient data...
[07:07:01] ℹ️  AI extracted raw sex value: 'M'
[07:07:01] ℹ️  AI extracted service line: 'Skilled Nursing'
[07:07:01] ℹ️  AI extracted payer source: 'Medicare'
[07:07:01] ℹ️  AI extracted diagnoses:
[07:07:01] ℹ️    - Diagnosis 1: 'None'
[07:07:01] ℹ️    - Diagnosis 2: 'None'
[07:07:01] ℹ️    - Diagnosis 3: 'None'
[07:07:01] ℹ️    - Diagnosis 4: 'None'
[07:07:01] ℹ️    - Diagnosis 5: 'None'
[07:07:01] ℹ️    - Diagnosis 6: 'None'
[07:07:01] ℹ️  Final extracted MRN: '3745015'
[07:07:01] ℹ️  Final extracted Sex: 'MALE'
[07:07:01] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[07:07:01] ℹ️  Final extracted Payer Source: 'Medicare'
[07:07:01] ✅ Patient data extraction completed successfully
[07:07:01] ✅    ✅ Patient data extracted successfully
[07:07:01] 📊 Patient Response
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[07:07:01] ✅    ✅ Patient identified: Stanley Waters
[07:07:01] ✅    ✅ Patient name validation passed
[07:07:01] 🔄 
🔄 Step 3: Processing patient dates...
[07:07:01] [DOC: 9234931] ℹ️  DOB normalized: 08/19/1941
[07:07:01] [DOC: 9234931] ℹ️  Episode startOfCare normalized: 03/13/2025
[07:07:01] [DOC: 9234931] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[07:07:01] [DOC: 9234931] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[07:07:01] [DOC: 9234931] ✅ Patient date processing completed successfully
[07:07:01] ✅    ✅ Date processing completed
[07:07:01] 📊 Processed Patient Data
     └─ patientFName: Stanley
     └─ patientLName: Waters
     └─ dob: 08/19/1941
     └─ patientSex: MALE
     └─ medicalRecordNo: 3745015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025'}]
[07:07:01] 🔄 
🔄 Step 4: Extracting order data...
[07:07:03] ℹ️  Order extraction - MRN: '3745015'
[07:07:03] ℹ️  Order extraction - Sex: 'MALE'
[07:07:03] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[07:07:03] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:07:03] ✅ Order data extraction completed successfully
[07:07:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:07:03] ℹ️  Using MRN from patient data: '3745015' over '3745015'
[07:07:03] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[07:07:03] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:07:03] ✅ Patient name cross-validation successful
[07:07:03] ✅    ✅ Data merged successfully
[07:07:05] ✅    ✅ Order data extracted and validated
[07:07:05] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:07:05] [DOC: 9234931] ✅ Patient found in local cache: Stanley Waters, ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[07:07:05] ✅    ✅ Existing patient found with ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[07:07:05] 🔄 
🔄 Step 6: Pushing order to API...
[07:07:05] [DOC: 9234931] ℹ️  Pushing order via API for patient ID: 5c967926-b804-40d7-9cac-2e10ae61f7db
[07:07:06] [DOC: 9234931] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:07:06] ❌    ❌ Failed to push order
[07:07:06] 🔄 
🔄 Step 7: Writing to CSV...
[07:07:06] [DOC: 9234931] ℹ️  Calculated age: 83 from DOB: 08/19/1941
[07:07:06] [DOC: 9234931] ℹ️  Service Line extracted: 'Skilled Nursing'
[07:07:06] [DOC: 9234931] ℹ️  Payer Source extracted: 'Medicare'
[07:07:06] [DOC: 9234931] ℹ️  Diagnosis codes being written:
[07:07:06] [DOC: 9234931] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:07:06] [DOC: 9234931] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:07:06] [DOC: 9234931] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:07:06] [DOC: 9234931] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:07:06] [DOC: 9234931] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:07:06] [DOC: 9234931] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:07:06] [DOC: 9234931] ✅ Patient data written to CSV: Stanley Waters | Sex: MALE | Age: 83 | Service: Skilled Nursing | Payer: Medicare | MRN: 3745015
[07:07:06] ✅    ✅ Document 9234931 processed and saved successfully
[07:07:06] 🔄 
🔄 Step 8: Saving API details...
[07:07:06] [DOC: 9234931] ℹ️  API push details saved for document 9234931
[07:07:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234923                         ║
================================================================================
[07:07:06] ℹ️  Agency: AccentCare Fall River
[07:07:06] ℹ️  Date: 04/11/2025
[07:07:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:07:19] [DOC: 9234923] ✅ Text extracted using pdfplumber (23889 chars)
[07:07:19] ✅    ✅ Text extracted using pdfplumber (23817 chars)
[07:07:19] 🔄 
🔄 Step 2: Extracting patient data...
[07:07:22] ℹ️  AI extracted raw sex value: 'M'
[07:07:22] ℹ️  AI extracted service line: 'Skilled Nursing, Psychiatric Nursing'
[07:07:22] ℹ️  AI extracted payer source: 'Medicare'
[07:07:22] ℹ️  AI extracted diagnoses:
[07:07:22] ℹ️    - Diagnosis 1: 'F41.1'
[07:07:22] ℹ️    - Diagnosis 2: 'F32.9'
[07:07:22] ℹ️    - Diagnosis 3: 'I10'
[07:07:22] ℹ️    - Diagnosis 4: 'G47.33'
[07:07:22] ℹ️    - Diagnosis 5: 'H26.9'
[07:07:22] ℹ️    - Diagnosis 6: 'N40.0'
[07:07:22] ℹ️  Final extracted MRN: 'C0200202684501'
[07:07:22] ℹ️  Final extracted Sex: 'MALE'
[07:07:22] ℹ️  Final extracted Service Line: 'Skilled Nursing, Psychiatric Nursing'
[07:07:22] ℹ️  Final extracted Payer Source: 'Medicare'
[07:07:22] ✅ Patient data extraction completed successfully
[07:07:22] ✅    ✅ Patient data extracted successfully
[07:07:22] 📊 Patient Response
     └─ patientFName: KONSTANTI
     └─ patientLName: SMIGEL
     └─ dob: 10/08/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: C0200202684501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 50 PAGE STREET
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Psychiatric Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/11/2024', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'F41.1', 'secondDiagnosis': 'F32.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'G47.33', 'fifthDiagnosis': 'H26.9', 'sixthDiagnosis': 'N40.0'}]
[07:07:22] ✅    ✅ Patient identified: KONSTANTI SMIGEL
[07:07:22] ✅    ✅ Patient name validation passed
[07:07:22] 🔄 
🔄 Step 3: Processing patient dates...
[07:07:22] [DOC: 9234923] ℹ️  DOB normalized: 10/08/1952
[07:07:22] [DOC: 9234923] ℹ️  Episode startOfCare normalized: 10/11/2024
[07:07:22] [DOC: 9234923] ℹ️  Episode startOfEpisode normalized: 04/09/2025
[07:07:22] [DOC: 9234923] ℹ️  Episode endOfEpisode normalized: 06/07/2025
[07:07:22] [DOC: 9234923] ✅ Patient date processing completed successfully
[07:07:22] ✅    ✅ Date processing completed
[07:07:22] 📊 Processed Patient Data
     └─ patientFName: KONSTANTI
     └─ patientLName: SMIGEL
     └─ dob: 10/08/1952
     └─ patientSex: MALE
     └─ medicalRecordNo: C0200202684501
     └─ billingProvider: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: ACCENTCARE OF MASS, INC. DBA AC HH OF MASS
     └─ address: 50 PAGE STREET
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02740
     └─ email: 
     └─ phoneNumber: (508) 235-5312
     └─ serviceLine: Skilled Nursing, Psychiatric Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '10/11/2024', 'startOfEpisode': '04/09/2025', 'endOfEpisode': '06/07/2025', 'firstDiagnosis': 'F41.1', 'secondDiagnosis': 'F32.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'G47.33', 'fifthDiagnosis': 'H26.9', 'sixthDiagnosis': 'N40.0'}]
[07:07:22] 🔄 
🔄 Step 4: Extracting order data...
[07:07:25] ℹ️  Order extraction - MRN: '227203'
[07:07:25] ℹ️  Order extraction - Sex: 'MALE'
[07:07:25] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Psychiatric Nursing'
[07:07:25] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:07:25] ✅ Order data extraction completed successfully
[07:07:25] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:07:25] ℹ️  Using MRN from patient data: 'C0200202684501' over '227203'
[07:07:25] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Psychiatric Nursing'
[07:07:25] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:07:25] ✅ Patient name cross-validation successful
[07:07:25] ✅    ✅ Data merged successfully
[07:07:26] ✅    ✅ Order data extracted and validated
[07:07:26] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:07:53] [DOC: 9234923] ℹ️  Patient not found in cache or API: KONSTANTI SMIGEL
[07:07:53] [DOC: 9234923] ℹ️  Patient not found, creating new patient via API...
[07:07:53] [DOC: 9234923] ℹ️  Creating patient via API: KONSTANTI SMIGEL
[07:07:55] [DOC: 9234923] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[07:07:55] ❌    ❌ Failed to create patient
[07:07:55] [DOC: 9234923] ℹ️  API push details saved for document 9234923
================================================================================
║                        Processing Document ID: 9234928                         ║
================================================================================
[07:07:55] ℹ️  Agency: Dartmouth HH
[07:07:55] ℹ️  Date: 04/11/2025
[07:07:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:07:57] [DOC: 9234928] ✅ Text extracted using pdfplumber (5429 chars)
[07:07:57] ✅    ✅ Text extracted using pdfplumber (5429 chars)
[07:07:57] 🔄 
🔄 Step 2: Extracting patient data...
[07:08:00] ℹ️  AI extracted raw sex value: 'M'
[07:08:00] ℹ️  AI extracted service line: 'PT'
[07:08:00] ℹ️  AI extracted payer source: 'Medicare'
[07:08:00] ℹ️  AI extracted diagnoses:
[07:08:00] ℹ️    - Diagnosis 1: 'Intracranial hemorrhage'
[07:08:00] ℹ️    - Diagnosis 2: 'Anemia'
[07:08:00] ℹ️    - Diagnosis 3: 'hypertension'
[07:08:00] ℹ️    - Diagnosis 4: 'hyperlipidemia'
[07:08:00] ℹ️    - Diagnosis 5: ''
[07:08:00] ℹ️    - Diagnosis 6: ''
[07:08:00] ℹ️  Final extracted MRN: '6396009'
[07:08:00] ℹ️  Final extracted Sex: 'MALE'
[07:08:00] ℹ️  Final extracted Service Line: 'PT'
[07:08:00] ℹ️  Final extracted Payer Source: 'Medicare'
[07:08:00] ✅ Patient data extraction completed successfully
[07:08:00] ✅    ✅ Patient data extracted successfully
[07:08:00] 📊 Patient Response
     └─ patientFName: Frank
     └─ patientLName: Edwards
     └─ dob: 04/08/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6396009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'Intracranial hemorrhage', 'secondDiagnosis': 'Anemia', 'thirdDiagnosis': 'hypertension', 'fourthDiagnosis': 'hyperlipidemia', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:08:00] ✅    ✅ Patient identified: Frank Edwards
[07:08:00] ✅    ✅ Patient name validation passed
[07:08:00] 🔄 
🔄 Step 3: Processing patient dates...
[07:08:00] [DOC: 9234928] ℹ️  DOB normalized: 04/08/1942
[07:08:00] [DOC: 9234928] ℹ️  Episode startOfCare normalized: 03/13/2025
[07:08:00] [DOC: 9234928] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[07:08:00] [DOC: 9234928] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[07:08:00] [DOC: 9234928] ✅ Patient date processing completed successfully
[07:08:00] ✅    ✅ Date processing completed
[07:08:00] 📊 Processed Patient Data
     └─ patientFName: Frank
     └─ patientLName: Edwards
     └─ dob: 04/08/1942
     └─ patientSex: MALE
     └─ medicalRecordNo: 6396009
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/13/2025', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'Intracranial hemorrhage', 'secondDiagnosis': 'Anemia', 'thirdDiagnosis': 'hypertension', 'fourthDiagnosis': 'hyperlipidemia', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:08:00] 🔄 
🔄 Step 4: Extracting order data...
[07:08:03] ℹ️  Order extraction - MRN: ''
[07:08:03] ℹ️  Order extraction - Sex: 'MALE'
[07:08:03] ℹ️  Order extraction - Service Line: 'PT'
[07:08:03] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:08:03] ✅ Order data extraction completed successfully
[07:08:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:08:03] ℹ️  Using MRN from patient data: '6396009'
[07:08:03] ℹ️  Service line consistent in both sources: 'PT'
[07:08:03] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:08:03] ✅ Patient name cross-validation successful
[07:08:03] ✅    ✅ Data merged successfully
[07:08:04] ✅    ✅ Order data extracted and validated
[07:08:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:08:04] [DOC: 9234928] ✅ Patient found in local cache: Frank Edwards, ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[07:08:04] ✅    ✅ Existing patient found with ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[07:08:04] 🔄 
🔄 Step 6: Pushing order to API...
[07:08:04] [DOC: 9234928] ℹ️  Pushing order via API for patient ID: 90626c77-7e3a-4531-8f13-d08a2d3d409c
[07:08:06] [DOC: 9234928] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:08:06] ❌    ❌ Failed to push order
[07:08:06] 🔄 
🔄 Step 7: Writing to CSV...
[07:08:06] [DOC: 9234928] ℹ️  Calculated age: 83 from DOB: 04/08/1942
[07:08:06] [DOC: 9234928] ℹ️  Service Line extracted: 'PT'
[07:08:06] [DOC: 9234928] ℹ️  Payer Source extracted: 'Medicare'
[07:08:06] [DOC: 9234928] ℹ️  Diagnosis codes being written:
[07:08:06] [DOC: 9234928] ℹ️    - Latest_Episode_Firstdiagnosis: 'Intracranial hemorrhage'
[07:08:06] [DOC: 9234928] ℹ️    - Latest_Episode_Seconddiagnosis: 'Anemia'
[07:08:06] [DOC: 9234928] ℹ️    - Latest_Episode_Thirddiagnosis: 'hypertension'
[07:08:06] [DOC: 9234928] ℹ️    - Latest_Episode_Fourthdiagnosis: 'hyperlipidemia'
[07:08:06] [DOC: 9234928] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:08:06] [DOC: 9234928] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:08:06] [DOC: 9234928] ✅ Patient data written to CSV: Frank Edwards | Sex: MALE | Age: 83 | Service: PT | Payer: Medicare | MRN: 6396009
[07:08:06] ✅    ✅ Document 9234928 processed and saved successfully
[07:08:06] 🔄 
🔄 Step 8: Saving API details...
[07:08:06] [DOC: 9234928] ℹ️  API push details saved for document 9234928
[07:08:06] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234918                         ║
================================================================================
[07:08:06] ℹ️  Agency: Dartmouth HH
[07:08:06] ℹ️  Date: 04/11/2025
[07:08:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:08:08] [DOC: 9234918] ✅ Text extracted using pdfplumber (2441 chars)
[07:08:08] ✅    ✅ Text extracted using pdfplumber (2441 chars)
[07:08:08] 🔄 
🔄 Step 2: Extracting patient data...
[07:08:11] ℹ️  AI extracted raw sex value: 'F'
[07:08:11] ℹ️  AI extracted service line: 'Skilled Nursing'
[07:08:11] ℹ️  AI extracted payer source: 'Medicare'
[07:08:11] ℹ️  AI extracted diagnoses:
[07:08:11] ℹ️    - Diagnosis 1: 'None'
[07:08:11] ℹ️    - Diagnosis 2: 'None'
[07:08:11] ℹ️    - Diagnosis 3: 'None'
[07:08:11] ℹ️    - Diagnosis 4: 'None'
[07:08:11] ℹ️    - Diagnosis 5: 'None'
[07:08:11] ℹ️    - Diagnosis 6: 'None'
[07:08:11] ℹ️  Final extracted MRN: '4106015'
[07:08:11] ℹ️  Final extracted Sex: 'FEMALE'
[07:08:11] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[07:08:11] ℹ️  Final extracted Payer Source: 'Medicare'
[07:08:11] ✅ Patient data extraction completed successfully
[07:08:11] ✅    ✅ Patient data extracted successfully
[07:08:11] 📊 Patient Response
     └─ patientFName: Susan
     └─ patientLName: Oliver
     └─ dob: 08/16/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4106015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[07:08:11] ✅    ✅ Patient identified: Susan Oliver
[07:08:11] ✅    ✅ Patient name validation passed
[07:08:11] 🔄 
🔄 Step 3: Processing patient dates...
[07:08:11] [DOC: 9234918] ℹ️  DOB normalized: 08/16/1946
[07:08:11] [DOC: 9234918] ℹ️  Episode startOfCare normalized: 03/06/2025
[07:08:11] [DOC: 9234918] ℹ️  Episode startOfEpisode normalized: 03/06/2025
[07:08:11] [DOC: 9234918] ℹ️  Episode endOfEpisode normalized: 05/04/2025
[07:08:11] [DOC: 9234918] ✅ Patient date processing completed successfully
[07:08:11] ✅    ✅ Date processing completed
[07:08:11] 📊 Processed Patient Data
     └─ patientFName: Susan
     └─ patientLName: Oliver
     └─ dob: 08/16/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4106015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/06/2025', 'startOfEpisode': '03/06/2025', 'endOfEpisode': '05/04/2025'}]
[07:08:11] 🔄 
🔄 Step 4: Extracting order data...
[07:08:13] ℹ️  Order extraction - MRN: '4106015'
[07:08:13] ℹ️  Order extraction - Sex: 'FEMALE'
[07:08:13] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[07:08:13] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:08:13] ✅ Order data extraction completed successfully
[07:08:13] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:08:13] ℹ️  Using MRN from patient data: '4106015' over '4106015'
[07:08:13] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[07:08:13] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:08:13] ✅ Patient name cross-validation successful
[07:08:13] ✅    ✅ Data merged successfully
[07:08:14] ✅    ✅ Order data extracted and validated
[07:08:14] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:08:28] [DOC: 9234918] ✅ Patient exists in API: Susan Oliver, ID: 09a4cdd5-6327-4666-9dcc-fbaaa8d59618
[07:08:28] ✅    ✅ Existing patient found with ID: 09a4cdd5-6327-4666-9dcc-fbaaa8d59618
[07:08:28] 🔄 
🔄 Step 6: Pushing order to API...
[07:08:28] [DOC: 9234918] ℹ️  Pushing order via API for patient ID: 09a4cdd5-6327-4666-9dcc-fbaaa8d59618
[07:08:29] [DOC: 9234918] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:08:29] ❌    ❌ Failed to push order
[07:08:29] 🔄 
🔄 Step 7: Writing to CSV...
[07:08:29] [DOC: 9234918] ℹ️  Calculated age: 78 from DOB: 08/16/1946
[07:08:29] [DOC: 9234918] ℹ️  Service Line extracted: 'Skilled Nursing'
[07:08:29] [DOC: 9234918] ℹ️  Payer Source extracted: 'Medicare'
[07:08:29] [DOC: 9234918] ℹ️  Diagnosis codes being written:
[07:08:29] [DOC: 9234918] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:08:29] [DOC: 9234918] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:08:29] [DOC: 9234918] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:08:29] [DOC: 9234918] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:08:29] [DOC: 9234918] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:08:29] [DOC: 9234918] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:08:29] [DOC: 9234918] ✅ Patient data written to CSV: Susan Oliver | Sex: FEMALE | Age: 78 | Service: Skilled Nursing | Payer: Medicare | MRN: 4106015
[07:08:29] ✅    ✅ Document 9234918 processed and saved successfully
[07:08:29] 🔄 
🔄 Step 8: Saving API details...
[07:08:29] [DOC: 9234918] ℹ️  API push details saved for document 9234918
[07:08:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234915                         ║
================================================================================
[07:08:29] ℹ️  Agency: Dartmouth HH
[07:08:29] ℹ️  Date: 04/11/2025
[07:08:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:08:31] [DOC: 9234915] ✅ Text extracted using pdfplumber (1288 chars)
[07:08:31] ✅    ✅ Text extracted using pdfplumber (1288 chars)
[07:08:31] 🔄 
🔄 Step 2: Extracting patient data...
[07:08:34] ℹ️  AI extracted raw sex value: 'F'
[07:08:34] ℹ️  AI extracted service line: 'PT'
[07:08:34] ℹ️  AI extracted payer source: 'Medicare'
[07:08:34] ℹ️  AI extracted diagnoses:
[07:08:34] ℹ️    - Diagnosis 1: ''
[07:08:34] ℹ️    - Diagnosis 2: ''
[07:08:34] ℹ️    - Diagnosis 3: ''
[07:08:34] ℹ️    - Diagnosis 4: ''
[07:08:34] ℹ️    - Diagnosis 5: ''
[07:08:34] ℹ️    - Diagnosis 6: ''
[07:08:34] ℹ️  Final extracted MRN: '6112015'
[07:08:34] ℹ️  Final extracted Sex: 'FEMALE'
[07:08:34] ℹ️  Final extracted Service Line: 'PT'
[07:08:34] ℹ️  Final extracted Payer Source: 'Medicare'
[07:08:34] ✅ Patient data extraction completed successfully
[07:08:34] ✅    ✅ Patient data extracted successfully
[07:08:34] 📊 Patient Response
     └─ patientFName: Beverly
     └─ patientLName: Schoen
     └─ dob: 12/14/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6112015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 46 Abner Potter Way
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:08:34] ✅    ✅ Patient identified: Beverly Schoen
[07:08:34] ✅    ✅ Patient name validation passed
[07:08:34] 🔄 
🔄 Step 3: Processing patient dates...
[07:08:34] [DOC: 9234915] ℹ️  DOB normalized: 12/14/1946
[07:08:34] [DOC: 9234915] ℹ️  Episode startOfCare normalized: 03/27/2025
[07:08:34] [DOC: 9234915] ℹ️  Episode startOfEpisode normalized: 03/27/2025
[07:08:34] [DOC: 9234915] ℹ️  Episode endOfEpisode normalized: 05/25/2025
[07:08:34] [DOC: 9234915] ✅ Patient date processing completed successfully
[07:08:34] ✅    ✅ Date processing completed
[07:08:34] 📊 Processed Patient Data
     └─ patientFName: Beverly
     └─ patientLName: Schoen
     └─ dob: 12/14/1946
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 6112015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 46 Abner Potter Way
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/27/2025', 'startOfEpisode': '03/27/2025', 'endOfEpisode': '05/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:08:34] 🔄 
🔄 Step 4: Extracting order data...
[07:08:36] ℹ️  Order extraction - MRN: ''
[07:08:36] ℹ️  Order extraction - Sex: 'FEMALE'
[07:08:36] ℹ️  Order extraction - Service Line: 'PT'
[07:08:36] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:08:36] ✅ Order data extraction completed successfully
[07:08:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:08:36] ℹ️  Using MRN from patient data: '6112015'
[07:08:36] ℹ️  Service line consistent in both sources: 'PT'
[07:08:36] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:08:36] ✅ Patient name cross-validation successful
[07:08:36] ✅    ✅ Data merged successfully
[07:08:38] ✅    ✅ Order data extracted and validated
[07:08:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:08:38] [DOC: 9234915] ✅ Patient found in local cache: Beverly Schoen, ID: d8ab59f6-e53d-4690-a132-0c8e7e1fae17
[07:08:38] ✅    ✅ Existing patient found with ID: d8ab59f6-e53d-4690-a132-0c8e7e1fae17
[07:08:38] 🔄 
🔄 Step 6: Pushing order to API...
[07:08:38] [DOC: 9234915] ℹ️  Pushing order via API for patient ID: d8ab59f6-e53d-4690-a132-0c8e7e1fae17
[07:08:39] [DOC: 9234915] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:08:39] ❌    ❌ Failed to push order
[07:08:39] 🔄 
🔄 Step 7: Writing to CSV...
[07:08:39] [DOC: 9234915] ℹ️  Calculated age: 78 from DOB: 12/14/1946
[07:08:39] [DOC: 9234915] ℹ️  Service Line extracted: 'PT'
[07:08:39] [DOC: 9234915] ℹ️  Payer Source extracted: 'Medicare'
[07:08:39] [DOC: 9234915] ℹ️  Diagnosis codes being written:
[07:08:39] [DOC: 9234915] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:08:39] [DOC: 9234915] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:08:39] [DOC: 9234915] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:08:39] [DOC: 9234915] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:08:39] [DOC: 9234915] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:08:39] [DOC: 9234915] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:08:39] [DOC: 9234915] ✅ Patient data written to CSV: Beverly Schoen | Sex: FEMALE | Age: 78 | Service: PT | Payer: Medicare | MRN: 6112015
[07:08:39] ✅    ✅ Document 9234915 processed and saved successfully
[07:08:39] 🔄 
🔄 Step 8: Saving API details...
[07:08:39] [DOC: 9234915] ℹ️  API push details saved for document 9234915
[07:08:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234908                         ║
================================================================================
[07:08:39] ℹ️  Agency: Dartmouth HH
[07:08:39] ℹ️  Date: 04/11/2025
[07:08:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:08:41] [DOC: 9234908] ✅ Text extracted using pdfplumber (1233 chars)
[07:08:41] ✅    ✅ Text extracted using pdfplumber (1233 chars)
[07:08:41] 🔄 
🔄 Step 2: Extracting patient data...
[07:08:44] ℹ️  AI extracted raw sex value: 'F'
[07:08:44] ℹ️  AI extracted service line: 'HHA'
[07:08:44] ℹ️  AI extracted payer source: 'Medicare'
[07:08:44] ℹ️  AI extracted diagnoses:
[07:08:44] ℹ️    - Diagnosis 1: ''
[07:08:44] ℹ️    - Diagnosis 2: ''
[07:08:44] ℹ️    - Diagnosis 3: ''
[07:08:44] ℹ️    - Diagnosis 4: ''
[07:08:44] ℹ️    - Diagnosis 5: ''
[07:08:44] ℹ️    - Diagnosis 6: ''
[07:08:44] ℹ️  Final extracted MRN: '2429011'
[07:08:44] ℹ️  Final extracted Sex: 'FEMALE'
[07:08:44] ℹ️  Final extracted Service Line: 'HHA'
[07:08:44] ℹ️  Final extracted Payer Source: 'Medicare'
[07:08:44] ✅ Patient data extraction completed successfully
[07:08:44] ✅    ✅ Patient data extracted successfully
[07:08:44] 📊 Patient Response
     └─ patientFName: Eduarda
     └─ patientLName: Demello
     └─ dob: 09/29/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2429011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/04/2024', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:08:44] ✅    ✅ Patient identified: Eduarda Demello
[07:08:44] ✅    ✅ Patient name validation passed
[07:08:44] 🔄 
🔄 Step 3: Processing patient dates...
[07:08:44] [DOC: 9234908] ℹ️  DOB normalized: 09/29/1942
[07:08:44] [DOC: 9234908] ℹ️  Episode startOfCare normalized: 11/04/2024
[07:08:44] [DOC: 9234908] ℹ️  Episode startOfEpisode normalized: 03/04/2025
[07:08:44] [DOC: 9234908] ℹ️  Episode endOfEpisode normalized: 05/02/2025
[07:08:44] [DOC: 9234908] ✅ Patient date processing completed successfully
[07:08:44] ✅    ✅ Date processing completed
[07:08:44] 📊 Processed Patient Data
     └─ patientFName: Eduarda
     └─ patientLName: Demello
     └─ dob: 09/29/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2429011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: HHA
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/04/2024', 'startOfEpisode': '03/04/2025', 'endOfEpisode': '05/02/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:08:44] 🔄 
🔄 Step 4: Extracting order data...
[07:08:46] ℹ️  Order extraction - MRN: ''
[07:08:46] ℹ️  Order extraction - Sex: 'FEMALE'
[07:08:46] ℹ️  Order extraction - Service Line: ''
[07:08:46] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:08:46] ✅ Order data extraction completed successfully
[07:08:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:08:46] ℹ️  Using MRN from patient data: '2429011'
[07:08:46] ℹ️  Using service line from patient data: 'HHA'
[07:08:46] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:08:46] ✅ Patient name cross-validation successful
[07:08:46] ✅    ✅ Data merged successfully
[07:08:48] ✅    ✅ Order data extracted and validated
[07:08:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:08:48] [DOC: 9234908] ✅ Patient found in local cache: Eduarda Demello, ID: 1c325c5b-5ef1-405d-9b3b-4d166788bcda
[07:08:48] ✅    ✅ Existing patient found with ID: 1c325c5b-5ef1-405d-9b3b-4d166788bcda
[07:08:48] 🔄 
🔄 Step 6: Pushing order to API...
[07:08:48] [DOC: 9234908] ℹ️  Pushing order via API for patient ID: 1c325c5b-5ef1-405d-9b3b-4d166788bcda
[07:08:49] [DOC: 9234908] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13804"}
[07:08:49] ❌    ❌ Failed to push order
[07:08:49] 🔄 
🔄 Step 7: Writing to CSV...
[07:08:49] [DOC: 9234908] ℹ️  Calculated age: 82 from DOB: 09/29/1942
[07:08:49] [DOC: 9234908] ℹ️  Service Line extracted: 'HHA'
[07:08:49] [DOC: 9234908] ℹ️  Payer Source extracted: 'Medicare'
[07:08:49] [DOC: 9234908] ℹ️  Diagnosis codes being written:
[07:08:49] [DOC: 9234908] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:08:49] [DOC: 9234908] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:08:49] [DOC: 9234908] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:08:49] [DOC: 9234908] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:08:49] [DOC: 9234908] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:08:49] [DOC: 9234908] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:08:49] [DOC: 9234908] ✅ Patient data written to CSV: Eduarda Demello | Sex: FEMALE | Age: 82 | Service: HHA | Payer: Medicare | MRN: 2429011
[07:08:49] ✅    ✅ Document 9234908 processed and saved successfully
[07:08:49] 🔄 
🔄 Step 8: Saving API details...
[07:08:49] [DOC: 9234908] ℹ️  API push details saved for document 9234908
[07:08:49] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234905                         ║
================================================================================
[07:08:49] ℹ️  Agency: Dartmouth HH
[07:08:49] ℹ️  Date: 04/11/2025
[07:08:49] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:08:51] [DOC: 9234905] ✅ Text extracted using pdfplumber (6084 chars)
[07:08:51] ✅    ✅ Text extracted using pdfplumber (6084 chars)
[07:08:51] 🔄 
🔄 Step 2: Extracting patient data...
[07:08:54] ℹ️  AI extracted raw sex value: 'F'
[07:08:54] ℹ️  AI extracted service line: 'OT'
[07:08:54] ℹ️  AI extracted payer source: 'Medicare'
[07:08:54] ℹ️  AI extracted diagnoses:
[07:08:54] ℹ️    - Diagnosis 1: 'None'
[07:08:54] ℹ️    - Diagnosis 2: 'None'
[07:08:54] ℹ️    - Diagnosis 3: 'None'
[07:08:54] ℹ️    - Diagnosis 4: 'None'
[07:08:54] ℹ️    - Diagnosis 5: 'None'
[07:08:54] ℹ️    - Diagnosis 6: 'None'
[07:08:54] ℹ️  Final extracted MRN: '3649009'
[07:08:54] ℹ️  Final extracted Sex: 'FEMALE'
[07:08:54] ℹ️  Final extracted Service Line: 'OT'
[07:08:54] ℹ️  Final extracted Payer Source: 'Medicare'
[07:08:54] ✅ Patient data extraction completed successfully
[07:08:54] ✅    ✅ Patient data extracted successfully
[07:08:54] 📊 Patient Response
     └─ patientFName: Dorothy
     └─ patientLName: Fernandes
     └─ dob: 10/01/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3649009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[07:08:54] ✅    ✅ Patient identified: Dorothy Fernandes
[07:08:54] ✅    ✅ Patient name validation passed
[07:08:54] 🔄 
🔄 Step 3: Processing patient dates...
[07:08:54] [DOC: 9234905] ℹ️  DOB normalized: 10/01/1937
[07:08:54] [DOC: 9234905] ℹ️  Episode startOfCare normalized: 03/22/2025
[07:08:54] [DOC: 9234905] ℹ️  Episode startOfEpisode normalized: 03/22/2025
[07:08:54] [DOC: 9234905] ℹ️  Episode endOfEpisode normalized: 05/20/2025
[07:08:54] [DOC: 9234905] ✅ Patient date processing completed successfully
[07:08:54] ✅    ✅ Date processing completed
[07:08:54] 📊 Processed Patient Data
     └─ patientFName: Dorothy
     └─ patientLName: Fernandes
     └─ dob: 10/01/1937
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3649009
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/22/2025', 'startOfEpisode': '03/22/2025', 'endOfEpisode': '05/20/2025'}]
[07:08:54] 🔄 
🔄 Step 4: Extracting order data...
[07:08:57] ℹ️  Order extraction - MRN: ''
[07:08:57] ℹ️  Order extraction - Sex: 'FEMALE'
[07:08:57] ℹ️  Order extraction - Service Line: 'OT'
[07:08:57] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:08:57] ✅ Order data extraction completed successfully
[07:08:57] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:08:57] ℹ️  Using MRN from patient data: '3649009'
[07:08:57] ℹ️  Service line consistent in both sources: 'OT'
[07:08:57] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:08:57] ✅ Patient name cross-validation successful
[07:08:57] ✅    ✅ Data merged successfully
[07:08:58] ✅    ✅ Order data extracted and validated
[07:08:58] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:08:58] [DOC: 9234905] ✅ Patient found in local cache: Dorothy Fernandes, ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[07:08:58] ✅    ✅ Existing patient found with ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[07:08:58] 🔄 
🔄 Step 6: Pushing order to API...
[07:08:58] [DOC: 9234905] ℹ️  Pushing order via API for patient ID: 8d0550db-b3b9-4811-bacb-2e46434cd2f7
[07:09:00] [DOC: 9234905] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:09:00] ❌    ❌ Failed to push order
[07:09:00] 🔄 
🔄 Step 7: Writing to CSV...
[07:09:00] [DOC: 9234905] ℹ️  Calculated age: 87 from DOB: 10/01/1937
[07:09:00] [DOC: 9234905] ℹ️  Service Line extracted: 'OT'
[07:09:00] [DOC: 9234905] ℹ️  Payer Source extracted: 'Medicare'
[07:09:00] [DOC: 9234905] ℹ️  Diagnosis codes being written:
[07:09:00] [DOC: 9234905] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:09:00] [DOC: 9234905] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:09:00] [DOC: 9234905] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:09:00] [DOC: 9234905] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:09:00] [DOC: 9234905] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:09:00] [DOC: 9234905] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:09:00] [DOC: 9234905] ✅ Patient data written to CSV: Dorothy Fernandes | Sex: FEMALE | Age: 87 | Service: OT | Payer: Medicare | MRN: 3649009
[07:09:00] ✅    ✅ Document 9234905 processed and saved successfully
[07:09:00] 🔄 
🔄 Step 8: Saving API details...
[07:09:00] [DOC: 9234905] ℹ️  API push details saved for document 9234905
[07:09:00] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234889                         ║
================================================================================
[07:09:00] ℹ️  Agency: Dartmouth HH
[07:09:00] ℹ️  Date: 04/11/2025
[07:09:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:09:02] [DOC: 9234889] ✅ Text extracted using pdfplumber (1265 chars)
[07:09:02] ✅    ✅ Text extracted using pdfplumber (1265 chars)
[07:09:02] 🔄 
🔄 Step 2: Extracting patient data...
[07:09:04] ℹ️  AI extracted raw sex value: 'F'
[07:09:04] ℹ️  AI extracted service line: 'Skilled Nursing'
[07:09:04] ℹ️  AI extracted payer source: 'Medicare'
[07:09:04] ℹ️  AI extracted diagnoses:
[07:09:04] ℹ️    - Diagnosis 1: ''
[07:09:04] ℹ️    - Diagnosis 2: ''
[07:09:04] ℹ️    - Diagnosis 3: ''
[07:09:04] ℹ️    - Diagnosis 4: ''
[07:09:04] ℹ️    - Diagnosis 5: ''
[07:09:04] ℹ️    - Diagnosis 6: ''
[07:09:04] ℹ️  Final extracted MRN: '919015'
[07:09:04] ℹ️  Final extracted Sex: 'FEMALE'
[07:09:04] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[07:09:04] ℹ️  Final extracted Payer Source: 'Medicare'
[07:09:04] ✅ Patient data extraction completed successfully
[07:09:04] ✅    ✅ Patient data extracted successfully
[07:09:04] 📊 Patient Response
     └─ patientFName: Julieta
     └─ patientLName: Pereira
     └─ dob: 03/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 919015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/26/2024', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:09:04] ✅    ✅ Patient identified: Julieta Pereira
[07:09:04] ✅    ✅ Patient name validation passed
[07:09:04] 🔄 
🔄 Step 3: Processing patient dates...
[07:09:04] [DOC: 9234889] ℹ️  DOB normalized: 03/23/1941
[07:09:04] [DOC: 9234889] ℹ️  Episode startOfCare normalized: 11/26/2024
[07:09:04] [DOC: 9234889] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[07:09:04] [DOC: 9234889] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[07:09:04] [DOC: 9234889] ✅ Patient date processing completed successfully
[07:09:04] ✅    ✅ Date processing completed
[07:09:04] 📊 Processed Patient Data
     └─ patientFName: Julieta
     └─ patientLName: Pereira
     └─ dob: 03/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 919015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/26/2024', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:09:04] 🔄 
🔄 Step 4: Extracting order data...
[07:09:07] ℹ️  Order extraction - MRN: '919015'
[07:09:07] ℹ️  Order extraction - Sex: 'FEMALE'
[07:09:07] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[07:09:07] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:09:07] ✅ Order data extraction completed successfully
[07:09:07] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:09:07] ℹ️  Using MRN from patient data: '919015' over '919015'
[07:09:07] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[07:09:07] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:09:07] ✅ Patient name cross-validation successful
[07:09:07] ✅    ✅ Data merged successfully
[07:09:08] ✅    ✅ Order data extracted and validated
[07:09:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:09:08] [DOC: 9234889] ✅ Patient found in local cache: Julieta Pereira, ID: c2e7114d-362f-4392-9923-06c73f2eab17
[07:09:08] ✅    ✅ Existing patient found with ID: c2e7114d-362f-4392-9923-06c73f2eab17
[07:09:08] 🔄 
🔄 Step 6: Pushing order to API...
[07:09:08] [DOC: 9234889] ℹ️  Pushing order via API for patient ID: c2e7114d-362f-4392-9923-06c73f2eab17
[07:09:09] [DOC: 9234889] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:09:09] ❌    ❌ Failed to push order
[07:09:09] 🔄 
🔄 Step 7: Writing to CSV...
[07:09:09] [DOC: 9234889] ℹ️  Calculated age: 84 from DOB: 03/23/1941
[07:09:09] [DOC: 9234889] ℹ️  Service Line extracted: 'Skilled Nursing'
[07:09:09] [DOC: 9234889] ℹ️  Payer Source extracted: 'Medicare'
[07:09:09] [DOC: 9234889] ℹ️  Diagnosis codes being written:
[07:09:09] [DOC: 9234889] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:09:09] [DOC: 9234889] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:09:09] [DOC: 9234889] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:09:09] [DOC: 9234889] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:09:09] [DOC: 9234889] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:09:09] [DOC: 9234889] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:09:09] [DOC: 9234889] ✅ Patient data written to CSV: Julieta Pereira | Sex: FEMALE | Age: 84 | Service: Skilled Nursing | Payer: Medicare | MRN: 919015
[07:09:09] ✅    ✅ Document 9234889 processed and saved successfully
[07:09:09] 🔄 
🔄 Step 8: Saving API details...
[07:09:09] [DOC: 9234889] ℹ️  API push details saved for document 9234889
[07:09:09] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234884                         ║
================================================================================
[07:09:09] ℹ️  Agency: Dartmouth HH
[07:09:09] ℹ️  Date: 04/11/2025
[07:09:09] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:09:11] [DOC: 9234884] ✅ Text extracted using pdfplumber (1851 chars)
[07:09:11] ✅    ✅ Text extracted using pdfplumber (1851 chars)
[07:09:11] 🔄 
🔄 Step 2: Extracting patient data...
[07:09:14] ℹ️  AI extracted raw sex value: 'M'
[07:09:14] ℹ️  AI extracted service line: 'RN, LPN'
[07:09:14] ℹ️  AI extracted payer source: 'Fallon Health'
[07:09:14] ℹ️  AI extracted diagnoses:
[07:09:14] ℹ️    - Diagnosis 1: 'None'
[07:09:14] ℹ️    - Diagnosis 2: 'None'
[07:09:14] ℹ️    - Diagnosis 3: 'None'
[07:09:14] ℹ️    - Diagnosis 4: 'None'
[07:09:14] ℹ️    - Diagnosis 5: 'None'
[07:09:14] ℹ️    - Diagnosis 6: 'None'
[07:09:14] ℹ️  Final extracted MRN: '6310015'
[07:09:14] ℹ️  Final extracted Sex: 'MALE'
[07:09:14] ℹ️  Final extracted Service Line: 'RN, LPN'
[07:09:14] ℹ️  Final extracted Payer Source: 'Fallon Health'
[07:09:14] ✅ Patient data extraction completed successfully
[07:09:14] ✅    ✅ Patient data extracted successfully
[07:09:14] 📊 Patient Response
     └─ patientFName: Augusto
     └─ patientLName: Dejesus
     └─ dob: 02/02/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 6310015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 28 Manhattan Avenue
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2025', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[07:09:14] ✅    ✅ Patient identified: Augusto Dejesus
[07:09:14] ✅    ✅ Patient name validation passed
[07:09:14] 🔄 
🔄 Step 3: Processing patient dates...
[07:09:14] [DOC: 9234884] ℹ️  DOB normalized: 02/02/1940
[07:09:14] [DOC: 9234884] ℹ️  Episode startOfCare normalized: 03/30/2025
[07:09:14] [DOC: 9234884] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[07:09:14] [DOC: 9234884] ℹ️  Episode endOfEpisode normalized: 05/28/2025
[07:09:14] [DOC: 9234884] ✅ Patient date processing completed successfully
[07:09:14] ✅    ✅ Date processing completed
[07:09:14] 📊 Processed Patient Data
     └─ patientFName: Augusto
     └─ patientLName: Dejesus
     └─ dob: 02/02/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 6310015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 28 Manhattan Avenue
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: RN, LPN
     └─ payorSource: Fallon Health
     └─ episodeDiagnoses: [{'startOfCare': '03/30/2025', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025'}]
[07:09:14] 🔄 
🔄 Step 4: Extracting order data...
[07:09:17] ℹ️  Order extraction - MRN: '6310015'
[07:09:17] ℹ️  Order extraction - Sex: 'MALE'
[07:09:17] ℹ️  Order extraction - Service Line: 'RN, LPN'
[07:09:17] ℹ️  Order extraction - Payer Source: 'Fallon Health'
[07:09:17] ✅ Order data extraction completed successfully
[07:09:17] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:09:17] ℹ️  Using MRN from patient data: '6310015' over '6310015'
[07:09:17] ℹ️  Service line consistent in both sources: 'RN, LPN'
[07:09:17] ℹ️  Payer source consistent in both sources: 'Fallon Health'
[07:09:17] ✅ Patient name cross-validation successful
[07:09:17] ✅    ✅ Data merged successfully
[07:09:18] ✅    ✅ Order data extracted and validated
[07:09:18] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:09:18] [DOC: 9234884] ✅ Patient found in local cache: Augusto Dejesus, ID: 3438e7f3-83b0-4cca-8df4-3ff0f30080f6
[07:09:18] ✅    ✅ Existing patient found with ID: 3438e7f3-83b0-4cca-8df4-3ff0f30080f6
[07:09:18] 🔄 
🔄 Step 6: Pushing order to API...
[07:09:18] [DOC: 9234884] ℹ️  Pushing order via API for patient ID: 3438e7f3-83b0-4cca-8df4-3ff0f30080f6
[07:09:20] [DOC: 9234884] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:09:20] ❌    ❌ Failed to push order
[07:09:20] 🔄 
🔄 Step 7: Writing to CSV...
[07:09:20] [DOC: 9234884] ℹ️  Calculated age: 85 from DOB: 02/02/1940
[07:09:20] [DOC: 9234884] ℹ️  Service Line extracted: 'RN, LPN'
[07:09:20] [DOC: 9234884] ℹ️  Payer Source extracted: 'Fallon Health'
[07:09:20] [DOC: 9234884] ℹ️  Diagnosis codes being written:
[07:09:20] [DOC: 9234884] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:09:20] [DOC: 9234884] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:09:20] [DOC: 9234884] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:09:20] [DOC: 9234884] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:09:20] [DOC: 9234884] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:09:20] [DOC: 9234884] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:09:20] [DOC: 9234884] ✅ Patient data written to CSV: Augusto Dejesus | Sex: MALE | Age: 85 | Service: RN, LPN | Payer: Fallon Health | MRN: 6310015
[07:09:20] ✅    ✅ Document 9234884 processed and saved successfully
[07:09:20] 🔄 
🔄 Step 8: Saving API details...
[07:09:20] [DOC: 9234884] ℹ️  API push details saved for document 9234884
[07:09:20] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234878                         ║
================================================================================
[07:09:20] ℹ️  Agency: Dartmouth HH
[07:09:20] ℹ️  Date: 04/11/2025
[07:09:20] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:09:23] [DOC: 9234878] ✅ Text extracted using pdfplumber (4445 chars)
[07:09:23] ✅    ✅ Text extracted using pdfplumber (4445 chars)
[07:09:23] 🔄 
🔄 Step 2: Extracting patient data...
[07:09:26] ℹ️  AI extracted raw sex value: 'M'
[07:09:26] ℹ️  AI extracted service line: 'OT, RN'
[07:09:26] ℹ️  AI extracted payer source: 'Blue Cross Medicare Adv'
[07:09:26] ℹ️  AI extracted diagnoses:
[07:09:26] ℹ️    - Diagnosis 1: ''
[07:09:26] ℹ️    - Diagnosis 2: ''
[07:09:26] ℹ️    - Diagnosis 3: ''
[07:09:26] ℹ️    - Diagnosis 4: ''
[07:09:26] ℹ️    - Diagnosis 5: ''
[07:09:26] ℹ️    - Diagnosis 6: ''
[07:09:26] ℹ️  Final extracted MRN: '6278015'
[07:09:26] ℹ️  Final extracted Sex: 'MALE'
[07:09:26] ℹ️  Final extracted Service Line: 'OT, RN'
[07:09:26] ℹ️  Final extracted Payer Source: 'Blue Cross Medicare Adv'
[07:09:26] ✅ Patient data extraction completed successfully
[07:09:26] ✅    ✅ Patient data extracted successfully
[07:09:26] 📊 Patient Response
     └─ patientFName: Joao
     └─ patientLName: Matias
     └─ dob: 04/20/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 6278015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:09:26] ✅    ✅ Patient identified: Joao Matias
[07:09:26] ✅    ✅ Patient name validation passed
[07:09:26] 🔄 
🔄 Step 3: Processing patient dates...
[07:09:26] [DOC: 9234878] ℹ️  DOB normalized: 04/20/1954
[07:09:26] [DOC: 9234878] ℹ️  Episode startOfCare normalized: 03/26/2025
[07:09:26] [DOC: 9234878] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[07:09:26] [DOC: 9234878] ℹ️  Episode endOfEpisode normalized: 05/24/2025
[07:09:26] [DOC: 9234878] ✅ Patient date processing completed successfully
[07:09:26] ✅    ✅ Date processing completed
[07:09:26] 📊 Processed Patient Data
     └─ patientFName: Joao
     └─ patientLName: Matias
     └─ dob: 04/20/1954
     └─ patientSex: MALE
     └─ medicalRecordNo: 6278015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT, RN
     └─ payorSource: Blue Cross Medicare Adv
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '05/24/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:09:26] 🔄 
🔄 Step 4: Extracting order data...
[07:09:28] ℹ️  Order extraction - MRN: ''
[07:09:28] ℹ️  Order extraction - Sex: 'MALE'
[07:09:28] ℹ️  Order extraction - Service Line: 'OT, RN'
[07:09:28] ℹ️  Order extraction - Payer Source: 'Blue Cross Medicare Adv'
[07:09:28] ✅ Order data extraction completed successfully
[07:09:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:09:28] ℹ️  Using MRN from patient data: '6278015'
[07:09:28] ℹ️  Service line consistent in both sources: 'OT, RN'
[07:09:28] ℹ️  Payer source consistent in both sources: 'Blue Cross Medicare Adv'
[07:09:28] ✅ Patient name cross-validation successful
[07:09:28] ✅    ✅ Data merged successfully
[07:09:29] ✅    ✅ Order data extracted and validated
[07:09:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:09:29] [DOC: 9234878] ✅ Patient found in local cache: Joao Matias, ID: 162e9796-685d-41fc-9319-ed281e05db28
[07:09:29] ✅    ✅ Existing patient found with ID: 162e9796-685d-41fc-9319-ed281e05db28
[07:09:29] 🔄 
🔄 Step 6: Pushing order to API...
[07:09:29] [DOC: 9234878] ℹ️  Pushing order via API for patient ID: 162e9796-685d-41fc-9319-ed281e05db28
[07:09:30] [DOC: 9234878] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14043"}
[07:09:30] ❌    ❌ Failed to push order
[07:09:30] 🔄 
🔄 Step 7: Writing to CSV...
[07:09:30] [DOC: 9234878] ℹ️  Calculated age: 71 from DOB: 04/20/1954
[07:09:30] [DOC: 9234878] ℹ️  Service Line extracted: 'OT, RN'
[07:09:30] [DOC: 9234878] ℹ️  Payer Source extracted: 'Blue Cross Medicare Adv'
[07:09:30] [DOC: 9234878] ℹ️  Diagnosis codes being written:
[07:09:30] [DOC: 9234878] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:09:30] [DOC: 9234878] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:09:30] [DOC: 9234878] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:09:30] [DOC: 9234878] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:09:30] [DOC: 9234878] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:09:30] [DOC: 9234878] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:09:30] [DOC: 9234878] ✅ Patient data written to CSV: Joao Matias | Sex: MALE | Age: 71 | Service: OT, RN | Payer: Blue Cross Medicare Adv | MRN: 6278015
[07:09:30] ✅    ✅ Document 9234878 processed and saved successfully
[07:09:30] 🔄 
🔄 Step 8: Saving API details...
[07:09:30] [DOC: 9234878] ℹ️  API push details saved for document 9234878
[07:09:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234866                         ║
================================================================================
[07:09:30] ℹ️  Agency: Dartmouth HH
[07:09:30] ℹ️  Date: 04/11/2025
[07:09:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:09:32] [DOC: 9234866] ✅ Text extracted using pdfplumber (1123 chars)
[07:09:32] ✅    ✅ Text extracted using pdfplumber (1123 chars)
[07:09:32] 🔄 
🔄 Step 2: Extracting patient data...
[07:09:35] ℹ️  AI extracted raw sex value: 'M'
[07:09:35] ℹ️  AI extracted service line: 'Wound Healing'
[07:09:35] ℹ️  AI extracted payer source: 'Tufts Health Plan Medicare Preferred'
[07:09:35] ℹ️  AI extracted diagnoses:
[07:09:35] ℹ️    - Diagnosis 1: ''
[07:09:35] ℹ️    - Diagnosis 2: ''
[07:09:35] ℹ️    - Diagnosis 3: ''
[07:09:35] ℹ️    - Diagnosis 4: ''
[07:09:35] ℹ️    - Diagnosis 5: ''
[07:09:35] ℹ️    - Diagnosis 6: ''
[07:09:35] ℹ️  Final extracted MRN: '4777015'
[07:09:35] ℹ️  Final extracted Sex: 'MALE'
[07:09:35] ℹ️  Final extracted Service Line: 'Wound Healing'
[07:09:35] ℹ️  Final extracted Payer Source: 'Tufts Health Plan Medicare Preferred'
[07:09:35] ✅ Patient data extraction completed successfully
[07:09:35] ✅    ✅ Patient data extracted successfully
[07:09:35] 📊 Patient Response
     └─ patientFName: Dennis
     └─ patientLName: Langevin
     └─ dob: 04/22/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 4777015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 916 Bristol Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Wound Healing
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '08/21/2024', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:09:35] ✅    ✅ Patient identified: Dennis Langevin
[07:09:35] ✅    ✅ Patient name validation passed
[07:09:35] 🔄 
🔄 Step 3: Processing patient dates...
[07:09:35] [DOC: 9234866] ℹ️  DOB normalized: 04/22/1944
[07:09:35] [DOC: 9234866] ℹ️  Episode startOfCare normalized: 08/21/2024
[07:09:35] [DOC: 9234866] ℹ️  Episode startOfEpisode normalized: 02/17/2025
[07:09:35] [DOC: 9234866] ℹ️  Episode endOfEpisode normalized: 04/17/2025
[07:09:35] [DOC: 9234866] ✅ Patient date processing completed successfully
[07:09:35] ✅    ✅ Date processing completed
[07:09:35] 📊 Processed Patient Data
     └─ patientFName: Dennis
     └─ patientLName: Langevin
     └─ dob: 04/22/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 4777015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 916 Bristol Street
     └─ city: New Bedford
     └─ state: MA
     └─ zip: 02745
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Wound Healing
     └─ payorSource: Tufts Health Plan Medicare Preferred
     └─ episodeDiagnoses: [{'startOfCare': '08/21/2024', 'startOfEpisode': '02/17/2025', 'endOfEpisode': '04/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:09:35] 🔄 
🔄 Step 4: Extracting order data...
[07:09:38] ℹ️  Order extraction - MRN: '4777015'
[07:09:38] ℹ️  Order extraction - Sex: 'MALE'
[07:09:38] ℹ️  Order extraction - Service Line: 'Wound Healing'
[07:09:38] ℹ️  Order extraction - Payer Source: 'Tufts Health Plan Medicare Preferred'
[07:09:38] ✅ Order data extraction completed successfully
[07:09:38] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:09:38] ℹ️  Using MRN from patient data: '4777015' over '4777015'
[07:09:38] ℹ️  Service line consistent in both sources: 'Wound Healing'
[07:09:38] ℹ️  Payer source consistent in both sources: 'Tufts Health Plan Medicare Preferred'
[07:09:38] ✅ Patient name cross-validation successful
[07:09:38] ✅    ✅ Data merged successfully
[07:09:39] ✅    ✅ Order data extracted and validated
[07:09:39] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:10:03] [DOC: 9234866] ✅ Patient exists in API: Dennis Langevin, ID: 8f2fccd6-0a07-4268-877c-ebb79b4b40f1
[07:10:03] ✅    ✅ Existing patient found with ID: 8f2fccd6-0a07-4268-877c-ebb79b4b40f1
[07:10:03] 🔄 
🔄 Step 6: Pushing order to API...
[07:10:03] [DOC: 9234866] ℹ️  Pushing order via API for patient ID: 8f2fccd6-0a07-4268-877c-ebb79b4b40f1
[07:10:04] [DOC: 9234866] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:10:04] ❌    ❌ Failed to push order
[07:10:04] 🔄 
🔄 Step 7: Writing to CSV...
[07:10:04] [DOC: 9234866] ℹ️  Calculated age: 81 from DOB: 04/22/1944
[07:10:04] [DOC: 9234866] ℹ️  Service Line extracted: 'Wound Healing'
[07:10:04] [DOC: 9234866] ℹ️  Payer Source extracted: 'Tufts Health Plan Medicare Preferred'
[07:10:04] [DOC: 9234866] ℹ️  Diagnosis codes being written:
[07:10:04] [DOC: 9234866] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:10:04] [DOC: 9234866] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:10:04] [DOC: 9234866] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:10:04] [DOC: 9234866] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:10:04] [DOC: 9234866] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:10:04] [DOC: 9234866] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:10:04] [DOC: 9234866] ✅ Patient data written to CSV: Dennis Langevin | Sex: MALE | Age: 81 | Service: Wound Healing | Payer: Tufts Health Plan Medicare Preferred | MRN: 4777015
[07:10:04] ✅    ✅ Document 9234866 processed and saved successfully
[07:10:04] 🔄 
🔄 Step 8: Saving API details...
[07:10:04] [DOC: 9234866] ℹ️  API push details saved for document 9234866
[07:10:04] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234842                         ║
================================================================================
[07:10:04] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[07:10:04] ℹ️  Date: 04/11/2025
[07:10:04] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:10:07] [DOC: 9234842] ✅ Text extracted using pdfplumber (1556 chars)
[07:10:07] ✅    ✅ Text extracted using pdfplumber (1556 chars)
[07:10:07] 🔄 
🔄 Step 2: Extracting patient data...
[07:10:10] ℹ️  AI extracted raw sex value: ''
[07:10:10] ℹ️  AI extracted service line: 'Occupational Therapy'
[07:10:10] ℹ️  AI extracted payer source: ''
[07:10:10] ℹ️  AI extracted diagnoses:
[07:10:10] ℹ️    - Diagnosis 1: 'J43.9'
[07:10:10] ℹ️    - Diagnosis 2: 'J96.11'
[07:10:10] ℹ️    - Diagnosis 3: 'J96.12'
[07:10:10] ℹ️    - Diagnosis 4: ''
[07:10:10] ℹ️    - Diagnosis 5: ''
[07:10:10] ℹ️    - Diagnosis 6: ''
[07:10:10] ℹ️  Final extracted MRN: 'MA250331114803'
[07:10:10] ℹ️  Final extracted Sex: ''
[07:10:10] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[07:10:10] ℹ️  Final extracted Payer Source: ''
[07:10:10] ✅ Patient data extraction completed successfully
[07:10:10] ✅    ✅ Patient data extracted successfully
[07:10:10] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'J43.9', 'secondDiagnosis': 'J96.11', 'thirdDiagnosis': 'J96.12', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:10:10] ✅    ✅ Patient identified: David Sturgeon
[07:10:10] ✅    ✅ Patient name validation passed
[07:10:10] 🔄 
🔄 Step 3: Processing patient dates...
[07:10:10] [DOC: 9234842] ℹ️  DOB normalized: 11/14/1948
[07:10:10] [DOC: 9234842] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[07:10:10] [DOC: 9234842] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[07:10:10] [DOC: 9234842] ✅ Patient date processing completed successfully
[07:10:10] ✅    ✅ Date processing completed
[07:10:10] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'J43.9', 'secondDiagnosis': 'J96.11', 'thirdDiagnosis': 'J96.12', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:10:10] 🔄 
🔄 Step 4: Extracting order data...
[07:10:12] ℹ️  Order extraction - MRN: 'MA250331114803'
[07:10:12] ℹ️  Order extraction - Sex: ''
[07:10:12] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[07:10:12] ℹ️  Order extraction - Payer Source: ''
[07:10:12] ✅ Order data extraction completed successfully
[07:10:12] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:10:12] ℹ️  Using MRN from patient data: 'MA250331114803' over 'MA250331114803'
[07:10:12] ℹ️  Inferred sex as MALE from name: David
[07:10:12] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[07:10:12] ✅ Patient name cross-validation successful
[07:10:12] ✅    ✅ Data merged successfully
[07:10:13] ✅    ✅ Order data extracted and validated
[07:10:13] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:10:13] [DOC: 9234842] ✅ Patient found in local cache: David Sturgeon, ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[07:10:13] ✅    ✅ Existing patient found with ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[07:10:13] 🔄 
🔄 Step 6: Pushing order to API...
[07:10:13] [DOC: 9234842] ℹ️  Pushing order via API for patient ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[07:10:15] [DOC: 9234842] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14462"}
[07:10:15] ❌    ❌ Failed to push order
[07:10:15] 🔄 
🔄 Step 7: Writing to CSV...
[07:10:15] [DOC: 9234842] ℹ️  Calculated age: 76 from DOB: 11/14/1948
[07:10:15] [DOC: 9234842] ℹ️  Service Line extracted: 'Occupational Therapy'
[07:10:15] [DOC: 9234842] ℹ️  Payer Source extracted: ''
[07:10:15] [DOC: 9234842] ℹ️  Diagnosis codes being written:
[07:10:15] [DOC: 9234842] ℹ️    - Latest_Episode_Firstdiagnosis: 'J43.9'
[07:10:15] [DOC: 9234842] ℹ️    - Latest_Episode_Seconddiagnosis: 'J96.11'
[07:10:15] [DOC: 9234842] ℹ️    - Latest_Episode_Thirddiagnosis: 'J96.12'
[07:10:15] [DOC: 9234842] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:10:15] [DOC: 9234842] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:10:15] [DOC: 9234842] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:10:15] [DOC: 9234842] ✅ Patient data written to CSV: David Sturgeon | Sex: MALE | Age: 76 | Service: Occupational Therapy | Payer:  | MRN: MA250331114803
[07:10:15] ✅    ✅ Document 9234842 processed and saved successfully
[07:10:15] 🔄 
🔄 Step 8: Saving API details...
[07:10:15] [DOC: 9234842] ℹ️  API push details saved for document 9234842
[07:10:15] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234838                         ║
================================================================================
[07:10:15] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[07:10:15] ℹ️  Date: 04/11/2025
[07:10:15] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:10:17] [DOC: 9234838] ✅ Text extracted using pdfplumber (1528 chars)
[07:10:17] ✅    ✅ Text extracted using pdfplumber (1528 chars)
[07:10:17] 🔄 
🔄 Step 2: Extracting patient data...
[07:10:20] ℹ️  AI extracted raw sex value: ''
[07:10:20] ℹ️  AI extracted service line: 'Physical Therapy'
[07:10:20] ℹ️  AI extracted payer source: ''
[07:10:20] ℹ️  AI extracted diagnoses:
[07:10:20] ℹ️    - Diagnosis 1: 'J43.9'
[07:10:20] ℹ️    - Diagnosis 2: 'J96.11'
[07:10:20] ℹ️    - Diagnosis 3: 'J96.12'
[07:10:20] ℹ️    - Diagnosis 4: 'None'
[07:10:20] ℹ️    - Diagnosis 5: 'None'
[07:10:20] ℹ️    - Diagnosis 6: 'None'
[07:10:20] ℹ️  Final extracted MRN: 'MA250331114803'
[07:10:20] ℹ️  Final extracted Sex: ''
[07:10:20] ℹ️  Final extracted Service Line: 'Physical Therapy'
[07:10:20] ℹ️  Final extracted Payer Source: ''
[07:10:20] ✅ Patient data extraction completed successfully
[07:10:20] ✅    ✅ Patient data extracted successfully
[07:10:20] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'J43.9', 'secondDiagnosis': 'J96.11', 'thirdDiagnosis': 'J96.12', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[07:10:20] ✅    ✅ Patient identified: David Sturgeon
[07:10:20] ✅    ✅ Patient name validation passed
[07:10:20] 🔄 
🔄 Step 3: Processing patient dates...
[07:10:20] [DOC: 9234838] ℹ️  DOB normalized: 11/14/1948
[07:10:20] [DOC: 9234838] ℹ️  Episode startOfEpisode normalized: 04/04/2025
[07:10:20] [DOC: 9234838] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[07:10:20] [DOC: 9234838] ✅ Patient date processing completed successfully
[07:10:20] ✅    ✅ Date processing completed
[07:10:20] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: ACHILLES ALCARAZ MD
     └─ npi: 1245548643
     └─ physicianNPI: 1245548643
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/04/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'J43.9', 'secondDiagnosis': 'J96.11', 'thirdDiagnosis': 'J96.12'}]
[07:10:20] 🔄 
🔄 Step 4: Extracting order data...
[07:10:23] ℹ️  Order extraction - MRN: 'MA250331114803'
[07:10:23] ℹ️  Order extraction - Sex: ''
[07:10:23] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[07:10:23] ℹ️  Order extraction - Payer Source: ''
[07:10:23] ✅ Order data extraction completed successfully
[07:10:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:10:23] ℹ️  Using MRN from patient data: 'MA250331114803' over 'MA250331114803'
[07:10:23] ℹ️  Inferred sex as MALE from name: David
[07:10:23] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[07:10:23] ✅ Patient name cross-validation successful
[07:10:23] ✅    ✅ Data merged successfully
[07:10:24] ✅    ✅ Order data extracted and validated
[07:10:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:10:24] [DOC: 9234838] ✅ Patient found in local cache: David Sturgeon, ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[07:10:24] ✅    ✅ Existing patient found with ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[07:10:24] 🔄 
🔄 Step 6: Pushing order to API...
[07:10:24] [DOC: 9234838] ℹ️  Pushing order via API for patient ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[07:10:26] [DOC: 9234838] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14463"}
[07:10:26] ❌    ❌ Failed to push order
[07:10:26] 🔄 
🔄 Step 7: Writing to CSV...
[07:10:26] [DOC: 9234838] ℹ️  Calculated age: 76 from DOB: 11/14/1948
[07:10:26] [DOC: 9234838] ℹ️  Service Line extracted: 'Physical Therapy'
[07:10:26] [DOC: 9234838] ℹ️  Payer Source extracted: ''
[07:10:26] [DOC: 9234838] ℹ️  Diagnosis codes being written:
[07:10:26] [DOC: 9234838] ℹ️    - Latest_Episode_Firstdiagnosis: 'J43.9'
[07:10:26] [DOC: 9234838] ℹ️    - Latest_Episode_Seconddiagnosis: 'J96.11'
[07:10:26] [DOC: 9234838] ℹ️    - Latest_Episode_Thirddiagnosis: 'J96.12'
[07:10:26] [DOC: 9234838] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:10:26] [DOC: 9234838] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:10:26] [DOC: 9234838] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:10:26] [DOC: 9234838] ✅ Patient data written to CSV: David Sturgeon | Sex: MALE | Age: 76 | Service: Physical Therapy | Payer:  | MRN: MA250331114803
[07:10:26] ✅    ✅ Document 9234838 processed and saved successfully
[07:10:26] 🔄 
🔄 Step 8: Saving API details...
[07:10:26] [DOC: 9234838] ℹ️  API push details saved for document 9234838
[07:10:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234837                         ║
================================================================================
[07:10:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[07:10:26] ℹ️  Date: 04/11/2025
[07:10:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:10:30] [DOC: 9234837] ✅ Text extracted using pdfplumber (18496 chars)
[07:10:30] ✅    ✅ Text extracted using pdfplumber (18496 chars)
[07:10:30] 🔄 
🔄 Step 2: Extracting patient data...
[07:10:34] ℹ️  AI extracted raw sex value: ''
[07:10:34] ℹ️  AI extracted service line: 'OT'
[07:10:34] ℹ️  AI extracted payer source: ''
[07:10:34] ℹ️  AI extracted diagnoses:
[07:10:34] ℹ️    - Diagnosis 1: 'CHRONIC HYPOXIC AND HYPERCAPNIC RESP FAILURE DUE TO COPD/EMPHYSEMA'
[07:10:34] ℹ️    - Diagnosis 2: 'SYNCOPE'
[07:10:34] ℹ️    - Diagnosis 3: 'Weakness'
[07:10:34] ℹ️    - Diagnosis 4: ''
[07:10:34] ℹ️    - Diagnosis 5: ''
[07:10:34] ℹ️    - Diagnosis 6: ''
[07:10:34] ℹ️  Final extracted MRN: 'MA250331114803'
[07:10:34] ℹ️  Final extracted Sex: ''
[07:10:34] ℹ️  Final extracted Service Line: 'OT'
[07:10:34] ℹ️  Final extracted Payer Source: ''
[07:10:34] ✅ Patient data extraction completed successfully
[07:10:34] ✅    ✅ Patient data extracted successfully
[07:10:34] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: Dr. Alcaraz, Achilles Romualdo E.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': 'CHRONIC HYPOXIC AND HYPERCAPNIC RESP FAILURE DUE TO COPD/EMPHYSEMA', 'secondDiagnosis': 'SYNCOPE', 'thirdDiagnosis': 'Weakness', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:10:34] ✅    ✅ Patient identified: David Sturgeon
[07:10:34] ✅    ✅ Patient name validation passed
[07:10:34] 🔄 
🔄 Step 3: Processing patient dates...
[07:10:34] [DOC: 9234837] ℹ️  DOB normalized: 11/14/1948
[07:10:34] [DOC: 9234837] ℹ️  Episode startOfCare normalized: 03/26/2025
[07:10:34] [DOC: 9234837] ℹ️  Episode startOfEpisode normalized: 03/26/2025
[07:10:34] [DOC: 9234837] ℹ️  Episode endOfEpisode normalized: 04/02/2025
[07:10:34] [DOC: 9234837] ✅ Patient date processing completed successfully
[07:10:34] ✅    ✅ Date processing completed
[07:10:34] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: 
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: Dr. Alcaraz, Achilles Romualdo E.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/26/2025', 'startOfEpisode': '03/26/2025', 'endOfEpisode': '04/02/2025', 'firstDiagnosis': 'CHRONIC HYPOXIC AND HYPERCAPNIC RESP FAILURE DUE TO COPD/EMPHYSEMA', 'secondDiagnosis': 'SYNCOPE', 'thirdDiagnosis': 'Weakness', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:10:34] 🔄 
🔄 Step 4: Extracting order data...
[07:10:37] ℹ️  Order extraction - MRN: 'MA250331114803'
[07:10:37] ℹ️  Order extraction - Sex: 'MALE'
[07:10:37] ℹ️  Order extraction - Service Line: 'OT'
[07:10:37] ℹ️  Order extraction - Payer Source: ''
[07:10:37] ✅ Order data extraction completed successfully
[07:10:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:10:37] ℹ️  Using MRN from patient data: 'MA250331114803' over 'MA250331114803'
[07:10:37] ℹ️  Service line consistent in both sources: 'OT'
[07:10:37] ✅ Patient name cross-validation successful
[07:10:37] ✅    ✅ Data merged successfully
[07:10:38] ✅    ✅ Order data extracted and validated
[07:10:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:10:38] [DOC: 9234837] ✅ Patient found in local cache: David Sturgeon, ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[07:10:38] ✅    ✅ Existing patient found with ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[07:10:38] 🔄 
🔄 Step 6: Pushing order to API...
[07:10:38] [DOC: 9234837] ℹ️  Pushing order via API for patient ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[07:10:39] [DOC: 9234837] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:10:39] ❌    ❌ Failed to push order
[07:10:39] 🔄 
🔄 Step 7: Writing to CSV...
[07:10:39] [DOC: 9234837] ℹ️  Calculated age: 76 from DOB: 11/14/1948
[07:10:39] [DOC: 9234837] ℹ️  Service Line extracted: 'OT'
[07:10:39] [DOC: 9234837] ℹ️  Payer Source extracted: ''
[07:10:39] [DOC: 9234837] ℹ️  Diagnosis codes being written:
[07:10:39] [DOC: 9234837] ℹ️    - Latest_Episode_Firstdiagnosis: 'CHRONIC HYPOXIC AND HYPERCAPNIC RESP FAILURE DUE TO COPD/EMPHYSEMA'
[07:10:39] [DOC: 9234837] ℹ️    - Latest_Episode_Seconddiagnosis: 'SYNCOPE'
[07:10:39] [DOC: 9234837] ℹ️    - Latest_Episode_Thirddiagnosis: 'Weakness'
[07:10:39] [DOC: 9234837] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:10:39] [DOC: 9234837] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:10:39] [DOC: 9234837] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:10:39] [DOC: 9234837] ✅ Patient data written to CSV: David Sturgeon | Sex: MALE | Age: 76 | Service: OT | Payer:  | MRN: MA250331114803
[07:10:39] ✅    ✅ Document 9234837 processed and saved successfully
[07:10:39] 🔄 
🔄 Step 8: Saving API details...
[07:10:39] [DOC: 9234837] ℹ️  API push details saved for document 9234837
[07:10:39] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234834                         ║
================================================================================
[07:10:39] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[07:10:39] ℹ️  Date: 04/11/2025
[07:10:39] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:10:45] [DOC: 9234834] ✅ Text extracted using pdfplumber (20194 chars)
[07:10:45] ✅    ✅ Text extracted using pdfplumber (20194 chars)
[07:10:45] 🔄 
🔄 Step 2: Extracting patient data...
[07:10:48] ℹ️  AI extracted raw sex value: 'M'
[07:10:48] ℹ️  AI extracted service line: 'PT'
[07:10:48] ℹ️  AI extracted payer source: 'None'
[07:10:48] ℹ️  AI extracted diagnoses:
[07:10:48] ℹ️    - Diagnosis 1: 'CHRONIC HYPOXIC AND HYPERCAPNIC RESP FAILURE DUE TO COPD/EMPHYSEMA'
[07:10:48] ℹ️    - Diagnosis 2: 'SYNCOPE'
[07:10:48] ℹ️    - Diagnosis 3: 'None'
[07:10:48] ℹ️    - Diagnosis 4: 'None'
[07:10:48] ℹ️    - Diagnosis 5: 'None'
[07:10:48] ℹ️    - Diagnosis 6: 'None'
[07:10:48] ℹ️  Final extracted MRN: 'MA250331114803'
[07:10:48] ℹ️  Final extracted Sex: 'MALE'
[07:10:48] ℹ️  Final extracted Service Line: 'PT'
[07:10:48] ℹ️  Final extracted Payer Source: ''
[07:10:48] ✅ Patient data extraction completed successfully
[07:10:48] ✅    ✅ Patient data extracted successfully
[07:10:48] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: Dr. Alcaraz, Achilles Romualdo E.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'CHRONIC HYPOXIC AND HYPERCAPNIC RESP FAILURE DUE TO COPD/EMPHYSEMA', 'secondDiagnosis': 'SYNCOPE', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[07:10:48] ✅    ✅ Patient identified: David Sturgeon
[07:10:48] ✅    ✅ Patient name validation passed
[07:10:48] 🔄 
🔄 Step 3: Processing patient dates...
[07:10:48] [DOC: 9234834] ℹ️  DOB normalized: 11/14/1948
[07:10:48] [DOC: 9234834] ℹ️  Episode startOfEpisode normalized: 04/08/2025
[07:10:48] [DOC: 9234834] ℹ️  Episode endOfEpisode normalized: 06/02/2025
[07:10:48] [DOC: 9234834] ✅ Patient date processing completed successfully
[07:10:48] ✅    ✅ Date processing completed
[07:10:48] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Sturgeon
     └─ dob: 11/14/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250331114803
     └─ billingProvider: Dr. Alcaraz, Achilles Romualdo E.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/08/2025', 'endOfEpisode': '06/02/2025', 'firstDiagnosis': 'CHRONIC HYPOXIC AND HYPERCAPNIC RESP FAILURE DUE TO COPD/EMPHYSEMA', 'secondDiagnosis': 'SYNCOPE'}]
[07:10:48] 🔄 
🔄 Step 4: Extracting order data...
[07:10:51] ℹ️  Order extraction - MRN: 'MA250331114803'
[07:10:51] ℹ️  Order extraction - Sex: 'MALE'
[07:10:51] ℹ️  Order extraction - Service Line: 'PT'
[07:10:51] ℹ️  Order extraction - Payer Source: ''
[07:10:51] ✅ Order data extraction completed successfully
[07:10:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:10:51] ℹ️  Using MRN from patient data: 'MA250331114803' over 'MA250331114803'
[07:10:51] ℹ️  Service line consistent in both sources: 'PT'
[07:10:51] ✅ Patient name cross-validation successful
[07:10:51] ✅    ✅ Data merged successfully
[07:10:52] ✅    ✅ Order data extracted and validated
[07:10:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:10:52] [DOC: 9234834] ✅ Patient found in local cache: David Sturgeon, ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[07:10:52] ✅    ✅ Existing patient found with ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[07:10:52] 🔄 
🔄 Step 6: Pushing order to API...
[07:10:52] [DOC: 9234834] ℹ️  Pushing order via API for patient ID: 18718a98-7ff6-461c-a94e-9ab6f55f446f
[07:10:54] [DOC: 9234834] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:10:54] ❌    ❌ Failed to push order
[07:10:54] 🔄 
🔄 Step 7: Writing to CSV...
[07:10:54] [DOC: 9234834] ℹ️  Calculated age: 76 from DOB: 11/14/1948
[07:10:54] [DOC: 9234834] ℹ️  Service Line extracted: 'PT'
[07:10:54] [DOC: 9234834] ℹ️  Payer Source extracted: ''
[07:10:54] [DOC: 9234834] ℹ️  Diagnosis codes being written:
[07:10:54] [DOC: 9234834] ℹ️    - Latest_Episode_Firstdiagnosis: 'CHRONIC HYPOXIC AND HYPERCAPNIC RESP FAILURE DUE TO COPD/EMPHYSEMA'
[07:10:54] [DOC: 9234834] ℹ️    - Latest_Episode_Seconddiagnosis: 'SYNCOPE'
[07:10:54] [DOC: 9234834] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:10:54] [DOC: 9234834] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:10:54] [DOC: 9234834] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:10:54] [DOC: 9234834] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:10:54] [DOC: 9234834] ✅ Patient data written to CSV: David Sturgeon | Sex: MALE | Age: 76 | Service: PT | Payer:  | MRN: MA250331114803
[07:10:54] ✅    ✅ Document 9234834 processed and saved successfully
[07:10:54] 🔄 
🔄 Step 8: Saving API details...
[07:10:54] [DOC: 9234834] ℹ️  API push details saved for document 9234834
[07:10:54] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234555                         ║
================================================================================
[07:10:54] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[07:10:54] ℹ️  Date: 04/11/2025
[07:10:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:10:55] [DOC: 9234555] ✅ Text extracted using pdfplumber (1296 chars)
[07:10:55] ✅    ✅ Text extracted using pdfplumber (1296 chars)
[07:10:55] 🔄 
🔄 Step 2: Extracting patient data...
[07:10:57] ℹ️  AI extracted raw sex value: 'F'
[07:10:57] ℹ️  AI extracted service line: 'Physical Therapy'
[07:10:57] ℹ️  AI extracted payer source: ''
[07:10:57] ℹ️  AI extracted diagnoses:
[07:10:57] ℹ️    - Diagnosis 1: ''
[07:10:57] ℹ️    - Diagnosis 2: ''
[07:10:57] ℹ️    - Diagnosis 3: ''
[07:10:57] ℹ️    - Diagnosis 4: ''
[07:10:57] ℹ️    - Diagnosis 5: ''
[07:10:57] ℹ️    - Diagnosis 6: ''
[07:10:57] ℹ️  Final extracted MRN: '2902972'
[07:10:57] ℹ️  Final extracted Sex: 'FEMALE'
[07:10:57] ℹ️  Final extracted Service Line: 'Physical Therapy'
[07:10:57] ℹ️  Final extracted Payer Source: ''
[07:10:57] ✅ Patient data extraction completed successfully
[07:10:57] ✅    ✅ Patient data extracted successfully
[07:10:57] 📊 Patient Response
     └─ patientFName: Anita B
     └─ patientLName: Riley-Robinson
     └─ dob: 05/09/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2902972
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:10:57] ✅    ✅ Patient identified: Anita B Riley-Robinson
[07:10:57] ✅    ✅ Patient name validation passed
[07:10:57] 🔄 
🔄 Step 3: Processing patient dates...
[07:10:57] [DOC: 9234555] ℹ️  DOB normalized: 05/09/1927
[07:10:57] [DOC: 9234555] ✅ Patient date processing completed successfully
[07:10:57] ✅    ✅ Date processing completed
[07:10:57] 📊 Processed Patient Data
     └─ patientFName: Anita B
     └─ patientLName: Riley-Robinson
     └─ dob: 05/09/1927
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2902972
     └─ billingProvider: Sirjana Dhungana Parajul, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:10:57] 🔄 
🔄 Step 4: Extracting order data...
[07:11:00] ℹ️  Order extraction - MRN: '2902972'
[07:11:00] ℹ️  Order extraction - Sex: 'FEMALE'
[07:11:00] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[07:11:00] ℹ️  Order extraction - Payer Source: ''
[07:11:00] ✅ Order data extraction completed successfully
[07:11:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:11:00] ℹ️  Using MRN from patient data: '2902972' over '2902972'
[07:11:00] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[07:11:00] ✅ Patient name cross-validation successful
[07:11:00] ✅    ✅ Data merged successfully
[07:11:01] ✅    ✅ Order data extracted and validated
[07:11:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:11:18] [DOC: 9234555] ℹ️  Patient not found in cache or API: Anita B Riley-Robinson
[07:11:18] [DOC: 9234555] ℹ️  Patient not found, creating new patient via API...
[07:11:18] [DOC: 9234555] ℹ️  Creating patient via API: Anita B Riley-Robinson
[07:11:19] [DOC: 9234555] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[07:11:19] ❌    ❌ Failed to create patient
[07:11:19] [DOC: 9234555] ℹ️  API push details saved for document 9234555
================================================================================
║                        Processing Document ID: 9234545                         ║
================================================================================
[07:11:19] ℹ️  Agency: Dartmouth HH
[07:11:19] ℹ️  Date: 04/11/2025
[07:11:19] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:11:21] [DOC: 9234545] ✅ Text extracted using pdfplumber (1066 chars)
[07:11:21] ✅    ✅ Text extracted using pdfplumber (1066 chars)
[07:11:21] 🔄 
🔄 Step 2: Extracting patient data...
[07:11:24] ℹ️  AI extracted raw sex value: 'F'
[07:11:24] ℹ️  AI extracted service line: 'PT'
[07:11:24] ℹ️  AI extracted payer source: 'Medicare'
[07:11:24] ℹ️  AI extracted diagnoses:
[07:11:24] ℹ️    - Diagnosis 1: 'None'
[07:11:24] ℹ️    - Diagnosis 2: 'None'
[07:11:24] ℹ️    - Diagnosis 3: 'None'
[07:11:24] ℹ️    - Diagnosis 4: 'None'
[07:11:24] ℹ️    - Diagnosis 5: 'None'
[07:11:24] ℹ️    - Diagnosis 6: 'None'
[07:11:24] ℹ️  Final extracted MRN: '919015'
[07:11:24] ℹ️  Final extracted Sex: 'FEMALE'
[07:11:24] ℹ️  Final extracted Service Line: 'PT'
[07:11:24] ℹ️  Final extracted Payer Source: 'Medicare'
[07:11:24] ✅ Patient data extraction completed successfully
[07:11:24] ✅    ✅ Patient data extracted successfully
[07:11:24] 📊 Patient Response
     └─ patientFName: Julieta
     └─ patientLName: Pereira
     └─ dob: 03/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 919015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 20 Palmer Street
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/26/2024', 'startOfEpisode': '01/25/2025', 'endOfEpisode': '03/25/2025', 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[07:11:24] ✅    ✅ Patient identified: Julieta Pereira
[07:11:24] ✅    ✅ Patient name validation passed
[07:11:24] 🔄 
🔄 Step 3: Processing patient dates...
[07:11:24] [DOC: 9234545] ℹ️  DOB normalized: 03/23/1941
[07:11:24] [DOC: 9234545] ℹ️  Episode startOfCare normalized: 11/26/2024
[07:11:24] [DOC: 9234545] ℹ️  Episode startOfEpisode normalized: 01/25/2025
[07:11:24] [DOC: 9234545] ℹ️  Episode endOfEpisode normalized: 03/25/2025
[07:11:24] [DOC: 9234545] ✅ Patient date processing completed successfully
[07:11:24] ✅    ✅ Date processing completed
[07:11:24] 📊 Processed Patient Data
     └─ patientFName: Julieta
     └─ patientLName: Pereira
     └─ dob: 03/23/1941
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 919015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 20 Palmer Street
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '11/26/2024', 'startOfEpisode': '01/25/2025', 'endOfEpisode': '03/25/2025'}]
[07:11:24] 🔄 
🔄 Step 4: Extracting order data...
[07:11:26] ℹ️  Order extraction - MRN: ''
[07:11:26] ℹ️  Order extraction - Sex: 'FEMALE'
[07:11:26] ℹ️  Order extraction - Service Line: 'PT'
[07:11:26] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:11:26] ✅ Order data extraction completed successfully
[07:11:26] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:11:26] ℹ️  Using MRN from patient data: '919015'
[07:11:26] ℹ️  Service line consistent in both sources: 'PT'
[07:11:26] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:11:26] ✅ Patient name cross-validation successful
[07:11:26] ✅    ✅ Data merged successfully
[07:11:27] ✅    ✅ Order data extracted and validated
[07:11:27] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:11:27] [DOC: 9234545] ✅ Patient found in local cache: Julieta Pereira, ID: c2e7114d-362f-4392-9923-06c73f2eab17
[07:11:27] ✅    ✅ Existing patient found with ID: c2e7114d-362f-4392-9923-06c73f2eab17
[07:11:27] 🔄 
🔄 Step 6: Pushing order to API...
[07:11:27] [DOC: 9234545] ℹ️  Pushing order via API for patient ID: c2e7114d-362f-4392-9923-06c73f2eab17
[07:11:28] [DOC: 9234545] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:11:28] ❌    ❌ Failed to push order
[07:11:28] 🔄 
🔄 Step 7: Writing to CSV...
[07:11:28] [DOC: 9234545] ℹ️  Calculated age: 84 from DOB: 03/23/1941
[07:11:28] [DOC: 9234545] ℹ️  Service Line extracted: 'PT'
[07:11:28] [DOC: 9234545] ℹ️  Payer Source extracted: 'Medicare'
[07:11:28] [DOC: 9234545] ℹ️  Diagnosis codes being written:
[07:11:28] [DOC: 9234545] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:11:28] [DOC: 9234545] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:11:28] [DOC: 9234545] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:11:28] [DOC: 9234545] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:11:28] [DOC: 9234545] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:11:28] [DOC: 9234545] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:11:28] [DOC: 9234545] ✅ Patient data written to CSV: Julieta Pereira | Sex: FEMALE | Age: 84 | Service: PT | Payer: Medicare | MRN: 919015
[07:11:28] ✅    ✅ Document 9234545 processed and saved successfully
[07:11:28] 🔄 
🔄 Step 8: Saving API details...
[07:11:28] [DOC: 9234545] ℹ️  API push details saved for document 9234545
[07:11:28] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234534                         ║
================================================================================
[07:11:28] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[07:11:28] ℹ️  Date: 04/11/2025
[07:11:28] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:11:30] [DOC: 9234534] ✅ Text extracted using pdfplumber (1056 chars)
[07:11:30] ✅    ✅ Text extracted using pdfplumber (1056 chars)
[07:11:30] 🔄 
🔄 Step 2: Extracting patient data...
[07:11:33] ℹ️  AI extracted raw sex value: 'F'
[07:11:33] ℹ️  AI extracted service line: 'Occupational Therapy'
[07:11:33] ℹ️  AI extracted payer source: ''
[07:11:33] ℹ️  AI extracted diagnoses:
[07:11:33] ℹ️    - Diagnosis 1: ''
[07:11:33] ℹ️    - Diagnosis 2: ''
[07:11:33] ℹ️    - Diagnosis 3: ''
[07:11:33] ℹ️    - Diagnosis 4: ''
[07:11:33] ℹ️    - Diagnosis 5: ''
[07:11:33] ℹ️    - Diagnosis 6: ''
[07:11:33] ℹ️  Final extracted MRN: '2682789'
[07:11:33] ℹ️  Final extracted Sex: 'FEMALE'
[07:11:33] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[07:11:33] ℹ️  Final extracted Payer Source: ''
[07:11:33] ✅ Patient data extraction completed successfully
[07:11:33] ✅    ✅ Patient data extracted successfully
[07:11:33] 📊 Patient Response
     └─ patientFName: Lorna
     └─ patientLName: Maciel
     └─ dob: 02/21/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2682789
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:11:33] ✅    ✅ Patient identified: Lorna Maciel
[07:11:33] ✅    ✅ Patient name validation passed
[07:11:33] 🔄 
🔄 Step 3: Processing patient dates...
[07:11:33] [DOC: 9234534] ℹ️  DOB normalized: 02/21/1967
[07:11:33] [DOC: 9234534] ℹ️  Episode startOfEpisode normalized: 03/19/2025
[07:11:33] [DOC: 9234534] ℹ️  Episode endOfEpisode normalized: 05/17/2025
[07:11:33] [DOC: 9234534] ✅ Patient date processing completed successfully
[07:11:33] ✅    ✅ Date processing completed
[07:11:33] 📊 Processed Patient Data
     └─ patientFName: Lorna
     └─ patientLName: Maciel
     └─ dob: 02/21/1967
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2682789
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/19/2025', 'endOfEpisode': '05/17/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:11:33] 🔄 
🔄 Step 4: Extracting order data...
[07:11:35] ℹ️  Order extraction - MRN: '2682789'
[07:11:35] ℹ️  Order extraction - Sex: 'FEMALE'
[07:11:35] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[07:11:35] ℹ️  Order extraction - Payer Source: ''
[07:11:35] ✅ Order data extraction completed successfully
[07:11:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:11:35] ℹ️  Using MRN from patient data: '2682789' over '2682789'
[07:11:35] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[07:11:35] ✅ Patient name cross-validation successful
[07:11:35] ✅    ✅ Data merged successfully
[07:11:37] ✅    ✅ Order data extracted and validated
[07:11:37] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:11:41] [DOC: 9234534] ✅ Patient exists in API: Lorna Maciel, ID: a7a397e4-8197-4b16-9fc4-bf5ce1a9aff8
[07:11:41] ✅    ✅ Existing patient found with ID: a7a397e4-8197-4b16-9fc4-bf5ce1a9aff8
[07:11:41] 🔄 
🔄 Step 6: Pushing order to API...
[07:11:41] [DOC: 9234534] ℹ️  Pushing order via API for patient ID: a7a397e4-8197-4b16-9fc4-bf5ce1a9aff8
[07:11:43] [DOC: 9234534] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD13307"}
[07:11:43] ❌    ❌ Failed to push order
[07:11:43] 🔄 
🔄 Step 7: Writing to CSV...
[07:11:43] [DOC: 9234534] ℹ️  Calculated age: 58 from DOB: 02/21/1967
[07:11:43] [DOC: 9234534] ℹ️  Service Line extracted: 'Occupational Therapy'
[07:11:43] [DOC: 9234534] ℹ️  Payer Source extracted: ''
[07:11:43] [DOC: 9234534] ℹ️  Diagnosis codes being written:
[07:11:43] [DOC: 9234534] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:11:43] [DOC: 9234534] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:11:43] [DOC: 9234534] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:11:43] [DOC: 9234534] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:11:43] [DOC: 9234534] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:11:43] [DOC: 9234534] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:11:43] [DOC: 9234534] ✅ Patient data written to CSV: Lorna Maciel | Sex: FEMALE | Age: 58 | Service: Occupational Therapy | Payer:  | MRN: 2682789
[07:11:43] ✅    ✅ Document 9234534 processed and saved successfully
[07:11:43] 🔄 
🔄 Step 8: Saving API details...
[07:11:43] [DOC: 9234534] ℹ️  API push details saved for document 9234534
[07:11:43] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234532                         ║
================================================================================
[07:11:43] ℹ️  Agency: Dartmouth HH
[07:11:43] ℹ️  Date: 04/11/2025
[07:11:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:11:45] [DOC: 9234532] ✅ Text extracted using pdfplumber (4058 chars)
[07:11:45] ✅    ✅ Text extracted using pdfplumber (4058 chars)
[07:11:45] 🔄 
🔄 Step 2: Extracting patient data...
[07:11:47] ℹ️  AI extracted raw sex value: 'M'
[07:11:47] ℹ️  AI extracted service line: 'OT'
[07:11:47] ℹ️  AI extracted payer source: 'Medicare'
[07:11:47] ℹ️  AI extracted diagnoses:
[07:11:47] ℹ️    - Diagnosis 1: ''
[07:11:47] ℹ️    - Diagnosis 2: ''
[07:11:47] ℹ️    - Diagnosis 3: ''
[07:11:47] ℹ️    - Diagnosis 4: ''
[07:11:47] ℹ️    - Diagnosis 5: ''
[07:11:47] ℹ️    - Diagnosis 6: ''
[07:11:47] ℹ️  Final extracted MRN: '894015'
[07:11:47] ℹ️  Final extracted Sex: 'MALE'
[07:11:47] ℹ️  Final extracted Service Line: 'OT'
[07:11:47] ℹ️  Final extracted Payer Source: 'Medicare'
[07:11:47] ✅ Patient data extraction completed successfully
[07:11:47] ✅    ✅ Patient data extracted successfully
[07:11:47] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Bourassa
     └─ dob: 05/10/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 894015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/05/2025', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:11:47] ✅    ✅ Patient identified: Joseph Bourassa
[07:11:47] ✅    ✅ Patient name validation passed
[07:11:47] 🔄 
🔄 Step 3: Processing patient dates...
[07:11:47] [DOC: 9234532] ℹ️  DOB normalized: 05/10/1944
[07:11:47] [DOC: 9234532] ℹ️  Episode startOfCare normalized: 03/05/2025
[07:11:47] [DOC: 9234532] ℹ️  Episode startOfEpisode normalized: 03/05/2025
[07:11:47] [DOC: 9234532] ℹ️  Episode endOfEpisode normalized: 05/03/2025
[07:11:47] [DOC: 9234532] ✅ Patient date processing completed successfully
[07:11:47] ✅    ✅ Date processing completed
[07:11:47] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Bourassa
     └─ dob: 05/10/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 894015
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: OT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/05/2025', 'startOfEpisode': '03/05/2025', 'endOfEpisode': '05/03/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:11:47] 🔄 
🔄 Step 4: Extracting order data...
[07:11:50] ℹ️  Order extraction - MRN: '894015'
[07:11:50] ℹ️  Order extraction - Sex: 'MALE'
[07:11:50] ℹ️  Order extraction - Service Line: 'OT'
[07:11:50] ℹ️  Order extraction - Payer Source: 'Medicare'
[07:11:50] ✅ Order data extraction completed successfully
[07:11:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:11:50] ℹ️  Using MRN from patient data: '894015' over '894015'
[07:11:50] ℹ️  Service line consistent in both sources: 'OT'
[07:11:50] ℹ️  Payer source consistent in both sources: 'Medicare'
[07:11:50] ✅ Patient name cross-validation successful
[07:11:50] ✅    ✅ Data merged successfully
[07:11:51] ✅    ✅ Order data extracted and validated
[07:11:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:12:31] [DOC: 9234532] ✅ Patient exists in API: Joseph Bourassa, ID: bee2f5f0-e19e-4005-96f3-b93dd3f30ebe
[07:12:31] ✅    ✅ Existing patient found with ID: bee2f5f0-e19e-4005-96f3-b93dd3f30ebe
[07:12:31] 🔄 
🔄 Step 6: Pushing order to API...
[07:12:31] [DOC: 9234532] ℹ️  Pushing order via API for patient ID: bee2f5f0-e19e-4005-96f3-b93dd3f30ebe
[07:12:32] [DOC: 9234532] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:12:32] ❌    ❌ Failed to push order
[07:12:32] 🔄 
🔄 Step 7: Writing to CSV...
[07:12:32] [DOC: 9234532] ℹ️  Calculated age: 81 from DOB: 05/10/1944
[07:12:32] [DOC: 9234532] ℹ️  Service Line extracted: 'OT'
[07:12:32] [DOC: 9234532] ℹ️  Payer Source extracted: 'Medicare'
[07:12:32] [DOC: 9234532] ℹ️  Diagnosis codes being written:
[07:12:32] [DOC: 9234532] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:12:32] [DOC: 9234532] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:12:32] [DOC: 9234532] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:12:32] [DOC: 9234532] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:12:32] [DOC: 9234532] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:12:32] [DOC: 9234532] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:12:32] [DOC: 9234532] ✅ Patient data written to CSV: Joseph Bourassa | Sex: MALE | Age: 81 | Service: OT | Payer: Medicare | MRN: 894015
[07:12:32] ✅    ✅ Document 9234532 processed and saved successfully
[07:12:32] 🔄 
🔄 Step 8: Saving API details...
[07:12:32] [DOC: 9234532] ℹ️  API push details saved for document 9234532
[07:12:32] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234531                         ║
================================================================================
[07:12:32] ℹ️  Agency: Dartmouth HH
[07:12:32] ℹ️  Date: 04/11/2025
[07:12:32] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:12:38] [DOC: 9234531] ✅ Text extracted using pdfplumber (17477 chars)
[07:12:38] ✅    ✅ Text extracted using pdfplumber (17477 chars)
[07:12:38] 🔄 
🔄 Step 2: Extracting patient data...
[07:12:41] ℹ️  AI extracted raw sex value: 'M'
[07:12:41] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[07:12:41] ℹ️  AI extracted payer source: 'None'
[07:12:41] ℹ️  AI extracted diagnoses:
[07:12:41] ℹ️    - Diagnosis 1: 'M48.062'
[07:12:41] ℹ️    - Diagnosis 2: 'M15.9'
[07:12:41] ℹ️    - Diagnosis 3: 'I48.0'
[07:12:41] ℹ️    - Diagnosis 4: 'I10'
[07:12:41] ℹ️    - Diagnosis 5: 'K59.09'
[07:12:41] ℹ️    - Diagnosis 6: 'D61.818'
[07:12:41] ℹ️  Final extracted MRN: '227027'
[07:12:41] ℹ️  Final extracted Sex: 'MALE'
[07:12:41] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[07:12:41] ℹ️  Final extracted Payer Source: ''
[07:12:41] ✅ Patient data extraction completed successfully
[07:12:41] ✅    ✅ Patient data extracted successfully
[07:12:41] 📊 Patient Response
     └─ patientFName: Augusto
     └─ patientLName: Dejesus
     └─ dob: 02/02/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': 'M48.062', 'secondDiagnosis': 'M15.9', 'thirdDiagnosis': 'I48.0', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'K59.09', 'sixthDiagnosis': 'D61.818'}]
[07:12:41] ✅    ✅ Patient identified: Augusto Dejesus
[07:12:41] ✅    ✅ Patient name validation passed
[07:12:41] 🔄 
🔄 Step 3: Processing patient dates...
[07:12:41] [DOC: 9234531] ℹ️  DOB normalized: 02/02/1940
[07:12:41] [DOC: 9234531] ℹ️  Episode startOfCare normalized: 03/29/2025
[07:12:41] [DOC: 9234531] ℹ️  Episode startOfEpisode normalized: 03/30/2025
[07:12:41] [DOC: 9234531] ℹ️  Episode endOfEpisode normalized: 05/28/2025
[07:12:41] [DOC: 9234531] ✅ Patient date processing completed successfully
[07:12:41] ✅    ✅ Date processing completed
[07:12:41] 📊 Processed Patient Data
     └─ patientFName: Augusto
     └─ patientLName: Dejesus
     └─ dob: 02/02/1940
     └─ patientSex: MALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/29/2025', 'startOfEpisode': '03/30/2025', 'endOfEpisode': '05/28/2025', 'firstDiagnosis': 'M48.062', 'secondDiagnosis': 'M15.9', 'thirdDiagnosis': 'I48.0', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'K59.09', 'sixthDiagnosis': 'D61.818'}]
[07:12:41] 🔄 
🔄 Step 4: Extracting order data...
[07:12:43] ℹ️  Order extraction - MRN: '227027'
[07:12:43] ℹ️  Order extraction - Sex: 'MALE'
[07:12:43] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[07:12:43] ℹ️  Order extraction - Payer Source: ''
[07:12:43] ✅ Order data extraction completed successfully
[07:12:43] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:12:43] ℹ️  Using MRN from patient data: '227027' over '227027'
[07:12:43] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[07:12:43] ✅ Patient name cross-validation successful
[07:12:43] ✅    ✅ Data merged successfully
[07:12:45] ✅    ✅ Order data extracted and validated
[07:12:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:12:45] [DOC: 9234531] ✅ Patient found in local cache: Augusto Dejesus, ID: 3438e7f3-83b0-4cca-8df4-3ff0f30080f6
[07:12:45] ✅    ✅ Existing patient found with ID: 3438e7f3-83b0-4cca-8df4-3ff0f30080f6
[07:12:45] 🔄 
🔄 Step 6: Pushing order to API...
[07:12:45] [DOC: 9234531] ℹ️  Pushing order via API for patient ID: 3438e7f3-83b0-4cca-8df4-3ff0f30080f6
[07:12:51] [DOC: 9234531] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[07:12:51] ❌    ❌ Failed to push order
[07:12:51] 🔄 
🔄 Step 7: Writing to CSV...
[07:12:51] [DOC: 9234531] ℹ️  Calculated age: 85 from DOB: 02/02/1940
[07:12:51] [DOC: 9234531] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[07:12:51] [DOC: 9234531] ℹ️  Payer Source extracted: ''
[07:12:51] [DOC: 9234531] ℹ️  Diagnosis codes being written:
[07:12:51] [DOC: 9234531] ℹ️    - Latest_Episode_Firstdiagnosis: 'M48.062'
[07:12:51] [DOC: 9234531] ℹ️    - Latest_Episode_Seconddiagnosis: 'M15.9'
[07:12:51] [DOC: 9234531] ℹ️    - Latest_Episode_Thirddiagnosis: 'I48.0'
[07:12:51] [DOC: 9234531] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I10'
[07:12:51] [DOC: 9234531] ℹ️    - Latest_Episode_Fifthdiagnosis: 'K59.09'
[07:12:51] [DOC: 9234531] ℹ️    - Latest_Episode_Sixthdiagnosis: 'D61.818'
[07:12:51] [DOC: 9234531] ✅ Patient data written to CSV: Augusto Dejesus | Sex: MALE | Age: 85 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 227027
[07:12:51] ✅    ✅ Document 9234531 processed and saved successfully
[07:12:51] 🔄 
🔄 Step 8: Saving API details...
[07:12:51] [DOC: 9234531] ℹ️  API push details saved for document 9234531
[07:12:51] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234525                         ║
================================================================================
[07:12:51] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[07:12:51] ℹ️  Date: 04/11/2025
[07:12:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:13:02] [DOC: 9234525] ✅ Text extracted using pdfplumber (1572 chars)
[07:13:02] ✅    ✅ Text extracted using pdfplumber (1572 chars)
[07:13:02] 🔄 
🔄 Step 2: Extracting patient data...
[07:13:04] ℹ️  AI extracted raw sex value: 'F'
[07:13:04] ℹ️  AI extracted service line: 'Physical Therapy'
[07:13:04] ℹ️  AI extracted payer source: ''
[07:13:04] ℹ️  AI extracted diagnoses:
[07:13:04] ℹ️    - Diagnosis 1: ''
[07:13:04] ℹ️    - Diagnosis 2: ''
[07:13:04] ℹ️    - Diagnosis 3: ''
[07:13:04] ℹ️    - Diagnosis 4: ''
[07:13:04] ℹ️    - Diagnosis 5: ''
[07:13:04] ℹ️    - Diagnosis 6: ''
[07:13:04] ℹ️  Final extracted MRN: '2491526'
[07:13:04] ℹ️  Final extracted Sex: 'FEMALE'
[07:13:04] ℹ️  Final extracted Service Line: 'Physical Therapy'
[07:13:04] ℹ️  Final extracted Payer Source: ''
[07:13:04] ✅ Patient data extraction completed successfully
[07:13:04] ✅    ✅ Patient data extracted successfully
[07:13:04] 📊 Patient Response
     └─ patientFName: Alda
     └─ patientLName: Frias
     └─ dob: 10/11/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2491526
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:13:04] ✅    ✅ Patient identified: Alda Frias
[07:13:04] ✅    ✅ Patient name validation passed
[07:13:04] 🔄 
🔄 Step 3: Processing patient dates...
[07:13:04] [DOC: 9234525] ℹ️  DOB normalized: 10/11/1934
[07:13:04] [DOC: 9234525] ✅ Patient date processing completed successfully
[07:13:04] ✅    ✅ Date processing completed
[07:13:04] 📊 Processed Patient Data
     └─ patientFName: Alda
     └─ patientLName: Frias
     └─ dob: 10/11/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2491526
     └─ billingProvider: Daniel J. Martin, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:13:04] 🔄 
🔄 Step 4: Extracting order data...
[07:13:06] ℹ️  Order extraction - MRN: '2491526'
[07:13:06] ℹ️  Order extraction - Sex: 'FEMALE'
[07:13:06] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[07:13:06] ℹ️  Order extraction - Payer Source: ''
[07:13:06] ✅ Order data extraction completed successfully
[07:13:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:13:06] ℹ️  Using MRN from patient data: '2491526' over '2491526'
[07:13:06] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[07:13:06] ✅ Patient name cross-validation successful
[07:13:06] ✅    ✅ Data merged successfully
[07:13:08] ✅    ✅ Order data extracted and validated
[07:13:08] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:13:08] [DOC: 9234525] ✅ Patient found in local cache: Alda Frias, ID: 815d9cfc-89d4-4f96-a8a6-1c3f6d19d220
[07:13:08] ✅    ✅ Existing patient found with ID: 815d9cfc-89d4-4f96-a8a6-1c3f6d19d220
[07:13:08] 🔄 
🔄 Step 6: Pushing order to API...
[07:13:08] [DOC: 9234525] ℹ️  Pushing order via API for patient ID: 815d9cfc-89d4-4f96-a8a6-1c3f6d19d220
[07:13:10] [DOC: 9234525] ❌ Order push failed with status 201: {"id":"1470a266-a1a8-4f00-a0ab-73047ef65152","orderWAVId":"ORD20035","orderNo":"1080547, 1080586","orderDate":"04/10/2025","startOfCare":"04/10/2025","episodeStartDate":"04/10/2025","episodeEndDate":"05/03/2025","documentID":"9234525","mrn":"2491526","patientName":"Frias,Alda F.","sentToPhysicianDate":"04/11/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/27/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"815d9cfc-89d4-4f96-a8a6-1c3f6d19d220","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[07:13:10] ❌    ❌ Failed to push order
[07:13:10] 🔄 
🔄 Step 7: Writing to CSV...
[07:13:10] [DOC: 9234525] ℹ️  Calculated age: 90 from DOB: 10/11/1934
[07:13:10] [DOC: 9234525] ℹ️  Service Line extracted: 'Physical Therapy'
[07:13:10] [DOC: 9234525] ℹ️  Payer Source extracted: ''
[07:13:10] [DOC: 9234525] ℹ️  Diagnosis codes being written:
[07:13:10] [DOC: 9234525] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:13:10] [DOC: 9234525] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:13:10] [DOC: 9234525] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:13:10] [DOC: 9234525] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:13:10] [DOC: 9234525] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:13:10] [DOC: 9234525] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:13:10] [DOC: 9234525] ✅ Patient data written to CSV: Alda Frias | Sex: FEMALE | Age: 90 | Service: Physical Therapy | Payer:  | MRN: 2491526
[07:13:10] ✅    ✅ Document 9234525 processed and saved successfully
[07:13:10] 🔄 
🔄 Step 8: Saving API details...
[07:13:10] [DOC: 9234525] ℹ️  API push details saved for document 9234525
[07:13:10] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234522                         ║
================================================================================
[07:13:10] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[07:13:10] ℹ️  Date: 04/11/2025
[07:13:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:13:11] [DOC: 9234522] ✅ Text extracted using pdfplumber (976 chars)
[07:13:11] ✅    ✅ Text extracted using pdfplumber (976 chars)
[07:13:11] 🔄 
🔄 Step 2: Extracting patient data...
[07:13:14] ℹ️  AI extracted raw sex value: 'M'
[07:13:14] ℹ️  AI extracted service line: 'Medical Social Work'
[07:13:14] ℹ️  AI extracted payer source: ''
[07:13:14] ℹ️  AI extracted diagnoses:
[07:13:14] ℹ️    - Diagnosis 1: ''
[07:13:14] ℹ️    - Diagnosis 2: ''
[07:13:14] ℹ️    - Diagnosis 3: ''
[07:13:14] ℹ️    - Diagnosis 4: ''
[07:13:14] ℹ️    - Diagnosis 5: ''
[07:13:14] ℹ️    - Diagnosis 6: ''
[07:13:14] ℹ️  Final extracted MRN: '2475455'
[07:13:14] ℹ️  Final extracted Sex: 'MALE'
[07:13:14] ℹ️  Final extracted Service Line: 'Medical Social Work'
[07:13:14] ℹ️  Final extracted Payer Source: ''
[07:13:14] ✅ Patient data extraction completed successfully
[07:13:14] ✅    ✅ Patient data extracted successfully
[07:13:14] 📊 Patient Response
     └─ patientFName: Jay
     └─ patientLName: Flanagan
     └─ dob: 11/01/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 2475455
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:13:14] ✅    ✅ Patient identified: Jay Flanagan
[07:13:14] ✅    ✅ Patient name validation passed
[07:13:14] 🔄 
🔄 Step 3: Processing patient dates...
[07:13:14] [DOC: 9234522] ℹ️  DOB normalized: 11/01/1951
[07:13:14] [DOC: 9234522] ℹ️  Episode startOfEpisode normalized: 04/14/2025
[07:13:14] [DOC: 9234522] ℹ️  Episode endOfEpisode normalized: 05/27/2025
[07:13:14] [DOC: 9234522] ✅ Patient date processing completed successfully
[07:13:14] ✅    ✅ Date processing completed
[07:13:14] 📊 Processed Patient Data
     └─ patientFName: Jay
     └─ patientLName: Flanagan
     └─ dob: 11/01/1951
     └─ patientSex: MALE
     └─ medicalRecordNo: 2475455
     └─ billingProvider: Nicholas Defusco, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/14/2025', 'endOfEpisode': '05/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[07:13:14] 🔄 
🔄 Step 4: Extracting order data...
[07:13:16] ℹ️  Order extraction - MRN: '2475455'
[07:13:16] ℹ️  Order extraction - Sex: 'MALE'
[07:13:16] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[07:13:16] ℹ️  Order extraction - Payer Source: ''
[07:13:16] ✅ Order data extraction completed successfully
[07:13:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:13:16] ℹ️  Using MRN from patient data: '2475455' over '2475455'
[07:13:16] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[07:13:16] ✅ Patient name cross-validation successful
[07:13:16] ✅    ✅ Data merged successfully
[07:13:17] ✅    ✅ Order data extracted and validated
[07:13:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:13:29] [DOC: 9234522] ℹ️  Patient not found in cache or API: Jay Flanagan
[07:13:29] [DOC: 9234522] ℹ️  Patient not found, creating new patient via API...
[07:13:29] [DOC: 9234522] ℹ️  Creating patient via API: Jay Flanagan
[07:13:30] [DOC: 9234522] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[07:13:30] ❌    ❌ Failed to create patient
[07:13:30] [DOC: 9234522] ℹ️  API push details saved for document 9234522
================================================================================
║                        Processing Document ID: 9234515                         ║
================================================================================
[07:13:30] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[07:13:30] ℹ️  Date: 04/11/2025
[07:13:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:13:31] [DOC: 9234515] ✅ Text extracted using pdfplumber (1192 chars)
[07:13:31] ✅    ✅ Text extracted using pdfplumber (1192 chars)
[07:13:31] 🔄 
🔄 Step 2: Extracting patient data...
[07:13:34] ℹ️  AI extracted raw sex value: 'M'
[07:13:34] ℹ️  AI extracted service line: 'Physical Therapy'
[07:13:34] ℹ️  AI extracted payer source: ''
[07:13:34] ℹ️  AI extracted diagnoses:
[07:13:34] ℹ️    - Diagnosis 1: 'None'
[07:13:34] ℹ️    - Diagnosis 2: 'None'
[07:13:34] ℹ️    - Diagnosis 3: 'None'
[07:13:34] ℹ️    - Diagnosis 4: 'None'
[07:13:34] ℹ️    - Diagnosis 5: 'None'
[07:13:34] ℹ️    - Diagnosis 6: 'None'
[07:13:34] ℹ️  Final extracted MRN: '2211831'
[07:13:34] ℹ️  Final extracted Sex: 'MALE'
[07:13:34] ℹ️  Final extracted Service Line: 'Physical Therapy'
[07:13:34] ℹ️  Final extracted Payer Source: ''
[07:13:34] ✅ Patient data extraction completed successfully
[07:13:34] ✅    ✅ Patient data extracted successfully
[07:13:34] 📊 Patient Response
     └─ patientFName: Viriato
     └─ patientLName: Bala
     └─ dob: 11/12/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 2211831
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[07:13:34] ✅    ✅ Patient identified: Viriato Bala
[07:13:34] ✅    ✅ Patient name validation passed
[07:13:34] 🔄 
🔄 Step 3: Processing patient dates...
[07:13:34] [DOC: 9234515] ℹ️  DOB normalized: 11/12/1937
[07:13:34] [DOC: 9234515] ✅ Patient date processing completed successfully
[07:13:34] ✅    ✅ Date processing completed
[07:13:34] 📊 Processed Patient Data
     └─ patientFName: Viriato
     └─ patientLName: Bala
     └─ dob: 11/12/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 2211831
     └─ billingProvider: Stephen C. Mackler, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[07:13:34] 🔄 
🔄 Step 4: Extracting order data...
[07:13:37] ℹ️  Order extraction - MRN: '2211831'
[07:13:37] ℹ️  Order extraction - Sex: 'MALE'
[07:13:37] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[07:13:37] ℹ️  Order extraction - Payer Source: ''
[07:13:37] ✅ Order data extraction completed successfully
[07:13:37] 🔄 
🔄 Step 4.5: Merging patient and order data...
[07:13:37] ℹ️  Using MRN from patient data: '2211831' over '2211831'
[07:13:37] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[07:13:37] ✅ Patient name cross-validation successful
[07:13:37] ✅    ✅ Data merged successfully
[07:13:38] ✅    ✅ Order data extracted and validated
[07:13:38] 🔄 
🔄 Step 5: Checking/Creating patient...
[07:13:38] [DOC: 9234515] ✅ Patient found in local cache: Viriato Bala, ID: b70c4038-8eef-4f28-b15b-74771b9982ae
[07:13:38] ✅    ✅ Existing patient found with ID: b70c4038-8eef-4f28-b15b-74771b9982ae
[07:13:38] 🔄 
🔄 Step 6: Pushing order to API...
[07:13:38] [DOC: 9234515] ℹ️  Pushing order via API for patient ID: b70c4038-8eef-4f28-b15b-74771b9982ae
[07:13:40] [DOC: 9234515] ❌ Order push failed with status 201: {"id":"6262293e-8ddd-4d44-a0d2-1ea3887bba4f","orderWAVId":"ORD20036","orderNo":"1080541","orderDate":"04/10/2025","startOfCare":"04/10/2025","episodeStartDate":"04/10/2025","episodeEndDate":"04/10/2025","documentID":"9234515","mrn":"2211831","patientName":"Bala, Viriato","sentToPhysicianDate":"04/11/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"04/15/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"b70c4038-8eef-4f28-b15b-74771b9982ae","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[07:13:40] ❌    ❌ Failed to push order
[07:13:40] 🔄 
🔄 Step 7: Writing to CSV...
[07:13:40] [DOC: 9234515] ℹ️  Calculated age: 87 from DOB: 11/12/1937
[07:13:40] [DOC: 9234515] ℹ️  Service Line extracted: 'Physical Therapy'
[07:13:40] [DOC: 9234515] ℹ️  Payer Source extracted: ''
[07:13:40] [DOC: 9234515] ℹ️  Diagnosis codes being written:
[07:13:40] [DOC: 9234515] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[07:13:40] [DOC: 9234515] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[07:13:40] [DOC: 9234515] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[07:13:40] [DOC: 9234515] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[07:13:40] [DOC: 9234515] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[07:13:40] [DOC: 9234515] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[07:13:40] [DOC: 9234515] ✅ Patient data written to CSV: Viriato Bala | Sex: MALE | Age: 87 | Service: Physical Therapy | Payer:  | MRN: 2211831
[07:13:40] ✅    ✅ Document 9234515 processed and saved successfully
[07:13:40] 🔄 
🔄 Step 8: Saving API details...
[07:13:40] [DOC: 9234515] ℹ️  API push details saved for document 9234515
[07:13:40] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9234485                         ║
================================================================================
[07:13:40] ℹ️  Agency: Visiting Rehab & Nursing Services
[07:13:40] ℹ️  Date: 04/11/2025
[07:13:40] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:13:43] [DOC: 9234485] ✅ Text extracted using pdfplumber (5640 chars)
[07:13:43] ✅    ✅ Text extracted using pdfplumber (5640 chars)
[07:13:43] 🔄 
🔄 Step 2: Extracting patient data...
[07:13:45] ℹ️  AI extracted raw sex value: 'None'
[07:13:45] ℹ️  AI extracted service line: 'None'
[07:13:45] ℹ️  AI extracted payer source: 'None'
[07:13:45] ℹ️  AI extracted diagnoses:
[07:13:45] ℹ️    - Diagnosis 1: ''
[07:13:45] ℹ️    - Diagnosis 2: ''
[07:13:45] ℹ️    - Diagnosis 3: ''
[07:13:45] ℹ️    - Diagnosis 4: ''
[07:13:45] ℹ️    - Diagnosis 5: ''
[07:13:45] ℹ️    - Diagnosis 6: ''
[07:13:45] ℹ️  Final extracted MRN: ''
[07:13:45] ℹ️  Final extracted Sex: ''
[07:13:45] ℹ️  Final extracted Service Line: ''
[07:13:45] ℹ️  Final extracted Payer Source: ''
[07:13:45] ✅ Patient data extraction completed successfully
[07:13:45] ✅    ✅ Patient data extracted successfully
[07:13:45] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[07:13:45] ⚠️     ❌ Insufficient patient data extracted
[07:13:45] [DOC: 9234485] ℹ️  API push details saved for document 9234485
================================================================================
║                        Processing Document ID: 9234481                         ║
================================================================================
[07:13:45] ℹ️  Agency: Visiting Rehab & Nursing Services
[07:13:45] ℹ️  Date: 04/11/2025
[07:13:45] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:13:50] [DOC: 9234481] ✅ Text extracted using pdfplumber (53341 chars)
[07:13:50] ✅    ✅ Text extracted using pdfplumber (53332 chars)
[07:13:50] 🔄 
🔄 Step 2: Extracting patient data...
[07:13:54] ℹ️  AI extracted raw sex value: 'None'
[07:13:54] ℹ️  AI extracted service line: 'None'
[07:13:54] ℹ️  AI extracted payer source: 'None'
[07:13:54] ℹ️  AI extracted diagnoses:
[07:13:54] ℹ️    - Diagnosis 1: ''
[07:13:54] ℹ️    - Diagnosis 2: ''
[07:13:54] ℹ️    - Diagnosis 3: ''
[07:13:54] ℹ️    - Diagnosis 4: ''
[07:13:54] ℹ️    - Diagnosis 5: ''
[07:13:54] ℹ️    - Diagnosis 6: ''
[07:13:54] ℹ️  Final extracted MRN: ''
[07:13:54] ℹ️  Final extracted Sex: ''
[07:13:54] ℹ️  Final extracted Service Line: ''
[07:13:54] ℹ️  Final extracted Payer Source: ''
[07:13:54] ✅ Patient data extraction completed successfully
[07:13:54] ✅    ✅ Patient data extracted successfully
[07:13:54] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[07:13:54] ⚠️     ❌ Insufficient patient data extracted
[07:13:54] [DOC: 9234481] ℹ️  API push details saved for document 9234481
================================================================================
║                        Processing Document ID: 9234477                         ║
================================================================================
[07:13:54] ℹ️  Agency: Visiting Rehab & Nursing Services
[07:13:54] ℹ️  Date: 04/11/2025
[07:13:54] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:14:02] [DOC: 9234477] ✅ Text extracted using pdfplumber (91169 chars)
[07:14:02] ✅    ✅ Text extracted using pdfplumber (91169 chars)
[07:14:02] 🔄 
🔄 Step 2: Extracting patient data...
[07:14:06] ℹ️  AI extracted raw sex value: 'None'
[07:14:06] ℹ️  AI extracted service line: 'None'
[07:14:06] ℹ️  AI extracted payer source: 'None'
[07:14:06] ℹ️  AI extracted diagnoses:
[07:14:06] ℹ️    - Diagnosis 1: ''
[07:14:06] ℹ️    - Diagnosis 2: ''
[07:14:06] ℹ️    - Diagnosis 3: ''
[07:14:06] ℹ️    - Diagnosis 4: ''
[07:14:06] ℹ️    - Diagnosis 5: ''
[07:14:06] ℹ️    - Diagnosis 6: ''
[07:14:06] ℹ️  Final extracted MRN: ''
[07:14:06] ℹ️  Final extracted Sex: ''
[07:14:06] ℹ️  Final extracted Service Line: ''
[07:14:06] ℹ️  Final extracted Payer Source: ''
[07:14:06] ✅ Patient data extraction completed successfully
[07:14:06] ✅    ✅ Patient data extracted successfully
[07:14:06] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[07:14:06] ⚠️     ❌ Insufficient patient data extracted
[07:14:06] [DOC: 9234477] ℹ️  API push details saved for document 9234477
================================================================================
║                        Processing Document ID: 9234474                         ║
================================================================================
[07:14:06] ℹ️  Agency: Visiting Rehab & Nursing Services
[07:14:06] ℹ️  Date: 04/11/2025
[07:14:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[07:14:08] [DOC: 9234474] ✅ Text extracted using pdfplumber (4489 chars)
[07:14:08] ✅    ✅ Text extracted using pdfplumber (4489 chars)
[07:14:08] 🔄 
🔄 Step 2: Extracting patient data...
[07:14:10] ℹ️  AI extracted raw sex value: 'None'
[07:14:10] ℹ️  AI extracted service line: 'None'
[07:14:10] ℹ️  AI extracted payer source: 'None'
[07:14:10] ℹ️  AI extracted diagnoses:
[07:14:10] ℹ️    - Diagnosis 1: ''
[07:14:10] ℹ️    - Diagnosis 2: ''
[07:14:10] ℹ️    - Diagnosis 3: ''
[07:14:10] ℹ️    - Diagnosis 4: ''
[07:14:10] ℹ️    - Diagnosis 5: ''
[07:14:10] ℹ️    - Diagnosis 6: ''
[07:14:10] ℹ️  Final extracted MRN: ''
[07:14:10] ℹ️  Final extracted Sex: ''
[07:14:10] ℹ️  Final extracted Service Line: ''
[07:14:10] ℹ️  Final extracted Payer Source: ''
[07:14:10] ✅ Patient data extraction completed successfully
[07:14:10] ✅    ✅ Patient data extracted successfully
[07:14:10] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[07:14:10] ⚠️     ❌ Insufficient patient data extracted
[07:14:10] [DOC: 9234474] ℹ️  API push details saved for document 9234474
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[07:14:10] ℹ️  Total Processed: 100
[07:14:10] ℹ️  CSV Success: 71
[07:14:10] ℹ️  CSV Errors: 11
[07:14:10] ℹ️  API Success: 0
[07:14:10] ℹ️  API Errors: 89
[07:14:10] ℹ️  CSV Success Rate: 71.0%
[07:14:10] ℹ️  API Success Rate: 0.0%
[07:14:10] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250608_063504.csv
[07:14:10] ℹ️  API Details File: api_outputs/api_push_details_20250608_063504.csv
================================================================================
║          ============================================================          ║
================================================================================
