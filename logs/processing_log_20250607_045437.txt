================================================================================
║                            FINAL VERSION PROCESSOR                             ║
================================================================================
[04:54:37] ℹ️  CSV Data Extraction & API Push Tool
[04:54:37] ℹ️  
[04:54:37] ℹ️  Features:
[04:54:37] ℹ️  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[04:54:37] ℹ️  - AI-powered patient and order data extraction
[04:54:37] ℹ️  - Enhanced error handling and logging
[04:54:37] ℹ️  - Full API integration (patient creation + order pushing)
[04:54:37] ℹ️  - CSV output with comprehensive patient data
[04:54:37] ℹ️  - Detailed API tracking with remarks for every document
[04:54:37] ℹ️  - Complete audit trail of all processing attempts
[04:54:37] ℹ️  
[04:54:37] ℹ️  Starting CSV processing with API integration: hawthorn_fam.csv
[04:54:37] ✅ Created output CSV file: csv_outputs/extracted_patients_20250607_045437.csv
[04:54:37] ✅ Created API details CSV file: api_outputs/api_push_details_20250607_045437.csv
================================================================================
║                        Processing Document ID: 9322942                         ║
================================================================================
[04:54:37] ℹ️  Agency: Visiting Rehab & Nursing Services
[04:54:37] ℹ️  Date: 06/02/2025
[04:54:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:54:41] [DOC: 9322942] ✅ Text extracted using pdfplumber (1743 chars)
[04:54:41] ✅    ✅ Text extracted using pdfplumber (1731 chars)
[04:54:41] 🔄 
🔄 Step 2: Extracting patient data...
[04:54:45] ℹ️  AI extracted raw sex value: ''
[04:54:45] ℹ️  AI extracted service line: ''
[04:54:45] ℹ️  AI extracted payer source: ''
[04:54:45] ℹ️  AI extracted diagnoses:
[04:54:45] ℹ️    - Diagnosis 1: 'M17.11'
[04:54:45] ℹ️    - Diagnosis 2: 'G31.83'
[04:54:45] ℹ️    - Diagnosis 3: 'F02.83'
[04:54:45] ℹ️    - Diagnosis 4: ''
[04:54:45] ℹ️    - Diagnosis 5: ''
[04:54:45] ℹ️    - Diagnosis 6: ''
[04:54:45] ℹ️  Final extracted MRN: 'HcbrMC893'
[04:54:45] ℹ️  Final extracted Sex: ''
[04:54:45] ℹ️  Final extracted Service Line: ''
[04:54:45] ℹ️  Final extracted Payer Source: ''
[04:54:45] ✅ Patient data extraction completed successfully
[04:54:45] ✅    ✅ Patient data extracted successfully
[04:54:45] 📊 Patient Response
     └─ patientFName: Jeanne
     └─ patientLName: DOliveira
     └─ dob: 09/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: HcbrMC893
     └─ billingProvider: Karmina Bautista MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: 
     └─ address: 1080 Russells Mills Rd
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508) 542-9366
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2025', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': 'M17.11', 'secondDiagnosis': 'G31.83', 'thirdDiagnosis': 'F02.83', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:54:45] ✅    ✅ Patient identified: Jeanne DOliveira
[04:54:45] ✅    ✅ Patient name validation passed
[04:54:45] 🔄 
🔄 Step 3: Processing patient dates...
[04:54:45] [DOC: 9322942] ℹ️  DOB normalized: 09/11/1952
[04:54:45] [DOC: 9322942] ℹ️  Episode startOfCare normalized: 05/21/2025
[04:54:45] [DOC: 9322942] ℹ️  Episode startOfEpisode normalized: 05/21/2025
[04:54:45] [DOC: 9322942] ℹ️  Episode endOfEpisode normalized: 07/19/2025
[04:54:45] [DOC: 9322942] ✅ Patient date processing completed successfully
[04:54:45] ✅    ✅ Date processing completed
[04:54:45] 📊 Processed Patient Data
     └─ patientFName: Jeanne
     └─ patientLName: DOliveira
     └─ dob: 09/11/1952
     └─ patientSex: 
     └─ medicalRecordNo: HcbrMC893
     └─ billingProvider: Karmina Bautista MD
     └─ npi: 1033131008
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: 
     └─ address: 1080 Russells Mills Rd
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ email: 
     └─ phoneNumber: (508) 542-9366
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2025', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': 'M17.11', 'secondDiagnosis': 'G31.83', 'thirdDiagnosis': 'F02.83', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:54:45] 🔄 
🔄 Step 4: Extracting order data...
[04:54:48] ℹ️  Order extraction - MRN: 'HcbrMC893'
[04:54:48] ℹ️  Order extraction - Sex: ''
[04:54:48] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[04:54:48] ℹ️  Order extraction - Payer Source: ''
[04:54:48] ✅ Order data extraction completed successfully
[04:54:48] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:54:48] ℹ️  Using MRN from patient data: 'HcbrMC893' over 'HcbrMC893'
[04:54:48] ⚠️  Could not determine sex using any available method
[04:54:48] ℹ️  Using service line from order data: 'Physical Therapy'
[04:54:48] ✅ Patient name cross-validation successful
[04:54:48] ✅    ✅ Data merged successfully
[04:54:49] ✅    ✅ Order data extracted and validated
[04:54:49] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:54:58] [DOC: 9322942] ✅ Patient exists in API: Jeanne DOliveira, ID: 034491a3-520e-4d6d-b802-7a04aa6ac087
[04:54:58] ✅    ✅ Existing patient found with ID: 034491a3-520e-4d6d-b802-7a04aa6ac087
[04:54:58] 🔄 
🔄 Step 6: Pushing order to API...
[04:54:58] [DOC: 9322942] ℹ️  Pushing order via API for patient ID: 034491a3-520e-4d6d-b802-7a04aa6ac087
[04:54:59] [DOC: 9322942] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18746"}
[04:54:59] ❌    ❌ Failed to push order
[04:54:59] 🔄 
🔄 Step 7: Writing to CSV...
[04:54:59] [DOC: 9322942] ℹ️  Calculated age: 72 from DOB: 09/11/1952
[04:54:59] [DOC: 9322942] ℹ️  Service Line extracted: 'Physical Therapy'
[04:54:59] [DOC: 9322942] ℹ️  Payer Source extracted: ''
[04:54:59] [DOC: 9322942] ℹ️  Diagnosis codes being written:
[04:54:59] [DOC: 9322942] ℹ️    - Latest_Episode_Firstdiagnosis: 'M17.11'
[04:54:59] [DOC: 9322942] ℹ️    - Latest_Episode_Seconddiagnosis: 'G31.83'
[04:54:59] [DOC: 9322942] ℹ️    - Latest_Episode_Thirddiagnosis: 'F02.83'
[04:54:59] [DOC: 9322942] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:54:59] [DOC: 9322942] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:54:59] [DOC: 9322942] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:54:59] [DOC: 9322942] ✅ Patient data written to CSV: Jeanne DOliveira | Sex:  | Age: 72 | Service: Physical Therapy | Payer:  | MRN: HcbrMC893
[04:54:59] ✅    ✅ Document 9322942 processed and saved successfully
[04:54:59] 🔄 
🔄 Step 8: Saving API details...
[04:54:59] [DOC: 9322942] ℹ️  API push details saved for document 9322942
[04:54:59] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9322908                         ║
================================================================================
[04:54:59] ℹ️  Agency: Visiting Rehab & Nursing Services
[04:54:59] ℹ️  Date: 06/02/2025
[04:54:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:55:03] [DOC: 9322908] ✅ Text extracted using pdfplumber (1413 chars)
[04:55:03] ✅    ✅ Text extracted using pdfplumber (1413 chars)
[04:55:03] 🔄 
🔄 Step 2: Extracting patient data...
[04:55:06] ℹ️  AI extracted raw sex value: ''
[04:55:06] ℹ️  AI extracted service line: 'Home healthcare'
[04:55:06] ℹ️  AI extracted payer source: ''
[04:55:06] ℹ️  AI extracted diagnoses:
[04:55:06] ℹ️    - Diagnosis 1: ''
[04:55:06] ℹ️    - Diagnosis 2: ''
[04:55:06] ℹ️    - Diagnosis 3: ''
[04:55:06] ℹ️    - Diagnosis 4: ''
[04:55:06] ℹ️    - Diagnosis 5: ''
[04:55:06] ℹ️    - Diagnosis 6: ''
[04:55:06] ℹ️  Final extracted MRN: ''
[04:55:06] ℹ️  Final extracted Sex: ''
[04:55:06] ℹ️  Final extracted Service Line: 'Home healthcare'
[04:55:06] ℹ️  Final extracted Payer Source: ''
[04:55:06] ✅ Patient data extraction completed successfully
[04:55:06] ✅    ✅ Patient data extracted successfully
[04:55:06] 📊 Patient Response
     └─ patientFName: Elizabeth
     └─ patientLName: St. Jacques
     └─ dob: 
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Visiting Rehab and Nursing Services
     └─ address: 125 High Street, Suite 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048
     └─ email: jmartinez@vrnshh.com
     └─ phoneNumber: (774) 581-9986
     └─ serviceLine: Home healthcare
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:55:06] ⚠️     ❌ Insufficient patient data extracted
[04:55:06] [DOC: 9322908] ℹ️  API push details saved for document 9322908
================================================================================
║                        Processing Document ID: 9322867                         ║
================================================================================
[04:55:06] ℹ️  Agency: Visiting Rehab & Nursing Services
[04:55:06] ℹ️  Date: 06/02/2025
[04:55:06] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:55:08] [DOC: 9322867] ✅ Text extracted using pdfplumber (5654 chars)
[04:55:08] ✅    ✅ Text extracted using pdfplumber (5654 chars)
[04:55:08] 🔄 
🔄 Step 2: Extracting patient data...
[04:55:10] ℹ️  AI extracted raw sex value: 'None'
[04:55:10] ℹ️  AI extracted service line: 'None'
[04:55:10] ℹ️  AI extracted payer source: 'None'
[04:55:10] ℹ️  AI extracted diagnoses:
[04:55:10] ℹ️    - Diagnosis 1: ''
[04:55:10] ℹ️    - Diagnosis 2: ''
[04:55:10] ℹ️    - Diagnosis 3: ''
[04:55:10] ℹ️    - Diagnosis 4: ''
[04:55:10] ℹ️    - Diagnosis 5: ''
[04:55:10] ℹ️    - Diagnosis 6: ''
[04:55:10] ℹ️  Final extracted MRN: ''
[04:55:10] ℹ️  Final extracted Sex: ''
[04:55:10] ℹ️  Final extracted Service Line: ''
[04:55:10] ℹ️  Final extracted Payer Source: ''
[04:55:10] ✅ Patient data extraction completed successfully
[04:55:10] ✅    ✅ Patient data extracted successfully
[04:55:10] 📊 Patient Response
     └─ patientFName: None
     └─ patientLName: None
     └─ dob: None
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: None
     └─ address: None
     └─ city: None
     └─ state: None
     └─ zip: 
     └─ email: None
     └─ phoneNumber: 
     └─ serviceLine: 
     └─ payorSource: 
     └─ episodeDiagnoses: []
[04:55:10] ⚠️     ❌ Insufficient patient data extracted
[04:55:10] [DOC: 9322867] ℹ️  API push details saved for document 9322867
================================================================================
║                        Processing Document ID: 9322866                         ║
================================================================================
[04:55:10] ℹ️  Agency: Visiting Rehab & Nursing Services
[04:55:10] ℹ️  Date: 06/02/2025
[04:55:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:55:12] [DOC: 9322866] ✅ Text extracted using pdfplumber (16380 chars)
[04:55:12] ✅    ✅ Text extracted using pdfplumber (16368 chars)
[04:55:12] 🔄 
🔄 Step 2: Extracting patient data...
[04:55:16] ℹ️  AI extracted raw sex value: 'F'
[04:55:16] ℹ️  AI extracted service line: 'PT'
[04:55:16] ℹ️  AI extracted payer source: 'Medicare'
[04:55:16] ℹ️  AI extracted diagnoses:
[04:55:16] ℹ️    - Diagnosis 1: 'M17.11'
[04:55:16] ℹ️    - Diagnosis 2: 'G31.83'
[04:55:16] ℹ️    - Diagnosis 3: 'F02.83'
[04:55:16] ℹ️    - Diagnosis 4: 'F02.A4'
[04:55:16] ℹ️    - Diagnosis 5: 'G25.9'
[04:55:16] ℹ️    - Diagnosis 6: 'I10'
[04:55:16] ℹ️  Final extracted MRN: 'HcbrMC893'
[04:55:16] ℹ️  Final extracted Sex: 'FEMALE'
[04:55:16] ℹ️  Final extracted Service Line: 'PT'
[04:55:16] ℹ️  Final extracted Payer Source: 'Medicare'
[04:55:16] ✅ Patient data extraction completed successfully
[04:55:16] ✅    ✅ Patient data extracted successfully
[04:55:16] 📊 Patient Response
     └─ patientFName: Jeanne
     └─ patientLName: DOliveira
     └─ dob: 09/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: HcbrMC893
     └─ billingProvider: Visiting Rehab and Nursing
     └─ npi: 1396101861
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Visiting Rehab and Nursing
     └─ address: 125 High Street STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048-2165
     └─ email: None
     └─ phoneNumber: (877) 242-8771
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': 'M17.11', 'secondDiagnosis': 'G31.83', 'thirdDiagnosis': 'F02.83', 'fourthDiagnosis': 'F02.A4', 'fifthDiagnosis': 'G25.9', 'sixthDiagnosis': 'I10'}]
[04:55:16] ✅    ✅ Patient identified: Jeanne DOliveira
[04:55:16] ✅    ✅ Patient name validation passed
[04:55:16] 🔄 
🔄 Step 3: Processing patient dates...
[04:55:16] [DOC: 9322866] ℹ️  DOB normalized: 09/11/1952
[04:55:16] [DOC: 9322866] ℹ️  Episode startOfCare normalized: 05/07/2025
[04:55:16] [DOC: 9322866] ℹ️  Episode startOfEpisode normalized: 05/21/2025
[04:55:16] [DOC: 9322866] ℹ️  Episode endOfEpisode normalized: 07/19/2025
[04:55:16] [DOC: 9322866] ✅ Patient date processing completed successfully
[04:55:16] ✅    ✅ Date processing completed
[04:55:16] 📊 Processed Patient Data
     └─ patientFName: Jeanne
     └─ patientLName: DOliveira
     └─ dob: 09/11/1952
     └─ patientSex: FEMALE
     └─ medicalRecordNo: HcbrMC893
     └─ billingProvider: Visiting Rehab and Nursing
     └─ npi: 1396101861
     └─ physicianNPI: 1033131008
     └─ nameOfAgency: Visiting Rehab and Nursing
     └─ address: 125 High Street STE 204
     └─ city: Mansfield
     └─ state: MA
     └─ zip: 02048-2165
     └─ phoneNumber: (877) 242-8771
     └─ serviceLine: PT
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': 'M17.11', 'secondDiagnosis': 'G31.83', 'thirdDiagnosis': 'F02.83', 'fourthDiagnosis': 'F02.A4', 'fifthDiagnosis': 'G25.9', 'sixthDiagnosis': 'I10'}]
[04:55:16] 🔄 
🔄 Step 4: Extracting order data...
[04:55:19] ℹ️  Order extraction - MRN: 'HcbrMC893'
[04:55:19] ℹ️  Order extraction - Sex: 'FEMALE'
[04:55:19] ℹ️  Order extraction - Service Line: 'PT'
[04:55:19] ℹ️  Order extraction - Payer Source: 'Medicare'
[04:55:19] ✅ Order data extraction completed successfully
[04:55:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:55:19] ℹ️  Using MRN from patient data: 'HcbrMC893' over 'HcbrMC893'
[04:55:19] ℹ️  Service line consistent in both sources: 'PT'
[04:55:19] ℹ️  Payer source consistent in both sources: 'Medicare'
[04:55:19] ✅ Patient name cross-validation successful
[04:55:19] ✅    ✅ Data merged successfully
[04:55:20] ✅    ✅ Order data extracted and validated
[04:55:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:55:20] [DOC: 9322866] ✅ Patient found in local cache: Jeanne DOliveira, ID: 034491a3-520e-4d6d-b802-7a04aa6ac087
[04:55:20] ✅    ✅ Existing patient found with ID: 034491a3-520e-4d6d-b802-7a04aa6ac087
[04:55:20] 🔄 
🔄 Step 6: Pushing order to API...
[04:55:20] [DOC: 9322866] ℹ️  Pushing order via API for patient ID: 034491a3-520e-4d6d-b802-7a04aa6ac087
[04:55:21] [DOC: 9322866] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18749"}
[04:55:21] ❌    ❌ Failed to push order
[04:55:21] 🔄 
🔄 Step 7: Writing to CSV...
[04:55:21] [DOC: 9322866] ℹ️  Calculated age: 72 from DOB: 09/11/1952
[04:55:21] [DOC: 9322866] ℹ️  Service Line extracted: 'PT'
[04:55:21] [DOC: 9322866] ℹ️  Payer Source extracted: 'Medicare'
[04:55:21] [DOC: 9322866] ℹ️  Diagnosis codes being written:
[04:55:21] [DOC: 9322866] ℹ️    - Latest_Episode_Firstdiagnosis: 'M17.11'
[04:55:21] [DOC: 9322866] ℹ️    - Latest_Episode_Seconddiagnosis: 'G31.83'
[04:55:21] [DOC: 9322866] ℹ️    - Latest_Episode_Thirddiagnosis: 'F02.83'
[04:55:21] [DOC: 9322866] ℹ️    - Latest_Episode_Fourthdiagnosis: 'F02.A4'
[04:55:21] [DOC: 9322866] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G25.9'
[04:55:21] [DOC: 9322866] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I10'
[04:55:21] [DOC: 9322866] ✅ Patient data written to CSV: Jeanne DOliveira | Sex: FEMALE | Age: 72 | Service: PT | Payer: Medicare | MRN: HcbrMC893
[04:55:21] ✅    ✅ Document 9322866 processed and saved successfully
[04:55:21] 🔄 
🔄 Step 8: Saving API details...
[04:55:21] [DOC: 9322866] ℹ️  API push details saved for document 9322866
[04:55:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321916                         ║
================================================================================
[04:55:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:55:21] ℹ️  Date: 06/02/2025
[04:55:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:55:23] [DOC: 9321916] ✅ Text extracted using pdfplumber (1672 chars)
[04:55:23] ✅    ✅ Text extracted using pdfplumber (1672 chars)
[04:55:23] 🔄 
🔄 Step 2: Extracting patient data...
[04:55:25] ℹ️  AI extracted raw sex value: 'F'
[04:55:25] ℹ️  AI extracted service line: 'MSW'
[04:55:25] ℹ️  AI extracted payer source: ''
[04:55:25] ℹ️  AI extracted diagnoses:
[04:55:25] ℹ️    - Diagnosis 1: ''
[04:55:25] ℹ️    - Diagnosis 2: ''
[04:55:25] ℹ️    - Diagnosis 3: ''
[04:55:25] ℹ️    - Diagnosis 4: ''
[04:55:25] ℹ️    - Diagnosis 5: ''
[04:55:25] ℹ️    - Diagnosis 6: ''
[04:55:25] ℹ️  Final extracted MRN: '3494855'
[04:55:25] ℹ️  Final extracted Sex: 'FEMALE'
[04:55:25] ℹ️  Final extracted Service Line: 'MSW'
[04:55:25] ℹ️  Final extracted Payer Source: ''
[04:55:25] ✅ Patient data extraction completed successfully
[04:55:25] ✅    ✅ Patient data extracted successfully
[04:55:25] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Skaza
     └─ dob: 09/23/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3494855
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: MSW
     └─ payorSource: 
     └─ episodeDiagnoses: []
[04:55:25] ✅    ✅ Patient identified: Patricia Skaza
[04:55:25] ✅    ✅ Patient name validation passed
[04:55:25] 🔄 
🔄 Step 3: Processing patient dates...
[04:55:25] [DOC: 9321916] ℹ️  DOB normalized: 09/23/1947
[04:55:25] [DOC: 9321916] ✅ Patient date processing completed successfully
[04:55:25] ✅    ✅ Date processing completed
[04:55:25] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Skaza
     └─ dob: 09/23/1947
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3494855
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: MSW
     └─ payorSource: 
     └─ episodeDiagnoses: []
[04:55:25] 🔄 
🔄 Step 4: Extracting order data...
[04:55:27] ℹ️  Order extraction - MRN: '3494855'
[04:55:27] ℹ️  Order extraction - Sex: 'FEMALE'
[04:55:27] ℹ️  Order extraction - Service Line: 'MSW'
[04:55:27] ℹ️  Order extraction - Payer Source: ''
[04:55:27] ✅ Order data extraction completed successfully
[04:55:27] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:55:27] ℹ️  Using MRN from patient data: '3494855' over '3494855'
[04:55:27] ℹ️  Service line consistent in both sources: 'MSW'
[04:55:27] ✅ Patient name cross-validation successful
[04:55:27] ✅    ✅ Data merged successfully
[04:55:28] ✅    ✅ Order data extracted and validated
[04:55:28] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:55:33] [DOC: 9321916] ✅ Patient exists in API: Patricia Skaza, ID: dc3655e9-56c2-4423-bdaa-c4e93123cb50
[04:55:33] ✅    ✅ Existing patient found with ID: dc3655e9-56c2-4423-bdaa-c4e93123cb50
[04:55:33] 🔄 
🔄 Step 6: Pushing order to API...
[04:55:33] [DOC: 9321916] ℹ️  Pushing order via API for patient ID: dc3655e9-56c2-4423-bdaa-c4e93123cb50
[04:55:34] [DOC: 9321916] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18750"}
[04:55:34] ❌    ❌ Failed to push order
[04:55:34] 🔄 
🔄 Step 7: Writing to CSV...
[04:55:34] [DOC: 9321916] ℹ️  Calculated age: 77 from DOB: 09/23/1947
[04:55:34] [DOC: 9321916] ℹ️  Service Line extracted: 'MSW'
[04:55:34] [DOC: 9321916] ℹ️  Payer Source extracted: ''
[04:55:34] [DOC: 9321916] ℹ️  Diagnosis codes being written:
[04:55:34] [DOC: 9321916] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:55:34] [DOC: 9321916] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:55:34] [DOC: 9321916] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:55:34] [DOC: 9321916] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:55:34] [DOC: 9321916] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:55:34] [DOC: 9321916] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:55:34] [DOC: 9321916] ✅ Patient data written to CSV: Patricia Skaza | Sex: FEMALE | Age: 77 | Service: MSW | Payer:  | MRN: 3494855
[04:55:34] ✅    ✅ Document 9321916 processed and saved successfully
[04:55:34] 🔄 
🔄 Step 8: Saving API details...
[04:55:34] [DOC: 9321916] ℹ️  API push details saved for document 9321916
[04:55:34] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321882                         ║
================================================================================
[04:55:34] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:55:34] ℹ️  Date: 06/02/2025
[04:55:34] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:55:36] [DOC: 9321882] ✅ Text extracted using pdfplumber (1121 chars)
[04:55:36] ✅    ✅ Text extracted using pdfplumber (1121 chars)
[04:55:36] 🔄 
🔄 Step 2: Extracting patient data...
[04:55:38] ℹ️  AI extracted raw sex value: 'F'
[04:55:38] ℹ️  AI extracted service line: 'Occupational Therapy, Home Health Aide'
[04:55:38] ℹ️  AI extracted payer source: ''
[04:55:38] ℹ️  AI extracted diagnoses:
[04:55:38] ℹ️    - Diagnosis 1: ''
[04:55:38] ℹ️    - Diagnosis 2: ''
[04:55:38] ℹ️    - Diagnosis 3: ''
[04:55:38] ℹ️    - Diagnosis 4: ''
[04:55:38] ℹ️    - Diagnosis 5: ''
[04:55:38] ℹ️    - Diagnosis 6: ''
[04:55:38] ℹ️  Final extracted MRN: '2122243'
[04:55:38] ℹ️  Final extracted Sex: 'FEMALE'
[04:55:38] ℹ️  Final extracted Service Line: 'Occupational Therapy, Home Health Aide'
[04:55:38] ℹ️  Final extracted Payer Source: ''
[04:55:38] ✅ Patient data extraction completed successfully
[04:55:38] ✅    ✅ Patient data extracted successfully
[04:55:38] 📊 Patient Response
     └─ patientFName: Carolyn
     └─ patientLName: Miranda
     └─ dob: 08/30/1961
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2122243
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:55:38] ✅    ✅ Patient identified: Carolyn Miranda
[04:55:38] ✅    ✅ Patient name validation passed
[04:55:38] 🔄 
🔄 Step 3: Processing patient dates...
[04:55:38] [DOC: 9321882] ℹ️  DOB normalized: 08/30/1961
[04:55:38] [DOC: 9321882] ✅ Patient date processing completed successfully
[04:55:38] ✅    ✅ Date processing completed
[04:55:38] 📊 Processed Patient Data
     └─ patientFName: Carolyn
     └─ patientLName: Miranda
     └─ dob: 08/30/1961
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2122243
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Occupational Therapy, Home Health Aide
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:55:38] 🔄 
🔄 Step 4: Extracting order data...
[04:55:41] ℹ️  Order extraction - MRN: '2122243'
[04:55:41] ℹ️  Order extraction - Sex: 'FEMALE'
[04:55:41] ℹ️  Order extraction - Service Line: 'Occupational Therapy, Home Health Aide'
[04:55:41] ℹ️  Order extraction - Payer Source: ''
[04:55:41] ✅ Order data extraction completed successfully
[04:55:41] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:55:41] ℹ️  Using MRN from patient data: '2122243' over '2122243'
[04:55:41] ℹ️  Service line consistent in both sources: 'Occupational Therapy, Home Health Aide'
[04:55:41] ✅ Patient name cross-validation successful
[04:55:41] ✅    ✅ Data merged successfully
[04:55:42] ✅    ✅ Order data extracted and validated
[04:55:42] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:55:48] [DOC: 9321882] ✅ Patient exists in API: Carolyn Miranda, ID: 80449427-0daf-4c75-96b1-77390a2a15f7
[04:55:48] ✅    ✅ Existing patient found with ID: 80449427-0daf-4c75-96b1-77390a2a15f7
[04:55:48] 🔄 
🔄 Step 6: Pushing order to API...
[04:55:48] [DOC: 9321882] ℹ️  Pushing order via API for patient ID: 80449427-0daf-4c75-96b1-77390a2a15f7
[04:55:50] [DOC: 9321882] ❌ Order push failed with status 201: {"id":"fbcf548f-7ed9-465d-b909-d2da3952556e","orderWAVId":"ORD19932","orderNo":"1096937, 1096942","orderDate":"05/29/2025","startOfCare":"06/01/2025","episodeStartDate":"06/01/2025","episodeEndDate":"06/28/2025","documentID":"9321882","mrn":"2122243","patientName":"Miranda,Carolyn J","sentToPhysicianDate":"06/02/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":null,"signedByPhysicianStatus":false,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"80449427-0daf-4c75-96b1-77390a2a15f7","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[04:55:50] ❌    ❌ Failed to push order
[04:55:50] 🔄 
🔄 Step 7: Writing to CSV...
[04:55:50] [DOC: 9321882] ℹ️  Calculated age: 63 from DOB: 08/30/1961
[04:55:50] [DOC: 9321882] ℹ️  Service Line extracted: 'Occupational Therapy, Home Health Aide'
[04:55:50] [DOC: 9321882] ℹ️  Payer Source extracted: ''
[04:55:50] [DOC: 9321882] ℹ️  Diagnosis codes being written:
[04:55:50] [DOC: 9321882] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:55:50] [DOC: 9321882] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:55:50] [DOC: 9321882] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:55:50] [DOC: 9321882] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:55:50] [DOC: 9321882] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:55:50] [DOC: 9321882] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:55:50] [DOC: 9321882] ✅ Patient data written to CSV: Carolyn Miranda | Sex: FEMALE | Age: 63 | Service: Occupational Therapy, Home Health Aide | Payer:  | MRN: 2122243
[04:55:50] ✅    ✅ Document 9321882 processed and saved successfully
[04:55:50] 🔄 
🔄 Step 8: Saving API details...
[04:55:50] [DOC: 9321882] ℹ️  API push details saved for document 9321882
[04:55:50] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321878                         ║
================================================================================
[04:55:50] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:55:50] ℹ️  Date: 06/02/2025
[04:55:50] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:55:51] [DOC: 9321878] ✅ Text extracted using pdfplumber (907 chars)
[04:55:51] ✅    ✅ Text extracted using pdfplumber (907 chars)
[04:55:51] 🔄 
🔄 Step 2: Extracting patient data...
[04:55:54] ℹ️  AI extracted raw sex value: 'M'
[04:55:54] ℹ️  AI extracted service line: 'Nursing'
[04:55:54] ℹ️  AI extracted payer source: ''
[04:55:54] ℹ️  AI extracted diagnoses:
[04:55:54] ℹ️    - Diagnosis 1: 'None'
[04:55:54] ℹ️    - Diagnosis 2: 'None'
[04:55:54] ℹ️    - Diagnosis 3: 'None'
[04:55:54] ℹ️    - Diagnosis 4: 'None'
[04:55:54] ℹ️    - Diagnosis 5: 'None'
[04:55:54] ℹ️    - Diagnosis 6: 'None'
[04:55:54] ℹ️  Final extracted MRN: '2749679'
[04:55:54] ℹ️  Final extracted Sex: 'MALE'
[04:55:54] ℹ️  Final extracted Service Line: 'Nursing'
[04:55:54] ℹ️  Final extracted Payer Source: ''
[04:55:54] ✅ Patient data extraction completed successfully
[04:55:54] ✅    ✅ Patient data extracted successfully
[04:55:54] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: Michaud
     └─ dob: 03/13/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 2749679
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:55:54] ✅    ✅ Patient identified: Robert Michaud
[04:55:54] ✅    ✅ Patient name validation passed
[04:55:54] 🔄 
🔄 Step 3: Processing patient dates...
[04:55:54] [DOC: 9321878] ℹ️  DOB normalized: 03/13/1937
[04:55:54] [DOC: 9321878] ✅ Patient date processing completed successfully
[04:55:54] ✅    ✅ Date processing completed
[04:55:54] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: Michaud
     └─ dob: 03/13/1937
     └─ patientSex: MALE
     └─ medicalRecordNo: 2749679
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[04:55:54] 🔄 
🔄 Step 4: Extracting order data...
[04:55:56] ℹ️  Order extraction - MRN: '2749679'
[04:55:56] ℹ️  Order extraction - Sex: 'MALE'
[04:55:56] ℹ️  Order extraction - Service Line: ''
[04:55:56] ℹ️  Order extraction - Payer Source: ''
[04:55:56] ✅ Order data extraction completed successfully
[04:55:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:55:56] ℹ️  Using MRN from patient data: '2749679' over '2749679'
[04:55:56] ℹ️  Using service line from patient data: 'Nursing'
[04:55:56] ✅ Patient name cross-validation successful
[04:55:56] ✅    ✅ Data merged successfully
[04:55:57] ✅    ✅ Order data extracted and validated
[04:55:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:56:34] [DOC: 9321878] ✅ Patient exists in API: Robert Michaud, ID: b2f8cef3-41f9-4633-abdc-41afddf1457e
[04:56:34] ✅    ✅ Existing patient found with ID: b2f8cef3-41f9-4633-abdc-41afddf1457e
[04:56:34] 🔄 
🔄 Step 6: Pushing order to API...
[04:56:34] [DOC: 9321878] ℹ️  Pushing order via API for patient ID: b2f8cef3-41f9-4633-abdc-41afddf1457e
[04:56:35] [DOC: 9321878] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18752"}
[04:56:35] ❌    ❌ Failed to push order
[04:56:35] 🔄 
🔄 Step 7: Writing to CSV...
[04:56:35] [DOC: 9321878] ℹ️  Calculated age: 88 from DOB: 03/13/1937
[04:56:35] [DOC: 9321878] ℹ️  Service Line extracted: 'Nursing'
[04:56:35] [DOC: 9321878] ℹ️  Payer Source extracted: ''
[04:56:35] [DOC: 9321878] ℹ️  Diagnosis codes being written:
[04:56:35] [DOC: 9321878] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:56:35] [DOC: 9321878] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:56:35] [DOC: 9321878] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:56:35] [DOC: 9321878] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:56:35] [DOC: 9321878] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:56:35] [DOC: 9321878] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:56:35] [DOC: 9321878] ✅ Patient data written to CSV: Robert Michaud | Sex: MALE | Age: 88 | Service: Nursing | Payer:  | MRN: 2749679
[04:56:35] ✅    ✅ Document 9321878 processed and saved successfully
[04:56:35] 🔄 
🔄 Step 8: Saving API details...
[04:56:35] [DOC: 9321878] ℹ️  API push details saved for document 9321878
[04:56:35] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321871                         ║
================================================================================
[04:56:35] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:56:35] ℹ️  Date: 06/02/2025
[04:56:35] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:56:37] [DOC: 9321871] ✅ Text extracted using pdfplumber (1831 chars)
[04:56:37] ✅    ✅ Text extracted using pdfplumber (1831 chars)
[04:56:37] 🔄 
🔄 Step 2: Extracting patient data...
[04:56:39] ℹ️  AI extracted raw sex value: 'M'
[04:56:39] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:56:39] ℹ️  AI extracted payer source: ''
[04:56:39] ℹ️  AI extracted diagnoses:
[04:56:39] ℹ️    - Diagnosis 1: 'None'
[04:56:39] ℹ️    - Diagnosis 2: 'None'
[04:56:39] ℹ️    - Diagnosis 3: 'None'
[04:56:39] ℹ️    - Diagnosis 4: 'None'
[04:56:39] ℹ️    - Diagnosis 5: 'None'
[04:56:39] ℹ️    - Diagnosis 6: 'None'
[04:56:39] ℹ️  Final extracted MRN: '2741524'
[04:56:39] ℹ️  Final extracted Sex: 'MALE'
[04:56:39] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:56:39] ℹ️  Final extracted Payer Source: ''
[04:56:39] ✅ Patient data extraction completed successfully
[04:56:39] ✅    ✅ Patient data extracted successfully
[04:56:39] 📊 Patient Response
     └─ patientFName: Stephen
     └─ patientLName: Mellor
     └─ dob: 07/24/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2741524
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:56:39] ✅    ✅ Patient identified: Stephen Mellor
[04:56:39] ✅    ✅ Patient name validation passed
[04:56:39] 🔄 
🔄 Step 3: Processing patient dates...
[04:56:39] [DOC: 9321871] ℹ️  DOB normalized: 07/24/1944
[04:56:39] [DOC: 9321871] ✅ Patient date processing completed successfully
[04:56:39] ✅    ✅ Date processing completed
[04:56:39] 📊 Processed Patient Data
     └─ patientFName: Stephen
     └─ patientLName: Mellor
     └─ dob: 07/24/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 2741524
     └─ billingProvider: Hugo Jauregui, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[04:56:39] 🔄 
🔄 Step 4: Extracting order data...
[04:56:42] ℹ️  Order extraction - MRN: '2741524'
[04:56:42] ℹ️  Order extraction - Sex: 'MALE'
[04:56:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:56:42] ℹ️  Order extraction - Payer Source: ''
[04:56:42] ✅ Order data extraction completed successfully
[04:56:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:56:42] ℹ️  Using MRN from patient data: '2741524' over '2741524'
[04:56:42] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:56:42] ✅ Patient name cross-validation successful
[04:56:42] ✅    ✅ Data merged successfully
[04:56:43] ⚠️     ❌ Skipping - missing episode start date
[04:56:43] [DOC: 9321871] ℹ️  API push details saved for document 9321871
================================================================================
║                        Processing Document ID: 9321869                         ║
================================================================================
[04:56:43] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:56:43] ℹ️  Date: 06/02/2025
[04:56:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:56:44] [DOC: 9321869] ✅ Text extracted using pdfplumber (1264 chars)
[04:56:44] ✅    ✅ Text extracted using pdfplumber (1264 chars)
[04:56:44] 🔄 
🔄 Step 2: Extracting patient data...
[04:56:47] ℹ️  AI extracted raw sex value: 'F'
[04:56:47] ℹ️  AI extracted service line: 'Medical Social Work'
[04:56:47] ℹ️  AI extracted payer source: ''
[04:56:47] ℹ️  AI extracted diagnoses:
[04:56:47] ℹ️    - Diagnosis 1: ''
[04:56:47] ℹ️    - Diagnosis 2: ''
[04:56:47] ℹ️    - Diagnosis 3: ''
[04:56:47] ℹ️    - Diagnosis 4: ''
[04:56:47] ℹ️    - Diagnosis 5: ''
[04:56:47] ℹ️    - Diagnosis 6: ''
[04:56:47] ℹ️  Final extracted MRN: '2737072'
[04:56:47] ℹ️  Final extracted Sex: 'FEMALE'
[04:56:47] ℹ️  Final extracted Service Line: 'Medical Social Work'
[04:56:47] ℹ️  Final extracted Payer Source: ''
[04:56:47] ✅ Patient data extraction completed successfully
[04:56:47] ✅    ✅ Patient data extracted successfully
[04:56:47] 📊 Patient Response
     └─ patientFName: Mary
     └─ patientLName: Melancon
     └─ dob: 08/02/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2737072
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '06/02/2025', 'endOfEpisode': '08/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:56:47] ✅    ✅ Patient identified: Mary Melancon
[04:56:47] ✅    ✅ Patient name validation passed
[04:56:47] 🔄 
🔄 Step 3: Processing patient dates...
[04:56:47] [DOC: 9321869] ℹ️  DOB normalized: 08/02/1934
[04:56:47] [DOC: 9321869] ℹ️  Episode startOfEpisode normalized: 06/02/2025
[04:56:47] [DOC: 9321869] ℹ️  Episode endOfEpisode normalized: 08/23/2025
[04:56:47] [DOC: 9321869] ✅ Patient date processing completed successfully
[04:56:47] ✅    ✅ Date processing completed
[04:56:47] 📊 Processed Patient Data
     └─ patientFName: Mary
     └─ patientLName: Melancon
     └─ dob: 08/02/1934
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2737072
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '06/02/2025', 'endOfEpisode': '08/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:56:47] 🔄 
🔄 Step 4: Extracting order data...
[04:56:49] ℹ️  Order extraction - MRN: '2737072'
[04:56:49] ℹ️  Order extraction - Sex: 'FEMALE'
[04:56:49] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[04:56:49] ℹ️  Order extraction - Payer Source: ''
[04:56:49] ✅ Order data extraction completed successfully
[04:56:49] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:56:49] ℹ️  Using MRN from patient data: '2737072' over '2737072'
[04:56:49] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[04:56:49] ✅ Patient name cross-validation successful
[04:56:49] ✅    ✅ Data merged successfully
[04:56:50] ✅    ✅ Order data extracted and validated
[04:56:50] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:56:55] [DOC: 9321869] ✅ Patient exists in API: Mary Melancon, ID: 70c8194f-5144-41ae-acf3-cd0cd0abde30
[04:56:55] ✅    ✅ Existing patient found with ID: 70c8194f-5144-41ae-acf3-cd0cd0abde30
[04:56:55] 🔄 
🔄 Step 6: Pushing order to API...
[04:56:55] [DOC: 9321869] ℹ️  Pushing order via API for patient ID: 70c8194f-5144-41ae-acf3-cd0cd0abde30
[04:56:56] [DOC: 9321869] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18754"}
[04:56:56] ❌    ❌ Failed to push order
[04:56:56] 🔄 
🔄 Step 7: Writing to CSV...
[04:56:56] [DOC: 9321869] ℹ️  Calculated age: 90 from DOB: 08/02/1934
[04:56:56] [DOC: 9321869] ℹ️  Service Line extracted: 'Medical Social Work'
[04:56:56] [DOC: 9321869] ℹ️  Payer Source extracted: ''
[04:56:56] [DOC: 9321869] ℹ️  Diagnosis codes being written:
[04:56:56] [DOC: 9321869] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:56:56] [DOC: 9321869] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:56:56] [DOC: 9321869] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:56:56] [DOC: 9321869] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:56:56] [DOC: 9321869] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:56:56] [DOC: 9321869] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:56:56] [DOC: 9321869] ✅ Patient data written to CSV: Mary Melancon | Sex: FEMALE | Age: 90 | Service: Medical Social Work | Payer:  | MRN: 2737072
[04:56:56] ✅    ✅ Document 9321869 processed and saved successfully
[04:56:56] 🔄 
🔄 Step 8: Saving API details...
[04:56:56] [DOC: 9321869] ℹ️  API push details saved for document 9321869
[04:56:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321868                         ║
================================================================================
[04:56:56] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:56:56] ℹ️  Date: 06/02/2025
[04:56:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:56:58] [DOC: 9321868] ✅ Text extracted using pdfplumber (1309 chars)
[04:56:58] ✅    ✅ Text extracted using pdfplumber (1309 chars)
[04:56:58] 🔄 
🔄 Step 2: Extracting patient data...
[04:57:00] ℹ️  AI extracted raw sex value: 'F'
[04:57:00] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:57:00] ℹ️  AI extracted payer source: ''
[04:57:00] ℹ️  AI extracted diagnoses:
[04:57:00] ℹ️    - Diagnosis 1: 'None'
[04:57:00] ℹ️    - Diagnosis 2: 'None'
[04:57:00] ℹ️    - Diagnosis 3: 'None'
[04:57:00] ℹ️    - Diagnosis 4: 'None'
[04:57:00] ℹ️    - Diagnosis 5: 'None'
[04:57:00] ℹ️    - Diagnosis 6: 'None'
[04:57:00] ℹ️  Final extracted MRN: '2682827'
[04:57:00] ℹ️  Final extracted Sex: 'FEMALE'
[04:57:00] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:57:00] ℹ️  Final extracted Payer Source: ''
[04:57:00] ✅ Patient data extraction completed successfully
[04:57:00] ✅    ✅ Patient data extracted successfully
[04:57:00] 📊 Patient Response
     └─ patientFName: Patricia
     └─ patientLName: Maciel
     └─ dob: 01/06/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2682827
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:57:00] ✅    ✅ Patient identified: Patricia Maciel
[04:57:00] ✅    ✅ Patient name validation passed
[04:57:00] 🔄 
🔄 Step 3: Processing patient dates...
[04:57:00] [DOC: 9321868] ℹ️  DOB normalized: 01/06/1951
[04:57:00] [DOC: 9321868] ✅ Patient date processing completed successfully
[04:57:00] ✅    ✅ Date processing completed
[04:57:00] 📊 Processed Patient Data
     └─ patientFName: Patricia
     └─ patientLName: Maciel
     └─ dob: 01/06/1951
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2682827
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[04:57:00] 🔄 
🔄 Step 4: Extracting order data...
[04:57:02] ℹ️  Order extraction - MRN: '2682827'
[04:57:02] ℹ️  Order extraction - Sex: 'FEMALE'
[04:57:02] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:57:02] ℹ️  Order extraction - Payer Source: ''
[04:57:02] ✅ Order data extraction completed successfully
[04:57:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:57:02] ℹ️  Using MRN from patient data: '2682827' over '2682827'
[04:57:02] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:57:02] ✅ Patient name cross-validation successful
[04:57:02] ✅    ✅ Data merged successfully
[04:57:04] ✅    ✅ Order data extracted and validated
[04:57:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:57:18] [DOC: 9321868] ✅ Patient exists in API: Patricia Maciel, ID: dee47df5-9c75-4a9c-a386-5e8749abe2e5
[04:57:18] ✅    ✅ Existing patient found with ID: dee47df5-9c75-4a9c-a386-5e8749abe2e5
[04:57:18] 🔄 
🔄 Step 6: Pushing order to API...
[04:57:18] [DOC: 9321868] ℹ️  Pushing order via API for patient ID: dee47df5-9c75-4a9c-a386-5e8749abe2e5
[04:57:21] [DOC: 9321868] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18755"}
[04:57:21] ❌    ❌ Failed to push order
[04:57:21] 🔄 
🔄 Step 7: Writing to CSV...
[04:57:21] [DOC: 9321868] ℹ️  Calculated age: 74 from DOB: 01/06/1951
[04:57:21] [DOC: 9321868] ℹ️  Service Line extracted: 'Skilled Nursing'
[04:57:21] [DOC: 9321868] ℹ️  Payer Source extracted: ''
[04:57:21] [DOC: 9321868] ℹ️  Diagnosis codes being written:
[04:57:21] [DOC: 9321868] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:57:21] [DOC: 9321868] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:57:21] [DOC: 9321868] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:57:21] [DOC: 9321868] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:57:21] [DOC: 9321868] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:57:21] [DOC: 9321868] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:57:21] [DOC: 9321868] ✅ Patient data written to CSV: Patricia Maciel | Sex: FEMALE | Age: 74 | Service: Skilled Nursing | Payer:  | MRN: 2682827
[04:57:21] ✅    ✅ Document 9321868 processed and saved successfully
[04:57:21] 🔄 
🔄 Step 8: Saving API details...
[04:57:21] [DOC: 9321868] ℹ️  API push details saved for document 9321868
[04:57:21] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321863                         ║
================================================================================
[04:57:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:57:21] ℹ️  Date: 06/02/2025
[04:57:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:57:23] [DOC: 9321863] ✅ Text extracted using pdfplumber (1075 chars)
[04:57:23] ✅    ✅ Text extracted using pdfplumber (1075 chars)
[04:57:23] 🔄 
🔄 Step 2: Extracting patient data...
[04:57:25] ℹ️  AI extracted raw sex value: 'M'
[04:57:25] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:57:25] ℹ️  AI extracted payer source: ''
[04:57:25] ℹ️  AI extracted diagnoses:
[04:57:25] ℹ️    - Diagnosis 1: ''
[04:57:25] ℹ️    - Diagnosis 2: ''
[04:57:25] ℹ️    - Diagnosis 3: ''
[04:57:25] ℹ️    - Diagnosis 4: ''
[04:57:25] ℹ️    - Diagnosis 5: ''
[04:57:25] ℹ️    - Diagnosis 6: ''
[04:57:25] ℹ️  Final extracted MRN: '2063794'
[04:57:25] ℹ️  Final extracted Sex: 'MALE'
[04:57:25] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:57:25] ℹ️  Final extracted Payer Source: ''
[04:57:25] ✅ Patient data extraction completed successfully
[04:57:25] ✅    ✅ Patient data extracted successfully
[04:57:25] 📊 Patient Response
     └─ patientFName: Adriano
     └─ patientLName: Lima
     └─ dob: 07/27/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 2063794
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:57:25] ✅    ✅ Patient identified: Adriano Lima
[04:57:25] ✅    ✅ Patient name validation passed
[04:57:25] 🔄 
🔄 Step 3: Processing patient dates...
[04:57:25] [DOC: 9321863] ℹ️  DOB normalized: 07/27/1956
[04:57:25] [DOC: 9321863] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[04:57:25] [DOC: 9321863] ℹ️  Episode endOfEpisode normalized: 06/18/2025
[04:57:25] [DOC: 9321863] ✅ Patient date processing completed successfully
[04:57:25] ✅    ✅ Date processing completed
[04:57:25] 📊 Processed Patient Data
     └─ patientFName: Adriano
     └─ patientLName: Lima
     └─ dob: 07/27/1956
     └─ patientSex: MALE
     └─ medicalRecordNo: 2063794
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:57:25] 🔄 
🔄 Step 4: Extracting order data...
[04:57:28] ℹ️  Order extraction - MRN: '2063794'
[04:57:28] ℹ️  Order extraction - Sex: 'MALE'
[04:57:28] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:57:28] ℹ️  Order extraction - Payer Source: ''
[04:57:28] ✅ Order data extraction completed successfully
[04:57:28] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:57:28] ℹ️  Using MRN from patient data: '2063794' over '2063794'
[04:57:28] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:57:28] ✅ Patient name cross-validation successful
[04:57:28] ✅    ✅ Data merged successfully
[04:57:29] ✅    ✅ Order data extracted and validated
[04:57:29] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:57:55] [DOC: 9321863] ✅ Patient exists in API: Adriano Lima, ID: bc228bea-5a75-435d-ba11-54637f839b99
[04:57:55] ✅    ✅ Existing patient found with ID: bc228bea-5a75-435d-ba11-54637f839b99
[04:57:55] 🔄 
🔄 Step 6: Pushing order to API...
[04:57:55] [DOC: 9321863] ℹ️  Pushing order via API for patient ID: bc228bea-5a75-435d-ba11-54637f839b99
[04:57:56] [DOC: 9321863] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18756"}
[04:57:56] ❌    ❌ Failed to push order
[04:57:56] 🔄 
🔄 Step 7: Writing to CSV...
[04:57:56] [DOC: 9321863] ℹ️  Calculated age: 68 from DOB: 07/27/1956
[04:57:56] [DOC: 9321863] ℹ️  Service Line extracted: 'Skilled Nursing'
[04:57:56] [DOC: 9321863] ℹ️  Payer Source extracted: ''
[04:57:56] [DOC: 9321863] ℹ️  Diagnosis codes being written:
[04:57:56] [DOC: 9321863] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:57:56] [DOC: 9321863] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:57:56] [DOC: 9321863] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:57:56] [DOC: 9321863] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:57:56] [DOC: 9321863] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:57:56] [DOC: 9321863] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:57:56] [DOC: 9321863] ✅ Patient data written to CSV: Adriano Lima | Sex: MALE | Age: 68 | Service: Skilled Nursing | Payer:  | MRN: 2063794
[04:57:56] ✅    ✅ Document 9321863 processed and saved successfully
[04:57:56] 🔄 
🔄 Step 8: Saving API details...
[04:57:56] [DOC: 9321863] ℹ️  API push details saved for document 9321863
[04:57:56] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321854                         ║
================================================================================
[04:57:56] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:57:56] ℹ️  Date: 06/02/2025
[04:57:56] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:57:58] [DOC: 9321854] ✅ Text extracted using pdfplumber (909 chars)
[04:57:58] ✅    ✅ Text extracted using pdfplumber (909 chars)
[04:57:58] 🔄 
🔄 Step 2: Extracting patient data...
[04:58:01] ℹ️  AI extracted raw sex value: 'F'
[04:58:01] ℹ️  AI extracted service line: 'Medical Social Work'
[04:58:01] ℹ️  AI extracted payer source: ''
[04:58:01] ℹ️  AI extracted diagnoses:
[04:58:01] ℹ️    - Diagnosis 1: ''
[04:58:01] ℹ️    - Diagnosis 2: ''
[04:58:01] ℹ️    - Diagnosis 3: ''
[04:58:01] ℹ️    - Diagnosis 4: ''
[04:58:01] ℹ️    - Diagnosis 5: ''
[04:58:01] ℹ️    - Diagnosis 6: ''
[04:58:01] ℹ️  Final extracted MRN: '2608070'
[04:58:01] ℹ️  Final extracted Sex: 'FEMALE'
[04:58:01] ℹ️  Final extracted Service Line: 'Medical Social Work'
[04:58:01] ℹ️  Final extracted Payer Source: ''
[04:58:01] ✅ Patient data extraction completed successfully
[04:58:01] ✅    ✅ Patient data extracted successfully
[04:58:01] 📊 Patient Response
     └─ patientFName: Susan
     └─ patientLName: Kaput
     └─ dob: 07/28/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2608070
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '06/02/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:58:01] ✅    ✅ Patient identified: Susan Kaput
[04:58:01] ✅    ✅ Patient name validation passed
[04:58:01] 🔄 
🔄 Step 3: Processing patient dates...
[04:58:01] [DOC: 9321854] ℹ️  DOB normalized: 07/28/1944
[04:58:01] [DOC: 9321854] ℹ️  Episode startOfEpisode normalized: 06/02/2025
[04:58:01] [DOC: 9321854] ℹ️  Episode endOfEpisode normalized: 07/19/2025
[04:58:01] [DOC: 9321854] ✅ Patient date processing completed successfully
[04:58:01] ✅    ✅ Date processing completed
[04:58:01] 📊 Processed Patient Data
     └─ patientFName: Susan
     └─ patientLName: Kaput
     └─ dob: 07/28/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2608070
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '06/02/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:58:01] 🔄 
🔄 Step 4: Extracting order data...
[04:58:03] ℹ️  Order extraction - MRN: '2608070'
[04:58:03] ℹ️  Order extraction - Sex: 'FEMALE'
[04:58:03] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[04:58:03] ℹ️  Order extraction - Payer Source: ''
[04:58:03] ✅ Order data extraction completed successfully
[04:58:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:58:03] ℹ️  Using MRN from patient data: '2608070' over '2608070'
[04:58:03] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[04:58:03] ✅ Patient name cross-validation successful
[04:58:03] ✅    ✅ Data merged successfully
[04:58:04] ✅    ✅ Order data extracted and validated
[04:58:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:58:36] [DOC: 9321854] ✅ Patient exists in API: Susan Kaput, ID: 3d01d230-b778-4f66-a4d0-d4cf2af94013
[04:58:36] ✅    ✅ Existing patient found with ID: 3d01d230-b778-4f66-a4d0-d4cf2af94013
[04:58:36] 🔄 
🔄 Step 6: Pushing order to API...
[04:58:36] [DOC: 9321854] ℹ️  Pushing order via API for patient ID: 3d01d230-b778-4f66-a4d0-d4cf2af94013
[04:58:37] [DOC: 9321854] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18757"}
[04:58:37] ❌    ❌ Failed to push order
[04:58:37] 🔄 
🔄 Step 7: Writing to CSV...
[04:58:37] [DOC: 9321854] ℹ️  Calculated age: 80 from DOB: 07/28/1944
[04:58:37] [DOC: 9321854] ℹ️  Service Line extracted: 'Medical Social Work'
[04:58:37] [DOC: 9321854] ℹ️  Payer Source extracted: ''
[04:58:37] [DOC: 9321854] ℹ️  Diagnosis codes being written:
[04:58:37] [DOC: 9321854] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:58:37] [DOC: 9321854] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:58:37] [DOC: 9321854] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:58:37] [DOC: 9321854] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:58:37] [DOC: 9321854] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:58:37] [DOC: 9321854] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:58:37] [DOC: 9321854] ✅ Patient data written to CSV: Susan Kaput | Sex: FEMALE | Age: 80 | Service: Medical Social Work | Payer:  | MRN: 2608070
[04:58:37] ✅    ✅ Document 9321854 processed and saved successfully
[04:58:37] 🔄 
🔄 Step 8: Saving API details...
[04:58:37] [DOC: 9321854] ℹ️  API push details saved for document 9321854
[04:58:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321841                         ║
================================================================================
[04:58:37] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:58:37] ℹ️  Date: 06/02/2025
[04:58:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:58:39] [DOC: 9321841] ✅ Text extracted using pdfplumber (905 chars)
[04:58:39] ✅    ✅ Text extracted using pdfplumber (905 chars)
[04:58:39] 🔄 
🔄 Step 2: Extracting patient data...
[04:58:42] ℹ️  AI extracted raw sex value: 'F'
[04:58:42] ℹ️  AI extracted service line: 'Skilled Nursing'
[04:58:42] ℹ️  AI extracted payer source: ''
[04:58:42] ℹ️  AI extracted diagnoses:
[04:58:42] ℹ️    - Diagnosis 1: ''
[04:58:42] ℹ️    - Diagnosis 2: ''
[04:58:42] ℹ️    - Diagnosis 3: ''
[04:58:42] ℹ️    - Diagnosis 4: ''
[04:58:42] ℹ️    - Diagnosis 5: ''
[04:58:42] ℹ️    - Diagnosis 6: ''
[04:58:42] ℹ️  Final extracted MRN: '2461354'
[04:58:42] ℹ️  Final extracted Sex: 'FEMALE'
[04:58:42] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[04:58:42] ℹ️  Final extracted Payer Source: ''
[04:58:42] ✅ Patient data extraction completed successfully
[04:58:42] ✅    ✅ Patient data extracted successfully
[04:58:42] 📊 Patient Response
     └─ patientFName: Ronda
     └─ patientLName: Fermino
     └─ dob: 12/03/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2461354
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/29/2025', 'endOfEpisode': '07/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:58:42] ✅    ✅ Patient identified: Ronda Fermino
[04:58:42] ✅    ✅ Patient name validation passed
[04:58:42] 🔄 
🔄 Step 3: Processing patient dates...
[04:58:42] [DOC: 9321841] ℹ️  DOB normalized: 12/03/1964
[04:58:42] [DOC: 9321841] ℹ️  Episode startOfEpisode normalized: 05/29/2025
[04:58:42] [DOC: 9321841] ℹ️  Episode endOfEpisode normalized: 07/27/2025
[04:58:42] [DOC: 9321841] ✅ Patient date processing completed successfully
[04:58:42] ✅    ✅ Date processing completed
[04:58:42] 📊 Processed Patient Data
     └─ patientFName: Ronda
     └─ patientLName: Fermino
     └─ dob: 12/03/1964
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2461354
     └─ billingProvider: Gloriane Afonso-Fede, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/29/2025', 'endOfEpisode': '07/27/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:58:42] 🔄 
🔄 Step 4: Extracting order data...
[04:58:44] ℹ️  Order extraction - MRN: '2461354'
[04:58:44] ℹ️  Order extraction - Sex: 'FEMALE'
[04:58:44] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[04:58:44] ℹ️  Order extraction - Payer Source: ''
[04:58:44] ✅ Order data extraction completed successfully
[04:58:44] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:58:44] ℹ️  Using MRN from patient data: '2461354' over '2461354'
[04:58:44] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[04:58:44] ✅ Patient name cross-validation successful
[04:58:44] ✅    ✅ Data merged successfully
[04:58:45] ✅    ✅ Order data extracted and validated
[04:58:45] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:59:11] [DOC: 9321841] ✅ Patient exists in API: Ronda Fermino, ID: 1a55c1f0-f0a3-4ba0-9b08-bb594df025ca
[04:59:11] ✅    ✅ Existing patient found with ID: 1a55c1f0-f0a3-4ba0-9b08-bb594df025ca
[04:59:11] 🔄 
🔄 Step 6: Pushing order to API...
[04:59:11] [DOC: 9321841] ℹ️  Pushing order via API for patient ID: 1a55c1f0-f0a3-4ba0-9b08-bb594df025ca
[04:59:13] [DOC: 9321841] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18758"}
[04:59:13] ❌    ❌ Failed to push order
[04:59:13] 🔄 
🔄 Step 7: Writing to CSV...
[04:59:13] [DOC: 9321841] ℹ️  Calculated age: 60 from DOB: 12/03/1964
[04:59:13] [DOC: 9321841] ℹ️  Service Line extracted: 'Skilled Nursing'
[04:59:13] [DOC: 9321841] ℹ️  Payer Source extracted: ''
[04:59:13] [DOC: 9321841] ℹ️  Diagnosis codes being written:
[04:59:13] [DOC: 9321841] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:59:13] [DOC: 9321841] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:59:13] [DOC: 9321841] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:59:13] [DOC: 9321841] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:59:13] [DOC: 9321841] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:59:13] [DOC: 9321841] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:59:13] [DOC: 9321841] ✅ Patient data written to CSV: Ronda Fermino | Sex: FEMALE | Age: 60 | Service: Skilled Nursing | Payer:  | MRN: 2461354
[04:59:13] ✅    ✅ Document 9321841 processed and saved successfully
[04:59:13] 🔄 
🔄 Step 8: Saving API details...
[04:59:13] [DOC: 9321841] ℹ️  API push details saved for document 9321841
[04:59:13] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321832                         ║
================================================================================
[04:59:13] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:59:13] ℹ️  Date: 06/02/2025
[04:59:13] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:59:15] [DOC: 9321832] ✅ Text extracted using pdfplumber (2042 chars)
[04:59:15] ✅    ✅ Text extracted using pdfplumber (2042 chars)
[04:59:15] 🔄 
🔄 Step 2: Extracting patient data...
[04:59:18] ℹ️  AI extracted raw sex value: 'F'
[04:59:18] ℹ️  AI extracted service line: 'RN'
[04:59:18] ℹ️  AI extracted payer source: ''
[04:59:18] ℹ️  AI extracted diagnoses:
[04:59:18] ℹ️    - Diagnosis 1: ''
[04:59:18] ℹ️    - Diagnosis 2: ''
[04:59:18] ℹ️    - Diagnosis 3: ''
[04:59:18] ℹ️    - Diagnosis 4: ''
[04:59:18] ℹ️    - Diagnosis 5: ''
[04:59:18] ℹ️    - Diagnosis 6: ''
[04:59:18] ℹ️  Final extracted MRN: '2158031'
[04:59:18] ℹ️  Final extracted Sex: 'FEMALE'
[04:59:18] ℹ️  Final extracted Service Line: 'RN'
[04:59:18] ℹ️  Final extracted Payer Source: ''
[04:59:18] ✅ Patient data extraction completed successfully
[04:59:18] ✅    ✅ Patient data extracted successfully
[04:59:18] 📊 Patient Response
     └─ patientFName: Norma
     └─ patientLName: Dyer
     └─ dob: 11/13/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2158031
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:59:18] ✅    ✅ Patient identified: Norma Dyer
[04:59:18] ✅    ✅ Patient name validation passed
[04:59:18] 🔄 
🔄 Step 3: Processing patient dates...
[04:59:18] [DOC: 9321832] ℹ️  DOB normalized: 11/13/1931
[04:59:18] [DOC: 9321832] ✅ Patient date processing completed successfully
[04:59:18] ✅    ✅ Date processing completed
[04:59:18] 📊 Processed Patient Data
     └─ patientFName: Norma
     └─ patientLName: Dyer
     └─ dob: 11/13/1931
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2158031
     └─ billingProvider: Christine A. Will, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: RN
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:59:18] 🔄 
🔄 Step 4: Extracting order data...
[04:59:20] ℹ️  Order extraction - MRN: '2158031'
[04:59:20] ℹ️  Order extraction - Sex: 'FEMALE'
[04:59:20] ℹ️  Order extraction - Service Line: ''
[04:59:20] ℹ️  Order extraction - Payer Source: ''
[04:59:20] ✅ Order data extraction completed successfully
[04:59:20] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:59:20] ℹ️  Using MRN from patient data: '2158031' over '2158031'
[04:59:20] ℹ️  Using service line from patient data: 'RN'
[04:59:20] ✅ Patient name cross-validation successful
[04:59:20] ✅    ✅ Data merged successfully
[04:59:21] ⚠️     ❌ Skipping - missing episode start date
[04:59:21] [DOC: 9321832] ℹ️  API push details saved for document 9321832
================================================================================
║                        Processing Document ID: 9321829                         ║
================================================================================
[04:59:21] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:59:21] ℹ️  Date: 06/02/2025
[04:59:21] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:59:25] [DOC: 9321829] ✅ Text extracted using pdfplumber (2163 chars)
[04:59:25] ✅    ✅ Text extracted using pdfplumber (2163 chars)
[04:59:25] 🔄 
🔄 Step 2: Extracting patient data...
[04:59:27] ℹ️  AI extracted raw sex value: 'F'
[04:59:27] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[04:59:27] ℹ️  AI extracted payer source: ''
[04:59:27] ℹ️  AI extracted diagnoses:
[04:59:27] ℹ️    - Diagnosis 1: 'None'
[04:59:27] ℹ️    - Diagnosis 2: 'None'
[04:59:27] ℹ️    - Diagnosis 3: 'None'
[04:59:27] ℹ️    - Diagnosis 4: 'None'
[04:59:27] ℹ️    - Diagnosis 5: 'None'
[04:59:27] ℹ️    - Diagnosis 6: 'None'
[04:59:27] ℹ️  Final extracted MRN: '2320533'
[04:59:27] ℹ️  Final extracted Sex: 'FEMALE'
[04:59:27] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[04:59:27] ℹ️  Final extracted Payer Source: ''
[04:59:27] ✅ Patient data extraction completed successfully
[04:59:27] ✅    ✅ Patient data extracted successfully
[04:59:27] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Chace
     └─ dob: 10/02/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2320533
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[04:59:27] ✅    ✅ Patient identified: Nancy Chace
[04:59:27] ✅    ✅ Patient name validation passed
[04:59:27] 🔄 
🔄 Step 3: Processing patient dates...
[04:59:27] [DOC: 9321829] ℹ️  DOB normalized: 10/02/1930
[04:59:27] [DOC: 9321829] ✅ Patient date processing completed successfully
[04:59:27] ✅    ✅ Date processing completed
[04:59:27] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Chace
     └─ dob: 10/02/1930
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2320533
     └─ billingProvider: Aileen C Souza, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': ''}]
[04:59:27] 🔄 
🔄 Step 4: Extracting order data...
[04:59:30] ℹ️  Order extraction - MRN: '2320533'
[04:59:30] ℹ️  Order extraction - Sex: 'FEMALE'
[04:59:30] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[04:59:30] ℹ️  Order extraction - Payer Source: ''
[04:59:30] ✅ Order data extraction completed successfully
[04:59:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:59:30] ℹ️  Using MRN from patient data: '2320533' over '2320533'
[04:59:30] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[04:59:30] ✅ Patient name cross-validation successful
[04:59:30] ✅    ✅ Data merged successfully
[04:59:31] ✅    ✅ Order data extracted and validated
[04:59:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:59:36] [DOC: 9321829] ✅ Patient exists in API: Nancy Chace, ID: 3c5e29d2-3fb8-411b-9d3e-6c0716466cbb
[04:59:36] ✅    ✅ Existing patient found with ID: 3c5e29d2-3fb8-411b-9d3e-6c0716466cbb
[04:59:36] 🔄 
🔄 Step 6: Pushing order to API...
[04:59:36] [DOC: 9321829] ℹ️  Pushing order via API for patient ID: 3c5e29d2-3fb8-411b-9d3e-6c0716466cbb
[04:59:38] [DOC: 9321829] ❌ Order push failed with status 201: {"id":"1daf6585-6807-4cb7-982b-d5c5d7722318","orderWAVId":"ORD19933","orderNo":"1096816, 1096817","orderDate":"05/29/2025","startOfCare":"04/29/2025","episodeStartDate":"04/29/2025","episodeEndDate":"06/27/2025","documentID":"9321829","mrn":"2320533","patientName":"Chace,Nancy","sentToPhysicianDate":"06/02/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"06/03/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"3c5e29d2-3fb8-411b-9d3e-6c0716466cbb","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[04:59:38] ❌    ❌ Failed to push order
[04:59:38] 🔄 
🔄 Step 7: Writing to CSV...
[04:59:38] [DOC: 9321829] ℹ️  Calculated age: 94 from DOB: 10/02/1930
[04:59:38] [DOC: 9321829] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[04:59:38] [DOC: 9321829] ℹ️  Payer Source extracted: ''
[04:59:38] [DOC: 9321829] ℹ️  Diagnosis codes being written:
[04:59:38] [DOC: 9321829] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:59:38] [DOC: 9321829] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:59:38] [DOC: 9321829] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:59:38] [DOC: 9321829] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:59:38] [DOC: 9321829] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:59:38] [DOC: 9321829] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:59:38] [DOC: 9321829] ✅ Patient data written to CSV: Nancy Chace | Sex: FEMALE | Age: 94 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 2320533
[04:59:38] ✅    ✅ Document 9321829 processed and saved successfully
[04:59:38] 🔄 
🔄 Step 8: Saving API details...
[04:59:38] [DOC: 9321829] ℹ️  API push details saved for document 9321829
[04:59:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321828                         ║
================================================================================
[04:59:38] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:59:38] ℹ️  Date: 06/02/2025
[04:59:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:59:40] [DOC: 9321828] ✅ Text extracted using pdfplumber (3805 chars)
[04:59:40] ✅    ✅ Text extracted using pdfplumber (3805 chars)
[04:59:40] 🔄 
🔄 Step 2: Extracting patient data...
[04:59:43] ℹ️  AI extracted raw sex value: 'M'
[04:59:43] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy'
[04:59:43] ℹ️  AI extracted payer source: ''
[04:59:43] ℹ️  AI extracted diagnoses:
[04:59:43] ℹ️    - Diagnosis 1: ''
[04:59:43] ℹ️    - Diagnosis 2: ''
[04:59:43] ℹ️    - Diagnosis 3: ''
[04:59:43] ℹ️    - Diagnosis 4: ''
[04:59:43] ℹ️    - Diagnosis 5: ''
[04:59:43] ℹ️    - Diagnosis 6: ''
[04:59:43] ℹ️  Final extracted MRN: '3451044'
[04:59:43] ℹ️  Final extracted Sex: 'MALE'
[04:59:43] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy'
[04:59:43] ℹ️  Final extracted Payer Source: ''
[04:59:43] ✅ Patient data extraction completed successfully
[04:59:43] ✅    ✅ Patient data extracted successfully
[04:59:43] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Breese
     └─ dob: 10/30/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 3451044
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:59:43] ✅    ✅ Patient identified: David Breese
[04:59:43] ✅    ✅ Patient name validation passed
[04:59:43] 🔄 
🔄 Step 3: Processing patient dates...
[04:59:43] [DOC: 9321828] ℹ️  DOB normalized: 10/30/1947
[04:59:43] [DOC: 9321828] ℹ️  Episode startOfCare normalized: 05/07/2025
[04:59:43] [DOC: 9321828] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[04:59:43] [DOC: 9321828] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[04:59:43] [DOC: 9321828] ✅ Patient date processing completed successfully
[04:59:43] ✅    ✅ Date processing completed
[04:59:43] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Breese
     └─ dob: 10/30/1947
     └─ patientSex: MALE
     └─ medicalRecordNo: 3451044
     └─ billingProvider: Karine Maalouf-Kaleshian, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Skilled Nursing, Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/07/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:59:43] 🔄 
🔄 Step 4: Extracting order data...
[04:59:46] ℹ️  Order extraction - MRN: '3451044'
[04:59:46] ℹ️  Order extraction - Sex: 'MALE'
[04:59:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[04:59:46] ℹ️  Order extraction - Payer Source: ''
[04:59:46] ✅ Order data extraction completed successfully
[04:59:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[04:59:46] ℹ️  Using MRN from patient data: '3451044' over '3451044'
[04:59:46] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy'
[04:59:46] ✅ Patient name cross-validation successful
[04:59:46] ✅    ✅ Data merged successfully
[04:59:47] ✅    ✅ Order data extracted and validated
[04:59:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[04:59:51] [DOC: 9321828] ✅ Patient exists in API: David Breese, ID: 49bdf5d7-829c-4215-90b5-9ddd891dce52
[04:59:51] ✅    ✅ Existing patient found with ID: 49bdf5d7-829c-4215-90b5-9ddd891dce52
[04:59:51] 🔄 
🔄 Step 6: Pushing order to API...
[04:59:51] [DOC: 9321828] ℹ️  Pushing order via API for patient ID: 49bdf5d7-829c-4215-90b5-9ddd891dce52
[04:59:53] [DOC: 9321828] ❌ Order push failed with status 201: {"id":"2b2477da-d3e5-4149-88b0-d9b9d94f5949","orderWAVId":"ORD19934","orderNo":"1097381, 1097647, 1097648, 1097380","orderDate":"05/31/2025","startOfCare":"05/07/2025","episodeStartDate":"05/07/2025","episodeEndDate":"07/05/2025","documentID":"9321828","mrn":"3451044","patientName":"Breese,David","sentToPhysicianDate":"06/02/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"06/03/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"Orders","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"49bdf5d7-829c-4215-90b5-9ddd891dce52","companyId":"370583e3-01c8-477e-8b6d-d3537a10c767","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[04:59:53] ❌    ❌ Failed to push order
[04:59:53] 🔄 
🔄 Step 7: Writing to CSV...
[04:59:53] [DOC: 9321828] ℹ️  Calculated age: 77 from DOB: 10/30/1947
[04:59:53] [DOC: 9321828] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy'
[04:59:53] [DOC: 9321828] ℹ️  Payer Source extracted: ''
[04:59:53] [DOC: 9321828] ℹ️  Diagnosis codes being written:
[04:59:53] [DOC: 9321828] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[04:59:53] [DOC: 9321828] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[04:59:53] [DOC: 9321828] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[04:59:53] [DOC: 9321828] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[04:59:53] [DOC: 9321828] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[04:59:53] [DOC: 9321828] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[04:59:53] [DOC: 9321828] ✅ Patient data written to CSV: David Breese | Sex: MALE | Age: 77 | Service: Skilled Nursing, Physical Therapy | Payer:  | MRN: 3451044
[04:59:53] ✅    ✅ Document 9321828 processed and saved successfully
[04:59:53] 🔄 
🔄 Step 8: Saving API details...
[04:59:53] [DOC: 9321828] ℹ️  API push details saved for document 9321828
[04:59:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321826                         ║
================================================================================
[04:59:53] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[04:59:53] ℹ️  Date: 06/02/2025
[04:59:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[04:59:54] [DOC: 9321826] ✅ Text extracted using pdfplumber (959 chars)
[04:59:54] ✅    ✅ Text extracted using pdfplumber (959 chars)
[04:59:54] 🔄 
🔄 Step 2: Extracting patient data...
[04:59:57] ℹ️  AI extracted raw sex value: 'F'
[04:59:57] ℹ️  AI extracted service line: 'Medical Social Work'
[04:59:57] ℹ️  AI extracted payer source: ''
[04:59:57] ℹ️  AI extracted diagnoses:
[04:59:57] ℹ️    - Diagnosis 1: ''
[04:59:57] ℹ️    - Diagnosis 2: ''
[04:59:57] ℹ️    - Diagnosis 3: ''
[04:59:57] ℹ️    - Diagnosis 4: ''
[04:59:57] ℹ️    - Diagnosis 5: ''
[04:59:57] ℹ️    - Diagnosis 6: ''
[04:59:57] ℹ️  Final extracted MRN: '2208958'
[04:59:57] ℹ️  Final extracted Sex: 'FEMALE'
[04:59:57] ℹ️  Final extracted Service Line: 'Medical Social Work'
[04:59:57] ℹ️  Final extracted Payer Source: ''
[04:59:57] ✅ Patient data extraction completed successfully
[04:59:57] ✅    ✅ Patient data extracted successfully
[04:59:57] 📊 Patient Response
     └─ patientFName: Carol
     └─ patientLName: Baden
     └─ dob: 07/19/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2208958
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/29/2025', 'endOfEpisode': '08/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:59:57] ✅    ✅ Patient identified: Carol Baden
[04:59:57] ✅    ✅ Patient name validation passed
[04:59:57] 🔄 
🔄 Step 3: Processing patient dates...
[04:59:57] [DOC: 9321826] ℹ️  DOB normalized: 07/19/1940
[04:59:57] [DOC: 9321826] ℹ️  Episode startOfEpisode normalized: 05/29/2025
[04:59:57] [DOC: 9321826] ℹ️  Episode endOfEpisode normalized: 08/25/2025
[04:59:57] [DOC: 9321826] ✅ Patient date processing completed successfully
[04:59:57] ✅    ✅ Date processing completed
[04:59:57] 📊 Processed Patient Data
     └─ patientFName: Carol
     └─ patientLName: Baden
     └─ dob: 07/19/1940
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 2208958
     └─ billingProvider: Jordan C. Gularek, DO
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: (508) 973-3200
     └─ serviceLine: Medical Social Work
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/29/2025', 'endOfEpisode': '08/25/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:59:57] 🔄 
🔄 Step 4: Extracting order data...
[05:00:00] ℹ️  Order extraction - MRN: '2208958'
[05:00:00] ℹ️  Order extraction - Sex: 'FEMALE'
[05:00:00] ℹ️  Order extraction - Service Line: 'Medical Social Work'
[05:00:00] ℹ️  Order extraction - Payer Source: ''
[05:00:00] ✅ Order data extraction completed successfully
[05:00:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:00:00] ℹ️  Using MRN from patient data: '2208958' over '2208958'
[05:00:00] ℹ️  Service line consistent in both sources: 'Medical Social Work'
[05:00:00] ✅ Patient name cross-validation successful
[05:00:00] ✅    ✅ Data merged successfully
[05:00:01] ✅    ✅ Order data extracted and validated
[05:00:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:00:01] [DOC: 9321826] ✅ Patient found in local cache: Carol Baden, ID: b21bad59-ac67-44df-a4c9-722195632f90
[05:00:01] ✅    ✅ Existing patient found with ID: b21bad59-ac67-44df-a4c9-722195632f90
[05:00:01] 🔄 
🔄 Step 6: Pushing order to API...
[05:00:01] [DOC: 9321826] ℹ️  Pushing order via API for patient ID: b21bad59-ac67-44df-a4c9-722195632f90
[05:00:02] [DOC: 9321826] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18762"}
[05:00:02] ❌    ❌ Failed to push order
[05:00:02] 🔄 
🔄 Step 7: Writing to CSV...
[05:00:02] [DOC: 9321826] ℹ️  Calculated age: 84 from DOB: 07/19/1940
[05:00:02] [DOC: 9321826] ℹ️  Service Line extracted: 'Medical Social Work'
[05:00:02] [DOC: 9321826] ℹ️  Payer Source extracted: ''
[05:00:02] [DOC: 9321826] ℹ️  Diagnosis codes being written:
[05:00:02] [DOC: 9321826] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:00:02] [DOC: 9321826] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:00:02] [DOC: 9321826] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:00:02] [DOC: 9321826] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:00:02] [DOC: 9321826] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:00:02] [DOC: 9321826] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:00:02] [DOC: 9321826] ✅ Patient data written to CSV: Carol Baden | Sex: FEMALE | Age: 84 | Service: Medical Social Work | Payer:  | MRN: 2208958
[05:00:02] ✅    ✅ Document 9321826 processed and saved successfully
[05:00:02] 🔄 
🔄 Step 8: Saving API details...
[05:00:02] [DOC: 9321826] ℹ️  API push details saved for document 9321826
[05:00:02] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321772                         ║
================================================================================
[05:00:02] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:00:02] ℹ️  Date: 06/02/2025
[05:00:02] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:00:05] [DOC: 9321772] ✅ Text extracted using pdfplumber (1522 chars)
[05:00:05] ✅    ✅ Text extracted using pdfplumber (1510 chars)
[05:00:05] 🔄 
🔄 Step 2: Extracting patient data...
[05:00:07] ℹ️  AI extracted raw sex value: ''
[05:00:07] ℹ️  AI extracted service line: 'Occupational Therapy'
[05:00:07] ℹ️  AI extracted payer source: ''
[05:00:07] ℹ️  AI extracted diagnoses:
[05:00:07] ℹ️    - Diagnosis 1: 'S22.41X'
[05:00:07] ℹ️    - Diagnosis 2: 'E11.9'
[05:00:07] ℹ️    - Diagnosis 3: 'E78.5'
[05:00:07] ℹ️    - Diagnosis 4: ''
[05:00:07] ℹ️    - Diagnosis 5: ''
[05:00:07] ℹ️    - Diagnosis 6: ''
[05:00:07] ℹ️  Final extracted MRN: 'MA250505104501'
[05:00:07] ℹ️  Final extracted Sex: ''
[05:00:07] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[05:00:07] ℹ️  Final extracted Payer Source: ''
[05:00:07] ✅ Patient data extraction completed successfully
[05:00:07] ✅    ✅ Patient data extracted successfully
[05:00:07] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Reis
     └─ dob: 10/20/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA250505104501
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'S22.41X', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:00:07] ✅    ✅ Patient identified: Joseph Reis
[05:00:07] ✅    ✅ Patient name validation passed
[05:00:07] 🔄 
🔄 Step 3: Processing patient dates...
[05:00:07] [DOC: 9321772] ℹ️  DOB normalized: 10/20/1945
[05:00:07] [DOC: 9321772] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[05:00:07] [DOC: 9321772] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[05:00:07] [DOC: 9321772] ✅ Patient date processing completed successfully
[05:00:07] ✅    ✅ Date processing completed
[05:00:07] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Reis
     └─ dob: 10/20/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA250505104501
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'S22.41X', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:00:07] 🔄 
🔄 Step 4: Extracting order data...
[05:00:10] ℹ️  Order extraction - MRN: 'MA250505104501'
[05:00:10] ℹ️  Order extraction - Sex: ''
[05:00:10] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[05:00:10] ℹ️  Order extraction - Payer Source: ''
[05:00:10] ✅ Order data extraction completed successfully
[05:00:10] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:00:10] ℹ️  Using MRN from patient data: 'MA250505104501' over 'MA250505104501'
[05:00:10] ℹ️  Inferred sex as MALE from name: Joseph
[05:00:10] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[05:00:10] ✅ Patient name cross-validation successful
[05:00:10] ✅    ✅ Data merged successfully
[05:00:11] ✅    ✅ Order data extracted and validated
[05:00:11] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:00:20] [DOC: 9321772] ✅ Patient exists in API: Joseph Reis, ID: e8699d92-17c4-4d61-be51-0cf73c400d5c
[05:00:20] ✅    ✅ Existing patient found with ID: e8699d92-17c4-4d61-be51-0cf73c400d5c
[05:00:20] 🔄 
🔄 Step 6: Pushing order to API...
[05:00:20] [DOC: 9321772] ℹ️  Pushing order via API for patient ID: e8699d92-17c4-4d61-be51-0cf73c400d5c
[05:00:22] [DOC: 9321772] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18763"}
[05:00:22] ❌    ❌ Failed to push order
[05:00:22] 🔄 
🔄 Step 7: Writing to CSV...
[05:00:22] [DOC: 9321772] ℹ️  Calculated age: 79 from DOB: 10/20/1945
[05:00:22] [DOC: 9321772] ℹ️  Service Line extracted: 'Occupational Therapy'
[05:00:22] [DOC: 9321772] ℹ️  Payer Source extracted: ''
[05:00:22] [DOC: 9321772] ℹ️  Diagnosis codes being written:
[05:00:22] [DOC: 9321772] ℹ️    - Latest_Episode_Firstdiagnosis: 'S22.41X'
[05:00:22] [DOC: 9321772] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[05:00:22] [DOC: 9321772] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[05:00:22] [DOC: 9321772] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:00:22] [DOC: 9321772] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:00:22] [DOC: 9321772] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:00:22] [DOC: 9321772] ✅ Patient data written to CSV: Joseph Reis | Sex: MALE | Age: 79 | Service: Occupational Therapy | Payer:  | MRN: MA250505104501
[05:00:22] ✅    ✅ Document 9321772 processed and saved successfully
[05:00:22] 🔄 
🔄 Step 8: Saving API details...
[05:00:22] [DOC: 9321772] ℹ️  API push details saved for document 9321772
[05:00:22] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321771                         ║
================================================================================
[05:00:22] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:00:22] ℹ️  Date: 06/02/2025
[05:00:22] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:00:25] [DOC: 9321771] ✅ Text extracted using pdfplumber (1639 chars)
[05:00:25] ✅    ✅ Text extracted using pdfplumber (1627 chars)
[05:00:25] 🔄 
🔄 Step 2: Extracting patient data...
[05:00:28] ℹ️  AI extracted raw sex value: ''
[05:00:28] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:00:28] ℹ️  AI extracted payer source: ''
[05:00:28] ℹ️  AI extracted diagnoses:
[05:00:28] ℹ️    - Diagnosis 1: 'S22.41X'
[05:00:28] ℹ️    - Diagnosis 2: 'E11.9'
[05:00:28] ℹ️    - Diagnosis 3: 'E78.5'
[05:00:28] ℹ️    - Diagnosis 4: 'None'
[05:00:28] ℹ️    - Diagnosis 5: 'None'
[05:00:28] ℹ️    - Diagnosis 6: 'None'
[05:00:28] ℹ️  Final extracted MRN: 'MA250505104501'
[05:00:28] ℹ️  Final extracted Sex: ''
[05:00:28] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:00:28] ℹ️  Final extracted Payer Source: ''
[05:00:28] ✅ Patient data extraction completed successfully
[05:00:28] ✅    ✅ Patient data extracted successfully
[05:00:28] 📊 Patient Response
     └─ patientFName: Joseph
     └─ patientLName: Reis
     └─ dob: 10/20/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA250505104501
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'S22.41X', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E78.5', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:00:28] ✅    ✅ Patient identified: Joseph Reis
[05:00:28] ✅    ✅ Patient name validation passed
[05:00:28] 🔄 
🔄 Step 3: Processing patient dates...
[05:00:28] [DOC: 9321771] ℹ️  DOB normalized: 10/20/1945
[05:00:28] [DOC: 9321771] ℹ️  Episode startOfEpisode normalized: 05/06/2025
[05:00:28] [DOC: 9321771] ℹ️  Episode endOfEpisode normalized: 07/04/2025
[05:00:28] [DOC: 9321771] ✅ Patient date processing completed successfully
[05:00:28] ✅    ✅ Date processing completed
[05:00:28] 📊 Processed Patient Data
     └─ patientFName: Joseph
     └─ patientLName: Reis
     └─ dob: 10/20/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA250505104501
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/06/2025', 'endOfEpisode': '07/04/2025', 'firstDiagnosis': 'S22.41X', 'secondDiagnosis': 'E11.9', 'thirdDiagnosis': 'E78.5'}]
[05:00:28] 🔄 
🔄 Step 4: Extracting order data...
[05:00:30] ℹ️  Order extraction - MRN: 'MA250505104501'
[05:00:30] ℹ️  Order extraction - Sex: ''
[05:00:30] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:00:30] ℹ️  Order extraction - Payer Source: ''
[05:00:30] ✅ Order data extraction completed successfully
[05:00:30] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:00:30] ℹ️  Using MRN from patient data: 'MA250505104501' over 'MA250505104501'
[05:00:30] ℹ️  Inferred sex as MALE from name: Joseph
[05:00:30] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:00:30] ✅ Patient name cross-validation successful
[05:00:30] ✅    ✅ Data merged successfully
[05:00:31] ✅    ✅ Order data extracted and validated
[05:00:31] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:00:31] [DOC: 9321771] ✅ Patient found in local cache: Joseph Reis, ID: e8699d92-17c4-4d61-be51-0cf73c400d5c
[05:00:31] ✅    ✅ Existing patient found with ID: e8699d92-17c4-4d61-be51-0cf73c400d5c
[05:00:31] 🔄 
🔄 Step 6: Pushing order to API...
[05:00:31] [DOC: 9321771] ℹ️  Pushing order via API for patient ID: e8699d92-17c4-4d61-be51-0cf73c400d5c
[05:00:33] [DOC: 9321771] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18764"}
[05:00:33] ❌    ❌ Failed to push order
[05:00:33] 🔄 
🔄 Step 7: Writing to CSV...
[05:00:33] [DOC: 9321771] ℹ️  Calculated age: 79 from DOB: 10/20/1945
[05:00:33] [DOC: 9321771] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:00:33] [DOC: 9321771] ℹ️  Payer Source extracted: ''
[05:00:33] [DOC: 9321771] ℹ️  Diagnosis codes being written:
[05:00:33] [DOC: 9321771] ℹ️    - Latest_Episode_Firstdiagnosis: 'S22.41X'
[05:00:33] [DOC: 9321771] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.9'
[05:00:33] [DOC: 9321771] ℹ️    - Latest_Episode_Thirddiagnosis: 'E78.5'
[05:00:33] [DOC: 9321771] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:00:33] [DOC: 9321771] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:00:33] [DOC: 9321771] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:00:33] [DOC: 9321771] ✅ Patient data written to CSV: Joseph Reis | Sex: MALE | Age: 79 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer:  | MRN: MA250505104501
[05:00:33] ✅    ✅ Document 9321771 processed and saved successfully
[05:00:33] 🔄 
🔄 Step 8: Saving API details...
[05:00:33] [DOC: 9321771] ℹ️  API push details saved for document 9321771
[05:00:33] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321543                         ║
================================================================================
[05:00:33] ℹ️  Agency: Dartmouth HH
[05:00:33] ℹ️  Date: 06/02/2025
[05:00:33] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:00:36] [DOC: 9321543] ✅ Text extracted using pdfplumber (19318 chars)
[05:00:36] ✅    ✅ Text extracted using pdfplumber (19306 chars)
[05:00:36] 🔄 
🔄 Step 2: Extracting patient data...
[05:00:39] ℹ️  AI extracted raw sex value: 'F'
[05:00:39] ℹ️  AI extracted service line: 'Skilled Nursing, PT, OT'
[05:00:39] ℹ️  AI extracted payer source: ''
[05:00:39] ℹ️  AI extracted diagnoses:
[05:00:39] ℹ️    - Diagnosis 1: 'N30.01'
[05:00:39] ℹ️    - Diagnosis 2: 'B95.2'
[05:00:39] ℹ️    - Diagnosis 3: 'S00.03XD'
[05:00:39] ℹ️    - Diagnosis 4: 'I65.23'
[05:00:39] ℹ️    - Diagnosis 5: 'F03.94'
[05:00:39] ℹ️    - Diagnosis 6: 'F03.93'
[05:00:39] ℹ️  Final extracted MRN: '549011'
[05:00:39] ℹ️  Final extracted Sex: 'FEMALE'
[05:00:39] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT, OT'
[05:00:39] ℹ️  Final extracted Payer Source: ''
[05:00:39] ✅ Patient data extraction completed successfully
[05:00:39] ✅    ✅ Patient data extracted successfully
[05:00:39] 📊 Patient Response
     └─ patientFName: Mary E
     └─ patientLName: Magee
     └─ dob: 04/02/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 549011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2025', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': 'N30.01', 'secondDiagnosis': 'B95.2', 'thirdDiagnosis': 'S00.03XD', 'fourthDiagnosis': 'I65.23', 'fifthDiagnosis': 'F03.94', 'sixthDiagnosis': 'F03.93'}]
[05:00:39] ✅    ✅ Patient identified: Mary E Magee
[05:00:39] ✅    ✅ Patient name validation passed
[05:00:39] 🔄 
🔄 Step 3: Processing patient dates...
[05:00:39] [DOC: 9321543] ℹ️  DOB normalized: 04/02/1933
[05:00:39] [DOC: 9321543] ℹ️  Episode startOfCare normalized: 05/21/2025
[05:00:39] [DOC: 9321543] ℹ️  Episode startOfEpisode normalized: 05/21/2025
[05:00:39] [DOC: 9321543] ℹ️  Episode endOfEpisode normalized: 07/19/2025
[05:00:39] [DOC: 9321543] ✅ Patient date processing completed successfully
[05:00:39] ✅    ✅ Date processing completed
[05:00:39] 📊 Processed Patient Data
     └─ patientFName: Mary E
     └─ patientLName: Magee
     └─ dob: 04/02/1933
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 549011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT, OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/21/2025', 'startOfEpisode': '05/21/2025', 'endOfEpisode': '07/19/2025', 'firstDiagnosis': 'N30.01', 'secondDiagnosis': 'B95.2', 'thirdDiagnosis': 'S00.03XD', 'fourthDiagnosis': 'I65.23', 'fifthDiagnosis': 'F03.94', 'sixthDiagnosis': 'F03.93'}]
[05:00:39] 🔄 
🔄 Step 4: Extracting order data...
[05:00:42] ℹ️  Order extraction - MRN: '549011'
[05:00:42] ℹ️  Order extraction - Sex: 'FEMALE'
[05:00:42] ℹ️  Order extraction - Service Line: 'Skilled Nursing, PT, OT'
[05:00:42] ℹ️  Order extraction - Payer Source: ''
[05:00:42] ✅ Order data extraction completed successfully
[05:00:42] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:00:42] ℹ️  Using MRN from patient data: '549011' over '549011'
[05:00:42] ℹ️  Service line consistent in both sources: 'Skilled Nursing, PT, OT'
[05:00:42] ✅ Patient name cross-validation successful
[05:00:42] ✅    ✅ Data merged successfully
[05:00:43] ✅    ✅ Order data extracted and validated
[05:00:43] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:00:50] [DOC: 9321543] ℹ️  Patient not found in cache or API: Mary E Magee
[05:00:50] [DOC: 9321543] ℹ️  Patient not found, creating new patient via API...
[05:00:50] [DOC: 9321543] ℹ️  Creating patient via API: Mary E Magee
[05:00:51] [DOC: 9321543] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:00:51] ❌    ❌ Failed to create patient
[05:00:51] [DOC: 9321543] ℹ️  API push details saved for document 9321543
================================================================================
║                        Processing Document ID: 9321541                         ║
================================================================================
[05:00:51] ℹ️  Agency: Dartmouth HH
[05:00:51] ℹ️  Date: 06/02/2025
[05:00:51] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:00:54] [DOC: 9321541] ✅ Text extracted using pdfplumber (11907 chars)
[05:00:54] ✅    ✅ Text extracted using pdfplumber (11907 chars)
[05:00:54] 🔄 
🔄 Step 2: Extracting patient data...
[05:00:57] ℹ️  AI extracted raw sex value: 'F'
[05:00:57] ℹ️  AI extracted service line: 'PT'
[05:00:57] ℹ️  AI extracted payer source: ''
[05:00:57] ℹ️  AI extracted diagnoses:
[05:00:57] ℹ️    - Diagnosis 1: 'Z47.1'
[05:00:57] ℹ️    - Diagnosis 2: 'M19.90'
[05:00:57] ℹ️    - Diagnosis 3: 'E66.811'
[05:00:57] ℹ️    - Diagnosis 4: 'E13.29'
[05:00:57] ℹ️    - Diagnosis 5: 'R80.9'
[05:00:57] ℹ️    - Diagnosis 6: 'F41.9'
[05:00:57] ℹ️  Final extracted MRN: '3946015'
[05:00:57] ℹ️  Final extracted Sex: 'FEMALE'
[05:00:57] ℹ️  Final extracted Service Line: 'PT'
[05:00:57] ℹ️  Final extracted Payer Source: ''
[05:00:57] ✅ Patient data extraction completed successfully
[05:00:57] ✅    ✅ Patient data extracted successfully
[05:00:57] 📊 Patient Response
     └─ patientFName: Nancy
     └─ patientLName: Mak
     └─ dob: 01/31/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3946015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/29/2025', 'startOfEpisode': '05/29/2025', 'endOfEpisode': '07/27/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M19.90', 'thirdDiagnosis': 'E66.811', 'fourthDiagnosis': 'E13.29', 'fifthDiagnosis': 'R80.9', 'sixthDiagnosis': 'F41.9'}]
[05:00:57] ✅    ✅ Patient identified: Nancy Mak
[05:00:57] ✅    ✅ Patient name validation passed
[05:00:57] 🔄 
🔄 Step 3: Processing patient dates...
[05:00:57] [DOC: 9321541] ℹ️  DOB normalized: 01/31/1955
[05:00:57] [DOC: 9321541] ℹ️  Episode startOfCare normalized: 05/29/2025
[05:00:57] [DOC: 9321541] ℹ️  Episode startOfEpisode normalized: 05/29/2025
[05:00:57] [DOC: 9321541] ℹ️  Episode endOfEpisode normalized: 07/27/2025
[05:00:57] [DOC: 9321541] ✅ Patient date processing completed successfully
[05:00:57] ✅    ✅ Date processing completed
[05:00:57] 📊 Processed Patient Data
     └─ patientFName: Nancy
     └─ patientLName: Mak
     └─ dob: 01/31/1955
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 3946015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/29/2025', 'startOfEpisode': '05/29/2025', 'endOfEpisode': '07/27/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'M19.90', 'thirdDiagnosis': 'E66.811', 'fourthDiagnosis': 'E13.29', 'fifthDiagnosis': 'R80.9', 'sixthDiagnosis': 'F41.9'}]
[05:00:57] 🔄 
🔄 Step 4: Extracting order data...
[05:01:00] ℹ️  Order extraction - MRN: '3946015'
[05:01:00] ℹ️  Order extraction - Sex: 'FEMALE'
[05:01:00] ℹ️  Order extraction - Service Line: 'PT'
[05:01:00] ℹ️  Order extraction - Payer Source: ''
[05:01:00] ✅ Order data extraction completed successfully
[05:01:00] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:01:00] ℹ️  Using MRN from patient data: '3946015' over '3946015'
[05:01:00] ℹ️  Service line consistent in both sources: 'PT'
[05:01:00] ✅ Patient name cross-validation successful
[05:01:00] ✅    ✅ Data merged successfully
[05:01:01] ✅    ✅ Order data extracted and validated
[05:01:01] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:01:11] [DOC: 9321541] ✅ Patient exists in API: Nancy Mak, ID: be8480ca-1e37-471f-ae38-67c2a43cfb40
[05:01:11] ✅    ✅ Existing patient found with ID: be8480ca-1e37-471f-ae38-67c2a43cfb40
[05:01:11] 🔄 
🔄 Step 6: Pushing order to API...
[05:01:11] [DOC: 9321541] ℹ️  Pushing order via API for patient ID: be8480ca-1e37-471f-ae38-67c2a43cfb40
[05:01:11] [DOC: 9321541] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:01:11] ❌    ❌ Failed to push order
[05:01:11] 🔄 
🔄 Step 7: Writing to CSV...
[05:01:11] [DOC: 9321541] ℹ️  Calculated age: 70 from DOB: 01/31/1955
[05:01:11] [DOC: 9321541] ℹ️  Service Line extracted: 'PT'
[05:01:11] [DOC: 9321541] ℹ️  Payer Source extracted: ''
[05:01:11] [DOC: 9321541] ℹ️  Diagnosis codes being written:
[05:01:11] [DOC: 9321541] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[05:01:11] [DOC: 9321541] ℹ️    - Latest_Episode_Seconddiagnosis: 'M19.90'
[05:01:11] [DOC: 9321541] ℹ️    - Latest_Episode_Thirddiagnosis: 'E66.811'
[05:01:11] [DOC: 9321541] ℹ️    - Latest_Episode_Fourthdiagnosis: 'E13.29'
[05:01:11] [DOC: 9321541] ℹ️    - Latest_Episode_Fifthdiagnosis: 'R80.9'
[05:01:11] [DOC: 9321541] ℹ️    - Latest_Episode_Sixthdiagnosis: 'F41.9'
[05:01:11] [DOC: 9321541] ✅ Patient data written to CSV: Nancy Mak | Sex: FEMALE | Age: 70 | Service: PT | Payer:  | MRN: 3946015
[05:01:11] ✅    ✅ Document 9321541 processed and saved successfully
[05:01:11] 🔄 
🔄 Step 8: Saving API details...
[05:01:11] [DOC: 9321541] ℹ️  API push details saved for document 9321541
[05:01:11] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321538                         ║
================================================================================
[05:01:11] ℹ️  Agency: Dartmouth HH
[05:01:11] ℹ️  Date: 06/02/2025
[05:01:11] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:01:13] [DOC: 9321538] ✅ Text extracted using pdfplumber (1337 chars)
[05:01:13] ✅    ✅ Text extracted using pdfplumber (1337 chars)
[05:01:13] 🔄 
🔄 Step 2: Extracting patient data...
[05:01:16] ℹ️  AI extracted raw sex value: 'F'
[05:01:16] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:01:16] ℹ️  AI extracted payer source: 'Medicare'
[05:01:16] ℹ️  AI extracted diagnoses:
[05:01:16] ℹ️    - Diagnosis 1: ''
[05:01:16] ℹ️    - Diagnosis 2: ''
[05:01:16] ℹ️    - Diagnosis 3: ''
[05:01:16] ℹ️    - Diagnosis 4: ''
[05:01:16] ℹ️    - Diagnosis 5: ''
[05:01:16] ℹ️    - Diagnosis 6: ''
[05:01:16] ℹ️  Final extracted MRN: '5496011'
[05:01:16] ℹ️  Final extracted Sex: 'FEMALE'
[05:01:16] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:01:16] ℹ️  Final extracted Payer Source: 'Medicare'
[05:01:16] ✅ Patient data extraction completed successfully
[05:01:16] ✅    ✅ Patient data extracted successfully
[05:01:16] 📊 Patient Response
     └─ patientFName: Donna
     └─ patientLName: Leclair
     └─ dob: 08/17/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5496011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:01:16] ✅    ✅ Patient identified: Donna Leclair
[05:01:16] ✅    ✅ Patient name validation passed
[05:01:16] 🔄 
🔄 Step 3: Processing patient dates...
[05:01:16] [DOC: 9321538] ℹ️  DOB normalized: 08/17/1950
[05:01:16] [DOC: 9321538] ℹ️  Episode startOfCare normalized: 03/08/2025
[05:01:16] [DOC: 9321538] ℹ️  Episode startOfEpisode normalized: 05/07/2025
[05:01:16] [DOC: 9321538] ℹ️  Episode endOfEpisode normalized: 07/05/2025
[05:01:16] [DOC: 9321538] ✅ Patient date processing completed successfully
[05:01:16] ✅    ✅ Date processing completed
[05:01:16] 📊 Processed Patient Data
     └─ patientFName: Donna
     └─ patientLName: Leclair
     └─ dob: 08/17/1950
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 5496011
     └─ billingProvider: Hawthorn Medical Associates
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '03/08/2025', 'startOfEpisode': '05/07/2025', 'endOfEpisode': '07/05/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:01:16] 🔄 
🔄 Step 4: Extracting order data...
[05:01:18] ℹ️  Order extraction - MRN: ''
[05:01:18] ℹ️  Order extraction - Sex: 'FEMALE'
[05:01:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:01:18] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:01:18] ✅ Order data extraction completed successfully
[05:01:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:01:18] ℹ️  Using MRN from patient data: '5496011'
[05:01:18] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:01:18] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:01:18] ✅ Patient name cross-validation successful
[05:01:18] ✅    ✅ Data merged successfully
[05:01:20] ✅    ✅ Order data extracted and validated
[05:01:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:01:37] [DOC: 9321538] ✅ Patient exists in API: Donna Leclair, ID: fb4435a9-b3ea-490a-98e0-c6f0ea1f5826
[05:01:37] ✅    ✅ Existing patient found with ID: fb4435a9-b3ea-490a-98e0-c6f0ea1f5826
[05:01:37] 🔄 
🔄 Step 6: Pushing order to API...
[05:01:37] [DOC: 9321538] ℹ️  Pushing order via API for patient ID: fb4435a9-b3ea-490a-98e0-c6f0ea1f5826
[05:01:38] [DOC: 9321538] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:01:38] ❌    ❌ Failed to push order
[05:01:38] 🔄 
🔄 Step 7: Writing to CSV...
[05:01:38] [DOC: 9321538] ℹ️  Calculated age: 74 from DOB: 08/17/1950
[05:01:38] [DOC: 9321538] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:01:38] [DOC: 9321538] ℹ️  Payer Source extracted: 'Medicare'
[05:01:38] [DOC: 9321538] ℹ️  Diagnosis codes being written:
[05:01:38] [DOC: 9321538] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:01:38] [DOC: 9321538] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:01:38] [DOC: 9321538] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:01:38] [DOC: 9321538] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:01:38] [DOC: 9321538] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:01:38] [DOC: 9321538] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:01:38] [DOC: 9321538] ✅ Patient data written to CSV: Donna Leclair | Sex: FEMALE | Age: 74 | Service: Skilled Nursing | Payer: Medicare | MRN: 5496011
[05:01:38] ✅    ✅ Document 9321538 processed and saved successfully
[05:01:38] 🔄 
🔄 Step 8: Saving API details...
[05:01:38] [DOC: 9321538] ℹ️  API push details saved for document 9321538
[05:01:38] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321537                         ║
================================================================================
[05:01:38] ℹ️  Agency: Dartmouth HH
[05:01:38] ℹ️  Date: 06/02/2025
[05:01:38] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:01:41] [DOC: 9321537] ✅ Text extracted using pdfplumber (10862 chars)
[05:01:41] ✅    ✅ Text extracted using pdfplumber (10862 chars)
[05:01:41] 🔄 
🔄 Step 2: Extracting patient data...
[05:01:44] ℹ️  AI extracted raw sex value: 'F'
[05:01:44] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:01:44] ℹ️  AI extracted payer source: 'Medicare'
[05:01:44] ℹ️  AI extracted diagnoses:
[05:01:44] ℹ️    - Diagnosis 1: 'I48.91'
[05:01:44] ℹ️    - Diagnosis 2: 'I50.33'
[05:01:44] ℹ️    - Diagnosis 3: 'I73.9'
[05:01:44] ℹ️    - Diagnosis 4: 'E11.22'
[05:01:44] ℹ️    - Diagnosis 5: 'N18.30'
[05:01:44] ℹ️    - Diagnosis 6: ''
[05:01:44] ℹ️  Final extracted MRN: '4009015'
[05:01:44] ℹ️  Final extracted Sex: 'FEMALE'
[05:01:44] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:01:44] ℹ️  Final extracted Payer Source: 'Medicare'
[05:01:44] ✅ Patient data extraction completed successfully
[05:01:44] ✅    ✅ Patient data extracted successfully
[05:01:44] 📊 Patient Response
     └─ patientFName: Rosa
     └─ patientLName: Batista
     └─ dob: 08/18/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4009015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '05/23/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'I48.91', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'I73.9', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': ''}]
[05:01:44] ✅    ✅ Patient identified: Rosa Batista
[05:01:44] ✅    ✅ Patient name validation passed
[05:01:44] 🔄 
🔄 Step 3: Processing patient dates...
[05:01:44] [DOC: 9321537] ℹ️  DOB normalized: 08/18/1942
[05:01:44] [DOC: 9321537] ℹ️  Episode startOfCare normalized: 04/03/2025
[05:01:44] [DOC: 9321537] ℹ️  Episode startOfEpisode normalized: 05/23/2025
[05:01:44] [DOC: 9321537] ℹ️  Episode endOfEpisode normalized: 05/26/2025
[05:01:44] [DOC: 9321537] ✅ Patient date processing completed successfully
[05:01:44] ✅    ✅ Date processing completed
[05:01:44] 📊 Processed Patient Data
     └─ patientFName: Rosa
     └─ patientLName: Batista
     └─ dob: 08/18/1942
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 4009015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: 
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/03/2025', 'startOfEpisode': '05/23/2025', 'endOfEpisode': '05/26/2025', 'firstDiagnosis': 'I48.91', 'secondDiagnosis': 'I50.33', 'thirdDiagnosis': 'I73.9', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'N18.30', 'sixthDiagnosis': ''}]
[05:01:44] 🔄 
🔄 Step 4: Extracting order data...
[05:01:47] ℹ️  Order extraction - MRN: ''
[05:01:47] ℹ️  Order extraction - Sex: 'FEMALE'
[05:01:47] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:01:47] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:01:47] ✅ Order data extraction completed successfully
[05:01:47] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:01:47] ℹ️  Using MRN from patient data: '4009015'
[05:01:47] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:01:47] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:01:47] ✅ Patient name cross-validation successful
[05:01:47] ✅    ✅ Data merged successfully
[05:01:48] ✅    ✅ Order data extracted and validated
[05:01:48] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:01:56] [DOC: 9321537] ℹ️  Patient not found in cache or API: Rosa Batista
[05:01:56] [DOC: 9321537] ℹ️  Patient not found, creating new patient via API...
[05:01:56] [DOC: 9321537] ℹ️  Creating patient via API: Rosa Batista
[05:01:57] [DOC: 9321537] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:01:57] ❌    ❌ Failed to create patient
[05:01:57] [DOC: 9321537] ℹ️  API push details saved for document 9321537
================================================================================
║                        Processing Document ID: 9321536                         ║
================================================================================
[05:01:57] ℹ️  Agency: Dartmouth HH
[05:01:57] ℹ️  Date: 06/02/2025
[05:01:57] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:02:00] [DOC: 9321536] ✅ Text extracted using pdfplumber (15375 chars)
[05:02:00] ✅    ✅ Text extracted using pdfplumber (15363 chars)
[05:02:00] 🔄 
🔄 Step 2: Extracting patient data...
[05:02:04] ℹ️  AI extracted raw sex value: 'F'
[05:02:04] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy'
[05:02:04] ℹ️  AI extracted payer source: 'None'
[05:02:04] ℹ️  AI extracted diagnoses:
[05:02:04] ℹ️    - Diagnosis 1: 'Z47.1'
[05:02:04] ℹ️    - Diagnosis 2: 'Z96.611'
[05:02:04] ℹ️    - Diagnosis 3: 'I10'
[05:02:04] ℹ️    - Diagnosis 4: 'J44.9'
[05:02:04] ℹ️    - Diagnosis 5: 'E78.5'
[05:02:04] ℹ️    - Diagnosis 6: 'E03.9'
[05:02:04] ℹ️  Final extracted MRN: '227027'
[05:02:04] ℹ️  Final extracted Sex: 'FEMALE'
[05:02:04] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy'
[05:02:04] ℹ️  Final extracted Payer Source: ''
[05:02:04] ✅ Patient data extraction completed successfully
[05:02:04] ✅    ✅ Patient data extracted successfully
[05:02:04] 📊 Patient Response
     └─ patientFName: Arlene
     └─ patientLName: Proulx
     └─ dob: 08/25/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/09/2025', 'startOfEpisode': '05/10/2025', 'endOfEpisode': '07/08/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.611', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'E03.9'}]
[05:02:04] ✅    ✅ Patient identified: Arlene Proulx
[05:02:04] ✅    ✅ Patient name validation passed
[05:02:04] 🔄 
🔄 Step 3: Processing patient dates...
[05:02:04] [DOC: 9321536] ℹ️  DOB normalized: 08/25/1944
[05:02:04] [DOC: 9321536] ℹ️  Episode startOfCare normalized: 05/09/2025
[05:02:04] [DOC: 9321536] ℹ️  Episode startOfEpisode normalized: 05/10/2025
[05:02:04] [DOC: 9321536] ℹ️  Episode endOfEpisode normalized: 07/08/2025
[05:02:04] [DOC: 9321536] ✅ Patient date processing completed successfully
[05:02:04] ✅    ✅ Date processing completed
[05:02:04] 📊 Processed Patient Data
     └─ patientFName: Arlene
     └─ patientLName: Proulx
     └─ dob: 08/25/1944
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 227027
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/09/2025', 'startOfEpisode': '05/10/2025', 'endOfEpisode': '07/08/2025', 'firstDiagnosis': 'Z47.1', 'secondDiagnosis': 'Z96.611', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': 'J44.9', 'fifthDiagnosis': 'E78.5', 'sixthDiagnosis': 'E03.9'}]
[05:02:04] 🔄 
🔄 Step 4: Extracting order data...
[05:02:06] ℹ️  Order extraction - MRN: '6360015'
[05:02:06] ℹ️  Order extraction - Sex: 'FEMALE'
[05:02:06] ℹ️  Order extraction - Service Line: 'Skilled Nursing,Occupational Therapy'
[05:02:06] ℹ️  Order extraction - Payer Source: ''
[05:02:06] ✅ Order data extraction completed successfully
[05:02:06] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:02:06] ℹ️  Using longer MRN from order data: '6360015' over '227027'
[05:02:06] ℹ️  Combined service lines: Patient='Skilled Nursing, Occupational Therapy' + Order='Skilled Nursing,Occupational Therapy' = 'Occupational Therapy, Skilled Nursing'
[05:02:06] ✅ Patient name cross-validation successful
[05:02:06] ✅    ✅ Data merged successfully
[05:02:07] ✅    ✅ Order data extracted and validated
[05:02:07] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:02:12] [DOC: 9321536] ✅ Patient exists in API: Arlene Proulx, ID: e41c1421-e72f-4f9c-9543-40356fdac279
[05:02:12] ✅    ✅ Existing patient found with ID: e41c1421-e72f-4f9c-9543-40356fdac279
[05:02:12] 🔄 
🔄 Step 6: Pushing order to API...
[05:02:12] [DOC: 9321536] ℹ️  Pushing order via API for patient ID: e41c1421-e72f-4f9c-9543-40356fdac279
[05:02:14] [DOC: 9321536] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:02:14] ❌    ❌ Failed to push order
[05:02:14] 🔄 
🔄 Step 7: Writing to CSV...
[05:02:14] [DOC: 9321536] ℹ️  Calculated age: 80 from DOB: 08/25/1944
[05:02:14] [DOC: 9321536] ℹ️  Service Line extracted: 'Occupational Therapy, Skilled Nursing'
[05:02:14] [DOC: 9321536] ℹ️  Payer Source extracted: ''
[05:02:14] [DOC: 9321536] ℹ️  Diagnosis codes being written:
[05:02:14] [DOC: 9321536] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.1'
[05:02:14] [DOC: 9321536] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z96.611'
[05:02:14] [DOC: 9321536] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[05:02:14] [DOC: 9321536] ℹ️    - Latest_Episode_Fourthdiagnosis: 'J44.9'
[05:02:14] [DOC: 9321536] ℹ️    - Latest_Episode_Fifthdiagnosis: 'E78.5'
[05:02:14] [DOC: 9321536] ℹ️    - Latest_Episode_Sixthdiagnosis: 'E03.9'
[05:02:14] [DOC: 9321536] ✅ Patient data written to CSV: Arlene Proulx | Sex: FEMALE | Age: 80 | Service: Occupational Therapy, Skilled Nursing | Payer:  | MRN: 6360015
[05:02:14] ✅    ✅ Document 9321536 processed and saved successfully
[05:02:14] 🔄 
🔄 Step 8: Saving API details...
[05:02:14] [DOC: 9321536] ℹ️  API push details saved for document 9321536
[05:02:14] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9323305                         ║
================================================================================
[05:02:14] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:02:14] ℹ️  Date: 06/02/2025
[05:02:14] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:02:17] [DOC: 9323305] ✅ Text extracted using pdfplumber (13174 chars)
[05:02:17] ✅    ✅ Text extracted using pdfplumber (13174 chars)
[05:02:17] 🔄 
🔄 Step 2: Extracting patient data...
[05:02:20] ℹ️  AI extracted raw sex value: 'M'
[05:02:20] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:02:20] ℹ️  AI extracted payer source: 'Medicare'
[05:02:20] ℹ️  AI extracted diagnoses:
[05:02:20] ℹ️    - Diagnosis 1: 'I11.0'
[05:02:20] ℹ️    - Diagnosis 2: 'E11.40'
[05:02:20] ℹ️    - Diagnosis 3: 'I25.110'
[05:02:20] ℹ️    - Diagnosis 4: 'M19.90'
[05:02:20] ℹ️    - Diagnosis 5: 'N18.32'
[05:02:20] ℹ️    - Diagnosis 6: 'K21.9'
[05:02:20] ℹ️  Final extracted MRN: 'MA250415024502'
[05:02:20] ℹ️  Final extracted Sex: 'MALE'
[05:02:20] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:02:20] ℹ️  Final extracted Payer Source: 'Medicare'
[05:02:20] ✅ Patient data extraction completed successfully
[05:02:20] ✅    ✅ Patient data extracted successfully
[05:02:20] 📊 Patient Response
     └─ patientFName: Martin
     └─ patientLName: Jordan
     └─ dob: 02/15/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250415024502
     └─ billingProvider: Dr. Wu, Elaine
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 23 Clinton St
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ email: None
     └─ phoneNumber: (508) 993-5765
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/24/2025', 'startOfEpisode': '04/24/2025', 'endOfEpisode': '06/22/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'E11.40', 'thirdDiagnosis': 'I25.110', 'fourthDiagnosis': 'M19.90', 'fifthDiagnosis': 'N18.32', 'sixthDiagnosis': 'K21.9'}]
[05:02:20] ✅    ✅ Patient identified: Martin Jordan
[05:02:20] ✅    ✅ Patient name validation passed
[05:02:20] 🔄 
🔄 Step 3: Processing patient dates...
[05:02:20] [DOC: 9323305] ℹ️  DOB normalized: 02/15/1945
[05:02:20] [DOC: 9323305] ℹ️  Episode startOfCare normalized: 04/24/2025
[05:02:20] [DOC: 9323305] ℹ️  Episode startOfEpisode normalized: 04/24/2025
[05:02:20] [DOC: 9323305] ℹ️  Episode endOfEpisode normalized: 06/22/2025
[05:02:20] [DOC: 9323305] ✅ Patient date processing completed successfully
[05:02:20] ✅    ✅ Date processing completed
[05:02:20] 📊 Processed Patient Data
     └─ patientFName: Martin
     └─ patientLName: Jordan
     └─ dob: 02/15/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250415024502
     └─ billingProvider: Dr. Wu, Elaine
     └─ npi: 1821064874
     └─ physicianNPI: 1821064874
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 23 Clinton St
     └─ city: South Dartmouth
     └─ state: MA
     └─ zip: 02748
     └─ phoneNumber: (508) 993-5765
     └─ serviceLine: Skilled Nursing
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '04/24/2025', 'startOfEpisode': '04/24/2025', 'endOfEpisode': '06/22/2025', 'firstDiagnosis': 'I11.0', 'secondDiagnosis': 'E11.40', 'thirdDiagnosis': 'I25.110', 'fourthDiagnosis': 'M19.90', 'fifthDiagnosis': 'N18.32', 'sixthDiagnosis': 'K21.9'}]
[05:02:20] 🔄 
🔄 Step 4: Extracting order data...
[05:02:23] ℹ️  Order extraction - MRN: 'MA250415024502'
[05:02:23] ℹ️  Order extraction - Sex: 'MALE'
[05:02:23] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:02:23] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:02:23] ✅ Order data extraction completed successfully
[05:02:23] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:02:23] ℹ️  Using MRN from patient data: 'MA250415024502' over 'MA250415024502'
[05:02:23] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:02:23] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:02:23] ✅ Patient name cross-validation successful
[05:02:23] ✅    ✅ Data merged successfully
[05:02:24] ✅    ✅ Order data extracted and validated
[05:02:24] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:02:29] [DOC: 9323305] ✅ Patient exists in API: Martin Jordan, ID: 19ab9f63-24e8-437c-91b5-454d159148fb
[05:02:29] ✅    ✅ Existing patient found with ID: 19ab9f63-24e8-437c-91b5-454d159148fb
[05:02:29] 🔄 
🔄 Step 6: Pushing order to API...
[05:02:29] [DOC: 9323305] ℹ️  Pushing order via API for patient ID: 19ab9f63-24e8-437c-91b5-454d159148fb
[05:02:30] [DOC: 9323305] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18788"}
[05:02:30] ❌    ❌ Failed to push order
[05:02:30] 🔄 
🔄 Step 7: Writing to CSV...
[05:02:30] [DOC: 9323305] ℹ️  Calculated age: 80 from DOB: 02/15/1945
[05:02:30] [DOC: 9323305] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:02:30] [DOC: 9323305] ℹ️  Payer Source extracted: 'Medicare'
[05:02:30] [DOC: 9323305] ℹ️  Diagnosis codes being written:
[05:02:30] [DOC: 9323305] ℹ️    - Latest_Episode_Firstdiagnosis: 'I11.0'
[05:02:30] [DOC: 9323305] ℹ️    - Latest_Episode_Seconddiagnosis: 'E11.40'
[05:02:30] [DOC: 9323305] ℹ️    - Latest_Episode_Thirddiagnosis: 'I25.110'
[05:02:30] [DOC: 9323305] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M19.90'
[05:02:30] [DOC: 9323305] ℹ️    - Latest_Episode_Fifthdiagnosis: 'N18.32'
[05:02:30] [DOC: 9323305] ℹ️    - Latest_Episode_Sixthdiagnosis: 'K21.9'
[05:02:30] [DOC: 9323305] ✅ Patient data written to CSV: Martin Jordan | Sex: MALE | Age: 80 | Service: Skilled Nursing | Payer: Medicare | MRN: MA250415024502
[05:02:30] ✅    ✅ Document 9323305 processed and saved successfully
[05:02:30] 🔄 
🔄 Step 8: Saving API details...
[05:02:30] [DOC: 9323305] ℹ️  API push details saved for document 9323305
[05:02:30] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9323106                         ║
================================================================================
[05:02:30] ℹ️  Agency: Southcoast VNA – Community Office (Fairhaven)
[05:02:30] ℹ️  Date: 06/02/2025
[05:02:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:02:34] [DOC: 9323106] ✅ Text extracted using pdfplumber (16261 chars)
[05:02:34] ✅    ✅ Text extracted using pdfplumber (16251 chars)
[05:02:34] 🔄 
🔄 Step 2: Extracting patient data...
[05:02:37] ℹ️  AI extracted raw sex value: 'M'
[05:02:37] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:02:37] ℹ️  AI extracted payer source: ''
[05:02:37] ℹ️  AI extracted diagnoses:
[05:02:37] ℹ️    - Diagnosis 1: 'I65.21'
[05:02:37] ℹ️    - Diagnosis 2: 'G45.9'
[05:02:37] ℹ️    - Diagnosis 3: 'I25.10'
[05:02:37] ℹ️    - Diagnosis 4: 'J96.21'
[05:02:37] ℹ️    - Diagnosis 5: 'J96.22'
[05:02:37] ℹ️    - Diagnosis 6: 'J44.9'
[05:02:37] ℹ️  Final extracted MRN: '2261639'
[05:02:37] ℹ️  Final extracted Sex: 'MALE'
[05:02:37] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:02:37] ℹ️  Final extracted Payer Source: ''
[05:02:37] ✅ Patient data extraction completed successfully
[05:02:37] ✅    ✅ Patient data extracted successfully
[05:02:37] 📊 Patient Response
     └─ patientFName: Webster
     └─ patientLName: Bowen
     └─ dob: 09/12/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 2261639
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/12/2025', 'startOfEpisode': '05/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'I65.21', 'secondDiagnosis': 'G45.9', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'J96.21', 'fifthDiagnosis': 'J96.22', 'sixthDiagnosis': 'J44.9'}]
[05:02:37] ✅    ✅ Patient identified: Webster Bowen
[05:02:37] ✅    ✅ Patient name validation passed
[05:02:37] 🔄 
🔄 Step 3: Processing patient dates...
[05:02:37] [DOC: 9323106] ℹ️  DOB normalized: 09/12/1949
[05:02:37] [DOC: 9323106] ℹ️  Episode startOfCare normalized: 05/12/2025
[05:02:37] [DOC: 9323106] ℹ️  Episode startOfEpisode normalized: 05/16/2025
[05:02:37] [DOC: 9323106] ℹ️  Episode endOfEpisode normalized: 07/14/2025
[05:02:37] [DOC: 9323106] ✅ Patient date processing completed successfully
[05:02:37] ✅    ✅ Date processing completed
[05:02:37] 📊 Processed Patient Data
     └─ patientFName: Webster
     └─ patientLName: Bowen
     └─ dob: 09/12/1949
     └─ patientSex: MALE
     └─ medicalRecordNo: 2261639
     └─ billingProvider: Jahn A. Pothier, MD
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     └─ address: 200 Mill Road
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719-5252
     └─ email: 
     └─ phoneNumber: 508-973-3200
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '05/12/2025', 'startOfEpisode': '05/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'I65.21', 'secondDiagnosis': 'G45.9', 'thirdDiagnosis': 'I25.10', 'fourthDiagnosis': 'J96.21', 'fifthDiagnosis': 'J96.22', 'sixthDiagnosis': 'J44.9'}]
[05:02:37] 🔄 
🔄 Step 4: Extracting order data...
[05:02:40] ℹ️  Order extraction - MRN: '2261639'
[05:02:40] ℹ️  Order extraction - Sex: 'MALE'
[05:02:40] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:02:40] ℹ️  Order extraction - Payer Source: ''
[05:02:40] ✅ Order data extraction completed successfully
[05:02:40] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:02:40] ℹ️  Using MRN from patient data: '2261639' over '2261639'
[05:02:40] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:02:40] ✅ Patient name cross-validation successful
[05:02:40] ✅    ✅ Data merged successfully
[05:02:41] ✅    ✅ Order data extracted and validated
[05:02:41] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:02:46] [DOC: 9323106] ℹ️  Patient not found in cache or API: Webster Bowen
[05:02:46] [DOC: 9323106] ℹ️  Patient not found, creating new patient via API...
[05:02:46] [DOC: 9323106] ℹ️  Creating patient via API: Webster Bowen
[05:02:47] [DOC: 9323106] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:02:47] ❌    ❌ Failed to create patient
[05:02:47] [DOC: 9323106] ℹ️  API push details saved for document 9323106
================================================================================
║                        Processing Document ID: 9321544                         ║
================================================================================
[05:02:47] ℹ️  Agency: Dartmouth HH
[05:02:47] ℹ️  Date: 06/02/2025
[05:02:47] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:02:50] [DOC: 9321544] ✅ Text extracted using pdfplumber (16796 chars)
[05:02:50] ✅    ✅ Text extracted using pdfplumber (16784 chars)
[05:02:50] 🔄 
🔄 Step 2: Extracting patient data...
[05:02:54] ℹ️  AI extracted raw sex value: 'F'
[05:02:54] ℹ️  AI extracted service line: 'Skilled Nursing, PT'
[05:02:54] ℹ️  AI extracted payer source: 'None'
[05:02:54] ℹ️  AI extracted diagnoses:
[05:02:54] ℹ️    - Diagnosis 1: 'Z47.89'
[05:02:54] ℹ️    - Diagnosis 2: 'M47.27'
[05:02:54] ℹ️    - Diagnosis 3: 'R26.89'
[05:02:54] ℹ️    - Diagnosis 4: 'M54.9'
[05:02:54] ℹ️    - Diagnosis 5: 'G90.09'
[05:02:54] ℹ️    - Diagnosis 6: 'M48.061'
[05:02:54] ℹ️  Final extracted MRN: '711015'
[05:02:54] ℹ️  Final extracted Sex: 'FEMALE'
[05:02:54] ℹ️  Final extracted Service Line: 'Skilled Nursing, PT'
[05:02:54] ℹ️  Final extracted Payer Source: ''
[05:02:54] ✅ Patient data extraction completed successfully
[05:02:54] ✅    ✅ Patient data extracted successfully
[05:02:54] 📊 Patient Response
     └─ patientFName: Eileen
     └─ patientLName: Roddy
     └─ dob: 02/29/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 711015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ email: None
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '06/01/2025', 'endOfEpisode': '07/30/2025', 'firstDiagnosis': 'Z47.89', 'secondDiagnosis': 'M47.27', 'thirdDiagnosis': 'R26.89', 'fourthDiagnosis': 'M54.9', 'fifthDiagnosis': 'G90.09', 'sixthDiagnosis': 'M48.061'}]
[05:02:54] ✅    ✅ Patient identified: Eileen Roddy
[05:02:54] ✅    ✅ Patient name validation passed
[05:02:54] 🔄 
🔄 Step 3: Processing patient dates...
[05:02:54] [DOC: 9321544] ℹ️  DOB normalized: 02/29/1948
[05:02:54] [DOC: 9321544] ℹ️  Episode startOfCare normalized: 04/02/2025
[05:02:54] [DOC: 9321544] ℹ️  Episode startOfEpisode normalized: 06/01/2025
[05:02:54] [DOC: 9321544] ℹ️  Episode endOfEpisode normalized: 07/30/2025
[05:02:54] [DOC: 9321544] ✅ Patient date processing completed successfully
[05:02:54] ✅    ✅ Date processing completed
[05:02:54] 📊 Processed Patient Data
     └─ patientFName: Eileen
     └─ patientLName: Roddy
     └─ dob: 02/29/1948
     └─ patientSex: FEMALE
     └─ medicalRecordNo: 711015
     └─ billingProvider: Community Nurse Inc
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Community Nurse Inc
     └─ address: 62 Center Street
     └─ city: Fairhaven
     └─ state: MA
     └─ zip: 02719
     └─ phoneNumber: (508) 992-6278
     └─ serviceLine: Skilled Nursing, PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/02/2025', 'startOfEpisode': '06/01/2025', 'endOfEpisode': '07/30/2025', 'firstDiagnosis': 'Z47.89', 'secondDiagnosis': 'M47.27', 'thirdDiagnosis': 'R26.89', 'fourthDiagnosis': 'M54.9', 'fifthDiagnosis': 'G90.09', 'sixthDiagnosis': 'M48.061'}]
[05:02:54] 🔄 
🔄 Step 4: Extracting order data...
[05:02:56] ℹ️  Order extraction - MRN: '711015'
[05:02:56] ℹ️  Order extraction - Sex: 'FEMALE'
[05:02:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy'
[05:02:56] ℹ️  Order extraction - Payer Source: ''
[05:02:56] ✅ Order data extraction completed successfully
[05:02:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:02:56] ℹ️  Using MRN from patient data: '711015' over '711015'
[05:02:56] ℹ️  Combined service lines: Patient='Skilled Nursing, PT' + Order='Skilled Nursing, Physical Therapy' = 'PT, Physical Therapy, Skilled Nursing'
[05:02:56] ✅ Patient name cross-validation successful
[05:02:56] ✅    ✅ Data merged successfully
[05:02:57] ✅    ✅ Order data extracted and validated
[05:02:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:03:06] [DOC: 9321544] ✅ Patient exists in API: Eileen Roddy, ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[05:03:06] ✅    ✅ Existing patient found with ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[05:03:06] 🔄 
🔄 Step 6: Pushing order to API...
[05:03:06] [DOC: 9321544] ℹ️  Pushing order via API for patient ID: 42f039d0-5980-4cb8-918c-efe0208cdeef
[05:03:07] [DOC: 9321544] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:03:07] ❌    ❌ Failed to push order
[05:03:07] 🔄 
🔄 Step 7: Writing to CSV...
[05:03:07] [DOC: 9321544] ℹ️  Calculated age: 77 from DOB: 02/29/1948
[05:03:07] [DOC: 9321544] ℹ️  Service Line extracted: 'PT, Physical Therapy, Skilled Nursing'
[05:03:07] [DOC: 9321544] ℹ️  Payer Source extracted: ''
[05:03:07] [DOC: 9321544] ℹ️  Diagnosis codes being written:
[05:03:07] [DOC: 9321544] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z47.89'
[05:03:07] [DOC: 9321544] ℹ️    - Latest_Episode_Seconddiagnosis: 'M47.27'
[05:03:07] [DOC: 9321544] ℹ️    - Latest_Episode_Thirddiagnosis: 'R26.89'
[05:03:07] [DOC: 9321544] ℹ️    - Latest_Episode_Fourthdiagnosis: 'M54.9'
[05:03:07] [DOC: 9321544] ℹ️    - Latest_Episode_Fifthdiagnosis: 'G90.09'
[05:03:07] [DOC: 9321544] ℹ️    - Latest_Episode_Sixthdiagnosis: 'M48.061'
[05:03:07] [DOC: 9321544] ✅ Patient data written to CSV: Eileen Roddy | Sex: FEMALE | Age: 77 | Service: PT, Physical Therapy, Skilled Nursing | Payer:  | MRN: 711015
[05:03:07] ✅    ✅ Document 9321544 processed and saved successfully
[05:03:07] 🔄 
🔄 Step 8: Saving API details...
[05:03:07] [DOC: 9321544] ℹ️  API push details saved for document 9321544
[05:03:07] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321345                         ║
================================================================================
[05:03:07] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[05:03:07] ℹ️  Date: 05/30/2025
[05:03:07] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:03:11] [DOC: 9321345] ✅ Text extracted using pdfplumber (31468 chars)
[05:03:11] ✅    ✅ Text extracted using pdfplumber (31468 chars)
[05:03:11] 🔄 
🔄 Step 2: Extracting patient data...
[05:03:15] ℹ️  AI extracted raw sex value: 'M'
[05:03:15] ℹ️  AI extracted service line: 'Skilled Nursing,Occupational therapy'
[05:03:15] ℹ️  AI extracted payer source: 'Medicare'
[05:03:15] ℹ️  AI extracted diagnoses:
[05:03:15] ℹ️    - Diagnosis 1: 'N13.39'
[05:03:15] ℹ️    - Diagnosis 2: 'Z43.6'
[05:03:15] ℹ️    - Diagnosis 3: 'N20.2'
[05:03:15] ℹ️    - Diagnosis 4: 'N17.9'
[05:03:15] ℹ️    - Diagnosis 5: 'I5A'
[05:03:15] ℹ️    - Diagnosis 6: 'C22.0'
[05:03:15] ℹ️  Final extracted MRN: '28700189743501'
[05:03:15] ℹ️  Final extracted Sex: 'MALE'
[05:03:15] ℹ️  Final extracted Service Line: 'Skilled Nursing,Occupational therapy'
[05:03:15] ℹ️  Final extracted Payer Source: 'Medicare'
[05:03:15] ✅ Patient data extraction completed successfully
[05:03:15] ✅    ✅ Patient data extracted successfully
[05:03:15] 📊 Patient Response
     └─ patientFName: JOHN
     └─ patientLName: LOURENCO
     └─ dob: 05/05/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700189743501
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 93 SEYMOUR ST
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing,Occupational therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/16/2025', 'startOfEpisode': '01/16/2025', 'endOfEpisode': '03/16/2025', 'firstDiagnosis': 'N13.39', 'secondDiagnosis': 'Z43.6', 'thirdDiagnosis': 'N20.2', 'fourthDiagnosis': 'N17.9', 'fifthDiagnosis': 'I5A', 'sixthDiagnosis': 'C22.0'}]
[05:03:15] ✅    ✅ Patient identified: JOHN LOURENCO
[05:03:15] ✅    ✅ Patient name validation passed
[05:03:15] 🔄 
🔄 Step 3: Processing patient dates...
[05:03:15] [DOC: 9321345] ℹ️  DOB normalized: 05/05/1948
[05:03:15] [DOC: 9321345] ℹ️  Episode startOfCare normalized: 01/16/2025
[05:03:15] [DOC: 9321345] ℹ️  Episode startOfEpisode normalized: 01/16/2025
[05:03:15] [DOC: 9321345] ℹ️  Episode endOfEpisode normalized: 03/16/2025
[05:03:15] [DOC: 9321345] ✅ Patient date processing completed successfully
[05:03:15] ✅    ✅ Date processing completed
[05:03:15] 📊 Processed Patient Data
     └─ patientFName: JOHN
     └─ patientLName: LOURENCO
     └─ dob: 05/05/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700189743501
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 93 SEYMOUR ST
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02744
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing,Occupational therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/16/2025', 'startOfEpisode': '01/16/2025', 'endOfEpisode': '03/16/2025', 'firstDiagnosis': 'N13.39', 'secondDiagnosis': 'Z43.6', 'thirdDiagnosis': 'N20.2', 'fourthDiagnosis': 'N17.9', 'fifthDiagnosis': 'I5A', 'sixthDiagnosis': 'C22.0'}]
[05:03:15] 🔄 
🔄 Step 4: Extracting order data...
[05:03:18] ℹ️  Order extraction - MRN: '28700189743501'
[05:03:18] ℹ️  Order extraction - Sex: 'MALE'
[05:03:18] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Occupational Therapy'
[05:03:18] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:03:18] ✅ Order data extraction completed successfully
[05:03:18] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:03:18] ℹ️  Using MRN from patient data: '28700189743501' over '28700189743501'
[05:03:18] ℹ️  Combined service lines: Patient='Skilled Nursing,Occupational therapy' + Order='Skilled Nursing, Occupational Therapy' = 'Occupational Therapy, Occupational therapy, Skilled Nursing'
[05:03:18] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:03:18] ✅ Patient name cross-validation successful
[05:03:18] ✅    ✅ Data merged successfully
[05:03:19] ✅    ✅ Order data extracted and validated
[05:03:19] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:03:28] [DOC: 9321345] ✅ Patient exists in API: JOHN LOURENCO, ID: 6c7c73d1-a7e4-48da-822a-99e186a5bed3
[05:03:28] ✅    ✅ Existing patient found with ID: 6c7c73d1-a7e4-48da-822a-99e186a5bed3
[05:03:28] 🔄 
🔄 Step 6: Pushing order to API...
[05:03:28] [DOC: 9321345] ℹ️  Pushing order via API for patient ID: 6c7c73d1-a7e4-48da-822a-99e186a5bed3
[05:03:29] [DOC: 9321345] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18769"}
[05:03:29] ❌    ❌ Failed to push order
[05:03:29] 🔄 
🔄 Step 7: Writing to CSV...
[05:03:29] [DOC: 9321345] ℹ️  Calculated age: 77 from DOB: 05/05/1948
[05:03:29] [DOC: 9321345] ℹ️  Service Line extracted: 'Occupational Therapy, Occupational therapy, Skilled Nursing'
[05:03:29] [DOC: 9321345] ℹ️  Payer Source extracted: 'Medicare'
[05:03:29] [DOC: 9321345] ℹ️  Diagnosis codes being written:
[05:03:29] [DOC: 9321345] ℹ️    - Latest_Episode_Firstdiagnosis: 'N13.39'
[05:03:29] [DOC: 9321345] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z43.6'
[05:03:29] [DOC: 9321345] ℹ️    - Latest_Episode_Thirddiagnosis: 'N20.2'
[05:03:29] [DOC: 9321345] ℹ️    - Latest_Episode_Fourthdiagnosis: 'N17.9'
[05:03:29] [DOC: 9321345] ℹ️    - Latest_Episode_Fifthdiagnosis: 'I5A'
[05:03:29] [DOC: 9321345] ℹ️    - Latest_Episode_Sixthdiagnosis: 'C22.0'
[05:03:29] [DOC: 9321345] ✅ Patient data written to CSV: JOHN LOURENCO | Sex: MALE | Age: 77 | Service: Occupational Therapy, Occupational therapy, Skilled Nursing | Payer: Medicare | MRN: 28700189743501
[05:03:29] ✅    ✅ Document 9321345 processed and saved successfully
[05:03:29] 🔄 
🔄 Step 8: Saving API details...
[05:03:29] [DOC: 9321345] ℹ️  API push details saved for document 9321345
[05:03:29] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321344                         ║
================================================================================
[05:03:29] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[05:03:29] ℹ️  Date: 05/30/2025
[05:03:29] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:03:32] [DOC: 9321344] ✅ Text extracted using pdfplumber (19463 chars)
[05:03:32] ✅    ✅ Text extracted using pdfplumber (19463 chars)
[05:03:32] 🔄 
🔄 Step 2: Extracting patient data...
[05:03:36] ℹ️  AI extracted raw sex value: 'M'
[05:03:36] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:03:36] ℹ️  AI extracted payer source: 'Medicare'
[05:03:36] ℹ️  AI extracted diagnoses:
[05:03:36] ℹ️    - Diagnosis 1: 'N13.39'
[05:03:36] ℹ️    - Diagnosis 2: 'Z43.6'
[05:03:36] ℹ️    - Diagnosis 3: 'N20.2'
[05:03:36] ℹ️    - Diagnosis 4: 'I5A'
[05:03:36] ℹ️    - Diagnosis 5: 'C22.0'
[05:03:36] ℹ️    - Diagnosis 6: 'I12.9'
[05:03:36] ℹ️  Final extracted MRN: '28700189743501'
[05:03:36] ℹ️  Final extracted Sex: 'MALE'
[05:03:36] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:03:36] ℹ️  Final extracted Payer Source: 'Medicare'
[05:03:36] ✅ Patient data extraction completed successfully
[05:03:36] ✅    ✅ Patient data extracted successfully
[05:03:36] 📊 Patient Response
     └─ patientFName: JOHN
     └─ patientLName: LOURENCO
     └─ dob: 05/05/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700189743501
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 93 SEYMOUR ST
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02744-
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/16/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'N13.39', 'secondDiagnosis': 'Z43.6', 'thirdDiagnosis': 'N20.2', 'fourthDiagnosis': 'I5A', 'fifthDiagnosis': 'C22.0', 'sixthDiagnosis': 'I12.9'}]
[05:03:36] ✅    ✅ Patient identified: JOHN LOURENCO
[05:03:36] ✅    ✅ Patient name validation passed
[05:03:36] 🔄 
🔄 Step 3: Processing patient dates...
[05:03:36] [DOC: 9321344] ℹ️  DOB normalized: 05/05/1948
[05:03:36] [DOC: 9321344] ℹ️  Episode startOfCare normalized: 01/16/2025
[05:03:36] [DOC: 9321344] ℹ️  Episode startOfEpisode normalized: 03/17/2025
[05:03:36] [DOC: 9321344] ℹ️  Episode endOfEpisode normalized: 05/15/2025
[05:03:36] [DOC: 9321344] ✅ Patient date processing completed successfully
[05:03:36] ✅    ✅ Date processing completed
[05:03:36] 📊 Processed Patient Data
     └─ patientFName: JOHN
     └─ patientLName: LOURENCO
     └─ dob: 05/05/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700189743501
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 93 SEYMOUR ST
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02744-
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/16/2025', 'startOfEpisode': '03/17/2025', 'endOfEpisode': '05/15/2025', 'firstDiagnosis': 'N13.39', 'secondDiagnosis': 'Z43.6', 'thirdDiagnosis': 'N20.2', 'fourthDiagnosis': 'I5A', 'fifthDiagnosis': 'C22.0', 'sixthDiagnosis': 'I12.9'}]
[05:03:36] 🔄 
🔄 Step 4: Extracting order data...
[05:03:39] ℹ️  Order extraction - MRN: '28700189743501'
[05:03:39] ℹ️  Order extraction - Sex: 'MALE'
[05:03:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:03:39] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:03:39] ✅ Order data extraction completed successfully
[05:03:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:03:39] ℹ️  Using MRN from patient data: '28700189743501' over '28700189743501'
[05:03:39] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:03:39] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:03:39] ✅ Patient name cross-validation successful
[05:03:39] ✅    ✅ Data merged successfully
[05:03:40] ✅    ✅ Order data extracted and validated
[05:03:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:03:40] [DOC: 9321344] ✅ Patient found in local cache: JOHN LOURENCO, ID: 6c7c73d1-a7e4-48da-822a-99e186a5bed3
[05:03:40] ✅    ✅ Existing patient found with ID: 6c7c73d1-a7e4-48da-822a-99e186a5bed3
[05:03:40] 🔄 
🔄 Step 6: Pushing order to API...
[05:03:40] [DOC: 9321344] ℹ️  Pushing order via API for patient ID: 6c7c73d1-a7e4-48da-822a-99e186a5bed3
[05:03:41] [DOC: 9321344] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18770"}
[05:03:41] ❌    ❌ Failed to push order
[05:03:41] 🔄 
🔄 Step 7: Writing to CSV...
[05:03:41] [DOC: 9321344] ℹ️  Calculated age: 77 from DOB: 05/05/1948
[05:03:41] [DOC: 9321344] ℹ️  Service Line extracted: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:03:41] [DOC: 9321344] ℹ️  Payer Source extracted: 'Medicare'
[05:03:41] [DOC: 9321344] ℹ️  Diagnosis codes being written:
[05:03:41] [DOC: 9321344] ℹ️    - Latest_Episode_Firstdiagnosis: 'N13.39'
[05:03:41] [DOC: 9321344] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z43.6'
[05:03:41] [DOC: 9321344] ℹ️    - Latest_Episode_Thirddiagnosis: 'N20.2'
[05:03:41] [DOC: 9321344] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I5A'
[05:03:41] [DOC: 9321344] ℹ️    - Latest_Episode_Fifthdiagnosis: 'C22.0'
[05:03:41] [DOC: 9321344] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I12.9'
[05:03:41] [DOC: 9321344] ✅ Patient data written to CSV: JOHN LOURENCO | Sex: MALE | Age: 77 | Service: Skilled Nursing, Physical Therapy, Occupational Therapy | Payer: Medicare | MRN: 28700189743501
[05:03:41] ✅    ✅ Document 9321344 processed and saved successfully
[05:03:41] 🔄 
🔄 Step 8: Saving API details...
[05:03:41] [DOC: 9321344] ℹ️  API push details saved for document 9321344
[05:03:41] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9321343                         ║
================================================================================
[05:03:41] ℹ️  Agency: Bayada Home Health Care-Dartmouth
[05:03:41] ℹ️  Date: 05/30/2025
[05:03:41] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:03:44] [DOC: 9321343] ✅ Text extracted using pdfplumber (18522 chars)
[05:03:44] ✅    ✅ Text extracted using pdfplumber (18522 chars)
[05:03:44] 🔄 
🔄 Step 2: Extracting patient data...
[05:03:47] ℹ️  AI extracted raw sex value: 'M'
[05:03:47] ℹ️  AI extracted service line: 'Skilled Nursing, Occupational Therapy'
[05:03:47] ℹ️  AI extracted payer source: 'Medicare'
[05:03:47] ℹ️  AI extracted diagnoses:
[05:03:47] ℹ️    - Diagnosis 1: 'Z43.6'
[05:03:47] ℹ️    - Diagnosis 2: 'N13.39'
[05:03:47] ℹ️    - Diagnosis 3: 'N20.2'
[05:03:47] ℹ️    - Diagnosis 4: 'I5A'
[05:03:47] ℹ️    - Diagnosis 5: 'C22.0'
[05:03:47] ℹ️    - Diagnosis 6: 'I12.9'
[05:03:47] ℹ️  Final extracted MRN: '28700189743501'
[05:03:47] ℹ️  Final extracted Sex: 'MALE'
[05:03:47] ℹ️  Final extracted Service Line: 'Skilled Nursing, Occupational Therapy'
[05:03:47] ℹ️  Final extracted Payer Source: 'Medicare'
[05:03:47] ✅ Patient data extraction completed successfully
[05:03:47] ✅    ✅ Patient data extracted successfully
[05:03:47] 📊 Patient Response
     └─ patientFName: JOHN
     └─ patientLName: LOURENCO
     └─ dob: 05/05/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700189743501
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 93 SEYMOUR ST
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02744-
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/16/2025', 'startOfEpisode': '05/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'Z43.6', 'secondDiagnosis': 'N13.39', 'thirdDiagnosis': 'N20.2', 'fourthDiagnosis': 'I5A', 'fifthDiagnosis': 'C22.0', 'sixthDiagnosis': 'I12.9'}]
[05:03:47] ✅    ✅ Patient identified: JOHN LOURENCO
[05:03:47] ✅    ✅ Patient name validation passed
[05:03:47] 🔄 
🔄 Step 3: Processing patient dates...
[05:03:47] [DOC: 9321343] ℹ️  DOB normalized: 05/05/1948
[05:03:47] [DOC: 9321343] ℹ️  Episode startOfCare normalized: 01/16/2025
[05:03:47] [DOC: 9321343] ℹ️  Episode startOfEpisode normalized: 05/16/2025
[05:03:47] [DOC: 9321343] ℹ️  Episode endOfEpisode normalized: 07/14/2025
[05:03:47] [DOC: 9321343] ✅ Patient date processing completed successfully
[05:03:47] ✅    ✅ Date processing completed
[05:03:47] 📊 Processed Patient Data
     └─ patientFName: JOHN
     └─ patientLName: LOURENCO
     └─ dob: 05/05/1948
     └─ patientSex: MALE
     └─ medicalRecordNo: 28700189743501
     └─ billingProvider: BAYADA HOME HEALTH CARE INC
     └─ npi: 227539
     └─ physicianNPI: 
     └─ nameOfAgency: BAYADA HOME HEALTH CARE INC
     └─ address: 93 SEYMOUR ST
     └─ city: NEW BEDFORD
     └─ state: MA
     └─ zip: 02744-
     └─ email: 
     └─ phoneNumber: (508) 994-1003
     └─ serviceLine: Skilled Nursing, Occupational Therapy
     └─ payorSource: Medicare
     └─ episodeDiagnoses: [{'startOfCare': '01/16/2025', 'startOfEpisode': '05/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'Z43.6', 'secondDiagnosis': 'N13.39', 'thirdDiagnosis': 'N20.2', 'fourthDiagnosis': 'I5A', 'fifthDiagnosis': 'C22.0', 'sixthDiagnosis': 'I12.9'}]
[05:03:47] 🔄 
🔄 Step 4: Extracting order data...
[05:03:50] ℹ️  Order extraction - MRN: '28700189743501'
[05:03:50] ℹ️  Order extraction - Sex: 'MALE'
[05:03:50] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Occupational Therapy'
[05:03:50] ℹ️  Order extraction - Payer Source: 'Medicare'
[05:03:50] ✅ Order data extraction completed successfully
[05:03:50] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:03:50] ℹ️  Using MRN from patient data: '28700189743501' over '28700189743501'
[05:03:50] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Occupational Therapy'
[05:03:50] ℹ️  Payer source consistent in both sources: 'Medicare'
[05:03:50] ✅ Patient name cross-validation successful
[05:03:50] ✅    ✅ Data merged successfully
[05:03:51] ✅    ✅ Order data extracted and validated
[05:03:51] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:03:51] [DOC: 9321343] ✅ Patient found in local cache: JOHN LOURENCO, ID: 6c7c73d1-a7e4-48da-822a-99e186a5bed3
[05:03:51] ✅    ✅ Existing patient found with ID: 6c7c73d1-a7e4-48da-822a-99e186a5bed3
[05:03:51] 🔄 
🔄 Step 6: Pushing order to API...
[05:03:51] [DOC: 9321343] ℹ️  Pushing order via API for patient ID: 6c7c73d1-a7e4-48da-822a-99e186a5bed3
[05:03:53] [DOC: 9321343] ❌ Order push failed with status 201: {"id":"ae42a51a-3470-4ab2-baad-316720ebc1c1","orderWAVId":"ORD19935","orderNo":"12491908","orderDate":"05/14/2025","startOfCare":"01/16/2025","episodeStartDate":"05/16/2025","episodeEndDate":"07/14/2025","documentID":"9321343","mrn":"28700189743501","patientName":"JOHN LOURENCO","sentToPhysicianDate":"05/30/2025","sentToPhysicianStatus":true,"signedByPhysicianDate":"06/03/2025","signedByPhysicianStatus":true,"uploadedSignedOrderDate":null,"uploadedSignedOrderStatus":false,"uploadedSignedPgOrderDate":null,"uploadedSignedPgOrderStatus":false,"cpoMinutes":null,"orderUrl":null,"documentName":"HOME HEALTH CERTIFICATION AND PLAN OF CARE","ehr":null,"account":null,"location":null,"remarks":null,"patientId":"6c7c73d1-a7e4-48da-822a-99e186a5bed3","companyId":"532ae690-17f2-4fb0-b9ec-e3ef8634f57d","pgCompanyId":"4b51c8b7-c8c4-4779-808c-038c057f026b","entityType":null,"clinicalJustification":null,"billingProvider":null,"billingProviderNPI":null,"supervisingProvider":null,"supervisingProviderNPI":null,"bit64Url":null,"daOrderType":null,"daUploadSuccess":null,"daResponseStatusCode":null,"daResponseDetails":null}
[05:03:53] ❌    ❌ Failed to push order
[05:03:53] 🔄 
🔄 Step 7: Writing to CSV...
[05:03:53] [DOC: 9321343] ℹ️  Calculated age: 77 from DOB: 05/05/1948
[05:03:53] [DOC: 9321343] ℹ️  Service Line extracted: 'Skilled Nursing, Occupational Therapy'
[05:03:53] [DOC: 9321343] ℹ️  Payer Source extracted: 'Medicare'
[05:03:53] [DOC: 9321343] ℹ️  Diagnosis codes being written:
[05:03:53] [DOC: 9321343] ℹ️    - Latest_Episode_Firstdiagnosis: 'Z43.6'
[05:03:53] [DOC: 9321343] ℹ️    - Latest_Episode_Seconddiagnosis: 'N13.39'
[05:03:53] [DOC: 9321343] ℹ️    - Latest_Episode_Thirddiagnosis: 'N20.2'
[05:03:53] [DOC: 9321343] ℹ️    - Latest_Episode_Fourthdiagnosis: 'I5A'
[05:03:53] [DOC: 9321343] ℹ️    - Latest_Episode_Fifthdiagnosis: 'C22.0'
[05:03:53] [DOC: 9321343] ℹ️    - Latest_Episode_Sixthdiagnosis: 'I12.9'
[05:03:53] [DOC: 9321343] ✅ Patient data written to CSV: JOHN LOURENCO | Sex: MALE | Age: 77 | Service: Skilled Nursing, Occupational Therapy | Payer: Medicare | MRN: 28700189743501
[05:03:53] ✅    ✅ Document 9321343 processed and saved successfully
[05:03:53] 🔄 
🔄 Step 8: Saving API details...
[05:03:53] [DOC: 9321343] ℹ️  API push details saved for document 9321343
[05:03:53] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320940                         ║
================================================================================
[05:03:53] ℹ️  Agency: All At Home Health Care-Allston
[05:03:53] ℹ️  Date: 05/30/2025
[05:03:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:03:56] [DOC: 9320940] ✅ Text extracted using pdfplumber (2139 chars)
[05:03:56] ✅    ✅ Text extracted using pdfplumber (2139 chars)
[05:03:56] 🔄 
🔄 Step 2: Extracting patient data...
[05:03:58] ℹ️  AI extracted raw sex value: ''
[05:03:58] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:03:58] ℹ️  AI extracted payer source: ''
[05:03:58] ℹ️  AI extracted diagnoses:
[05:03:58] ℹ️    - Diagnosis 1: ''
[05:03:58] ℹ️    - Diagnosis 2: ''
[05:03:58] ℹ️    - Diagnosis 3: ''
[05:03:58] ℹ️    - Diagnosis 4: ''
[05:03:58] ℹ️    - Diagnosis 5: ''
[05:03:58] ℹ️    - Diagnosis 6: ''
[05:03:58] ℹ️  Final extracted MRN: ''
[05:03:58] ℹ️  Final extracted Sex: ''
[05:03:58] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:03:58] ℹ️  Final extracted Payer Source: ''
[05:03:58] ✅ Patient data extraction completed successfully
[05:03:58] ✅    ✅ Patient data extracted successfully
[05:03:58] 📊 Patient Response
     └─ patientFName: David
     └─ patientLName: Richardson
     └─ dob: 05/03/1955
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Colm McCarthy, MD
     └─ npi: 1720386378
     └─ physicianNPI: 1982269205
     └─ nameOfAgency: All At Home Health Care
     └─ address: 531 Faunce Corner Road
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: olsa.rusha@allathomehealth.com
     └─ phoneNumber: (508) 933-4956
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/25/2025', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:03:58] ✅    ✅ Patient identified: David Richardson
[05:03:58] ✅    ✅ Patient name validation passed
[05:03:58] 🔄 
🔄 Step 3: Processing patient dates...
[05:03:58] [DOC: 9320940] ℹ️  DOB normalized: 05/03/1955
[05:03:58] [DOC: 9320940] ℹ️  Episode startOfCare normalized: 04/25/2025
[05:03:58] [DOC: 9320940] ℹ️  Episode startOfEpisode normalized: 04/25/2025
[05:03:58] [DOC: 9320940] ℹ️  Episode endOfEpisode normalized: 06/23/2025
[05:03:58] [DOC: 9320940] ✅ Patient date processing completed successfully
[05:03:58] ✅    ✅ Date processing completed
[05:03:58] 📊 Processed Patient Data
     └─ patientFName: David
     └─ patientLName: Richardson
     └─ dob: 05/03/1955
     └─ patientSex: 
     └─ medicalRecordNo: 
     └─ billingProvider: Colm McCarthy, MD
     └─ npi: 1720386378
     └─ physicianNPI: 1982269205
     └─ nameOfAgency: All At Home Health Care
     └─ address: 531 Faunce Corner Road
     └─ city: North Dartmouth
     └─ state: MA
     └─ zip: 02747
     └─ email: olsa.rusha@allathomehealth.com
     └─ phoneNumber: (508) 933-4956
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '04/25/2025', 'startOfEpisode': '04/25/2025', 'endOfEpisode': '06/23/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:03:58] 🔄 
🔄 Step 4: Extracting order data...
[05:04:01] ℹ️  Order extraction - MRN: ''
[05:04:01] ℹ️  Order extraction - Sex: ''
[05:04:01] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:04:01] ℹ️  Order extraction - Payer Source: ''
[05:04:01] ✅ Order data extraction completed successfully
[05:04:01] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:04:01] ⚠️  No MRN found in either patient or order data
[05:04:01] ℹ️  Inferred sex as MALE from name: David
[05:04:01] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:04:01] ✅ Patient name cross-validation successful
[05:04:01] ✅    ✅ Data merged successfully
[05:04:02] ✅    ✅ Order data extracted and validated
[05:04:02] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:04:22] [DOC: 9320940] ✅ Patient exists in API: David Richardson, ID: cc0688d1-ac1b-4cfd-9e1f-718e2c0ee026
[05:04:22] ✅    ✅ Existing patient found with ID: cc0688d1-ac1b-4cfd-9e1f-718e2c0ee026
[05:04:22] 🔄 
🔄 Step 6: Pushing order to API...
[05:04:22] [DOC: 9320940] ℹ️  Pushing order via API for patient ID: cc0688d1-ac1b-4cfd-9e1f-718e2c0ee026
[05:04:23] [DOC: 9320940] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:04:23] ❌    ❌ Failed to push order
[05:04:23] 🔄 
🔄 Step 7: Writing to CSV...
[05:04:23] [DOC: 9320940] ℹ️  Calculated age: 70 from DOB: 05/03/1955
[05:04:23] [DOC: 9320940] ℹ️  Service Line extracted: 'Skilled Nursing'
[05:04:23] [DOC: 9320940] ℹ️  Payer Source extracted: ''
[05:04:23] [DOC: 9320940] ℹ️  Diagnosis codes being written:
[05:04:23] [DOC: 9320940] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:04:23] [DOC: 9320940] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:04:23] [DOC: 9320940] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:04:23] [DOC: 9320940] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:04:23] [DOC: 9320940] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:04:23] [DOC: 9320940] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:04:23] [DOC: 9320940] ✅ Patient data written to CSV: David Richardson | Sex: MALE | Age: 70 | Service: Skilled Nursing | Payer:  | MRN: 
[05:04:23] ✅    ✅ Document 9320940 processed and saved successfully
[05:04:23] 🔄 
🔄 Step 8: Saving API details...
[05:04:23] [DOC: 9320940] ℹ️  API push details saved for document 9320940
[05:04:23] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320926                         ║
================================================================================
[05:04:23] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:04:23] ℹ️  Date: 05/30/2025
[05:04:23] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:04:26] [DOC: 9320926] ✅ Text extracted using pdfplumber (12446 chars)
[05:04:26] ✅    ✅ Text extracted using pdfplumber (12446 chars)
[05:04:26] 🔄 
🔄 Step 2: Extracting patient data...
[05:04:29] ℹ️  AI extracted raw sex value: 'F'
[05:04:29] ℹ️  AI extracted service line: 'OT'
[05:04:29] ℹ️  AI extracted payer source: ''
[05:04:29] ℹ️  AI extracted diagnoses:
[05:04:29] ℹ️    - Diagnosis 1: ''
[05:04:29] ℹ️    - Diagnosis 2: ''
[05:04:29] ℹ️    - Diagnosis 3: ''
[05:04:29] ℹ️    - Diagnosis 4: ''
[05:04:29] ℹ️    - Diagnosis 5: ''
[05:04:29] ℹ️    - Diagnosis 6: ''
[05:04:29] ℹ️  Final extracted MRN: 'MA221209055605'
[05:04:29] ℹ️  Final extracted Sex: 'FEMALE'
[05:04:29] ℹ️  Final extracted Service Line: 'OT'
[05:04:29] ℹ️  Final extracted Payer Source: ''
[05:04:29] ✅ Patient data extraction completed successfully
[05:04:29] ✅    ✅ Patient data extracted successfully
[05:04:29] 📊 Patient Response
     └─ patientFName: Connie
     └─ patientLName: Sousa
     └─ dob: 05/23/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221209055605
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Home Health Services
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:04:29] ✅    ✅ Patient identified: Connie Sousa
[05:04:29] ✅    ✅ Patient name validation passed
[05:04:29] 🔄 
🔄 Step 3: Processing patient dates...
[05:04:29] [DOC: 9320926] ℹ️  DOB normalized: 05/23/1956
[05:04:29] [DOC: 9320926] ✅ Patient date processing completed successfully
[05:04:29] ✅    ✅ Date processing completed
[05:04:29] 📊 Processed Patient Data
     └─ patientFName: Connie
     └─ patientLName: Sousa
     └─ dob: 05/23/1956
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA221209055605
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Home Health Services
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:04:29] 🔄 
🔄 Step 4: Extracting order data...
[05:04:32] ℹ️  Order extraction - MRN: 'MA221209055605'
[05:04:32] ℹ️  Order extraction - Sex: 'FEMALE'
[05:04:32] ℹ️  Order extraction - Service Line: 'OT'
[05:04:32] ℹ️  Order extraction - Payer Source: ''
[05:04:32] ✅ Order data extraction completed successfully
[05:04:32] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:04:32] ℹ️  Using MRN from patient data: 'MA221209055605' over 'MA221209055605'
[05:04:32] ℹ️  Service line consistent in both sources: 'OT'
[05:04:32] ✅ Patient name cross-validation successful
[05:04:32] ✅    ✅ Data merged successfully
[05:04:34] ✅    ✅ Order data extracted and validated
[05:04:34] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:04:53] [DOC: 9320926] ℹ️  Patient not found in cache or API: Connie Sousa
[05:04:53] [DOC: 9320926] ℹ️  Patient not found, creating new patient via API...
[05:04:53] [DOC: 9320926] ℹ️  Creating patient via API: Connie Sousa
[05:04:59] [DOC: 9320926] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:04:59] ❌    ❌ Failed to create patient
[05:04:59] [DOC: 9320926] ℹ️  API push details saved for document 9320926
================================================================================
║                        Processing Document ID: 9320924                         ║
================================================================================
[05:04:59] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:04:59] ℹ️  Date: 05/30/2025
[05:04:59] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:05:03] [DOC: 9320924] ✅ Text extracted using pdfplumber (23013 chars)
[05:05:03] ✅    ✅ Text extracted using pdfplumber (23013 chars)
[05:05:03] 🔄 
🔄 Step 2: Extracting patient data...
[05:05:06] ℹ️  AI extracted raw sex value: 'F'
[05:05:06] ℹ️  AI extracted service line: 'PT'
[05:05:06] ℹ️  AI extracted payer source: ''
[05:05:06] ℹ️  AI extracted diagnoses:
[05:05:06] ℹ️    - Diagnosis 1: 'J06.9'
[05:05:06] ℹ️    - Diagnosis 2: 'M62.81'
[05:05:06] ℹ️    - Diagnosis 3: ''
[05:05:06] ℹ️    - Diagnosis 4: ''
[05:05:06] ℹ️    - Diagnosis 5: ''
[05:05:06] ℹ️    - Diagnosis 6: ''
[05:05:06] ℹ️  Final extracted MRN: 'MA240417095701'
[05:05:06] ℹ️  Final extracted Sex: 'FEMALE'
[05:05:06] ℹ️  Final extracted Service Line: 'PT'
[05:05:06] ℹ️  Final extracted Payer Source: ''
[05:05:06] ✅ Patient data extraction completed successfully
[05:05:06] ✅    ✅ Patient data extracted successfully
[05:05:06] 📊 Patient Response
     └─ patientFName: Cheryl
     └─ patientLName: Perkins
     └─ dob: 09/07/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240417095701
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J06.9', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:05:06] ✅    ✅ Patient identified: Cheryl Perkins
[05:05:06] ✅    ✅ Patient name validation passed
[05:05:06] 🔄 
🔄 Step 3: Processing patient dates...
[05:05:06] [DOC: 9320924] ℹ️  DOB normalized: 09/07/1957
[05:05:06] [DOC: 9320924] ℹ️  Episode startOfEpisode normalized: 03/01/2025
[05:05:06] [DOC: 9320924] ✅ Patient date processing completed successfully
[05:05:06] ✅    ✅ Date processing completed
[05:05:06] 📊 Processed Patient Data
     └─ patientFName: Cheryl
     └─ patientLName: Perkins
     └─ dob: 09/07/1957
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA240417095701
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/01/2025', 'endOfEpisode': '', 'firstDiagnosis': 'J06.9', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:05:06] 🔄 
🔄 Step 4: Extracting order data...
[05:05:09] ℹ️  Order extraction - MRN: 'MA240417095701'
[05:05:09] ℹ️  Order extraction - Sex: 'FEMALE'
[05:05:09] ℹ️  Order extraction - Service Line: 'PT'
[05:05:09] ℹ️  Order extraction - Payer Source: ''
[05:05:09] ✅ Order data extraction completed successfully
[05:05:09] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:05:09] ℹ️  Using MRN from patient data: 'MA240417095701' over 'MA240417095701'
[05:05:09] ℹ️  Service line consistent in both sources: 'PT'
[05:05:09] ✅ Patient name cross-validation successful
[05:05:09] ✅    ✅ Data merged successfully
[05:05:10] ⚠️     ❌ Skipping - missing episode start date
[05:05:10] [DOC: 9320924] ℹ️  API push details saved for document 9320924
================================================================================
║                        Processing Document ID: 9320920                         ║
================================================================================
[05:05:10] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:05:10] ℹ️  Date: 05/30/2025
[05:05:10] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:05:12] [DOC: 9320920] ✅ Text extracted using pdfplumber (1345 chars)
[05:05:12] ✅    ✅ Text extracted using pdfplumber (1345 chars)
[05:05:12] 🔄 
🔄 Step 2: Extracting patient data...
[05:05:15] ℹ️  AI extracted raw sex value: ''
[05:05:15] ℹ️  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[05:05:15] ℹ️  AI extracted payer source: ''
[05:05:15] ℹ️  AI extracted diagnoses:
[05:05:15] ℹ️    - Diagnosis 1: 'I10'
[05:05:15] ℹ️    - Diagnosis 2: 'Z96.651'
[05:05:15] ℹ️    - Diagnosis 3: 'E11.65'
[05:05:15] ℹ️    - Diagnosis 4: ''
[05:05:15] ℹ️    - Diagnosis 5: ''
[05:05:15] ℹ️    - Diagnosis 6: ''
[05:05:15] ℹ️  Final extracted MRN: 'MA211109044503'
[05:05:15] ℹ️  Final extracted Sex: ''
[05:05:15] ℹ️  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[05:05:15] ℹ️  Final extracted Payer Source: ''
[05:05:15] ✅ Patient data extraction completed successfully
[05:05:15] ✅    ✅ Patient data extracted successfully
[05:05:15] 📊 Patient Response
     └─ patientFName: Judith
     └─ patientLName: Mickelson
     └─ dob: 04/01/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA211109044503
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/21/2025', 'endOfEpisode': '06/19/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'Z96.651', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:05:15] ✅    ✅ Patient identified: Judith Mickelson
[05:05:15] ✅    ✅ Patient name validation passed
[05:05:15] 🔄 
🔄 Step 3: Processing patient dates...
[05:05:15] [DOC: 9320920] ℹ️  DOB normalized: 04/01/1945
[05:05:15] [DOC: 9320920] ℹ️  Episode startOfEpisode normalized: 04/21/2025
[05:05:15] [DOC: 9320920] ℹ️  Episode endOfEpisode normalized: 06/19/2025
[05:05:15] [DOC: 9320920] ✅ Patient date processing completed successfully
[05:05:15] ✅    ✅ Date processing completed
[05:05:15] 📊 Processed Patient Data
     └─ patientFName: Judith
     └─ patientLName: Mickelson
     └─ dob: 04/01/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA211109044503
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/21/2025', 'endOfEpisode': '06/19/2025', 'firstDiagnosis': 'I10', 'secondDiagnosis': 'Z96.651', 'thirdDiagnosis': 'E11.65', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:05:15] 🔄 
🔄 Step 4: Extracting order data...
[05:05:19] ℹ️  Order extraction - MRN: 'MA211109044503'
[05:05:19] ℹ️  Order extraction - Sex: ''
[05:05:19] ℹ️  Order extraction - Service Line: 'Physical Therapy, Occupational Therapy'
[05:05:19] ℹ️  Order extraction - Payer Source: ''
[05:05:19] ✅ Order data extraction completed successfully
[05:05:19] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:05:19] ℹ️  Using MRN from patient data: 'MA211109044503' over 'MA211109044503'
[05:05:19] ⚠️  Could not determine sex using any available method
[05:05:19] ℹ️  Service line consistent in both sources: 'Physical Therapy, Occupational Therapy'
[05:05:19] ✅ Patient name cross-validation successful
[05:05:19] ✅    ✅ Data merged successfully
[05:05:20] ✅    ✅ Order data extracted and validated
[05:05:20] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:05:25] [DOC: 9320920] ✅ Patient exists in API: Judith Mickelson, ID: 255ec057-36f8-4c73-8255-34510546da0f
[05:05:25] ✅    ✅ Existing patient found with ID: 255ec057-36f8-4c73-8255-34510546da0f
[05:05:25] 🔄 
🔄 Step 6: Pushing order to API...
[05:05:25] [DOC: 9320920] ℹ️  Pushing order via API for patient ID: 255ec057-36f8-4c73-8255-34510546da0f
[05:05:26] [DOC: 9320920] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18775"}
[05:05:26] ❌    ❌ Failed to push order
[05:05:26] 🔄 
🔄 Step 7: Writing to CSV...
[05:05:26] [DOC: 9320920] ℹ️  Calculated age: 80 from DOB: 04/01/1945
[05:05:26] [DOC: 9320920] ℹ️  Service Line extracted: 'Physical Therapy, Occupational Therapy'
[05:05:26] [DOC: 9320920] ℹ️  Payer Source extracted: ''
[05:05:26] [DOC: 9320920] ℹ️  Diagnosis codes being written:
[05:05:26] [DOC: 9320920] ℹ️    - Latest_Episode_Firstdiagnosis: 'I10'
[05:05:26] [DOC: 9320920] ℹ️    - Latest_Episode_Seconddiagnosis: 'Z96.651'
[05:05:26] [DOC: 9320920] ℹ️    - Latest_Episode_Thirddiagnosis: 'E11.65'
[05:05:26] [DOC: 9320920] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:05:26] [DOC: 9320920] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:05:26] [DOC: 9320920] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:05:26] [DOC: 9320920] ✅ Patient data written to CSV: Judith Mickelson | Sex:  | Age: 80 | Service: Physical Therapy, Occupational Therapy | Payer:  | MRN: MA211109044503
[05:05:26] ✅    ✅ Document 9320920 processed and saved successfully
[05:05:26] 🔄 
🔄 Step 8: Saving API details...
[05:05:26] [DOC: 9320920] ℹ️  API push details saved for document 9320920
[05:05:26] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320917                         ║
================================================================================
[05:05:26] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:05:26] ℹ️  Date: 05/30/2025
[05:05:26] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:05:28] [DOC: 9320917] ✅ Text extracted using pdfplumber (1231 chars)
[05:05:28] ✅    ✅ Text extracted using pdfplumber (1231 chars)
[05:05:28] 🔄 
🔄 Step 2: Extracting patient data...
[05:05:31] ℹ️  AI extracted raw sex value: ''
[05:05:31] ℹ️  AI extracted service line: 'Occupational Therapy'
[05:05:31] ℹ️  AI extracted payer source: ''
[05:05:31] ℹ️  AI extracted diagnoses:
[05:05:31] ℹ️    - Diagnosis 1: 'I48.92'
[05:05:31] ℹ️    - Diagnosis 2: 'A08.4'
[05:05:31] ℹ️    - Diagnosis 3: 'J18.9'
[05:05:31] ℹ️    - Diagnosis 4: ''
[05:05:31] ℹ️    - Diagnosis 5: ''
[05:05:31] ℹ️    - Diagnosis 6: ''
[05:05:31] ℹ️  Final extracted MRN: 'MA220722094502'
[05:05:31] ℹ️  Final extracted Sex: ''
[05:05:31] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[05:05:31] ℹ️  Final extracted Payer Source: ''
[05:05:31] ✅ Patient data extraction completed successfully
[05:05:31] ✅    ✅ Patient data extracted successfully
[05:05:31] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': 'I48.92', 'secondDiagnosis': 'A08.4', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:05:31] ✅    ✅ Patient identified: Robert McHale
[05:05:31] ✅    ✅ Patient name validation passed
[05:05:31] 🔄 
🔄 Step 3: Processing patient dates...
[05:05:31] [DOC: 9320917] ℹ️  DOB normalized: 09/12/1945
[05:05:31] [DOC: 9320917] ℹ️  Episode startOfEpisode normalized: 05/12/2025
[05:05:31] [DOC: 9320917] ℹ️  Episode endOfEpisode normalized: 07/10/2025
[05:05:31] [DOC: 9320917] ✅ Patient date processing completed successfully
[05:05:31] ✅    ✅ Date processing completed
[05:05:31] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': 'I48.92', 'secondDiagnosis': 'A08.4', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:05:31] 🔄 
🔄 Step 4: Extracting order data...
[05:05:34] ℹ️  Order extraction - MRN: 'MA220722094502'
[05:05:34] ℹ️  Order extraction - Sex: ''
[05:05:34] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[05:05:34] ℹ️  Order extraction - Payer Source: ''
[05:05:34] ✅ Order data extraction completed successfully
[05:05:34] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:05:34] ℹ️  Using MRN from patient data: 'MA220722094502' over 'MA220722094502'
[05:05:34] ℹ️  Inferred sex as MALE from name: Robert
[05:05:34] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[05:05:34] ✅ Patient name cross-validation successful
[05:05:34] ✅    ✅ Data merged successfully
[05:05:35] ✅    ✅ Order data extracted and validated
[05:05:35] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:05:42] [DOC: 9320917] ℹ️  Patient not found in cache or API: Robert McHale
[05:05:42] [DOC: 9320917] ℹ️  Patient not found, creating new patient via API...
[05:05:42] [DOC: 9320917] ℹ️  Creating patient via API: Robert McHale
[05:05:43] [DOC: 9320917] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:05:43] ❌    ❌ Failed to create patient
[05:05:43] [DOC: 9320917] ℹ️  API push details saved for document 9320917
================================================================================
║                        Processing Document ID: 9320914                         ║
================================================================================
[05:05:43] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:05:43] ℹ️  Date: 05/30/2025
[05:05:43] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:05:46] [DOC: 9320914] ✅ Text extracted using pdfplumber (1307 chars)
[05:05:46] ✅    ✅ Text extracted using pdfplumber (1307 chars)
[05:05:46] 🔄 
🔄 Step 2: Extracting patient data...
[05:05:49] ℹ️  AI extracted raw sex value: ''
[05:05:49] ℹ️  AI extracted service line: 'Physical Therapy'
[05:05:49] ℹ️  AI extracted payer source: ''
[05:05:49] ℹ️  AI extracted diagnoses:
[05:05:49] ℹ️    - Diagnosis 1: 'I48.92'
[05:05:49] ℹ️    - Diagnosis 2: 'A08.4'
[05:05:49] ℹ️    - Diagnosis 3: 'J18.9'
[05:05:49] ℹ️    - Diagnosis 4: ''
[05:05:49] ℹ️    - Diagnosis 5: ''
[05:05:49] ℹ️    - Diagnosis 6: ''
[05:05:49] ℹ️  Final extracted MRN: 'MA220722094502'
[05:05:49] ℹ️  Final extracted Sex: ''
[05:05:49] ℹ️  Final extracted Service Line: 'Physical Therapy'
[05:05:49] ℹ️  Final extracted Payer Source: ''
[05:05:49] ✅ Patient data extraction completed successfully
[05:05:49] ✅    ✅ Patient data extracted successfully
[05:05:49] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': 'I48.92', 'secondDiagnosis': 'A08.4', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:05:49] ✅    ✅ Patient identified: Robert McHale
[05:05:49] ✅    ✅ Patient name validation passed
[05:05:49] 🔄 
🔄 Step 3: Processing patient dates...
[05:05:49] [DOC: 9320914] ℹ️  DOB normalized: 09/12/1945
[05:05:49] [DOC: 9320914] ℹ️  Episode startOfEpisode normalized: 05/12/2025
[05:05:49] [DOC: 9320914] ℹ️  Episode endOfEpisode normalized: 07/10/2025
[05:05:49] [DOC: 9320914] ✅ Patient date processing completed successfully
[05:05:49] ✅    ✅ Date processing completed
[05:05:49] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/12/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': 'I48.92', 'secondDiagnosis': 'A08.4', 'thirdDiagnosis': 'J18.9', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:05:49] 🔄 
🔄 Step 4: Extracting order data...
[05:05:51] ℹ️  Order extraction - MRN: 'MA220722094502'
[05:05:51] ℹ️  Order extraction - Sex: ''
[05:05:51] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[05:05:51] ℹ️  Order extraction - Payer Source: ''
[05:05:51] ✅ Order data extraction completed successfully
[05:05:51] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:05:51] ℹ️  Using MRN from patient data: 'MA220722094502' over 'MA220722094502'
[05:05:51] ℹ️  Inferred sex as MALE from name: Robert
[05:05:51] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[05:05:51] ✅ Patient name cross-validation successful
[05:05:51] ✅    ✅ Data merged successfully
[05:05:52] ✅    ✅ Order data extracted and validated
[05:05:52] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:05:59] [DOC: 9320914] ℹ️  Patient not found in cache or API: Robert McHale
[05:05:59] [DOC: 9320914] ℹ️  Patient not found, creating new patient via API...
[05:05:59] [DOC: 9320914] ℹ️  Creating patient via API: Robert McHale
[05:06:00] [DOC: 9320914] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:06:00] ❌    ❌ Failed to create patient
[05:06:00] [DOC: 9320914] ℹ️  API push details saved for document 9320914
================================================================================
║                        Processing Document ID: 9320913                         ║
================================================================================
[05:06:00] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:06:00] ℹ️  Date: 05/30/2025
[05:06:00] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:06:06] [DOC: 9320913] ✅ Text extracted using pdfplumber (17760 chars)
[05:06:06] ✅    ✅ Text extracted using pdfplumber (17760 chars)
[05:06:06] 🔄 
🔄 Step 2: Extracting patient data...
[05:06:09] ℹ️  AI extracted raw sex value: 'M'
[05:06:09] ℹ️  AI extracted service line: 'PT'
[05:06:09] ℹ️  AI extracted payer source: ''
[05:06:09] ℹ️  AI extracted diagnoses:
[05:06:09] ℹ️    - Diagnosis 1: ''
[05:06:09] ℹ️    - Diagnosis 2: ''
[05:06:09] ℹ️    - Diagnosis 3: ''
[05:06:09] ℹ️    - Diagnosis 4: ''
[05:06:09] ℹ️    - Diagnosis 5: ''
[05:06:09] ℹ️    - Diagnosis 6: ''
[05:06:09] ℹ️  Final extracted MRN: 'MA220722094502'
[05:06:09] ℹ️  Final extracted Sex: 'MALE'
[05:06:09] ℹ️  Final extracted Service Line: 'PT'
[05:06:09] ℹ️  Final extracted Payer Source: ''
[05:06:09] ✅ Patient data extraction completed successfully
[05:06:09] ✅    ✅ Patient data extracted successfully
[05:06:09] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/03/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:06:09] ✅    ✅ Patient identified: Robert McHale
[05:06:09] ✅    ✅ Patient name validation passed
[05:06:09] 🔄 
🔄 Step 3: Processing patient dates...
[05:06:09] [DOC: 9320913] ℹ️  DOB normalized: 09/12/1945
[05:06:09] [DOC: 9320913] ℹ️  Episode startOfEpisode normalized: 01/03/2025
[05:06:09] [DOC: 9320913] ℹ️  Episode endOfEpisode normalized: 07/10/2025
[05:06:09] [DOC: 9320913] ✅ Patient date processing completed successfully
[05:06:09] ✅    ✅ Date processing completed
[05:06:09] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '01/03/2025', 'endOfEpisode': '07/10/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:06:09] 🔄 
🔄 Step 4: Extracting order data...
[05:06:11] ℹ️  Order extraction - MRN: 'MA220722094502'
[05:06:11] ℹ️  Order extraction - Sex: 'MALE'
[05:06:11] ℹ️  Order extraction - Service Line: 'PT'
[05:06:11] ℹ️  Order extraction - Payer Source: ''
[05:06:11] ✅ Order data extraction completed successfully
[05:06:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:06:11] ℹ️  Using MRN from patient data: 'MA220722094502' over 'MA220722094502'
[05:06:11] ℹ️  Service line consistent in both sources: 'PT'
[05:06:11] ✅ Patient name cross-validation successful
[05:06:11] ✅    ✅ Data merged successfully
[05:06:12] ⚠️     ❌ Skipping - missing episode start date
[05:06:12] [DOC: 9320913] ℹ️  API push details saved for document 9320913
================================================================================
║                        Processing Document ID: 9320910                         ║
================================================================================
[05:06:12] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:06:12] ℹ️  Date: 05/30/2025
[05:06:12] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:06:16] [DOC: 9320910] ✅ Text extracted using pdfplumber (11358 chars)
[05:06:16] ✅    ✅ Text extracted using pdfplumber (11358 chars)
[05:06:16] 🔄 
🔄 Step 2: Extracting patient data...
[05:06:19] ℹ️  AI extracted raw sex value: ''
[05:06:19] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:06:19] ℹ️  AI extracted payer source: 'SWH'
[05:06:19] ℹ️  AI extracted diagnoses:
[05:06:19] ℹ️    - Diagnosis 1: 'G20A1'
[05:06:19] ℹ️    - Diagnosis 2: 'I951'
[05:06:19] ℹ️    - Diagnosis 3: ''
[05:06:19] ℹ️    - Diagnosis 4: ''
[05:06:19] ℹ️    - Diagnosis 5: ''
[05:06:19] ℹ️    - Diagnosis 6: ''
[05:06:19] ℹ️  Final extracted MRN: 'MA220722094502'
[05:06:19] ℹ️  Final extracted Sex: ''
[05:06:19] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:06:19] ℹ️  Final extracted Payer Source: 'SWH'
[05:06:19] ✅ Patient data extraction completed successfully
[05:06:19] ✅    ✅ Patient data extracted successfully
[05:06:19] 📊 Patient Response
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'G20A1', 'secondDiagnosis': 'I951', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:06:19] ✅    ✅ Patient identified: Robert McHale
[05:06:19] ✅    ✅ Patient name validation passed
[05:06:19] 🔄 
🔄 Step 3: Processing patient dates...
[05:06:19] [DOC: 9320910] ℹ️  DOB normalized: 09/12/1945
[05:06:19] [DOC: 9320910] ℹ️  Episode startOfEpisode normalized: 03/13/2025
[05:06:19] [DOC: 9320910] ℹ️  Episode endOfEpisode normalized: 05/11/2025
[05:06:19] [DOC: 9320910] ✅ Patient date processing completed successfully
[05:06:19] ✅    ✅ Date processing completed
[05:06:19] 📊 Processed Patient Data
     └─ patientFName: Robert
     └─ patientLName: McHale
     └─ dob: 09/12/1945
     └─ patientSex: 
     └─ medicalRecordNo: MA220722094502
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: SWH
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/13/2025', 'endOfEpisode': '05/11/2025', 'firstDiagnosis': 'G20A1', 'secondDiagnosis': 'I951', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:06:19] 🔄 
🔄 Step 4: Extracting order data...
[05:06:21] ℹ️  Order extraction - MRN: 'MA220722094502'
[05:06:21] ℹ️  Order extraction - Sex: ''
[05:06:21] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:06:21] ℹ️  Order extraction - Payer Source: 'SWH'
[05:06:21] ✅ Order data extraction completed successfully
[05:06:21] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:06:21] ℹ️  Using MRN from patient data: 'MA220722094502' over 'MA220722094502'
[05:06:21] ℹ️  Inferred sex as MALE from name: Robert
[05:06:21] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:06:21] ℹ️  Payer source consistent in both sources: 'SWH'
[05:06:21] ✅ Patient name cross-validation successful
[05:06:21] ✅    ✅ Data merged successfully
[05:06:23] ✅    ✅ Order data extracted and validated
[05:06:23] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:06:29] [DOC: 9320910] ℹ️  Patient not found in cache or API: Robert McHale
[05:06:29] [DOC: 9320910] ℹ️  Patient not found, creating new patient via API...
[05:06:29] [DOC: 9320910] ℹ️  Creating patient via API: Robert McHale
[05:06:30] [DOC: 9320910] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:06:30] ❌    ❌ Failed to create patient
[05:06:30] [DOC: 9320910] ℹ️  API push details saved for document 9320910
================================================================================
║                        Processing Document ID: 9320905                         ║
================================================================================
[05:06:30] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:06:30] ℹ️  Date: 05/30/2025
[05:06:30] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:06:33] [DOC: 9320905] ✅ Text extracted using pdfplumber (15545 chars)
[05:06:33] ✅    ✅ Text extracted using pdfplumber (15545 chars)
[05:06:33] 🔄 
🔄 Step 2: Extracting patient data...
[05:06:36] ℹ️  AI extracted raw sex value: 'M'
[05:06:36] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:06:36] ℹ️  AI extracted payer source: ''
[05:06:36] ℹ️  AI extracted diagnoses:
[05:06:36] ℹ️    - Diagnosis 1: 'I130'
[05:06:36] ℹ️    - Diagnosis 2: 'I5043'
[05:06:36] ℹ️    - Diagnosis 3: ''
[05:06:36] ℹ️    - Diagnosis 4: ''
[05:06:36] ℹ️    - Diagnosis 5: ''
[05:06:36] ℹ️    - Diagnosis 6: ''
[05:06:36] ℹ️  Final extracted MRN: 'MA250306056005'
[05:06:36] ℹ️  Final extracted Sex: 'MALE'
[05:06:36] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:06:36] ℹ️  Final extracted Payer Source: ''
[05:06:36] ✅ Patient data extraction completed successfully
[05:06:36] ✅    ✅ Patient data extracted successfully
[05:06:36] 📊 Patient Response
     └─ patientFName: Frederick
     └─ patientLName: Ellis
     └─ dob: 05/29/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250306056005
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I130', 'secondDiagnosis': 'I5043', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:06:36] ✅    ✅ Patient identified: Frederick Ellis
[05:06:36] ✅    ✅ Patient name validation passed
[05:06:36] 🔄 
🔄 Step 3: Processing patient dates...
[05:06:36] [DOC: 9320905] ℹ️  DOB normalized: 05/29/1960
[05:06:36] [DOC: 9320905] ℹ️  Episode startOfEpisode normalized: 03/11/2025
[05:06:36] [DOC: 9320905] ℹ️  Episode endOfEpisode normalized: 05/09/2025
[05:06:36] [DOC: 9320905] ✅ Patient date processing completed successfully
[05:06:36] ✅    ✅ Date processing completed
[05:06:36] 📊 Processed Patient Data
     └─ patientFName: Frederick
     └─ patientLName: Ellis
     └─ dob: 05/29/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250306056005
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I130', 'secondDiagnosis': 'I5043', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:06:36] 🔄 
🔄 Step 4: Extracting order data...
[05:06:39] ℹ️  Order extraction - MRN: 'MA250306056005'
[05:06:39] ℹ️  Order extraction - Sex: 'MALE'
[05:06:39] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:06:39] ℹ️  Order extraction - Payer Source: ''
[05:06:39] ✅ Order data extraction completed successfully
[05:06:39] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:06:39] ℹ️  Using MRN from patient data: 'MA250306056005' over 'MA250306056005'
[05:06:39] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:06:39] ✅ Patient name cross-validation successful
[05:06:39] ✅    ✅ Data merged successfully
[05:06:40] ✅    ✅ Order data extracted and validated
[05:06:40] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:06:47] [DOC: 9320905] ℹ️  Patient not found in cache or API: Frederick Ellis
[05:06:47] [DOC: 9320905] ℹ️  Patient not found, creating new patient via API...
[05:06:47] [DOC: 9320905] ℹ️  Creating patient via API: Frederick Ellis
[05:06:48] [DOC: 9320905] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:06:48] ❌    ❌ Failed to create patient
[05:06:48] [DOC: 9320905] ℹ️  API push details saved for document 9320905
================================================================================
║                        Processing Document ID: 9320902                         ║
================================================================================
[05:06:48] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:06:48] ℹ️  Date: 05/30/2025
[05:06:48] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:06:51] [DOC: 9320902] ✅ Text extracted using pdfplumber (13970 chars)
[05:06:51] ✅    ✅ Text extracted using pdfplumber (13970 chars)
[05:06:51] 🔄 
🔄 Step 2: Extracting patient data...
[05:06:54] ℹ️  AI extracted raw sex value: 'M'
[05:06:54] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:06:54] ℹ️  AI extracted payer source: 'None'
[05:06:54] ℹ️  AI extracted diagnoses:
[05:06:54] ℹ️    - Diagnosis 1: 'I130'
[05:06:54] ℹ️    - Diagnosis 2: 'I5022'
[05:06:54] ℹ️    - Diagnosis 3: 'None'
[05:06:54] ℹ️    - Diagnosis 4: 'None'
[05:06:54] ℹ️    - Diagnosis 5: 'None'
[05:06:54] ℹ️    - Diagnosis 6: 'None'
[05:06:54] ℹ️  Final extracted MRN: 'MA250306056005'
[05:06:54] ℹ️  Final extracted Sex: 'MALE'
[05:06:54] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:06:54] ℹ️  Final extracted Payer Source: ''
[05:06:54] ✅ Patient data extraction completed successfully
[05:06:54] ✅    ✅ Patient data extracted successfully
[05:06:54] 📊 Patient Response
     └─ patientFName: Frederick
     └─ patientLName: Ellis
     └─ dob: 05/29/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250306056005
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I130', 'secondDiagnosis': 'I5022', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:06:54] ✅    ✅ Patient identified: Frederick Ellis
[05:06:54] ✅    ✅ Patient name validation passed
[05:06:54] 🔄 
🔄 Step 3: Processing patient dates...
[05:06:54] [DOC: 9320902] ℹ️  DOB normalized: 05/29/1960
[05:06:54] [DOC: 9320902] ℹ️  Episode startOfEpisode normalized: 03/11/2025
[05:06:54] [DOC: 9320902] ℹ️  Episode endOfEpisode normalized: 05/09/2025
[05:06:54] [DOC: 9320902] ✅ Patient date processing completed successfully
[05:06:54] ✅    ✅ Date processing completed
[05:06:54] 📊 Processed Patient Data
     └─ patientFName: Frederick
     └─ patientLName: Ellis
     └─ dob: 05/29/1960
     └─ patientSex: MALE
     └─ medicalRecordNo: MA250306056005
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/11/2025', 'endOfEpisode': '05/09/2025', 'firstDiagnosis': 'I130', 'secondDiagnosis': 'I5022'}]
[05:06:54] 🔄 
🔄 Step 4: Extracting order data...
[05:06:56] ℹ️  Order extraction - MRN: 'MA250306056005'
[05:06:56] ℹ️  Order extraction - Sex: 'MALE'
[05:06:56] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:06:56] ℹ️  Order extraction - Payer Source: ''
[05:06:56] ✅ Order data extraction completed successfully
[05:06:56] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:06:56] ℹ️  Using MRN from patient data: 'MA250306056005' over 'MA250306056005'
[05:06:56] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:06:56] ✅ Patient name cross-validation successful
[05:06:56] ✅    ✅ Data merged successfully
[05:06:57] ✅    ✅ Order data extracted and validated
[05:06:57] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:07:06] [DOC: 9320902] ℹ️  Patient not found in cache or API: Frederick Ellis
[05:07:06] [DOC: 9320902] ℹ️  Patient not found, creating new patient via API...
[05:07:06] [DOC: 9320902] ℹ️  Creating patient via API: Frederick Ellis
[05:07:08] [DOC: 9320902] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:07:08] ❌    ❌ Failed to create patient
[05:07:08] [DOC: 9320902] ℹ️  API push details saved for document 9320902
================================================================================
║                        Processing Document ID: 9320900                         ║
================================================================================
[05:07:08] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:07:08] ℹ️  Date: 05/30/2025
[05:07:08] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:07:10] [DOC: 9320900] ✅ Text extracted using pdfplumber (1281 chars)
[05:07:10] ✅    ✅ Text extracted using pdfplumber (1281 chars)
[05:07:10] 🔄 
🔄 Step 2: Extracting patient data...
[05:07:13] ℹ️  AI extracted raw sex value: ''
[05:07:13] ℹ️  AI extracted service line: 'Occupational Therapy'
[05:07:13] ℹ️  AI extracted payer source: ''
[05:07:13] ℹ️  AI extracted diagnoses:
[05:07:13] ℹ️    - Diagnosis 1: 'J96.21'
[05:07:13] ℹ️    - Diagnosis 2: 'J96.22'
[05:07:13] ℹ️    - Diagnosis 3: 'J44.1'
[05:07:13] ℹ️    - Diagnosis 4: 'None'
[05:07:13] ℹ️    - Diagnosis 5: 'None'
[05:07:13] ℹ️    - Diagnosis 6: 'None'
[05:07:13] ℹ️  Final extracted MRN: 'MA240910054401'
[05:07:13] ℹ️  Final extracted Sex: ''
[05:07:13] ℹ️  Final extracted Service Line: 'Occupational Therapy'
[05:07:13] ℹ️  Final extracted Payer Source: ''
[05:07:13] ✅ Patient data extraction completed successfully
[05:07:13] ✅    ✅ Patient data extracted successfully
[05:07:13] 📊 Patient Response
     └─ patientFName: Val
     └─ patientLName: Cardoso Brito
     └─ dob: 05/30/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA240910054401
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'J96.21', 'secondDiagnosis': 'J96.22', 'thirdDiagnosis': 'J44.1', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:07:13] ✅    ✅ Patient identified: Val Cardoso Brito
[05:07:13] ✅    ✅ Patient name validation passed
[05:07:13] 🔄 
🔄 Step 3: Processing patient dates...
[05:07:13] [DOC: 9320900] ℹ️  DOB normalized: 05/30/1944
[05:07:13] [DOC: 9320900] ℹ️  Episode startOfEpisode normalized: 03/25/2025
[05:07:13] [DOC: 9320900] ℹ️  Episode endOfEpisode normalized: 05/23/2025
[05:07:13] [DOC: 9320900] ✅ Patient date processing completed successfully
[05:07:13] ✅    ✅ Date processing completed
[05:07:13] 📊 Processed Patient Data
     └─ patientFName: Val
     └─ patientLName: Cardoso Brito
     └─ dob: 05/30/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA240910054401
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/25/2025', 'endOfEpisode': '05/23/2025', 'firstDiagnosis': 'J96.21', 'secondDiagnosis': 'J96.22', 'thirdDiagnosis': 'J44.1'}]
[05:07:13] 🔄 
🔄 Step 4: Extracting order data...
[05:07:16] ℹ️  Order extraction - MRN: 'MA240910054401'
[05:07:16] ℹ️  Order extraction - Sex: ''
[05:07:16] ℹ️  Order extraction - Service Line: 'Occupational Therapy'
[05:07:16] ℹ️  Order extraction - Payer Source: ''
[05:07:16] ✅ Order data extraction completed successfully
[05:07:16] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:07:16] ℹ️  Using MRN from patient data: 'MA240910054401' over 'MA240910054401'
[05:07:16] ⚠️  Could not determine sex using any available method
[05:07:16] ℹ️  Service line consistent in both sources: 'Occupational Therapy'
[05:07:16] ✅ Patient name cross-validation successful
[05:07:16] ✅    ✅ Data merged successfully
[05:07:17] ✅    ✅ Order data extracted and validated
[05:07:17] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:07:23] [DOC: 9320900] ✅ Patient exists in API: Val Cardoso Brito, ID: 4e55c20a-8dbf-4602-8d02-b84e4cba0438
[05:07:23] ✅    ✅ Existing patient found with ID: 4e55c20a-8dbf-4602-8d02-b84e4cba0438
[05:07:23] 🔄 
🔄 Step 6: Pushing order to API...
[05:07:23] [DOC: 9320900] ℹ️  Pushing order via API for patient ID: 4e55c20a-8dbf-4602-8d02-b84e4cba0438
[05:07:24] [DOC: 9320900] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18782"}
[05:07:24] ❌    ❌ Failed to push order
[05:07:24] 🔄 
🔄 Step 7: Writing to CSV...
[05:07:24] [DOC: 9320900] ℹ️  Calculated age: 81 from DOB: 05/30/1944
[05:07:24] [DOC: 9320900] ℹ️  Service Line extracted: 'Occupational Therapy'
[05:07:24] [DOC: 9320900] ℹ️  Payer Source extracted: ''
[05:07:24] [DOC: 9320900] ℹ️  Diagnosis codes being written:
[05:07:24] [DOC: 9320900] ℹ️    - Latest_Episode_Firstdiagnosis: 'J96.21'
[05:07:24] [DOC: 9320900] ℹ️    - Latest_Episode_Seconddiagnosis: 'J96.22'
[05:07:24] [DOC: 9320900] ℹ️    - Latest_Episode_Thirddiagnosis: 'J44.1'
[05:07:24] [DOC: 9320900] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:07:24] [DOC: 9320900] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:07:24] [DOC: 9320900] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:07:24] [DOC: 9320900] ✅ Patient data written to CSV: Val Cardoso Brito | Sex:  | Age: 81 | Service: Occupational Therapy | Payer:  | MRN: MA240910054401
[05:07:24] ✅    ✅ Document 9320900 processed and saved successfully
[05:07:24] 🔄 
🔄 Step 8: Saving API details...
[05:07:24] [DOC: 9320900] ℹ️  API push details saved for document 9320900
[05:07:24] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320895                         ║
================================================================================
[05:07:24] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:07:24] ℹ️  Date: 05/30/2025
[05:07:24] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:07:30] [DOC: 9320895] ✅ Text extracted using pdfplumber (19073 chars)
[05:07:30] ✅    ✅ Text extracted using pdfplumber (19073 chars)
[05:07:30] 🔄 
🔄 Step 2: Extracting patient data...
[05:07:33] ℹ️  AI extracted raw sex value: 'M'
[05:07:33] ℹ️  AI extracted service line: 'OT'
[05:07:33] ℹ️  AI extracted payer source: ''
[05:07:33] ℹ️  AI extracted diagnoses:
[05:07:33] ℹ️    - Diagnosis 1: 'hypoxia'
[05:07:33] ℹ️    - Diagnosis 2: 'Weakness'
[05:07:33] ℹ️    - Diagnosis 3: 'morbid obesity'
[05:07:33] ℹ️    - Diagnosis 4: 'hernia'
[05:07:33] ℹ️    - Diagnosis 5: 'pneumonia'
[05:07:33] ℹ️    - Diagnosis 6: 'acute respiratory failure'
[05:07:33] ℹ️  Final extracted MRN: '1270089757'
[05:07:33] ℹ️  Final extracted Sex: 'MALE'
[05:07:33] ℹ️  Final extracted Service Line: 'OT'
[05:07:33] ℹ️  Final extracted Payer Source: ''
[05:07:33] ✅ Patient data extraction completed successfully
[05:07:33] ✅    ✅ Patient data extracted successfully
[05:07:33] 📊 Patient Response
     └─ patientFName: Val
     └─ patientLName: Cardoso Brito
     └─ dob: 05/30/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 1270089757
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/11/2025', 'startOfEpisode': '03/11/2025', 'endOfEpisode': None, 'firstDiagnosis': 'hypoxia', 'secondDiagnosis': 'Weakness', 'thirdDiagnosis': 'morbid obesity', 'fourthDiagnosis': 'hernia', 'fifthDiagnosis': 'pneumonia', 'sixthDiagnosis': 'acute respiratory failure'}]
[05:07:33] ✅    ✅ Patient identified: Val Cardoso Brito
[05:07:33] ✅    ✅ Patient name validation passed
[05:07:33] 🔄 
🔄 Step 3: Processing patient dates...
[05:07:33] [DOC: 9320895] ℹ️  DOB normalized: 05/30/1944
[05:07:33] [DOC: 9320895] ℹ️  Episode startOfCare normalized: 03/11/2025
[05:07:33] [DOC: 9320895] ℹ️  Episode startOfEpisode normalized: 03/11/2025
[05:07:33] [DOC: 9320895] ✅ Patient date processing completed successfully
[05:07:33] ✅    ✅ Date processing completed
[05:07:33] 📊 Processed Patient Data
     └─ patientFName: Val
     └─ patientLName: Cardoso Brito
     └─ dob: 05/30/1944
     └─ patientSex: MALE
     └─ medicalRecordNo: 1270089757
     └─ billingProvider: Nightingale Visiting Nurses
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '03/11/2025', 'startOfEpisode': '03/11/2025', 'firstDiagnosis': 'hypoxia', 'secondDiagnosis': 'Weakness', 'thirdDiagnosis': 'morbid obesity', 'fourthDiagnosis': 'hernia', 'fifthDiagnosis': 'pneumonia', 'sixthDiagnosis': 'acute respiratory failure'}]
[05:07:33] 🔄 
🔄 Step 4: Extracting order data...
[05:07:36] ℹ️  Order extraction - MRN: 'MA240910054401'
[05:07:36] ℹ️  Order extraction - Sex: 'MALE'
[05:07:36] ℹ️  Order extraction - Service Line: 'OT'
[05:07:36] ℹ️  Order extraction - Payer Source: ''
[05:07:36] ✅ Order data extraction completed successfully
[05:07:36] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:07:36] ℹ️  Using longer MRN from order data: 'MA240910054401' over '1270089757'
[05:07:36] ℹ️  Service line consistent in both sources: 'OT'
[05:07:36] ✅ Patient name cross-validation successful
[05:07:36] ✅    ✅ Data merged successfully
[05:07:37] ⚠️     ❌ Skipping - missing episode start date
[05:07:37] [DOC: 9320895] ℹ️  API push details saved for document 9320895
================================================================================
║                        Processing Document ID: 9320894                         ║
================================================================================
[05:07:37] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:07:37] ℹ️  Date: 05/30/2025
[05:07:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:07:41] [DOC: 9320894] ✅ Text extracted using pdfplumber (12085 chars)
[05:07:41] ✅    ✅ Text extracted using pdfplumber (12085 chars)
[05:07:41] 🔄 
🔄 Step 2: Extracting patient data...
[05:07:44] ℹ️  AI extracted raw sex value: 'F'
[05:07:44] ℹ️  AI extracted service line: 'OT'
[05:07:44] ℹ️  AI extracted payer source: ''
[05:07:44] ℹ️  AI extracted diagnoses:
[05:07:44] ℹ️    - Diagnosis 1: 'Polyosteoarthritis'
[05:07:44] ℹ️    - Diagnosis 2: 'DM 2'
[05:07:44] ℹ️    - Diagnosis 3: ''
[05:07:44] ℹ️    - Diagnosis 4: ''
[05:07:44] ℹ️    - Diagnosis 5: ''
[05:07:44] ℹ️    - Diagnosis 6: ''
[05:07:44] ℹ️  Final extracted MRN: 'MA210910032501'
[05:07:44] ℹ️  Final extracted Sex: 'FEMALE'
[05:07:44] ℹ️  Final extracted Service Line: 'OT'
[05:07:44] ℹ️  Final extracted Payer Source: ''
[05:07:44] ✅ Patient data extraction completed successfully
[05:07:44] ✅    ✅ Patient data extracted successfully
[05:07:44] 📊 Patient Response
     └─ patientFName: Elizabeth
     └─ patientLName: Amaral
     └─ dob: 03/31/1925
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210910032501
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'Polyosteoarthritis', 'secondDiagnosis': 'DM 2', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:07:44] ✅    ✅ Patient identified: Elizabeth Amaral
[05:07:44] ✅    ✅ Patient name validation passed
[05:07:44] 🔄 
🔄 Step 3: Processing patient dates...
[05:07:44] [DOC: 9320894] ℹ️  DOB normalized: 03/31/1925
[05:07:44] [DOC: 9320894] ✅ Patient date processing completed successfully
[05:07:44] ✅    ✅ Date processing completed
[05:07:44] 📊 Processed Patient Data
     └─ patientFName: Elizabeth
     └─ patientLName: Amaral
     └─ dob: 03/31/1925
     └─ patientSex: FEMALE
     └─ medicalRecordNo: MA210910032501
     └─ billingProvider: Dr. Will, Christine A.
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': 'Polyosteoarthritis', 'secondDiagnosis': 'DM 2', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:07:44] 🔄 
🔄 Step 4: Extracting order data...
[05:07:46] ℹ️  Order extraction - MRN: 'MA210910032501'
[05:07:46] ℹ️  Order extraction - Sex: 'FEMALE'
[05:07:46] ℹ️  Order extraction - Service Line: 'OT'
[05:07:46] ℹ️  Order extraction - Payer Source: ''
[05:07:46] ✅ Order data extraction completed successfully
[05:07:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:07:46] ℹ️  Using MRN from patient data: 'MA210910032501' over 'MA210910032501'
[05:07:46] ℹ️  Service line consistent in both sources: 'OT'
[05:07:46] ✅ Patient name cross-validation successful
[05:07:46] ✅    ✅ Data merged successfully
[05:07:47] ✅    ✅ Order data extracted and validated
[05:07:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:07:54] [DOC: 9320894] ✅ Patient exists in API: Elizabeth Amaral, ID: 5d52677a-611c-45f6-bcba-ca9901b3761d
[05:07:54] ✅    ✅ Existing patient found with ID: 5d52677a-611c-45f6-bcba-ca9901b3761d
[05:07:54] 🔄 
🔄 Step 6: Pushing order to API...
[05:07:54] [DOC: 9320894] ℹ️  Pushing order via API for patient ID: 5d52677a-611c-45f6-bcba-ca9901b3761d
[05:07:55] [DOC: 9320894] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:07:55] ❌    ❌ Failed to push order
[05:07:55] 🔄 
🔄 Step 7: Writing to CSV...
[05:07:55] [DOC: 9320894] ℹ️  Calculated age: 100 from DOB: 03/31/1925
[05:07:55] [DOC: 9320894] ℹ️  Service Line extracted: 'OT'
[05:07:55] [DOC: 9320894] ℹ️  Payer Source extracted: ''
[05:07:55] [DOC: 9320894] ℹ️  Diagnosis codes being written:
[05:07:55] [DOC: 9320894] ℹ️    - Latest_Episode_Firstdiagnosis: 'Polyosteoarthritis'
[05:07:55] [DOC: 9320894] ℹ️    - Latest_Episode_Seconddiagnosis: 'DM 2'
[05:07:55] [DOC: 9320894] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:07:55] [DOC: 9320894] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:07:55] [DOC: 9320894] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:07:55] [DOC: 9320894] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:07:55] [DOC: 9320894] ✅ Patient data written to CSV: Elizabeth Amaral | Sex: FEMALE | Age: 100 | Service: OT | Payer:  | MRN: MA210910032501
[05:07:55] ✅    ✅ Document 9320894 processed and saved successfully
[05:07:55] 🔄 
🔄 Step 8: Saving API details...
[05:07:55] [DOC: 9320894] ℹ️  API push details saved for document 9320894
[05:07:55] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320893                         ║
================================================================================
[05:07:55] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:07:55] ℹ️  Date: 05/30/2025
[05:07:55] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:07:57] [DOC: 9320893] ✅ Text extracted using pdfplumber (1341 chars)
[05:07:57] ✅    ✅ Text extracted using pdfplumber (1341 chars)
[05:07:57] 🔄 
🔄 Step 2: Extracting patient data...
[05:08:00] ℹ️  AI extracted raw sex value: ''
[05:08:00] ℹ️  AI extracted service line: 'Physical Therapy'
[05:08:00] ℹ️  AI extracted payer source: ''
[05:08:00] ℹ️  AI extracted diagnoses:
[05:08:00] ℹ️    - Diagnosis 1: 'M81.0'
[05:08:00] ℹ️    - Diagnosis 2: 'F41.9'
[05:08:00] ℹ️    - Diagnosis 3: 'I10'
[05:08:00] ℹ️    - Diagnosis 4: ''
[05:08:00] ℹ️    - Diagnosis 5: ''
[05:08:00] ℹ️    - Diagnosis 6: ''
[05:08:00] ℹ️  Final extracted MRN: 'MA210910032501'
[05:08:00] ℹ️  Final extracted Sex: ''
[05:08:00] ℹ️  Final extracted Service Line: 'Physical Therapy'
[05:08:00] ℹ️  Final extracted Payer Source: ''
[05:08:00] ✅ Patient data extraction completed successfully
[05:08:00] ✅    ✅ Patient data extracted successfully
[05:08:00] 📊 Patient Response
     └─ patientFName: Elizabeth
     └─ patientLName: Amaral
     └─ dob: 03/31/1925
     └─ patientSex: 
     └─ medicalRecordNo: MA210910032501
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'M81.0', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:08:00] ✅    ✅ Patient identified: Elizabeth Amaral
[05:08:00] ✅    ✅ Patient name validation passed
[05:08:00] 🔄 
🔄 Step 3: Processing patient dates...
[05:08:00] [DOC: 9320893] ℹ️  DOB normalized: 03/31/1925
[05:08:00] [DOC: 9320893] ℹ️  Episode startOfEpisode normalized: 04/15/2025
[05:08:00] [DOC: 9320893] ℹ️  Episode endOfEpisode normalized: 06/13/2025
[05:08:00] [DOC: 9320893] ✅ Patient date processing completed successfully
[05:08:00] ✅    ✅ Date processing completed
[05:08:00] 📊 Processed Patient Data
     └─ patientFName: Elizabeth
     └─ patientLName: Amaral
     └─ dob: 03/31/1925
     └─ patientSex: 
     └─ medicalRecordNo: MA210910032501
     └─ billingProvider: CHRISTINE WILL MD
     └─ npi: 1760458632
     └─ physicianNPI: 1760458632
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Physical Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/15/2025', 'endOfEpisode': '06/13/2025', 'firstDiagnosis': 'M81.0', 'secondDiagnosis': 'F41.9', 'thirdDiagnosis': 'I10', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:08:00] 🔄 
🔄 Step 4: Extracting order data...
[05:08:03] ℹ️  Order extraction - MRN: 'MA210910032501'
[05:08:03] ℹ️  Order extraction - Sex: ''
[05:08:03] ℹ️  Order extraction - Service Line: 'Physical Therapy'
[05:08:03] ℹ️  Order extraction - Payer Source: ''
[05:08:03] ✅ Order data extraction completed successfully
[05:08:03] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:08:03] ℹ️  Using MRN from patient data: 'MA210910032501' over 'MA210910032501'
[05:08:03] ℹ️  Inferred sex as FEMALE from name: Elizabeth
[05:08:03] ℹ️  Service line consistent in both sources: 'Physical Therapy'
[05:08:03] ✅ Patient name cross-validation successful
[05:08:03] ✅    ✅ Data merged successfully
[05:08:04] ✅    ✅ Order data extracted and validated
[05:08:04] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:08:04] [DOC: 9320893] ✅ Patient found in local cache: Elizabeth Amaral, ID: 5d52677a-611c-45f6-bcba-ca9901b3761d
[05:08:04] ✅    ✅ Existing patient found with ID: 5d52677a-611c-45f6-bcba-ca9901b3761d
[05:08:04] 🔄 
🔄 Step 6: Pushing order to API...
[05:08:04] [DOC: 9320893] ℹ️  Pushing order via API for patient ID: 5d52677a-611c-45f6-bcba-ca9901b3761d
[05:08:05] [DOC: 9320893] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18792"}
[05:08:05] ❌    ❌ Failed to push order
[05:08:05] 🔄 
🔄 Step 7: Writing to CSV...
[05:08:05] [DOC: 9320893] ℹ️  Calculated age: 100 from DOB: 03/31/1925
[05:08:05] [DOC: 9320893] ℹ️  Service Line extracted: 'Physical Therapy'
[05:08:05] [DOC: 9320893] ℹ️  Payer Source extracted: ''
[05:08:05] [DOC: 9320893] ℹ️  Diagnosis codes being written:
[05:08:05] [DOC: 9320893] ℹ️    - Latest_Episode_Firstdiagnosis: 'M81.0'
[05:08:05] [DOC: 9320893] ℹ️    - Latest_Episode_Seconddiagnosis: 'F41.9'
[05:08:05] [DOC: 9320893] ℹ️    - Latest_Episode_Thirddiagnosis: 'I10'
[05:08:05] [DOC: 9320893] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:08:05] [DOC: 9320893] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:08:05] [DOC: 9320893] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:08:05] [DOC: 9320893] ✅ Patient data written to CSV: Elizabeth Amaral | Sex: FEMALE | Age: 100 | Service: Physical Therapy | Payer:  | MRN: MA210910032501
[05:08:05] ✅    ✅ Document 9320893 processed and saved successfully
[05:08:05] 🔄 
🔄 Step 8: Saving API details...
[05:08:05] [DOC: 9320893] ℹ️  API push details saved for document 9320893
[05:08:05] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320687                         ║
================================================================================
[05:08:05] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:08:05] ℹ️  Date: 05/30/2025
[05:08:05] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:08:09] [DOC: 9320687] ✅ Text extracted using pdfplumber (13135 chars)
[05:08:09] ✅    ✅ Text extracted using pdfplumber (13135 chars)
[05:08:09] 🔄 
🔄 Step 2: Extracting patient data...
[05:08:12] ℹ️  AI extracted raw sex value: ''
[05:08:12] ℹ️  AI extracted service line: 'PT'
[05:08:12] ℹ️  AI extracted payer source: ''
[05:08:12] ℹ️  AI extracted diagnoses:
[05:08:12] ℹ️    - Diagnosis 1: 'E11.9'
[05:08:12] ℹ️    - Diagnosis 2: 'None'
[05:08:12] ℹ️    - Diagnosis 3: 'None'
[05:08:12] ℹ️    - Diagnosis 4: 'None'
[05:08:12] ℹ️    - Diagnosis 5: 'None'
[05:08:12] ℹ️    - Diagnosis 6: 'None'
[05:08:12] ℹ️  Final extracted MRN: 'MA220126074307'
[05:08:12] ℹ️  Final extracted Sex: ''
[05:08:12] ℹ️  Final extracted Service Line: 'PT'
[05:08:12] ℹ️  Final extracted Payer Source: ''
[05:08:12] ✅ Patient data extraction completed successfully
[05:08:12] ✅    ✅ Patient data extracted successfully
[05:08:12] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': 'E11.9', 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:08:12] ✅    ✅ Patient identified: Manuel Furtado
[05:08:12] ✅    ✅ Patient name validation passed
[05:08:12] 🔄 
🔄 Step 3: Processing patient dates...
[05:08:12] [DOC: 9320687] ℹ️  DOB normalized: 07/13/1943
[05:08:12] [DOC: 9320687] ✅ Patient date processing completed successfully
[05:08:12] ✅    ✅ Date processing completed
[05:08:12] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: 
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: 
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'firstDiagnosis': 'E11.9'}]
[05:08:12] 🔄 
🔄 Step 4: Extracting order data...
[05:08:15] ℹ️  Order extraction - MRN: 'MA220126074307'
[05:08:15] ℹ️  Order extraction - Sex: 'MALE'
[05:08:15] ℹ️  Order extraction - Service Line: 'PT'
[05:08:15] ℹ️  Order extraction - Payer Source: ''
[05:08:15] ✅ Order data extraction completed successfully
[05:08:15] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:08:15] ℹ️  Using MRN from patient data: 'MA220126074307' over 'MA220126074307'
[05:08:15] ℹ️  Service line consistent in both sources: 'PT'
[05:08:15] ✅ Patient name cross-validation successful
[05:08:15] ✅    ✅ Data merged successfully
[05:08:16] ✅    ✅ Order data extracted and validated
[05:08:16] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:08:23] [DOC: 9320687] ✅ Patient exists in API: Manuel Furtado, ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[05:08:23] ✅    ✅ Existing patient found with ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[05:08:23] 🔄 
🔄 Step 6: Pushing order to API...
[05:08:23] [DOC: 9320687] ℹ️  Pushing order via API for patient ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[05:08:25] [DOC: 9320687] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:08:25] ❌    ❌ Failed to push order
[05:08:25] 🔄 
🔄 Step 7: Writing to CSV...
[05:08:25] [DOC: 9320687] ℹ️  Calculated age: 81 from DOB: 07/13/1943
[05:08:25] [DOC: 9320687] ℹ️  Service Line extracted: 'PT'
[05:08:25] [DOC: 9320687] ℹ️  Payer Source extracted: ''
[05:08:25] [DOC: 9320687] ℹ️  Diagnosis codes being written:
[05:08:25] [DOC: 9320687] ℹ️    - Latest_Episode_Firstdiagnosis: 'E11.9'
[05:08:25] [DOC: 9320687] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:08:25] [DOC: 9320687] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:08:25] [DOC: 9320687] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:08:25] [DOC: 9320687] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:08:25] [DOC: 9320687] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:08:25] [DOC: 9320687] ✅ Patient data written to CSV: Manuel Furtado | Sex: MALE | Age: 81 | Service: PT | Payer:  | MRN: MA220126074307
[05:08:25] ✅    ✅ Document 9320687 processed and saved successfully
[05:08:25] 🔄 
🔄 Step 8: Saving API details...
[05:08:25] [DOC: 9320687] ℹ️  API push details saved for document 9320687
[05:08:25] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320684                         ║
================================================================================
[05:08:25] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:08:25] ℹ️  Date: 05/30/2025
[05:08:25] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:08:30] [DOC: 9320684] ✅ Text extracted using pdfplumber (10253 chars)
[05:08:30] ✅    ✅ Text extracted using pdfplumber (10253 chars)
[05:08:30] 🔄 
🔄 Step 2: Extracting patient data...
[05:08:32] ℹ️  AI extracted raw sex value: 'M'
[05:08:32] ℹ️  AI extracted service line: 'OT'
[05:08:32] ℹ️  AI extracted payer source: 'None'
[05:08:32] ℹ️  AI extracted diagnoses:
[05:08:32] ℹ️    - Diagnosis 1: 'None'
[05:08:32] ℹ️    - Diagnosis 2: 'None'
[05:08:32] ℹ️    - Diagnosis 3: 'None'
[05:08:32] ℹ️    - Diagnosis 4: 'None'
[05:08:32] ℹ️    - Diagnosis 5: 'None'
[05:08:32] ℹ️    - Diagnosis 6: 'None'
[05:08:32] ℹ️  Final extracted MRN: 'MA220126074307'
[05:08:32] ℹ️  Final extracted Sex: 'MALE'
[05:08:32] ℹ️  Final extracted Service Line: 'OT'
[05:08:32] ℹ️  Final extracted Payer Source: ''
[05:08:32] ✅ Patient data extraction completed successfully
[05:08:32] ✅    ✅ Patient data extracted successfully
[05:08:32] 📊 Patient Response
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220126074307
     └─ billingProvider: None
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '05/19/2025', 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:08:32] ✅    ✅ Patient identified: Manuel Furtado
[05:08:32] ✅    ✅ Patient name validation passed
[05:08:32] 🔄 
🔄 Step 3: Processing patient dates...
[05:08:32] [DOC: 9320684] ℹ️  DOB normalized: 07/13/1943
[05:08:32] [DOC: 9320684] ℹ️  Episode startOfEpisode normalized: 05/19/2025
[05:08:32] [DOC: 9320684] ✅ Patient date processing completed successfully
[05:08:32] ✅    ✅ Date processing completed
[05:08:32] 📊 Processed Patient Data
     └─ patientFName: Manuel
     └─ patientLName: Furtado
     └─ dob: 07/13/1943
     └─ patientSex: MALE
     └─ medicalRecordNo: MA220126074307
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: OT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/19/2025'}]
[05:08:32] 🔄 
🔄 Step 4: Extracting order data...
[05:08:35] ℹ️  Order extraction - MRN: 'MA220126074307'
[05:08:35] ℹ️  Order extraction - Sex: 'MALE'
[05:08:35] ℹ️  Order extraction - Service Line: 'OT'
[05:08:35] ℹ️  Order extraction - Payer Source: ''
[05:08:35] ✅ Order data extraction completed successfully
[05:08:35] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:08:35] ℹ️  Using MRN from patient data: 'MA220126074307' over 'MA220126074307'
[05:08:35] ℹ️  Service line consistent in both sources: 'OT'
[05:08:35] ✅ Patient name cross-validation successful
[05:08:35] ✅    ✅ Data merged successfully
[05:08:36] ✅    ✅ Order data extracted and validated
[05:08:36] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:08:36] [DOC: 9320684] ✅ Patient found in local cache: Manuel Furtado, ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[05:08:36] ✅    ✅ Existing patient found with ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[05:08:36] 🔄 
🔄 Step 6: Pushing order to API...
[05:08:36] [DOC: 9320684] ℹ️  Pushing order via API for patient ID: 7f81226b-afe2-4c3f-ad44-3253bdc3b1b8
[05:08:37] [DOC: 9320684] ❌ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[05:08:37] ❌    ❌ Failed to push order
[05:08:37] 🔄 
🔄 Step 7: Writing to CSV...
[05:08:37] [DOC: 9320684] ℹ️  Calculated age: 81 from DOB: 07/13/1943
[05:08:37] [DOC: 9320684] ℹ️  Service Line extracted: 'OT'
[05:08:37] [DOC: 9320684] ℹ️  Payer Source extracted: ''
[05:08:37] [DOC: 9320684] ℹ️  Diagnosis codes being written:
[05:08:37] [DOC: 9320684] ℹ️    - Latest_Episode_Firstdiagnosis: ''
[05:08:37] [DOC: 9320684] ℹ️    - Latest_Episode_Seconddiagnosis: ''
[05:08:37] [DOC: 9320684] ℹ️    - Latest_Episode_Thirddiagnosis: ''
[05:08:37] [DOC: 9320684] ℹ️    - Latest_Episode_Fourthdiagnosis: ''
[05:08:37] [DOC: 9320684] ℹ️    - Latest_Episode_Fifthdiagnosis: ''
[05:08:37] [DOC: 9320684] ℹ️    - Latest_Episode_Sixthdiagnosis: ''
[05:08:37] [DOC: 9320684] ✅ Patient data written to CSV: Manuel Furtado | Sex: MALE | Age: 81 | Service: OT | Payer:  | MRN: MA220126074307
[05:08:37] ✅    ✅ Document 9320684 processed and saved successfully
[05:08:37] 🔄 
🔄 Step 8: Saving API details...
[05:08:37] [DOC: 9320684] ℹ️  API push details saved for document 9320684
[05:08:37] ✅    ✅ API details saved
================================================================================
║                        Processing Document ID: 9320634                         ║
================================================================================
[05:08:37] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:08:37] ℹ️  Date: 05/30/2025
[05:08:37] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:08:41] [DOC: 9320634] ✅ Text extracted using pdfplumber (1510 chars)
[05:08:41] ✅    ✅ Text extracted using pdfplumber (1510 chars)
[05:08:41] 🔄 
🔄 Step 2: Extracting patient data...
[05:08:43] ℹ️  AI extracted raw sex value: ''
[05:08:43] ℹ️  AI extracted service line: 'Skilled Nursing'
[05:08:43] ℹ️  AI extracted payer source: ''
[05:08:43] ℹ️  AI extracted diagnoses:
[05:08:43] ℹ️    - Diagnosis 1: 'F39'
[05:08:43] ℹ️    - Diagnosis 2: 'F32.A'
[05:08:43] ℹ️    - Diagnosis 3: 'E11.42'
[05:08:43] ℹ️    - Diagnosis 4: ''
[05:08:43] ℹ️    - Diagnosis 5: ''
[05:08:43] ℹ️    - Diagnosis 6: ''
[05:08:43] ℹ️  Final extracted MRN: 'MA221103064405'
[05:08:43] ℹ️  Final extracted Sex: ''
[05:08:43] ℹ️  Final extracted Service Line: 'Skilled Nursing'
[05:08:43] ℹ️  Final extracted Payer Source: ''
[05:08:43] ✅ Patient data extraction completed successfully
[05:08:43] ✅    ✅ Patient data extracted successfully
[05:08:43] 📊 Patient Response
     └─ patientFName: Marie
     └─ patientLName: Mendoza
     └─ dob: 06/25/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221103064405
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '04/22/2025', 'endOfEpisode': '06/20/2025', 'firstDiagnosis': 'F39', 'secondDiagnosis': 'F32.A', 'thirdDiagnosis': 'E11.42', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:08:43] ✅    ✅ Patient identified: Marie Mendoza
[05:08:43] ✅    ✅ Patient name validation passed
[05:08:43] 🔄 
🔄 Step 3: Processing patient dates...
[05:08:43] [DOC: 9320634] ℹ️  DOB normalized: 06/25/1944
[05:08:43] [DOC: 9320634] ℹ️  Episode startOfEpisode normalized: 04/22/2025
[05:08:43] [DOC: 9320634] ℹ️  Episode endOfEpisode normalized: 06/20/2025
[05:08:43] [DOC: 9320634] ✅ Patient date processing completed successfully
[05:08:43] ✅    ✅ Date processing completed
[05:08:43] 📊 Processed Patient Data
     └─ patientFName: Marie
     └─ patientLName: Mendoza
     └─ dob: 06/25/1944
     └─ patientSex: 
     └─ medicalRecordNo: MA221103064405
     └─ billingProvider: SHAN QIN
     └─ npi: 1891138822
     └─ physicianNPI: 1891138822
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/22/2025', 'endOfEpisode': '06/20/2025', 'firstDiagnosis': 'F39', 'secondDiagnosis': 'F32.A', 'thirdDiagnosis': 'E11.42', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:08:43] 🔄 
🔄 Step 4: Extracting order data...
[05:08:46] ℹ️  Order extraction - MRN: 'MA221103064405'
[05:08:46] ℹ️  Order extraction - Sex: ''
[05:08:46] ℹ️  Order extraction - Service Line: 'Skilled Nursing'
[05:08:46] ℹ️  Order extraction - Payer Source: ''
[05:08:46] ✅ Order data extraction completed successfully
[05:08:46] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:08:46] ℹ️  Using MRN from patient data: 'MA221103064405' over 'MA221103064405'
[05:08:46] ℹ️  Inferred sex as FEMALE from name: Marie
[05:08:46] ℹ️  Service line consistent in both sources: 'Skilled Nursing'
[05:08:46] ✅ Patient name cross-validation successful
[05:08:46] ✅    ✅ Data merged successfully
[05:08:47] ✅    ✅ Order data extracted and validated
[05:08:47] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:08:52] [DOC: 9320634] ℹ️  Patient not found in cache or API: Marie Mendoza
[05:08:52] [DOC: 9320634] ℹ️  Patient not found, creating new patient via API...
[05:08:52] [DOC: 9320634] ℹ️  Creating patient via API: Marie Mendoza
[05:08:53] [DOC: 9320634] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:08:53] ❌    ❌ Failed to create patient
[05:08:53] [DOC: 9320634] ℹ️  API push details saved for document 9320634
================================================================================
║                        Processing Document ID: 9320632                         ║
================================================================================
[05:08:53] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:08:53] ℹ️  Date: 05/30/2025
[05:08:53] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:08:56] [DOC: 9320632] ✅ Text extracted using pdfplumber (16318 chars)
[05:08:56] ✅    ✅ Text extracted using pdfplumber (16318 chars)
[05:08:56] 🔄 
🔄 Step 2: Extracting patient data...
[05:08:59] ℹ️  AI extracted raw sex value: ''
[05:08:59] ℹ️  AI extracted service line: 'PT'
[05:08:59] ℹ️  AI extracted payer source: 'None'
[05:08:59] ℹ️  AI extracted diagnoses:
[05:08:59] ℹ️    - Diagnosis 1: 'DM'
[05:08:59] ℹ️    - Diagnosis 2: 'CHF'
[05:08:59] ℹ️    - Diagnosis 3: 'None'
[05:08:59] ℹ️    - Diagnosis 4: 'None'
[05:08:59] ℹ️    - Diagnosis 5: 'None'
[05:08:59] ℹ️    - Diagnosis 6: 'None'
[05:08:59] ℹ️  Final extracted MRN: 'MA200528053701'
[05:08:59] ℹ️  Final extracted Sex: ''
[05:08:59] ℹ️  Final extracted Service Line: 'PT'
[05:08:59] ℹ️  Final extracted Payer Source: ''
[05:08:59] ✅ Patient data extraction completed successfully
[05:08:59] ✅    ✅ Patient data extracted successfully
[05:08:59] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: None
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/18/2025', 'endOfEpisode': None, 'firstDiagnosis': 'DM', 'secondDiagnosis': 'CHF', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[05:08:59] ✅    ✅ Patient identified: Roderick Lopez
[05:08:59] ✅    ✅ Patient name validation passed
[05:08:59] 🔄 
🔄 Step 3: Processing patient dates...
[05:08:59] [DOC: 9320632] ℹ️  DOB normalized: 05/21/1937
[05:08:59] [DOC: 9320632] ℹ️  Episode startOfEpisode normalized: 03/18/2025
[05:08:59] [DOC: 9320632] ✅ Patient date processing completed successfully
[05:08:59] ✅    ✅ Date processing completed
[05:08:59] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: PT
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/18/2025', 'firstDiagnosis': 'DM', 'secondDiagnosis': 'CHF'}]
[05:08:59] 🔄 
🔄 Step 4: Extracting order data...
[05:09:02] ℹ️  Order extraction - MRN: 'MA200528053701'
[05:09:02] ℹ️  Order extraction - Sex: 'MALE'
[05:09:02] ℹ️  Order extraction - Service Line: 'PT'
[05:09:02] ℹ️  Order extraction - Payer Source: ''
[05:09:02] ✅ Order data extraction completed successfully
[05:09:02] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:09:02] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[05:09:02] ℹ️  Service line consistent in both sources: 'PT'
[05:09:02] ✅ Patient name cross-validation successful
[05:09:02] ✅    ✅ Data merged successfully
[05:09:03] ⚠️     ❌ Skipping - missing episode start date
[05:09:03] [DOC: 9320632] ℹ️  API push details saved for document 9320632
================================================================================
║                        Processing Document ID: 9320631                         ║
================================================================================
[05:09:03] ℹ️  Agency: Nightingale Visiting Nurses-Taunton
[05:09:03] ℹ️  Date: 05/30/2025
[05:09:03] 🔄 
🔄 Step 1: Extracting text from PDF...
[05:09:05] [DOC: 9320631] ✅ Text extracted using pdfplumber (13919 chars)
[05:09:05] ✅    ✅ Text extracted using pdfplumber (13919 chars)
[05:09:05] 🔄 
🔄 Step 2: Extracting patient data...
[05:09:08] ℹ️  AI extracted raw sex value: ''
[05:09:08] ℹ️  AI extracted service line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:09:08] ℹ️  AI extracted payer source: ''
[05:09:08] ℹ️  AI extracted diagnoses:
[05:09:08] ℹ️    - Diagnosis 1: 'I2699'
[05:09:08] ℹ️    - Diagnosis 2: 'M4856XD'
[05:09:08] ℹ️    - Diagnosis 3: ''
[05:09:08] ℹ️    - Diagnosis 4: ''
[05:09:08] ℹ️    - Diagnosis 5: ''
[05:09:08] ℹ️    - Diagnosis 6: ''
[05:09:08] ℹ️  Final extracted MRN: 'MA200528053701'
[05:09:08] ℹ️  Final extracted Sex: ''
[05:09:08] ℹ️  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:09:08] ℹ️  Final extracted Payer Source: ''
[05:09:08] ✅ Patient data extraction completed successfully
[05:09:08] ✅    ✅ Patient data extracted successfully
[05:09:08] 📊 Patient Response
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'I2699', 'secondDiagnosis': 'M4856XD', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:09:08] ✅    ✅ Patient identified: Roderick Lopez
[05:09:08] ✅    ✅ Patient name validation passed
[05:09:08] 🔄 
🔄 Step 3: Processing patient dates...
[05:09:08] [DOC: 9320631] ℹ️  DOB normalized: 05/21/1937
[05:09:08] [DOC: 9320631] ℹ️  Episode startOfEpisode normalized: 04/20/2025
[05:09:08] [DOC: 9320631] ℹ️  Episode endOfEpisode normalized: 06/18/2025
[05:09:08] [DOC: 9320631] ✅ Patient date processing completed successfully
[05:09:08] ✅    ✅ Date processing completed
[05:09:08] 📊 Processed Patient Data
     └─ patientFName: Roderick
     └─ patientLName: Lopez
     └─ dob: 05/21/1937
     └─ patientSex: 
     └─ medicalRecordNo: MA200528053701
     └─ billingProvider: Dr. QIN, SHAN
     └─ npi: 
     └─ physicianNPI: 
     └─ nameOfAgency: Nightingale Visiting Nurses
     └─ address: 125 County ST.
     └─ city: Taunton
     └─ state: MA
     └─ zip: 02780
     └─ email: 
     └─ phoneNumber: (508) 967-0761
     └─ serviceLine: Skilled Nursing, Physical Therapy, Occupational Therapy
     └─ payorSource: 
     └─ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '04/20/2025', 'endOfEpisode': '06/18/2025', 'firstDiagnosis': 'I2699', 'secondDiagnosis': 'M4856XD', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[05:09:08] 🔄 
🔄 Step 4: Extracting order data...
[05:09:11] ℹ️  Order extraction - MRN: 'MA200528053701'
[05:09:11] ℹ️  Order extraction - Sex: ''
[05:09:11] ℹ️  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:09:11] ℹ️  Order extraction - Payer Source: ''
[05:09:11] ✅ Order data extraction completed successfully
[05:09:11] 🔄 
🔄 Step 4.5: Merging patient and order data...
[05:09:11] ℹ️  Using MRN from patient data: 'MA200528053701' over 'MA200528053701'
[05:09:11] ℹ️  Inferred sex as MALE from name: Roderick
[05:09:11] ℹ️  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Occupational Therapy'
[05:09:11] ✅ Patient name cross-validation successful
[05:09:11] ✅    ✅ Data merged successfully
[05:09:12] ✅    ✅ Order data extracted and validated
[05:09:12] 🔄 
🔄 Step 5: Checking/Creating patient...
[05:09:24] [DOC: 9320631] ℹ️  Patient not found in cache or API: Roderick Lopez
[05:09:24] [DOC: 9320631] ℹ️  Patient not found, creating new patient via API...
[05:09:24] [DOC: 9320631] ℹ️  Creating patient via API: Roderick Lopez
[05:09:25] [DOC: 9320631] ❌ Patient creation failed with status 409: A patient with the same first name, last name, DOB, and Zip already exists.
[05:09:25] ❌    ❌ Failed to create patient
[05:09:25] [DOC: 9320631] ℹ️  API push details saved for document 9320631
================================================================================
║                               PROCESSING SUMMARY                               ║
================================================================================
[05:09:25] ℹ️  Total Processed: 49
[05:09:25] ℹ️  CSV Success: 30
[05:09:25] ℹ️  CSV Errors: 8
[05:09:25] ℹ️  API Success: 0
[05:09:25] ℹ️  API Errors: 41
[05:09:25] ℹ️  CSV Success Rate: 61.2%
[05:09:25] ℹ️  API Success Rate: 0.0%
[05:09:25] ℹ️  Output CSV File: csv_outputs/extracted_patients_20250607_045437.csv
[05:09:25] ℹ️  API Details File: api_outputs/api_push_details_20250607_045437.csv
================================================================================
║          ============================================================          ║
================================================================================
