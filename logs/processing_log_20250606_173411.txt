================================================================================
â•‘                            FINAL VERSION PROCESSOR                             â•‘
================================================================================
[17:34:11] â„¹ï¸  CSV Data Extraction & API Push Tool
[17:34:11] â„¹ï¸  
[17:34:11] â„¹ï¸  Features:
[17:34:11] â„¹ï¸  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[17:34:11] â„¹ï¸  - AI-powered patient and order data extraction
[17:34:11] â„¹ï¸  - Enhanced error handling and logging
[17:34:11] â„¹ï¸  - Full API integration (patient creation + order pushing)
[17:34:11] â„¹ï¸  - CSV output with comprehensive patient data
[17:34:11] â„¹ï¸  - Detailed API tracking with remarks for every document
[17:34:11] â„¹ï¸  - Complete audit trail of all processing attempts
[17:34:11] â„¹ï¸  
[17:34:11] â„¹ï¸  Starting CSV processing with API integration: hawthorn_fam.csv
[17:34:11] âœ… Created output CSV file: csv_outputs/extracted_patients_20250606_173411.csv
[17:34:11] âœ… Created API details CSV file: api_outputs/api_push_details_20250606_173411.csv
================================================================================
â•‘                        Processing Document ID: 9259497                         â•‘
================================================================================
[17:34:11] â„¹ï¸  Agency: Southcoast VNA â€“ Community Office (Fairhaven)
[17:34:11] â„¹ï¸  Date: 04/24/2025
[17:34:11] ğŸ”„ 
ğŸ”„ Step 1: Extracting text from PDF...
[17:34:14] [DOC: 9259497] âœ… Text extracted using pdfplumber (2612 chars)
[17:34:14] âœ…    âœ… Text extracted using pdfplumber (2612 chars)
[17:34:14] ğŸ”„ 
ğŸ”„ Step 2: Extracting patient data...
[17:34:18] â„¹ï¸  AI extracted raw sex value: 'M'
[17:34:18] â„¹ï¸  AI extracted service line: 'Physical Therapy'
[17:34:18] â„¹ï¸  AI extracted payer source: ''
[17:34:18] â„¹ï¸  AI extracted diagnoses:
[17:34:18] â„¹ï¸    - Diagnosis 1: 'None'
[17:34:18] â„¹ï¸    - Diagnosis 2: 'None'
[17:34:18] â„¹ï¸    - Diagnosis 3: 'None'
[17:34:18] â„¹ï¸    - Diagnosis 4: 'None'
[17:34:18] â„¹ï¸    - Diagnosis 5: 'None'
[17:34:18] â„¹ï¸    - Diagnosis 6: 'None'
[17:34:18] â„¹ï¸  Final extracted MRN: '2005206'
[17:34:18] â„¹ï¸  Final extracted Sex: 'MALE'
[17:34:18] â„¹ï¸  Final extracted Service Line: 'Physical Therapy'
[17:34:18] â„¹ï¸  Final extracted Payer Source: ''
[17:34:18] âœ… Patient data extraction completed successfully
[17:34:18] âœ…    âœ… Patient data extracted successfully
[17:34:18] ğŸ“Š Patient Response
     â””â”€ patientFName: Jose
     â””â”€ patientLName: Baptista
     â””â”€ dob: 07/02/1934
     â””â”€ patientSex: MALE
     â””â”€ medicalRecordNo: 2005206
     â””â”€ billingProvider: Sachin Maskey, MD
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     â””â”€ address: 200 Mill Road
     â””â”€ city: Fairhaven
     â””â”€ state: MA
     â””â”€ zip: 02719-5252
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 973-3200
     â””â”€ serviceLine: Physical Therapy
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': None, 'endOfEpisode': None, 'firstDiagnosis': None, 'secondDiagnosis': None, 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:34:18] âœ…    âœ… Patient identified: Jose Baptista
[17:34:18] âœ…    âœ… Patient name validation passed
[17:34:18] ğŸ”„ 
ğŸ”„ Step 3: Processing patient dates...
[17:34:18] [DOC: 9259497] â„¹ï¸  DOB normalized: 07/02/1934
[17:34:18] [DOC: 9259497] âœ… Patient date processing completed successfully
[17:34:18] âœ…    âœ… Date processing completed
[17:34:18] ğŸ“Š Processed Patient Data
     â””â”€ patientFName: Jose
     â””â”€ patientLName: Baptista
     â””â”€ dob: 07/02/1934
     â””â”€ patientSex: MALE
     â””â”€ medicalRecordNo: 2005206
     â””â”€ billingProvider: Sachin Maskey, MD
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     â””â”€ address: 200 Mill Road
     â””â”€ city: Fairhaven
     â””â”€ state: MA
     â””â”€ zip: 02719-5252
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 973-3200
     â””â”€ serviceLine: Physical Therapy
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': ''}]
[17:34:18] ğŸ”„ 
ğŸ”„ Step 4: Extracting order data...
[17:34:21] â„¹ï¸  Order extraction - MRN: '2005206'
[17:34:21] â„¹ï¸  Order extraction - Sex: 'MALE'
[17:34:21] â„¹ï¸  Order extraction - Service Line: ''
[17:34:21] â„¹ï¸  Order extraction - Payer Source: ''
[17:34:21] âœ… Order data extraction completed successfully
[17:34:21] ğŸ”„ 
ğŸ”„ Step 4.5: Merging patient and order data...
[17:34:21] â„¹ï¸  Using MRN from patient data: '2005206' over '2005206'
[17:34:21] â„¹ï¸  Using service line from patient data: 'Physical Therapy'
[17:34:21] âœ… Patient name cross-validation successful
[17:34:21] âœ…    âœ… Data merged successfully
[17:34:22] âš ï¸     âŒ Skipping - missing episode start date
[17:34:22] [DOC: 9259497] â„¹ï¸  API push details saved for document 9259497
================================================================================
â•‘                        Processing Document ID: 9259495                         â•‘
================================================================================
[17:34:22] â„¹ï¸  Agency: Southcoast VNA â€“ Community Office (Fairhaven)
[17:34:22] â„¹ï¸  Date: 04/24/2025
[17:34:22] ğŸ”„ 
ğŸ”„ Step 1: Extracting text from PDF...
[17:34:27] [DOC: 9259495] âœ… Text extracted using pdfplumber (15814 chars)
[17:34:27] âœ…    âœ… Text extracted using pdfplumber (15814 chars)
[17:34:27] ğŸ”„ 
ğŸ”„ Step 2: Extracting patient data...
[17:34:31] â„¹ï¸  AI extracted raw sex value: 'M'
[17:34:31] â„¹ï¸  AI extracted service line: 'Physical Therapy, Occupational Therapy'
[17:34:31] â„¹ï¸  AI extracted payer source: ''
[17:34:31] â„¹ï¸  AI extracted diagnoses:
[17:34:31] â„¹ï¸    - Diagnosis 1: 'G20.A1'
[17:34:31] â„¹ï¸    - Diagnosis 2: 'I88.0'
[17:34:31] â„¹ï¸    - Diagnosis 3: 'R53.1'
[17:34:31] â„¹ï¸    - Diagnosis 4: 'I10'
[17:34:31] â„¹ï¸    - Diagnosis 5: 'N13.30'
[17:34:31] â„¹ï¸    - Diagnosis 6: 'N40.1'
[17:34:31] â„¹ï¸  Final extracted MRN: '2211831'
[17:34:31] â„¹ï¸  Final extracted Sex: 'MALE'
[17:34:31] â„¹ï¸  Final extracted Service Line: 'Physical Therapy, Occupational Therapy'
[17:34:31] â„¹ï¸  Final extracted Payer Source: ''
[17:34:31] âœ… Patient data extraction completed successfully
[17:34:31] âœ…    âœ… Patient data extracted successfully
[17:34:31] ğŸ“Š Patient Response
     â””â”€ patientFName: Viriato
     â””â”€ patientLName: Bala
     â””â”€ dob: 11/12/1937
     â””â”€ patientSex: MALE
     â””â”€ medicalRecordNo: 2211831
     â””â”€ billingProvider: Stephen C. Mackler, MD
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     â””â”€ address: 200 Mill Road
     â””â”€ city: Fairhaven
     â””â”€ state: MA
     â””â”€ zip: 02719-5252
     â””â”€ email: 
     â””â”€ phoneNumber: 508-973-3200
     â””â”€ serviceLine: Physical Therapy, Occupational Therapy
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '04/10/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I88.0', 'thirdDiagnosis': 'R53.1', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'N13.30', 'sixthDiagnosis': 'N40.1'}]
[17:34:31] âœ…    âœ… Patient identified: Viriato Bala
[17:34:31] âœ…    âœ… Patient name validation passed
[17:34:31] ğŸ”„ 
ğŸ”„ Step 3: Processing patient dates...
[17:34:31] [DOC: 9259495] â„¹ï¸  DOB normalized: 11/12/1937
[17:34:31] [DOC: 9259495] â„¹ï¸  Episode startOfCare normalized: 04/10/2025
[17:34:31] [DOC: 9259495] â„¹ï¸  Episode startOfEpisode normalized: 04/11/2025
[17:34:31] [DOC: 9259495] â„¹ï¸  Episode endOfEpisode normalized: 06/09/2025
[17:34:31] [DOC: 9259495] âœ… Patient date processing completed successfully
[17:34:31] âœ…    âœ… Date processing completed
[17:34:31] ğŸ“Š Processed Patient Data
     â””â”€ patientFName: Viriato
     â””â”€ patientLName: Bala
     â””â”€ dob: 11/12/1937
     â””â”€ patientSex: MALE
     â””â”€ medicalRecordNo: 2211831
     â””â”€ billingProvider: Stephen C. Mackler, MD
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     â””â”€ address: 200 Mill Road
     â””â”€ city: Fairhaven
     â””â”€ state: MA
     â””â”€ zip: 02719-5252
     â””â”€ email: 
     â””â”€ phoneNumber: 508-973-3200
     â””â”€ serviceLine: Physical Therapy, Occupational Therapy
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '04/10/2025', 'startOfEpisode': '04/11/2025', 'endOfEpisode': '06/09/2025', 'firstDiagnosis': 'G20.A1', 'secondDiagnosis': 'I88.0', 'thirdDiagnosis': 'R53.1', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'N13.30', 'sixthDiagnosis': 'N40.1'}]
[17:34:31] ğŸ”„ 
ğŸ”„ Step 4: Extracting order data...
[17:34:34] â„¹ï¸  Order extraction - MRN: '2211831'
[17:34:34] â„¹ï¸  Order extraction - Sex: 'MALE'
[17:34:34] â„¹ï¸  Order extraction - Service Line: 'PT, OT'
[17:34:34] â„¹ï¸  Order extraction - Payer Source: ''
[17:34:34] âœ… Order data extraction completed successfully
[17:34:34] ğŸ”„ 
ğŸ”„ Step 4.5: Merging patient and order data...
[17:34:34] â„¹ï¸  Using MRN from patient data: '2211831' over '2211831'
[17:34:34] â„¹ï¸  Combined service lines: Patient='Physical Therapy, Occupational Therapy' + Order='PT, OT' = 'OT, Occupational Therapy, PT, Physical Therapy'
[17:34:34] âœ… Patient name cross-validation successful
[17:34:34] âœ…    âœ… Data merged successfully
[17:34:35] âœ…    âœ… Order data extracted and validated
[17:34:35] ğŸ”„ 
ğŸ”„ Step 5: Checking/Creating patient...
[17:34:35] [DOC: 9259495] âœ… Patient found in local cache: Viriato Bala, ID: b70c4038-8eef-4f28-b15b-74771b9982ae
[17:34:35] âœ…    âœ… Existing patient found with ID: b70c4038-8eef-4f28-b15b-74771b9982ae
[17:34:35] ğŸ”„ 
ğŸ”„ Step 6: Pushing order to API...
[17:34:35] [DOC: 9259495] â„¹ï¸  Pushing order via API for patient ID: b70c4038-8eef-4f28-b15b-74771b9982ae
[17:34:37] [DOC: 9259495] âŒ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12982"}
[17:34:37] âŒ    âŒ Failed to push order
[17:34:37] ğŸ”„ 
ğŸ”„ Step 7: Writing to CSV...
[17:34:37] [DOC: 9259495] â„¹ï¸  Calculated age: 87 from DOB: 11/12/1937
[17:34:37] [DOC: 9259495] â„¹ï¸  Service Line extracted: 'OT, Occupational Therapy, PT, Physical Therapy'
[17:34:37] [DOC: 9259495] â„¹ï¸  Payer Source extracted: ''
[17:34:37] [DOC: 9259495] â„¹ï¸  Diagnosis codes being written:
[17:34:37] [DOC: 9259495] â„¹ï¸    - Latest_Episode_Firstdiagnosis: 'G20.A1'
[17:34:37] [DOC: 9259495] â„¹ï¸    - Latest_Episode_Seconddiagnosis: 'I88.0'
[17:34:37] [DOC: 9259495] â„¹ï¸    - Latest_Episode_Thirddiagnosis: 'R53.1'
[17:34:37] [DOC: 9259495] â„¹ï¸    - Latest_Episode_Fourthdiagnosis: 'I10'
[17:34:37] [DOC: 9259495] â„¹ï¸    - Latest_Episode_Fifthdiagnosis: 'N13.30'
[17:34:37] [DOC: 9259495] â„¹ï¸    - Latest_Episode_Sixthdiagnosis: 'N40.1'
[17:34:37] [DOC: 9259495] âœ… Patient data written to CSV: Viriato Bala | Sex: MALE | Age: 87 | Service: OT, Occupational Therapy, PT, Physical Therapy | Payer:  | MRN: 2211831
[17:34:37] âœ…    âœ… Document 9259495 processed and saved successfully
[17:34:37] ğŸ”„ 
ğŸ”„ Step 8: Saving API details...
[17:34:37] [DOC: 9259495] â„¹ï¸  API push details saved for document 9259495
[17:34:37] âœ…    âœ… API details saved
================================================================================
â•‘                        Processing Document ID: 9258663                         â•‘
================================================================================
[17:34:37] â„¹ï¸  Agency: Nightingale Visiting Nurses-Taunton
[17:34:37] â„¹ï¸  Date: 04/24/2025
[17:34:37] ğŸ”„ 
ğŸ”„ Step 1: Extracting text from PDF...
[17:34:50] [DOC: 9258663] âœ… Text extracted using pdfplumber (12349 chars)
[17:34:50] âœ…    âœ… Text extracted using pdfplumber (12349 chars)
[17:34:50] ğŸ”„ 
ğŸ”„ Step 2: Extracting patient data...
[17:34:53] â„¹ï¸  AI extracted raw sex value: 'F'
[17:34:53] â„¹ï¸  AI extracted service line: 'OT'
[17:34:53] â„¹ï¸  AI extracted payer source: 'None'
[17:34:53] â„¹ï¸  AI extracted diagnoses:
[17:34:53] â„¹ï¸    - Diagnosis 1: 'J44.1'
[17:34:53] â„¹ï¸    - Diagnosis 2: 'M62.81'
[17:34:53] â„¹ï¸    - Diagnosis 3: 'None'
[17:34:53] â„¹ï¸    - Diagnosis 4: 'None'
[17:34:53] â„¹ï¸    - Diagnosis 5: 'None'
[17:34:53] â„¹ï¸    - Diagnosis 6: 'None'
[17:34:53] â„¹ï¸  Final extracted MRN: 'MA250130025704'
[17:34:53] â„¹ï¸  Final extracted Sex: 'FEMALE'
[17:34:53] â„¹ï¸  Final extracted Service Line: 'OT'
[17:34:53] â„¹ï¸  Final extracted Payer Source: ''
[17:34:53] âœ… Patient data extraction completed successfully
[17:34:53] âœ…    âœ… Patient data extracted successfully
[17:34:53] ğŸ“Š Patient Response
     â””â”€ patientFName: Theresa
     â””â”€ patientLName: Racine
     â””â”€ dob: 02/10/1957
     â””â”€ patientSex: FEMALE
     â””â”€ medicalRecordNo: MA250130025704
     â””â”€ billingProvider: Nightingale Visiting Nurses
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Nightingale Visiting Nurses
     â””â”€ address: 125 County ST
     â””â”€ city: Taunton
     â””â”€ state: MA
     â””â”€ zip: 02780
     â””â”€ email: None
     â””â”€ phoneNumber: (508) 967-0761
     â””â”€ serviceLine: OT
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/05/2025', 'endOfEpisode': None, 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'M62.81', 'thirdDiagnosis': None, 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:34:53] âœ…    âœ… Patient identified: Theresa Racine
[17:34:53] âœ…    âœ… Patient name validation passed
[17:34:53] ğŸ”„ 
ğŸ”„ Step 3: Processing patient dates...
[17:34:53] [DOC: 9258663] â„¹ï¸  DOB normalized: 02/10/1957
[17:34:53] [DOC: 9258663] â„¹ï¸  Episode startOfEpisode normalized: 03/05/2025
[17:34:53] [DOC: 9258663] âœ… Patient date processing completed successfully
[17:34:53] âœ…    âœ… Date processing completed
[17:34:53] ğŸ“Š Processed Patient Data
     â””â”€ patientFName: Theresa
     â””â”€ patientLName: Racine
     â””â”€ dob: 02/10/1957
     â””â”€ patientSex: FEMALE
     â””â”€ medicalRecordNo: MA250130025704
     â””â”€ billingProvider: Nightingale Visiting Nurses
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Nightingale Visiting Nurses
     â””â”€ address: 125 County ST
     â””â”€ city: Taunton
     â””â”€ state: MA
     â””â”€ zip: 02780
     â””â”€ phoneNumber: (508) 967-0761
     â””â”€ serviceLine: OT
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/05/2025', 'firstDiagnosis': 'J44.1', 'secondDiagnosis': 'M62.81'}]
[17:34:53] ğŸ”„ 
ğŸ”„ Step 4: Extracting order data...
[17:34:56] â„¹ï¸  Order extraction - MRN: 'MA250130025704'
[17:34:56] â„¹ï¸  Order extraction - Sex: 'FEMALE'
[17:34:56] â„¹ï¸  Order extraction - Service Line: 'OT'
[17:34:56] â„¹ï¸  Order extraction - Payer Source: ''
[17:34:56] âœ… Order data extraction completed successfully
[17:34:56] ğŸ”„ 
ğŸ”„ Step 4.5: Merging patient and order data...
[17:34:56] â„¹ï¸  Using MRN from patient data: 'MA250130025704' over 'MA250130025704'
[17:34:56] â„¹ï¸  Service line consistent in both sources: 'OT'
[17:34:56] âœ… Patient name cross-validation successful
[17:34:56] âœ…    âœ… Data merged successfully
[17:34:57] âœ…    âœ… Order data extracted and validated
[17:34:57] ğŸ”„ 
ğŸ”„ Step 5: Checking/Creating patient...
[17:34:57] [DOC: 9258663] âœ… Patient found in local cache: Theresa Racine, ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[17:34:57] âœ…    âœ… Existing patient found with ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[17:34:57] ğŸ”„ 
ğŸ”„ Step 6: Pushing order to API...
[17:34:57] [DOC: 9258663] â„¹ï¸  Pushing order via API for patient ID: 2274c2a2-b173-4dfd-9f06-90e01ec4c8d1
[17:34:58] [DOC: 9258663] âŒ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD12965"}
[17:34:58] âŒ    âŒ Failed to push order
[17:34:58] ğŸ”„ 
ğŸ”„ Step 7: Writing to CSV...
[17:34:58] [DOC: 9258663] â„¹ï¸  Calculated age: 68 from DOB: 02/10/1957
[17:34:58] [DOC: 9258663] â„¹ï¸  Service Line extracted: 'OT'
[17:34:58] [DOC: 9258663] â„¹ï¸  Payer Source extracted: ''
[17:34:58] [DOC: 9258663] â„¹ï¸  Diagnosis codes being written:
[17:34:58] [DOC: 9258663] â„¹ï¸    - Latest_Episode_Firstdiagnosis: 'J44.1'
[17:34:58] [DOC: 9258663] â„¹ï¸    - Latest_Episode_Seconddiagnosis: 'M62.81'
[17:34:58] [DOC: 9258663] â„¹ï¸    - Latest_Episode_Thirddiagnosis: ''
[17:34:58] [DOC: 9258663] â„¹ï¸    - Latest_Episode_Fourthdiagnosis: ''
[17:34:58] [DOC: 9258663] â„¹ï¸    - Latest_Episode_Fifthdiagnosis: ''
[17:34:58] [DOC: 9258663] â„¹ï¸    - Latest_Episode_Sixthdiagnosis: ''
[17:34:58] [DOC: 9258663] âœ… Patient data written to CSV: Theresa Racine | Sex: FEMALE | Age: 68 | Service: OT | Payer:  | MRN: MA250130025704
[17:34:58] âœ…    âœ… Document 9258663 processed and saved successfully
[17:34:58] ğŸ”„ 
ğŸ”„ Step 8: Saving API details...
[17:34:58] [DOC: 9258663] â„¹ï¸  API push details saved for document 9258663
[17:34:58] âœ…    âœ… API details saved
================================================================================
â•‘                        Processing Document ID: 9258661                         â•‘
================================================================================
[17:34:58] â„¹ï¸  Agency: Nightingale Visiting Nurses-Taunton
[17:34:58] â„¹ï¸  Date: 04/24/2025
[17:34:58] ğŸ”„ 
ğŸ”„ Step 1: Extracting text from PDF...
[17:35:01] [DOC: 9258661] âœ… Text extracted using pdfplumber (1686 chars)
[17:35:01] âœ…    âœ… Text extracted using pdfplumber (1686 chars)
[17:35:01] ğŸ”„ 
ğŸ”„ Step 2: Extracting patient data...
[17:35:04] â„¹ï¸  AI extracted raw sex value: ''
[17:35:04] â„¹ï¸  AI extracted service line: 'Skilled Nursing'
[17:35:04] â„¹ï¸  AI extracted payer source: ''
[17:35:04] â„¹ï¸  AI extracted diagnoses:
[17:35:04] â„¹ï¸    - Diagnosis 1: 'E11.65'
[17:35:04] â„¹ï¸    - Diagnosis 2: 'I10'
[17:35:04] â„¹ï¸    - Diagnosis 3: 'H54.8'
[17:35:04] â„¹ï¸    - Diagnosis 4: ''
[17:35:04] â„¹ï¸    - Diagnosis 5: ''
[17:35:04] â„¹ï¸    - Diagnosis 6: ''
[17:35:04] â„¹ï¸  Final extracted MRN: 'MA210907053505'
[17:35:04] â„¹ï¸  Final extracted Sex: ''
[17:35:04] â„¹ï¸  Final extracted Service Line: 'Skilled Nursing'
[17:35:04] â„¹ï¸  Final extracted Payer Source: ''
[17:35:04] âœ… Patient data extraction completed successfully
[17:35:04] âœ…    âœ… Patient data extracted successfully
[17:35:04] ğŸ“Š Patient Response
     â””â”€ patientFName: Rolande
     â””â”€ patientLName: Morrell
     â””â”€ dob: 05/15/1935
     â””â”€ patientSex: 
     â””â”€ medicalRecordNo: MA210907053505
     â””â”€ billingProvider: SACHIN MASKEY MD
     â””â”€ npi: 1134386972
     â””â”€ physicianNPI: 1134386972
     â””â”€ nameOfAgency: Nightingale Visiting Nurses
     â””â”€ address: 125 County ST
     â””â”€ city: Taunton
     â””â”€ state: MA
     â””â”€ zip: 02780
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 967-0761
     â””â”€ serviceLine: Skilled Nursing
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:35:04] âœ…    âœ… Patient identified: Rolande Morrell
[17:35:04] âœ…    âœ… Patient name validation passed
[17:35:04] ğŸ”„ 
ğŸ”„ Step 3: Processing patient dates...
[17:35:04] [DOC: 9258661] â„¹ï¸  DOB normalized: 05/15/1935
[17:35:04] [DOC: 9258661] â„¹ï¸  Episode startOfEpisode normalized: 03/14/2025
[17:35:04] [DOC: 9258661] â„¹ï¸  Episode endOfEpisode normalized: 05/12/2025
[17:35:04] [DOC: 9258661] âœ… Patient date processing completed successfully
[17:35:04] âœ…    âœ… Date processing completed
[17:35:04] ğŸ“Š Processed Patient Data
     â””â”€ patientFName: Rolande
     â””â”€ patientLName: Morrell
     â””â”€ dob: 05/15/1935
     â””â”€ patientSex: 
     â””â”€ medicalRecordNo: MA210907053505
     â””â”€ billingProvider: SACHIN MASKEY MD
     â””â”€ npi: 1134386972
     â””â”€ physicianNPI: 1134386972
     â””â”€ nameOfAgency: Nightingale Visiting Nurses
     â””â”€ address: 125 County ST
     â””â”€ city: Taunton
     â””â”€ state: MA
     â””â”€ zip: 02780
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 967-0761
     â””â”€ serviceLine: Skilled Nursing
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[17:35:04] ğŸ”„ 
ğŸ”„ Step 4: Extracting order data...
[17:35:06] â„¹ï¸  Order extraction - MRN: 'MA210907053505'
[17:35:06] â„¹ï¸  Order extraction - Sex: ''
[17:35:06] â„¹ï¸  Order extraction - Service Line: 'Skilled Nursing'
[17:35:06] â„¹ï¸  Order extraction - Payer Source: ''
[17:35:06] âœ… Order data extraction completed successfully
[17:35:06] ğŸ”„ 
ğŸ”„ Step 4.5: Merging patient and order data...
[17:35:06] â„¹ï¸  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[17:35:06] âš ï¸  Could not determine sex using any available method
[17:35:06] â„¹ï¸  Service line consistent in both sources: 'Skilled Nursing'
[17:35:06] âœ… Patient name cross-validation successful
[17:35:06] âœ…    âœ… Data merged successfully
[17:35:08] âœ…    âœ… Order data extracted and validated
[17:35:08] ğŸ”„ 
ğŸ”„ Step 5: Checking/Creating patient...
[17:35:08] [DOC: 9258661] âœ… Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[17:35:08] âœ…    âœ… Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[17:35:08] ğŸ”„ 
ğŸ”„ Step 6: Pushing order to API...
[17:35:08] [DOC: 9258661] â„¹ï¸  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[17:35:09] [DOC: 9258661] âŒ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14149"}
[17:35:09] âŒ    âŒ Failed to push order
[17:35:09] ğŸ”„ 
ğŸ”„ Step 7: Writing to CSV...
[17:35:09] [DOC: 9258661] â„¹ï¸  Calculated age: 90 from DOB: 05/15/1935
[17:35:09] [DOC: 9258661] â„¹ï¸  Service Line extracted: 'Skilled Nursing'
[17:35:09] [DOC: 9258661] â„¹ï¸  Payer Source extracted: ''
[17:35:09] [DOC: 9258661] â„¹ï¸  Diagnosis codes being written:
[17:35:09] [DOC: 9258661] â„¹ï¸    - Latest_Episode_Firstdiagnosis: 'E11.65'
[17:35:09] [DOC: 9258661] â„¹ï¸    - Latest_Episode_Seconddiagnosis: 'I10'
[17:35:09] [DOC: 9258661] â„¹ï¸    - Latest_Episode_Thirddiagnosis: 'H54.8'
[17:35:09] [DOC: 9258661] â„¹ï¸    - Latest_Episode_Fourthdiagnosis: ''
[17:35:09] [DOC: 9258661] â„¹ï¸    - Latest_Episode_Fifthdiagnosis: ''
[17:35:09] [DOC: 9258661] â„¹ï¸    - Latest_Episode_Sixthdiagnosis: ''
[17:35:09] [DOC: 9258661] âœ… Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: Skilled Nursing | Payer:  | MRN: MA210907053505
[17:35:09] âœ…    âœ… Document 9258661 processed and saved successfully
[17:35:09] ğŸ”„ 
ğŸ”„ Step 8: Saving API details...
[17:35:09] [DOC: 9258661] â„¹ï¸  API push details saved for document 9258661
[17:35:09] âœ…    âœ… API details saved
================================================================================
â•‘                        Processing Document ID: 9258658                         â•‘
================================================================================
[17:35:09] â„¹ï¸  Agency: Nightingale Visiting Nurses-Taunton
[17:35:09] â„¹ï¸  Date: 04/24/2025
[17:35:09] ğŸ”„ 
ğŸ”„ Step 1: Extracting text from PDF...
[17:35:15] [DOC: 9258658] âœ… Text extracted using pdfplumber (1147 chars)
[17:35:15] âœ…    âœ… Text extracted using pdfplumber (1147 chars)
[17:35:15] ğŸ”„ 
ğŸ”„ Step 2: Extracting patient data...
[17:35:18] â„¹ï¸  AI extracted raw sex value: ''
[17:35:18] â„¹ï¸  AI extracted service line: 'Speech Therapy'
[17:35:18] â„¹ï¸  AI extracted payer source: ''
[17:35:18] â„¹ï¸  AI extracted diagnoses:
[17:35:18] â„¹ï¸    - Diagnosis 1: 'E11.65'
[17:35:18] â„¹ï¸    - Diagnosis 2: 'I10'
[17:35:18] â„¹ï¸    - Diagnosis 3: 'H54.8'
[17:35:18] â„¹ï¸    - Diagnosis 4: 'None'
[17:35:18] â„¹ï¸    - Diagnosis 5: 'None'
[17:35:18] â„¹ï¸    - Diagnosis 6: 'None'
[17:35:18] â„¹ï¸  Final extracted MRN: 'MA210907053505'
[17:35:18] â„¹ï¸  Final extracted Sex: ''
[17:35:18] â„¹ï¸  Final extracted Service Line: 'Speech Therapy'
[17:35:18] â„¹ï¸  Final extracted Payer Source: ''
[17:35:18] âœ… Patient data extraction completed successfully
[17:35:18] âœ…    âœ… Patient data extracted successfully
[17:35:18] ğŸ“Š Patient Response
     â””â”€ patientFName: Rolande
     â””â”€ patientLName: Morrell
     â””â”€ dob: 05/15/1935
     â””â”€ patientSex: 
     â””â”€ medicalRecordNo: MA210907053505
     â””â”€ billingProvider: SACHIN MASKEY MD
     â””â”€ npi: 1134386972
     â””â”€ physicianNPI: 1134386972
     â””â”€ nameOfAgency: Nightingale Visiting Nurses
     â””â”€ address: 125 County ST
     â””â”€ city: Taunton
     â””â”€ state: MA
     â””â”€ zip: 02780
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 967-0761
     â””â”€ serviceLine: Speech Therapy
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': None, 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8', 'fourthDiagnosis': None, 'fifthDiagnosis': None, 'sixthDiagnosis': None}]
[17:35:18] âœ…    âœ… Patient identified: Rolande Morrell
[17:35:18] âœ…    âœ… Patient name validation passed
[17:35:18] ğŸ”„ 
ğŸ”„ Step 3: Processing patient dates...
[17:35:18] [DOC: 9258658] â„¹ï¸  DOB normalized: 05/15/1935
[17:35:18] [DOC: 9258658] â„¹ï¸  Episode startOfEpisode normalized: 03/14/2025
[17:35:18] [DOC: 9258658] â„¹ï¸  Episode endOfEpisode normalized: 05/12/2025
[17:35:18] [DOC: 9258658] âœ… Patient date processing completed successfully
[17:35:18] âœ…    âœ… Date processing completed
[17:35:18] ğŸ“Š Processed Patient Data
     â””â”€ patientFName: Rolande
     â””â”€ patientLName: Morrell
     â””â”€ dob: 05/15/1935
     â””â”€ patientSex: 
     â””â”€ medicalRecordNo: MA210907053505
     â””â”€ billingProvider: SACHIN MASKEY MD
     â””â”€ npi: 1134386972
     â””â”€ physicianNPI: 1134386972
     â””â”€ nameOfAgency: Nightingale Visiting Nurses
     â””â”€ address: 125 County ST
     â””â”€ city: Taunton
     â””â”€ state: MA
     â””â”€ zip: 02780
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 967-0761
     â””â”€ serviceLine: Speech Therapy
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '03/14/2025', 'endOfEpisode': '05/12/2025', 'firstDiagnosis': 'E11.65', 'secondDiagnosis': 'I10', 'thirdDiagnosis': 'H54.8'}]
[17:35:18] ğŸ”„ 
ğŸ”„ Step 4: Extracting order data...
[17:35:21] â„¹ï¸  Order extraction - MRN: 'MA210907053505'
[17:35:21] â„¹ï¸  Order extraction - Sex: ''
[17:35:21] â„¹ï¸  Order extraction - Service Line: 'Speech Therapy'
[17:35:21] â„¹ï¸  Order extraction - Payer Source: ''
[17:35:21] âœ… Order data extraction completed successfully
[17:35:21] ğŸ”„ 
ğŸ”„ Step 4.5: Merging patient and order data...
[17:35:21] â„¹ï¸  Using MRN from patient data: 'MA210907053505' over 'MA210907053505'
[17:35:21] âš ï¸  Could not determine sex using any available method
[17:35:21] â„¹ï¸  Service line consistent in both sources: 'Speech Therapy'
[17:35:21] âœ… Patient name cross-validation successful
[17:35:21] âœ…    âœ… Data merged successfully
[17:35:22] âœ…    âœ… Order data extracted and validated
[17:35:22] ğŸ”„ 
ğŸ”„ Step 5: Checking/Creating patient...
[17:35:22] [DOC: 9258658] âœ… Patient found in local cache: Rolande Morrell, ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[17:35:22] âœ…    âœ… Existing patient found with ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[17:35:22] ğŸ”„ 
ğŸ”„ Step 6: Pushing order to API...
[17:35:22] [DOC: 9258658] â„¹ï¸  Pushing order via API for patient ID: a7b62c9f-0fda-482d-9f85-332fa9572d30
[17:35:23] [DOC: 9258658] âŒ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14151"}
[17:35:23] âŒ    âŒ Failed to push order
[17:35:23] ğŸ”„ 
ğŸ”„ Step 7: Writing to CSV...
[17:35:23] [DOC: 9258658] â„¹ï¸  Calculated age: 90 from DOB: 05/15/1935
[17:35:23] [DOC: 9258658] â„¹ï¸  Service Line extracted: 'Speech Therapy'
[17:35:23] [DOC: 9258658] â„¹ï¸  Payer Source extracted: ''
[17:35:23] [DOC: 9258658] â„¹ï¸  Diagnosis codes being written:
[17:35:23] [DOC: 9258658] â„¹ï¸    - Latest_Episode_Firstdiagnosis: 'E11.65'
[17:35:23] [DOC: 9258658] â„¹ï¸    - Latest_Episode_Seconddiagnosis: 'I10'
[17:35:23] [DOC: 9258658] â„¹ï¸    - Latest_Episode_Thirddiagnosis: 'H54.8'
[17:35:23] [DOC: 9258658] â„¹ï¸    - Latest_Episode_Fourthdiagnosis: ''
[17:35:23] [DOC: 9258658] â„¹ï¸    - Latest_Episode_Fifthdiagnosis: ''
[17:35:23] [DOC: 9258658] â„¹ï¸    - Latest_Episode_Sixthdiagnosis: ''
[17:35:23] [DOC: 9258658] âœ… Patient data written to CSV: Rolande Morrell | Sex:  | Age: 90 | Service: Speech Therapy | Payer:  | MRN: MA210907053505
[17:35:23] âœ…    âœ… Document 9258658 processed and saved successfully
[17:35:23] ğŸ”„ 
ğŸ”„ Step 8: Saving API details...
[17:35:23] [DOC: 9258658] â„¹ï¸  API push details saved for document 9258658
[17:35:23] âœ…    âœ… API details saved
================================================================================
â•‘                               PROCESSING SUMMARY                               â•‘
================================================================================
[17:35:23] â„¹ï¸  Total Processed: 5
[17:35:23] â„¹ï¸  CSV Success: 4
[17:35:23] â„¹ï¸  CSV Errors: 1
[17:35:23] â„¹ï¸  API Success: 0
[17:35:23] â„¹ï¸  API Errors: 4
[17:35:23] â„¹ï¸  CSV Success Rate: 80.0%
[17:35:23] â„¹ï¸  API Success Rate: 0.0%
[17:35:23] â„¹ï¸  Output CSV File: csv_outputs/extracted_patients_20250606_173411.csv
[17:35:23] â„¹ï¸  API Details File: api_outputs/api_push_details_20250606_173411.csv
================================================================================
â•‘          ============================================================          â•‘
================================================================================
