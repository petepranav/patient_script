================================================================================
â•‘                            FINAL VERSION PROCESSOR                             â•‘
================================================================================
[04:51:22] â„¹ï¸  CSV Data Extraction & API Push Tool
[04:51:22] â„¹ï¸  
[04:51:22] â„¹ï¸  Features:
[04:51:22] â„¹ï¸  - 2 Robust text extraction methods (PDFPlumber + Tesseract OCR)
[04:51:22] â„¹ï¸  - AI-powered patient and order data extraction
[04:51:22] â„¹ï¸  - Enhanced error handling and logging
[04:51:22] â„¹ï¸  - Full API integration (patient creation + order pushing)
[04:51:22] â„¹ï¸  - CSV output with comprehensive patient data
[04:51:22] â„¹ï¸  - Detailed API tracking with remarks for every document
[04:51:22] â„¹ï¸  - Complete audit trail of all processing attempts
[04:51:22] â„¹ï¸  
[04:51:22] â„¹ï¸  Starting CSV processing with API integration: hawthorn_fam.csv
[04:51:22] âœ… Created output CSV file: csv_outputs/extracted_patients_20250607_045122.csv
[04:51:22] âœ… Created API details CSV file: api_outputs/api_push_details_20250607_045122.csv
================================================================================
â•‘                        Processing Document ID: 9323602                         â•‘
================================================================================
[04:51:22] â„¹ï¸  Agency: Dartmouth HH
[04:51:22] â„¹ï¸  Date: 06/03/2025
[04:51:22] ğŸ”„ 
ğŸ”„ Step 1: Extracting text from PDF...
[04:51:27] [DOC: 9323602] âœ… Text extracted using pdfplumber (2178 chars)
[04:51:27] âœ…    âœ… Text extracted using pdfplumber (2178 chars)
[04:51:27] ğŸ”„ 
ğŸ”„ Step 2: Extracting patient data...
[04:51:31] â„¹ï¸  AI extracted raw sex value: 'F'
[04:51:31] â„¹ï¸  AI extracted service line: 'RN'
[04:51:31] â„¹ï¸  AI extracted payer source: 'Medicare'
[04:51:31] â„¹ï¸  AI extracted diagnoses:
[04:51:31] â„¹ï¸    - Diagnosis 1: ''
[04:51:31] â„¹ï¸    - Diagnosis 2: ''
[04:51:31] â„¹ï¸    - Diagnosis 3: ''
[04:51:31] â„¹ï¸    - Diagnosis 4: ''
[04:51:31] â„¹ï¸    - Diagnosis 5: ''
[04:51:31] â„¹ï¸    - Diagnosis 6: ''
[04:51:31] â„¹ï¸  Final extracted MRN: '1252008'
[04:51:31] â„¹ï¸  Final extracted Sex: 'FEMALE'
[04:51:31] â„¹ï¸  Final extracted Service Line: 'RN'
[04:51:31] â„¹ï¸  Final extracted Payer Source: 'Medicare'
[04:51:31] âœ… Patient data extraction completed successfully
[04:51:31] âœ…    âœ… Patient data extracted successfully
[04:51:31] ğŸ“Š Patient Response
     â””â”€ patientFName: Linda
     â””â”€ patientLName: Sykes
     â””â”€ dob: 09/19/1947
     â””â”€ patientSex: FEMALE
     â””â”€ medicalRecordNo: 1252008
     â””â”€ billingProvider: Hawthorn Medical Associates
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Community Nurse Inc
     â””â”€ address: 62 Center Street
     â””â”€ city: Fairhaven
     â””â”€ state: MA
     â””â”€ zip: 02719
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 992-6278
     â””â”€ serviceLine: RN
     â””â”€ payorSource: Medicare
     â””â”€ episodeDiagnoses: [{'startOfCare': '04/13/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '06/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:51:31] âœ…    âœ… Patient identified: Linda Sykes
[04:51:31] âœ…    âœ… Patient name validation passed
[04:51:31] ğŸ”„ 
ğŸ”„ Step 3: Processing patient dates...
[04:51:31] [DOC: 9323602] â„¹ï¸  DOB normalized: 09/19/1947
[04:51:31] [DOC: 9323602] â„¹ï¸  Episode startOfCare normalized: 04/13/2025
[04:51:31] [DOC: 9323602] â„¹ï¸  Episode startOfEpisode normalized: 04/13/2025
[04:51:31] [DOC: 9323602] â„¹ï¸  Episode endOfEpisode normalized: 06/11/2025
[04:51:31] [DOC: 9323602] âœ… Patient date processing completed successfully
[04:51:31] âœ…    âœ… Date processing completed
[04:51:31] ğŸ“Š Processed Patient Data
     â””â”€ patientFName: Linda
     â””â”€ patientLName: Sykes
     â””â”€ dob: 09/19/1947
     â””â”€ patientSex: FEMALE
     â””â”€ medicalRecordNo: 1252008
     â””â”€ billingProvider: Hawthorn Medical Associates
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Community Nurse Inc
     â””â”€ address: 62 Center Street
     â””â”€ city: Fairhaven
     â””â”€ state: MA
     â””â”€ zip: 02719
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 992-6278
     â””â”€ serviceLine: RN
     â””â”€ payorSource: Medicare
     â””â”€ episodeDiagnoses: [{'startOfCare': '04/13/2025', 'startOfEpisode': '04/13/2025', 'endOfEpisode': '06/11/2025', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:51:31] ğŸ”„ 
ğŸ”„ Step 4: Extracting order data...
[04:51:33] â„¹ï¸  Order extraction - MRN: ''
[04:51:33] â„¹ï¸  Order extraction - Sex: 'FEMALE'
[04:51:33] â„¹ï¸  Order extraction - Service Line: 'RN'
[04:51:33] â„¹ï¸  Order extraction - Payer Source: 'Medicare'
[04:51:33] âœ… Order data extraction completed successfully
[04:51:33] ğŸ”„ 
ğŸ”„ Step 4.5: Merging patient and order data...
[04:51:33] â„¹ï¸  Using MRN from patient data: '1252008'
[04:51:33] â„¹ï¸  Service line consistent in both sources: 'RN'
[04:51:33] â„¹ï¸  Payer source consistent in both sources: 'Medicare'
[04:51:33] âœ… Patient name cross-validation successful
[04:51:33] âœ…    âœ… Data merged successfully
[04:51:35] âœ…    âœ… Order data extracted and validated
[04:51:35] ğŸ”„ 
ğŸ”„ Step 5: Checking/Creating patient...
[04:51:35] [DOC: 9323602] âœ… Patient found in local cache: Linda Sykes, ID: a10dd95f-9d80-4489-8146-b834f50f18d5
[04:51:35] âœ…    âœ… Existing patient found with ID: a10dd95f-9d80-4489-8146-b834f50f18d5
[04:51:35] ğŸ”„ 
ğŸ”„ Step 6: Pushing order to API...
[04:51:35] [DOC: 9323602] â„¹ï¸  Pushing order via API for patient ID: a10dd95f-9d80-4489-8146-b834f50f18d5
[04:51:36] [DOC: 9323602] âŒ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD14469"}
[04:51:36] âŒ    âŒ Failed to push order
[04:51:36] ğŸ”„ 
ğŸ”„ Step 7: Writing to CSV...
[04:51:36] [DOC: 9323602] â„¹ï¸  Calculated age: 77 from DOB: 09/19/1947
[04:51:36] [DOC: 9323602] â„¹ï¸  Service Line extracted: 'RN'
[04:51:36] [DOC: 9323602] â„¹ï¸  Payer Source extracted: 'Medicare'
[04:51:36] [DOC: 9323602] â„¹ï¸  Diagnosis codes being written:
[04:51:36] [DOC: 9323602] â„¹ï¸    - Latest_Episode_Firstdiagnosis: ''
[04:51:36] [DOC: 9323602] â„¹ï¸    - Latest_Episode_Seconddiagnosis: ''
[04:51:36] [DOC: 9323602] â„¹ï¸    - Latest_Episode_Thirddiagnosis: ''
[04:51:36] [DOC: 9323602] â„¹ï¸    - Latest_Episode_Fourthdiagnosis: ''
[04:51:36] [DOC: 9323602] â„¹ï¸    - Latest_Episode_Fifthdiagnosis: ''
[04:51:36] [DOC: 9323602] â„¹ï¸    - Latest_Episode_Sixthdiagnosis: ''
[04:51:36] [DOC: 9323602] âœ… Patient data written to CSV: Linda Sykes | Sex: FEMALE | Age: 77 | Service: RN | Payer: Medicare | MRN: 1252008
[04:51:36] âœ…    âœ… Document 9323602 processed and saved successfully
[04:51:36] ğŸ”„ 
ğŸ”„ Step 8: Saving API details...
[04:51:36] [DOC: 9323602] â„¹ï¸  API push details saved for document 9323602
[04:51:36] âœ…    âœ… API details saved
================================================================================
â•‘                        Processing Document ID: 9323125                         â•‘
================================================================================
[04:51:36] â„¹ï¸  Agency: Southcoast VNA â€“ Community Office (Fairhaven)
[04:51:36] â„¹ï¸  Date: 06/02/2025
[04:51:36] ğŸ”„ 
ğŸ”„ Step 1: Extracting text from PDF...
[04:51:40] [DOC: 9323125] âœ… Text extracted using pdfplumber (26176 chars)
[04:51:40] âœ…    âœ… Text extracted using pdfplumber (26176 chars)
[04:51:40] ğŸ”„ 
ğŸ”„ Step 2: Extracting patient data...
[04:51:44] â„¹ï¸  AI extracted raw sex value: 'F'
[04:51:44] â„¹ï¸  AI extracted service line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[04:51:44] â„¹ï¸  AI extracted payer source: ''
[04:51:44] â„¹ï¸  AI extracted diagnoses:
[04:51:44] â„¹ï¸    - Diagnosis 1: 'S72.001D'
[04:51:44] â„¹ï¸    - Diagnosis 2: 'D62'
[04:51:44] â„¹ï¸    - Diagnosis 3: 'I48.0'
[04:51:44] â„¹ï¸    - Diagnosis 4: 'I10'
[04:51:44] â„¹ï¸    - Diagnosis 5: 'I25.10'
[04:51:44] â„¹ï¸    - Diagnosis 6: 'S50.11XD'
[04:51:44] â„¹ï¸  Final extracted MRN: '2611003'
[04:51:44] â„¹ï¸  Final extracted Sex: 'FEMALE'
[04:51:44] â„¹ï¸  Final extracted Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[04:51:44] â„¹ï¸  Final extracted Payer Source: ''
[04:51:44] âœ… Patient data extraction completed successfully
[04:51:44] âœ…    âœ… Patient data extracted successfully
[04:51:44] ğŸ“Š Patient Response
     â””â”€ patientFName: Johnnie-Ann
     â””â”€ patientLName: Keighley
     â””â”€ dob: 04/04/1945
     â””â”€ patientSex: FEMALE
     â””â”€ medicalRecordNo: 2611003
     â””â”€ billingProvider: Christine A. Will, MD
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     â””â”€ address: 39 Menton St
     â””â”€ city: New Bedford
     â””â”€ state: MA
     â””â”€ zip: 02745-2647
     â””â”€ email: 
     â””â”€ phoneNumber: 508-995-3323
     â””â”€ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '05/09/2025', 'startOfEpisode': '05/11/2025', 'endOfEpisode': '07/09/2025', 'firstDiagnosis': 'S72.001D', 'secondDiagnosis': 'D62', 'thirdDiagnosis': 'I48.0', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'S50.11XD'}]
[04:51:44] âœ…    âœ… Patient identified: Johnnie-Ann Keighley
[04:51:44] âœ…    âœ… Patient name validation passed
[04:51:44] ğŸ”„ 
ğŸ”„ Step 3: Processing patient dates...
[04:51:44] [DOC: 9323125] â„¹ï¸  DOB normalized: 04/04/1945
[04:51:44] [DOC: 9323125] â„¹ï¸  Episode startOfCare normalized: 05/09/2025
[04:51:44] [DOC: 9323125] â„¹ï¸  Episode startOfEpisode normalized: 05/11/2025
[04:51:44] [DOC: 9323125] â„¹ï¸  Episode endOfEpisode normalized: 07/09/2025
[04:51:44] [DOC: 9323125] âœ… Patient date processing completed successfully
[04:51:44] âœ…    âœ… Date processing completed
[04:51:44] ğŸ“Š Processed Patient Data
     â””â”€ patientFName: Johnnie-Ann
     â””â”€ patientLName: Keighley
     â””â”€ dob: 04/04/1945
     â””â”€ patientSex: FEMALE
     â””â”€ medicalRecordNo: 2611003
     â””â”€ billingProvider: Christine A. Will, MD
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     â””â”€ address: 39 Menton St
     â””â”€ city: New Bedford
     â””â”€ state: MA
     â””â”€ zip: 02745-2647
     â””â”€ email: 
     â””â”€ phoneNumber: 508-995-3323
     â””â”€ serviceLine: Skilled Nursing,Physical Therapy,Occupational Therapy
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '05/09/2025', 'startOfEpisode': '05/11/2025', 'endOfEpisode': '07/09/2025', 'firstDiagnosis': 'S72.001D', 'secondDiagnosis': 'D62', 'thirdDiagnosis': 'I48.0', 'fourthDiagnosis': 'I10', 'fifthDiagnosis': 'I25.10', 'sixthDiagnosis': 'S50.11XD'}]
[04:51:44] ğŸ”„ 
ğŸ”„ Step 4: Extracting order data...
[04:51:47] â„¹ï¸  Order extraction - MRN: '2611003'
[04:51:47] â„¹ï¸  Order extraction - Sex: 'FEMALE'
[04:51:47] â„¹ï¸  Order extraction - Service Line: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[04:51:47] â„¹ï¸  Order extraction - Payer Source: ''
[04:51:47] âœ… Order data extraction completed successfully
[04:51:47] ğŸ”„ 
ğŸ”„ Step 4.5: Merging patient and order data...
[04:51:47] â„¹ï¸  Using MRN from patient data: '2611003' over '2611003'
[04:51:47] â„¹ï¸  Service line consistent in both sources: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[04:51:47] âœ… Patient name cross-validation successful
[04:51:47] âœ…    âœ… Data merged successfully
[04:51:48] âœ…    âœ… Order data extracted and validated
[04:51:48] ğŸ”„ 
ğŸ”„ Step 5: Checking/Creating patient...
[04:51:59] [DOC: 9323125] âœ… Patient exists in API: Johnnie-Ann Keighley, ID: 9a5d9789-6f14-49d5-8385-ec991990de31
[04:51:59] âœ…    âœ… Existing patient found with ID: 9a5d9789-6f14-49d5-8385-ec991990de31
[04:51:59] ğŸ”„ 
ğŸ”„ Step 6: Pushing order to API...
[04:51:59] [DOC: 9323125] â„¹ï¸  Pushing order via API for patient ID: 9a5d9789-6f14-49d5-8385-ec991990de31
[04:52:02] [DOC: 9323125] âŒ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18742"}
[04:52:02] âŒ    âŒ Failed to push order
[04:52:02] ğŸ”„ 
ğŸ”„ Step 7: Writing to CSV...
[04:52:02] [DOC: 9323125] â„¹ï¸  Calculated age: 80 from DOB: 04/04/1945
[04:52:02] [DOC: 9323125] â„¹ï¸  Service Line extracted: 'Skilled Nursing,Physical Therapy,Occupational Therapy'
[04:52:02] [DOC: 9323125] â„¹ï¸  Payer Source extracted: ''
[04:52:02] [DOC: 9323125] â„¹ï¸  Diagnosis codes being written:
[04:52:02] [DOC: 9323125] â„¹ï¸    - Latest_Episode_Firstdiagnosis: 'S72.001D'
[04:52:02] [DOC: 9323125] â„¹ï¸    - Latest_Episode_Seconddiagnosis: 'D62'
[04:52:02] [DOC: 9323125] â„¹ï¸    - Latest_Episode_Thirddiagnosis: 'I48.0'
[04:52:02] [DOC: 9323125] â„¹ï¸    - Latest_Episode_Fourthdiagnosis: 'I10'
[04:52:02] [DOC: 9323125] â„¹ï¸    - Latest_Episode_Fifthdiagnosis: 'I25.10'
[04:52:02] [DOC: 9323125] â„¹ï¸    - Latest_Episode_Sixthdiagnosis: 'S50.11XD'
[04:52:02] [DOC: 9323125] âœ… Patient data written to CSV: Johnnie-Ann Keighley | Sex: FEMALE | Age: 80 | Service: Skilled Nursing,Physical Therapy,Occupational Therapy | Payer:  | MRN: 2611003
[04:52:02] âœ…    âœ… Document 9323125 processed and saved successfully
[04:52:02] ğŸ”„ 
ğŸ”„ Step 8: Saving API details...
[04:52:02] [DOC: 9323125] â„¹ï¸  API push details saved for document 9323125
[04:52:02] âœ…    âœ… API details saved
================================================================================
â•‘                        Processing Document ID: 9323119                         â•‘
================================================================================
[04:52:02] â„¹ï¸  Agency: Southcoast VNA â€“ Community Office (Fairhaven)
[04:52:02] â„¹ï¸  Date: 06/02/2025
[04:52:02] ğŸ”„ 
ğŸ”„ Step 1: Extracting text from PDF...
[04:52:06] [DOC: 9323119] âœ… Text extracted using pdfplumber (29108 chars)
[04:52:06] âœ…    âœ… Text extracted using pdfplumber (29108 chars)
[04:52:06] ğŸ”„ 
ğŸ”„ Step 2: Extracting patient data...
[04:52:10] â„¹ï¸  AI extracted raw sex value: 'M'
[04:52:10] â„¹ï¸  AI extracted service line: 'Skilled Nursing, Physical Therapy, Home Health Aide'
[04:52:10] â„¹ï¸  AI extracted payer source: ''
[04:52:10] â„¹ï¸  AI extracted diagnoses:
[04:52:10] â„¹ï¸    - Diagnosis 1: 'I21.3'
[04:52:10] â„¹ï¸    - Diagnosis 2: 'G93.41'
[04:52:10] â„¹ï¸    - Diagnosis 3: 'F05'
[04:52:10] â„¹ï¸    - Diagnosis 4: 'E11.22'
[04:52:10] â„¹ï¸    - Diagnosis 5: 'I12.9'
[04:52:10] â„¹ï¸    - Diagnosis 6: 'N18.4'
[04:52:10] â„¹ï¸  Final extracted MRN: '2469775'
[04:52:10] â„¹ï¸  Final extracted Sex: 'MALE'
[04:52:10] â„¹ï¸  Final extracted Service Line: 'Skilled Nursing, Physical Therapy, Home Health Aide'
[04:52:10] â„¹ï¸  Final extracted Payer Source: ''
[04:52:10] âœ… Patient data extraction completed successfully
[04:52:10] âœ…    âœ… Patient data extracted successfully
[04:52:10] ğŸ“Š Patient Response
     â””â”€ patientFName: Mario
     â””â”€ patientLName: Fialho
     â””â”€ dob: 02/13/1946
     â””â”€ patientSex: MALE
     â””â”€ medicalRecordNo: 2469775
     â””â”€ billingProvider: Gloriane Afonso-Fede, MD
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     â””â”€ address: 200 Mill Road
     â””â”€ city: Fairhaven
     â””â”€ state: MA
     â””â”€ zip: 02719-5252
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 973-3200
     â””â”€ serviceLine: Skilled Nursing, Physical Therapy, Home Health Aide
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '05/11/2025', 'startOfEpisode': '05/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'I21.3', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'F05', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.4'}]
[04:52:10] âœ…    âœ… Patient identified: Mario Fialho
[04:52:10] âœ…    âœ… Patient name validation passed
[04:52:10] ğŸ”„ 
ğŸ”„ Step 3: Processing patient dates...
[04:52:10] [DOC: 9323119] â„¹ï¸  DOB normalized: 02/13/1946
[04:52:10] [DOC: 9323119] â„¹ï¸  Episode startOfCare normalized: 05/11/2025
[04:52:10] [DOC: 9323119] â„¹ï¸  Episode startOfEpisode normalized: 05/16/2025
[04:52:10] [DOC: 9323119] â„¹ï¸  Episode endOfEpisode normalized: 07/14/2025
[04:52:10] [DOC: 9323119] âœ… Patient date processing completed successfully
[04:52:10] âœ…    âœ… Date processing completed
[04:52:10] ğŸ“Š Processed Patient Data
     â””â”€ patientFName: Mario
     â””â”€ patientLName: Fialho
     â””â”€ dob: 02/13/1946
     â””â”€ patientSex: MALE
     â””â”€ medicalRecordNo: 2469775
     â””â”€ billingProvider: Gloriane Afonso-Fede, MD
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     â””â”€ address: 200 Mill Road
     â””â”€ city: Fairhaven
     â””â”€ state: MA
     â””â”€ zip: 02719-5252
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 973-3200
     â””â”€ serviceLine: Skilled Nursing, Physical Therapy, Home Health Aide
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '05/11/2025', 'startOfEpisode': '05/16/2025', 'endOfEpisode': '07/14/2025', 'firstDiagnosis': 'I21.3', 'secondDiagnosis': 'G93.41', 'thirdDiagnosis': 'F05', 'fourthDiagnosis': 'E11.22', 'fifthDiagnosis': 'I12.9', 'sixthDiagnosis': 'N18.4'}]
[04:52:10] ğŸ”„ 
ğŸ”„ Step 4: Extracting order data...
[04:52:13] â„¹ï¸  Order extraction - MRN: '2469775'
[04:52:13] â„¹ï¸  Order extraction - Sex: 'MALE'
[04:52:13] â„¹ï¸  Order extraction - Service Line: 'Skilled Nursing, Physical Therapy, Home Health Aide'
[04:52:13] â„¹ï¸  Order extraction - Payer Source: ''
[04:52:13] âœ… Order data extraction completed successfully
[04:52:13] ğŸ”„ 
ğŸ”„ Step 4.5: Merging patient and order data...
[04:52:13] â„¹ï¸  Using MRN from patient data: '2469775' over '2469775'
[04:52:13] â„¹ï¸  Service line consistent in both sources: 'Skilled Nursing, Physical Therapy, Home Health Aide'
[04:52:13] âœ… Patient name cross-validation successful
[04:52:13] âœ…    âœ… Data merged successfully
[04:52:14] âœ…    âœ… Order data extracted and validated
[04:52:14] ğŸ”„ 
ğŸ”„ Step 5: Checking/Creating patient...
[04:52:26] [DOC: 9323119] âœ… Patient exists in API: Mario Fialho, ID: 529c500d-5320-4ac1-a293-eb2867b2e42e
[04:52:26] âœ…    âœ… Existing patient found with ID: 529c500d-5320-4ac1-a293-eb2867b2e42e
[04:52:26] ğŸ”„ 
ğŸ”„ Step 6: Pushing order to API...
[04:52:26] [DOC: 9323119] â„¹ï¸  Pushing order via API for patient ID: 529c500d-5320-4ac1-a293-eb2867b2e42e
[04:52:27] [DOC: 9323119] âŒ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18743"}
[04:52:27] âŒ    âŒ Failed to push order
[04:52:27] ğŸ”„ 
ğŸ”„ Step 7: Writing to CSV...
[04:52:27] [DOC: 9323119] â„¹ï¸  Calculated age: 79 from DOB: 02/13/1946
[04:52:27] [DOC: 9323119] â„¹ï¸  Service Line extracted: 'Skilled Nursing, Physical Therapy, Home Health Aide'
[04:52:27] [DOC: 9323119] â„¹ï¸  Payer Source extracted: ''
[04:52:27] [DOC: 9323119] â„¹ï¸  Diagnosis codes being written:
[04:52:27] [DOC: 9323119] â„¹ï¸    - Latest_Episode_Firstdiagnosis: 'I21.3'
[04:52:27] [DOC: 9323119] â„¹ï¸    - Latest_Episode_Seconddiagnosis: 'G93.41'
[04:52:27] [DOC: 9323119] â„¹ï¸    - Latest_Episode_Thirddiagnosis: 'F05'
[04:52:27] [DOC: 9323119] â„¹ï¸    - Latest_Episode_Fourthdiagnosis: 'E11.22'
[04:52:27] [DOC: 9323119] â„¹ï¸    - Latest_Episode_Fifthdiagnosis: 'I12.9'
[04:52:27] [DOC: 9323119] â„¹ï¸    - Latest_Episode_Sixthdiagnosis: 'N18.4'
[04:52:27] [DOC: 9323119] âœ… Patient data written to CSV: Mario Fialho | Sex: MALE | Age: 79 | Service: Skilled Nursing, Physical Therapy, Home Health Aide | Payer:  | MRN: 2469775
[04:52:27] âœ…    âœ… Document 9323119 processed and saved successfully
[04:52:27] ğŸ”„ 
ğŸ”„ Step 8: Saving API details...
[04:52:27] [DOC: 9323119] â„¹ï¸  API push details saved for document 9323119
[04:52:27] âœ…    âœ… API details saved
================================================================================
â•‘                        Processing Document ID: 9323104                         â•‘
================================================================================
[04:52:27] â„¹ï¸  Agency: Southcoast VNA â€“ Community Office (Fairhaven)
[04:52:27] â„¹ï¸  Date: 06/02/2025
[04:52:27] ğŸ”„ 
ğŸ”„ Step 1: Extracting text from PDF...
[04:52:29] [DOC: 9323104] âœ… Text extracted using pdfplumber (685 chars)
[04:52:29] âœ…    âœ… Text extracted using pdfplumber (685 chars)
[04:52:29] ğŸ”„ 
ğŸ”„ Step 2: Extracting patient data...
[04:52:31] â„¹ï¸  AI extracted raw sex value: 'F'
[04:52:31] â„¹ï¸  AI extracted service line: ''
[04:52:31] â„¹ï¸  AI extracted payer source: ''
[04:52:31] â„¹ï¸  AI extracted diagnoses:
[04:52:31] â„¹ï¸    - Diagnosis 1: ''
[04:52:31] â„¹ï¸    - Diagnosis 2: ''
[04:52:31] â„¹ï¸    - Diagnosis 3: ''
[04:52:31] â„¹ï¸    - Diagnosis 4: ''
[04:52:31] â„¹ï¸    - Diagnosis 5: ''
[04:52:31] â„¹ï¸    - Diagnosis 6: ''
[04:52:31] â„¹ï¸  Final extracted MRN: '2208958'
[04:52:31] â„¹ï¸  Final extracted Sex: 'FEMALE'
[04:52:31] â„¹ï¸  Final extracted Service Line: ''
[04:52:31] â„¹ï¸  Final extracted Payer Source: ''
[04:52:31] âœ… Patient data extraction completed successfully
[04:52:31] âœ…    âœ… Patient data extracted successfully
[04:52:31] ğŸ“Š Patient Response
     â””â”€ patientFName: Carol
     â””â”€ patientLName: Baden
     â””â”€ dob: 07/19/1940
     â””â”€ patientSex: FEMALE
     â””â”€ medicalRecordNo: 2208958
     â””â”€ billingProvider: Jordan C. Gularek, DO
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     â””â”€ address: 200 Mill Road
     â””â”€ city: Fairhaven
     â””â”€ state: MA
     â””â”€ zip: 02719-5252
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 973-3200
     â””â”€ serviceLine: 
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:52:31] âœ…    âœ… Patient identified: Carol Baden
[04:52:31] âœ…    âœ… Patient name validation passed
[04:52:31] ğŸ”„ 
ğŸ”„ Step 3: Processing patient dates...
[04:52:31] [DOC: 9323104] â„¹ï¸  DOB normalized: 07/19/1940
[04:52:31] [DOC: 9323104] âœ… Patient date processing completed successfully
[04:52:31] âœ…    âœ… Date processing completed
[04:52:31] ğŸ“Š Processed Patient Data
     â””â”€ patientFName: Carol
     â””â”€ patientLName: Baden
     â””â”€ dob: 07/19/1940
     â””â”€ patientSex: FEMALE
     â””â”€ medicalRecordNo: 2208958
     â””â”€ billingProvider: Jordan C. Gularek, DO
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     â””â”€ address: 200 Mill Road
     â””â”€ city: Fairhaven
     â””â”€ state: MA
     â””â”€ zip: 02719-5252
     â””â”€ email: 
     â””â”€ phoneNumber: (508) 973-3200
     â””â”€ serviceLine: 
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '', 'endOfEpisode': '', 'firstDiagnosis': '', 'secondDiagnosis': '', 'thirdDiagnosis': '', 'fourthDiagnosis': '', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:52:31] ğŸ”„ 
ğŸ”„ Step 4: Extracting order data...
[04:52:33] â„¹ï¸  Order extraction - MRN: '2208958'
[04:52:33] â„¹ï¸  Order extraction - Sex: 'FEMALE'
[04:52:33] â„¹ï¸  Order extraction - Service Line: ''
[04:52:33] â„¹ï¸  Order extraction - Payer Source: ''
[04:52:33] âœ… Order data extraction completed successfully
[04:52:33] ğŸ”„ 
ğŸ”„ Step 4.5: Merging patient and order data...
[04:52:33] â„¹ï¸  Using MRN from patient data: '2208958' over '2208958'
[04:52:33] âœ… Patient name cross-validation successful
[04:52:33] âœ…    âœ… Data merged successfully
[04:52:34] âš ï¸     âŒ Skipping - missing episode start date
[04:52:34] [DOC: 9323104] â„¹ï¸  API push details saved for document 9323104
================================================================================
â•‘                        Processing Document ID: 9323102                         â•‘
================================================================================
[04:52:34] â„¹ï¸  Agency: Southcoast VNA â€“ Community Office (Fairhaven)
[04:52:34] â„¹ï¸  Date: 06/02/2025
[04:52:34] ğŸ”„ 
ğŸ”„ Step 1: Extracting text from PDF...
[04:52:39] [DOC: 9323102] âœ… Text extracted using pdfplumber (23636 chars)
[04:52:39] âœ…    âœ… Text extracted using pdfplumber (23636 chars)
[04:52:39] ğŸ”„ 
ğŸ”„ Step 2: Extracting patient data...
[04:52:42] â„¹ï¸  AI extracted raw sex value: 'F'
[04:52:42] â„¹ï¸  AI extracted service line: 'Skilled Nursing, MSW, Clergy, Home Health Aide'
[04:52:42] â„¹ï¸  AI extracted payer source: ''
[04:52:42] â„¹ï¸  AI extracted diagnoses:
[04:52:42] â„¹ï¸    - Diagnosis 1: 'I69.90'
[04:52:42] â„¹ï¸    - Diagnosis 2: 'E44.0'
[04:52:42] â„¹ï¸    - Diagnosis 3: 'R13.10'
[04:52:42] â„¹ï¸    - Diagnosis 4: 'F01.50'
[04:52:42] â„¹ï¸    - Diagnosis 5: ''
[04:52:42] â„¹ï¸    - Diagnosis 6: ''
[04:52:42] â„¹ï¸  Final extracted MRN: '2208958'
[04:52:42] â„¹ï¸  Final extracted Sex: 'FEMALE'
[04:52:42] â„¹ï¸  Final extracted Service Line: 'Skilled Nursing, MSW, Clergy, Home Health Aide'
[04:52:42] â„¹ï¸  Final extracted Payer Source: ''
[04:52:42] âœ… Patient data extraction completed successfully
[04:52:42] âœ…    âœ… Patient data extracted successfully
[04:52:42] ğŸ“Š Patient Response
     â””â”€ patientFName: Carol
     â””â”€ patientLName: Baden
     â””â”€ dob: 07/19/1940
     â””â”€ patientSex: FEMALE
     â””â”€ medicalRecordNo: 2208958
     â””â”€ billingProvider: Jordan C. Gularek, DO
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     â””â”€ address: 200 Mill Road
     â””â”€ city: Fairhaven
     â””â”€ state: MA
     â””â”€ zip: 02719-5252
     â””â”€ email: 
     â””â”€ phoneNumber: 508-973-3200
     â””â”€ serviceLine: Skilled Nursing, MSW, Clergy, Home Health Aide
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '08/25/2025', 'firstDiagnosis': 'I69.90', 'secondDiagnosis': 'E44.0', 'thirdDiagnosis': 'R13.10', 'fourthDiagnosis': 'F01.50', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:52:42] âœ…    âœ… Patient identified: Carol Baden
[04:52:42] âœ…    âœ… Patient name validation passed
[04:52:42] ğŸ”„ 
ğŸ”„ Step 3: Processing patient dates...
[04:52:42] [DOC: 9323102] â„¹ï¸  DOB normalized: 07/19/1940
[04:52:42] [DOC: 9323102] â„¹ï¸  Episode startOfEpisode normalized: 05/28/2025
[04:52:42] [DOC: 9323102] â„¹ï¸  Episode endOfEpisode normalized: 08/25/2025
[04:52:42] [DOC: 9323102] âœ… Patient date processing completed successfully
[04:52:42] âœ…    âœ… Date processing completed
[04:52:42] ğŸ“Š Processed Patient Data
     â””â”€ patientFName: Carol
     â””â”€ patientLName: Baden
     â””â”€ dob: 07/19/1940
     â””â”€ patientSex: FEMALE
     â””â”€ medicalRecordNo: 2208958
     â””â”€ billingProvider: Jordan C. Gularek, DO
     â””â”€ npi: 
     â””â”€ physicianNPI: 
     â””â”€ nameOfAgency: Southcoast Visiting Nurse Association Inc.
     â””â”€ address: 200 Mill Road
     â””â”€ city: Fairhaven
     â””â”€ state: MA
     â””â”€ zip: 02719-5252
     â””â”€ email: 
     â””â”€ phoneNumber: 508-973-3200
     â””â”€ serviceLine: Skilled Nursing, MSW, Clergy, Home Health Aide
     â””â”€ payorSource: 
     â””â”€ episodeDiagnoses: [{'startOfCare': '', 'startOfEpisode': '05/28/2025', 'endOfEpisode': '08/25/2025', 'firstDiagnosis': 'I69.90', 'secondDiagnosis': 'E44.0', 'thirdDiagnosis': 'R13.10', 'fourthDiagnosis': 'F01.50', 'fifthDiagnosis': '', 'sixthDiagnosis': ''}]
[04:52:42] ğŸ”„ 
ğŸ”„ Step 4: Extracting order data...
[04:52:45] â„¹ï¸  Order extraction - MRN: '2208958'
[04:52:45] â„¹ï¸  Order extraction - Sex: 'FEMALE'
[04:52:45] â„¹ï¸  Order extraction - Service Line: 'Skilled Nursing, MSW, Clergy, Home Health Aide'
[04:52:45] â„¹ï¸  Order extraction - Payer Source: ''
[04:52:45] âœ… Order data extraction completed successfully
[04:52:45] ğŸ”„ 
ğŸ”„ Step 4.5: Merging patient and order data...
[04:52:45] â„¹ï¸  Using MRN from patient data: '2208958' over '2208958'
[04:52:45] â„¹ï¸  Service line consistent in both sources: 'Skilled Nursing, MSW, Clergy, Home Health Aide'
[04:52:45] âœ… Patient name cross-validation successful
[04:52:45] âœ…    âœ… Data merged successfully
[04:52:46] âœ…    âœ… Order data extracted and validated
[04:52:46] ğŸ”„ 
ğŸ”„ Step 5: Checking/Creating patient...
[04:53:08] [DOC: 9323102] âœ… Patient exists in API: Carol Baden, ID: b21bad59-ac67-44df-a4c9-722195632f90
[04:53:08] âœ…    âœ… Existing patient found with ID: b21bad59-ac67-44df-a4c9-722195632f90
[04:53:08] ğŸ”„ 
ğŸ”„ Step 6: Pushing order to API...
[04:53:08] [DOC: 9323102] â„¹ï¸  Pushing order via API for patient ID: b21bad59-ac67-44df-a4c9-722195632f90
[04:53:09] [DOC: 9323102] âŒ Order push failed with status 409: {"message":"Duplicate order found","orderId":"ORD18745"}
[04:53:09] âŒ    âŒ Failed to push order
[04:53:09] ğŸ”„ 
ğŸ”„ Step 7: Writing to CSV...
[04:53:09] [DOC: 9323102] â„¹ï¸  Calculated age: 84 from DOB: 07/19/1940
[04:53:09] [DOC: 9323102] â„¹ï¸  Service Line extracted: 'Skilled Nursing, MSW, Clergy, Home Health Aide'
[04:53:09] [DOC: 9323102] â„¹ï¸  Payer Source extracted: ''
[04:53:09] [DOC: 9323102] â„¹ï¸  Diagnosis codes being written:
[04:53:09] [DOC: 9323102] â„¹ï¸    - Latest_Episode_Firstdiagnosis: 'I69.90'
[04:53:09] [DOC: 9323102] â„¹ï¸    - Latest_Episode_Seconddiagnosis: 'E44.0'
[04:53:09] [DOC: 9323102] â„¹ï¸    - Latest_Episode_Thirddiagnosis: 'R13.10'
[04:53:09] [DOC: 9323102] â„¹ï¸    - Latest_Episode_Fourthdiagnosis: 'F01.50'
[04:53:09] [DOC: 9323102] â„¹ï¸    - Latest_Episode_Fifthdiagnosis: ''
[04:53:09] [DOC: 9323102] â„¹ï¸    - Latest_Episode_Sixthdiagnosis: ''
[04:53:09] [DOC: 9323102] âœ… Patient data written to CSV: Carol Baden | Sex: FEMALE | Age: 84 | Service: Skilled Nursing, MSW, Clergy, Home Health Aide | Payer:  | MRN: 2208958
[04:53:09] âœ…    âœ… Document 9323102 processed and saved successfully
[04:53:09] ğŸ”„ 
ğŸ”„ Step 8: Saving API details...
[04:53:09] [DOC: 9323102] â„¹ï¸  API push details saved for document 9323102
[04:53:09] âœ…    âœ… API details saved
================================================================================
â•‘                               PROCESSING SUMMARY                               â•‘
================================================================================
[04:53:09] â„¹ï¸  Total Processed: 5
[04:53:09] â„¹ï¸  CSV Success: 4
[04:53:09] â„¹ï¸  CSV Errors: 1
[04:53:09] â„¹ï¸  API Success: 0
[04:53:09] â„¹ï¸  API Errors: 4
[04:53:09] â„¹ï¸  CSV Success Rate: 80.0%
[04:53:09] â„¹ï¸  API Success Rate: 0.0%
[04:53:09] â„¹ï¸  Output CSV File: csv_outputs/extracted_patients_20250607_045122.csv
[04:53:09] â„¹ï¸  API Details File: api_outputs/api_push_details_20250607_045122.csv
================================================================================
â•‘          ============================================================          â•‘
================================================================================
